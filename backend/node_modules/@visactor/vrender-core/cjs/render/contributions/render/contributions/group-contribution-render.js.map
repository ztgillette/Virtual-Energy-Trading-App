{"version":3,"sources":["../src/render/contributions/render/contributions/group-contribution-render.ts"],"names":[],"mappings":";;;AAQA,yEAAqF;AACrF,oDAAsE;AAEtE,MAAa,wCACX,SAAQ,kEAAuC;IADjD;;QAIE,SAAI,GAA+B,kCAA0B,CAAC,gBAAgB,CAAC;IAwDjF,CAAC;IAtDC,SAAS,CACP,OAAe,EACf,OAAmB,EACnB,CAAS,EACT,CAAS,EACT,MAAe,EACf,QAAiB,EACjB,QAAiB,EACjB,QAAiB,EACjB,gBAA6C,EAC7C,WAAyB,EACzB,MAAiH,EACjH,QAAmH;QAEnH,MAAM,EACJ,UAAU,EACV,cAAc,GAAG,gBAAgB,CAAC,cAAc,EAChD,aAAa,GAAG,gBAAgB,CAAC,aAAa,EAC9C,yBAAyB,GAAG,gBAAgB,CAAC,yBAAyB,EACtE,eAAe,GAAG,gBAAgB,CAAC,eAAe,EAClD,iBAAiB,GAAG,gBAAgB,CAAC,iBAAiB,EACtD,iBAAiB,GAAG,gBAAgB,CAAC,iBAAiB,EACvD,GAAG,OAAO,CAAC,SAAS,CAAC;QACtB,IAAI,CAAC,UAAU,EAAE;YACf,OAAO;SACR;QAED,IAAI,OAAO,CAAC,aAAa,IAAI,OAAO,CAAC,SAAS,EAAE;YAC9C,MAAM,GAAG,GAAG,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,UAAiB,CAAC,CAAC;YACrD,IAAI,GAAG,CAAC,KAAK,KAAK,SAAS,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE;gBACxC,OAAO;aACR;YAED,OAAO,CAAC,mBAAmB,EAAE,CAAC;YAE9B,OAAO,CAAC,sBAAsB,CAAC,OAAO,CAAC,MAAM,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;YACvE,MAAM,CAAC,GAAG,OAAO,CAAC,UAAU,CAAC;YAC7B,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,GAAG,CAAC,IAAI,EAAE,CAAC,EAAE;gBACrC,cAAc;gBACd,aAAa;gBACb,yBAAyB;gBACzB,eAAe;gBACf,iBAAiB;gBACjB,iBAAiB;aAClB,CAAC,CAAC;YACH,OAAO,CAAC,sBAAsB,EAAE,CAAC;YACjC,OAAO,CAAC,sBAAsB,EAAE,CAAC;SAClC;aAAM;YACL,OAAO,CAAC,mBAAmB,EAAE,CAAC;YAC9B,OAAO,CAAC,SAAS,GAAG,UAAoB,CAAC;YACzC,OAAO,CAAC,IAAI,EAAE,CAAC;YACf,OAAO,CAAC,sBAAsB,EAAE,CAAC;SAClC;IACH,CAAC;CACF;AA5DD,4FA4DC;AAEY,QAAA,wCAAwC,GAAG,IAAI,wCAAwC,EAAE,CAAC","file":"group-contribution-render.js","sourcesContent":["import type {\n  IGraphicAttribute,\n  IContext2d,\n  IGroup,\n  IThemeAttribute,\n  IGroupRenderContribution,\n  IDrawContext\n} from '../../../../interface';\nimport { DefaultBaseBackgroundRenderContribution } from './base-contribution-render';\nimport { BaseRenderContributionTime } from '../../../../common/enums';\n\nexport class DefaultGroupBackgroundRenderContribution\n  extends DefaultBaseBackgroundRenderContribution\n  implements IGroupRenderContribution\n{\n  time: BaseRenderContributionTime = BaseRenderContributionTime.beforeFillStroke;\n\n  drawShape(\n    graphic: IGroup,\n    context: IContext2d,\n    x: number,\n    y: number,\n    doFill: boolean,\n    doStroke: boolean,\n    fVisible: boolean,\n    sVisible: boolean,\n    graphicAttribute: Required<IGraphicAttribute>,\n    drawContext: IDrawContext,\n    fillCb?: (ctx: IContext2d, markAttribute: Partial<IGraphicAttribute>, themeAttribute: IThemeAttribute) => boolean,\n    strokeCb?: (ctx: IContext2d, markAttribute: Partial<IGraphicAttribute>, themeAttribute: IThemeAttribute) => boolean\n  ) {\n    const {\n      background,\n      backgroundMode = graphicAttribute.backgroundMode,\n      backgroundFit = graphicAttribute.backgroundFit,\n      backgroundKeepAspectRatio = graphicAttribute.backgroundKeepAspectRatio,\n      backgroundScale = graphicAttribute.backgroundScale,\n      backgroundOffsetX = graphicAttribute.backgroundOffsetX,\n      backgroundOffsetY = graphicAttribute.backgroundOffsetY\n    } = graphic.attribute;\n    if (!background) {\n      return;\n    }\n\n    if (graphic.backgroundImg && graphic.resources) {\n      const res = graphic.resources.get(background as any);\n      if (res.state !== 'success' || !res.data) {\n        return;\n      }\n\n      context.highPerformanceSave();\n\n      context.setTransformFromMatrix(graphic.parent.globalTransMatrix, true);\n      const b = graphic.AABBBounds;\n      this.doDrawImage(context, res.data, b, {\n        backgroundMode,\n        backgroundFit,\n        backgroundKeepAspectRatio,\n        backgroundScale,\n        backgroundOffsetX,\n        backgroundOffsetY\n      });\n      context.highPerformanceRestore();\n      context.setTransformForCurrent();\n    } else {\n      context.highPerformanceSave();\n      context.fillStyle = background as string;\n      context.fill();\n      context.highPerformanceRestore();\n    }\n  }\n}\n\nexport const defaultGroupBackgroundRenderContribution = new DefaultGroupBackgroundRenderContribution();\n"]}