{"version":3,"sources":["../src/graphic/arc.ts"],"names":[],"mappings":"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","file":"arc.js","sourcesContent":["import type { IAABBBounds } from '@visactor/vutils';\nimport { pi2, sin, epsilon, abs, asin, clampAngleByRadian, isNumber, cos, sqrt, isArray } from '@visactor/vutils';\nimport type { IArc, IArcGraphicAttribute } from '../interface/graphic/arc';\nimport { Graphic, GRAPHIC_UPDATE_TAG_KEY, NOWORK_ANIMATE_ATTR } from './graphic';\nimport { CustomPath2D } from '../common/custom-path2d';\nimport { circleBounds } from '../common/utils';\nimport { getTheme } from './theme';\nimport { application } from '../application';\nimport type { GraphicType } from '../interface';\nimport { ARC_NUMBER_TYPE } from './constants';\nimport { updateBoundsOfCommonOuterBorder } from './graphic-service/common-outer-boder-bounds';\n\n/**\n * 部分代码参考 https://github.com/d3/d3-shape/\n * Copyright 2010-2022 Mike Bostock\n\n  Permission to use, copy, modify, and/or distribute this software for any purpose\n  with or without fee is hereby granted, provided that the above copyright notice\n  and this permission notice appear in all copies.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND\n  FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\n  OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER\n  TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF\n  THIS SOFTWARE.\n */\n\nconst ARC_UPDATE_TAG_KEY = [\n  'innerRadius',\n  'outerRadius',\n  'startAngle',\n  'endAngle',\n  'cornerRadius',\n  'padAngle',\n  'padRadius',\n  'cap',\n  ...GRAPHIC_UPDATE_TAG_KEY\n];\n\n/**\n * 圆形图元\n * 默认顺时针绘制\n */\nexport class Arc extends Graphic<IArcGraphicAttribute> implements IArc {\n  type: GraphicType = 'arc';\n\n  static NOWORK_ANIMATE_ATTR = {\n    cap: 1,\n    ...NOWORK_ANIMATE_ATTR\n  };\n\n  // static parseCornerRadius(r: IArcGraphicAttribute['cornerRadius']) {\n  //   if (isArray(r)) {\n  //     if ((r as any[]).length === 1) {\n  //       const value = r[0];\n  //       return [value, value, value, value];\n  //     }\n\n  //     if ((r as any[]).length === 2) {\n  //       return [r[0], r[0], r[1], r[1]];\n  //     }\n\n  //     if ((r as any[]).length === 3) {\n  //       return [r[0], r[1], r[2], 0];\n  //     }\n\n  //     return (r as any[]).slice(0, 4);\n  //   }\n\n  //   return [r as string | number, r as string | number, r as string | number, r as string | number];\n  // }\n\n  // static isCornerRadiusEqual(oldR: IArcGraphicAttribute['cornerRadius'], newR: IArcGraphicAttribute['cornerRadius']) {\n  //   throw new Error('暂不支持');\n  //   if (oldR === newR) {\n  //     return true;\n  //   }\n\n  //   if (isArray(oldR) && !isArray(newR)) {\n  //     return (oldR as (string | number)[]).every(r => r === newR);\n  //   }\n\n  //   if (!isArray(oldR) && isArray(newR)) {\n  //     return (newR as (string | number)[]).every(r => r === oldR);\n  //   }\n\n  //   return arrayEqual(oldR as (string | number)[], newR as (string | number)[]);\n  // }\n\n  constructor(params: IArcGraphicAttribute) {\n    super(params);\n    this.numberType = ARC_NUMBER_TYPE;\n  }\n\n  isValid(): boolean {\n    return super.isValid() && this._isValid();\n  }\n  private _isValid(): boolean {\n    const { startAngle, endAngle, outerRadius, innerRadius } = this.attribute;\n    return (\n      this._validNumber(startAngle) &&\n      this._validNumber(endAngle) &&\n      this._validNumber(outerRadius) &&\n      this._validNumber(innerRadius)\n    );\n  }\n\n  getParsedCornerRadius() {\n    const arcTheme = this.getGraphicTheme();\n    const {\n      cornerRadius = arcTheme.cornerRadius,\n      innerPadding = arcTheme.innerPadding,\n      outerPadding = arcTheme.outerPadding\n    } = this.attribute;\n    let { outerRadius = arcTheme.outerRadius, innerRadius = arcTheme.innerRadius } = this.attribute;\n    outerRadius += outerPadding;\n    innerRadius -= innerPadding;\n    if (cornerRadius === 0 || cornerRadius === '0%') {\n      return 0;\n    }\n    const deltaRadius = Math.abs(outerRadius - innerRadius);\n    const parseCR = (cornerRadius: number | string) => {\n      return Math.min(\n        isNumber(cornerRadius, true)\n          ? (cornerRadius as number)\n          : (deltaRadius * parseFloat(cornerRadius as string)) / 100,\n        deltaRadius / 2\n      );\n    };\n    if (isArray(cornerRadius)) {\n      const crList = cornerRadius.map(cr => parseCR(cr) || 0);\n      if (crList.length === 0) {\n        return [crList[0], crList[0], crList[0], crList[0]];\n      } else if (crList.length === 2) {\n        return [crList[0], crList[1], crList[0], crList[1]];\n      } else if (crList.length === 3) {\n        crList.push(0);\n      }\n      return crList;\n    }\n    return parseCR(cornerRadius);\n  }\n\n  getParsedAngle() {\n    const arcTheme = this.getGraphicTheme();\n    let { startAngle = arcTheme.startAngle, endAngle = arcTheme.endAngle } = this.attribute;\n    const { cap = arcTheme.cap } = this.attribute;\n\n    const sign = endAngle - startAngle >= 0 ? 1 : -1;\n    const deltaAngle = endAngle - startAngle;\n\n    startAngle = clampAngleByRadian(startAngle);\n    endAngle = startAngle + deltaAngle;\n\n    if (cap && abs(deltaAngle) < pi2 - epsilon) {\n      let startCap = 1;\n      let endCap = 1;\n      if ((cap as boolean[]).length) {\n        startCap = Number((cap as boolean[])[0]);\n        endCap = Number((cap as boolean[])[1]);\n      }\n      let { outerRadius = arcTheme.outerRadius, innerRadius = arcTheme.innerRadius } = this.attribute;\n      const { outerPadding = arcTheme.outerPadding, innerPadding = arcTheme.innerPadding } = this.attribute;\n      outerRadius += outerPadding;\n      innerRadius -= innerPadding;\n      const capWidth = Math.abs(outerRadius - innerRadius) / 2;\n      // 以外边界长度为准\n      const capAngle = capWidth / outerRadius;\n\n      if (capWidth > epsilon && outerRadius > epsilon) {\n        return {\n          startAngle: startAngle - sign * capAngle * startCap,\n          endAngle: endAngle + sign * capAngle * endCap,\n          sc: sign * capAngle * startCap,\n          ec: sign * capAngle * endCap\n        };\n      }\n    }\n\n    return {\n      startAngle: startAngle,\n      endAngle: endAngle\n    };\n  }\n\n  // 参考 https://github.com/d3/d3-shape/blob/main/src/arc.js\n  getParsePadAngle(startAngle: number, endAngle: number) {\n    const arcTheme = this.getGraphicTheme();\n    const {\n      innerPadding = arcTheme.innerPadding,\n      outerPadding = arcTheme.outerPadding,\n      padAngle = arcTheme.padAngle\n    } = this.attribute;\n    let { outerRadius = arcTheme.outerRadius, innerRadius = arcTheme.innerRadius } = this.attribute;\n    outerRadius += outerPadding;\n    innerRadius -= innerPadding;\n\n    const { padRadius = sqrt(outerRadius * outerRadius + innerRadius * innerRadius) } = this.attribute;\n    const deltaAngle = abs(endAngle - startAngle);\n\n    // Or is it a circular or annular sector?\n    let outerStartAngle = startAngle;\n    let outerEndAngle = endAngle;\n    let innerStartAngle = startAngle;\n    let innerEndAngle = endAngle;\n    const halfPadAngle = padAngle / 2;\n    let innerDeltaAngle = deltaAngle;\n    let outerDeltaAngle = deltaAngle;\n\n    // Apply padding? Note that since r1 ≥ r0, outerDeltaAngle ≥ innerDeltaAngle.\n    if (halfPadAngle > epsilon && padRadius > epsilon) {\n      const sign = endAngle > startAngle ? 1 : -1;\n\n      let p0 = asin((Number(padRadius) / innerRadius) * sin(halfPadAngle));\n      let p1 = asin((Number(padRadius) / outerRadius) * sin(halfPadAngle));\n      if ((innerDeltaAngle -= p0 * 2) > epsilon) {\n        p0 *= sign;\n        innerStartAngle += p0;\n        innerEndAngle -= p0;\n      } else {\n        innerDeltaAngle = 0;\n        innerStartAngle = innerEndAngle = (startAngle + endAngle) / 2;\n      }\n      if ((outerDeltaAngle -= p1 * 2) > epsilon) {\n        p1 *= sign;\n        outerStartAngle += p1;\n        outerEndAngle -= p1;\n      } else {\n        outerDeltaAngle = 0;\n        outerStartAngle = outerEndAngle = (startAngle + endAngle) / 2;\n      }\n\n      return {\n        outerStartAngle,\n        outerEndAngle,\n        innerStartAngle,\n        innerEndAngle,\n        innerDeltaAngle,\n        outerDeltaAngle\n      };\n    }\n\n    return {\n      outerStartAngle,\n      outerEndAngle,\n      innerStartAngle,\n      innerEndAngle,\n      innerDeltaAngle,\n      outerDeltaAngle\n    };\n  }\n\n  getGraphicTheme(): Required<IArcGraphicAttribute> {\n    return getTheme(this).arc;\n  }\n\n  protected updateAABBBounds(\n    attribute: IArcGraphicAttribute,\n    arcTheme: Required<IArcGraphicAttribute>,\n    aabbBounds: IAABBBounds,\n    full?: boolean\n  ) {\n    if (!this.updatePathProxyAABBBounds(aabbBounds)) {\n      full\n        ? this.updateArcAABBBoundsImprecise(attribute, arcTheme, aabbBounds)\n        : this.updateArcAABBBoundsAccurate(attribute, arcTheme, aabbBounds);\n    }\n\n    const { tb1, tb2 } = application.graphicService.updateTempAABBBounds(aabbBounds);\n\n    updateBoundsOfCommonOuterBorder(attribute, arcTheme, tb1);\n    aabbBounds.union(tb1);\n    tb1.setValue(tb2.x1, tb2.y1, tb2.x2, tb2.y2);\n\n    this.setWidthHeightWithoutTransform(aabbBounds);\n\n    const { lineJoin = arcTheme.lineJoin } = attribute;\n    application.graphicService.transformAABBBounds(attribute, aabbBounds, arcTheme, lineJoin === 'miter', this);\n\n    return aabbBounds;\n  }\n\n  protected updateArcAABBBoundsImprecise(\n    attribute: IArcGraphicAttribute,\n    arcTheme: Required<IArcGraphicAttribute>,\n    aabbBounds: IAABBBounds\n  ): IAABBBounds {\n    let { outerRadius = arcTheme.outerRadius, innerRadius = arcTheme.innerRadius } = attribute;\n    const { outerPadding = arcTheme.outerPadding, innerPadding = arcTheme.innerPadding } = attribute;\n    outerRadius += outerPadding;\n    innerRadius -= innerPadding;\n    if (outerRadius < innerRadius) {\n      outerRadius = innerRadius;\n    }\n\n    aabbBounds.set(-outerRadius, -outerRadius, outerRadius, outerRadius);\n\n    return aabbBounds;\n  }\n  protected updateArcAABBBoundsAccurate(\n    attribute: IArcGraphicAttribute,\n    arcTheme: Required<IArcGraphicAttribute>,\n    aabbBounds: IAABBBounds\n  ): IAABBBounds {\n    let { outerRadius = arcTheme.outerRadius, innerRadius = arcTheme.innerRadius } = attribute;\n    const { outerPadding = arcTheme.outerPadding, innerPadding = arcTheme.innerPadding } = attribute;\n    outerRadius += outerPadding;\n    innerRadius -= innerPadding;\n    if (outerRadius < innerRadius) {\n      // 不用解构，避免性能问题\n      const temp = outerRadius;\n      outerRadius = innerRadius;\n      innerRadius = temp;\n    }\n    let { endAngle = arcTheme.endAngle, startAngle = arcTheme.startAngle } = attribute;\n\n    if (startAngle > endAngle) {\n      const temp = startAngle;\n      startAngle = endAngle;\n      endAngle = temp;\n    }\n\n    if (outerRadius <= epsilon) {\n      aabbBounds.set(0, 0, 0, 0);\n    } else if (Math.abs(endAngle - startAngle) > pi2 - epsilon) {\n      aabbBounds.set(-outerRadius, -outerRadius, outerRadius, outerRadius);\n    } else {\n      // 直接内外两个radius叠加即可，不需要更精确\n      circleBounds(startAngle, endAngle, outerRadius, aabbBounds);\n      circleBounds(startAngle, endAngle, innerRadius, aabbBounds);\n    }\n\n    return aabbBounds;\n  }\n\n  protected needUpdateTags(keys: string[]): boolean {\n    return super.needUpdateTags(keys, ARC_UPDATE_TAG_KEY);\n  }\n  protected needUpdateTag(key: string): boolean {\n    return super.needUpdateTag(key, ARC_UPDATE_TAG_KEY);\n  }\n\n  toCustomPath() {\n    let path = super.toCustomPath();\n    if (path) {\n      return path;\n    }\n    const x = 0;\n    const y = 0;\n\n    const attribute = this.attribute;\n    const { startAngle, endAngle } = this.getParsedAngle();\n    let innerRadius = (attribute.innerRadius ?? 0) - (attribute.innerPadding ?? 0);\n    let outerRadius = (attribute.outerRadius ?? 0) - (attribute.outerPadding ?? 0);\n    const deltaAngle = abs(endAngle - startAngle);\n    const clockwise: boolean = endAngle > startAngle;\n\n    if (outerRadius < innerRadius) {\n      const temp = outerRadius;\n      outerRadius = innerRadius;\n      innerRadius = temp;\n    }\n\n    path = new CustomPath2D();\n\n    if (outerRadius <= epsilon) {\n      path.moveTo(x, y);\n    } else if (deltaAngle >= pi2 - epsilon) {\n      // 是个完整的圆环\n      // Or is it a circle or annulus?\n      path.moveTo(x + outerRadius * cos(startAngle), y + outerRadius * sin(startAngle));\n      path.arc(x, y, outerRadius, startAngle, endAngle, !clockwise);\n      if (innerRadius > epsilon) {\n        path.moveTo(x + innerRadius * cos(endAngle), y + innerRadius * sin(endAngle));\n        path.arc(x, y, innerRadius, endAngle, startAngle, clockwise);\n      }\n    } else {\n      const xors = outerRadius * cos(startAngle);\n      const yors = outerRadius * sin(startAngle);\n      const xire = innerRadius * cos(endAngle);\n      const yire = innerRadius * sin(endAngle);\n\n      path.moveTo(x + xors, y + yors);\n      path.arc(x, y, outerRadius, startAngle, endAngle, !clockwise);\n      path.lineTo(x + xire, y + yire);\n      path.arc(x, y, innerRadius, endAngle, startAngle, clockwise);\n      path.closePath();\n    }\n\n    return path;\n  }\n\n  clone() {\n    return new Arc({ ...this.attribute });\n  }\n\n  getNoWorkAnimateAttr(): Record<string, number> {\n    return Arc.NOWORK_ANIMATE_ATTR;\n  }\n}\n\nexport function createArc(attributes: IArcGraphicAttribute): IArc {\n  return new Arc(attributes);\n}\n\n// addAttributeToPrototype(DefaultCircleStyle, Circle, PURE_STYLE_KEY);\n"]}