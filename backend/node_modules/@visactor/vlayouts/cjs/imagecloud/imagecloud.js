"use strict";

Object.defineProperty(exports, "__esModule", {
    value: !0
}), exports.transform = void 0;

const vutils_1 = require("@visactor/vutils"), spiral_1 = require("./layout/spiral"), grid_1 = require("./layout/grid/grid"), stack_1 = require("./layout/stack"), transform = (options, upstreamData, parameters) => {
    var _a, _b;
    const size = (0, vutils_1.isFunction)(options.size) ? options.size() : options.size;
    if (options.size = size, !size || (0, vutils_1.isNil)(size[0]) || (0, vutils_1.isNil)(size[1]) || size[0] <= 0 || size[1] <= 0) {
        return vutils_1.Logger.getInstance().info("Wordcloud size dimensions must be greater than 0"), 
        [];
    }
    if (options.size = [ Math.ceil(size[0]), Math.ceil(size[1]) ], options.image || vutils_1.Logger.getInstance().error("Imagecloud: image source must be specified."), 
    options.onBeforeLayout && options.onBeforeLayout(), !upstreamData || 0 === upstreamData.length) return [];
    let layoutConstructor;
    switch (null !== (_b = null === (_a = options.layoutConfig) || void 0 === _a ? void 0 : _a.layoutMode) && void 0 !== _b ? _b : "spiral") {
      case "grid":
        layoutConstructor = grid_1.GridLayout;
        break;

      case "stack":
        layoutConstructor = stack_1.StackLayout;
        break;

      default:
        layoutConstructor = spiral_1.SpiralLayout;
    }
    const layout = new layoutConstructor(options);
    return layout.layout(upstreamData), layout.unfinished() ? {
        progressive: layout
    } : layout.output();
};

exports.transform = transform;
//# sourceMappingURL=imagecloud.js.map