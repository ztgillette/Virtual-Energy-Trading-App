!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).VChart={})}(this,(function(t){"use strict";function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n(t,e,i){return e=c(e),p(t,d()?Reflect.construct(e,i||[],c(t).constructor):e.apply(t,i))}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,x(n.key),n)}}function o(t,e,i){return e&&a(t.prototype,e),i&&a(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=S(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function l(t,e,i){return(e=x(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}},u.apply(null,arguments)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e)}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function p(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return i(t)}function f(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var t,e,i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",r=i.toStringTag||"@@toStringTag";function a(i,n,r,a){var l=n&&n.prototype instanceof s?n:s,u=Object.create(l.prototype);return v(u,"_invoke",function(i,n,r){var a,s,l,u=0,c=r||[],h=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,i){return a=e,s=0,l=t,d.n=i,o}};function p(i,n){for(s=i,l=n,e=0;!h&&u&&!r&&e<c.length;e++){var r,a=c[e],p=d.p,f=a[2];i>3?(r=f===n)&&(l=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=p&&((r=i<2&&p<a[1])?(s=0,d.v=n,d.n=a[1]):p<f&&(r=i<3||a[0]>n||n>f)&&(a[4]=i,a[5]=n,d.n=f,s=0))}if(r||i>1)return o;throw h=!0,n}return function(r,c,f){if(u>1)throw TypeError("Generator is already running");for(h&&1===c&&p(c,f),s=c,l=f;(e=s<2?t:l)||!h;){a||(s?s<3?(s>1&&(d.n=-1),p(s,l)):d.n=l:d.v=l);try{if(u=2,a){if(s||(r="next"),e=a[r]){if(!(e=e.call(a,l)))throw TypeError("iterator result is not an object");if(!e.done)return e;l=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),s=1);a=t}else if((e=(h=d.n<0)?l:i.call(n,d))!==o)break}catch(e){a=t,s=1,l=e}finally{u=1}}return{value:e,done:h}}}(i,r,a),!0),u}var o={};function s(){}function l(){}function u(){}e=Object.getPrototypeOf;var c=[][n]?e(e([][n]())):(v(e={},n,(function(){return this})),e),h=u.prototype=s.prototype=Object.create(c);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,v(t,r,"GeneratorFunction")),t.prototype=Object.create(h),t}return l.prototype=u,v(h,"constructor",u),v(u,"constructor",l),l.displayName="GeneratorFunction",v(u,r,"GeneratorFunction"),v(h),v(h,r,"Generator"),v(h,n,(function(){return this})),v(h,"toString",(function(){return"[object Generator]"})),(f=function(){return{w:a,m:d}})()}function v(t,e,i,n){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}v=function(t,e,i,n){if(e)r?r(t,e,{value:i,enumerable:!n,configurable:!n,writable:!n}):t[e]=i;else{function a(e,i){v(t,e,(function(t){return this._invoke(e,i,t)}))}a("next",0),a("throw",1),a("return",2)}},v(t,e,i,n)}function g(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],i=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}}throw new TypeError(typeof t+" is not iterable")}function y(t,e){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},y(t,e)}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,a,o,s=[],l=!0,u=!1;try{if(a=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=a.call(i)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){u=!0,r=t}finally{try{if(!l&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(u)throw r}}return s}}(t,e)||S(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e,i,n){var r=u(c(1&n?t.prototype:t),e,i);return 2&n&&"function"==typeof r?function(t){return r.apply(i,t)}:r}function b(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||S(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function S(t,i){if(t){if("string"==typeof t)return e(t,i);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,i):void 0}}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var A=function(t,e){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},A(t,e)};function M(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}A(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var T=function(){return T=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},T.apply(this,arguments)};function w(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i}function C(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))}function E(t,e){var i,n,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],n=0}finally{i=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function P(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function B(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,a=i.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}function R(t,e,i){if(i||2===arguments.length)for(var n,r=0,a=e.length;r<a;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return t.concat(n||Array.prototype.slice.call(e))}var L,I,D=function(t){return t};function O(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}t.RenderModeEnum=void 0,(L=t.RenderModeEnum||(t.RenderModeEnum={}))["desktop-browser"]="desktop-browser",L["mobile-browser"]="mobile-browser",L.node="node",L.worker="worker",L.miniApp="miniApp",L.wx="wx",L.tt="tt",L.harmony="harmony",L["desktop-miniApp"]="desktop-miniApp",L.lynx="lynx",function(t){t.cartesianAxis="cartesianAxis",t.cartesianBandAxis="cartesianAxis-band",t.cartesianLinearAxis="cartesianAxis-linear",t.cartesianTimeAxis="cartesianAxis-time",t.cartesianLogAxis="cartesianAxis-log",t.cartesianSymlogAxis="cartesianAxis-symlog",t.polarAxis="polarAxis",t.polarBandAxis="polarAxis-band",t.polarLinearAxis="polarAxis-linear",t.crosshair="crosshair",t.cartesianCrosshair="cartesianCrosshair",t.polarCrosshair="polarCrosshair",t.dataZoom="dataZoom",t.geoCoordinate="geoCoordinate",t.indicator="indicator",t.discreteLegend="discreteLegend",t.continuousLegend="continuousLegend",t.colorLegend="colorLegend",t.sizeLegend="sizeLegend",t.markLine="markLine",t.markArea="markArea",t.markPoint="markPoint",t.polarMarkLine="polarMarkLine",t.polarMarkArea="polarMarkArea",t.polarMarkPoint="polarMarkPoint",t.geoMarkPoint="geoMarkPoint",t.tooltip="tooltip",t.title="title",t.player="player",t.scrollBar="scrollBar",t.label="label",t.totalLabel="totalLabel",t.brush="brush",t.poptip="poptip",t.customMark="customMark"}(I||(I={}));var F={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,i="~";function n(){}function r(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function a(t,e,n,a,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new r(n,a||t,o),l=i?i+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],s]:t._events[l].push(s):(t._events[l]=s,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(i=!1)),s.prototype.eventNames=function(){var t,n,r=[];if(0===this._eventsCount)return r;for(n in t=this._events)e.call(t,n)&&r.push(i?n.slice(1):n);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},s.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,a=n.length,o=new Array(a);r<a;r++)o[r]=n[r].fn;return o},s.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},s.prototype.emit=function(t,e,n,r,a,o){var s=i?i+t:t;if(!this._events[s])return!1;var l,u,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,n),!0;case 4:return c.fn.call(c.context,e,n,r),!0;case 5:return c.fn.call(c.context,e,n,r,a),!0;case 6:return c.fn.call(c.context,e,n,r,a,o),!0}for(u=1,l=new Array(h-1);u<h;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var d,p=c.length;for(u=0;u<p;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),h){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,e);break;case 3:c[u].fn.call(c[u].context,e,n);break;case 4:c[u].fn.call(c[u].context,e,n,r);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(t,e,i){return a(this,t,e,i,!1)},s.prototype.once=function(t,e,i){return a(this,t,e,i,!0)},s.prototype.removeListener=function(t,e,n,r){var a=i?i+t:t;if(!this._events[a])return this;if(!e)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn!==e||r&&!s.once||n&&s.context!==n||o(this,a);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==e||r&&!s[l].once||n&&s[l].context!==n)&&u.push(s[l]);u.length?this._events[a]=1===u.length?u[0]:u:o(this,a)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&o(this,e)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=i,s.EventEmitter=s,t.exports=s}(F);var z=O(F.exports),H=function(t,e){return Object.prototype.toString.call(t)==="[object ".concat(e,"]")},N=function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"boolean"==typeof t:!0===t||!1===t||H(t,"Boolean")},V=function(t){return"function"==typeof t},j=function(t){return null==t},U=function(t){return null!=t},W=function(t){var e=k(t);return null!==t&&"object"===e||"function"===e},G=function(t){return"object"==k(t)&&null!==t},Y=function(t){if(!G(t)||!H(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},X=function(t){return void 0===t},K=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=k(t);return e?"string"===i:"string"===i||H(t,"String")},q=function(t){return Array.isArray?Array.isArray(t):H(t,"Array")},Z=function(t){return null!==t&&"function"!=typeof t&&Number.isFinite(t.length)},J=function(t){return H(t,"Date")},Q=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=k(t);return e?"number"===i:"number"===i||H(t,"Number")},$=function(t){return"string"==typeof t&&!isNaN(Number(t))&&!isNaN(parseFloat(t))},et=function(t){return Q(t)&&Number.isFinite(t)},it=function(t){return new RegExp(/^(http(s)?:\/\/)\w+[^\s]+(\.[^\s]+){1,}$/).test(t)},nt=function(t){return new RegExp(/^data:image\/(?:gif|png|jpeg|bmp|webp|svg\+xml)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/g).test(t)},rt=function(t){return{}.toString.call(t).replace(/^\[object /,"").replace(/]$/,"")},at=Object.prototype,ot=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||at)},st=Object.prototype.hasOwnProperty;function lt(t){if(j(t))return!0;if(Z(t))return!t.length;var e=rt(t);if("Map"===e||"Set"===e)return!t.size;if(ot(t))return!Object.keys(t).length;for(var i in t)if(st.call(t,i))return!1;return!0}var ut=function(t,e,i){for(var n=K(e)?e.split("."):e,r=0;r<n.length;r++)t=t?t[n[r]]:void 0;return void 0===t?i:t},ct=Object.prototype.hasOwnProperty,ht=function(t,e){return null!=t&&ct.call(t,e)};function dt(t,e,i){var n;if(!U(t)||"object"!=k(t)||e&&e(t))return t;var r=q(t),a=t.length;n=r?new Array(a):"object"==k(t)?{}:N(t)||Q(t)||K(t)?t:J(t)?new Date(+t):void 0;var o=r?void 0:Object.keys(Object(t)),s=-1;if(n)for(;++s<(o||t).length;){var l=o?o[s]:s,u=t[l];i&&i.includes(l.toString())?n[l]=u:n[l]=dt(u,e,i)}return n}function pt(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e){if(t===e)return;if(U(e)&&"object"==k(e)){var r=Object(e),a=[];for(var o in r)a.push(o);for(var s=a.length,l=-1;s--;){var u=a[++l];!U(r[u])||"object"!=k(r[u])||n&&q(t[u])?vt(t,u,r[u]):ft(t,e,u,i,n)}}}}function ft(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t[i],o=e[i],s=e[i],l=!0;if(q(o)){if(n)s=[];else if(q(a))s=a;else if(Z(a)){s=new Array(a.length);for(var u=-1,c=a.length;++u<c;)s[u]=a[u]}}else Y(o)?(s=null!=a?a:{},"function"!=typeof a&&"object"==k(a)||(s={})):l=!1;l&&pt(s,o,n,r),vt(t,i,s)}function vt(t,e,i){(void 0!==i&&!function(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}(t[e],i)||void 0===i&&!(e in t))&&(t[e]=i)}function gt(t){for(var e=-1,i=arguments.length<=1?0:arguments.length-1;++e<i;)pt(t,e+1<1||arguments.length<=e+1?void 0:arguments[e+1],!0);return t}function yt(t,e){if(!t||!Y(t))return t;var i={};return Object.keys(t).forEach((function(n){var r=t[n],a=!1;e.forEach((function(t){(K(t)&&t===n||t instanceof RegExp&&n.match(t))&&(a=!0)})),a||(i[n]=r)})),i}function mt(t){return Object.prototype.toString.call(t)}function _t(t){return Object.keys(t)}function bt(t,e,i){if(t===e)return!0;if(k(t)!=k(e))return!1;if(null==t||null==e)return!1;if(Number.isNaN(t)&&Number.isNaN(e))return!0;if(mt(t)!==mt(e))return!1;if(V(t))return!!(null==i?void 0:i.skipFunction);if("object"!=k(t))return!1;if(q(t)){if(t.length!==e.length)return!1;for(var n=t.length-1;n>=0;n--)if(!bt(t[n],e[n],i))return!1;return!0}if(!Y(t))return!1;var r=_t(t),a=_t(e);if(r.length!==a.length)return!1;r.sort(),a.sort();for(var o=r.length-1;o>=0;o--)if(r[o]!=a[o])return!1;for(var s=r.length-1;s>=0;s--){var l=r[s];if(!bt(t[l],e[l],i))return!1}return!0}function xt(t,e,i){for(var n=function(t){if(!t)return[];if(Object.keys)return Object.keys(t);var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e}(e),r=0;r<n.length;r++){var a=n[r];(i?null!=e[a]:null==t[a])&&(t[a]=e[a])}return t}function kt(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames)for(var n=Object.getOwnPropertyNames(e),r=0;r<n.length;r++){var a=n[r];"constructor"!==a&&(i?null!=e[a]:null==t[a])&&(t[a]=e[a])}else xt(t,e,i)}function St(t){return U(t)?q(t)?t:[t]:[]}function At(t){if(Z(t))return t[t.length-1]}var Mt=function(t,e){var i;if(0!==t.length){for(var n=t[0],r=1;r<t.length;r++){var a=t[r];(null!==(i=null==e?void 0:e(a,n))&&void 0!==i?i:a-n)>0&&(n=a)}return n}},Tt=function(t,e){var i;if(0!==t.length){for(var n=t[0],r=1;r<t.length;r++){var a=t[r];(null!==(i=null==e?void 0:e(a,n))&&void 0!==i?i:a-n)<0&&(n=a)}return n}};function wt(t,e){if(!q(t)||!q(e))return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function Ct(t){for(var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random,r=t.length;r;)e=Math.floor(n()*r),i=t[--r],t[r]=t[e],t[e]=i;return t}function Et(t){if(!q(t))return[t];var e,i=[],n=s(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;i.push.apply(i,b(Et(r)))}}catch(t){n.e(t)}finally{n.f()}return i}function Pt(t,e,i){U(e)||(e=t,t=0),U(i)||(i=1);for(var n=-1,r=0|Math.max(0,Math.ceil((e-t)/i)),a=new Array(r);++n<r;)a[n]=t+n*i;return a}function Bt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Rt(t){return Number(t)}var Lt,It="undefined"!=typeof console;function Dt(t,e,i){var n=[e].concat([].slice.call(i));It&&console[t].apply(console,n)}!function(t){t[t.None=0]="None",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Info=3]="Info",t[t.Debug=4]="Debug"}(Lt||(Lt={}));var Ot=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt.None,i=arguments.length>1?arguments[1]:void 0;r(this,t),this._onErrorHandler=[],this._level=e,this._method=i}return o(t,[{key:"addErrorHandler",value:function(t){this._onErrorHandler.find((function(e){return e===t}))||this._onErrorHandler.push(t)}},{key:"removeErrorHandler",value:function(t){var e=this._onErrorHandler.findIndex((function(e){return e===t}));e<0||this._onErrorHandler.splice(e,1)}},{key:"callErrorHandler",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this._onErrorHandler.forEach((function(t){return t.apply(void 0,e)}))}},{key:"canLogInfo",value:function(){return this._level>=Lt.Info}},{key:"canLogDebug",value:function(){return this._level>=Lt.Debug}},{key:"canLogError",value:function(){return this._level>=Lt.Error}},{key:"canLogWarn",value:function(){return this._level>=Lt.Warn}},{key:"level",value:function(t){return arguments.length?(this._level=+t,this):this._level}},{key:"error",value:function(){for(var t,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return this._level>=Lt.Error&&(this._onErrorHandler.length?this.callErrorHandler.apply(this,i):Dt(null!==(t=this._method)&&void 0!==t?t:"error","ERROR",i)),this}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this._level>=Lt.Warn&&Dt(this._method||"warn","WARN",e),this}},{key:"info",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this._level>=Lt.Info&&Dt(this._method||"log","INFO",e),this}},{key:"debug",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this._level>=Lt.Debug&&Dt(this._method||"log","DEBUG",e),this}}],[{key:"getInstance",value:function(e,i){return t._instance&&Q(e)?t._instance.level(e):t._instance||(t._instance=new t(e,i)),t._instance}},{key:"setInstance",value:function(e){return t._instance=e}},{key:"setInstanceLevel",value:function(e){t._instance?t._instance.level(e):t._instance=new t(e)}},{key:"clearInstance",value:function(){t._instance=null}}])}();function Ft(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0;for(j(n)&&(n=t.length);i<n;){var r=i+n>>>1;Bt(t[r],e)>0?n=r:i=r+1}return i}Ot._instance=null;var zt=function(t,e){return Ht(0,t.length,(function(i){return e(t[i])}))},Ht=function(t,e,i){for(var n=t,r=e;n<r;){var a=Math.floor((n+r)/2);i(a)>=0?r=a:n=a+1}return n},Nt=function(t,e){var i=t;return!0!==e&&(i=t.sort(Bt)),function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Rt,n=t.length;if(n){if(e<=0||n<2)return i(t[0],0,t);if(e>=1)return i(t[n-1],n-1,t);var r=(n-1)*e,a=Math.floor(r),o=i(t[a],a,t);return o+(i(t[a+1],a+1,t)-o)*(r-a)}}(i,.5)},Vt=1e-10,jt=1e-10;function Ut(t,e){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Vt,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:jt)*Math.max(t,e);return Math.abs(t-e)<=Math.max(i,n)}function Wt(t,e,i,n){return t>e&&!Ut(t,e,i,n)}function Gt(t,e,i,n){return t<e&&!Ut(t,e,i,n)}var Yt=function(t){var e=null,i=null;return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e&&r.every((function(t,i){return t===e[i]}))||(e=r,i=t.apply(void 0,r)),i}},Xt=function(t,e,i){return t<e?e:t>i?i:t},Kt=function(t,e,i){var n=m(t,2),r=n[0],a=n[1];a<r&&(r=t[1],a=t[0]);var o=a-r;return o>=i-e?[e,i]:[r=Math.min(Math.max(r,e),i-o),r+o]};function qt(t,e){var i;return t>e&&(i=t,t=e,e=i),function(i){return Math.max(t,Math.min(e,i))}}var Zt=!1;try{Zt="function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame}catch(t){Zt=!1}function Jt(t,e,i){var n,r,a,o,s,l,u=0,c=!1,h=!1,d=!0,p=!e&&0!==e&&Zt;if("function"!=typeof t)throw new TypeError("Expected a function");function f(e){var i=n,a=r;return n=r=void 0,u=e,o=t.apply(a,i)}function v(t,e){return p?(cancelAnimationFrame(s),requestAnimationFrame(t)):setTimeout(t,e)}function g(t){var i=t-l;return void 0===l||i>=e||i<0||h&&t-u>=a}function y(){var t=Date.now();if(g(t))return m(t);s=v(y,function(t){var i=t-u,n=e-(t-l);return h?Math.min(n,a-i):n}(t))}function m(t){return s=void 0,d&&n?f(t):(n=r=void 0,o)}function _(){for(var t=Date.now(),i=g(t),a=arguments.length,d=new Array(a),p=0;p<a;p++)d[p]=arguments[p];if(n=d,r=this,l=t,i){if(void 0===s)return function(t){return u=t,s=v(y,e),c?f(t):o}(l);if(h)return s=v(y,e),f(l)}return void 0===s&&(s=v(y,e)),o}return e=+e||0,W(i)&&(c=!!i.leading,(h="maxWait"in i)&&(a=Math.max(et(i.maxWait)?i.maxWait:0,e)),d="trailing"in i?!!i.trailing:d),_.cancel=function(){void 0!==s&&function(t){if(p)return cancelAnimationFrame(t);clearTimeout(t)}(s),u=0,n=l=r=s=void 0},_.flush=function(){return void 0===s?o:m(Date.now())},_.pending=function(){return void 0!==s},_}function Qt(t,e,i){var n=!0,r=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return W(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),Jt(t,e,{leading:n,trailing:r,maxWait:e})}function $t(t,e){return function(i){return t*(1-i)+e*i}}function te(t,e){return function(i){return Math.round(t*(1-i)+e*i)}}function ee(t){if(et(t))return t;var e=+t;return et(e)?e:0}function ie(t){return parseFloat("0."+Math.sin(t).toString().substring(6))}Zt=!1;var ne=4294967296;var re=function(t){return function(e){return ut(e,t)}},ae=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(V(t))return t;var i=[t];return(e&&e.get||re)(i)},oe=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(q(t)){var i=t.map((function(t){return ae(t,e)}));return function(t){return i.map((function(e){return e(t)}))}}return ae(t,e)},se=function(t){return t?"string"==typeof t||"number"==typeof t?function(){return t}:V(t)?t:function(e){return e[t.field]}:null},le=function(t,e){return j(t)?e:K(t)?e*parseFloat(t)/100:t},ue=function(t){return 0},ce=function(t,e){var i,n,r=V(e)?e:function(t){return t};if(t&&t.length){for(var a=t.length,o=0;o<a;o+=1){var s=r(t[o]);j(s)||!Q(s=+s)||Number.isNaN(s)||(j(i)?(i=s,n=s):(i=Math.min(i,s),n=Math.max(n,s)))}return[i,n]}return[i,n]};function he(t,e,i,n){var r,a,o=-1;t.forEach((function(t){r=e(t),a=i(t),!j(r)&&(r=+r)>=r&&!j(a)&&(a=+a)>=a&&n(r,a,++o)}))}function de(t,e,i,n,r){var a=0,o=0;return he(t,e,i,(function(t,e){var i=e-r(t),s=e-n;a+=i*i,o+=s*s})),1-a/o}function pe(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t.x},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.y},n=0,r=0,a=0,o=0,s=0;he(t,e,i,(function(t,e){++s,n+=(t-n)/s,r+=(e-r)/s,a+=(t*e-a)/s,o+=(t*t-o)/s}));var l,u,c,h,d,p=(u=r,c=a,h=o-(l=n)*l,d=Math.abs(h)<1e-24?0:(c-l*u)/h,[u-d*l,d]),f=function(t){return p[0]+p[1]*t};return{coef:p,predict:f,rSquared:de(t,e,i,r,f)}}var fe=1e-12,ve=Math.PI,ge=ve/2,ye=2*ve,me=2*Math.PI,_e=Math.abs,be=Math.atan2,xe=Math.cos,ke=Math.max,Se=Math.min,Ae=Math.sin,Me=Math.sqrt,Te=Math.pow;function we(t){return t>=1?ge:t<=-1?-ge:Math.asin(t)}function Ce(t,e,i,n,r){var a=i,o=n;return"number"==typeof t&&"number"==typeof i&&(a=(1-r)*t+r*i),"number"==typeof e&&"number"==typeof n&&(o=(1-r)*e+r*n),{x:a,y:o}}function Ee(t,e){return t[0]*e[1]-t[1]*e[0]}function Pe(t,e){for(var i=0,n=0;n<t.length;++n)i+=t[n]*e[n];return i}function Be(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return Math.round(t*e)/e}function Re(t){var e=t.toString().split(/[eE]/),i=(e[0].split(".")[1]||"").length-(+e[1]||0);return i>0?i:0}function Le(t,e){return Be(t+e,Math.pow(10,Math.max(Re(t),Re(e))))}function Ie(t,e){return Be(t-e,Math.pow(10,Math.max(Re(t),Re(e))))}var De=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;r(this,t),this.x=0,this.y=0,this.x=e,this.y=i,this.x1=n,this.y1=a}return o(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"copyFrom",value:function(t){return this.x=t.x,this.y=t.y,this.x1=t.x1,this.y1=t.y1,this.defined=t.defined,this.context=t.context,this}},{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"add",value:function(t){return Q(t)?(this.x+=t,void(this.y+=t)):(this.x+=t.x,this.y+=t.y,this)}},{key:"sub",value:function(t){return Q(t)?(this.x-=t,void(this.y-=t)):(this.x-=t.x,this.y-=t.y,this)}},{key:"multi",value:function(t){throw new Error("暂不支持")}},{key:"div",value:function(t){throw new Error("暂不支持")}}])}(),Oe=function(){return o((function t(){r(this,t)}),null,[{key:"distancePP",value:function(t,e){return Me(Te(t.x-e.x,2)+Te(t.y-e.y,2))}},{key:"distanceNN",value:function(t,e,i,n){return Me(Te(t-i,2)+Te(e-n,2))}},{key:"distancePN",value:function(t,e,i){return Me(Te(e-t.x,2)+Te(i-t.y,2))}},{key:"pointAtPP",value:function(t,e,i){return new De((e.x-t.x)*i+t.x,(e.y-t.y)*i+t.y)}}])}();function Fe(t){return t*(Math.PI/180)}function ze(t){return 180*t/Math.PI}var He,Ne=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(t<0)for(;t<-ye;)t+=ye;else if(t>0)for(;t>ye;)t-=ye;return t};function Ve(t,e,i){return e?{x:t.x+e*Math.cos(i),y:t.y+e*Math.sin(i)}:{x:t.x,y:t.y}}function je(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI,r=t.x,a=t.y,o=r-e.x,s=a-e.y,l=Math.sqrt(o*o+s*s);if(0===l)return{radius:0,angle:0};o/=l,s/=l;var u=Math.atan2(s,o);if(u<i)for(;u<=i;)u+=2*Math.PI;if(u>n)for(;u>=n;)u-=2*Math.PI;return{radius:l,angle:u}}function Ue(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function We(t){for(;t<0;)t+=2*Math.PI;for(;t>=2*Math.PI;)t-=2*Math.PI;return t}function Ge(t,e,i,n){var r=e.x,a=e.y,o=function(t,e){var i=Math.abs(e-t);if(i>=2*Math.PI||2*Math.PI-i<1e-6)return[0,Math.PI/2,Math.PI,1.5*Math.PI];for(var n=We(Math.min(t,e)),r=n+i,a=[n,r],o=Math.floor(n/Math.PI)*Math.PI/2;o<r;)o>n&&a.push(o),o+=Math.PI/2;return a}(i,n),s=t.width,l=t.height,u=[];return o.forEach((function(t){var e=Math.sin(t),i=Math.cos(t);1===e?u.push(l-a):-1===e?u.push(a):1===i?u.push(s-r):-1===i?u.push(r):(e>0?u.push(Math.abs((l-a)/e)):u.push(Math.abs(a/e)),i>0?u.push(Math.abs((s-r)/i)):u.push(Math.abs(r/i)))})),Math.min.apply(null,u)}function Ye(t){return(t=We(t))>0&&t<=Math.PI/2?2:t>Math.PI/2&&t<=Math.PI?3:t>Math.PI&&t<=3*Math.PI/2?4:1}function Xe(t,e,i){t[0]=e[0]-i[0],t[1]=e[1]-i[1]}function Ke(t,e,i,n){var r,a,o,s,l=t[0],u=e[0],c=i[0],h=n[0];return u<l&&(l=(r=[u,l])[0],u=r[1]),h<c&&(h=(a=[c,h])[0],c=a[1]),!(u<c||h<l||(l=t[1],u=e[1],c=i[1],h=n[1],u<l&&(o=[u,l],l=o[0],u=o[1]),h<c&&(s=[c,h],h=s[0],c=s[1]),u<c||h<l))}function qe(t,e,i,n){if(!Ke(t,e,i,n))return!1;var r=[0,0],a=[0,0],o=[0,0];if(Xe(r,e,t),Xe(a,n,i),function(t,e){return _e(t[0]-e[0])+_e(t[1]-e[1])<1e-12}(r,a))return!0;Xe(o,i,t);var s=Ee(o,a)/Ee(r,a);return s>=0&&s<=1&&[t[0]+r[0]*s,t[1]+r[1]*s]}function Ze(t,e,i){if(null===t)return e;if(null===e)return t;var n=Je(t,e,i),r=n.x11,a=n.x12,o=n.y11,s=n.y12,l=n.x21,u=n.x22,c=n.y21,h=n.y22;return r>=u||a<=l||o>=h||s<=c?{x1:0,y1:0,x2:0,y2:0}:{x1:Math.max(r,l),y1:Math.max(o,c),x2:Math.min(a,u),y2:Math.min(s,h)}}!function(t){t[t.NONE=0]="NONE",t[t.BBOX1=1]="BBOX1",t[t.BBOX2=2]="BBOX2"}(He||(He={}));var Je=function(t,e,i){var n,r,a,o,s=t.x1,l=t.x2,u=t.y1,c=t.y2,h=e.x1,d=e.x2,p=e.y1,f=e.y2;return i&&(s>l&&(s=(n=[l,s])[0],l=n[1]),u>c&&(u=(r=[c,u])[0],c=r[1]),h>d&&(h=(a=[d,h])[0],d=a[1]),p>f&&(p=(o=[f,p])[0],f=o[1])),{x11:s,x12:l,y11:u,y12:c,x21:h,x22:d,y21:p,y22:f}};function Qe(t,e,i){if(!t||!e)return He.NONE;var n=Je(t,e,i),r=n.x11,a=n.x12,o=n.y11,s=n.y12,l=n.x21,u=n.x22,c=n.y21,h=n.y22;return r>l&&a<u&&o>c&&s<h?He.BBOX1:l>r&&u<a&&c>o&&h<s?He.BBOX2:He.NONE}function $e(t,e,i){if(t&&e){if(!i)return!(t.x1>e.x2||t.x2<e.x1||t.y1>e.y2||t.y2<e.y1);var n=Je(t,e,!0),r=n.x11,a=n.x12,o=n.y11,s=n.y12,l=n.x21,u=n.x22,c=n.y21,h=n.y22;return!(r>u||a<l||o>h||s<c)}return!0}function ti(t,e,i){var n,r;if(!e)return!0;if(!i)return t.x>=e.x1&&t.x<=e.x2&&t.y>=e.y1&&t.y<=e.y2;var a=e.x1,o=e.x2,s=e.y1,l=e.y2;return a>o&&(a=(n=[o,a])[0],o=n[1]),s>l&&(s=(r=[l,s])[0],l=r[1]),t.x>=a&&t.x<=o&&t.y>=s&&t.y<=l}function ei(t,e){return Math.abs(e[0]*t[0]+e[1]*t[1])}function ii(t,e){var i=t.x,n=t.y,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};return{x:(i-r.x)*Math.cos(e)-(n-r.y)*Math.sin(e)+r.x,y:(i-r.x)*Math.sin(e)+(n-r.y)*Math.cos(e)+r.y}}function ni(t){return{x:(t.x1+t.x2)/2,y:(t.y1+t.y2)/2}}function ri(t,e){var i=e?Fe(t.angle):t.angle,n=ni(t);return[ii({x:t.x1,y:t.y1},i,n),ii({x:t.x2,y:t.y1},i,n),ii({x:t.x2,y:t.y2},i,n),ii({x:t.x1,y:t.y2},i,n)]}function ai(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=ri(t,i),r=ri(e,i),a=function(t,e){return[e.x-t.x,e.y-t.y]},o=a(ni(t),ni(e)),s=a(n[0],n[1]),l=a(n[1],n[2]),u=a(r[0],r[1]),c=a(r[1],r[2]),h=i?Fe(t.angle):t.angle,d=i?Fe(90-t.angle):t.angle+ge,p=i?Fe(e.angle):e.angle,f=i?Fe(90-e.angle):e.angle+ge;d>me&&(d-=me),f>me&&(f-=me);var v=function(t,e,i,n){var r=[Math.cos(e),Math.sin(e)];return t+(ei(r,i)+ei(r,n))/2>ei(r,o)};return v((t.x2-t.x1)/2,h,u,c)&&v((t.y2-t.y1)/2,d,u,c)&&v((e.x2-e.x1)/2,p,s,l)&&v((e.y2-e.y1)/2,f,s,l)}var oi=1e-8;function si(t,e,i,n,r){for(var a=0,o=r[r.length-1];a<r.length;a++){var s=r[a];if(Ke([t,e],[i,n],[s.x,s.y],[o.x,o.y]))return!0;o=s}return!1}function li(t,e,i){var n=0,r=t[0];if(!r)return!1;for(var a=1;a<t.length;a++){var o=t[a];n+=ui(r.x,r.y,o.x,o.y,e,i),r=o}var s=t[0];return ci(r.x,s.x)&&ci(r.y,s.y)||(n+=ui(r.x,r.y,s.x,s.y,e,i)),0!==n}function ui(t,e,i,n,r,a){if(a>e&&a>n||a<e&&a<n)return 0;if(n===e)return 0;var o=(a-e)/(n-e),s=n<e?1:-1;1!==o&&0!==o||(s=n<e?.5:-.5);var l=o*(i-t)+t;return l===r?1/0:l>r?s:0}function ci(t,e){return Math.abs(t-e)<oi}var hi=function(t){var e=t.charCodeAt(0),i=2===t.length?t.charCodeAt(1):0,n=e;return 55296<=e&&e<=56319&&56320<=i&&i<=57343&&(n=(e&=1023)<<10|(i&=1023),n+=65536),12288===n||65281<=n&&n<=65376||65504<=n&&n<=65510?"F":8361===n||65377<=n&&n<=65470||65474<=n&&n<=65479||65482<=n&&n<=65487||65490<=n&&n<=65495||65498<=n&&n<=65500||65512<=n&&n<=65518?"H":4352<=n&&n<=4447||4515<=n&&n<=4519||4602<=n&&n<=4607||9001<=n&&n<=9002||11904<=n&&n<=11929||11931<=n&&n<=12019||12032<=n&&n<=12245||12272<=n&&n<=12283||12289<=n&&n<=12350||12353<=n&&n<=12438||12441<=n&&n<=12543||12549<=n&&n<=12589||12593<=n&&n<=12686||12688<=n&&n<=12730||12736<=n&&n<=12771||12784<=n&&n<=12830||12832<=n&&n<=12871||12880<=n&&n<=13054||13056<=n&&n<=19903||19968<=n&&n<=42124||42128<=n&&n<=42182||43360<=n&&n<=43388||44032<=n&&n<=55203||55216<=n&&n<=55238||55243<=n&&n<=55291||63744<=n&&n<=64255||65040<=n&&n<=65049||65072<=n&&n<=65106||65108<=n&&n<=65126||65128<=n&&n<=65131||110592<=n&&n<=110593||127488<=n&&n<=127490||127504<=n&&n<=127546||127552<=n&&n<=127560||127568<=n&&n<=127569||131072<=n&&n<=194367||177984<=n&&n<=196605||196608<=n&&n<=262141?"W":32<=n&&n<=126||162<=n&&n<=163||165<=n&&n<=166||172===n||175===n||10214<=n&&n<=10221||10629<=n&&n<=10630?"Na":161===n||164===n||167<=n&&n<=168||170===n||173<=n&&n<=174||176<=n&&n<=180||182<=n&&n<=186||188<=n&&n<=191||198===n||208===n||215<=n&&n<=216||222<=n&&n<=225||230===n||232<=n&&n<=234||236<=n&&n<=237||240===n||242<=n&&n<=243||247<=n&&n<=250||252===n||254===n||257===n||273===n||275===n||283===n||294<=n&&n<=295||299===n||305<=n&&n<=307||312===n||319<=n&&n<=322||324===n||328<=n&&n<=331||333===n||338<=n&&n<=339||358<=n&&n<=359||363===n||462===n||464===n||466===n||468===n||470===n||472===n||474===n||476===n||593===n||609===n||708===n||711===n||713<=n&&n<=715||717===n||720===n||728<=n&&n<=731||733===n||735===n||768<=n&&n<=879||913<=n&&n<=929||931<=n&&n<=937||945<=n&&n<=961||963<=n&&n<=969||1025===n||1040<=n&&n<=1103||1105===n||8208===n||8211<=n&&n<=8214||8216<=n&&n<=8217||8220<=n&&n<=8221||8224<=n&&n<=8226||8228<=n&&n<=8231||8240===n||8242<=n&&n<=8243||8245===n||8251===n||8254===n||8308===n||8319===n||8321<=n&&n<=8324||8364===n||8451===n||8453===n||8457===n||8467===n||8470===n||8481<=n&&n<=8482||8486===n||8491===n||8531<=n&&n<=8532||8539<=n&&n<=8542||8544<=n&&n<=8555||8560<=n&&n<=8569||8585===n||8592<=n&&n<=8601||8632<=n&&n<=8633||8658===n||8660===n||8679===n||8704===n||8706<=n&&n<=8707||8711<=n&&n<=8712||8715===n||8719===n||8721===n||8725===n||8730===n||8733<=n&&n<=8736||8739===n||8741===n||8743<=n&&n<=8748||8750===n||8756<=n&&n<=8759||8764<=n&&n<=8765||8776===n||8780===n||8786===n||8800<=n&&n<=8801||8804<=n&&n<=8807||8810<=n&&n<=8811||8814<=n&&n<=8815||8834<=n&&n<=8835||8838<=n&&n<=8839||8853===n||8857===n||8869===n||8895===n||8978===n||9312<=n&&n<=9449||9451<=n&&n<=9547||9552<=n&&n<=9587||9600<=n&&n<=9615||9618<=n&&n<=9621||9632<=n&&n<=9633||9635<=n&&n<=9641||9650<=n&&n<=9651||9654<=n&&n<=9655||9660<=n&&n<=9661||9664<=n&&n<=9665||9670<=n&&n<=9672||9675===n||9678<=n&&n<=9681||9698<=n&&n<=9701||9711===n||9733<=n&&n<=9734||9737===n||9742<=n&&n<=9743||9748<=n&&n<=9749||9756===n||9758===n||9792===n||9794===n||9824<=n&&n<=9825||9827<=n&&n<=9829||9831<=n&&n<=9834||9836<=n&&n<=9837||9839===n||9886<=n&&n<=9887||9918<=n&&n<=9919||9924<=n&&n<=9933||9935<=n&&n<=9953||9955===n||9960<=n&&n<=9983||10045===n||10071===n||10102<=n&&n<=10111||11093<=n&&n<=11097||12872<=n&&n<=12879||57344<=n&&n<=63743||65024<=n&&n<=65039||65533===n||127232<=n&&n<=127242||127248<=n&&n<=127277||127280<=n&&n<=127337||127344<=n&&n<=127386||917760<=n&&n<=917999||983040<=n&&n<=1048573||1048576<=n&&n<=1114109?"A":"N"};function di(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;i||(i=1);var n=t.fontStyle,r=void 0===n?e.fontStyle:n,a=t.fontVariant,o=void 0===a?e.fontVariant:a,s=t.fontWeight,l=void 0===s?e.fontWeight:s,u=t.fontSize,c=void 0===u?e.fontSize:u,h=t.fontFamily;return(r?r+" ":"")+(o?o+" ":"")+(l?l+" ":"")+c*i+"px "+((void 0===h?e.fontFamily:h)||"sans-serif")}var pi=function(){function t(e,i){r(this,t),this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet="-/: .,@%'\"~",this._option=e,this._userSpec=null!=i?i:{},this.textSpec=this._initSpec(),U(e.specialCharSet)&&(this.specialCharSet=e.specialCharSet),this._standardMethod=U(e.getTextBounds)?this.fullMeasure.bind(this):this.measureWithNaiveCanvas.bind(this)}return o(t,[{key:"initContext",value:function(){if(this._notSupportCanvas)return!1;if(j(this._canvas)&&(U(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),j(this._canvas)&&"undefined"!=typeof window&&void 0!==window.document&&globalThis&&U(globalThis.document)&&(this._canvas=globalThis.document.createElement("canvas"))),j(this._context)&&U(this._canvas)){var t=this._canvas.getContext("2d");U(t)&&(t.save(),t.font=di(this.textSpec),this._contextSaved=!0,this._context=t)}return!j(this._context)||(this._notSupportCanvas=!0,!1)}},{key:"_initSpec",value:function(){var t,e,i,n=this._option.defaultFontParams,r=void 0===n?{}:n,a=this._userSpec,o=a.fontStyle,s=void 0===o?r.fontStyle:o,l=a.fontVariant,u=void 0===l?r.fontVariant:l,c=a.fontWeight,h=void 0===c?null!==(t=r.fontWeight)&&void 0!==t?t:"normal":c,d=a.fontSize,p=void 0===d?null!==(e=r.fontSize)&&void 0!==e?e:12:d,f=a.fontFamily,v=void 0===f?null!==(i=r.fontFamily)&&void 0!==i?i:"sans-serif":f,g=a.align,y=a.textAlign,m=void 0===y?null!=g?g:"center":y,_=a.baseline,b=a.textBaseline,x=void 0===b?null!=_?_:"middle":b,k=a.ellipsis,S=a.limit,A=this._userSpec.lineHeight,M=void 0===A?p:A;if(K(M)&&"%"===M[M.length-1]){var T=Number.parseFloat(M.substring(0,M.length-1))/100;M=p*T}return{fontStyle:s,fontVariant:u,fontFamily:v,fontSize:p,fontWeight:h,textAlign:m,textBaseline:x,ellipsis:k,limit:S,lineHeight:M}}},{key:"measure",value:function(t,e){switch(e){case"vrender":case"canopus":return this.fullMeasure(t);case"canvas":return this.measureWithNaiveCanvas(t);case"simple":return this.quickMeasureWithoutCanvas(t);default:return this.quickMeasure(t)}}},{key:"fullMeasure",value:function(t){if(j(t))return{width:0,height:0};if(j(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(t);var e,i=this.textSpec,n=i.fontFamily,r=i.fontSize,a=i.fontWeight,o=i.textAlign,s=i.textBaseline,l=i.ellipsis,u=i.limit,c=i.lineHeight;try{var h=this._option.getTextBounds({text:t,fontFamily:n,fontSize:r,fontWeight:a,textAlign:o,textBaseline:s,ellipsis:!!l,maxLineWidth:u||1/0,lineHeight:c});e={width:h.width(),height:h.height()}}catch(i){this._notSupportVRender=!0,e=this.measureWithNaiveCanvas(t)}return e}},{key:"measureWithNaiveCanvas",value:function(t){return this._measureReduce(t,this._measureWithNaiveCanvas.bind(this))}},{key:"_measureWithNaiveCanvas",value:function(t){var e;if(!this.initContext())return this._quickMeasureWithoutCanvas(t);var i=this._context.measureText(t),n=this.textSpec,r=n.fontSize,a=n.lineHeight;return{width:i.width,height:null!==(e=a)&&void 0!==e?e:r,fontBoundingBoxAscent:i.fontBoundingBoxAscent,fontBoundingBoxDescent:i.fontBoundingBoxDescent}}},{key:"quickMeasure",value:function(t){return this._measureReduce(t,this._quickMeasure.bind(this))}},{key:"_quickMeasure",value:function(e){for(var i={width:0,height:0},n=0;n<e.length;n++){var r=e[n],a=this._measureSpecialChar(r);j(a)&&t.NUMBERS_CHAR_SET.includes(r)&&(a=this._measureNumberChar()),j(a)&&["F","W"].includes(hi(r))&&(a=this._measureFullSizeChar()),j(a)&&(a=this._measureLetterChar()),i.width+=a.width,i.height=Math.max(i.height,a.height),!j(a.fontBoundingBoxAscent)&&(i.fontBoundingBoxAscent=a.fontBoundingBoxAscent),!j(a.fontBoundingBoxDescent)&&(i.fontBoundingBoxDescent=a.fontBoundingBoxDescent)}return i}},{key:"quickMeasureWithoutCanvas",value:function(t){return this._measureReduce(t,this._quickMeasureWithoutCanvas.bind(this))}},{key:"_quickMeasureWithoutCanvas",value:function(t){for(var e,i={width:0,height:0},n=this.textSpec,r=n.fontSize,a=n.lineHeight,o=0;o<t.length;o++){var s=t[o],l=["F","W"].includes(hi(s))?1:.53;i.width+=l*r}return i.height=null!==(e=a)&&void 0!==e?e:r,i}},{key:"_measureReduce",value:function(t,e){var i,n=this.textSpec,r=n.fontSize,a=n.lineHeight,o={width:0,height:0};if(j(t))return o;if(q(t)){var s=t.filter(U).map((function(t){return t.toString()}));return 0===s.length?o:1===s.length?e(s[0]):{width:s.reduce((function(t,i){return Math.max(t,e(i).width)}),0),height:s.length*((null!==(i=a)&&void 0!==i?i:r)+1)+1}}return e(t.toString())}},{key:"_measureNumberChar",value:function(){if(j(this._numberCharSize)){var e=this._standardMethod(t.NUMBERS_CHAR_SET);this._numberCharSize={width:e.width/t.NUMBERS_CHAR_SET.length,height:e.height,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}return this._numberCharSize}},{key:"_measureFullSizeChar",value:function(){return j(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(t.FULL_SIZE_CHAR)),this._fullCharSize}},{key:"_measureLetterChar",value:function(){if(j(this._letterCharSize)){var e=this._standardMethod(t.ALPHABET_CHAR_SET);this._letterCharSize={width:e.width/t.ALPHABET_CHAR_SET.length,height:e.height,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}return this._letterCharSize}},{key:"_measureSpecialChar",value:function(t){return U(this._specialCharSizeMap[t])?this._specialCharSizeMap[t]:this.specialCharSet.includes(t)?(this._specialCharSizeMap[t]=this._standardMethod(t),this._specialCharSizeMap[t]):null}},{key:"release",value:function(){U(this._canvas)&&(this._canvas=null),U(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}}])}();pi.ALPHABET_CHAR_SET="abcdefghijklmnopqrstuvwxyz",pi.NUMBERS_CHAR_SET="0123456789",pi.FULL_SIZE_CHAR="字";var fi=function(t,e){var i=t.x1,n=t.x2,r=t.y1,a=t.y2,o=Math.abs(n-i),s=Math.abs(a-r),l=(i+n)/2,u=(r+a)/2,c=0,h=0;switch(e){case"top":case"inside-top":h=-.5;break;case"bottom":case"inside-bottom":h=.5;break;case"left":case"inside-left":c=-.5;break;case"right":case"inside-right":c=.5;break;case"top-right":c=.5,h=-.5;break;case"top-left":c=-.5,h=-.5;break;case"bottom-right":c=.5,h=.5;break;case"bottom-left":c=-.5,h=.5}return{x:l+=c*o,y:u+=h*s}},vi=function(t,e){return Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2)},gi=function(t,e){function i(t,e,i){var n=t.getRotatedCorners().map((function(t){return t.x*e+t.y*i}));return{min:Math.min.apply(Math,b(n)),max:Math.max.apply(Math,b(n))}}for(var n=0,r=0,a=[{x:Math.cos(t.angle),y:Math.sin(t.angle)},{x:-Math.sin(t.angle),y:Math.cos(t.angle)},{x:Math.cos(e.angle),y:Math.sin(t.angle)},{x:-Math.sin(e.angle),y:Math.cos(t.angle)}];r<a.length;r++){var o,s=a[r],l=i(t,s.x,s.y),u=i(e,s.x,s.y);o=l.max<u.min?u.min-l.max:u.max<l.min?l.min-u.max:0,n=Math.max(n,o)}return n};function yi(t,e,i){var n=e.x1,r=e.y1,a=e.x2,o=e.y2;return i.onlyTranslate()?(t!==e&&t.setValue(e.x1,e.y1,e.x2,e.y2),t.translate(i.e,i.f),e):(t.clear(),t.add(i.a*n+i.c*r+i.e,i.b*n+i.d*r+i.f),t.add(i.a*a+i.c*r+i.e,i.b*a+i.d*r+i.f),t.add(i.a*a+i.c*o+i.e,i.b*a+i.d*o+i.f),t.add(i.a*n+i.c*o+i.e,i.b*n+i.d*o+i.f),e)}var mi=function(){function t(e){r(this,t),e?this.setValue(e.x1,e.y1,e.x2,e.y2):this.clear()}return o(t,[{key:"clone",value:function(){return new t(this)}},{key:"clear",value:function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}},{key:"empty",value:function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}},{key:"equals",value:function(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}},{key:"setValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.x1=t,this.y1=e,this.x2=i,this.y2=n,this}},{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),n<e?(this.y2=e,this.y1=n):(this.y1=e,this.y2=n),this}},{key:"add",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}},{key:"expand",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return q(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}},{key:"round",value:function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}},{key:"translate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}},{key:"rotate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.rotatedPoints(t,e,i);return this.clear().add(n[0],n[1]).add(n[2],n[3]).add(n[4],n[5]).add(n[6],n[7])}},{key:"scale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=this.scalePoints(t,e,i,n);return this.clear().add(r[0],r[1]).add(r[2],r[3])}},{key:"union",value:function(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}},{key:"intersect",value:function(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}},{key:"encloses",value:function(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}},{key:"alignsWith",value:function(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}},{key:"intersects",value:function(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}},{key:"contains",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}},{key:"containsPoint",value:function(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}},{key:"width",value:function(){return this.empty()?0:this.x2-this.x1}},{key:"height",value:function(){return this.empty()?0:this.y2-this.y1}},{key:"scaleX",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.x1*=t,this.x2*=t,this}},{key:"scaleY",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.y1*=t,this.y2*=t,this}},{key:"transformWithMatrix",value:function(t){return yi(this,this,t),this}},{key:"copy",value:function(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}},{key:"rotatedPoints",value:function(t,e,i){var n=this.x1,r=this.y1,a=this.x2,o=this.y2,s=Math.cos(t),l=Math.sin(t),u=e-e*s+i*l,c=i-e*l-i*s;return[s*n-l*r+u,l*n+s*r+c,s*n-l*o+u,l*n+s*o+c,s*a-l*r+u,l*a+s*r+c,s*a-l*o+u,l*a+s*o+c]}},{key:"scalePoints",value:function(t,e,i,n){return[t*this.x1+(1-t)*i,e*this.y1+(1-e)*n,t*this.x2+(1-t)*i,e*this.y2+(1-e)*n]}}])}(),_i=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e)}(mi),bi=function(t){function e(t){var i,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return r(this,e),i=n(this,e,[t]),t&&(i.angle=null!==(a=t.angle)&&void 0!==a?a:o),i}return h(e,t),o(e,[{key:"intersects",value:function(t){return ai(this,t)}},{key:"setValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return _(e,"setValue",this,3)([t,i,n,r]),this.angle=a,this}},{key:"clone",value:function(){return new e(this)}},{key:"getRotatedCorners",value:function(){var t={x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2};return[ii({x:this.x1,y:this.y1},this.angle,t),ii({x:this.x2,y:this.y1},this.angle,t),ii({x:this.x1,y:this.y2},this.angle,t),ii({x:this.x2,y:this.y2},this.angle,t)]}}])}(mi),xi=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;r(this,t),this.a=e,this.b=i,this.c=n,this.d=a,this.e=o,this.f=s}return o(t,[{key:"equalToMatrix",value:function(t){return!(this.e!==t.e||this.f!==t.f||this.a!==t.a||this.d!==t.d||this.b!==t.b||this.c!==t.c)}},{key:"equalTo",value:function(t,e,i,n,r,a){return!(this.e!==r||this.f!==a||this.a!==t||this.d!==n||this.b!==e||this.c!==i)}},{key:"setValue",value:function(t,e,i,n,r,a){return this.a=t,this.b=e,this.c=i,this.d=n,this.e=r,this.f=a,this}},{key:"reset",value:function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}},{key:"getInverse",value:function(){var e=this.a,i=this.b,n=this.c,r=this.d,a=this.e,o=this.f,s=new t,l=e*r-i*n;return s.a=r/l,s.b=-i/l,s.c=-n/l,s.d=e/l,s.e=(n*o-r*a)/l,s.f=-(e*o-i*a)/l,s}},{key:"rotate",value:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a*e+this.c*i,r=this.b*e+this.d*i,a=this.a*-i+this.c*e,o=this.b*-i+this.d*e;return this.a=n,this.b=r,this.c=a,this.d=o,this}},{key:"rotateByCenter",value:function(t,e,i){var n=Math.cos(t),r=Math.sin(t),a=(1-n)*e+r*i,o=(1-n)*i-r*e,s=n*this.a-r*this.b,l=r*this.a+n*this.b,u=n*this.c-r*this.d,c=r*this.c+n*this.d,h=n*this.e-r*this.f+a,d=r*this.e+n*this.f+o;return this.a=s,this.b=l,this.c=u,this.d=c,this.e=h,this.f=d,this}},{key:"scale",value:function(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this}},{key:"setScale",value:function(t,e){return this.b=this.b/this.a*t,this.c=this.c/this.d*e,this.a=t,this.d=e,this}},{key:"transform",value:function(t,e,i,n,r,a){return this.multiply(t,e,i,n,r,a),this}},{key:"translate",value:function(t,e){return this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e,this}},{key:"transpose",value:function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=this.e,a=this.f;return this.a=e,this.b=t,this.c=n,this.d=i,this.e=a,this.f=r,this}},{key:"multiply",value:function(t,e,i,n,r,a){var o=this.a,s=this.b,l=this.c,u=this.d,c=o*t+l*e,h=s*t+u*e,d=o*i+l*n,p=s*i+u*n,f=o*r+l*a+this.e,v=s*r+u*a+this.f;return this.a=c,this.b=h,this.c=d,this.d=p,this.e=f,this.f=v,this}},{key:"interpolate",value:function(e,i){var n=new t;return n.a=this.a+(e.a-this.a)*i,n.b=this.b+(e.b-this.b)*i,n.c=this.c+(e.c-this.c)*i,n.d=this.d+(e.d-this.d)*i,n.e=this.e+(e.e-this.e)*i,n.f=this.f+(e.f-this.f)*i,n}},{key:"transformPoint",value:function(t,e){var i=this.a,n=this.b,r=this.c,a=this.d,o=this.e,s=this.f,l=i*a-n*r,u=a/l,c=-n/l,h=-r/l,d=i/l,p=(r*s-a*o)/l,f=-(i*s-n*o)/l,v=t.x,g=t.y;e.x=v*u+g*h+p,e.y=v*c+g*d+f}},{key:"onlyTranslate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.a===t&&0===this.b&&0===this.c&&this.d===t}},{key:"clone",value:function(){return new t(this.a,this.b,this.c,this.d,this.e,this.f)}},{key:"toTransformAttrs",value:function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=t*n-e*i,a={x:this.e,y:this.f,rotateDeg:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!==t||0!==e){var o=Math.sqrt(t*t+e*e);a.rotateDeg=e>0?Math.acos(t/o):-Math.acos(t/o),a.scaleX=o,a.scaleY=r/o,a.skewX=(t*i+e*n)/r,a.skewY=0}else if(0!==i||0!==n){var s=Math.sqrt(i*i+n*n);a.rotateDeg=Math.PI/2-(n>0?Math.acos(-i/s):-Math.acos(i/s)),a.scaleX=r/s,a.scaleY=s,a.skewX=0,a.skewY=(t*i+e*n)/r}return a.rotateDeg=ze(a.rotateDeg),a}}])}();var ki=function(){return o((function t(){r(this,t),this.CLEAN_THRESHOLD=1e3,this.L_TIME=1e3,this.R_COUNT=1,this.R_TIMESTAMP_MAX_SIZE=20}),[{key:"clearCache",value:function(t,e){var i=e.CLEAN_THRESHOLD,n=void 0===i?this.CLEAN_THRESHOLD:i,r=e.L_TIME,a=void 0===r?this.L_TIME:r,o=e.R_COUNT,s=void 0===o?this.R_COUNT:o;if(t.size<n)return 0;var l=0,u=function(e){l++,t.delete(e)},c=Date.now();return t.forEach((function(t,e){if(t.timestamp.length<s)return u(e);for(var i=0;c-t.timestamp[t.timestamp.length-1-i]<a&&!(++i>=s););if(i<s)return u(e);for(;c-t.timestamp[0]>a;)t.timestamp.shift()})),l}},{key:"addLimitedTimestamp",value:function(t,e,i){var n=i.R_TIMESTAMP_MAX_SIZE,r=void 0===n?this.R_TIMESTAMP_MAX_SIZE:n;t.timestamp.length>r&&t.timestamp.shift(),t.timestamp.push(e)}},{key:"clearTimeStamp",value:function(t,e){var i=e.L_TIME,n=void 0===i?this.L_TIME:i,r=Date.now();t.forEach((function(t){for(;r-t.timestamp[0]>n;)t.timestamp.shift()}))}},{key:"clearItemTimestamp",value:function(t,e){for(var i=e.L_TIME,n=void 0===i?this.L_TIME:i,r=Date.now();r-t.timestamp[0]>n;)t.timestamp.shift()}}])}();function Si(t,e,i){e/=100,i/=100;var n=(1-Math.abs(2*i-1))*e,r=n*(1-Math.abs(t/60%2-1)),a=i-n/2,o=0,s=0,l=0;return 0<=t&&t<60?(o=n,s=r,l=0):60<=t&&t<120?(o=r,s=n,l=0):120<=t&&t<180?(o=0,s=n,l=r):180<=t&&t<240?(o=0,s=r,l=n):240<=t&&t<300?(o=r,s=0,l=n):300<=t&&t<360&&(o=n,s=0,l=r),{r:o=Math.round(255*(o+a)),g:s=Math.round(255*(s+a)),b:l=Math.round(255*(l+a))}}function Ai(t,e,i){t/=255,e/=255,i/=255;var n=Math.min(t,e,i),r=Math.max(t,e,i),a=r-n,o=0,s=0;return o=0===a?0:r===t?(e-i)/a%6:r===e?(i-t)/a+2:(t-e)/a+4,(o=Math.round(60*o))<0&&(o+=360),s=(r+n)/2,{h:o,s:+(100*(0===a?0:a/(1-Math.abs(2*s-1)))).toFixed(1),l:s=+(100*s).toFixed(1)}}var Mi=/^#([0-9a-f]{3,8})$/,Ti={transparent:4294967040},wi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ci(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Ei(t){return Q(t)?new Ii(t>>16,t>>8&255,255&t,1):q(t)?new Ii(t[0],t[1],t[2]):new Ii(255,255,255)}function Pi(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Bi(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}var Ri=function(t,e){var i=Mi.exec(t);if(e||i){var n=parseInt(i[1],16),r=i[1].length;return 3===r?new Ii((n>>8&15)+((n>>8&15)<<4),(n>>4&15)+((n>>4&15)<<4),(15&n)+((15&n)<<4),1):6===r?Ei(n):8===r?new Ii(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):null}},Li=function(){function t(e){r(this,t);var i=t.parseColorString(e);i?this.color=i:(console.warn("Warn: 传入".concat(e,"无法解析为Color")),this.color=new Ii(255,255,255))}return o(t,[{key:"toRGBA",value:function(){return this.color.formatRgb()}},{key:"toString",value:function(){return this.color.formatRgb()}},{key:"toHex",value:function(){return this.color.formatHex()}},{key:"toHsl",value:function(){return this.color.formatHsl()}},{key:"brighter",value:function(t){var e=this.color,i=e.r,n=e.g,r=e.b;return this.color.r=Math.max(0,Math.min(255,Math.floor(i*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(n*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t))),this}},{key:"add",value:function(t){var e=this.color,i=e.r,n=e.g,r=e.b;return this.color.r+=Math.min(255,i+t.color.r),this.color.g+=Math.min(255,n+t.color.g),this.color.b+=Math.min(255,r+t.color.b),this}},{key:"sub",value:function(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}},{key:"multiply",value:function(t){var e=this.color,i=e.r,n=e.g,r=e.b;return this.color.r=Math.max(0,Math.min(255,Math.floor(i*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(n*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t.color.b))),this}},{key:"getHSVBrightness",value:function(){return Math.max(this.color.r,this.color.g,this.color.b)/255}},{key:"getHSLBrightness",value:function(){return.5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}},{key:"setHsl",value:function(t,e,i){var n=this.color.opacity,r=Ai(this.color.r,this.color.g,this.color.b),a=Si(j(t)?r.h:Xt(t,0,360),j(e)?r.s:e>=0&&e<=1?100*e:e,j(i)?r.l:i<=1&&i>=0?100*i:i);return this.color=new Ii(a.r,a.g,a.b,n),this}},{key:"setRGB",value:function(t,e,i){return!j(t)&&(this.color.r=t),!j(e)&&(this.color.g=e),!j(i)&&(this.color.b=i),this}},{key:"setHex",value:function(t){var e="".concat(t).trim().toLowerCase(),i=Ri(e,!0);return null!=i?i:this}},{key:"setColorName",value:function(t){var e=wi[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}},{key:"setScalar",value:function(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}},{key:"setOpacity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.color.opacity=t,this}},{key:"getLuminance",value:function(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}},{key:"getLuminance2",value:function(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}},{key:"getLuminance3",value:function(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}},{key:"getLuminanceWCAG",value:function(){var t=this.color.r/255,e=this.color.g/255,i=this.color.b/255;return.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))}},{key:"clone",value:function(){return new t(this.color.toString())}},{key:"copyGammaToLinear",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}},{key:"copyLinearToGamma",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,i),this.color.g=Math.pow(t.color.g,i),this.color.b=Math.pow(t.color.b,i),this}},{key:"convertGammaToLinear",value:function(t){return this.copyGammaToLinear(this,t),this}},{key:"convertLinearToGamma",value:function(t){return this.copyLinearToGamma(this,t),this}},{key:"copySRGBToLinear",value:function(t){return this.color.r=Pi(t.color.r),this.color.g=Pi(t.color.g),this.color.b=Pi(t.color.b),this}},{key:"copyLinearToSRGB",value:function(t){return this.color.r=Bi(t.color.r),this.color.g=Bi(t.color.g),this.color.b=Bi(t.color.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}}],[{key:"Brighter",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return 1===i?e:new t(e).brighter(i).toRGBA()}},{key:"SetOpacity",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return 1===i?e:new t(e).setOpacity(i).toRGBA()}},{key:"getColorBrightness",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hsl",n=e instanceof t?e:new t(e);switch(i){case"hsv":default:return n.getHSVBrightness();case"hsl":return n.getHSLBrightness();case"lum":return n.getLuminance();case"lum2":return n.getLuminance2();case"lum3":return n.getLuminance3();case"wcag":return n.getLuminanceWCAG()}}},{key:"parseColorString",value:function(t){if(U(Ti[t]))return function(t){return Q(t)?new Ii(t>>>24,t>>>16&255,t>>>8&255,255&t):q(t)?new Ii(t[0],t[1],t[2],t[3]):new Ii(255,255,255,1)}(Ti[t]);if(U(wi[t]))return Ei(wi[t]);var e="".concat(t).trim().toLowerCase(),i=Ri(e);if(void 0!==i)return i;if(/^(rgb|RGB|rgba|RGBA)/.test(e)){var n=e.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new Ii(parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10),parseFloat(n[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(e)){var r=e.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),a=Si(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10));return new Ii(a.r,a.g,a.b,parseFloat(r[3]))}}}])}(),Ii=function(){return o((function t(e,i,n,a){r(this,t),this.r=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.g=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),this.b=isNaN(+n)?255:Math.max(0,Math.min(255,+n)),U(a)?this.opacity=isNaN(+a)?1:Math.max(0,Math.min(1,+a)):this.opacity=1}),[{key:"formatHex",value:function(){return"#".concat(Ci(this.r)+Ci(this.g)+Ci(this.b)+(1===this.opacity?"":Ci(255*this.opacity)))}},{key:"formatRgb",value:function(){var t=this.opacity;return"".concat(1===t?"rgb(":"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b).concat(1===t?")":",".concat(t,")"))}},{key:"formatHsl",value:function(){var t=this.opacity,e=Ai(this.r,this.g,this.b),i=e.h,n=e.s,r=e.l;return"".concat(1===t?"hsl(":"hsla(").concat(i,",").concat(n,"%,").concat(r,"%").concat(1===t?")":",".concat(t,")"))}},{key:"toString",value:function(){return this.formatHex()}}])}();function Di(t){if(et(t))return[t,t,t,t];if(q(t)){var e=t.length;if(1===e){var i=t[0];return[i,i,i,i]}if(2===e){var n=m(t,2),r=n[0],a=n[1];return[r,a,r,a]}if(3===e){var o=m(t,3),s=o[0],l=o[1];return[s,l,o[2],l]}if(4===e)return t}if(W(t)){var u=t.top,c=void 0===u?0:u,h=t.right,d=void 0===h?0:h,p=t.bottom,f=void 0===p?0:p,v=t.left;return[c,d,f,void 0===v?0:v]}return[0,0,0,0]}function Oi(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t)return{width:i,height:n};try{e=null===window||void 0===window?void 0:window.getComputedStyle}catch(t){e=function(){return{}}}var r=e(t);if(/^(\d*\.?\d+)(px)$/.exec(r.width)){var a=parseFloat(r.width)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)||t.clientWidth-1,o=parseFloat(r.height)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)||t.clientHeight-1;return{width:a<=0?i:a,height:o<=0?n:o}}return{width:i,height:n}}var Fi=function(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()};function zi(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function Hi(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}var Ni=1e-10;function Vi(t,e){var i=function(t){for(var e=[],i=0;i<t.length;++i)for(var n=i+1;n<t.length;++n)for(var r=Wi(t[i],t[n]),a=0;a<r.length;++a){var o=r[a];o.parentIndex=[i,n],e.push(o)}return e}(t),n=i.filter((function(e){return function(t,e){for(var i=0;i<e.length;++i)if(Oe.distancePP(t,e[i])>e[i].radius+Ni)return!1;return!0}(e,t)})),r=0,a=0,o=[];if(n.length>1){for(var s=Gi(n),l=0;l<n.length;++l){var u=n[l];u.angle=Math.atan2(u.x-s.x,u.y-s.y)}n.sort((function(t,e){return e.angle-t.angle}));for(var c=n[n.length-1],h=0;h<n.length;++h){var d=n[h];a+=(c.x+d.x)*(d.y-c.y);for(var p={x:(d.x+c.x)/2,y:(d.y+c.y)/2},f=null,v=0;v<d.parentIndex.length;++v)if(c.parentIndex.indexOf(d.parentIndex[v])>-1){var g=t[d.parentIndex[v]],y=Math.atan2(d.x-g.x,d.y-g.y),m=Math.atan2(c.x-g.x,c.y-g.y),_=m-y;_<0&&(_+=2*Math.PI);var b=m-_/2,x=Oe.distancePP(p,{x:g.x+g.radius*Math.sin(b),y:g.y+g.radius*Math.cos(b)});x>2*g.radius&&(x=2*g.radius),(null===f||f.width>x)&&(f={circle:g,width:x,p1:d,p2:c})}null!==f&&(o.push(f),r+=ji(f.circle.radius,f.width),c=d)}}else{for(var k=t[0],S=1;S<t.length;++S)t[S].radius<k.radius&&(k=t[S]);for(var A=!1,M=0;M<t.length;++M)if(Oe.distancePP(t[M],k)>Math.abs(k.radius-t[M].radius)){A=!0;break}A?r=a=0:(r=k.radius*k.radius*Math.PI,o.push({circle:k,p1:{x:k.x,y:k.y+k.radius},p2:{x:k.x-Ni,y:k.y+k.radius},width:2*k.radius}))}return a/=2,e&&(e.area=r+a,e.arcArea=r,e.polygonArea=a,e.arcs=o,e.innerPoints=n,e.intersectionPoints=i),r+a}function ji(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function Ui(t,e,i){if(i>=t+e)return 0;if(i<=Math.abs(t-e))return Math.PI*Math.min(t,e)*Math.min(t,e);var n=e-(i*i-t*t+e*e)/(2*i);return ji(t,t-(i*i-e*e+t*t)/(2*i))+ji(e,n)}function Wi(t,e){var i=Oe.distancePP(t,e),n=t.radius,r=e.radius;if(i>=n+r||i<=Math.abs(n-r))return[];var a=(n*n-r*r+i*i)/(2*i),o=Math.sqrt(n*n-a*a),s=t.x+a*(e.x-t.x)/i,l=t.y+a*(e.y-t.y)/i,u=-(e.y-t.y)*(o/i),c=-(e.x-t.x)*(o/i);return[{x:s+u,y:l-c},{x:s-u,y:l+c}]}function Gi(t){for(var e={x:0,y:0},i=0;i<t.length;++i)e.x+=t[i].x,e.y+=t[i].y;return e.x/=t.length,e.y/=t.length,e}var Yi,Xi=function(){function t(){var e=this;r(this,t),this.locale_shortWeekdays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.locale_periods=["AM","PM"],this.locale_weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.locale_shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.numberRe=/^\s*\d+/,this.pads={"-":"",_:" ",0:"0"},this.requoteRe=/[\\^$*+?|[\]().{}]/g,this.locale_months=["January","February","March","April","May","June","July","August","September","October","November","December"],this.formatShortWeekday=function(t){return e.locale_shortWeekdays[t.getDay()]},this.formatWeekday=function(t){return e.locale_weekdays[t.getDay()]},this.formatShortMonth=function(t){return e.locale_shortMonths[t.getMonth()]},this.formatMonth=function(t){return e.locale_months[t.getMonth()]},this.formatDayOfMonth=function(t,i){return e.pad(t.getDate(),i,2)},this.formatHour24=function(t,i){return e.pad(t.getHours(),i,2)},this.formatHour12=function(t,i){return e.pad(t.getHours()%12||12,i,2)},this.formatMilliseconds=function(t,i){return e.pad(t.getMilliseconds(),i,3)},this.formatMonthNumber=function(t,i){return e.pad(t.getMonth()+1,i,2)},this.formatMinutes=function(t,i){return e.pad(t.getMinutes(),i,2)},this.formatPeriod=function(t){return e.locale_periods[+(t.getHours()>=12)]},this.formatSeconds=function(t,i){return e.pad(t.getSeconds(),i,2)},this.formatFullYear=function(t,i){return e.pad(t.getFullYear()%1e4,i,4)},this.formatUTCShortWeekday=function(t){return e.locale_shortWeekdays[t.getUTCDay()]},this.formatUTCWeekday=function(t){return e.locale_weekdays[t.getUTCDay()]},this.formatUTCShortMonth=function(t){return e.locale_shortMonths[t.getUTCMonth()]},this.formatUTCMonth=function(t){return e.locale_months[t.getUTCMonth()]},this.formatUTCDayOfMonth=function(t,i){return e.pad(t.getUTCDate(),i,2)},this.formatUTCHour24=function(t,i){return e.pad(t.getUTCHours(),i,2)},this.formatUTCHour12=function(t,i){return e.pad(t.getUTCHours()%12||12,i,2)},this.formatUTCMilliseconds=function(t,i){return e.pad(t.getUTCMilliseconds(),i,3)},this.formatUTCMonthNumber=function(t,i){return e.pad(t.getUTCMonth()+1,i,2)},this.formatUTCMinutes=function(t,i){return e.pad(t.getUTCMinutes(),i,2)},this.formatUTCPeriod=function(t){return e.locale_periods[+(t.getUTCHours()>=12)]},this.formatUTCSeconds=function(t,i){return e.pad(t.getUTCSeconds(),i,2)},this.formatUTCFullYear=function(t,i){return e.pad(t.getUTCFullYear()%1e4,i,4)},this.formats={a:this.formatShortWeekday,A:this.formatWeekday,b:this.formatShortMonth,B:this.formatMonth,d:this.formatDayOfMonth,e:this.formatDayOfMonth,H:this.formatHour24,I:this.formatHour12,L:this.formatMilliseconds,m:this.formatMonthNumber,M:this.formatMinutes,p:this.formatPeriod,S:this.formatSeconds,Y:this.formatFullYear},this.utcFormats={a:this.formatUTCShortWeekday,A:this.formatUTCWeekday,b:this.formatUTCShortMonth,B:this.formatUTCMonth,d:this.formatUTCDayOfMonth,e:this.formatUTCDayOfMonth,H:this.formatUTCHour24,I:this.formatUTCHour12,L:this.formatUTCMilliseconds,m:this.formatUTCMonthNumber,M:this.formatUTCMinutes,p:this.formatUTCPeriod,S:this.formatUTCSeconds,Y:this.formatUTCFullYear},this.parseShortWeekday=function(t,i,n){var r=e.shortWeekdayRe.exec(i.slice(n));return r?(t.w=e.shortWeekdayLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseWeekday=function(t,i,n){var r=e.weekdayRe.exec(i.slice(n));return r?(t.w=e.weekdayLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseShortMonth=function(t,i,n){var r=e.shortMonthRe.exec(i.slice(n));return r?(t.m=e.shortMonthLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseMonth=function(t,i,n){var r=e.monthRe.exec(i.slice(n));return r?(t.m=e.monthLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseDayOfMonth=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1},this.parseHour24=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1},this.parseMilliseconds=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1},this.parseMonthNumber=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+2));return r?(t.m=r-1,n+r[0].length):-1},this.parseMinutes=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1},this.parsePeriod=function(t,i,n){var r=e.periodRe.exec(i.slice(n));return r?(t.p=e.periodLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseSeconds=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1},this.parseFullYear=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1},this.parses={a:this.parseShortWeekday,A:this.parseWeekday,b:this.parseShortMonth,B:this.parseMonth,d:this.parseDayOfMonth,e:this.parseDayOfMonth,H:this.parseHour24,I:this.parseHour24,L:this.parseMilliseconds,m:this.parseMonthNumber,M:this.parseMinutes,p:this.parsePeriod,S:this.parseSeconds,Y:this.parseFullYear},this.timeFormat=function(t,i){return e.newFormat(t,e.formats)(new Date(e.getFullTimeStamp(i)))},this.timeUTCFormat=function(t,i){return e.newFormat(t,e.utcFormats)(new Date(e.getFullTimeStamp(i)))},this.timeParse=function(t,i){return e.newParse(t,!1)(i+"")},this.requoteF=this.requote.bind(this),this.periodRe=this.formatRe(this.locale_periods),this.periodLookup=this.formatLookup(this.locale_periods),this.weekdayRe=this.formatRe(this.locale_weekdays),this.weekdayLookup=this.formatLookup(this.locale_weekdays),this.shortWeekdayRe=this.formatRe(this.locale_shortWeekdays),this.shortWeekdayLookup=this.formatLookup(this.locale_shortWeekdays),this.monthRe=this.formatRe(this.locale_months),this.monthLookup=this.formatLookup(this.locale_months),this.shortMonthRe=this.formatRe(this.locale_shortMonths),this.shortMonthLookup=this.formatLookup(this.locale_shortMonths)}return o(t,[{key:"requote",value:function(t){return t.replace(this.requoteRe,"\\$&")}},{key:"localDate",value:function(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}},{key:"utcDate",value:function(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}},{key:"newDate",value:function(t,e,i){return{y:t,m:e,d:i,H:0,M:0,S:0,L:0}}},{key:"formatRe",value:function(t){return new RegExp("^(?:"+t.map(this.requoteF).join("|")+")","i")}},{key:"formatLookup",value:function(t){return new Map(t.map((function(t,e){return[t.toLowerCase(),e]})))}},{key:"pad",value:function(t,e,i){var n=t<0?"-":"",r=(n?-t:t)+"",a=r.length;return n+(a<i?new Array(i-a+1).join(e)+r:r)}},{key:"parseSpecifier",value:function(t,e,i,n){for(var r,a,o=0,s=e.length,l=i.length;o<s;){if(n>=l)return-1;if(37===(r=e.charCodeAt(o++))){if(r=e.charAt(o++),!(a=this.parses[r in this.pads?e.charAt(o++):r])||(n=a(t,i,n))<0)return-1}else if(r!==i.charCodeAt(n++))return-1}return n}},{key:"newParse",value:function(t,e){var i=this;return function(n){var r=i.newDate(1900,void 0,1);return i.parseSpecifier(r,t,n+="",0)!==n.length?null:"Q"in r?new Date(r.Q):"s"in r?new Date(1e3*r.s+("L"in r?r.L:0)):(e&&!("Z"in r)&&(r.Z=0),"p"in r&&(r.H=r.H%12+12*r.p),void 0===r.m&&(r.m="q"in r?r.q:0),"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,i.utcDate(r)):i.localDate(r))}}},{key:"newFormat",value:function(t,e){var i=this;return function(n){var r,a,o=[],s=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(o.push(t.slice(l,s)),(a=i.pads[r=t.charAt(++s)])?r=t.charAt(++s):a="e"===r?" ":"0",r=(0,e[r])(n,a),o.push(r),l=s+1);return o.push(t.slice(l,s)),o.join("")}}},{key:"getFullTimeStamp",value:function(t){var e=parseInt(t+"",10);return 10===String(e).length?1e3*e:e}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}])}();function Ki(t,e){var i=e?t.toExponential(e-1):t.toExponential(),n=i.indexOf("e");if(n<0)return null;var r=i.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+i.slice(n+1)]}function qi(t,e){var i=Ki(t,e);if(!i)return t+"";var n=i[0],r=i[1];return r<0?"0."+new Array(-r).join("0")+n:n.length>r+1?n.slice(0,r+1)+"."+n.slice(r+1):n+new Array(r-n.length+2).join("0")}var Zi=function(){return o((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t),this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}),[{key:"toString",value:function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type}}])}(),Ji=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Qi(t){var e;if(e=Ji.exec(t))return new Zi({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]});Ot.getInstance().error("invalid format: "+t)}var $i=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],tn=function(){function t(){var e,i,n,a=this;r(this,t),this.locale={thousands:",",grouping:[3],currency:["$",""]},this.group=void 0===this.locale.grouping||void 0===this.locale.thousands?function(t){return t}:(i=b(this.locale.grouping).map(Number),n="".concat(this.locale.thousands),function(t,e){for(var r=t.length,a=[],o=0,s=i[0],l=0;r>0&&s>0&&(l+s+1>e&&(s=Math.max(1,e-l)),a.push(t.substring(r-=s,r+s)),!((l+=s+1)>e));)s=i[o=(o+1)%i.length];return a.reverse().join(n)}),this.currencyPrefix=void 0===this.locale.currency?"":this.locale.currency[0]+"",this.currencySuffix=void 0===this.locale.currency?"":this.locale.currency[1]+"",this.decimal=void 0===this.locale.decimal?".":this.locale.decimal+"",this.numerals=void 0===this.locale.numerals?function(t){return t}:(e=b(this.locale.numerals).map(String),function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}),this.percent=void 0===this.locale.percent?"%":this.locale.percent+"",this.minus=void 0===this.locale.minus?"−":this.locale.minus+"",this.nan=void 0===this.locale.nan?"NaN":this.locale.nan+"",this.formatter=function(t){return a.newFormat(t)},this.format=function(t,e){return a.formatter(t)(e)},this.formatPrefix=function(t,e){return a._formatPrefix(t,e)}}return o(t,[{key:"newFormat",value:function(t){var e=Qi(t),i=e.fill,n=e.align,r=e.sign,a=e.symbol,o=e.zero,s=e.width,l=e.comma,u=e.precision,c=e.trim,h=e.type;"n"===h?(l=!0,h="g"):en[h]||(void 0===u&&(u=12),c=!0,h="g"),(o||"0"===i&&"="===n)&&(o=!0,i="0",n="=");var d="$"===a?this.currencyPrefix:"#"===a&&/[boxX]/.test(h)?"0"+h.toLowerCase():"",p="$"===a?this.currencySuffix:/[%p]/.test(h)?this.percent:"",f=en[h],v=/[defgprstz%]/.test(h);u=void 0===u?6:/[gprs]/.test(h)?Math.max(1,Math.min(21,u)):Math.max(0,Math.min(20,u));var g=this.nan,y=this.minus,m=this.decimal,_=this.group,b=this.numerals;function x(t){var e,a,x,k=d,S=p,A=t;if("c"===h)S=f(A)+S,A="";else{var M=(A=+A)<0||1/A<0;if(A=isNaN(A)?g:f(Math.abs(A),u),c&&(A=function(t){var e,i=t.length,n=-1;t:for(var r=1;r<i;++r)switch(t[r]){case".":n=e=r;break;case"0":0===n&&(n=r),e=r;break;default:if(!+t[r])break t;n>0&&(n=0)}return n>0?t.slice(0,n)+t.slice(e+1):t}(A)),M&&0==+A&&"+"!==r&&(M=!1),k=(M?"("===r?r:y:"-"===r||"("===r?"":r)+k,S=("s"===h?$i[8+Yi/3]:"")+S+(M&&"("===r?")":""),v)for(e=-1,a=A.length;++e<a;)if(48>(x=A.charCodeAt(e))||x>57){S=(46===x?m+A.slice(e+1):A.slice(e))+S,A=A.slice(0,e);break}}l&&!o&&(A=_(A,1/0));var T=k.length+A.length+S.length,w=T<s?new Array(s-T+1).join(i):"";switch(l&&o&&(A=_(w+A,w.length?s-S.length:1/0),w=""),n){case"<":A=k+A+S+w;break;case"=":A=k+w+A+S;break;case"^":A=w.slice(0,T=w.length>>1)+k+A+S+w.slice(T);break;default:A=w+k+A+S}return b(A)}return x.toString=function(){return t+""},x}},{key:"_formatPrefix",value:function(t,e){var i=Qi(t);i.type="f";var n,r,a=this.newFormat(i.toString()),o=3*Math.max(-8,Math.min(8,Math.floor((n=e,((r=Ki(Math.abs(n)))?r[1]:NaN)/3)))),s=Math.pow(10,-o),l=$i[8+o/3];return function(t){return a(s*t)+l}}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}])}(),en={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},f:function(t,e){return t.toFixed(e)},e:function(t,e){return t.toExponential(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return qi(100*t,e)},r:qi,s:function(t,e){var i=Ki(t,e);if(!i)return t+"";var n=i[0],r=i[1],a=r-(Yi=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Ki(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)},t:function(t,e){return Number.isInteger(t)?t.toFixed(2):Math.floor(t*Math.pow(10,e))/Math.pow(10,e)+""},z:function(t,e){return t%1==0?t+"":t.toFixed(e)}};function nn(t){for(var e=new Array(t),i=0;i<t;++i)e[i]=0;return e}function rn(t,e){return nn(t).map((function(){return nn(e)}))}function an(t){return Math.sqrt(Pe(t,t))}function on(t,e,i){for(var n=0;n<e.length;++n)t[n]=e[n]*i}function sn(t,e,i,n,r){for(var a=0;a<t.length;++a)t[a]=e*i[a]+n*r[a]}function ln(t,e,i){var n,r=(i=i||{}).maxIterations||200*e.length,a=i.nonZeroDelta||1.05,o=i.zeroDelta||.001,s=i.minErrorDelta||1e-6,l=i.minErrorDelta||1e-5,u=void 0!==i.rho?i.rho:1,c=void 0!==i.chi?i.chi:2,h=void 0!==i.psi?i.psi:-.5,d=void 0!==i.sigma?i.sigma:.5,p=e.length,f=new Array(p+1);f[0]=e,f[0].fx=t(e),f[0].id=0;for(var v=0;v<p;++v){var g=e.slice();g[v]=g[v]?g[v]*a:o,f[v+1]=g,f[v+1].fx=t(g),f[v+1].id=v+1}function y(t){for(var e=0;e<t.length;e++)f[p][e]=t[e];f[p].fx=t.fx}for(var m=function(t,e){return t.fx-e.fx},_=e.slice(),b=e.slice(),x=e.slice(),k=e.slice(),S=0;S<r;++S){if(f.sort(m),i.history){var A=f.map((function(t){var e=t.slice();return e.fx=t.fx,e.id=t.id,e}));A.sort((function(t,e){return t.id-e.id})),i.history.push({x:f[0].slice(),fx:f[0].fx,simplex:A})}n=0;for(var M=0;M<p;++M)n=Math.max(n,Math.abs(f[0][M]-f[1][M]));if(Math.abs(f[0].fx-f[p].fx)<s&&n<l)break;for(var T=0;T<p;++T){_[T]=0;for(var w=0;w<p;++w)_[T]+=f[w][T];_[T]/=p}var C=f[p];if(sn(b,1+u,_,-u,C),b.fx=t(b),b.fx<f[0].fx)sn(k,1+c,_,-c,C),k.fx=t(k),k.fx<b.fx?y(k):y(b);else if(b.fx>=f[p-1].fx){var E=!1;if(b.fx>C.fx?(sn(x,1+h,_,-h,C),x.fx=t(x),x.fx<C.fx?y(x):E=!0):(sn(x,1-h*u,_,h*u,C),x.fx=t(x),x.fx<b.fx?y(x):E=!0),E){if(d>=1)break;for(var P=1;P<f.length;++P)sn(f[P],1-d,f[0],d,f[P]),f[P].fx=t(f[P])}}else y(b)}return f.sort(m),{fx:f[0].fx,x:f[0]}}function un(t,e,i,n,r,a,o){var s=i.fx,l=Pe(i.fxprime,e),u=s,c=s,h=l,d=0;function p(c,d,p){for(var f=0;f<16;++f)if(r=(c+d)/2,sn(n.x,1,i.x,r,e),u=n.fx=t(n.x,n.fxprime),h=Pe(n.fxprime,e),u>s+a*r*l||u>=p)d=r;else{if(Math.abs(h)<=-o*l)return r;h*(d-c)>=0&&(d=c),c=r,p=u}return 0}r=r||1,a=a||1e-6,o=o||.1;for(var f=0;f<10;++f){if(sn(n.x,1,i.x,r,e),u=n.fx=t(n.x,n.fxprime),h=Pe(n.fxprime,e),u>s+a*r*l||f&&u>=c)return p(d,r,c);if(Math.abs(h)<=-o*l)return r;if(h>=0)return p(r,d,u);c=u,d=r,r*=2}return r}function cn(t,e,i){var n,r={x:e.slice(),fx:0,fxprime:e.slice()},a={x:e.slice(),fx:0,fxprime:e.slice()},o=e.slice(),s=1,l=(i=i||{}).maxIterations||20*e.length;r.fx=t(r.x,r.fxprime);var u=r.fxprime.slice();on(u,r.fxprime,-1);for(var c=0;c<l;++c){if(s=un(t,u,r,a,s),i.history&&i.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:s}),s){sn(o,1,a.fxprime,-1,r.fxprime);var h=Pe(r.fxprime,r.fxprime);sn(u,Math.max(0,Pe(o,a.fxprime)/h),u,-1,a.fxprime),n=r,r=a,a=n}else on(u,r.fxprime,-1);if(an(r.fxprime)<=1e-5)break}return i.history&&i.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:s}),r}var hn=function(t,e){var i=e.callback;return i&&(t=t.filter(i)),t};function dn(){return new pn}function pn(){this.reset()}pn.prototype={constructor:pn,reset:function(){this.s=this.t=0},add:function(t){vn(fn,t,this.t),vn(this,fn.s,this.s),this.s?this.t+=fn.t:this.s=fn.t},valueOf:function(){return this.s}};var fn=new pn;function vn(t,e,i){var n=t.s=e+i,r=n-e,a=n-r;t.t=e-a+(i-r)}var gn=1e-6,yn=Math.PI,mn=yn/2,_n=yn/4,bn=2*yn,xn=180/yn,kn=yn/180,Sn=Math.abs,An=Math.atan,Mn=Math.atan2,Tn=Math.cos,wn=Math.exp,Cn=Math.log,En=Math.pow,Pn=Math.sin,Bn=Math.sign||function(t){return t>0?1:t<0?-1:0},Rn=Math.sqrt,Ln=Math.tan;function In(t){return t>1?0:t<-1?yn:Math.acos(t)}function Dn(t){return t>1?mn:t<-1?-mn:Math.asin(t)}function On(){}function Fn(t,e){t&&Hn.hasOwnProperty(t.type)&&Hn[t.type](t,e)}var zn={Feature:function(t,e){Fn(t.geometry,e)},FeatureCollection:function(t,e){for(var i=t.features,n=-1,r=i.length;++n<r;)Fn(i[n].geometry,e)}},Hn={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)t=i[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){Nn(t.coordinates,e,0)},MultiLineString:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)Nn(i[n],e,0)},Polygon:function(t,e){Vn(t.coordinates,e)},MultiPolygon:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)Vn(i[n],e)},GeometryCollection:function(t,e){for(var i=t.geometries,n=-1,r=i.length;++n<r;)Fn(i[n],e)}};function Nn(t,e,i){var n,r=-1,a=t.length-i;for(e.lineStart();++r<a;)n=t[r],e.point(n[0],n[1],n[2]);e.lineEnd()}function Vn(t,e){var i=-1,n=t.length;for(e.polygonStart();++i<n;)Nn(t[i],e,1);e.polygonEnd()}function jn(t,e){t&&zn.hasOwnProperty(t.type)?zn[t.type](t,e):Fn(t,e)}function Un(t){return[Mn(t[1],t[0]),Dn(t[2])]}function Wn(t){var e=t[0],i=t[1],n=Tn(i);return[n*Tn(e),n*Pn(e),Pn(i)]}function Gn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Yn(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Xn(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Kn(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function qn(t){var e=Rn(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Zn(t,e){function i(i,n){return i=t(i,n),e(i[0],i[1])}return t.invert&&e.invert&&(i.invert=function(i,n){return(i=e.invert(i,n))&&t.invert(i[0],i[1])}),i}function Jn(t,e){return[Sn(t)>yn?t+Math.round(-t/bn)*bn:t,e]}function Qn(t,e,i){return(t%=bn)?e||i?Zn(tr(t),er(e,i)):tr(t):e||i?er(e,i):Jn}function $n(t){return function(e,i){return[(e+=t)>yn?e-bn:e<-yn?e+bn:e,i]}}function tr(t){var e=$n(t);return e.invert=$n(-t),e}function er(t,e){var i=Tn(t),n=Pn(t),r=Tn(e),a=Pn(e);function o(t,e){var o=Tn(e),s=Tn(t)*o,l=Pn(t)*o,u=Pn(e),c=u*i+s*n;return[Mn(l*r-c*a,s*i-u*n),Dn(c*r+l*a)]}return o.invert=function(t,e){var o=Tn(e),s=Tn(t)*o,l=Pn(t)*o,u=Pn(e),c=u*r-l*a;return[Mn(l*r+u*a,s*i+c*n),Dn(c*i-s*n)]},o}function ir(t,e){(e=Wn(e))[0]-=t,qn(e);var i=In(-e[1]);return((-e[2]<0?-i:i)+bn-gn)%bn}function nr(){var t,e=[];return{point:function(e,i,n){t.push([e,i,n])},lineStart:function(){e.push(t=[])},lineEnd:On,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function rr(t,e){return Sn(t[0]-e[0])<gn&&Sn(t[1]-e[1])<gn}function ar(t,e,i,n){this.x=t,this.z=e,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function or(t,e,i,n,r){var a,o,s=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,i,n=t[0],o=t[e];if(rr(n,o)){if(!n[2]&&!o[2]){for(r.lineStart(),a=0;a<e;++a)r.point((n=t[a])[0],n[1]);return void r.lineEnd()}o[0]+=2*gn}s.push(i=new ar(n,t,null,!0)),l.push(i.o=new ar(n,null,i,!1)),s.push(i=new ar(o,t,null,!1)),l.push(i.o=new ar(o,null,i,!0))}})),s.length){for(l.sort(e),sr(s),sr(l),a=0,o=l.length;a<o;++a)l[a].e=i=!i;for(var u,c,h=s[0];;){for(var d=h,p=!0;d.v;)if((d=d.n)===h)return;u=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(a=0,o=u.length;a<o;++a)r.point((c=u[a])[0],c[1]);else n(d.x,d.n.x,1,r);d=d.n}else{if(p)for(u=d.p.z,a=u.length-1;a>=0;--a)r.point((c=u[a])[0],c[1]);else n(d.x,d.p.x,-1,r);d=d.p}u=(d=d.o).z,p=!p}while(!d.v);r.lineEnd()}}}function sr(t){if(e=t.length){for(var e,i,n=0,r=t[0];++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}Jn.invert=Jn;var lr,ur,cr=dn();function hr(t){return Sn(t[0])<=yn?t[0]:Bn(t[0])*((Sn(t[0])+yn)%bn-yn)}function dr(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function pr(t){for(var e,i,n,r=t.length,a=-1,o=0;++a<r;)o+=t[a].length;for(i=new Array(o);--r>=0;)for(e=(n=t[r]).length;--e>=0;)i[--o]=n[e];return i}function fr(t,e,i,n){return function(r){var a,o,s,l=e(r),u=nr(),c=e(u),h=!1,d={point:p,lineStart:v,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=m,d.lineEnd=_,o=[],a=[]},polygonEnd:function(){d.point=p,d.lineStart=v,d.lineEnd=g,o=pr(o);var t=function(t,e){var i=hr(e),n=e[1],r=Pn(n),a=[Pn(i),-Tn(i),0],o=0,s=0;cr.reset(),1===r?n=mn+gn:-1===r&&(n=-mn-gn);for(var l=0,u=t.length;l<u;++l)if(h=(c=t[l]).length)for(var c,h,d=c[h-1],p=hr(d),f=d[1]/2+_n,v=Pn(f),g=Tn(f),y=0;y<h;++y,p=_,v=x,g=k,d=m){var m=c[y],_=hr(m),b=m[1]/2+_n,x=Pn(b),k=Tn(b),S=_-p,A=S>=0?1:-1,M=A*S,T=M>yn,w=v*x;if(cr.add(Mn(w*A*Pn(M),g*k+w*Tn(M))),o+=T?S+A*bn:S,T^p>=i^_>=i){var C=Yn(Wn(d),Wn(m));qn(C);var E=Yn(a,C);qn(E);var P=(T^S>=0?-1:1)*Dn(E[2]);(n>P||n===P&&(C[0]||C[1]))&&(s+=T^S>=0?1:-1)}}return(o<-gn||o<gn&&cr<-gn)^1&s}(a,n);o.length?(h||(r.polygonStart(),h=!0),or(o,gr,t,i,r)):t&&(h||(r.polygonStart(),h=!0),r.lineStart(),i(null,null,1,r),r.lineEnd()),h&&(r.polygonEnd(),h=!1),o=a=null},sphere:function(){r.polygonStart(),r.lineStart(),i(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(e,i){t(e,i)&&r.point(e,i)}function f(t,e){l.point(t,e)}function v(){d.point=f,l.lineStart()}function g(){d.point=p,l.lineEnd()}function y(t,e){s.push([t,e]),c.point(t,e)}function m(){c.lineStart(),s=[]}function _(){y(s[0][0],s[0][1]),c.lineEnd();var t,e,i,n,l=c.clean(),d=u.result(),p=d.length;if(s.pop(),a.push(s),s=null,p)if(1&l){if((e=(i=d[0]).length-1)>0){for(h||(r.polygonStart(),h=!0),r.lineStart(),t=0;t<e;++t)r.point((n=i[t])[0],n[1]);r.lineEnd()}}else p>1&&2&l&&d.push(d.pop().concat(d.shift())),o.push(d.filter(vr))}return d}}function vr(t){return t.length>1}function gr(t,e){return((t=t.x)[0]<0?t[1]-mn-gn:mn-t[1])-((e=e.x)[0]<0?e[1]-mn-gn:mn-e[1])}1===(lr=dr).length&&(ur=lr,lr=function(t,e){return dr(ur(t),e)});var yr=fr((function(){return!0}),(function(t){var e,i=NaN,n=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,o){var s=a>0?yn:-yn,l=Sn(a-i);Sn(l-yn)<gn?(t.point(i,n=(n+o)/2>0?mn:-mn),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(s,n),t.point(a,n),e=0):r!==s&&l>=yn&&(Sn(i-r)<gn&&(i-=r*gn),Sn(a-s)<gn&&(a-=s*gn),n=function(t,e,i,n){var r,a,o=Pn(t-i);return Sn(o)>gn?An((Pn(e)*(a=Tn(n))*Pn(i)-Pn(n)*(r=Tn(e))*Pn(t))/(r*a*o)):(e+n)/2}(i,n,a,o),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(s,n),e=0),t.point(i=a,n=o),r=s},lineEnd:function(){t.lineEnd(),i=n=NaN},clean:function(){return 2-e}}}),(function(t,e,i,n){var r;if(null==t)r=i*mn,n.point(-yn,r),n.point(0,r),n.point(yn,r),n.point(yn,0),n.point(yn,-r),n.point(0,-r),n.point(-yn,-r),n.point(-yn,0),n.point(-yn,r);else if(Sn(t[0]-e[0])>gn){var a=t[0]<e[0]?yn:-yn;r=i*a/2,n.point(-a,r),n.point(0,r),n.point(a,r)}else n.point(e[0],e[1])}),[-yn,-mn]);function mr(t){var e=Tn(t),i=6*kn,n=e>0,r=Sn(e)>gn;function a(t,i){return Tn(t)*Tn(i)>e}function o(t,i,n){var r=[1,0,0],a=Yn(Wn(t),Wn(i)),o=Gn(a,a),s=a[0],l=o-s*s;if(!l)return!n&&t;var u=e*o/l,c=-e*s/l,h=Yn(r,a),d=Kn(r,u);Xn(d,Kn(a,c));var p=h,f=Gn(d,p),v=Gn(p,p),g=f*f-v*(Gn(d,d)-1);if(!(g<0)){var y=Rn(g),m=Kn(p,(-f-y)/v);if(Xn(m,d),m=Un(m),!n)return m;var _,b=t[0],x=i[0],k=t[1],S=i[1];x<b&&(_=b,b=x,x=_);var A=x-b,M=Sn(A-yn)<gn;if(!M&&S<k&&(_=k,k=S,S=_),M||A<gn?M?k+S>0^m[1]<(Sn(m[0]-b)<gn?k:S):k<=m[1]&&m[1]<=S:A>yn^(b<=m[0]&&m[0]<=x)){var T=Kn(p,(-f+y)/v);return Xn(T,d),[m,Un(T)]}}}function s(e,i){var r=n?t:yn-t,a=0;return e<-r?a|=1:e>r&&(a|=2),i<-r?a|=4:i>r&&(a|=8),a}return fr(a,(function(t){var e,i,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,d){var p,f=[h,d],v=a(h,d),g=n?v?0:s(h,d):v?s(h+(h<0?yn:-yn),d):0;if(!e&&(u=l=v)&&t.lineStart(),v!==l&&(!(p=o(e,f))||rr(e,p)||rr(f,p))&&(f[2]=1),v!==l)c=0,v?(t.lineStart(),p=o(f,e),t.point(p[0],p[1])):(p=o(e,f),t.point(p[0],p[1],2),t.lineEnd()),e=p;else if(r&&e&&n^v){var y;g&i||!(y=o(f,e,!0))||(c=0,n?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!v||e&&rr(e,f)||t.point(f[0],f[1]),e=f,l=v,i=g},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),(function(e,n,r,a){!function(t,e,i,n,r,a){if(i){var o=Tn(e),s=Pn(e),l=n*i;null==r?(r=e+n*bn,a=e-l/2):(r=ir(o,r),a=ir(o,a),(n>0?r<a:r>a)&&(r+=n*bn));for(var u,c=r;n>0?c>a:c<a;c-=l)u=Un([o,-s*Tn(c),-s*Pn(c)]),t.point(u[0],u[1])}}(a,t,i,r,e,n)}),n?[0,-t]:[-yn,t-yn])}var _r=1e9,br=-_r;function xr(t,e,i,n){function r(r,a){return t<=r&&r<=i&&e<=a&&a<=n}function a(r,a,s,u){var c=0,h=0;if(null==r||(c=o(r,s))!==(h=o(a,s))||l(r,a)<0^s>0)do{u.point(0===c||3===c?t:i,c>1?n:e)}while((c=(c+s+4)%4)!==h);else u.point(a[0],a[1])}function o(n,r){return Sn(n[0]-t)<gn?r>0?0:3:Sn(n[0]-i)<gn?r>0?2:1:Sn(n[1]-e)<gn?r>0?1:0:r>0?3:2}function s(t,e){return l(t.x,e.x)}function l(t,e){var i=o(t,1),n=o(e,1);return i!==n?i-n:0===i?e[1]-t[1]:1===i?t[0]-e[0]:2===i?t[1]-e[1]:e[0]-t[0]}return function(o){var l,u,c,h,d,p,f,v,g,y,m,_=o,b=nr(),x={point:k,lineStart:function(){x.point=S,u&&u.push(c=[]);y=!0,g=!1,f=v=NaN},lineEnd:function(){l&&(S(h,d),p&&g&&b.rejoin(),l.push(b.result()));x.point=k,g&&_.lineEnd()},polygonStart:function(){_=b,l=[],u=[],m=!0},polygonEnd:function(){var e=function(){for(var e=0,i=0,r=u.length;i<r;++i)for(var a,o,s=u[i],l=1,c=s.length,h=s[0],d=h[0],p=h[1];l<c;++l)a=d,o=p,d=(h=s[l])[0],p=h[1],o<=n?p>n&&(d-a)*(n-o)>(p-o)*(t-a)&&++e:p<=n&&(d-a)*(n-o)<(p-o)*(t-a)&&--e;return e}(),i=m&&e,r=(l=pr(l)).length;(i||r)&&(o.polygonStart(),i&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),r&&or(l,s,e,a,o),o.polygonEnd());_=o,l=u=c=null}};function k(t,e){r(t,e)&&_.point(t,e)}function S(a,o){var s=r(a,o);if(u&&c.push([a,o]),y)h=a,d=o,p=s,y=!1,s&&(_.lineStart(),_.point(a,o));else if(s&&g)_.point(a,o);else{var l=[f=Math.max(br,Math.min(_r,f)),v=Math.max(br,Math.min(_r,v))],b=[a=Math.max(br,Math.min(_r,a)),o=Math.max(br,Math.min(_r,o))];!function(t,e,i,n,r,a){var o,s=t[0],l=t[1],u=0,c=1,h=e[0]-s,d=e[1]-l;if(o=i-s,h||!(o>0)){if(o/=h,h<0){if(o<u)return;o<c&&(c=o)}else if(h>0){if(o>c)return;o>u&&(u=o)}if(o=r-s,h||!(o<0)){if(o/=h,h<0){if(o>c)return;o>u&&(u=o)}else if(h>0){if(o<u)return;o<c&&(c=o)}if(o=n-l,d||!(o>0)){if(o/=d,d<0){if(o<u)return;o<c&&(c=o)}else if(d>0){if(o>c)return;o>u&&(u=o)}if(o=a-l,d||!(o<0)){if(o/=d,d<0){if(o>c)return;o>u&&(u=o)}else if(d>0){if(o<u)return;o<c&&(c=o)}return u>0&&(t[0]=s+u*h,t[1]=l+u*d),c<1&&(e[0]=s+c*h,e[1]=l+c*d),!0}}}}}(l,b,t,e,i,n)?s&&(_.lineStart(),_.point(a,o),m=!1):(g||(_.lineStart(),_.point(l[0],l[1])),_.point(b[0],b[1]),s||_.lineEnd(),m=!1)}f=a,v=o,g=s}return x}}function kr(t){return t}var Sr,Ar,Mr,Tr,wr=dn(),Cr=dn(),Er={point:On,lineStart:On,lineEnd:On,polygonStart:function(){Er.lineStart=Pr,Er.lineEnd=Lr},polygonEnd:function(){Er.lineStart=Er.lineEnd=Er.point=On,wr.add(Sn(Cr)),Cr.reset()},result:function(){var t=wr/2;return wr.reset(),t}};function Pr(){Er.point=Br}function Br(t,e){Er.point=Rr,Sr=Mr=t,Ar=Tr=e}function Rr(t,e){Cr.add(Tr*t-Mr*e),Mr=t,Tr=e}function Lr(){Rr(Sr,Ar)}var Ir=Er,Dr=1/0,Or=Dr,Fr=-Dr,zr=Fr;var Hr,Nr,Vr,jr,Ur={point:function(t,e){t<Dr&&(Dr=t);t>Fr&&(Fr=t);e<Or&&(Or=e);e>zr&&(zr=e)},lineStart:On,lineEnd:On,polygonStart:On,polygonEnd:On,result:function(){var t=[[Dr,Or],[Fr,zr]];return Fr=zr=-(Or=Dr=1/0),t}},Wr=0,Gr=0,Yr=0,Xr=0,Kr=0,qr=0,Zr=0,Jr=0,Qr=0,$r={point:ta,lineStart:ea,lineEnd:ra,polygonStart:function(){$r.lineStart=aa,$r.lineEnd=oa},polygonEnd:function(){$r.point=ta,$r.lineStart=ea,$r.lineEnd=ra},result:function(){var t=Qr?[Zr/Qr,Jr/Qr]:qr?[Xr/qr,Kr/qr]:Yr?[Wr/Yr,Gr/Yr]:[NaN,NaN];return Wr=Gr=Yr=Xr=Kr=qr=Zr=Jr=Qr=0,t}};function ta(t,e){Wr+=t,Gr+=e,++Yr}function ea(){$r.point=ia}function ia(t,e){$r.point=na,ta(Vr=t,jr=e)}function na(t,e){var i=t-Vr,n=e-jr,r=Rn(i*i+n*n);Xr+=r*(Vr+t)/2,Kr+=r*(jr+e)/2,qr+=r,ta(Vr=t,jr=e)}function ra(){$r.point=ta}function aa(){$r.point=sa}function oa(){la(Hr,Nr)}function sa(t,e){$r.point=la,ta(Hr=Vr=t,Nr=jr=e)}function la(t,e){var i=t-Vr,n=e-jr,r=Rn(i*i+n*n);Xr+=r*(Vr+t)/2,Kr+=r*(jr+e)/2,qr+=r,Zr+=(r=jr*t-Vr*e)*(Vr+t),Jr+=r*(jr+e),Qr+=3*r,ta(Vr=t,jr=e)}var ua=$r;function ca(t){this._context=t}ca.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,bn)}},result:On};var ha,da,pa,fa,va,ga=dn(),ya={point:On,lineStart:function(){ya.point=ma},lineEnd:function(){ha&&_a(da,pa),ya.point=On},polygonStart:function(){ha=!0},polygonEnd:function(){ha=null},result:function(){var t=+ga;return ga.reset(),t}};function ma(t,e){ya.point=_a,da=fa=t,pa=va=e}function _a(t,e){fa-=t,va-=e,ga.add(Rn(fa*fa+va*va)),fa=t,va=e}var ba=ya;function xa(){this._string=[]}function ka(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Sa(t,e){var i,n,r=4.5;function a(t){return t&&("function"==typeof r&&n.pointRadius(+r.apply(this,arguments)),jn(t,i(n))),n.result()}return a.area=function(t){return jn(t,i(Ir)),Ir.result()},a.measure=function(t){return jn(t,i(ba)),ba.result()},a.bounds=function(t){return jn(t,i(Ur)),Ur.result()},a.centroid=function(t){return jn(t,i(ua)),ua.result()},a.projection=function(e){return arguments.length?(i=null==e?(t=null,kr):(t=e).stream,a):t},a.context=function(t){return arguments.length?(n=null==t?(e=null,new xa):new ca(e=t),"function"!=typeof r&&n.pointRadius(r),a):e},a.pointRadius=function(t){return arguments.length?(r="function"==typeof t?t:(n.pointRadius(+t),+t),a):r},a.projection(t).context(e)}function Aa(t){return function(e){var i=new Ma;for(var n in t)i[n]=t[n];return i.stream=e,i}}function Ma(){}function Ta(t,e,i){var n=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=n&&t.clipExtent(null),jn(i,t.stream(Ur)),e(Ur.result()),null!=n&&t.clipExtent(n),t}function wa(t,e,i){return Ta(t,(function(i){var n=e[1][0]-e[0][0],r=e[1][1]-e[0][1],a=Math.min(n/(i[1][0]-i[0][0]),r/(i[1][1]-i[0][1])),o=+e[0][0]+(n-a*(i[1][0]+i[0][0]))/2,s=+e[0][1]+(r-a*(i[1][1]+i[0][1]))/2;t.scale(150*a).translate([o,s])}),i)}function Ca(t,e,i){return wa(t,[[0,0],e],i)}function Ea(t,e,i){return Ta(t,(function(i){var n=+e,r=n/(i[1][0]-i[0][0]),a=(n-r*(i[1][0]+i[0][0]))/2,o=-r*i[0][1];t.scale(150*r).translate([a,o])}),i)}function Pa(t,e,i){return Ta(t,(function(i){var n=+e,r=n/(i[1][1]-i[0][1]),a=-r*i[0][0],o=(n-r*(i[1][1]+i[0][1]))/2;t.scale(150*r).translate([a,o])}),i)}xa.prototype={_radius:4.5,_circle:ka(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=ka(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},Ma.prototype={constructor:Ma,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Ba=16,Ra=Tn(30*kn);function La(t,e){return+e?function(t,e){function i(n,r,a,o,s,l,u,c,h,d,p,f,v,g){var y=u-n,m=c-r,_=y*y+m*m;if(_>4*e&&v--){var b=o+d,x=s+p,k=l+f,S=Rn(b*b+x*x+k*k),A=Dn(k/=S),M=Sn(Sn(k)-1)<gn||Sn(a-h)<gn?(a+h)/2:Mn(x,b),T=t(M,A),w=T[0],C=T[1],E=w-n,P=C-r,B=m*E-y*P;(B*B/_>e||Sn((y*E+m*P)/_-.5)>.3||o*d+s*p+l*f<Ra)&&(i(n,r,a,o,s,l,w,C,M,b/=S,x/=S,k,v,g),g.point(w,C),i(w,C,M,b,x,k,u,c,h,d,p,f,v,g))}}return function(e){var n,r,a,o,s,l,u,c,h,d,p,f,v={point:g,lineStart:y,lineEnd:_,polygonStart:function(){e.polygonStart(),v.lineStart=b},polygonEnd:function(){e.polygonEnd(),v.lineStart=y}};function g(i,n){i=t(i,n),e.point(i[0],i[1])}function y(){c=NaN,v.point=m,e.lineStart()}function m(n,r){var a=Wn([n,r]),o=t(n,r);i(c,h,u,d,p,f,c=o[0],h=o[1],u=n,d=a[0],p=a[1],f=a[2],Ba,e),e.point(c,h)}function _(){v.point=g,e.lineEnd()}function b(){y(),v.point=x,v.lineEnd=k}function x(t,e){m(n=t,e),r=c,a=h,o=d,s=p,l=f,v.point=m}function k(){i(c,h,u,d,p,f,r,a,n,o,s,l,Ba,e),v.lineEnd=_,_()}return v}}(t,e):function(t){return Aa({point:function(e,i){e=t(e,i),this.stream.point(e[0],e[1])}})}(t)}var Ia=Aa({point:function(t,e){this.stream.point(t*kn,e*kn)}});function Da(t,e,i,n,r){function a(a,o){return[e+t*(a*=n),i-t*(o*=r)]}return a.invert=function(a,o){return[(a-e)/t*n,(i-o)/t*r]},a}function Oa(t,e,i,n,r,a){var o=Tn(a),s=Pn(a),l=o*t,u=s*t,c=o/t,h=s/t,d=(s*i-o*e)/t,p=(s*e+o*i)/t;function f(t,a){return[l*(t*=n)-u*(a*=r)+e,i-u*t-l*a]}return f.invert=function(t,e){return[n*(c*t-h*e+d),r*(p-h*t-c*e)]},f}function Fa(t){return za((function(){return t}))()}function za(t){var e,i,n,r,a,o,s,l,u,c,h=150,d=480,p=250,f=0,v=0,g=0,y=0,m=0,_=0,b=1,x=1,k=null,S=yr,A=null,M=kr,T=.5;function w(t){return l(t[0]*kn,t[1]*kn)}function C(t){return(t=l.invert(t[0],t[1]))&&[t[0]*xn,t[1]*xn]}function E(){var t=Oa(h,0,0,b,x,_).apply(null,e(f,v)),n=(_?Oa:Da)(h,d-t[0],p-t[1],b,x,_);return i=Qn(g,y,m),s=Zn(e,n),l=Zn(i,s),o=La(s,T),P()}function P(){return u=c=null,w}return w.stream=function(t){return u&&c===t?u:u=Ia(function(t){return Aa({point:function(e,i){var n=t(e,i);return this.stream.point(n[0],n[1])}})}(i)(S(o(M(c=t)))))},w.preclip=function(t){return arguments.length?(S=t,k=void 0,P()):S},w.postclip=function(t){return arguments.length?(M=t,A=n=r=a=null,P()):M},w.clipAngle=function(t){return arguments.length?(S=+t?mr(k=t*kn):(k=null,yr),P()):k*xn},w.clipExtent=function(t){return arguments.length?(M=null==t?(A=n=r=a=null,kr):xr(A=+t[0][0],n=+t[0][1],r=+t[1][0],a=+t[1][1]),P()):null==A?null:[[A,n],[r,a]]},w.scale=function(t){return arguments.length?(h=+t,E()):h},w.translate=function(t){return arguments.length?(d=+t[0],p=+t[1],E()):[d,p]},w.center=function(t){return arguments.length?(f=t[0]%360*kn,v=t[1]%360*kn,E()):[f*xn,v*xn]},w.rotate=function(t){return arguments.length?(g=t[0]%360*kn,y=t[1]%360*kn,m=t.length>2?t[2]%360*kn:0,E()):[g*xn,y*xn,m*xn]},w.angle=function(t){return arguments.length?(_=t%360*kn,E()):_*xn},w.reflectX=function(t){return arguments.length?(b=t?-1:1,E()):b<0},w.reflectY=function(t){return arguments.length?(x=t?-1:1,E()):x<0},w.precision=function(t){return arguments.length?(o=La(s,T=t*t),P()):Rn(T)},w.fitExtent=function(t,e){return wa(w,t,e)},w.fitSize=function(t,e){return Ca(w,t,e)},w.fitWidth=function(t,e){return Ea(w,t,e)},w.fitHeight=function(t,e){return Pa(w,t,e)},function(){return e=t.apply(this,arguments),w.invert=e.invert&&C,E()}}function Ha(t){var e=0,i=yn/3,n=za(t),r=n(e,i);return r.parallels=function(t){return arguments.length?n(e=t[0]*kn,i=t[1]*kn):[e*xn,i*xn]},r}function Na(t,e){var i=Pn(t),n=(i+Pn(e))/2;if(Sn(n)<gn)return function(t){var e=Tn(t);function i(t,i){return[t*e,Pn(i)/e]}return i.invert=function(t,i){return[t/e,Dn(i*e)]},i}(t);var r=1+i*(2*n-i),a=Rn(r)/n;function o(t,e){var i=Rn(r-2*n*Pn(e))/n;return[i*Pn(t*=n),a-i*Tn(t)]}return o.invert=function(t,e){var i=a-e,o=Mn(t,Sn(i))*Bn(i);return i*n<0&&(o-=yn*Bn(t)*Bn(i)),[o/n,Dn((r-(t*t+i*i)*n*n)/(2*n))]},o}function Va(){return Ha(Na).scale(155.424).center([0,33.6442])}function ja(){return Va().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Ua(t){return function(e,i){var n=Tn(e),r=Tn(i),a=t(n*r);return[a*r*Pn(e),a*Pn(i)]}}function Wa(t){return function(e,i){var n=Rn(e*e+i*i),r=t(n),a=Pn(r),o=Tn(r);return[Mn(e*a,n*o),Dn(n&&i*a/n)]}}var Ga=Ua((function(t){return Rn(2/(1+t))}));Ga.invert=Wa((function(t){return 2*Dn(t/2)}));var Ya=Ua((function(t){return(t=In(t))&&t/Pn(t)}));function Xa(t,e){return[t,Cn(Ln((mn+e)/2))]}function Ka(t){var e,i,n,r=Fa(t),a=r.center,o=r.scale,s=r.translate,l=r.clipExtent,u=null;function c(){var a=yn*o(),s=r(function(t){function e(e){return(e=t(e[0]*kn,e[1]*kn))[0]*=xn,e[1]*=xn,e}return t=Qn(t[0]*kn,t[1]*kn,t.length>2?t[2]*kn:0),e.invert=function(e){return(e=t.invert(e[0]*kn,e[1]*kn))[0]*=xn,e[1]*=xn,e},e}(r.rotate()).invert([0,0]));return l(null==u?[[s[0]-a,s[1]-a],[s[0]+a,s[1]+a]]:t===Xa?[[Math.max(s[0]-a,u),e],[Math.min(s[0]+a,i),n]]:[[u,Math.max(s[1]-a,e)],[i,Math.min(s[1]+a,n)]])}return r.scale=function(t){return arguments.length?(o(t),c()):o()},r.translate=function(t){return arguments.length?(s(t),c()):s()},r.center=function(t){return arguments.length?(a(t),c()):a()},r.clipExtent=function(t){return arguments.length?(null==t?u=e=i=n=null:(u=+t[0][0],e=+t[0][1],i=+t[1][0],n=+t[1][1]),c()):null==u?null:[[u,e],[i,n]]},c()}function qa(t){return Ln((mn+t)/2)}function Za(t,e){var i=Tn(t),n=t===e?Pn(t):Cn(i/Tn(e))/Cn(qa(e)/qa(t)),r=i*En(qa(t),n)/n;if(!n)return Xa;function a(t,e){r>0?e<-mn+gn&&(e=-mn+gn):e>mn-gn&&(e=mn-gn);var i=r/En(qa(e),n);return[i*Pn(n*t),r-i*Tn(n*t)]}return a.invert=function(t,e){var i=r-e,a=Bn(n)*Rn(t*t+i*i),o=Mn(t,Sn(i))*Bn(i);return i*n<0&&(o-=yn*Bn(t)*Bn(i)),[o/n,2*An(En(r/a,1/n))-mn]},a}function Ja(t,e){return[t,e]}function Qa(t,e){var i=Tn(t),n=t===e?Pn(t):(i-Tn(e))/(e-t),r=i/n+t;if(Sn(n)<gn)return Ja;function a(t,e){var i=r-e,a=n*t;return[i*Pn(a),r-i*Tn(a)]}return a.invert=function(t,e){var i=r-e,a=Mn(t,Sn(i))*Bn(i);return i*n<0&&(a-=yn*Bn(t)*Bn(i)),[a/n,r-Bn(n)*Rn(t*t+i*i)]},a}Ya.invert=Wa((function(t){return t})),Xa.invert=function(t,e){return[t,2*An(wn(e))-mn]},Ja.invert=Ja;var $a=1.340264,to=-.081106,eo=893e-6,io=.003796,no=Rn(3)/2;function ro(t,e){var i=Dn(no*Pn(e)),n=i*i,r=n*n*n;return[t*Tn(i)/(no*($a+3*to*n+r*(7*eo+9*io*n))),i*($a+to*n+r*(eo+io*n))]}function ao(t,e){var i=Tn(e),n=Tn(t)*i;return[i*Pn(t)/n,Pn(e)/n]}function oo(t,e){var i=e*e,n=i*i;return[t*(.8707-.131979*i+n*(n*(.003971*i-.001529*n)-.013791)),e*(1.007226+i*(.015085+n*(.028874*i-.044475-.005916*n)))]}function so(t,e){return[Tn(e)*Pn(t),Pn(e)]}function lo(t,e){var i=Tn(e),n=1+Tn(t)*i;return[i*Pn(t)/n,Pn(e)/n]}function uo(t,e){return[Cn(Ln((mn+e)/2)),-t]}function co(t){return t}function ho(t,e){var i=e.id,n=e.bbox,r=null==e.properties?{}:e.properties,a=function(t,e){var i=function(t){if(null==t)return co;var e,i,n=t.scale[0],r=t.scale[1],a=t.translate[0],o=t.translate[1];return function(t,s){s||(e=i=0);var l=2,u=t.length,c=new Array(u);for(c[0]=(e+=t[0])*n+a,c[1]=(i+=t[1])*r+o;l<u;)c[l]=t[l],++l;return c}}(t.transform),n=t.arcs;function r(t,e){e.length&&e.pop();for(var r=n[t<0?~t:t],a=0,o=r.length;a<o;++a)e.push(i(r[a],a));t<0&&function(t,e){for(var i,n=t.length,r=n-e;r<--n;)i=t[r],t[r++]=t[n],t[n]=i}(e,o)}function a(t){return i(t)}function o(t){for(var e=[],i=0,n=t.length;i<n;++i)r(t[i],e);return e.length<2&&e.push(e[0]),e}function s(t){for(var e=o(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(s)}function u(t){var e,i=t.type;switch(i){case"GeometryCollection":return{type:i,geometries:t.geometries.map(u)};case"Point":e=a(t.coordinates);break;case"MultiPoint":e=t.coordinates.map(a);break;case"LineString":e=o(t.arcs);break;case"MultiLineString":e=t.arcs.map(o);break;case"Polygon":e=l(t.arcs);break;case"MultiPolygon":e=t.arcs.map(l);break;default:return null}return{type:i,coordinates:e}}return u(e)}(t,e);return null==i&&null==n?{type:"Feature",properties:r,geometry:a}:null==n?{type:"Feature",id:i,properties:r,geometry:a}:{type:"Feature",id:i,bbox:n,properties:r,geometry:a}}ro.invert=function(t,e){for(var i,n=e,r=n*n,a=r*r*r,o=0;o<12&&(a=(r=(n-=i=(n*($a+to*r+a*(eo+io*r))-e)/($a+3*to*r+a*(7*eo+9*io*r)))*n)*r*r,!(Sn(i)<1e-12));++o);return[no*t*($a+3*to*r+a*(7*eo+9*io*r))/Tn(n),Dn(Pn(n)/no)]},ao.invert=Wa(An),oo.invert=function(t,e){var i,n=e,r=25;do{var a=n*n,o=a*a;n-=i=(n*(1.007226+a*(.015085+o*(.028874*a-.044475-.005916*o)))-e)/(1.007226+a*(.045255+o*(.259866*a-.311325-.005916*11*o)))}while(Sn(i)>gn&&--r>0);return[t/(.8707+(a=n*n)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),n]},so.invert=Wa(Dn),lo.invert=Wa((function(t){return 2*An(t)})),uo.invert=function(t,e){return[-e,2*An(wn(t))-mn]};var po={exports:{}},fo=function(t,e){this.p1=t,this.p2=e};fo.prototype.rise=function(){return this.p2[1]-this.p1[1]},fo.prototype.run=function(){return this.p2[0]-this.p1[0]},fo.prototype.slope=function(){return this.rise()/this.run()},fo.prototype.yIntercept=function(){return this.p1[1]-this.p1[0]*this.slope(this.p1,this.p2)},fo.prototype.isVertical=function(){return!isFinite(this.slope())},fo.prototype.isHorizontal=function(){return this.p1[1]==this.p2[1]},fo.prototype._perpendicularDistanceHorizontal=function(t){return Math.abs(this.p1[1]-t[1])},fo.prototype._perpendicularDistanceVertical=function(t){return Math.abs(this.p1[0]-t[0])},fo.prototype._perpendicularDistanceHasSlope=function(t){var e=this.slope(),i=this.yIntercept();return Math.abs(e*t[0]-t[1]+i)/Math.sqrt(Math.pow(e,2)+1)},fo.prototype.perpendicularDistance=function(t){return this.isVertical()?this._perpendicularDistanceVertical(t):this.isHorizontal()?this._perpendicularDistanceHorizontal(t):this._perpendicularDistanceHasSlope(t)};var vo=fo,go=function(t,e){for(var i=0,n=0,r=1;r<=t.length-2;r++){var a=new vo(t[0],t[t.length-1]).perpendicularDistance(t[r]);a>i&&(n=r,i=a)}if(i>e)var o=go(t.slice(0,n),e),s=go(t.slice(n,t.length),e),l=o.concat(s);else l=t.length>1?[t[0],t[t.length-1]]:[t[0]];return l},yo=go;!function(t){var e=yo;function i(e,i){var n=e.geometry,r=n.type;if("LineString"===r)n.coordinates=t.exports.simplify(n.coordinates,i);else if("Polygon"===r||"MultiLineString"===r)for(var a=0;a<n.coordinates.length;a++)n.coordinates[a]=t.exports.simplify(n.coordinates[a],i);else if("MultiPolygon"===r)for(var o=0;o<n.coordinates.length;o++)for(var s=0;s<n.coordinates[o].length;s++)n.coordinates[o][s]=t.exports.simplify(n.coordinates[o][s],i);return e}t.exports=function(t,e,n){return n||(t=JSON.parse(JSON.stringify(t))),t.features?function(t,e){for(var n=0;n<t.features.length;n++)t.features[n]=i(t.features[n],e);return t}(t,e):t.type&&"Feature"===t.type?i(t,e):new Error("FeatureCollection or individual Feature required")},t.exports.simplify=function(t,i){return e(t,i)}}(po);var mo=O(po.exports),_o=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return ko.apply(void 0,[dt(t)].concat(i))};function bo(t,e,i){var n=e[i];if(void 0===n)t[i]=null;else if(W(n))for(var r in W(t[i])||(t[i]={}),n)bo(t[i],n,r);else t[i]=n}function xo(t,e){if(W(e)&&t!==e)for(var i in e)bo(t,e,i)}function ko(t){t||(t={});for(var e=-1,i=arguments.length<=1?0:arguments.length-1;++e<i;)xo(t,e+1<1||arguments.length<=e+1?void 0:arguments[e+1]);return t}var So,Ao={tolerance:.01},Mo=function(t,e){var i=_o(Ao,e).tolerance;return mo(t,i)};!function(t){t.DSV="dsv",t.TREE="tree",t.GEO="geo",t.BYTE="bytejson",t.HEX="hex",t.GRAPH="graph",t.TABLE="table",t.GEO_GRATICULE="geo-graticule"}(So||(So={}));var To=function(t,e){for(var i=e.fields,n=e.key,r=e.value,a=e.retains,o=[],s=function(e){i.forEach((function(s){var l={};if(l[n]=s,l[r]=t[e][s],a)a.forEach((function(i){l[i]=t[e][i]}));else for(var u in t[e])-1===i.indexOf(u)&&(l[u]=t[e][u]);o.push(l)}))},l=0;l<t.length;l++)s(l);return o},wo=function(t,e){var i,n;if(!(null==e?void 0:e.fields))return t;if(0===t.length)return t;var r=e.fields,a=t[0],o={},s=[],l=function(e){if(Object.prototype.hasOwnProperty.call(r,e)){var l,u=r[e];if(u.sort&&(et(u.sortIndex)||(u.sortIndex=0),U(u.sortReverse)||(u.sortReverse="desc"===u.sort)),!u.type){var c=a;e in a||(c=null!==(i=t.find((function(t){return e in t})))&&void 0!==i?i:a),u.type="number"==typeof c[e]?"linear":"ordinal"}if("number"==typeof u.sortIndex&&(l={key:e,type:u.type,index:u.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:!0===u.sortReverse},s.push(l)),(null===(n=u.domain)||void 0===n?void 0:n.length)>0)if("ordinal"===u.type){u._domainCache={},o[e]=u;var h={};u.domain.forEach((function(t,e){h[t]=e,u._domainCache[t]=e})),l&&(l.sortIndex=h,l.sortIndexCount=u.domain.length)}else u.domain.length>=2&&(o[e]=u)}};for(var u in r)l(u);return Object.keys(o).length>0&&(t=t.filter((function(t){for(var e in o){var i=o[e];if("ordinal"===i.type){if(!(t[e]in i._domainCache))return!1}else if(i.domain[0]>t[e]||i.domain[1]<t[e])return!1}return!0}))),s.sort((function(t,e){return t.index-e.index})),t.sort((function(t,e){return function(t,e,i){for(var n=0;n<i.length;n++){var r=i[n],a=0;if("ordinal"===r.type?(void 0===r.sortIndex[e[r.key]]&&(r.sortIndex[e[r.key]]=r.sortIndexCount++),void 0===r.sortIndex[t[r.key]]&&(r.sortIndex[t[r.key]]=r.sortIndexCount++),a=r.sortIndex[t[r.key]]-r.sortIndex[e[r.key]]):"linear"===r.type&&(a=t[r.key]-e[r.key]),r.sortReverse&&(a=-a),0!==a)return a}return 0}(t,e,s)})),t};var Co={},Eo={};function Po(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function Bo(t){var e=Object.create(null),i=[];return t.forEach((function(t){for(var n in t)n in e||i.push(e[n]=n)})),i}function Ro(t,e){var i=t+"",n=i.length;return n<e?new Array(e-n+1).join(0)+i:i}function Lo(t){var e,i=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+Ro(-e,6):e>9999?"+"+Ro(e,6):Ro(e,4))+"-"+Ro(t.getUTCMonth()+1,2)+"-"+Ro(t.getUTCDate(),2)+(a?"T"+Ro(i,2)+":"+Ro(n,2)+":"+Ro(r,2)+"."+Ro(a,3)+"Z":r?"T"+Ro(i,2)+":"+Ro(n,2)+":"+Ro(r,2)+"Z":n||i?"T"+Ro(i,2)+":"+Ro(n,2)+"Z":"")}function Io(t){var e=new RegExp('["'+t+"\n\r]"),i=t.charCodeAt(0);function n(t,e){var n,r=[],a=t.length,o=0,s=0,l=a<=0,u=!1;function c(){if(l)return Eo;if(u)return u=!1,Co;var e,n,r=o;if(34===t.charCodeAt(r)){for(;o++<a&&34!==t.charCodeAt(o)||34===t.charCodeAt(++o););return(e=o)>=a?l=!0:10===(n=t.charCodeAt(o++))?u=!0:13===n&&(u=!0,10===t.charCodeAt(o)&&++o),t.slice(r+1,e-1).replace(/""/g,'"')}for(;o<a;){if(10===(n=t.charCodeAt(e=o++)))u=!0;else if(13===n)u=!0,10===t.charCodeAt(o)&&++o;else if(n!==i)continue;return t.slice(r,e)}return l=!0,t.slice(r,a)}for(10===t.charCodeAt(a-1)&&--a,13===t.charCodeAt(a-1)&&--a;(n=c())!==Eo;){for(var h=[];n!==Co&&n!==Eo;)h.push(n),n=c();e&&null==(h=e(h,s++))||r.push(h)}return r}function r(e,i){return e.map((function(e){return i.map((function(t){return o(e[t])})).join(t)}))}function a(e){return e.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?Lo(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var i,r,a=n(t,(function(t,n){if(i)return i(t,n-1);r=t,i=e?function(t,e){var i=Po(t);return function(n,r){return e(i(n),r,t)}}(t,e):Po(t)}));return a.columns=r||[],a},parseRows:n,format:function(e,i){return null==i&&(i=Bo(e)),[i.map(o).join(t)].concat(r(e,i)).join("\n")},formatBody:function(t,e){return null==e&&(e=Bo(t)),r(t,e).join("\n")},formatRows:function(t){return t.map(a).join("\n")},formatRow:a,formatValue:o}}var Do=Io(",").parse,Oo=Io("\t").parse,Fo={delimiter:","},zo=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(arguments.length>2?arguments[2]:void 0).type=So.DSV;var i=_o(Fo,e).delimiter;if(!K(i))throw new TypeError("Invalid delimiter: must be a string!");return Io(i).parse(t)},Ho=function(t){return(arguments.length>2?arguments[2]:void 0).type=So.DSV,Do(t)},No=function(t){return(arguments.length>2?arguments[2]:void 0).type=So.DSV,Oo(t)};function Vo(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return jo(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(i){switch(i){case"type":case"features":return;default:e[i]=t[i]}})),e.features=t.features.map((function(t){return jo(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Wo(t);default:throw new Error("unknown GeoJSON type")}}function jo(t){var e={type:"Feature"};return Object.keys(t).forEach((function(i){switch(i){case"type":case"properties":case"geometry":return;default:e[i]=t[i]}})),e.properties=Uo(t.properties),e.geometry=Wo(t.geometry),e}function Uo(t){var e={};return t?(Object.keys(t).forEach((function(i){var n=t[i];"object"===k(n)?null===n?e[i]=null:Array.isArray(n)?e[i]=n.map((function(t){return t})):e[i]=Uo(n):e[i]=n})),e):e}function Wo(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return Wo(t)})),e):(e.coordinates=Go(t.coordinates),e)}function Go(t){var e=t;return"object"!==k(e[0])?e.slice():e.map((function(t){return Go(t)}))}function Yo(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Xo(t){for(var e,i,n=Yo(t),r=0,a=1;a<n.length;)e=i||n[0],r+=((i=n[a])[0]-e[0])*(i[1]+e[1]),a++;return r>0}function Ko(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function qo(t,e){var i,n,r,a,o,s,l,u,c,h,d=0,p="FeatureCollection"===t.type,f="Feature"===t.type,v=p?t.features.length:1;for(i=0;i<v;i++){for(s=p?t.features[i].geometry:f?t.geometry:t,u=p?t.features[i].properties:f?t.properties:{},c=p?t.features[i].bbox:f?t.bbox:void 0,h=p?t.features[i].id:f?t.id:void 0,o=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,r=0;r<o;r++)if(null!==(a=l?s.geometries[r]:s))switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(a,d,u,c,h))return!1;break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===e(a.geometries[n],d,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,u,c,h))return!1;d++}}function Zo(t,e){if(!(i=e=e||{})||i.constructor!==Object)throw new Error("options is invalid");var i,n=e.reverse||!1,r=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof n)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof r)throw new Error("<mutate> must be a boolean");!1===r&&(t=Vo(t));var a=[];switch(t.type){case"GeometryCollection":return qo(t,(function(t){Jo(t,n)})),t;case"FeatureCollection":return Ko(t,(function(t){Ko(Jo(t,n),(function(t){a.push(t)}))})),Hi(a)}return Jo(t,n)}function Jo(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return qo(t,(function(t){Jo(t,e)})),t;case"LineString":return Qo(Yo(t),e),t;case"Polygon":return $o(Yo(t),e),t;case"MultiLineString":return Yo(t).forEach((function(t){Qo(t,e)})),t;case"MultiPolygon":return Yo(t).forEach((function(t){$o(t,e)})),t;case"Point":case"MultiPoint":return t}}function Qo(t,e){Xo(t)===e&&t.reverse()}function $o(t,e){Xo(t[0])!==e&&t[0].reverse();for(var i=1;i<t.length;i++)Xo(t[i])===e&&t[i].reverse()}function ts(t){if(!t)throw new Error("geojson is required");var e=[];return function(t,e){qo(t,(function(t,i,n,r,a){var o,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==e(zi(t,n,{bbox:r,id:a}),i,0)&&void 0}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var l=0;l<t.coordinates.length;l++){var u=t.coordinates[l];if(!1===e(zi({type:o,coordinates:u},n),i,l))return!1}}))}(t,(function(t){e.push(t)})),Hi(e)}var es=Sa(),is={centroid:!1,name:!1,bbox:!1,rewind:!1},ns=function(t){if(t.geometry.type.startsWith("Multi")){var e=ts(t).features[0];return Object.assign(Object.assign({},e),e.properties)}return Object.assign(Object.assign({},t),t.properties)},rs=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(arguments.length>2?arguments[2]:void 0).type=So.GEO;var i=_o(is,e),n=i.centroid,r=i.name,a=i.bbox,o=i.rewind;if(Array.isArray(t))return function(t){var e=[];return t.forEach((function(t){"FeatureCollection"===t.type?t.features.forEach((function(t){e.push(ns(t))})):e.push(ns(t))})),e}(t);var s=t.features;return o&&(s=Zo(t,{reverse:!W(o)||o.reverse}).features),s.forEach((function(t){if(n){var e=es.centroid(t);t.centroidX=e[0],t.centroidY=e[1]}if(r&&(t.name=t.properties.name),a){var i=es.bounds(t);t.bbox=i}})),t.features=s,t},as={},os=function(t,e,i){i.type=So.GEO;var n=_o(is,as,e),r=n.object;if(!K(r))throw new TypeError("Invalid object: must be a string!");var a,o,s=(a=t,"string"==typeof(o=t.objects[r])&&(o=a.objects[o]),"GeometryCollection"===o.type?{type:"FeatureCollection",features:o.geometries.map((function(t){return ho(a,t)}))}:ho(a,o));return rs(s,n,i)},ss=function(t,e,i){var n=!N(null==e?void 0:e.dependencyUpdate)||(null==e?void 0:e.dependencyUpdate);if(!t||!q(t))throw new TypeError("Invalid data: must be DataView array!");return q(i.rawData)&&i.rawData.forEach((function(t){t.target&&(t.target.removeListener("change",i.reRunAllTransform),t.target.removeListener("markRunning",i.markRunning))})),n&&t.forEach((function(t){t.target.addListener("change",i.reRunAllTransform),t.target.addListener("markRunning",i.markRunning)})),t},ls=0;function us(){return ls>1e8&&(ls=0),(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dataset")+"_"+ls++}var cs=function(){return o((function t(e){var i,n;r(this,t),this.options=e,this.isDataSet=!0,this.transformMap={},this.parserMap={},this.dataViewMap={},this.target=new z,n=(null==e?void 0:e.name)?e.name:us("dataset"),this.name=n,this._logger=null!==(i=null==e?void 0:e.logger)&&void 0!==i?i:Ot.getInstance()}),[{key:"setLogger",value:function(t){this._logger=t}},{key:"getDataView",value:function(t){return this.dataViewMap[t]}},{key:"setDataView",value:function(t,e){var i;this.dataViewMap[t]&&(null===(i=this._logger)||void 0===i||i.error("Error: dataView ".concat(t," 之前已存在，请重新命名"))),this.dataViewMap[t]=e}},{key:"removeDataView",value:function(t){this.dataViewMap[t]=null,delete this.dataViewMap[t]}},{key:"registerParser",value:function(t,e){var i;this.parserMap[t]&&(null===(i=this._logger)||void 0===i||i.warn("Warn: transform ".concat(t," 之前已注册，执行覆盖逻辑"))),this.parserMap[t]=e}},{key:"removeParser",value:function(t){this.parserMap[t]=null,delete this.parserMap[t]}},{key:"getParser",value:function(t){return this.parserMap[t]||this.parserMap.default}},{key:"registerTransform",value:function(t,e){var i;this.transformMap[t]&&(null===(i=this._logger)||void 0===i||i.warn("Warn: transform ".concat(t," 之前已注册，执行覆盖逻辑"))),this.transformMap[t]=e}},{key:"removeTransform",value:function(t){this.transformMap[t]=null,delete this.transformMap[t]}},{key:"getTransform",value:function(t){return this.transformMap[t]}},{key:"multipleDataViewAddListener",value:function(t,e,i){this._callMap||(this._callMap=new Map);var n=this._callMap.get(i);n||(n=function(){t.some((function(t){return t.isRunning}))||i()}),t.forEach((function(t){t.target.addListener(e,n)})),this._callMap.set(i,n)}},{key:"allDataViewAddListener",value:function(t,e){this.multipleDataViewAddListener(Object.values(this.dataViewMap),t,e)}},{key:"multipleDataViewRemoveListener",value:function(t,e,i){if(this._callMap){var n=this._callMap.get(i);n&&t.forEach((function(t){t.target.removeListener(e,n)})),this._callMap.delete(i)}}},{key:"multipleDataViewUpdateInParse",value:function(t){var e=this;t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.markRunning()})),t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.parseNewData(t.data,t.options)}))}},{key:"multipleDataViewUpdateInRawData",value:function(t){var e=this;t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.markRunning()})),t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.updateRawData(t.data,t.options)}))}},{key:"destroy",value:function(){this.transformMap=null,this.parserMap=null,this.dataViewMap=null,this._callMap=null,this.target.removeAllListeners()}}])}(),hs=function(){function t(e,i){var n,a=this;r(this,t),this.dataSet=e,this.options=i,this.isDataView=!0,this.target=new z,this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=a.latestData;return a.isRunning=!0,a.resetTransformData(),a.transformsArr.forEach((function(e){a.executeTransform(e,{pushHistory:t.pushHistory,emitMessage:!1})})),a.isRunning=!1,!1===t.emitMessage||t.skipEqual&&bt(e,a.latestData)||a.target.emit("change",{latestData:a.latestData}),a},this.markRunning=function(){a.isRunning=!0,a.target.emit("markRunning",[])},n=(null==i?void 0:i.name)?i.name:us("dataview"),this.name=n,(null==i?void 0:i.history)&&(this.history=i.history,this.historyData=[]),this.dataSet.setDataView(n,this),this.setFields(null==i?void 0:i.fields)}return o(t,[{key:"parse",value:function(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isRunning=!0,n&&this.target.emit("beforeParse",[]),e&&(this.parseOption=e);var r=this.cloneParseData(t,e);if(null==e?void 0:e.type){var a=(null!==(i=this.dataSet.getParser(e.type))&&void 0!==i?i:this.dataSet.getParser("bytejson"))(r,e.options,this);this.rawData=r,this.parserData=a,this.history&&this.historyData.push(r,a),this.latestData=a}else this.parserData=r,this.rawData=r,this.history&&this.historyData.push(r),this.latestData=r;return this.isRunning=!1,n&&this.target.emit("afterParse",[]),this}},{key:"transform",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.isRunning=!0,t&&t.type){var i=!0;if("fields"===t.type){this._fields=t.options.fields;var n=this.transformsArr.findIndex((function(e){return e.type===t.type}));n>=0&&(i=!1,this.transformsArr[n].options.fields=this._fields)}i&&this.transformsArr.push(t),e&&this.executeTransform(t)}return this.sortTransform(),this.isRunning=!1,this}},{key:"sortTransform",value:function(){this.transformsArr.length>=2&&this.transformsArr.sort((function(t,e){var i,n;return(null!==(i=t.level)&&void 0!==i?i:0)-(null!==(n=e.level)&&void 0!==n?n:0)}))}},{key:"executeTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.pushHistory,n=e.emitMessage,r=e.skipEqual,a=this.dataSet.getTransform(t.type),o=this.latestData,s=a(o,t.options);this.history&&!1!==i&&this.historyData.push(s),this.latestData=s,!1===n||r&&bt(o,this.latestData)||this.target.emit("change",{latestData:this.latestData})}},{key:"resetTransformData",value:function(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}},{key:"cloneParseData",value:function(e,i){var n=!1;return e instanceof t||!0!==(null==i?void 0:i.clone)||(n=!0),n?dt(e):e}},{key:"parseNewData",value:function(t,e){this.parse(t,e||this.parseOption),this.reRunAllTransform()}},{key:"updateRawData",value:function(t,e){var i=this.cloneParseData(t,e);this.rawData=i,this.parserData=i,this.latestData=i,this.reRunAllTransform()}},{key:"getFields",value:function(){var t;return this._fields?this._fields:"dataview"===(null===(t=this.parseOption)||void 0===t?void 0:t.type)&&1===this.rawData.length&&this.rawData[0].getFields?this.rawData[0].getFields():null}},{key:"setFields",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._fields=t&&e?gt({},this._fields,t):t;var i=this.transformsArr.find((function(t){return"fields"===t.type}));!j(this._fields)&&j(i)?(this.dataSet.registerTransform("fields",wo),this.transform({type:"fields",options:{fields:this._fields}},!1)):i&&(i.options.fields=this._fields)}},{key:"destroy",value:function(){this.dataSet.removeDataView(this.name),this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}}])}();Sa();var ds={},ps={albers:ja,albersusa:function(){var t,e,i,n,r,a,o=ja(),s=Va().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=Va().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,e){a=[t,e]}};function c(t){var e=t[0],o=t[1];return a=null,i.point(e,o),a||(n.point(e,o),a)||(r.point(e,o),a)}function h(){return t=e=null,c}return c.invert=function(t){var e=o.scale(),i=o.translate(),n=(t[0]-i[0])/e,r=(t[1]-i[1])/e;return(r>=.12&&r<.234&&n>=-.425&&n<-.214?s:r>=.166&&r<.234&&n>=-.214&&n<-.115?l:o).invert(t)},c.stream=function(i){return t&&e===i?t:(n=[o.stream(e=i),s.stream(i),l.stream(i)],r=n.length,t={point:function(t,e){for(var i=-1;++i<r;)n[i].point(t,e)},sphere:function(){for(var t=-1;++t<r;)n[t].sphere()},lineStart:function(){for(var t=-1;++t<r;)n[t].lineStart()},lineEnd:function(){for(var t=-1;++t<r;)n[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<r;)n[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<r;)n[t].polygonEnd()}});var n,r},c.precision=function(t){return arguments.length?(o.precision(t),s.precision(t),l.precision(t),h()):o.precision()},c.scale=function(t){return arguments.length?(o.scale(t),s.scale(.35*t),l.scale(t),c.translate(o.translate())):o.scale()},c.translate=function(t){if(!arguments.length)return o.translate();var e=o.scale(),a=+t[0],c=+t[1];return i=o.translate(t).clipExtent([[a-.455*e,c-.238*e],[a+.455*e,c+.238*e]]).stream(u),n=s.translate([a-.307*e,c+.201*e]).clipExtent([[a-.425*e+gn,c+.12*e+gn],[a-.214*e-gn,c+.234*e-gn]]).stream(u),r=l.translate([a-.205*e,c+.212*e]).clipExtent([[a-.214*e+gn,c+.166*e+gn],[a-.115*e-gn,c+.234*e-gn]]).stream(u),h()},c.fitExtent=function(t,e){return wa(c,t,e)},c.fitSize=function(t,e){return Ca(c,t,e)},c.fitWidth=function(t,e){return Ea(c,t,e)},c.fitHeight=function(t,e){return Pa(c,t,e)},c.scale(1070)},azimuthalequalarea:function(){return Fa(Ga).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return Fa(Ya).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return Ha(Za).scale(109.5).parallels([30,30])},conicequalarea:Va,conicequidistant:function(){return Ha(Qa).scale(131.154).center([0,13.9389])},equalearth:function(){return Fa(ro).scale(177.158)},equirectangular:function(){return Fa(Ja).scale(152.63)},gnomonic:function(){return Fa(ao).scale(144.049).clipAngle(60)},identity:function(){var t,e,i,n,r,a,o,s=1,l=0,u=0,c=1,h=1,d=0,p=null,f=1,v=1,g=Aa({point:function(t,e){var i=_([t,e]);this.stream.point(i[0],i[1])}}),y=kr;function m(){return f=s*c,v=s*h,a=o=null,_}function _(i){var n=i[0]*f,r=i[1]*v;if(d){var a=r*t-n*e;n=n*t+r*e,r=a}return[n+l,r+u]}return _.invert=function(i){var n=i[0]-l,r=i[1]-u;if(d){var a=r*t+n*e;n=n*t-r*e,r=a}return[n/f,r/v]},_.stream=function(t){return a&&o===t?a:a=g(y(o=t))},_.postclip=function(t){return arguments.length?(y=t,p=i=n=r=null,m()):y},_.clipExtent=function(t){return arguments.length?(y=null==t?(p=i=n=r=null,kr):xr(p=+t[0][0],i=+t[0][1],n=+t[1][0],r=+t[1][1]),m()):null==p?null:[[p,i],[n,r]]},_.scale=function(t){return arguments.length?(s=+t,m()):s},_.translate=function(t){return arguments.length?(l=+t[0],u=+t[1],m()):[l,u]},_.angle=function(i){return arguments.length?(e=Pn(d=i%360*kn),t=Tn(d),m()):d*xn},_.reflectX=function(t){return arguments.length?(c=t?-1:1,m()):c<0},_.reflectY=function(t){return arguments.length?(h=t?-1:1,m()):h<0},_.fitExtent=function(t,e){return wa(_,t,e)},_.fitSize=function(t,e){return Ca(_,t,e)},_.fitWidth=function(t,e){return Ea(_,t,e)},_.fitHeight=function(t,e){return Pa(_,t,e)},_},mercator:function(){return Ka(Xa).scale(961/bn)},naturalearth1:function(){return Fa(oo).scale(175.295)},orthographic:function(){return Fa(so).scale(249.5).clipAngle(90+gn)},stereographic:function(){return Fa(lo).scale(250).clipAngle(142)},transversemercator:function(){var t=Ka(uo),e=t.center,i=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?i([t[0],t[1],t.length>2?t[2]+90:90]):[(t=i())[0],t[1],t[2]-90]},i([0,0,90]).scale(159.155)}},fs=["clipAngle","clipExtent","scale","translate","center","rotate","precision","reflectX","reflectY","parallels","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function vs(t,e){return function i(){var n=e();return n.type=t,n.path=Sa().projection(n),n.copy=n.copy||function(){var t=i();return fs.forEach((function(e){n[e]&&t[e](n[e]())})),t.path.pointRadius(n.path.pointRadius()),t},n}}var gs=function(){function t(){r(this,t)}return o(t,null,[{key:"GenAutoIncrementId",value:function(){return t.auto_increment_id++}}])}();gs.auto_increment_id=0;var ys=o((function t(e){r(this,t),this.id=gs.GenAutoIncrementId(),this.registry=e})),ms="named",_s="inject",bs="multi_inject",xs="inversify:tagged",ks="inversify:paramtypes",Ss=function(){return o((function t(e,i){r(this,t),this.key=e,this.value=i}),[{key:"toString",value:function(){return this.key===ms?"named: ".concat(String(this.value).toString()," "):"tagged: { key:".concat(this.key.toString(),", value: ").concat(String(this.value)," }")}}])}(),As=function(t){var e;return function(t){var e="function"==typeof Symbol&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=Object.getPrototypeOf(Function),n=("object"==("undefined"==typeof process?"undefined":k(process))&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL,Map),r=new WeakMap;function a(t,e,i){var a=r.get(t);if(u(a)){if(!i)return;a=new n,r.set(t,a)}var o=a.get(e);if(u(o)){if(!i)return;o=new n,a.set(e,o)}return o}function o(t,e,i){if(s(t,e,i))return!0;var n=v(e);return!c(n)&&o(t,n,i)}function s(t,e,i){var n=a(e,i,!1);return!u(n)&&!!n.has(t)}function l(t,e,i){if(s(t,e,i))return function(t,e,i){var n=a(e,i,!1);if(!u(n))return n.get(t)}(t,e,i);var n=v(e);return c(n)?void 0:l(t,n,i)}function u(t){return void 0===t}function c(t){return null===t}function h(t){return"object"==k(t)?null!==t:"function"==typeof t}function d(t,i){switch(function(t){if(null===t)return 1;switch(k(t)){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===i?"string":5===i?"number":"default",r=function(t,e){var i=t[e];if(null!=i){if(!f(i))throw new TypeError;return i}}(t,e);if(void 0!==r){var a=r.call(t,n);if(h(a))throw new TypeError;return a}return function(t,e){if("string"===e){var i=t.toString;if(f(i)){var n=i.call(t);if(!h(n))return n}var r=t.valueOf;if(f(r)){var a=r.call(t);if(!h(a))return a}}else{var o=t.valueOf;if(f(o)){var s=o.call(t);if(!h(s))return s}var l=t.toString;if(f(l)){var u=l.call(t);if(!h(u))return u}}throw new TypeError}(t,"default"===n?"number":n)}function p(t){var e=d(t,3);return"symbol"==k(e)?e:function(t){return""+t}(e)}function f(t){return"function"==typeof t}function v(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===i)return e;if(e!==i)return e;var n=t.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return e;var a=r.constructor;return"function"!=typeof a||a===t?e:a}t("defineMetadata",(function(t,e,i,n){if(!h(i))throw new TypeError;return r=t,o=e,void a(i,n,!0).set(r,o);var r,o})),t("hasMetadata",(function(t,e,i){if(!h(e))throw new TypeError;return u(i)||(i=p(i)),o(t,e,i)})),t("hasOwnMetadata",(function(t,e,i){if(!h(e))throw new TypeError;return u(i)||(i=p(i)),s(t,e,i)})),t("getMetadata",(function(t,e,i){if(!h(e))throw new TypeError;return u(i)||(i=p(i)),l(t,e,i)}))}((e=t,function(t,i){"function"!=typeof e[t]&&Object.defineProperty(e,t,{configurable:!0,writable:!0,value:i})})),t}({});function Ms(t,e,i,n){!function(t,e,i,n){var r,a=[n],o={};As.hasOwnMetadata(t,e)&&(o=As.getMetadata(t,e));var s=o[i];void 0===s&&(s=[]),(r=s).push.apply(r,a),o[i]=s,As.defineMetadata(t,o,e)}(xs,t,i.toString(),n)}function Ts(t){return function(e,i,n){Ms(e,0,n,t)}}function ws(t){return function(e){return function(i,n,r){return Ts(new Ss(t,e))(i,n,r)}}}var Cs=ws(_s),Es=ws(bs);function Ps(){return function(t){return As.defineMetadata(ks,null,t),t}}function Bs(t){return Ts(new Ss(ms,t))}var Rs,Ls="Singleton",Is="Transient",Ds="ConstantValue",Os="DynamicValue",Fs="Factory",zs="Function",Hs="Instance",Ns="Invalid",Vs=function(){function t(e,i){r(this,t),this.id=gs.GenAutoIncrementId(),this.activated=!1,this.serviceIdentifier=e,this.scope=i,this.type=Ns,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.dynamicValue=null}return o(t,[{key:"clone",value:function(){var e=new t(this.serviceIdentifier,this.scope);return e.activated=e.scope===Ls&&this.activated,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.provider=this.provider,e.constraint=this.constraint,e.cache=this.cache,e}}])}(),js=function(){return o((function t(){r(this,t)}),[{key:"getConstructorMetadata",value:function(t){return{compilerGeneratedMetadata:As.getMetadata(ks,t),userGeneratedMetadata:As.getMetadata(xs,t)||{}}}},{key:"getPropertiesMetadata",value:function(t){throw new Error("暂未实现")}}])}(),Us=(Rs=ms,function(t){var e=function(e){if(null==e)return!1;if(e.key===Rs&&e.value===t)return!0;if(null==e.constructorArgsMetadata)return!1;for(var i=e.constructorArgsMetadata,n=0;n<i.length;n++)if(i[n].key===Rs&&i[n].value===t)return!0;return!1};return e.metaData=new Ss(Rs,t),e}),Ws=function(){return o((function t(e){r(this,t),this._binding=e}),[{key:"inRequestScope",value:function(){throw new Error("暂未实现")}},{key:"inSingletonScope",value:function(){return this._binding.scope=Ls,this}},{key:"inTransientScope",value:function(){return this._binding.scope=Is,this}},{key:"whenTargetNamed",value:function(t){return this._binding.constraint=Us(t),this}}])}(),Gs=function(){return o((function t(e){r(this,t),this._binding=e}),[{key:"to",value:function(t){return this._binding.type=Hs,this._binding.implementationType=t,new Ws(this._binding)}},{key:"toSelf",value:function(){var t=this._binding.serviceIdentifier;return this.to(t)}},{key:"toDynamicValue",value:function(t){return this._binding.type=Os,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new Ws(this._binding)}},{key:"toConstantValue",value:function(t){return this._binding.type=Ds,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Ls,new Ws(this._binding)}},{key:"toFactory",value:function(t){return this._binding.type=Fs,this._binding.factory=t,this._binding.scope=Ls,new Ws(this._binding)}},{key:"toService",value:function(t){this.toDynamicValue((function(e){return e.container.get(t)}))}}])}(),Ys=function(){return o((function t(e){r(this,t);var i=e||{};i.defaultScope=i.defaultScope||Is,this.options=i,this.id=gs.GenAutoIncrementId(),this._bindingDictionary=new Map,this._metadataReader=new js}),[{key:"load",value:function(t){var e=this._getContainerModuleHelpersFactory()(t.id);t.registry(e.bindFunction,e.unbindFunction,e.isboundFunction,e.rebindFunction)}},{key:"get",value:function(t){var e=this._getNotAllArgs(t,!1);return this._get(e)}},{key:"getAll",value:function(t){var e=this._getAllArgs(t);return this._get(e)}},{key:"getTagged",value:function(t,e,i){var n=this._getNotAllArgs(t,!1,e,i);return this._get(n)}},{key:"getNamed",value:function(t,e){return this.getTagged(t,ms,e)}},{key:"isBound",value:function(t){return this._bindingDictionary.has(t)}},{key:"bind",value:function(t){var e=this.options.defaultScope,i=new Vs(t,e),n=this._bindingDictionary.get(t)||[];return n.push(i),this._bindingDictionary.set(t,n),new Gs(i)}},{key:"unbind",value:function(t){this._bindingDictionary.delete(t)}},{key:"rebind",value:function(t){return this.unbind(t),this.bind(t)}},{key:"_getContainerModuleHelpersFactory",value:function(){var t=this,e=function(t,e){t._binding.moduleId=e},i=function(i){return function(n){var r=t.rebind(n);return e(r,i),r}};return function(n){return{bindFunction:(r=n,function(i){var n=t.bind(i);return e(n,r),n}),isboundFunction:function(e){return t.isBound(e)},rebindFunction:i(n),unbindFunction:function(e){return t.unbind(e)},unbindAsyncFunction:function(t){return null}};var r}}},{key:"_getNotAllArgs",value:function(t,e,i,n){return{avoidConstraints:!1,isMultiInject:e,serviceIdentifier:t,key:i,value:n}}},{key:"_getAllArgs",value:function(t){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:t}}},{key:"_get",value:function(t){var e=this,i=[];return this._bindingDictionary.get(t.serviceIdentifier).filter((function(e){return e.constraint(t)})).forEach((function(t){i.push(e._resolveFromBinding(t))})),t.isMultiInject||1!==i.length?i:i[0]}},{key:"_getChildRequest",value:function(t){for(var e=this,i=t.implementationType,n=this._metadataReader.getConstructorMetadata(i).userGeneratedMetadata,r=Object.keys(n),a=[],o=function(){var t=n[s],i={};t.forEach((function(t){i[t.key]=t.value}));var r={inject:i[_s],multiInject:i[bs]},o=r.inject||r.multiInject,l={serviceIdentifier:o,constructorArgsMetadata:t},u=(e._bindingDictionary.get(o)||[]).filter((function(t){return t.constraint(l)}));if(u.length){var c={injectIdentifier:o,metadata:t,bindings:u};a.push(c)}},s=0;s<r.length;s++)o();return a}},{key:"_resolveFromBinding",value:function(t){var e=this._getResolvedFromBinding(t);return this._saveToScope(t,e),e}},{key:"_getResolvedFromBinding",value:function(t){var e;switch(t.type){case Ds:case zs:e=t.cache;break;case Hs:e=this._resolveInstance(t,t.implementationType);break;default:e=t.dynamicValue({container:this})}return e}},{key:"_resolveInstance",value:function(t,e){if(t.activated)return t.cache;var i=this._getChildRequest(t);return this._createInstance(e,i)}},{key:"_createInstance",value:function(t,e){return e.length?function(t,e,i){if(d())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var r=new(t.bind.apply(t,n));return i&&y(r,i.prototype),r}(t,b(this._resolveRequests(e))):new t}},{key:"_resolveRequests",value:function(t){var e=this;return t.map((function(t){return t.bindings.length>1?t.bindings.map((function(t){return e._resolveFromBinding(t)})):e._resolveFromBinding(t.bindings[0])}))}},{key:"_saveToScope",value:function(t,e){t.scope===Ls&&(t.cache=e,t.activated=!0)}}])}(),Xs=Symbol("ContributionProvider"),Ks=function(){return o((function t(e,i){r(this,t),this.serviceIdentifier=e,this.container=i,Zs.setStore(this.serviceIdentifier,this)}),[{key:"getContributions",value:function(){var t;return this.caches||(this.caches=[],this.container&&this.container.isBound(this.serviceIdentifier)&&(t=this.caches).push.apply(t,b(this.container.getAll(this.serviceIdentifier)))),this.caches}},{key:"refresh",value:function(){var t;this.caches&&(this.caches.length=0,this.container&&this.container.isBound(this.serviceIdentifier)&&(t=this.caches).push.apply(t,b(this.container.getAll(this.serviceIdentifier))))}}])}();function qs(t,e){t(Xs).toDynamicValue((function(t){var i=t.container;return new Ks(e,i)})).inSingletonScope().whenTargetNamed(e)}var Zs=function(){return o((function t(){r(this,t)}),null,[{key:"getStore",value:function(t){return this.store.get(t)}},{key:"setStore",value:function(t,e){this.store.set(t,e)}},{key:"refreshAllContributions",value:function(){this.store.forEach((function(t){t.refresh()}))}}])}();Zs.store=new Map;var Js,Qs,$s,tl,el=function(){return o((function t(e,i){r(this,t),this._args=e,this.name=i,this.taps=[]}),[{key:"tap",value:function(t,e){this._tap("sync",t,e)}},{key:"unTap",value:function(t,e){var i="string"==typeof t?t.trim():t.name;i&&(this.taps=this.taps.filter((function(t){return!(t.name===i&&(!e||t.fn===e))})))}},{key:"_parseOptions",value:function(t,e,i){var n;if("string"==typeof e)n={name:e.trim()};else if("object"!=k(e)||null===e)throw new Error("Invalid tap options");if("string"!=typeof n.name||""===n.name)throw new Error("Missing name for tap");return n=Object.assign({type:t,fn:i},n)}},{key:"_tap",value:function(t,e,i){this._insert(this._parseOptions(t,e,i))}},{key:"_insert",value:function(t){var e;"string"==typeof t.before?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));var i=0;"number"==typeof t.stage&&(i=t.stage);for(var n=this.taps.length;n>0;){n--;var r=this.taps[n];this.taps[n+1]=r;var a=r.stage||0;if(e){if(e.has(r.name)){e.delete(r.name);continue}if(e.size>0)continue}if(!(a>i)){n++;break}}this.taps[n]=t}}])}(),il=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"call",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this.taps.map((function(t){return t.fn})).forEach((function(t){return t.apply(void 0,e)}))}}])}(el),nl=Symbol.for("EnvContribution"),rl=Symbol.for("VGlobal"),al=new(o((function t(){r(this,t)}))),ol=0,sl=function(){return o((function t(){var e=this;r(this,t),this.nextAnimationFrameCbs=new Map,this._rafHandle=null,this.runAnimationFrame=function(t){e._rafHandle=null;var i=e.nextAnimationFrameCbs;e.nextAnimationFrameCbs=new Map,i.forEach((function(e){return e(t)}))},this.tryRunAnimationFrameNextFrame=function(){null===e._rafHandle&&0!==e.nextAnimationFrameCbs.size&&(e._rafHandle=al.global.getRequestAnimationFrame()(e.runAnimationFrame))}}),[{key:"addAnimationFrameCb",value:function(t){return this.nextAnimationFrameCbs.set(++ol,t),this.tryRunAnimationFrameNextFrame(),ol}},{key:"removeAnimationFrameCb",value:function(t){return!!this.nextAnimationFrameCbs.has(t)&&(this.nextAnimationFrameCbs.delete(t),!0)}}])}(),ll=function(){return o((function t(){r(this,t),this._listenerMap=new Map,this._eventListenerTransformer=function(t){return t}}),[{key:"setEventListenerTransformer",value:function(t){this._eventListenerTransformer=t||function(t){return t}}},{key:"addEventListener",value:function(t,e,i){var n=this;if(e){var r=function(t){var i=n._eventListenerTransformer(t);"function"==typeof e?e(i):e.handleEvent&&e.handleEvent(i)};this._listenerMap.has(t)||this._listenerMap.set(t,new Map),this._listenerMap.get(t).set(e,r),this._nativeAddEventListener(t,r,i)}}},{key:"removeEventListener",value:function(t,e,i){var n;if(e){var r=null===(n=this._listenerMap.get(t))||void 0===n?void 0:n.get(e);r&&(this._nativeRemoveEventListener(t,r,i),this._listenerMap.get(t).delete(e),0===this._listenerMap.get(t).size&&this._listenerMap.delete(t))}}},{key:"dispatchEvent",value:function(t){return this._nativeDispatchEvent(t)}},{key:"clearAllEventListeners",value:function(){var t=this;this._listenerMap.forEach((function(e,i){e.forEach((function(e,n){t._nativeRemoveEventListener(i,e,void 0)}))})),this._listenerMap.clear()}},{key:"_nativeAddEventListener",value:function(t,e,i){throw new Error("_nativeAddEventListener must be implemented by derived classes")}},{key:"_nativeRemoveEventListener",value:function(t,e,i){throw new Error("_nativeRemoveEventListener must be implemented by derived classes")}},{key:"_nativeDispatchEvent",value:function(t){throw new Error("_nativeDispatchEvent must be implemented by derived classes")}}])}(),ul=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},cl=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},hl=function(t,e){return function(i,n){e(i,n,t)}},dl=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))},pl=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).contributions=t,i._isImageAnonymous=!0,i._performanceRAFList=[],i.eventListenerTransformer=function(t){return t},i.id=gs.GenAutoIncrementId(),i.hooks={onSetEnv:new il(["lastEnv","env","global"])},i.measureTextMethod="native",i.optimizeVisible=!1,i}return h(e,t),o(e,[{key:"env",get:function(){return this._env}},{key:"isImageAnonymous",get:function(){return this._isImageAnonymous},set:function(t){this._isImageAnonymous=t}},{key:"devicePixelRatio",get:function(){return this._env||this.setEnv("browser"),this.envContribution.getDevicePixelRatio()}},{key:"supportEvent",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportEvent},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportEvent=t}},{key:"supportsTouchEvents",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents=t}},{key:"supportsPointerEvents",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents=t}},{key:"supportsMouseEvents",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents=t}},{key:"applyStyles",get:function(){return this._env||this.setEnv("browser"),this.envContribution.applyStyles},set:function(t){this._env||this.setEnv("browser"),this.envContribution.applyStyles=t}},{key:"_nativeAddEventListener",value:function(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.addEventListener(t,e,i)}},{key:"_nativeRemoveEventListener",value:function(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.removeEventListener(t,e,i)}},{key:"_nativeDispatchEvent",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.dispatchEvent(t)}},{key:"bindContribution",value:function(t){var e=this,i=[];if(this.contributions.getContributions().forEach((function(n){var r=n.configure(e,t);r&&r.then&&i.push(r)})),i.length)return Promise.all(i)}},{key:"getDynamicCanvasCount",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getDynamicCanvasCount()}},{key:"getStaticCanvasCount",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getStaticCanvasCount()}},{key:"setEnv",value:function(t,e){if(e&&!0===e.force||this._env!==t)return this.deactiveCurrentEnv(),this.activeEnv(t,e)}},{key:"deactiveCurrentEnv",value:function(){this.envContribution&&this.envContribution.release()}},{key:"activeEnv",value:function(t,e){var i=this,n=this._env;this._env=t;var r=this.bindContribution(e);if(r&&r.then)return r.then((function(){i.envParams=e,i.hooks.onSetEnv.call(n,t,i)}));this.envParams=e,this.hooks.onSetEnv.call(n,t,this)}},{key:"setActiveEnvContribution",value:function(t){this.envContribution=t}},{key:"createCanvas",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.createCanvas(t)}},{key:"createOffscreenCanvas",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.createOffscreenCanvas(t)}},{key:"releaseCanvas",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.releaseCanvas(t)}},{key:"getRequestAnimationFrame",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getRequestAnimationFrame()}},{key:"getSpecifiedRequestAnimationFrame",value:function(t){this._env||this.setEnv("browser"),this._performanceRAFList[t]||(this._performanceRAFList[t]=new sl);var e=this._performanceRAFList[t];return function(t){return e.addAnimationFrameCb(t)}}},{key:"getSpecifiedCancelAnimationFrame",value:function(t){if(this._env||this.setEnv("browser"),!this._performanceRAFList[t])return function(){return!1};var e=this._performanceRAFList[t];return function(t){return e.removeAnimationFrameCb(t)}}},{key:"getCancelAnimationFrame",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getCancelAnimationFrame()}},{key:"getElementById",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.getElementById?this.envContribution.getElementById(t):null}},{key:"getRootElement",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getRootElement?this.envContribution.getRootElement():null}},{key:"getDocument",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getDocument?this.envContribution.getDocument():null}},{key:"mapToCanvasPoint",value:function(t,e){return this._env||this.setEnv("browser"),this.envContribution.mapToCanvasPoint?this.envContribution.mapToCanvasPoint(t,e):null}},{key:"loadImage",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadImage(t)}},{key:"loadSvg",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadSvg(t)}},{key:"loadJson",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadJson(t)}},{key:"loadArrayBuffer",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadArrayBuffer(t)}},{key:"loadBlob",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadBlob(t)}},{key:"loadFont",value:function(t,e,i){return dl(this,void 0,void 0,f().m((function n(){return f().w((function(n){for(;;)if(0===n.n)return n.a(2,(this._env||this.setEnv("browser"),this.envContribution.loadFont(t,e,i)))}),n,this)})))}},{key:"isChrome",value:function(){return null!=this._isChrome||(this._env||this.setEnv("browser"),this._isChrome="browser"===this._env&&navigator.userAgent.indexOf("Chrome")>-1),this._isChrome}},{key:"isSafari",value:function(){return null!=this._isSafari||(this._env||this.setEnv("browser"),this._isSafari="browser"===this._env&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)),this._isSafari}},{key:"getNativeAABBBounds",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.getNativeAABBBounds(t)}},{key:"removeDom",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.removeDom(t)}},{key:"createDom",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.createDom(t)}},{key:"updateDom",value:function(t,e){return this._env||this.setEnv("browser"),this.envContribution.updateDom(t,e)}},{key:"getElementTop",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._env||this.setEnv("browser"),this.envContribution.getElementTop(t,e)}},{key:"getElementLeft",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._env||this.setEnv("browser"),this.envContribution.getElementLeft(t,e)}},{key:"getElementTopLeft",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._env||this.setEnv("browser"),this.envContribution.getElementTopLeft(t,e)}},{key:"isMacOS",value:function(){return this._env||this.setEnv("browser"),this.envContribution.isMacOS()}},{key:"copyToClipBoard",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.copyToClipBoard(t)}}])}(ll);pl=ul([Ps(),hl(0,Cs(Xs)),hl(0,Bs(nl)),cl("design:paramtypes",[Object])],pl),function(t){t[t.estimate=0]="estimate",t[t.actualBounding=1]="actualBounding",t[t.fontBounding=2]="fontBounding"}(Js||(Js={})),function(t){t[t.INITIAL=0]="INITIAL",t[t.RUNNING=1]="RUNNING",t[t.PAUSE=2]="PAUSE"}(Qs||(Qs={})),function(t){t.wait="wait",t.from="from",t.to="to",t.customAnimate="customAnimate"}($s||($s={})),function(t){t[t.INITIAL=0]="INITIAL",t[t.RUNNING=1]="RUNNING",t[t.PAUSED=2]="PAUSED",t[t.END=3]="END"}(tl||(tl={}));var fl,vl,gl,yl,ml,_l,bl,xl,kl,Sl,Al,Ml,Tl=ye-1e-8,wl=function(){return o((function t(e){r(this,t),this.init(e)}),[{key:"init",value:function(t){this.bounds=t}},{key:"arc",value:function(t,e,i,n,r,a){if(Math.abs(r-n)>Tl)return this.bounds.add(t-i,e-i),void this.bounds.add(t+i,e+i);var o,s,l,u,c=1/0,h=-1/0,d=1/0,p=-1/0;function f(t){l=i*Math.cos(t),u=i*Math.sin(t),l<c&&(c=l),l>h&&(h=l),u<d&&(d=u),u>p&&(p=u)}if(f(n),f(r),r!==n)if((n%=ye)<0&&(n+=ye),(r%=ye)<0&&(r+=ye),r<n&&(a=!a,o=n,n=r,r=o),a)for(r-=ye,o=n-n%ge,s=0;s<4&&o>r;++s,o-=ge)f(o);else for(o=n-n%ge+ge,s=0;s<4&&o<r;++s,o+=ge)f(o);this.bounds.add(t+c,e+d),this.bounds.add(t+h,e+p)}},{key:"arcTo",value:function(t,e,i,n,r){this.bounds.add(t,e)}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a){this.bounds.add(t,e),this.bounds.add(i,n),this.bounds.add(r,a)}},{key:"closePath",value:function(){}},{key:"ellipse",value:function(){throw new Error("不支持ellipse")}},{key:"lineTo",value:function(t,e){this.bounds.add(t,e)}},{key:"moveTo",value:function(t,e){this.bounds.add(t,e)}},{key:"quadraticCurveTo",value:function(t,e,i,n){this.bounds.add(t,e),this.bounds.add(i,n)}},{key:"rect",value:function(t,e,i,n){this.bounds.add(t,e),this.bounds.add(t+i,e+n)}},{key:"clear",value:function(){this.bounds.clear()}},{key:"release",value:function(){}}])}(),Cl=function(){return o((function t(){r(this,t),this._curves=[],this.bounds=new _i}),[{key:"curves",get:function(){return this._curves}},{key:"getCurveLengths",value:function(){return this._curves.map((function(t){return t.getLength()}))}},{key:"getPointAt",value:function(t){return{x:0,y:0}}},{key:"getLength",value:function(){return 0}},{key:"getBounds",value:function(){return this.bounds}}])}(),El=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,Pl={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7},Bl={A:0,AT:1,C:2,Z:3,E:4,L:5,M:6,Q:7,R:8};function Rl(t){var e=t[0],i=t[1],n=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=l*a,c=-s*o,h=s*a,d=l*o,p=Math.cos(n),f=Math.sin(n),v=Math.cos(r),g=Math.sin(r),y=.5*(r-n),m=Math.sin(.5*y),_=8/3*m*m/Math.sin(y),b=e+p-_*f,x=i+f+_*p,k=e+v,S=i+g,A=k+_*g,M=S-_*v;return[u*b+c*x,h*b+d*x,u*A+c*M,h*A+d*M,u*k+c*S,h*k+d*S]}function Ll(t,e,i,n){for(var r=function(t,e,i,n,r,a,o,s,l){var u=Fe(o),c=Math.sin(u),h=Math.cos(u),d=h*(s-t)*.5+c*(l-e)*.5,p=h*(l-e)*.5-c*(s-t)*.5,f=d*d/((i=Math.abs(i))*i)+p*p/((n=Math.abs(n))*n);f>1&&(i*=f=Math.sqrt(f),n*=f);var v=h/i,g=c/i,y=-c/n,m=h/n,_=v*s+g*l,b=y*s+m*l,x=v*t+g*e,k=y*t+m*e,S=1/((x-_)*(x-_)+(k-b)*(k-b))-.25;S<0&&(S=0);var A=Math.sqrt(S);a===r&&(A=-A);var M=.5*(_+x)-A*(k-b),T=.5*(b+k)+A*(x-_),w=Math.atan2(b-T,_-M),C=Math.atan2(k-T,x-M)-w;C<0&&1===a?C+=ye:C>0&&0===a&&(C-=ye);for(var E=Math.ceil(Math.abs(C/(ge+.001))),P=[],B=0;B<E;++B){var R=w+B*C/E,L=w+(B+1)*C/E;P[B]=[M,T,R,L,i,n,c,h]}return P}(n[5],n[6],n[0],n[1],n[3],n[4],n[2],e,i),a=0;a<r.length;++a){var o=Rl(r[a]);t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}!function(t){t[t.NONE=0]="NONE",t[t.UPDATE_BOUNDS=1]="UPDATE_BOUNDS",t[t.UPDATE_SHAPE=2]="UPDATE_SHAPE",t[t.CLEAR_SHAPE=253]="CLEAR_SHAPE",t[t.UPDATE_SHAPE_AND_BOUNDS=3]="UPDATE_SHAPE_AND_BOUNDS",t[t.INIT=179]="INIT",t[t.CLEAR_BOUNDS=254]="CLEAR_BOUNDS",t[t.UPDATE_GLOBAL_MATRIX=32]="UPDATE_GLOBAL_MATRIX",t[t.CLEAR_GLOBAL_MATRIX=223]="CLEAR_GLOBAL_MATRIX",t[t.UPDATE_LOCAL_MATRIX=16]="UPDATE_LOCAL_MATRIX",t[t.CLEAR_LOCAL_MATRIX=239]="CLEAR_LOCAL_MATRIX",t[t.UPDATE_GLOBAL_LOCAL_MATRIX=48]="UPDATE_GLOBAL_LOCAL_MATRIX",t[t.UPDATE_LAYOUT=128]="UPDATE_LAYOUT",t[t.CLEAR_LAYOUT=127]="CLEAR_LAYOUT"}(bl||(bl={})),function(t){t[t.GLOBAL=1]="GLOBAL",t[t.LOCAL=16]="LOCAL",t[t.GLOBAL_ACCURATE=3]="GLOBAL_ACCURATE",t[t.LOCAL_ACCURATE=48]="LOCAL_ACCURATE"}(xl||(xl={})),function(t){t[t.INIT=0]="INIT",t[t.DEFAULT=1]="DEFAULT",t[t.STATE=2]="STATE",t[t.ANIMATE_BIND=10]="ANIMATE_BIND",t[t.ANIMATE_PLAY=11]="ANIMATE_PLAY",t[t.ANIMATE_START=12]="ANIMATE_START",t[t.ANIMATE_UPDATE=13]="ANIMATE_UPDATE",t[t.ANIMATE_END=14]="ANIMATE_END",t[t.TRANSLATE=20]="TRANSLATE",t[t.TRANSLATE_TO=21]="TRANSLATE_TO",t[t.SCALE=22]="SCALE",t[t.SCALE_TO=23]="SCALE_TO",t[t.ROTATE=24]="ROTATE",t[t.ROTATE_TO=25]="ROTATE_TO"}(kl||(kl={})),function(t){t[t.ROW=1]="ROW",t[t.COLUMN=2]="COLUMN"}(Sl||(Sl={})),function(t){t[t.CubicBezierCurve=0]="CubicBezierCurve",t[t.QuadraticBezierCurve=1]="QuadraticBezierCurve",t[t.ArcCurve=2]="ArcCurve",t[t.LineCurve=3]="LineCurve",t[t.EllipseCurve=4]="EllipseCurve",t[t.MoveCurve=5]="MoveCurve"}(Al||(Al={})),function(t){t[t.beforeFillStroke=0]="beforeFillStroke",t[t.afterFillStroke=1]="afterFillStroke"}(Ml||(Ml={}));var Il=[function(t,e,i,n,r,a,o){return e.arc(t[1]*r+i,t[2]*a+n,t[3]*(r+a)/2,t[4],t[5],t[6],o)},function(t,e,i,n,r,a,o){return e.arcTo(t[1]*r+i,t[2]*a+n,t[3]*r+i,t[4]*a+n,t[5]*(r+a)/2,o)},function(t,e,i,n,r,a,o){return e.bezierCurveTo(t[1]*r+i,t[2]*a+n,t[3]*r+i,t[4]*a+n,t[5]*r+i,t[6]*a+n,o)},function(t,e,i,n){return e.closePath()},function(t,e,i,n,r,a){return e.ellipse(t[1]*r+i,t[2]*a+n,t[3]*r,t[4]*a,t[5],t[6],t[7],t[8])},function(t,e,i,n,r,a,o){return e.lineTo(t[1]*r+i,t[2]*a+n,o)},function(t,e,i,n,r,a,o){return e.moveTo(t[1]*r+i,t[2]*a+n,o)},function(t,e,i,n,r,a,o){return e.quadraticCurveTo(t[1]*r+i,t[2]*a+n,t[3]*r+i,t[4]*a+n,o)},function(t,e,i,n,r,a,o){return e.rect(t[1]*r+i,t[2]*a+n,t[3]*r,t[4]*a,o)}];function Dl(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0,s=0;s<t.length;s++){var l=t[s];Il[l[0]](l,e,i,n,r,a,o)}}var Ol=function(){return o((function t(){r(this,t)}),[{key:"getLength",value:function(t){return null!=t?this.calcProjLength(t):(Number.isFinite(this.length)||(this.length=this.calcLength()),this.length)}}])}();function Fl(t,e){for(var i=0,n=t.length,r=0;r<n;r++){var a=t[r],o=e[r],s=t[(r+1)%n],l=e[(r+1)%n];i+=Oe.distanceNN(a,o,s,l)}return i/2}function zl(t,e,i,n,r){var a=1-r;return a*a*a*t+3*e*r*a*a+3*i*r*r*a+n*r*r*r}function Hl(t,e,i,n,r){var a=zl(t.x,e.x,i.x,n.x,r),o=zl(t.y,e.y,i.y,n.y,r);return new De(a,o)}function Nl(t,e,i,n){var r=1-n;return r*r*t+2*r*n*e+n*n*i}function Vl(t,e,i,n){var r=Nl(t.x,e.x,i.x,n),a=Nl(t.y,e.y,i.y,n);return new De(r,a)}function jl(t,e){var i=t.p0,n=t.p1,r=t.p2,a=t.p3,o=Hl(i,n,r,a,e),s=Oe.pointAtPP(i,n,e),l=Oe.pointAtPP(n,r,e),u=Oe.pointAtPP(r,a,e),c=Oe.pointAtPP(s,l,e),h=Oe.pointAtPP(l,u,e);return[new Ul(i,s,c,o),new Ul(o,h,u,a)]}var Ul=function(t){function e(t,i,a,o){var s;return r(this,e),(s=n(this,e)).type=Al.CubicBezierCurve,s.p0=t,s.p1=i,s.p2=a,s.p3=o,s}return h(e,t),o(e,[{key:"_validPoint",value:function(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y+this.p3.x+this.p3.y)}},{key:"getPointAt",value:function(t){if(!1!==this.defined)return Hl(this.p0,this.p1,this.p2,this.p3,t);throw new Error("defined为false的点不能getPointAt")}},{key:"calcLength",value:function(){return this._validPoint()?(t=this.p0,e=this.p1,i=this.p2,n=this.p3,Fl([t.x,e.x,i.x,n.x],[t.y,e.y,i.y,n.y])):60;var t,e,i,n}},{key:"calcProjLength",value:function(t){return t===Sl.ROW?_e(this.p0.x-this.p3.x):t===Sl.COLUMN?_e(this.p0.y-this.p3.y):0}},{key:"getAngleAt",value:function(t){var e=ke(t-.01,0),i=Se(t+.01,1),n=this.getPointAt(e),r=this.getPointAt(i);return be(r.y-n.y,r.x-n.x)}},{key:"draw",value:function(t,e,i,n,r,a){if(t.moveTo(this.p0.x*n+e,this.p0.y*r+i),a>=1)t.bezierCurveTo(this.p1.x*n+e,this.p1.y*r+i,this.p2.x*n+e,this.p2.y*r+i,this.p3.x*n+e,this.p3.y*r+i);else if(a>0){var o=m(jl(this,a),1)[0];t.bezierCurveTo(o.p1.x*n+e,o.p1.y*r+i,o.p2.x*n+e,o.p2.y*r+i,o.p3.x*n+e,o.p3.y*r+i)}}},{key:"includeX",value:function(t){var e=Se(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=ke(this.p0.x,this.p1.x,this.p2.x,this.p3.x);return t>=e&&t<=i}},{key:"getYAt",value:function(t){var e=Se(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=(t-e)/(ke(this.p0.x,this.p1.x,this.p2.x,this.p3.x)-e);return this.getPointAt(i).y}}])}(Ol);function Wl(t,e){var i=t.p0,n=t.p1,r=Oe.pointAtPP(i,n,e);return[new Gl(i,r),new Gl(r,n)]}var Gl=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e)).type=Al.LineCurve,a.p0=t,a.p1=i,a}return h(e,t),o(e,[{key:"getPointAt",value:function(t){if(!1!==this.defined)return Oe.pointAtPP(this.p0,this.p1,t);throw new Error("defined为false的点不能getPointAt")}},{key:"getAngleAt",value:function(t){return null==this.angle&&(this.angle=be(this.p1.y-this.p0.y,this.p1.x-this.p0.x)),this.angle}},{key:"_validPoint",value:function(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y)}},{key:"calcLength",value:function(){return this._validPoint()?Oe.distancePP(this.p0,this.p1):60}},{key:"calcProjLength",value:function(t){return t===Sl.ROW?_e(this.p0.x-this.p1.x):t===Sl.COLUMN?_e(this.p0.y-this.p1.y):0}},{key:"draw",value:function(t,e,i,n,r,a){if(t.moveTo(this.p0.x*n+e,this.p0.y*r+i),a>=1)t.lineTo(this.p1.x*n+e,this.p1.y*r+i);else if(a>0){var o=this.getPointAt(a);t.lineTo(o.x*n+e,o.y*r+i)}}},{key:"includeX",value:function(t){return t>=this.p0.x&&t<=this.p1.x||t>=this.p1.x&&t<=this.p0.x}},{key:"getYAt",value:function(t){if(this.includeX(t)){var e=this.p0,i=this.p1;this.p0.x>this.p1.x&&(e=this.p1,i=this.p0);var n=(t-e.x)/(i.x-e.x);return e.y+n*(i.y-e.y)}return 1/0}}])}(Ol),Yl=function(){return o((function t(e,i){r(this,t),this.init(e,i)}),[{key:"endX",get:function(){return this._lastX}},{key:"endY",get:function(){return this._lastY}},{key:"init",value:function(t,e){this._lastX=this._lastY=this._startX=this._startY=0,this.curveType=t,this.direction=e,this.curves=[]}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a,o,s){var l=new Ul(new De(this._lastX,this._lastY),new De(t,e),new De(i,n),new De(r,a));l.originP1=this._lastOriginP,l.originP2=s,l.defined=o,this.curves.push(l),this._lastX=r,this._lastY=a,this._lastOriginP=s}},{key:"closePath",value:function(){if(!(this.curves.length<2)){var t=this.curves[this.curves.length-1];this.lineTo(this._startX,this._startY,t.defined,this._startOriginP)}}},{key:"ellipse",value:function(){throw new Error("SegContext不支持调用ellipse")}},{key:"lineTo",value:function(t,e,i,n){var r=this.addLinearCurve(t,e,i,this._lastOriginP,n);this.curves.push(r),this._lastX=t,this._lastY=e,this._lastOriginP=n}},{key:"moveTo",value:function(t,e,i){return this._lastX=this._startX=t,this._lastY=this._startY=e,this._lastOriginP=i,this._startOriginP=i,this}},{key:"quadraticCurveTo",value:function(t,e,i,n){throw new Error("SegContext不支持调用quadraticCurveTo")}},{key:"clear",value:function(){this.curves=[],this.length=NaN}},{key:"tryUpdateLength",value:function(t){return this.getLength(t)}},{key:"addLinearCurve",value:function(t,e,i,n,r){var a=new Gl(new De(this._lastX,this._lastY),new De(t,e));return a.originP1=n,a.originP2=r,a.defined=i,a}},{key:"getPointAt",value:function(t){throw new Error("暂未实现")}},{key:"getCurveLengths",value:function(){return[]}},{key:"getLength",value:function(t){var e,i;if(t===Sl.COLUMN){if(!this.curves.length)return 0;var n=this.curves[0],r=this.curves[this.curves.length-1],a=null!==(e=r.p3)&&void 0!==e?e:r.p1;return _e(n.p0.y-a.y)}if(t===Sl.ROW){if(!this.curves.length)return 0;var o=this.curves[0],s=this.curves[this.curves.length-1],l=null!==(i=s.p3)&&void 0!==i?i:s.p1;return _e(o.p0.x-l.x)}return Number.isFinite(this.length)||(this.length=this.curves.reduce((function(t,e){return t+e.getLength()}),0)),this.length}}])}(),Xl=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"bezierCurveTo",value:function(t,i,n,r,a,o,s,l){return _(e,"bezierCurveTo",this,3)([i,t,r,n,o,a,s,l])}},{key:"lineTo",value:function(t,i,n,r){return _(e,"lineTo",this,3)([i,t,n,r])}},{key:"moveTo",value:function(t,i,n){return _(e,"moveTo",this,3)([i,t,n])}},{key:"clear",value:function(){return _(e,"clear",this,3)([])}}])}(Yl);function Kl(t,e){for(var i=!1,n=0,r=e.length;n<=r;n++)n>=r===i&&((i=!i)?t.lineStart():t.lineEnd()),i&&t.point(e[n])}function ql(t,e,i){var n=null!=e?e:_e(i[i.length-1].x-i[0].x)>_e(i[i.length-1].y-i[0].y)?Sl.ROW:Sl.COLUMN;return"monotoneY"===t?new Xl(t,n):new Yl(t,n)}var Zl=function(){return o((function t(e,i){r(this,t),this.context=e,i&&(this.startPoint=i)}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}},{key:"point",value:function(t){var e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t)}this._lastDefined=t.defined}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}();function Jl(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;var r=ql("linear",i,t);return function(t,e){Kl(t,e)}(new Zl(r,n),t),r}function Ql(t,e,i,n,r){t.context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+i)/6,n,t.lastPoint1)}var $l=function(){return o((function t(e,i){r(this,t),this.context=e,this.startPoint=i}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){2===this._point&&Ql(this,6*this._x1-(this._x0+4*this._x1),6*this._y1-(this._y0+4*this._y1),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}},{key:"point",value:function(t){var e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;break;default:Ql(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}();function tu(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;if(t.length<3-Number(!!n))return Jl(t,e);var r=ql("basis",i,t);return function(t,e){Kl(t,e)}(new $l(r,n),t),r}function eu(t){return t<0?-1:1}function iu(t,e,i){var n=t._x1-t._x0,r=e-t._x1,a=(t._y1-t._y0)/(n||Number(r<0&&-0)),o=(i-t._y1)/(r||Number(n<0&&-0)),s=(a*r+o*n)/(n+r);return(eu(a)+eu(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function nu(t,e){var i=t._x1-t._x0;return i?(3*(t._y1-t._y0)/i-e)/2:e}function ru(t,e,i,n,r){var a=t._x0,o=t._y0,s=t._x1,l=t._y1,u=(s-a)/3;t.context.bezierCurveTo(a+u,o+u*e,s-u,l-u*i,s,l,n,t.lastPoint1)}var au=function(){return o((function t(e,i){r(this,t),this.context=e,this.startPoint=i}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){switch(this._point){case 2:this.context.lineTo(this._x1,this._y1,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:ru(this,this._t0,nu(this,this._t0),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1)}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}},{key:"point",value:function(t){var e=NaN,i=t.x,n=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,n,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(i,n,t);break;case 1:this._point=2;break;case 2:this._point=3,ru(this,nu(this,e=iu(this,i,n)),e,!1!==this._lastDefined1&&!1!==this._lastDefined2);break;default:ru(this,this._t0,e=iu(this,i,n),!1!==this._lastDefined1&&!1!==this._lastDefined2)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=n,this._t0=e,this._lastDefined1=this._lastDefined2,this._lastDefined2=!1!==t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}(),ou=function(t){function e(t,i){return r(this,e),n(this,e,[t,i])}return h(e,t),o(e,[{key:"point",value:function(t){return _(e,"point",this,3)([{y:t.x,x:t.y,defined:t.defined}])}}])}(au);function su(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;if(t.length<3-Number(!!n))return Jl(t,e);var r=ql("monotoneX",i,t);return function(t,e){Kl(t,e)}(new au(r,n),t),r}function lu(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;if(t.length<3-Number(!!n))return Jl(t,e);var r=ql("monotoneY",i,t);return function(t,e){Kl(t,e)}(new ou(r,n),t),r}var uu=function(){return o((function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2?arguments[2]:void 0;r(this,t),this.context=e,this._t=i,this.startPoint=n}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x=this._y=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){0<this._t&&this._t<1&&2===this._point&&this.context.lineTo(this._x,this._y,!1!==this._lastDefined,this.lastPoint),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)}},{key:"point",value:function(t){var e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:if(this._t<=0)this.context.lineTo(this._x,i,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t);else{var n=this._x*(1-this._t)+e*this._t;.5===this._t?this.context.lineTo(n,this._y,!1!==this._lastDefined,this.lastPoint):this.context.lineTo(n,this._y,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(n,i,!1!==this._lastDefined&&!1!==t.defined,t)}}this._lastDefined=t.defined,this._x=e,this._y=i,this.lastPoint=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}(),cu=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"lineEnd",value:function(){this.context.closePath()}}])}(uu);function hu(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.direction,r=i.startPoint;if(t.length<2-Number(!!r))return null;var a=new Yl("step",null!=n?n:_e(t[t.length-1].x-t[0].x)>_e(t[t.length-1].y-t[0].y)?Sl.ROW:Sl.COLUMN);return du(new uu(a,e,r),t),a}function du(t,e){return Kl(t,e)}var pu=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"lineEnd",value:function(){this.context.closePath()}}])}(Zl);function fu(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;var r=ql("linear",i,t);return function(t,e){Kl(t,e)}(new pu(r,n),t),r}function vu(t,e,i,n,r){var a=t._x1,o=t._y1,s=t._x2,l=t._y2;if(t._l01_a>fe){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);a=(a*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,o=(o*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>fe){var h=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,d=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*h+t._x1*t._l23_2a-e*t._l12_2a)/d,l=(l*h+t._y1*t._l23_2a-i*t._l12_2a)/d}t.context.bezierCurveTo(a,o,s,l,t._x2,t._y2,n,t.lastPoint1)}var gu=function(){return o((function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2?arguments[2]:void 0;r(this,t),this.context=e,this.startPoint=n,this._alpha=i}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}},{key:"lineEnd",value:function(){switch(this._point){case 2:this.context.lineTo(this._x2,this._y2,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:this.point({x:this._x2,y:this._y2})}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}},{key:"point",value:function(t){var e=t.x,i=t.y;if(this._point){var n=this._x2-e,r=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2):this.context.moveTo(e,i);break;case 1:this._point=2;break;case 2:this._point=3;default:vu(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}();function yu(t,e){return function(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.direction,o=r.startPoint;if(i.length<2-Number(!!o))return null;if(i.length<3-Number(!!o))return Jl(i,r);var s=ql(t,a,i);return Kl(new e(s,n,o),i),s}}var mu=yu("catmullRom",gu),_u=function(){return o((function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2?arguments[2]:void 0;r(this,t),this.context=e,this.startPoint=n,this._alpha=i}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}},{key:"lineEnd",value:function(){switch(this._point){case 1:this.context.moveTo(this._x3,this._y3,this.lastPoint1),this.context.closePath();break;case 2:this.context.lineTo(this._x3,this._y3,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),this.context.closePath();break;case 3:this.point({x:this._x3,y:this._y3}),this.point({x:this._x4,y:this._y4}),this.point({x:this._x5,y:this._y5})}}},{key:"point",value:function(t){var e=t.x,i=t.y;if(this._point){var n=this._x2-e,r=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=i;break;case 1:this._point=2,this.context.moveTo(this._x4=e,this._y4=i,t);break;case 2:this._point=3,this._x5=e,this._y5=i;break;default:vu(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}(),bu=yu("catmullRomClosed",_u);function xu(t,e){var i=t.p0,n=t.p1,r=t.p2,a=Vl(i,n,r,e),o=Oe.pointAtPP(i,n,e),s=Oe.pointAtPP(n,r,e);return[new ku(i,o,a),new ku(a,s,r)]}var ku=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e)).type=Al.QuadraticBezierCurve,o.p0=t,o.p1=i,o.p2=a,o}return h(e,t),o(e,[{key:"_validPoint",value:function(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y)}},{key:"getPointAt",value:function(t){if(!1!==this.defined)return Vl(this.p0,this.p1,this.p2,t);throw new Error("defined为false的点不能getPointAt")}},{key:"calcLength",value:function(){return this._validPoint()?(t=this.p0,e=this.p1,i=this.p2,Fl([t.x,e.x,i.x],[t.y,e.y,i.y])):60;var t,e,i}},{key:"calcProjLength",value:function(t){return t===Sl.ROW?_e(this.p0.x-this.p2.x):t===Sl.COLUMN?_e(this.p0.y-this.p2.y):0}},{key:"getAngleAt",value:function(t){var e=ke(t-.01,0),i=Se(t+.01,1),n=this.getPointAt(e),r=this.getPointAt(i);return be(r.y-n.y,r.x-n.x)}},{key:"draw",value:function(t,e,i,n,r,a){if(t.moveTo(this.p0.x*n+e,this.p0.y*r+i),a>=1)t.quadraticCurveTo(this.p1.x*n+e,this.p1.y*r+i,this.p2.x*n+e,this.p2.y*r+i);else if(a>0){var o=m(xu(this,a),1)[0];t.quadraticCurveTo(o.p1.x*n+e,o.p1.y*r+i,o.p2.x*n+e,o.p2.y*r+i)}}},{key:"getYAt",value:function(t){throw new Error("QuadraticBezierCurve暂不支持getYAt")}},{key:"includeX",value:function(t){throw new Error("QuadraticBezierCurve暂不支持includeX")}}])}(Ol),Su=function(){return o((function t(e){r(this,t),this.path=e,this._lastX=this._lastY=this._startX=this._startY=0}),[{key:"moveTo",value:function(t,e){return this._lastX=this._startX=t,this._lastY=this._startY=e,this}},{key:"lineTo",value:function(t,e){var i=this.addLinearCurve(t,e);this.path.addCurve(i),this._lastX=t,this._lastY=e}},{key:"addLinearCurve",value:function(t,e){return new Gl(new De(this._lastX,this._lastY),new De(t,e))}},{key:"quadraticCurveTo",value:function(t,e,i,n){var r=new ku(new De(this._lastX,this._lastY),new De(t,e),new De(i,n));this.path.addCurve(r),this._lastX=i,this._lastY=n}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a){var o=new Ul(new De(this._lastX,this._lastY),new De(t,e),new De(i,n),new De(r,a));this.path.addCurve(o),this._lastX=r,this._lastY=a}},{key:"arcTo",value:function(t,e,i,n,r){throw new Error("CurveContext不支持调用arcTo")}},{key:"ellipse",value:function(t,e,i,n,r,a,o,s){throw new Error("CurveContext不支持调用ellipse")}},{key:"rect",value:function(t,e,i,n){throw new Error("CurveContext不支持调用rect")}},{key:"arc",value:function(t,e,i,n,r,a){throw new Error("CurveContext不支持调用arc")}},{key:"closePath",value:function(){this.path.curves.length<2||this.lineTo(this._startX,this._startY)}}])}();function Au(t,e,i){var n,r;switch(e){case"linear":default:return Jl(t,i);case"basis":return tu(t,i);case"monotoneX":return su(t,i);case"monotoneY":return lu(t,i);case"step":return hu(t,.5,i);case"stepClosed":return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.direction,r=i.startPoint;if(t.length<2-Number(!!r))return null;var a=new Yl("step",null!=n?n:_e(t[t.length-1].x-t[0].x)>_e(t[t.length-1].y-t[0].y)?Sl.ROW:Sl.COLUMN);return du(new cu(a,e,r),t),a}(t,.5,i);case"stepBefore":return hu(t,0,i);case"stepAfter":return hu(t,1,i);case"catmullRom":return mu(t,null!==(n=null==i?void 0:i.curveTension)&&void 0!==n?n:.5,i);case"catmullRomClosed":return bu(t,null!==(r=null==i?void 0:i.curveTension)&&void 0!==r?r:.5,i);case"linearClosed":return fu(t,i)}}var Mu=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).commandList=[],t&&(i._ctx=t),i._boundsContext=new wl(i.bounds),i}return h(e,t),o(e,[{key:"curves",get:function(){return this.tryBuildCurves()}},{key:"setCtx",value:function(t){this._ctx=t}},{key:"moveTo",value:function(t,e){return this.commandList.push([Bl.M,t,e]),this._ctx&&this._ctx.moveTo(t,e),this}},{key:"lineTo",value:function(t,e){return this.commandList.push([Bl.L,t,e]),this._ctx&&this._ctx.lineTo(t,e),this}},{key:"quadraticCurveTo",value:function(t,e,i,n){return this.commandList.push([Bl.Q,t,e,i,n]),this._ctx&&this._ctx.quadraticCurveTo(t,e,i,n),this}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a){return this.commandList.push([Bl.C,t,e,i,n,r,a]),this._ctx&&this._ctx.bezierCurveTo(t,e,i,n,r,a),this}},{key:"arcTo",value:function(t,e,i,n,r){return this.commandList.push([Bl.AT,t,e,i,n,r]),this._ctx&&this._ctx.arcTo(t,e,i,n,r),this}},{key:"ellipse",value:function(t,e,i,n,r,a,o,s){return this.commandList.push([Bl.E,t,e,i,n,r,a,o,s]),this._ctx&&this._ctx.ellipse(t,e,i,n,r,a,o,s),this}},{key:"rect",value:function(t,e,i,n){return this.commandList.push([Bl.R,t,e,i,n]),this._ctx&&this._ctx.rect(t,e,i,n),this}},{key:"arc",value:function(t,e,i,n,r,a){return this.commandList.push([Bl.A,t,e,i,n,r,a]),this._ctx&&this._ctx.arc(t,e,i,n,r,a),this}},{key:"closePath",value:function(){return this.commandList.push([Bl.Z]),this._ctx&&this._ctx.closePath(),this}},{key:"addCurve",value:function(t){this._curves.push(t)}},{key:"clear",value:function(){this.transformCbList=null,this.commandList.length=0,this._curves.length=0}},{key:"beginPath",value:function(){this.clear()}},{key:"tryBuildCurves",value:function(){if(!this._curves||!this._curves.length){var t=new Su(this);Dl(this.commandList,t,0,0,1,1)}return this._curves}},{key:"toString",value:function(){if(!this.toStringCbList){var t=[];t[Bl.M]=function(t){return"M".concat(t[1]," ").concat(t[2])},t[Bl.L]=function(t){return"L".concat(t[1]," ").concat(t[2])},t[Bl.Q]=function(t){return"Q".concat(t[1]," ").concat(t[2]," ").concat(t[3]," ").concat(t[4])},t[Bl.C]=function(t){return"C".concat(t[1]," ").concat(t[2]," ").concat(t[3]," ").concat(t[4]," ").concat(t[5]," ").concat(t[6])},t[Bl.A]=function(t){var e=[],i=t[1],n=t[2],r=t[3];!function(t,e,i,n,r,a,o){var s,l=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=2*Math.PI,c=(e%u+u)%u,h=(i%u+u)%u;l?(h>=c&&(h-=u),s=h-c):(h<=c&&(h+=u),s=h-c);for(var d=Math.ceil(Math.abs(s)/(.5*Math.PI)),p=s/d,f=0;f<d;f++){var v=c+p*f,g=c+p*(f+1),y=4/3*Math.tan(Math.abs(p)/4),m=Math.cos(v),_=Math.sin(v),b=Math.cos(g),x=Math.sin(g),k=m*a+n,S=_*o+r,A=b*a+n,M=x*o+r,T=l?-1:1,w=a*y*T,C=o*y*T;t.push(k-w*_,S+C*m,A+w*x,M-C*b,A,M)}}(e,t[4],t[5],i,n,r,r,t[6]);for(var a="",o=0;o<e.length;o+=6)a+="C".concat(e[o]," ").concat(e[o+1]," ").concat(e[o+2]," ").concat(e[o+3]," ").concat(e[o+4]," ").concat(e[o+5]);return a},t[Bl.R]=function(t){return"M".concat(t[1]," ").concat(t[2]," h").concat(t[3]," v").concat(t[4]," H").concat(t[1],"Z")},t[Bl.Z]=function(t){return"Z"},this.toStringCbList=t}var e=this.toStringCbList,i="";return this.commandList.forEach((function(t){i+=e[t[0]](t)})),i}},{key:"fromString",value:function(t,e,i,n,r){this.clear();var a=function(t){if(!t)return[];var e,i,n=t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);if(null===n)return[];for(var r=[],a=0,o=n.length;a<o;a++)if(fl=n[a],vl=fl.slice(1),e=[gl=fl[0]],null!==(i=vl.match(El))){for(var s=0,l=i.length;s<l;s++)yl=i[s],ml=parseFloat(yl),Number.isNaN(ml)||e.push(ml);if(_l=Pl[gl],e.length-1>_l)for(var u=void 0,c=gl,h=1,d=e.length;h<d;h+=_l){u=[c];for(var p=h,f=h+_l;p<f;p++)u.push(e[p]);r.push(u),"m"===c?c="l":"M"===c&&(c="L")}else r.push(e)}else r.push(e);return r}(t);return this._runCommandStrList(a,e,i,n,r),this._updateBounds(),this}},{key:"fromLine",value:function(t){var e=t.attribute,i=e.points,n=e.curveType,r=e.clipRangeByDimension;if(i){var a=Au(i,n);"x"===r?this.direction=Sl.ROW:"y"===r?this.direction=Sl.COLUMN:"auto"===r&&(this.direction=a.direction),this._curves=a.curves}}},{key:"fromCustomPath2D",value:function(t,e,i,n,r){return this.clear(),this._runCommandList(t.commandList,e,i,n,r),this._updateBounds(),this}},{key:"transform",value:function(t,e,i,n){var r=this,a=this.commandList;if(!this.transformCbList){var o=[];o[Bl.M]=this.moveToTransform,o[Bl.L]=this.lineToTransform,o[Bl.Q]=this.quadraticCurveToTransform,o[Bl.C]=this.bezierCurveToTransform,o[Bl.AT]=this.arcToTransform,o[Bl.E]=this.ellipseTransform,o[Bl.R]=this.rectTransform,o[Bl.A]=this.arcTransform,o[Bl.Z]=this.closePathTransform,this.transformCbList=o}a.forEach((function(a){r.transformCbList[a[0]](a,t,e,i,n)})),this._updateBounds()}},{key:"moveToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i}},{key:"lineToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i}},{key:"quadraticCurveToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n+e,t[4]=t[4]*r+i}},{key:"bezierCurveToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n+e,t[4]=t[4]*r+i,t[5]=t[5]*n+e,t[6]=t[6]*r+i}},{key:"arcToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n+e,t[4]=t[4]*r+i,t[5]=t[5]*(n+r)/2}},{key:"ellipseTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n,t[4]=t[4]*r}},{key:"rectTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n,t[4]=t[4]*r}},{key:"arcTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*(n+r)/2}},{key:"closePathTransform",value:function(){}},{key:"_runCommandStrList",value:function(t){for(var e,i,n,r,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,c=null,h=0,d=0,p=0,f=0,v=0,g=t.length;v<g;++v){switch(e=t[v],1===l&&1===u||(e=wu(e,l,u)),e[0]){case"l":h+=e[1],d+=e[2],this.lineTo(h+o,d+s);break;case"L":h=e[1],d=e[2],this.lineTo(h+o,d+s);break;case"h":h+=e[1],this.lineTo(h+o,d+s);break;case"H":h=e[1],this.lineTo(h+o,d+s);break;case"v":d+=e[1],this.lineTo(h+o,d+s);break;case"V":d=e[1],this.lineTo(h+o,d+s);break;case"m":h+=e[1],d+=e[2],this.moveTo(h+o,d+s);break;case"M":h=e[1],d=e[2],this.moveTo(h+o,d+s);break;case"c":i=h+e[5],n=d+e[6],p=h+e[3],f=d+e[4],this.bezierCurveTo(h+e[1]+o,d+e[2]+s,p+o,f+s,i+o,n+s),h=i,d=n;break;case"C":h=e[5],d=e[6],p=e[3],f=e[4],this.bezierCurveTo(e[1]+o,e[2]+s,p+o,f+s,h+o,d+s);break;case"s":i=h+e[3],n=d+e[4],null===c[0].match(/[CcSs]/)?(p=h,f=d):(p=2*h-p,f=2*d-f),r=h+e[1],a=d+e[2],this.bezierCurveTo(p+o,f+s,r+o,a+s,i+o,n+s),p=r,f=a,h=i,d=n;break;case"S":i=e[3],n=e[4],null===c[0].match(/[CcSs]/)?(p=h,f=d):(p=2*h-p,f=2*d-f),r=e[1],a=e[2],this.bezierCurveTo(p+o,f+s,r+o,a+s,i+o,n+s),p=r,f=a,h=i,d=n;break;case"q":i=h+e[3],n=d+e[4],p=h+e[1],f=d+e[2],this.quadraticCurveTo(p+o,f+s,i+o,n+s),h=i,d=n;break;case"Q":i=e[3],n=e[4],this.quadraticCurveTo(e[1]+o,e[2]+s,i+o,n+s),h=i,d=n,p=e[1],f=e[2];break;case"t":i=h+e[1],n=d+e[2],null===c[0].match(/[QqTt]/)?(p=h,f=d):"t"===c[0]?(p=2*h-r,f=2*d-a):"q"===c[0]&&(p=2*h-p,f=2*d-f),r=p,a=f,this.quadraticCurveTo(p+o,f+s,i+o,n+s),d=n,p=(h=i)+e[1],f=d+e[2];break;case"T":i=e[1],n=e[2],p=2*h-p,f=2*d-f,this.quadraticCurveTo(p+o,f+s,i+o,n+s),h=i,d=n;break;case"a":Ll(this,h+o,d+s,[e[1],e[2],e[3],e[4],e[5],e[6]+h+o,e[7]+d+s]),h+=e[6],d+=e[7];break;case"A":Ll(this,h+o,d+s,[e[1],e[2],e[3],e[4],e[5],e[6]+o,e[7]+s]),h=e[6],d=e[7];break;case"z":case"Z":this.closePath()}c=e}}},{key:"_runCommandList",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(0!==e||0!==i||1!==n||1!==r)for(var a=0,o=t.length;a<o;++a){var s=t[a].slice();switch(s[0]){case Bl.L:this.lineToTransform(s,e,i,n,r);break;case Bl.M:this.moveToTransform(s,e,i,n,r);break;case Bl.C:this.bezierCurveToTransform(s,e,i,n,r);break;case Bl.Q:this.quadraticCurveToTransform(s,e,i,n,r);break;case Bl.A:this.arcToTransform(s,e,i,n,r);break;case Bl.E:this.ellipseTransform(s,e,i,n,r);break;case Bl.R:this.rectTransform(s,e,i,n,r);break;case Bl.AT:this.arcToTransform(s,e,i,n,r);break;case Bl.Z:this.closePath()}}else this.commandList=t.map((function(t){return t.slice()}))}},{key:"_updateBounds",value:function(){this.bounds.clear(),Dl(this.commandList,this._boundsContext)}},{key:"release",value:function(){this.commandList=[],this._boundsContext=null,this._ctx=null}},{key:"getLength",value:function(){if(this.direction===Sl.COLUMN){if(!this._curves.length)return 0;var t=this._curves[0],e=this._curves[this._curves.length-1];return _e(t.p0.y-e.p1.y)}if(this.direction===Sl.ROW){if(!this._curves.length)return 0;var i=this._curves[0],n=this._curves[this._curves.length-1];return _e(i.p0.x-n.p1.x)}return this._curves.reduce((function(t,e){return t+e.getLength()}),0)}},{key:"getYAt",value:function(t){if(!this.curves)return 1/0;for(var e=0;e<this.curves.length;e++){var i=this.curves[e];if(i.includeX(t))return i.getYAt(t)}return 1/0}},{key:"getAttrAt",value:function(t){if(!this._curves)return{pos:{x:0,y:0},angle:0};for(var e,i=0,n=0;n<this._curves.length;n++){var r=(e=this._curves[n]).getLength(this.direction);if(i+r>=t)break;i+=r}var a=(t-i)/e.getLength(this.direction);return{pos:e.getPointAt(a),angle:e.getAngleAt(a)}}},{key:"drawWithClipRange",value:function(t,e,i,n,r){this.tryBuildCurves();for(var a=this.getLength()*r,o=0,s=0;s<this._curves.length;s++){var l=this._curves[s],u=l.getLength(this.direction);if(!(o+u<=a)){var c=1-(o+u-a)/u;l.draw(t,i,n,e,e,c);break}l.draw(t,i,n,e,e,1),o+=u}}}])}(Cl),Tu=["l",0,0,0,0,0,0,0];function wu(t,e,i){var n=Tu[0]=t[0];if("a"===n||"A"===n)Tu[1]=e*t[1],Tu[2]=i*t[2],Tu[3]=t[3],Tu[4]=t[4],Tu[5]=t[5],Tu[6]=e*t[6],Tu[7]=i*t[7];else if("h"===n||"H"===n)Tu[1]=e*t[1];else if("v"===n||"V"===n)Tu[1]=i*t[1];else for(var r=1,a=t.length;r<a;++r)Tu[r]=(r%2==1?e:i)*t[r];return Tu}var Cu={x:0,y:0,z:0,dx:0,dy:0,dz:0,scrollX:0,scrollY:0,scaleX:1,scaleY:1,scaleZ:1,angle:0,alpha:0,beta:0,scaleCenter:[0,0],anchor:[0,0],anchor3d:[0,0],postMatrix:new xi},Eu={fillOpacity:1,fill:!1,shadowBlur:0,shadowColor:"black",shadowOffsetX:0,shadowOffsetY:0},Pu={strokeOpacity:1,lineDash:[],lineDashOffset:0,lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,strokeBoundsBuffer:2,stroke:!1},Bu=Object.assign({outerBorder:Object.assign(Object.assign({},Pu),{distance:0}),innerBorder:Object.assign(Object.assign({},Pu),{distance:0})},Pu),Ru={text:"",maxLineWidth:1/0,maxWidth:1/0,textAlign:"left",textBaseline:"alphabetic",fontSize:16,fontFamily:"PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,\n    Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol",fontWeight:"",ellipsis:"…",fontVariant:"",fontStyle:"",lineHeight:void 0,underline:0,lineThrough:0,scaleIn3d:!1,direction:"horizontal",wordBreak:"break-all",ignoreBuf:!1,verticalMode:0,wrap:!1,whiteSpace:"no-wrap",heightLimit:1/0,lineClamp:1/0,suffixPosition:"end",underlineDash:[],underlineOffset:0,disableAutoClipedPoptip:void 0,measureMode:Js.fontBounding,keepCenterInLine:!1},Lu=Object.assign(Object.assign(Object.assign(Object.assign({forceBoundsWidth:void 0,forceBoundsHeight:void 0,opacity:1,background:null,autoAnimateTexture:!1,textureRatio:1,textureOptions:null,backgroundOpacity:1,backgroundCornerRadius:0,texture:null,textureColor:"black",textureSize:10,texturePadding:2,backgroundMode:"no-repeat",backgroundFit:!0,backgroundKeepAspectRatio:!1,backgroundClip:!0,backgroundScale:1,backgroundOffsetX:0,backgroundOffsetY:0,blur:0,filter:"",cursor:null,html:null,react:null,vue:null},Eu),Bu),{alignSelf:"auto"}),{pickStrokeBuffer:0}),Iu={connectedType:"none",connectedStyle:{},connectedX:NaN,connectedY:NaN},Du=Object.assign(Object.assign(Object.assign({strokeSeg:null,renderable:!0,pickable:!0,shadowGraphic:void 0,childrenPickable:!0,fillPickable:!0,strokePickable:!0,visible:!0,zIndex:0,layout:null,boundsPadding:0,fillStrokeOrder:0,renderStyle:"default",pickMode:"accurate",customPickShape:null,boundsMode:"accurate",keepDirIn3d:!0,shadowRootIdx:1,globalZIndex:1,globalCompositeOperation:"",overflow:"hidden",shadowPickMode:"graphic",keepStrokeScale:!1,clipConfig:null,roughStyle:null},{_debug_bounds:!1}),Lu),Cu),Ou=Object.assign(Object.assign({},Du),{startAngle:0,endAngle:me,innerRadius:0,outerRadius:1,innerPadding:0,outerPadding:0,cornerRadius:0,padRadius:0,padAngle:0,cap:!1,forceShowCap:!1}),Fu=Object.assign(Object.assign(Object.assign({},Du),Iu),{points:[],segments:[],curveType:"linear",clipRange:1,closePath:!1,curveTension:1}),zu=Object.assign(Object.assign({},Du),{radius:1,startAngle:0,endAngle:me}),Hu=Object.assign(Object.assign({},Du),{width:0,height:0,cornerRadius:0,path:[],clip:!1,visibleAll:!0,display:"relative",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start",baseOpacity:1,cornerType:"round"}),Nu=Object.assign(Object.assign({},Du),{path:"",width:0,height:0,cornerRadius:0,clip:!1}),Vu=Object.assign(Object.assign(Object.assign({},Du),Iu),{points:[],segments:[],curveType:"linear",clipRange:1,clipRangeByDimension:"default",closePath:!1,curveTension:1}),ju=Object.assign(Object.assign({},Du),{path:new Mu,fillStrokeOrder:1,clipRange:1,customPath:function(){Ot.getInstance().warn("空函数")}}),Uu=Object.assign(Object.assign({},Du),{points:[],cornerRadius:0,closePath:!0}),Wu=Object.assign(Object.assign({},Du),{width:100,height:100,spikes:5,thickness:.5}),Gu=Object.assign(Object.assign({},Du),{width:0,height:0,x1:0,y1:0,strokeBoundsBuffer:0,cornerRadius:0,cornerType:"round",drawStrokeWhenZeroWH:!1});Object.assign(Object.assign({},Du),{width:0,height:0,x1:0,y1:0,cornerRadius:0,length:0,cornerType:"round",drawStrokeWhenZeroWH:!1});var Yu=Object.assign(Object.assign({},Du),{symbolType:"circle",size:10,keepDirIn3d:!0,clipRange:1}),Xu=Object.assign(Object.assign(Object.assign({},Du),Ru),{strokeBoundsBuffer:0,keepDirIn3d:!0}),Ku=Object.assign(Object.assign(Object.assign({},Du),Ru),{upgradeAttrs:null,editable:!1,editOptions:null,ascentDescentMode:"actual",width:300,height:300,ellipsis:!0,wordBreak:"break-word",verticalDirection:"top",textAlign:"left",textBaseline:"top",layoutDirection:"horizontal",textConfig:[],disableAutoWrapLine:!1,maxHeight:void 0,maxWidth:void 0,singleLine:!1}),qu=Object.assign(Object.assign({repeatX:"no-repeat",repeatY:"no-repeat",image:"",width:0,height:0,maxWidth:500,maxHeight:500},Du),{fill:!0,cornerRadius:0,cornerType:"round"}),Zu=Object.assign(Object.assign({},qu),{backgroundShowMode:"never",backgroundWidth:0,backgroundHeight:0,textAlign:"left",textBaseline:"middle",direction:"horizontal",margin:0,id:"",width:20,height:20,backgroundFill:"rgba(101, 117, 168, 0.1)",backgroundFillOpacity:1,backgroundStroke:!1,backgroundStrokeOpacity:1,backgroundRadius:4,opacity:1}),Ju=function(){var t={linearGradient:/^(linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,fromAngleValue:/^from\s*(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/(^\#[0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^(rgb\(\d{1,3},\s*\d{1,3},\s*\d{1,3}\))/i,rgbaColor:/^(rgba\(\d{1,3},\s*\d{1,3},\s*\d{1,3},\s*((\d\.\d+)|\d{1,3})\))/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function i(t){var i=new Error(e+": "+t);throw i.source=e,i}function n(){return r("linear",t.linearGradient,a)||r("radial",t.radialGradient,s)||r("conic",t.conicGradient,o)}function r(e,n,r){return function(n,a){var o,s=y(n);if(s){y(t.startCall)||i("Missing (");var l=((o=r())&&(y(t.comma)||i("Missing comma before color stops")),{type:e,orientation:o,colorStops:d(p)});return y(t.endCall)||i("Missing )"),l}}(n)}function a(){return g("directional",t.sideOrCorner,1)||g("angular",t.angleValue,1)}function o(){return g("angular",t.fromAngleValue,1)}function s(){var i,n,r=l();return r&&((i=[]).push(r),n=e,y(t.comma)&&((r=l())?i.push(r):e=n)),i}function l(){var t,e=function(){var t=g("shape",/^(circle)/i,0);return t&&(t.style=v()||u()),t}()||((t=g("shape",/^(ellipse)/i,0))&&(t.style=f()||u()),t);if(e)e.at=c();else{var i=u();if(i){e=i;var n=c();n&&(e.at=n)}else{var r=h();r&&(e={type:"default-radial",at:r})}}return e}function u(){return g("extent-keyword",t.extentKeywords,1)}function c(){if(g("position",/^at/,0)){var t=h();return t||i("Missing positioning value"),t}}function h(){var t={x:f(),y:f()};if(t.x||t.y)return{type:"position",value:t}}function d(e){var n=e(),r=[];if(n)for(r.push(n);y(t.comma);)(n=e())?r.push(n):i("One extra comma");return r}function p(){var e=g("hex",t.hexColor,1)||g("rgba",t.rgbaColor,1)||g("rgb",t.rgbColor,1)||g("literal",t.literalColor,0);return e||i("Expected color definition"),e.length=f(),e}function f(){return g("%",t.percentageValue,1)||g("position-keyword",t.positionKeywords,1)||v()}function v(){return g("px",t.pixelValue,1)||g("em",t.emValue,1)}function g(t,e,i){var n=y(e);if(n)return{type:t,value:n[i]}}function y(t){var i=/^[\n\r\t\s]+/.exec(e);i&&m(i[0].length);var n=t.exec(e);return n&&m(n[0].length),n}function m(t){e=e.substr(t)}return function(t){return e=t.toString(),r=d(n),e.length>0&&i("Invalid input not EOF"),r;var r}}(),Qu=function(){function t(){r(this,t)}return o(t,null,[{key:"IsGradient",value:function(t){return!("string"==typeof t&&!t.includes("gradient"))}},{key:"IsGradientStr",value:function(t){return"string"==typeof t&&t.includes("gradient")}},{key:"Parse",value:function(e){if(t.IsGradientStr(e))try{var i=Ju(e)[0];if(i){if("linear"===i.type)return t.ParseLinear(i);if("radial"===i.type)return t.ParseRadial(i);if("conic"===i.type)return t.ParseConic(i)}}catch(t){return e}return e}},{key:"processColorStops",value:function(t){if(!t||0===t.length)return[];if(t.some((function(t){return t.length}))){var e=t.map((function(t){return{color:t.value,offset:t.length?parseFloat(t.length.value)/100:-1}}));e[0].offset<0&&(e[0].offset=0),e[e.length-1].offset<0&&(e[e.length-1].offset=1);for(var i=1;i<e.length-1;i++)if(e[i].offset<0){for(var n=i-1,r=i+1;r<e.length&&e[r].offset<0;)r++;for(var a=e[n].offset,o=e[r].offset,s=r-n,l=1;l<s;l++)e[n+l].offset=a+(o-a)*l/s;i=r-1}return e}return t.map((function(e,i){var n=t.length>1?i/(t.length-1):0;return{color:e.value,offset:n}}))}},{key:"ParseConic",value:function(e){var i=e.orientation,n=e.colorStops,r=void 0===n?[]:n,a=ve/2,o=parseFloat(i.value)/180*ve-a;return{gradient:"conical",x:.5,y:.5,startAngle:o,endAngle:o+me,stops:t.processColorStops(r)}}},{key:"ParseRadial",value:function(e){var i=e.colorStops,n=void 0===i?[]:i;return{gradient:"radial",x0:.5,y0:.5,x1:.5,y1:.5,r0:0,r1:1,stops:t.processColorStops(n)}}},{key:"ParseLinear",value:function(e){for(var i=e.orientation,n=e.colorStops,r=void 0===n?[]:n,a=ve/2,o="angular"===i.type?parseFloat(i.value)/180*ve:0;o<0;)o+=me;for(;o>=me;)o-=me;var s=0,l=0,u=0,c=0;return o<a?(s=0,l=1,u=Math.sin(o),c=l-Math.cos(o)):o<ve?(s=0,l=0,u=Math.cos(o-a),c=Math.sin(o-a)):o<ve+a?(l=0,u=(s=1)-Math.sin(o-ve),c=Math.cos(o-ve)):(u=(s=1)-Math.cos(o-a-ve),c-=Math.sin(o-a-ve)),{gradient:"linear",x0:s,y0:l,x1:u,y1:c,stops:t.processColorStops(r)}}}])}();function $u(t,e,i){var n=e,r=t.currentMatrix,a=r.a,o=r.b,s=r.c,l=r.d,u=Math.sign(a)*Math.sqrt(a*a+o*o),c=Math.sign(l)*Math.sqrt(s*s+l*l);return u+c===0?0:n=n/Math.abs(u+c)*2*i}function tc(t,e,i){var n,r,a,o,s,l,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!e||!0===e)return"black";if(q(e))for(var h=0;h<e.length&&!(l=e[h]);h++);else l=e;if("string"==typeof(l=Qu.Parse(l)))return l;if(i.AABBBounds&&(!i.attribute||0!==i.attribute.scaleX||0!==i.attribute.scaleY)){var d=i.AABBBounds,p=d.x2-d.x1,f=d.y2-d.y1,v=d.x1-u,g=d.y1-c;if(i.attribute){var y=i.attribute,m=y.scaleX,_=void 0===m?1:m,b=y.scaleY,x=void 0===b?1:b,k=y.angle;p/=_,f/=x,v/=_,g/=x,((void 0===k?0:k)||1!==_||1!==x)&&(v=null!==(n=i.x1WithoutTransform)&&void 0!==n?n:0,g=null!==(r=i.y1WithoutTransform)&&void 0!==r?r:0,p=null!==(a=i.widthWithoutTransform)&&void 0!==a?a:p,f=null!==(o=i.heightWithoutTransform)&&void 0!==o?o:f)}"linear"===l.gradient?s=function(t,e,i,n,r,a){var o,s,l,u,c=t.createLinearGradient(i+(null!==(o=e.x0)&&void 0!==o?o:0)*r,n+(null!==(s=e.y0)&&void 0!==s?s:0)*a,i+(null!==(l=e.x1)&&void 0!==l?l:1)*r,n+(null!==(u=e.y1)&&void 0!==u?u:0)*a);return e.stops.forEach((function(t){c.addColorStop(t.offset,t.color)})),c}(t,l,v,g,p,f):"conical"===l.gradient?s=function(t,e,i,n,r,a){var o,s,l=t.createConicGradient(i+(null!==(o=e.x)&&void 0!==o?o:0)*r,n+(null!==(s=e.y)&&void 0!==s?s:0)*a,e.startAngle,e.endAngle);return e.stops.forEach((function(t){l.addColorStop(t.offset,t.color)})),l.GetPattern?l.GetPattern(r+i,a+n,void 0):l}(t,l,v,g,p,f):"radial"===l.gradient&&(s=function(t,e,i,n,r,a){var o,s,l,u,c,h,d=t.createRadialGradient(i+(null!==(o=e.x0)&&void 0!==o?o:.5)*r,n+(null!==(s=e.y0)&&void 0!==s?s:.5)*a,Math.max(r,a)*(null!==(l=e.r0)&&void 0!==l?l:0),i+(null!==(u=e.x1)&&void 0!==u?u:.5)*r,n+(null!==(c=e.y1)&&void 0!==c?c:.5)*a,Math.max(r,a)*(null!==(h=e.r1)&&void 0!==h?h:.5));return e.stops.forEach((function(t){d.addColorStop(t.offset,t.color)})),d}(t,l,v,g,p,f))}return s||"orange"}var ec={horizontal:{width:"width",height:"height",left:"left",top:"top",x:"x",y:"y",bottom:"bottom"},vertical:{width:"height",height:"width",left:"top",top:"left",x:"y",y:"x",bottom:"right"}},ic=!0,nc=!1,rc=/\w|\(|\)|-/,ac=/[.?!,;:/，。？！、；：]/,oc=/\S/,sc=function(t,e){var i=e.fontSize||16;switch(e.script){case"super":case"sub":i*=.8}t.setTextStyle({textAlign:"left",textBaseline:e.textBaseline||"alphabetic",fontStyle:e.fontStyle||"",fontWeight:e.fontWeight||"",fontSize:i,fontFamily:e.fontFamily})};function lc(t,e,i,n,r){if(t.length<=1)return 0;if(!e||e<=0)return 0;for(var a=al.graphicUtil.textMeasure,o=n,s=t.slice(0,o),l=Math.floor(a.measureText(s,i).width),u=t.slice(0,o+1),c=Math.floor(a.measureText(u,i).width);l>e||c<=e;){if(l>e?o--:o++,o>t.length){o=t.length;break}if(o<0){o=0;break}s=t.slice(0,o),l=Math.floor(a.measureText(s,i).width),u=t.slice(0,o+1),c=Math.floor(a.measureText(u,i).width)}return r&&(o=uc(t,o)),o}function uc(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e;rc.test(t[n-1])&&rc.test(t[n])||ac.test(t[n]);)if(--n<=0)return i?cc(t,e):e;return n}function cc(t,e){for(var i=e;rc.test(t[i+1])&&rc.test(t[i])||ac.test(t[i]);)if(++i>=t.length)return i;return i+1}function hc(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"actual";if(""===t)return{ascent:0,height:0,descent:0,width:0};var r=al.graphicUtil.textMeasure.measureText(t,e),a={ascent:0,height:0,descent:0,width:0},o="actual"===n?r.actualBoundingBoxAscent:r.fontBoundingBoxAscent,s="actual"===n?r.actualBoundingBoxDescent:r.fontBoundingBoxDescent;"number"!=typeof o||"number"!=typeof s?(a.width=Math.floor(r.width),a.height=e.fontSize||0,a.ascent=a.height,a.descent=0):(a.width=Math.floor(r.width),a.height=Math.floor(o+s),a.ascent=Math.floor(o),a.descent=a.height-a.ascent);var l=null!==(i=e.space)&&void 0!==i?i:0;return a.width+=l,a}var dc=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},pc=function(){return o((function t(){r(this,t)}),[{key:"configure",value:function(t,e){this.canvas=t.canvas,this.context=t.context,t.bindTextMeasure(this)}},{key:"_measureTextWithoutAlignBaseline",value:function(t,e,i){this.context.setTextStyleWithoutAlignBaseline(e);var n=this.context.measureText(t);return i?this.compatibleMetrics(n,e):n}},{key:"_measureTextWithAlignBaseline",value:function(t,e,i){this.context.setTextStyle(e);var n=this.context.measureText(t);return i?this.compatibleMetrics(n,e):n}},{key:"compatibleMetrics",value:function(t,e){if(null==t.actualBoundingBoxAscent||null==t.actualBoundingBoxDescent||null==t.fontBoundingBoxAscent||null==t.fontBoundingBoxDescent){t={width:t.width};var i=this.measureTextBoundADscentEstimate(e),n=i.ascent,r=i.descent;t.actualBoundingBoxAscent=n,t.actualBoundingBoxDescent=r,t.fontBoundingBoxAscent=n,t.fontBoundingBoxDescent=r}if(null==t.actualBoundingBoxLeft||null==t.actualBoundingBoxRight){t={width:t.width,actualBoundingBoxAscent:t.actualBoundingBoxAscent,actualBoundingBoxDescent:t.actualBoundingBoxDescent,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent};var a=this.measureTextBoundLeftRightEstimate(e),o=a.left,s=a.right;t.actualBoundingBoxLeft=o,t.actualBoundingBoxRight=s}return t}},{key:"estimate",value:function(t,e){for(var i=e.fontSize,n=void 0===i?Xu.fontSize:i,r=0,a=0,o=0;o<t.length;o++)t.charCodeAt(o)<128?r++:a++;return{width:~~(.8*r*n+a*n),height:n}}},{key:"measureTextWidth",value:function(t,e,i){return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e)).width:this.estimate(t,e).width}},{key:"measureTextBoundsWidth",value:function(t,e,i){return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e)).width:this.estimate(t,e).width}},{key:"measureTextBoundsLeftRight",value:function(t,e,i){return this.context?{left:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).actualBoundingBoxLeft,right:i.actualBoundingBoxRight}:this.measureTextBoundLeftRightEstimate(e)}},{key:"measureTextPixelHeight",value:function(t,e,i){var n;return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e,!0),Math.abs(i.actualBoundingBoxAscent-i.actualBoundingBoxDescent)):null!==(n=e.fontSize)&&void 0!==n?n:Ru.fontSize}},{key:"measureTextPixelADscent",value:function(t,e,i){return this.context?{ascent:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent}:this.measureTextBoundADscentEstimate(e)}},{key:"measureTextBoundHieght",value:function(t,e,i){var n;return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e,!0),Math.abs(i.fontBoundingBoxAscent-i.fontBoundingBoxDescent)):null!==(n=e.fontSize)&&void 0!==n?n:Ru.fontSize}},{key:"measureTextBoundADscent",value:function(t,e,i){return this.context?{ascent:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).fontBoundingBoxAscent,descent:i.fontBoundingBoxDescent}:this.measureTextBoundADscentEstimate(e)}},{key:"measureTextBoundADscentEstimate",value:function(t){var e,i=null!==(e=t.fontSize)&&void 0!==e?e:Ru.fontSize;return{ascent:.79*i,descent:.21*i}}},{key:"measureTextBoundLeftRightEstimate",value:function(t){var e,i=null!==(e=t.fontSize)&&void 0!==e?e:Ru.fontSize,n=t.textAlign;return"center"===n?{left:i/2,right:i/2}:"right"===n||"end"===n?{left:i,right:0}:{left:0,right:i}}},{key:"measureTextPixelADscentAndWidth",value:function(t,e,i){if(!this.context)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(e)),{width:this.estimate(t,e).width});var n=this._measureTextWithoutAlignBaseline(t,e,!0);if(i===Js.actualBounding)return{ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,width:n.width};if(i===Js.estimate)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(e)),{width:n.width});if(i===Js.fontBounding){var r=n.fontBoundingBoxAscent,a=n.fontBoundingBoxDescent;if(n.actualBoundingBoxDescent&&a<n.actualBoundingBoxDescent){var o=n.actualBoundingBoxDescent-a;a+=o,r-=o}else if(n.actualBoundingBoxAscent&&r<n.actualBoundingBoxAscent){var s=n.actualBoundingBoxAscent-r;r+=s,a-=s}return{ascent:r,descent:a,width:n.width}}return{ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,width:n.width}}},{key:"measureText",value:function(t,e){return this.context?(this.context.setTextStyleWithoutAlignBaseline(e),this.context.measureText(t)):this.estimate(t,e)}},{key:"clipTextVertical",value:function(t,e,i,n){var r=this;if(0===t.length)return{verticalList:t,width:0};var a=e.fontSize,o=void 0===a?12:a;t.forEach((function(t){t.width=0===t.direction?o:r.measureTextWidth(t.text,e)}));for(var s=[],l=0,u=0;u<t.length&&l+t[u].width<i;u++)l+=t[u].width,s.push(t[u]);if(t[u]&&t[u].text.length>1){var c=this._clipText(t[u].text,e,i-l,0,t[u].text.length-1,"end",!1);if(n&&c.str!==t[u].text){for(var h="",d=0,p=0;p<u;p++){var f=t[p];h+=f.text,d+=f.text.length}var v=uc(h+=t[u].text,d+c.str.length);(v-=d)!==c.str.length-1&&(c.str=c.str.substring(0,v),c.width=this.measureTextWidth(c.str,e))}s.push(Object.assign(Object.assign({},t[u]),{text:c.str,width:c.width})),l+=c.width}return{verticalList:s,width:l}}},{key:"clipText",value:function(t,e,i,n,r){if(0===t.length)return{str:"",width:0};var a=this.measureTextWidth(t,e);if(a<=i)return{str:t,width:a};if((a=this.measureTextWidth(t[0],e))>i)return{str:"",width:0};var o=this._clipText(t,e,i,0,t.length-1,"end",!1);if(n&&o.str!==t){var s=uc(t,o.str.length,r);s!==o.str.length&&(s>o.str.length&&(o.wordBreaked=s,s=o.str.length),o.str=t.substring(0,s),o.width=this.measureTextWidth(o.str,e))}return o}},{key:"_clipText",value:function(t,e,i,n,r,a,o){var s;if("start"===a)s=this._clipTextStart(t,e,i,n,r),o&&(s.result=o+s.str);else if("middle"===a){var l=this._clipTextMiddle(t,e,i,"","",0,0,1);s={str:"none",width:l.width,result:l.left+o+l.right}}else s=this._clipTextEnd(t,e,i,n,r),o&&(s.result=s.str+o);return s}},{key:"_clipTextEnd",value:function(t,e,i,n,r){if(n===r){Ot.getInstance().warn("【_clipTextEnd】不应该走到这里".concat(t,", ").concat(n,", ").concat(r));var a=t.substring(0,r+1);return{str:a,width:this.measureTextWidth(a,e)}}var o,s=Math.floor((n+r)/2),l=t.substring(0,s+1),u=this.measureTextWidth(l,e);if(u>i){if(l.length<=1)return{str:"",width:0};var c=t.substring(0,s);return(o=this.measureTextWidth(c,e))<=i?{str:c,width:o}:this._clipTextEnd(t,e,i,n,s)}if(u<i){if(s>=t.length-1)return{str:t,width:this.measureTextWidth(t,e)};var h=t.substring(0,s+2);return(o=this.measureTextWidth(h,e))>=i?{str:l,width:u}:this._clipTextEnd(t,e,i,s,r)}return{str:l,width:u}}},{key:"_clipTextStart",value:function(t,e,i,n,r){var a,o=Math.ceil((n+r)/2),s=t.substring(o-1,t.length),l=this.measureTextWidth(s,e);if(l>i){if(s.length<=1)return{str:"",width:0};var u=t.substring(o,t.length);return(a=this.measureTextWidth(u,e))<=i?{str:u,width:a}:this._clipTextStart(t,e,i,o,t.length)}if(l<i){if(o<=0)return{str:t,width:this.measureTextWidth(t,e)};var c=t.substring(o-2,t.length);return(a=this.measureTextWidth(c,e))>=i?{str:s,width:l}:this._clipTextStart(t,e,i,n,o)}return{str:s,width:l}}},{key:"_clipTextMiddle",value:function(t,e,i,n,r,a,o,s){var l=t.substring(0,s),u=this.measureTextWidth(l,e);if(u+o>i)return{left:n,right:r,width:a+o};var c=t.substring(t.length-s,t.length),h=this.measureTextWidth(c,e);return u+h>i?{left:l,right:r,width:u+o}:this._clipTextMiddle(t,e,i,l,c,u,h,s+1)}},{key:"clipTextWithSuffixVertical",value:function(t,e,i,n,r,a){if(""===n)return this.clipTextVertical(t,e,i,r);if(0===t.length)return{verticalList:t,width:0};var o=this.clipTextVertical(t,e,i,r);if(o.verticalList.length===t.length&&o.verticalList[o.verticalList.length-1].width===t[t.length-1].width)return o;var s,l=this.measureTextWidth(n,e);if(l>i)return o;if(i-=l,"start"===a){var u=this.revertVerticalList(t);s=this.clipTextVertical(u,e,i,r);var c=this.revertVerticalList(s.verticalList);c.unshift({text:n,direction:1,width:l}),s.verticalList=c}else if("middle"===a){var h=this.clipTextVertical(t,e,i/2,r),d=this.revertVerticalList(t),p=this.clipTextVertical(d,e,i/2,r);h.verticalList.push({text:n,direction:1,width:l}),this.revertVerticalList(p.verticalList).forEach((function(t){return h.verticalList.push(t)})),s={verticalList:h.verticalList,width:h.width+p.width}}else(s=this.clipTextVertical(t,e,i,r)).verticalList.push({text:n,direction:1,width:l});return s.width+=l,s}},{key:"revertVerticalList",value:function(t){return t.reverse().map((function(t){var e=t.text.split("").reverse().join("");return Object.assign(Object.assign({},t),{text:e})}))}},{key:"clipTextWithSuffix",value:function(t,e,i,n,r,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(""===n)return this.clipText(t,e,i,r);if(0===t.length)return{str:"",width:0};var s=this.measureTextWidth(t,e);if(!o&&s<=i)return{str:t,width:s};var l=this.measureTextWidth(n,e);if(l>i)return{str:"",width:0};if(o&&s+l<=i)return{str:t+n,width:s+l};i-=l;var u=this._clipText(t,e,i,0,t.length-1,a,n);if(r&&u.str!==t){var c=uc(t,u.str.length);c!==u.str.length&&(u.result=t.substring(0,c),u.width=this.measureTextWidth(u.str,e))}else o&&u.str===t&&(u.result=t+n);return u.str=u.result,u.width+=l,u}}])}();pc=dc([Ps()],pc);var fc=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},vc=Symbol.for("TextMeasureContribution"),gc=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e)}(pc);gc=fc([Ps()],gc);var yc=new Ys,mc=Symbol.for("CanvasFactory"),_c=Symbol.for("Context2dFactory");function bc(t){return yc.getNamed(mc,al.global.env)(t)}var xc=1e-4,kc=Math.sqrt(3),Sc=1/3;function Ac(t){return t>-Fc&&t<Fc}function Mc(t){return t>Fc||t<-Fc}var Tc=[0,0],wc=[0,0],Cc=[0,0];function Ec(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function Pc(t,e,i,n){var r=1-n;return r*(r*t+2*n*e)+n*n*i}function Bc(t,e,i,n,r){var a=1-r;return a*a*(a*t+3*r*e)+r*r*(r*n+3*a*i)}function Rc(t){return(t%=me)<0&&(t+=me),t}function Lc(t,e,i,n,r,a,o,s,l){if(0===o)return!1;var u=o;return!(l>e+u&&l>n+u&&l>a+u||l<e-u&&l<n-u&&l<a-u||s>t+u&&s>i+u&&s>r+u||s<t-u&&s<i-u&&s<r-u)&&function(t,e,i,n,r,a,o,s,l){var u=0,c=.005,h=1/0;Tc[0]=o,Tc[1]=s;for(var d=0;d<1;d+=.05){wc[0]=Pc(t,i,r,d),wc[1]=Pc(e,n,a,d);var p=Ec(Tc,wc);p<h&&(u=d,h=p)}h=1/0;for(var f=0;f<32&&!(c<xc);f++){var v=u-c,g=u+c;wc[0]=Pc(t,i,r,v),wc[1]=Pc(e,n,a,v);var y=Ec(wc,Tc);if(v>=0&&y<h)u=v,h=y;else{Cc[0]=Pc(t,i,r,g),Cc[1]=Pc(e,n,a,g);var m=Ec(Cc,Tc);g<=1&&m<h?(u=g,h=m):c*=.5}}return l&&(l[0]=Pc(t,i,r,u),l[1]=Pc(e,n,a,u)),Math.sqrt(h)}(t,e,i,n,r,a,s,l,null)<=u/2}function Ic(t,e,i,n,r,a,o,s,l,u,c){if(0===l)return!1;var h=l;return!(c>e+h&&c>n+h&&c>a+h&&c>s+h||c<e-h&&c<n-h&&c<a-h&&c<s-h||u>t+h&&u>i+h&&u>r+h&&u>o+h||u<t-h&&u<i-h&&u<r-h&&u<o-h)&&function(t,e,i,n,r,a,o,s,l,u,c){var h,d,p,f,v=0,g=.005,y=1/0;Tc[0]=l,Tc[1]=u;for(var m=0;m<1;m+=.05)wc[0]=Bc(t,i,r,o,m),wc[1]=Bc(e,n,a,s,m),(p=Ec(Tc,wc))<y&&(v=m,y=p);y=1/0;for(var _=0;_<32&&!(g<xc);_++)h=v-g,d=v+g,wc[0]=Bc(t,i,r,o,h),wc[1]=Bc(e,n,a,s,h),p=Ec(wc,Tc),h>=0&&p<y?(v=h,y=p):(Cc[0]=Bc(t,i,r,o,d),Cc[1]=Bc(e,n,a,s,d),f=Ec(Cc,Tc),d<=1&&f<y?(v=d,y=f):g*=.5);return c&&(c[0]=Bc(t,i,r,o,v),c[1]=Bc(e,n,a,s,v)),Math.sqrt(y)}(t,e,i,n,r,a,o,s,u,c,null)<=h/2}function Dc(t,e,i,n,r,a,o,s,l){if(0===o)return!1;var u=o;s-=t,l-=e;var c=Math.sqrt(s*s+l*l);if(c-u>i||c+u<i)return!1;if(Math.abs(n-r)%me<1e-4)return!0;if(a){var h=n;n=Rc(r),r=Rc(h)}else n=Rc(n),r=Rc(r);n>r&&(r+=me);var d=Math.atan2(l,s);return d<0&&(d+=me),d>=n&&d<=r||d+me>=n&&d+me<=r}function Oc(t,e,i,n,r,a,o){if(0===r)return!1;var s,l=r,u=r/2;if(o>e+u&&o>n+u||o<e-u&&o<n-u||a>t+u&&a>i+u||a<t-u&&a<i-u)return!1;if(t===i)return Math.abs(a-t)<=l/2;var c=(s=(e-n)/(t-i))*a-o+(t*n-i*e)/(t-i);return c*c/(s*s+1)<=l/2*l/2}var Fc=1e-4;function zc(t,e,i,n,r){var a=6*i-12*e+6*t,o=9*e+3*n-3*t-9*i,s=3*e-3*t,l=0;if(Ac(o)){if(Mc(a)){var u=-s/a;u>=0&&u<=1&&(r[l++]=u)}}else{var c=a*a-4*o*s;if(Ac(c))r[0]=-a/(2*o);else if(c>0){var h=Math.sqrt(c),d=(-a+h)/(2*o),p=(-a-h)/(2*o);d>=0&&d<=1&&(r[l++]=d),p>=0&&p<=1&&(r[l++]=p)}}return l}var Hc=[-1,-1,-1],Nc=[-1,-1];function Vc(t,e,i,n,r,a,o,s,l,u){if(u>e&&u>n&&u>a&&u>s||u<e&&u<n&&u<a&&u<s)return 0;var c=function(t,e,i,n,r,a){var o=n+3*(e-i)-t,s=3*(i-2*e+t),l=3*(e-t),u=t-r,c=s*s-3*o*l,h=s*l-9*o*u,d=l*l-3*s*u,p=0;if(Ac(c)&&Ac(h))if(Ac(s))a[0]=0;else{var f=-l/s;f>=0&&f<=1&&(a[p++]=f)}else{var v=h*h-4*c*d;if(Ac(v)){var g=h/c,y=-s/o+g,m=-g/2;y>=0&&y<=1&&(a[p++]=y),m>=0&&m<=1&&(a[p++]=m)}else if(v>0){var _=Math.sqrt(v),b=c*s+1.5*o*(-h+_),x=c*s+1.5*o*(-h-_),k=(-s-((b=b<0?-Math.pow(-b,Sc):Math.pow(b,Sc))+(x=x<0?-Math.pow(-x,Sc):Math.pow(x,Sc))))/(3*o);k>=0&&k<=1&&(a[p++]=k)}else{var S=(2*c*s-3*o*h)/(2*Math.sqrt(c*c*c)),A=Math.acos(S)/3,M=Math.sqrt(c),T=Math.cos(A),w=(-s-2*M*T)/(3*o),C=(-s+M*(T+kc*Math.sin(A)))/(3*o),E=(-s+M*(T-kc*Math.sin(A)))/(3*o);w>=0&&w<=1&&(a[p++]=w),C>=0&&C<=1&&(a[p++]=C),E>=0&&E<=1&&(a[p++]=E)}}return p}(e,n,a,s,u,Hc);if(0===c)return 0;for(var h,d=0,p=-1,f=0,v=0,g=0;g<c;g++){var y=Hc[g],m=0===y||1===y?.5:1;Bc(t,i,r,o,y)<l||(p<0&&(p=zc(e,n,a,s,Nc),Nc[1]<Nc[0]&&p>1&&(h=void 0,h=Nc[0],Nc[0]=Nc[1],Nc[1]=h),f=Bc(e,n,a,s,Nc[0]),p>1&&(v=Bc(e,n,a,s,Nc[1]))),2===p?y<Nc[0]?d+=f<e?m:-m:y<Nc[1]?d+=v<f?m:-m:d+=s<v?m:-m:y<Nc[0]?d+=f<e?m:-m:d+=s<f?m:-m)}return d}function jc(t,e,i,n,r,a,o,s){if(s>e&&s>n&&s>a||s<e&&s<n&&s<a)return 0;var l=function(t,e,i,n,r){var a=t-2*e+i,o=2*(e-t),s=t-n,l=0;if(Ac(a)){if(Mc(o)){var u=-s/o;u>=0&&u<=1&&(r[l++]=u)}}else{var c=o*o-4*a*s;if(Ac(c)){var h=-o/(2*a);h>=0&&h<=1&&(r[l++]=h)}else if(c>0){var d=Math.sqrt(c),p=(-o+d)/(2*a),f=(-o-d)/(2*a);p>=0&&p<=1&&(r[l++]=p),f>=0&&f<=1&&(r[l++]=f)}}return l}(e,n,a,s,Hc);if(0===l)return 0;var u,c,h,d=0===(h=(u=e)+a-2*(c=n))?.5:(u-c)/h;if(d>=0&&d<=1){for(var p=0,f=Pc(e,n,a,d),v=0;v<l;v++){var g=0===Hc[v]||1===Hc[v]?.5:1;Pc(t,i,r,Hc[v])<o||(Hc[v]<d?p+=f<e?g:-g:p+=a<f?g:-g)}return p}var y=0===Hc[0]||1===Hc[0]?.5:1;return Pc(t,i,r,Hc[0])<o?0:a<e?y:-y}function Uc(t,e,i,n,r,a,o,s){if((s-=e)>i||s<-i)return 0;var l=Math.sqrt(i*i-s*s);Hc[0]=-l,Hc[1]=l;var u=Math.abs(n-r);if(u<1e-4)return 0;if(u>=me-1e-4){n=0,r=me;var c=a?1:-1;return o>=Hc[0]+t&&o<=Hc[1]+t?c:0}if(n>r){var h=n;n=r,r=h}n<0&&(n+=me,r+=me);for(var d=0,p=0;p<2;p++){var f=Hc[p];if(f+t>o){var v=Math.atan2(s,f),g=a?1:-1;v<0&&(v=me+v),(v>=n&&v<=r||v+me>=n&&v+me<=r)&&(v>ve/2&&v<1.5*ve&&(g=-g),d+=g)}}return d}function Wc(t){return Math.round(t/ve*1e8)/1e8%2*ve}function Gc(t,e){var i=Wc(t[0]);i<0&&(i+=me);var n=i-t[0],r=t[1];r+=n,!e&&r-i>=me?r=i+me:e&&i-r>=me?r=i-me:!e&&i>r?r=i+(me-Wc(i-r)):e&&i<r&&(r=i-(me-Wc(r-i))),t[0]=i,t[1]=r}var Yc=[0,0];function Xc(t,e,i,n,r){for(var a,o,s=t,l=t.length,u=0,c=0,h=0,d=0,p=0,f=0;f<l;f++){var v=s[f],g=0===f;v[0]===Bl.M&&f>1&&(i||(u+=ui(c,h,d,p,n,r))),g&&(d=c=v[1],p=h=v[2]);var y=v[0],m=v[1],_=v[2],b=v[3],x=v[4],k=v[5],S=v[6],A=x,M=k;Yc[0]=A,Yc[1]=M,Gc(Yc,Boolean(v[6]));var T=A=Yc[0],w=(M=Yc[1])-A,C=!!(1-(v[6]?0:1)),E=(n-m)*b/b+m;switch(y){case Bl.M:c=d=m,h=p=_;break;case Bl.L:if(i){if(Oc(c,h,m,_,e,n,r))return!0}else u+=ui(c,h,m,_,n,r)||0;c=m,h=_;break;case Bl.C:if(i){if(Ic(c,h,m,_,b,x,k,S,e,n,r))return!0}else u+=Vc(c,h,m,_,b,x,k,S,n,r)||0;c=k,h=S;break;case Bl.Q:if(i){if(Lc(c,h,m,_,b,x,e,n,r))return!0}else u+=jc(c,h,m,_,b,x,n,r)||0;c=b,h=x;break;case Bl.A:if(a=Math.cos(T)*b+m,o=Math.sin(T)*b+_,g?(d=a,p=o):u+=ui(c,h,a,o,n,r),i){if(Dc(m,_,b,T,T+w,C,e,E,r))return!0}else u+=Uc(m,_,b,T,T+w,C,E,r);c=Math.cos(T+w)*b+m,h=Math.sin(T+w)*b+_;break;case Bl.R:if(a=(d=c=m)+b,o=(p=h=_)+x,i){if(Oc(d,p,a,p,e,n,r)||Oc(a,p,a,o,e,n,r)||Oc(a,o,d,o,e,n,r)||Oc(d,o,d,p,e,n,r))return!0}else u+=ui(a,p,a,o,n,r),u+=ui(d,o,d,p,n,r);break;case Bl.Z:if(i){if(Oc(c,h,d,p,e,n,r))return!0}else u+=ui(c,h,d,p,n,r);c=d,h=p}}return i||function(t,e){return Math.abs(t-e)<Fc}(h,p)||(u+=ui(c,h,d,p,n,r)||0),0!==u}var Kc=function(){return o((function t(){r(this,t),this.pools=[],this.allocatedCanvas=[]}),[{key:"shareCanvas",value:function(){return this.allocatedCanvas.length?this.allocatedCanvas[0]:this.getCommonCanvas()}},{key:"getCommonCanvas",value:function(){return this._commonCanvas||(this._commonCanvas=this.allocate({width:100,height:100,dpr:2})),this._commonCanvas}},{key:"allocate",value:function(t){if(!this.pools.length){var e=bc(Object.assign({nativeCanvas:al.global.createCanvas(t)},t));return this.allocatedCanvas.push(e),e}var i=this.pools.pop();return i.resize(t.width,t.height),i.dpr=t.dpr,i}},{key:"allocateByObj",value:function(t){if(!this.pools.length){var e={width:t.width/t.dpr,height:t.height/t.dpr,dpr:t.dpr},i=bc(Object.assign({nativeCanvas:al.global.createCanvas(e)},e));return this.allocatedCanvas.push(i),i}var n=this.pools.pop();return n.width=t.width,n.height=t.height,n}},{key:"free",value:function(t){this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}])}(),qc=new Kc,Zc=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Jc=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Qc=Symbol.for("VWindow"),$c=Symbol.for("WindowHandlerContribution"),th=function(t){function e(){var t;return r(this,e),(t=n(this,e)).hooks={onChange:new il(["x","y","width","height"])},t.active=function(){var e=t.global;e.env&&!t.actived&&(yc.getNamed($c,e.env).configure(i(t),e),t.actived=!0)},t._uid=gs.GenAutoIncrementId(),t.global=al.global,t.postInit(),t}return h(e,t),o(e,[{key:"width",get:function(){if(this._handler){var t=this._handler.getWH();return this._width=t.width}return this._width}},{key:"height",get:function(){if(this._handler){var t=this._handler.getWH();return this._height=t.height}return this._height}},{key:"dpr",get:function(){return this._handler.getDpr()}},{key:"_nativeAddEventListener",value:function(t,e,i){return this._handler.addEventListener(t,e,i)}},{key:"_nativeRemoveEventListener",value:function(t,e,i){return this._handler.removeEventListener(t,e,i)}},{key:"_nativeDispatchEvent",value:function(t){return this._handler.dispatchEvent(t)}},{key:"postInit",value:function(){this.global.hooks.onSetEnv.tap("window",this.active),this.active()}},{key:"style",get:function(){var t;return null!==(t=this._handler.getStyle())&&void 0!==t?t:{}},set:function(t){this._handler.setStyle(t)}},{key:"create",value:function(t){var e,i;this._handler.createWindow(t);var n=this._handler.getWH();this._width=n.width,this._height=n.height,t.viewBox?this.setViewBox(t.viewBox):!1!==t.canvasControled?this.setViewBox({x1:0,y1:0,x2:this._width,y2:this._height}):this.setViewBox({x1:0,y1:0,x2:null!==(e=t.width)&&void 0!==e?e:this._width,y2:null!==(i=t.height)&&void 0!==i?i:this._height}),this.title=this._handler.getTitle(),this.resizable=!0}},{key:"setWindowHandler",value:function(t){this._handler=t}},{key:"setDpr",value:function(t){return this._handler.setDpr(t)}},{key:"resize",value:function(t,e){return this._handler.resizeWindow(t,e)}},{key:"configure",value:function(){throw new Error("暂不支持")}},{key:"release",value:function(){return this.global.hooks.onSetEnv.unTap("window",this.active),this.clearAllEventListeners(),this._handler.releaseWindow()}},{key:"getContext",value:function(){return this._handler.getContext()}},{key:"getNativeHandler",value:function(){return this._handler.getNativeHandler()}},{key:"getImageBuffer",value:function(t){return this._handler.getImageBuffer?this._handler.getImageBuffer(t):null}},{key:"getBoundingClientRect",value:function(){return this._handler.getBoundingClientRect()}},{key:"getContainer",value:function(){return this._handler.container}},{key:"clearViewBox",value:function(t){this._handler.clearViewBox(t)}},{key:"setViewBox",value:function(t){this._handler.setViewBox(t)}},{key:"setViewBoxTransform",value:function(t,e,i,n,r,a){this._handler.setViewBoxTransform(t,e,i,n,r,a)}},{key:"getViewBox",value:function(){return this._handler.getViewBox()}},{key:"getViewBoxTransform",value:function(){return this._handler.getViewBoxTransform()}},{key:"pointTransform",value:function(t,e){var i=this._handler.getViewBox(),n={x:t,y:e};return this._handler.getViewBoxTransform().transformPoint({x:t,y:e},n),n.x-=i.x1,n.y-=i.y1,n}},{key:"hasSubView",value:function(){var t=this._handler.getViewBox();return!(0===t.x1&&0===t.y1&&Ut(this.width,t.width())&&Ut(this.height,t.height()))}},{key:"isVisible",value:function(t){return this._handler.isVisible(t)}},{key:"onVisibleChange",value:function(t){return this._handler.onVisibleChange(t)}},{key:"getTopLeft",value:function(t){return this._handler.getTopLeft(t)}}])}(ll);th=Zc([Ps(),Jc("design:paramtypes",[])],th);var eh,ih=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},nh=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},rh=function(t,e){return function(i,n){e(i,n,t)}},ah=function(){return o((function t(e){var i=this;r(this,t),this.contributions=e,this.configured=!1,this.global=al.global,this.global.hooks.onSetEnv.tap("graphic-util",(function(t,e,n){i.configured=!1,i.configure(n,e)}))}),[{key:"canvas",get:function(){return this.tryInitCanvas(),this._canvas}},{key:"context",get:function(){return this.tryInitCanvas(),this._context}},{key:"textMeasure",get:function(){return this._textMeasure||this.configure(this.global,this.global.env),this._textMeasure}},{key:"configure",value:function(t,e){var i=this;this.configured||(this.contributions.getContributions().forEach((function(t){t.configure(i,e)})),this.configured=!0)}},{key:"tryInitCanvas",value:function(){if(!this._canvas){var t=qc.shareCanvas();this._canvas=t,this._context=t.getContext("2d")}}},{key:"bindTextMeasure",value:function(t){this._textMeasure=t}},{key:"measureText",value:function(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"native";this.configure(this.global,this.global.env);var r=this.global.measureTextMethod;this.global.measureTextMethod=n;var a={width:this._textMeasure.measureTextWidth(t,e),height:null!==(i=e.fontSize)&&void 0!==i?i:Ru.fontSize};return this.global.measureTextMethod=r,a}},{key:"createTextMeasureInstance",value:function(t,e,i){var n=this;return this.configure(this.global,this.global.env),new pi(Object.assign({defaultFontParams:{fontFamily:Ru.fontFamily,fontSize:Ru.fontSize},getCanvasForMeasure:i||function(){return n.canvas},getTextBounds:void 0,specialCharSet:"-/: .,@%'\"~"+pi.ALPHABET_CHAR_SET+pi.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t)}},{key:"drawGraphicToCanvas",value:function(t,e,i){if(!e.defaultLayer)return null;var n=yc.get(Qc),r=t.AABBBounds,a=r.width(),o=r.height(),s=-r.x1,l=-r.y1;n.create({viewBox:{x1:s,y1:l,x2:r.x2,y2:r.y2},width:a,height:o,canvas:i,dpr:e.window.dpr,canvasControled:!0,offscreen:!0,title:""});var u=e.params.optimize.disableCheckGraphicWidthOutRange;e.params.optimize.disableCheckGraphicWidthOutRange=!0,e.defaultLayer.getNativeHandler().drawTo(n,[t],{transMatrix:n.getViewBoxTransform(),viewBox:n.getViewBox(),stage:e,layer:e.defaultLayer,renderService:e.renderService,background:"transparent",clear:!0,updateBounds:!1}),e.params.optimize.disableCheckGraphicWidthOutRange=u;var c=n.getNativeHandler();return c.nativeCanvas?c.nativeCanvas:null}}])}();ah=ih([Ps(),rh(0,Cs(Xs)),rh(0,Bs(vc)),nh("design:paramtypes",[Object])],ah),function(t){t[t.transform=0]="transform",t[t.matrix=1]="matrix"}(eh||(eh={}));var oh=new xi,sh=function(){return o((function t(){r(this,t),this.matrix=new xi}),[{key:"init",value:function(t){return this.mode=eh.transform,this.originTransform=t,this.matrix.reset(),this}},{key:"fromMatrix",value:function(t,e){return this.mode=eh.matrix,this.outSourceMatrix=t,this.outTargetMatrix=e,this}},{key:"scaleMatrix",value:function(t,e,i){var n=this.outSourceMatrix;if(oh.setValue(n.a,n.b,n.c,n.d,n.e,n.f),this.outTargetMatrix.reset(),i){var r=i.x,a=i.y;this.outTargetMatrix.translate(r,a),this.outTargetMatrix.scale(t,e),this.outTargetMatrix.translate(-r,-a)}else this.outTargetMatrix.scale(t,e);return this.outTargetMatrix.multiply(oh.a,oh.b,oh.c,oh.d,oh.e,oh.f),this}},{key:"rotateMatrix",value:function(t,e){var i=this.outSourceMatrix;if(oh.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),e){var n=e.x,r=e.y;this.outTargetMatrix.translate(n,r),this.outTargetMatrix.rotate(t),this.outTargetMatrix.translate(-n,-r)}else this.outTargetMatrix.rotate(t);return this.outTargetMatrix.multiply(oh.a,oh.b,oh.c,oh.d,oh.e,oh.f),this}},{key:"scale",value:function(t,e,i){return this.mode===eh.matrix?this.scaleMatrix(t,e,i):this}},{key:"rotate",value:function(t,e){return this.mode===eh.matrix?this.rotateMatrix(t,e):this}},{key:"translateMatrix",value:function(t,e){var i=this.outSourceMatrix;return oh.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),this.outTargetMatrix.translate(t,e),this.outTargetMatrix.multiply(oh.a,oh.b,oh.c,oh.d,oh.e,oh.f),this}},{key:"translate",value:function(t,e){return this.mode===eh.matrix?this.translateMatrix(t,e):this}},{key:"simplify",value:function(t){return this.mode===eh.matrix?this.simplifyMatrix(t):this}},{key:"simplifyMatrix",value:function(t){return this}}])}();sh=ih([Ps(),nh("design:paramtypes",[])],sh);var lh={arc:Ou,area:Fu,circle:zu,line:Vu,path:ju,symbol:Yu,text:Xu,rect:Gu,polygon:Uu,star:Wu,richtext:Ku,richtextIcon:Zu,image:qu,group:Hu,glyph:Nu},uh=Object.keys(lh);function ch(t,e){Object.keys(e).forEach((function(i){t[i]=e[i]}))}var hh={arc:Object.assign({},lh.arc),area:Object.assign({},lh.area),circle:Object.assign({},lh.circle),line:Object.assign({},lh.line),path:Object.assign({},lh.path),symbol:Object.assign({},lh.symbol),text:Object.assign({},lh.text),rect:Object.assign({},lh.rect),polygon:Object.assign({},lh.polygon),star:Object.assign({},lh.star),richtext:Object.assign({},lh.richtext),richtextIcon:Object.assign({},lh.richtextIcon),image:Object.assign({},lh.image),group:Object.assign({},lh.group),glyph:Object.assign({},lh.glyph)},dh=function(){return o((function t(){r(this,t),this.initTheme(),this.dirty=!1}),[{key:"initTheme",value:function(){var t=this;this._defaultTheme={},uh.forEach((function(e){t._defaultTheme[e]=Object.create(hh[e])})),this.combinedTheme=this._defaultTheme}},{key:"getTheme",value:function(t){if(!t)return this.combinedTheme;if(!this.dirty)return this.combinedTheme;var e={},i=this.getParentWithTheme(t);return i&&(e=i.theme),this.applyTheme(t,e),this.combinedTheme}},{key:"getParentWithTheme",value:function(t){for(;t.parent;)if((t=t.parent).theme)return t;return null}},{key:"applyTheme",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.dirty){var n=this.getParentWithTheme(t);if(n){var r=n.theme;(r.dirty||i)&&r.applyTheme(n,e,!0)}this.userTheme?this.doCombine(n&&n.theme.combinedTheme):(n?this.combinedTheme=n.theme.combinedTheme:(this.combinedTheme=this._defaultTheme,Ot.getInstance().warn("未知错误，走到不应该走的区域里")),this.dirty=!1)}return this.combinedTheme}},{key:"doCombine",value:function(t){var e=this,i=this.userTheme,n=this.combinedTheme;uh.forEach((function(r){var a=Object.create(hh[r]);t&&t[r]&&ch(a,t[r]),n[r]&&ch(a,n[r]),i[r]&&ch(a,i[r]),e.combinedTheme[r]=a})),i.common&&uh.forEach((function(t){ch(e.combinedTheme[t],i.common)})),this.dirty=!1}},{key:"setTheme",value:function(t,e){var i=this.userTheme;i?Object.keys(t).forEach((function(e){i[e]?Object.assign(i[e],t[e]):i[e]=Object.assign({},t[e])})):i=t,this.userTheme=i,this.dirty=!0,this.dirtyChildren(e)}},{key:"resetTheme",value:function(t,e){this.userTheme=t,this.dirty=!0,this.dirtyChildren(e)}},{key:"dirtyChildren",value:function(t){var e=this;t.forEachChildren((function(t){t.isContainer&&(t.theme&&(t.theme.dirty=!0),e.dirtyChildren(t))}))}}])}(),ph=new dh;function fh(t,e){return t.glyphHost?fh(t.glyphHost):e?(t.isContainer,e):function(t){var e;if(e=t.isContainer?t:t.parent,e){for(;e&&!e.theme;)e=e.parent;return e?(e.theme||e.createTheme(),e.theme.getTheme(e)):ph.getTheme()}return null}(t)||t.attachedThemeGraphic&&fh(t.attachedThemeGraphic)||ph.getTheme()}var vh=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))},gh=function(t){function e(){var t;return r(this,e),(t=n(this,e))._uid=gs.GenAutoIncrementId(),t._firstChild=null,t._lastChild=null,t.parent=null,t._count=1,t}return h(e,t),o(e,[{key:"previousSibling",get:function(){return this._prev}},{key:"nextSibling",get:function(){return this._next}},{key:"children",get:function(){return this.getChildren()}},{key:"firstChild",get:function(){return this._firstChild}},{key:"lastChild",get:function(){return this._lastChild}},{key:"count",get:function(){return this._count}},{key:"childrenCount",get:function(){return this._idMap?this._idMap.size:0}},{key:"forEachChildren",value:function(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])for(var e=this._lastChild,i=0;e;){if(t(e,i++))return;e=e._prev}else for(var n=this._firstChild,r=0;n;){if(t(n,r++))return;n=n._next}}},{key:"forEachChildrenAsync",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return vh(this,void 0,void 0,f().m((function i(){var n,r,a,o,s,l;return f().w((function(i){for(;;)switch(i.n){case 0:if(!e){i.n=7;break}n=this._lastChild,r=0;case 1:if(!n){i.n=6;break}if(a=t(n,r++),!a.then){i.n=3;break}return i.n=2,a;case 2:a=i.v;case 3:if(!a){i.n=4;break}return i.a(2);case 4:n=n._prev;case 5:i.n=1;break;case 6:i.n=13;break;case 7:o=this._firstChild,s=0;case 8:if(!o){i.n=13;break}if(l=t(o,s++),!l.then){i.n=10;break}return i.n=9,l;case 9:l=i.v;case 10:if(!l){i.n=11;break}return i.a(2);case 11:o=o._next;case 12:i.n=8;break;case 13:return i.a(2)}}),i,this)})))}},{key:"forEach",value:function(t){return this.forEachChildren(t)}},{key:"appendChild",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._uid===t._uid)return null;if(!e&&t.isAncestorsOf(this))throw new Error("【Node::appendChild】不能将父辈元素append为子元素");return t.parent&&t.parent.removeChild(t),t.parent=this,this._lastChild?(this._lastChild._next=t,t._prev=this._lastChild,this._lastChild=t):(this._firstChild=this._lastChild=t,t._prev=t._next=null),this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this.setCount(t.count),this._structEdit=!0,t}},{key:"appendChildArrHighPerformance",value:function(t){return console.error("暂不支持该函数"),t}},{key:"insertBefore",value:function(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertBefore】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,t._prev=e._prev,e._prev?e._prev._next=t:this._firstChild=t,e._prev=t,t._next=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}},{key:"insertAfter",value:function(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertAfter】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,e._next?(e._next._prev=t,t._next=e._next):this._lastChild=t,e._next=t,t._prev=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}},{key:"insertInto",value:function(t,e){if(!this._ignoreWarn&&this._nodeList&&Ot.getInstance().warn("insertIntoKeepIdx和insertInto混用可能会存在错误"),e>=this.childrenCount)return this.appendChild(t);if(this===t)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertBefore】不能将父辈元素insert为子元素");if(t.parent&&t.parent.removeChild(t),t.parent=this,0===e)t._next=this._firstChild,this._firstChild&&(this._firstChild._prev=t),t._prev=null,this._firstChild=t;else{for(var i=this._firstChild,n=0;n<e;n++){if(!i)return null;n>0&&(i=i._next)}if(!i)return null;t._next=i._next,t._prev=i,i._next=t,t._next&&(t._next._prev=t)}return this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t}},{key:"insertIntoKeepIdx",value:function(t,e){if(this._nodeList||(this._nodeList=this.children),this._nodeList[e]){var i=this._nodeList[e];return this._nodeList.splice(e,0,t),this.insertBefore(t,i)}var n;this._nodeList[e]=t;for(var r=e-1;r>=0&&!(n=this._nodeList[r]);r--);if(n)return n._next?this.insertBefore(t,n._next):this.appendChild(t);this._ignoreWarn=!0;var a=this.insertInto(t,0);return this._ignoreWarn=!1,a}},{key:"removeChild",value:function(t){if(!this._idMap)return null;if(!this._idMap.has(t._uid))return null;if(this._idMap.delete(t._uid),this._nodeList){var e=this._nodeList.findIndex((function(e){return e===t}));e>=0&&this._nodeList.splice(e,1)}return t._prev?t._prev._next=t._next:this._firstChild=t._next,t._next?t._next._prev=t._prev:this._lastChild=t._prev,t.parent=null,t._prev=null,t._next=null,this._structEdit=!0,this.setCount(-t.count),t}},{key:"delete",value:function(){this.parent&&this.parent.removeChild(this)}},{key:"removeAllChild",value:function(t){if(this._idMap){this._nodeList&&(this._nodeList.length=0);for(var e=this._firstChild;e;){var i=e._next;e.parent=null,e._prev=null,e._next=null,e=e._next,e=i}this._firstChild=null,this._lastChild=null,this._idMap.clear(),this._structEdit=!0,this.setCount(1-this._count)}}},{key:"replaceChild",value:function(t,e){throw new Error("暂不支持")}},{key:"find",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null;return this.forEachChildren((function(i,r){return!(i===e||!t(i,r)||(n=i,0))})),i&&this.forEachChildren((function(e){if(e.isContainer){var i=e.find(t,!0);if(i)return n=i,!0}return!1})),n}},{key:"findAll",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return this.forEachChildren((function(i,r){i!==e&&t(i,r)&&n.push(i)})),i&&this.forEachChildren((function(e){if(e.isContainer){var i=e.findAll(t,!0);i.length&&(n=n.concat(i))}})),n}},{key:"getElementById",value:function(t){return this.find((function(e){return e.id===t}),!0)}},{key:"findChildById",value:function(t){return this.getElementById(t)}},{key:"findChildByUid",value:function(t){return this._idMap&&this._idMap.get(t)||null}},{key:"getElementsByName",value:function(t){return this.findAll((function(e){return e.name===t}),!0)}},{key:"findChildrenByName",value:function(t){return this.getElementsByName(t)}},{key:"getElementsByType",value:function(t){return this.findAll((function(e){return e.type===t}),!0)}},{key:"getChildByName",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.find((function(e){return e.name===t}),e)}},{key:"getChildAt",value:function(t){var e=this._firstChild;if(!e)return null;for(var i=0;i<t;i++){if(!e._next)return null;e=e._next}return e}},{key:"at",value:function(t){return this.getChildAt(t)}},{key:"containNode",value:function(t){if(!this._idMap)return!1;if(this._idMap.has(t._uid))return!0;for(var e=this._firstChild;e;){if(e.containNode(t))return!0;e=e._next}return!1}},{key:"getRootNode",value:function(){for(var t=this.parent;null==t?void 0:t.parent;)t=t.parent;return t||this}},{key:"hasChildNodes",value:function(){return null!==this._firstChild}},{key:"addChild",value:function(t){return this.appendChild(t)}},{key:"add",value:function(t){return this.appendChild(t)}},{key:"getChildren",value:function(){for(var t=[],e=this._firstChild;e;)t.push(e),e=e._next;return t}},{key:"isChildOf",value:function(t){return!!this.parent&&this.parent._uid===t._uid}},{key:"isParentOf",value:function(t){return t.isChildOf(this)}},{key:"isDescendantsOf",value:function(t){var e=this.parent;if(!e)return!1;do{if(e._uid===t._uid)return!0;e=e.parent}while(null!==e);return!1}},{key:"isAncestorsOf",value:function(t){return t.isDescendantsOf(this)}},{key:"getAncestor",value:function(t){throw new Error("暂不支持")}},{key:"setAllDescendantsProps",value:function(t,e){for(var i=this._firstChild;i;)i[t]=e,i.setAllDescendantsProps(t,e),i=i._next}},{key:"setCount",value:function(t){this._count+=t;var e=this.parent;if(e)do{e._count+=t,e=e.parent}while(null!==e)}},{key:"clone",value:function(){throw new Error("暂不支持")}},{key:"cloneTo",value:function(t){throw new Error("暂不支持")}},{key:"getParent",value:function(){return this.parent}},{key:"del",value:function(t){return this.removeChild(t)}},{key:"addEventListener",value:function(t,i,n){var r=N(n,!0)&&n||W(n)&&n.capture,a=W(n)&&n.once,o=V(i)?void 0:i;return t=r?"".concat(t,"capture"):t,i=V(i)?i:i.handleEvent,a?_(e,"once",this,3)([t,i,o]):_(e,"on",this,3)([t,i,o]),this}},{key:"on",value:function(t,e,i){return this.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,i,n){var r=N(n,!0)&&n||W(n)&&n.capture,a=V(i)?void 0:i;t=r?"".concat(t,"capture"):t,i=V(i)?i:i.handleEvent;var o=W(n)&&n.once;return _(e,"off",this,3)([t,i,a,o]),this}},{key:"off",value:function(t,e,i){return this.removeEventListener(t,e,i)}},{key:"once",value:function(t,e,i){return W(i)?(i.once=!0,this.addEventListener(t,e,i)):this.addEventListener(t,e,{once:!0})}},{key:"removeAllEventListeners",value:function(){return _(e,"removeAllListeners",this,3)([]),this}},{key:"removeAllListeners",value:function(){return this.removeAllEventListeners()}},{key:"dispatchEvent",value:function(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return _(e,"emit",this,3)([t.type,t].concat(n)),!t.defaultPrevented}},{key:"emit",value:function(t,e){return this.dispatchEvent(t,e)}},{key:"release",value:function(){this.removeAllListeners()}}])}(z),yh=function(){return o((function t(e){r(this,t),this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=t.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer={x:0,y:0},this.page={x:0,y:0},this.canvas={x:0,y:0},this.viewport={x:0,y:0},this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}),[{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewX",get:function(){return this.viewport.x}},{key:"viewY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.composedDetailPath(),this.path}},{key:"composedDetailPath",value:function(){return this.pickParams&&this.pickParams.graphic?(this.detailPath=this.path.slice(),this._composedDetailPath(this.pickParams)):this.detailPath=this.path.slice(),this.detailPath}},{key:"_composedDetailPath",value:function(t){if(t&&t.graphic){var e=t.graphic;if(e.stage){var i=e.stage.eventSystem.manager.propagationPath(e);this.detailPath.push(i),this._composedDetailPath(t.params)}}}},{key:"preventDefault",value:function(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault()}catch(t){this.nativeEvent.preventDefault&&V(this.nativeEvent.preventDefault)&&this.nativeEvent.preventDefault()}this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.stopPropagation()}catch(t){this.nativeEvent.stopPropagation&&V(this.nativeEvent.stopPropagation)&&this.nativeEvent.stopPropagation()}this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error("Method not implemented.")}}])}(),mh=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).client={x:0,y:0},t.movement={x:0,y:0},t.offset={x:0,y:0},t.global={x:0,y:0},t.screen={x:0,y:0},t}return h(e,t),o(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d,p,f){throw new Error("Method not implemented.")}}])}(yh),_h=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).width=0,t.height=0,t.isPrimary=!1,t}return h(e,t),o(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){var t,i,n,r=new e(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null===(t=this.manager)||void 0===t||t.copyPointerData(this,r),null===(i=this.manager)||void 0===i||i.copyMouseData(this,r),null===(n=this.manager)||void 0===n||n.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();var a=this.composedDetailPath();return r.detailPath=a&&a.slice(),r.type=this.type,r}}])}(mh),bh=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).DOM_DELTA_PIXEL=0,t.DOM_DELTA_LINE=1,t.DOM_DELTA_PAGE=2,t}return h(e,t),o(e,[{key:"clone",value:function(){var t,i,n,r=new e(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null===(t=this.manager)||void 0===t||t.copyWheelData(this,r),null===(i=this.manager)||void 0===i||i.copyMouseData(this,r),null===(n=this.manager)||void 0===n||n.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();var a=this.composedDetailPath();return r.detailPath=a&&a.slice(),r.type=this.type,r}}])}(mh);bh.DOM_DELTA_PIXEL=0,bh.DOM_DELTA_LINE=1,bh.DOM_DELTA_PAGE=2;var xh=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e)).type=t,a.detail=i,a}return h(e,t),o(e)}(yh),kh="object"==("undefined"==typeof performance?"undefined":k(performance))&&performance.now?performance:Date;function Sh(t){return"mouse"===t||"pen"===t}var Ah,Mh=function(){return o((function t(e,i){var n=this;r(this,t),this.dispatch=new z,this.cursorTarget=null,this.pauseNotify=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.onPointerDown=function(t,e){if(t instanceof _h){var i=n.createPointerEvent(t,t.type,e);if(n.dispatchEvent(i,"pointerdown"),"touch"===i.pointerType)n.dispatchEvent(i,"touchstart");else if(Sh(i.pointerType)){var r=2===i.button;n.dispatchEvent(i,r?"rightdown":"mousedown")}n.trackingData(t.pointerId).pressTargetsByButton[t.button]=i.composedPath(),n.freeEvent(i)}else Ot.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerMove=function(t,e){var i,r;if(t instanceof _h){var a=n.createPointerEvent(t,t.type,e),o=Sh(a.pointerType),s=n.trackingData(t.pointerId),l=n.findMountedTarget(s.overTargets);if(s.overTargets&&l&&l!==n.rootTarget&&l!==a.target){var u="mousemove"===t.type?"mouseout":"pointerout",c=n.createPointerEvent(t,u,l||void 0);if(n.dispatchEvent(c,"pointerout"),o&&n.dispatchEvent(c,"mouseout"),!a.composedPath().includes(l)){var h=n.createPointerEvent(t,"pointerleave",l||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&!a.composedPath().includes(h.target);)h.currentTarget=h.target,n.notifyTarget(h),o&&n.notifyTarget(h,"mouseleave"),h.target=h.target.parent;n.freeEvent(h)}n.freeEvent(c)}if(l!==a.target){var d="mousemove"===t.type?"mouseover":"pointerover",p=n.clonePointerEvent(a,d);n.dispatchEvent(p,"pointerover"),o&&n.dispatchEvent(p,"mouseover");for(var f=null==l?void 0:l.parent;f&&f!==n.rootTarget.parent&&f!==a.target;)f=f.parent;if(!f||f===n.rootTarget.parent){var v=n.clonePointerEvent(a,"pointerenter");v.eventPhase=v.AT_TARGET;for(var g=v.target,y=new Set,m=l;m&&m!==n.rootTarget;)y.add(m),m=m.parent;for(;g&&g!==l&&g!==n.rootTarget.parent;)y.has(g)||(v.currentTarget=g,n.notifyTarget(v),o&&n.notifyTarget(v,"mouseenter")),g=g.parent;n.freeEvent(v)}n.freeEvent(p)}n.dispatchEvent(a,"pointermove"),"touch"===a.pointerType&&n.dispatchEvent(a,"touchmove"),o&&(n.dispatchEvent(a,"mousemove"),n.cursorTarget=a.target,n.cursor=(null===(r=null===(i=a.target)||void 0===i?void 0:i.attribute)||void 0===r?void 0:r.cursor)||n.rootTarget.getCursor()),s.overTargets=a.composedPath(),n.freeEvent(a)}else Ot.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerOver=function(t,e){var i,r;if(t instanceof _h){var a=n.trackingData(t.pointerId),o=n.createPointerEvent(t,t.type,e),s=Sh(o.pointerType);n.dispatchEvent(o,"pointerover"),s&&n.dispatchEvent(o,"mouseover"),"mouse"===o.pointerType&&(n.cursorTarget=o.target,n.cursor=(null===(r=null===(i=o.target)||void 0===i?void 0:i.attribute)||void 0===r?void 0:r.cursor)||n.rootTarget.getCursor());var l=n.clonePointerEvent(o,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==n.rootTarget.parent;)l.currentTarget=l.target,n.notifyTarget(l),s&&n.notifyTarget(l,"mouseenter"),l.target=l.target.parent;a.overTargets=o.composedPath(),n.freeEvent(o),n.freeEvent(l)}else Ot.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerOut=function(t,e){if(t instanceof _h){var i=n.trackingData(t.pointerId);if(i.overTargets){var r=Sh(t.pointerType),a=n.findMountedTarget(i.overTargets),o=n.createPointerEvent(t,"pointerout",a||void 0);n.dispatchEvent(o),r&&n.dispatchEvent(o,"mouseout");var s=n.createPointerEvent(t,"pointerleave",a||void 0);for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==n.rootTarget.parent;)s.currentTarget=s.target,n.notifyTarget(s),r&&n.notifyTarget(s,"mouseleave"),s.target=s.target.parent;i.overTargets=[],n.freeEvent(o),n.freeEvent(s)}n.cursorTarget=null,n.cursor=""}else Ot.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerUp=function(t,e){var i;if(t instanceof _h){var r=kh.now(),a=n.createPointerEvent(t,t.type,e);if(n.dispatchEvent(a,"pointerup"),"touch"===a.pointerType)n.dispatchEvent(a,"touchend");else if(Sh(a.pointerType)){var o=2===a.button;n.dispatchEvent(a,o?"rightup":"mouseup")}var s=n.trackingData(t.pointerId),l=n.findMountedTarget(s.pressTargetsByButton[t.button]),u=l;if(l&&!a.composedPath().includes(l)){for(var c=l;c&&!a.composedPath().includes(c);){if(a.currentTarget=c,n.notifyTarget(a,"pointerupoutside"),"touch"===a.pointerType)n.notifyTarget(a,"touchendoutside");else if(Sh(a.pointerType)){var h=2===a.button;n.notifyTarget(a,h?"rightupoutside":"mouseupoutside")}c=c.parent}delete s.pressTargetsByButton[t.button],u=c}if(u){var d=n.clonePointerEvent(a,"click");d.target=u,d.path=[],d.detailPath=[],s.clicksByButton[t.button]||(s.clicksByButton[t.button]={clickCount:0,target:d.target,timeStamp:r});var p=s.clicksByButton[t.button];p.target===d.target&&r-p.timeStamp<(null!==(i=n._config.clickInterval)&&void 0!==i?i:200)?++p.clickCount:p.clickCount=1,p.target=d.target,p.timeStamp=r,d.detail=p.clickCount,Sh(d.pointerType)?(n.dispatchEvent(d,"click"),2===p.clickCount&&n.dispatchEvent(d,"dblclick")):"touch"===d.pointerType&&n._config.supportsTouchEvents&&(n.dispatchEvent(d,"tap"),2===p.clickCount&&n.dispatchEvent(d,"dbltap")),n.dispatchEvent(d,"pointertap"),n.freeEvent(d)}n.freeEvent(a)}else Ot.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerUpOutside=function(t,e){if(t instanceof _h){var i=n.trackingData(t.pointerId),r=n.findMountedTarget(i.pressTargetsByButton[t.button]),a=n.createPointerEvent(t,t.type,e);if(r){for(var o=r;o;)a.currentTarget=o,n.notifyTarget(a,"pointerupoutside"),"touch"===a.pointerType?n.notifyTarget(a,"touchendoutside"):Sh(a.pointerType)&&n.notifyTarget(a,2===a.button?"rightupoutside":"mouseupoutside"),o=o.parent;delete i.pressTargetsByButton[t.button]}n.freeEvent(a)}else Ot.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onWheel=function(t,e){if(t instanceof bh){var i=n.createWheelEvent(t,e);n.dispatchEvent(i),n.freeEvent(i)}else Ot.getInstance().warn("EventManager cannot map a non-wheel event as a wheel event")},this.rootTarget=e,this.mappingTable={},this._config=Object.assign({clickInterval:200},i),this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)}),[{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((function(t,e){return t.priority-e.priority}))}},{key:"dispatchEvent",value:function(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}},{key:"mapEvent",value:function(t){var e,i,n,r,a,o,s;if(this.rootTarget){var u,c=this.mappingTable[t.type],h="".concat(t.canvasX,"-").concat(t.canvasY);if((null===(e=this._prePointTargetCache)||void 0===e?void 0:e[h])&&(null===(n=null===(i=this._prePointTargetCache)||void 0===i?void 0:i[h])||void 0===n?void 0:n.stage)&&(null===(a=null===(r=this._prePointTargetCache)||void 0===r?void 0:r[h])||void 0===a?void 0:a.stage.renderCount)===(null===(o=this._prePointTargetCache)||void 0===o?void 0:o.stageRenderCount)?u=this._prePointTargetCache[h]:(u=this.pickTarget(t.viewX,t.viewY,t),t.pickParams||(this._prePointTargetCache=l(l({},h,u),"stageRenderCount",null!==(s=null==u?void 0:u.stage.renderCount)&&void 0!==s?s:-1))),c)for(var d=0,p=c.length;d<p;d++)c[d].fn(t,u);else Ot.getInstance().warn("[EventManager]: Event mapping not defined for ".concat(t.type))}}},{key:"propagate",value:function(t,e){if(t.target){var i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var n=0,r=i.length-1;n<r;n++)if(t.currentTarget=i[n],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(var a=i.length-2;a>=0;a--)if(t.currentTarget=i[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(t){for(var e=[t],i=0;i<2048&&t!==this.rootTarget&&t.parent;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}},{key:"notifyTarget",value:function(t,e){if(!this.pauseNotify){e=null!=e?e:t.type;var i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[0],i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}},{key:"createPointerEvent",value:function(t,e,i){var n,r,a=this.allocateEvent(_h);return this.copyPointerData(t,a),this.copyMouseData(t,a),this.copyData(t,a),a.nativeEvent=t.nativeEvent,a.originalEvent=t,a.target=i||this.pickTarget(null!==(n=a.viewX)&&void 0!==n?n:a.global.x,null!==(r=a.viewY)&&void 0!==r?r:a.global.y,a),"string"==typeof e&&(a.type=e),a}},{key:"createWheelEvent",value:function(t,e){var i,n,r=this.allocateEvent(bh);return this.copyWheelData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=e||this.pickTarget(null!==(i=r.viewX)&&void 0!==i?i:r.global.x,null!==(n=r.viewY)&&void 0!==n?n:r.global.y,r),r}},{key:"clonePointerEvent",value:function(t,e){var i=this.allocateEvent(_h);i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice();var n=t.composedDetailPath();return i.detailPath=n&&n.slice(),i.type=null!=e?e:i.type,i}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}},{key:"copyPointerData",value:function(t,e){t instanceof _h&&e instanceof _h&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}},{key:"copyMouseData",value:function(t,e){t instanceof mh&&e instanceof mh&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.shiftKey=t.shiftKey,e.metaKey=t.metaKey,["client","movement","canvas","screen","global","offset","viewport"].forEach((function(i){e[i].x=t[i].x,e[i].y=t[i].y})))}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=kh.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.x=t.layer.x,e.layer.y=t.layer.y,e.page.x=t.page.x,e.page.y=t.page.y,e.pickParams=t.pickParams}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}},{key:"allocateEvent",value:function(t){var e;this.eventPool.has(t)||this.eventPool.set(t,[]);var i=(null===(e=this.eventPool.get(t))||void 0===e?void 0:e.pop())||new t(this);return i.eventPhase=i.NONE,i.currentTarget=null,i.path=[],i.detailPath=[],i.target=null,i}},{key:"freeEvent",value:function(t){var e;if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventManager!");var i=t.constructor;this.eventPool.has(i)||this.eventPool.set(i,[]),null===(e=this.eventPool.get(i))||void 0===e||e.push(t)}},{key:"notifyListeners",value:function(t,e){var i=t.currentTarget._events[e];if(i)if("fn"in i)i.once&&t.currentTarget.removeEventListener(e,i.fn,{once:!0}),i.fn.call(i.context,t);else for(var n=0,r=i.length;n<r&&!t.propagationImmediatelyStopped;n++)i[n].once&&t.currentTarget.removeEventListener(e,i[n].fn,{once:!0}),i[n].fn.call(i[n].context,t);this.emitDelegation(t,e)}},{key:"emitDelegation",value:function(t,e){var i=t.currentTarget._events["*"];if(i)if("fn"in i)i.fn.call(i.context,t,e);else for(var n=0,r=i.length;n<r&&!t.propagationImmediatelyStopped;n++)i[n].fn.call(i[n].context,t,e)}},{key:"pickTarget",value:function(t,e,i){var n,r=this.rootTarget.pick(t,e);return n=r&&r.graphic?r.graphic:r&&r.group?r.group:this.rootTarget.AABBBounds.contains(t,e)?this.rootTarget:null,i&&(i.pickParams=r.params),n}},{key:"release",value:function(){this.dispatch.removeAllListeners(),this.eventPool.clear(),this.rootTarget=null,this.mappingTable=null,this.mappingState=null,this.cursorTarget=null}}])}(),Th={dispatchEvent:function(t){var e;if(!(t instanceof yh))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=[],t.detailPath&&(t.detailPath=[]),t.target=this,null===(e=null==t?void 0:t.manager)||void 0===e||e.dispatchEvent(t),!t.defaultPrevented},emit:function(t,e){return this.dispatchEvent(new xh(t,e))}},wh={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Ch=function(){return o((function t(e){var i=this;r(this,t),this.resolution=1,this.onPointerDown=function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=i.normalizeToPointerData(t);i.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var n=0,r=e.length;n<r;n++){var a=e[n],o=i.bootstrapEvent(i.rootPointerEvent,a);i.manager.mapEvent(o)}i.setCursor(i.manager.cursor,i.manager.cursorTarget),i.rootPointerEvent.nativeEvent=null}},this.onPointerMove=function(t){if(!(i.supportsTouchEvents&&"touch"===t.pointerType||i.isEventOutsideOfTargetElement(t))){for(var e=i.normalizeToPointerData(t),n=0,r=e.length;n<r;n++){var a=i.bootstrapEvent(i.rootPointerEvent,e[n]);i.manager.mapEvent(a)}i.setCursor(i.manager.cursor,i.manager.cursorTarget),i.rootPointerEvent.nativeEvent=null}},this.onPointerUp=function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){for(var e=i.isEventOutsideOfTargetViewPort(t)?"outside":"",n=i.normalizeToPointerData(t),r=0,a=n.length;r<a;r++){var o=i.bootstrapEvent(i.rootPointerEvent,n[r]);o.type+=e,i.manager.mapEvent(o)}i.setCursor(i.manager.cursor,i.manager.cursorTarget),i.rootPointerEvent.nativeEvent=null}},this.onPointerOverOut=function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){for(var e=i.normalizeToPointerData(t),n=0,r=e.length;n<r;n++){var a=i.bootstrapEvent(i.rootPointerEvent,e[n]);i.manager.mapEvent(a)}i.setCursor(i.manager.cursor,i.manager.cursorTarget),i.rootPointerEvent.nativeEvent=null}},this.onWheel=function(t){var e=i.normalizeWheelEvent(t);i.manager.mapEvent(e)};var n=e.targetElement,a=e.resolution,o=e.rootNode,s=e.global,l=e.autoPreventDefault,u=void 0!==l&&l,c=e.clickInterval,h=e.supportsTouchEvents,d=void 0===h?s.supportsTouchEvents:h,p=e.supportsPointerEvents,f=void 0===p?s.supportsPointerEvents:p;this.manager=new Mh(o,{clickInterval:c,supportsTouchEvents:d}),this.globalObj=s,this.supportsPointerEvents=f,this.supportsTouchEvents=d,this.supportsMouseEvents=s.supportsMouseEvents,this.applyStyles=s.applyStyles,this.autoPreventDefault=u,this.eventsAdded=!1,this.rootPointerEvent=new _h,this.rootWheelEvent=new bh,this.cursorStyles={default:"inherit",pointer:"pointer"},this.resolution=a,this.setTargetElement(n)}),[{key:"release",value:function(){this.removeEvents(),this.manager&&this.manager.release(),this.domElement=null,this.manager=null,this.globalObj=null}},{key:"setCursor",value:function(t,e){if(e||this.manager.rootTarget.window._handler.canvas.controled){t||(t="default");var i=this.applyStyles,n=this.domElement;if(this.currentCursor!==t){this.currentCursor=t;var r=this.cursorStyles[t];r?"string"==typeof r&&i?n.style.cursor=r:"function"==typeof r?r(t):"object"==k(r)&&i&&Object.assign(n.style,r):i&&K(t)&&!ht(this.cursorStyles,t)&&(n.style.cursor=t)}}}},{key:"setTargetElement",value:function(t){this.removeEvents(),this.domElement=t,this.addEvents()}},{key:"addEvents",value:function(){if(!this.eventsAdded&&this.domElement){var t=this.globalObj,e=this.domElement;this.supportsPointerEvents?(t.getDocument()?(t.addEventListener("pointermove",this.onPointerMove,!0),t.addEventListener("pointerup",this.onPointerUp,!0)):(e.addEventListener("pointermove",this.onPointerMove,!0),e.addEventListener("pointerup",this.onPointerUp,!0)),e.addEventListener("pointerdown",this.onPointerDown,!0),e.addEventListener("pointerleave",this.onPointerOverOut,!0),e.addEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.addEventListener("mousemove",this.onPointerMove,!0),t.addEventListener("mouseup",this.onPointerUp,!0)):(e.addEventListener("mousemove",this.onPointerMove,!0),e.addEventListener("mouseup",this.onPointerUp,!0)),e.addEventListener("mousedown",this.onPointerDown,!0),e.addEventListener("mouseout",this.onPointerOverOut,!0),e.addEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.addEventListener("touchstart",this.onPointerDown,!0),e.addEventListener("touchend",this.onPointerUp,!0),e.addEventListener("touchmove",this.onPointerMove,!0)),e.addEventListener("wheel",this.onWheel,{capture:!0}),this.eventsAdded=!0}}},{key:"removeEvents",value:function(){if(this.eventsAdded&&this.domElement){var t=this.globalObj,e=this.domElement;this.supportsPointerEvents?(t.getDocument()?(t.removeEventListener("pointermove",this.onPointerMove,!0),t.removeEventListener("pointerup",this.onPointerUp,!0)):(e.removeEventListener("pointermove",this.onPointerMove,!0),e.removeEventListener("pointerup",this.onPointerUp,!0)),e.removeEventListener("pointerdown",this.onPointerDown,!0),e.removeEventListener("pointerleave",this.onPointerOverOut,!0),e.removeEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.removeEventListener("mousemove",this.onPointerMove,!0),t.removeEventListener("mouseup",this.onPointerUp,!0)):(e.removeEventListener("mousemove",this.onPointerMove,!0),e.removeEventListener("mouseup",this.onPointerUp,!0)),e.removeEventListener("mousedown",this.onPointerDown,!0),e.removeEventListener("mouseout",this.onPointerOverOut,!0),e.removeEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.removeEventListener("touchstart",this.onPointerDown,!0),e.removeEventListener("touchend",this.onPointerUp,!0),e.removeEventListener("touchmove",this.onPointerMove,!0)),e.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}}},{key:"mapToViewportPoint",value:function(t){return this.domElement.pointTransform?this.domElement.pointTransform(t.x,t.y):t}},{key:"mapToCanvasPoint",value:function(t){var e,i,n=null===(e=this.globalObj)||void 0===e?void 0:e.mapToCanvasPoint(t,this.domElement);if(n)return n;var r=0,a=0;if(t.changedTouches){var o=null!==(i=t.changedTouches[0])&&void 0!==i?i:{};r=o.clientX||0,a=o.clientY||0}else r=t.clientX||0,a=t.clientY||0;var s=this.domElement.getBoundingClientRect();return{x:r-s.left,y:a-s.top}}},{key:"normalizeToPointerData",value:function(t){var e=[];if(this.supportsTouchEvents&&t.changedTouches&&t.changedTouches.length)for(var i=0,n=t.changedTouches.length;i<n;i++){var r=t.changedTouches[i];X(r.button)&&(r.button=0),X(r.buttons)&&(r.buttons=1),X(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),X(r.width)&&(r.width=r.radiusX||1),X(r.height)&&(r.height=r.radiusY||1),X(r.tiltX)&&(r.tiltX=0),X(r.tiltY)&&(r.tiltY=0),X(r.pointerType)&&(r.pointerType="touch"),X(r.pointerId)&&(r.pointerId=r.identifier||0),X(r.pressure)&&(r.pressure=r.force||.5),X(r.twist)&&(r.twist=0),X(r.tangentialPressure)&&(r.tangentialPressure=0),X(r.layerX)&&(r.layerX=r.offsetX=r.clientX),X(r.layerY)&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=t.type,e.push(r)}else if(!this.globalObj.supportsMouseEvents||t instanceof MouseEvent&&!(this.supportsPointerEvents&&t instanceof PointerEvent)){var a=t;X(a.isPrimary)&&(a.isPrimary=!0),X(a.width)&&(a.width=1),X(a.height)&&(a.height=1),X(a.tiltX)&&(a.tiltX=0),X(a.tiltY)&&(a.tiltY=0),X(a.pointerType)&&(a.pointerType="mouse"),X(a.pointerId)&&(a.pointerId=1),X(a.pressure)&&(a.pressure=.5),X(a.twist)&&(a.twist=0),X(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,e.push(a)}else e.push(t);return e}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var i=this.mapToCanvasPoint(t),n=i.x,r=i.y;e.canvas.x=n,e.canvas.y=r,e.global.x=n,e.global.y=r,e.offset.x=n,e.offset.y=r;var a=this.mapToViewportPoint(e),o=a.x,s=a.y;return e.viewport.x=o,e.viewport.y=s,e.nativeEvent=t,e.type=t.type,e}},{key:"bootstrapEvent",value:function(t,e){t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.mapToCanvasPoint(e),n=i.x,r=i.y;t.canvas.x=n,t.canvas.y=r,t.global.x=n,t.global.y=r,t.offset.x=n,t.offset.y=r;var a=this.mapToViewportPoint(t),o=a.x,s=a.y;return t.viewport.x=o,t.viewport.y=s,t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=wh[t.type]||t.type),t}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=kh.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null}},{key:"isEventOutsideOfTargetViewPort",value:function(t){if(this.isEventOutsideOfTargetElement(t))return!0;if(this.domElement.getViewBox){var e=this.mapToViewportPoint(this.mapToCanvasPoint(t)),i=this.domElement.getViewBox(),n=i.width(),r=i.height();return!(e.x<n&&e.y<r&&e.x>0&&e.y>0)}return!1}},{key:"isEventOutsideOfTargetElement",value:function(t){var e=t.target;return t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]),e!==(this.domElement.getNativeHandler?this.domElement.getNativeHandler().nativeCanvas:this.domElement)}},{key:"pauseTriggerEvent",value:function(){this.manager.pauseNotify=!0}},{key:"resumeTriggerEvent",value:function(){this.manager.pauseNotify=!1}}])}(),Eh=function(){function t(){r(this,t)}return o(t,null,[{key:"GetImage",value:function(e,i){var n,r=t.cache.get(e);r?"fail"===r.loadState?al.global.getRequestAnimationFrame()((function(){i.imageLoadFail(e)})):"init"===r.loadState||"loading"===r.loadState?null===(n=r.waitingMark)||void 0===n||n.push(i):i&&i.imageLoadSuccess(e,r.data):t.loadImage(e,i)}},{key:"GetSvg",value:function(e,i){var n,r=t.cache.get(e);r?"fail"===r.loadState?al.global.getRequestAnimationFrame()((function(){i.imageLoadFail(e)})):"init"===r.loadState||"loading"===r.loadState?null===(n=r.waitingMark)||void 0===n||n.push(i):i&&i.imageLoadSuccess(e,r.data):(r={type:"image",loadState:"init"},t.cache.set(e,r),r.dataPromise=al.global.loadSvg(e),r.dataPromise?(r.waitingMark=[i],r.dataPromise.then((function(t){var i;r.loadState=(null==t?void 0:t.data)?"success":"fail",r.data=null==t?void 0:t.data,null===(i=r.waitingMark)||void 0===i||i.map((function(i,n){(null==t?void 0:t.data)?(r.loadState="success",r.data=t.data,i.imageLoadSuccess(e,t.data)):(r.loadState="fail",i.imageLoadFail(e))})),r.waitingMark&&(r.waitingMark=[])}))):(r.loadState="fail",i.imageLoadFail(e)))}},{key:"GetFile",value:function(e,i){var n=t.cache.get(e);return n?"fail"===n.loadState?Promise.reject():"init"===n.loadState||"loading"===n.loadState?n.dataPromise.then((function(t){return t.data})):Promise.resolve(n.data):(n={type:i,loadState:"init"},t.cache.set(e,n),"arrayBuffer"===i?n.dataPromise=al.global.loadArrayBuffer(e):"blob"===i?n.dataPromise=al.global.loadBlob(e):"json"===i&&(n.dataPromise=al.global.loadJson(e)),n.dataPromise.then((function(t){return t.data})))}},{key:"loading",value:function(){var e=this;setTimeout((function(){if(!t.isLoading&&t.toLoadAueue.length){t.isLoading=!0;var i=t.toLoadAueue.splice(0,10),n=[];i.forEach((function(e){var i=e.url,r=e.marks,a={type:"image",loadState:"init"};if(t.cache.set(i,a),a.dataPromise=al.global.loadImage(i),a.dataPromise){a.waitingMark=r;var o=a.dataPromise.then((function(t){var e;a.loadState=(null==t?void 0:t.data)?"success":"fail",a.data=null==t?void 0:t.data,null===(e=a.waitingMark)||void 0===e||e.map((function(e,n){(null==t?void 0:t.data)?(a.loadState="success",a.data=t.data,e.imageLoadSuccess(i,t.data)):(a.loadState="fail",e.imageLoadFail(i))})),a.waitingMark&&(a.waitingMark=[])}));n.push(o)}else a.loadState="fail",r.forEach((function(t){return t.imageLoadFail(i)}))})),Promise.all(n).then((function(){t.isLoading=!1,e.onLoadSuccessCb.forEach((function(t){return t()})),t.loading()})).catch((function(i){console.error(i),t.isLoading=!1,e.onLoadSuccessCb.forEach((function(t){return t()})),t.loading()}))}}),0)}},{key:"loadImage",value:function(e,i){var n=Ph(e,t.toLoadAueue);if(-1!==n)return t.toLoadAueue[n].marks.push(i),void t.loading();t.toLoadAueue.push({url:e,marks:[i]}),t.loading()}},{key:"improveImageLoading",value:function(e){var i=Ph(e,t.toLoadAueue);if(-1!==i){var n=t.toLoadAueue.splice(i,1);t.toLoadAueue.unshift(n[0])}}},{key:"onLoadSuccess",value:function(t){this.onLoadSuccessCb.push(t)}}])}();function Ph(t,e){for(var i=0;i<e.length;i++)if(e[i].url===t)return i;return-1}Eh.cache=new Map,Eh.isLoading=!1,Eh.toLoadAueue=[],Eh.onLoadSuccessCb=[],function(t){t[t.Top=1]="Top",t[t.Right=2]="Right",t[t.Bottom=4]="Bottom",t[t.Left=8]="Left",t[t.ALL=15]="ALL"}(Ah||(Ah={}));var Bh=[!1,!1,!1,!1],Rh=[0,0,0,0],Lh=function(t){return t?q(t)?0===t.length?0:1===t.length?t[0]:2===t.length?(Rh[0]=t[0],Rh[2]=t[0],Rh[1]=t[1],Rh[3]=t[1],Rh):t:t:0},Ih=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],Dh=[1,2,3,0,1,2,3,0];function Oh(t,e,i,n){for(;t>=me;)t-=me;for(;t<0;)t+=me;for(;t>e;)e+=me;Ih[0].x=i,Ih[1].y=i,Ih[2].x=-i,Ih[3].y=-i;var r=Math.ceil(t/ge)%4,a=Math.ceil(e/ge)%4;if(n.add(xe(t)*i,Ae(t)*i),n.add(xe(e)*i,Ae(e)*i),r!==a||e-t>ve)for(var o=!1,s=0;s<Dh.length;s++)if(o||r!==Dh[s]){if(o&&a===Dh[s])break;if(o){var l=Ih[Dh[s]];n.add(l.x,l.y)}}else{o=!0;var u=Ih[r];n.add(u.x,u.y)}}function Fh(t,e,i){var n=Ce(t.x,t.y,e.x,e.y,i),r=n.x,a=n.y,o=Ce(t.x1,t.y1,e.x1,e.y1,i),s=o.x,l=o.y,u=new De(r,a,s,l);return u.defined=e.defined,u}function zh(t,e,i){if(!t||!e)return[];Array.isArray(t)||(t=[t]),Array.isArray(e)||(e=[e]);var n=[];if(t.length>e.length){n=e.map((function(t){var e=new De(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e}));for(var r=0;r<e.length;r++)n[r]=Fh(t[r],e[r],i)}else{n=e.map((function(t){var e=new De(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e}));for(var a=0;a<t.length;a++)n[a]=Fh(t[a],e[a],i)}return n}function Hh(t,e){if(q(t)){for(var i,n=0;n<t.length&&void 0===i;n++)i=t[n][e];return i}return t[e]}var Nh=function(){return o((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.TimeOut;r(this,t),this.durations=[],this.timeout=e,this.lastDate=0,this.durationsListThreshold=30}),[{key:"call",value:function(t){var e=this;return this.lastDate=Date.now(),setTimeout((function(){e.appendDuration(Date.now()-e.lastDate),t(0)}),this.timeout,!0)}},{key:"clear",value:function(t){clearTimeout(t)}},{key:"appendDuration",value:function(t){this.durations.push(t),this.durations.length>this.durationsListThreshold&&this.durations.shift(),this.timeout=Math.min(Math.max(this.durations.reduce((function(t,e){return t+e}),0)/this.durations.length,1e3/60),1e3/30)}}])}();Nh.TimeOut=1e3/60;var Vh=new Nh,jh=function(t,e){var i=function(t,e){return K(t)&&"%"===t[t.length-1]?e*(Number.parseFloat(t.substring(0,t.length-1))/100):t}(t,e);return isNaN(i)?i:Math.max(e,i)},Uh=function(){return o((function t(){r(this,t)}),[{key:"bounds",value:function(t,e){if(Q(t)){var i=t/2;e.x1=-i,e.x2=i,e.y1=-i,e.y2=i}else e.x1=-t[0]/2,e.x2=t[0]/2,e.y1=-t[1]/2,e.y2=t[1]/2}},{key:"parseSize",value:function(t){return Q(t)?t:Math.min(t[0],t[1])}}])}();function Wh(t,e,i,n,r){return r?t.arc(i,n,e,0,ye,!1,r):t.arc(i,n,e,0,ye),!1}var Gh=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="circle",t.pathStr="M0.5,0A0.5,0.5,0,1,1,-0.5,0A0.5,0.5,0,1,1,0.5,0",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return Wh(t,this.parseSize(e)/2,i,n,r)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return Wh(t,this.parseSize(e)/2+r,i,n,a)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=this.parseSize(t)/2;return"M ".concat(e-r,", ").concat(i," a ").concat(r,",").concat(r," 0 1,0 ").concat(2*r,",0 a ").concat(r,",").concat(r," 0 1,0 -").concat(2*r,",0")}}])}(Uh),Yh=new Gh;var Xh=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="cross",t.pathStr="M-0.5,-0.2L-0.5,0.2L-0.2,0.2L-0.2,0.5L0.2,0.5L0.2,0.2L0.5,0.2L0.5,-0.2L0.2,-0.2L0.2,-0.5L-0.2,-0.5L-0.2,-0.2Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return function(t,e,i,n,r){return t.moveTo(-3*e+i,-e+n,r),t.lineTo(-e+i,-e+n,r),t.lineTo(-e+i,-3*e+n,r),t.lineTo(e+i,-3*e+n,r),t.lineTo(e+i,-e+n,r),t.lineTo(3*e+i,-e+n,r),t.lineTo(3*e+i,e+n,r),t.lineTo(e+i,e+n,r),t.lineTo(e+i,3*e+n,r),t.lineTo(-e+i,3*e+n,r),t.lineTo(-e+i,e+n,r),t.lineTo(-3*e+i,e+n,r),t.closePath(),!0}(t,this.parseSize(e)/6,i,n,r)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return function(t,e,i,n,r,a){return t.moveTo(-3*e+i-r,-e+n-r,a),t.lineTo(-e+i-r,-e+n-r,a),t.lineTo(-e+i-r,-3*e+n-r,a),t.lineTo(e+i+r,-3*e+n-r,a),t.lineTo(e+i+r,-e+n-r,a),t.lineTo(3*e+i+r,-e+n-r,a),t.lineTo(3*e+i+r,e+n+r,a),t.lineTo(e+i+r,e+n+r,a),t.lineTo(e+i+r,3*e+n+r,a),t.lineTo(-e+i-r,3*e+n+r,a),t.lineTo(-e+i-r,e+n+r,a),t.lineTo(-3*e+i-r,e+n+r,a),t.closePath(),!0}(t,this.parseSize(e)/6,i,n,r,a)}}])}(Uh),Kh=new Xh;function qh(t,e,i,n,r){return t.moveTo(i,n-e,r),t.lineTo(e+i,n,r),t.lineTo(i,n+e,r),t.lineTo(i-e,n,r),t.closePath(),!0}var Zh=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="diamond",t.pathStr="M-0.5,0L0,-0.5L0.5,0L0,0.5Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return qh(t,this.parseSize(e)/2,i,n,r)}},{key:"drawFitDir",value:function(t,e,i,n,r){return qh(t,this.parseSize(e)/2,i,n,r)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return qh(t,this.parseSize(e)/2+r,i,n,a)}}])}(Uh),Jh=new Zh;function Qh(t,e,i,n){var r=2*e;return t.rect(i-e,n-e,r,r),!1}var $h=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="square",t.pathStr="M-0.5,-0.5h1v1h-1Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Qh(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Qh(t,this.parseSize(e)/2+r,i,n)}}])}(Uh),td=new $h;function ed(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return t.moveTo(i+e+2*r,e+n+r),t.lineTo(i-e-2*r,e+n+r),t.lineTo(i,n-e-2*r),t.closePath(),!0}var id=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="triangleUp",t.pathStr="M0.5,0.5 L-0.5,0.5 L0,-0.5 Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return ed(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return ed(t,this.parseSize(e)/2,i,n,r)}}])}(Uh),nd=new id,rd=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="triangle",t}return h(e,t),o(e)}(id),ad=new rd,od=Math.sin(Math.PI/10)/Math.sin(7*Math.PI/10),sd=Math.sin(ye/10)*od,ld=-Math.cos(ye/10)*od;function ud(t,e,i,n){var r=sd*e,a=ld*e;t.moveTo(i,-e+n),t.lineTo(r+i,a+n);for(var o=1;o<5;++o){var s=ye*o/5,l=Math.cos(s),u=Math.sin(s);t.lineTo(u*e+i,-l*e+n),t.lineTo(l*r-u*a+i,u*r+l*a+n)}return t.closePath(),!0}var cd=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="star",t.pathStr="M0 -1L0.22451398828979266 -0.3090169943749474L0.9510565162951535 -0.30901699437494745L0.3632712640026804 0.1180339887498948L0.5877852522924732 0.8090169943749473L8.326672684688674e-17 0.3819660112501051L-0.587785252292473 0.8090169943749476L-0.3632712640026804 0.11803398874989487L-0.9510565162951536 -0.30901699437494723L-0.22451398828979274 -0.30901699437494734Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return ud(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return ud(t,this.parseSize(e)/2+r,i,n)}}])}(Uh),hd=new cd,dd=Me(3);function pd(t,e,i,n){var r=e,a=r/dd,o=a/5,s=e;return t.moveTo(0+i,-r+n),t.lineTo(a/2+i,n),t.lineTo(o/2+i,n),t.lineTo(o/2+i,s+n),t.lineTo(-o/2+i,s+n),t.lineTo(-o/2+i,n),t.lineTo(-a/2+i,n),t.closePath(),!0}var fd=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="arrow",t.pathStr="M-0.07142857142857142,0.5L0.07142857142857142,0.5L0.07142857142857142,-0.0625L0.2,-0.0625L0,-0.5L-0.2,-0.0625L-0.07142857142857142,-0.0625Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return pd(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return pd(t,this.parseSize(e)/2+r,i,n)}}])}(Uh),vd=new fd;function gd(t,e,i,n){var r=2*e;return t.moveTo(i,-e+n),t.lineTo(r/3/2+i,e+n),t.lineTo(-r/3/2+i,e+n),t.closePath(),!0}var yd=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="wedge",t.pathStr="M0,-0.5773502691896257L-0.125,0.28867513459481287L0.125,0.28867513459481287Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return gd(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return gd(t,this.parseSize(e)/2+r,i,n)}}])}(Uh),md=new yd;function _d(t,e,i,n){return t.moveTo(-e+i,n),t.lineTo(i,e+n),!1}var bd=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="stroke",t.pathStr="",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return _d(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return _d(t,this.parseSize(e)/2+r,i,n)}}])}(Uh),xd=new bd,kd=-.5,Sd=Me(3)/2,Ad=1/Me(12);function Md(t,e,i,n){var r=e/2,a=e*Ad,o=r,s=e*Ad+e,l=-o,u=s;return t.moveTo(r+i,a+n),t.lineTo(o+i,s+n),t.lineTo(l+i,u+n),t.lineTo(kd*r-Sd*a+i,Sd*r+kd*a+n),t.lineTo(kd*o-Sd*s+i,Sd*o+kd*s+n),t.lineTo(kd*l-Sd*u+i,Sd*l+kd*u+n),t.lineTo(kd*r+Sd*a+i,kd*a-Sd*r+n),t.lineTo(kd*o+Sd*s+i,kd*s-Sd*o+n),t.lineTo(kd*l+Sd*u+i,kd*u-Sd*l+n),t.closePath(),!1}var Td=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="wye",t.pathStr="M0.25 0.14433756729740646L0.25 0.6443375672974064L-0.25 0.6443375672974064L-0.25 0.14433756729740643L-0.6830127018922193 -0.10566243270259357L-0.4330127018922193 -0.5386751345948129L0 -0.28867513459481287L0.4330127018922193 -0.5386751345948129L0.6830127018922193 -0.10566243270259357Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Md(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Md(t,this.parseSize(e)/2+r,i,n)}}])}(Uh),wd=new Td;function Cd(t,e,i,n,r){return t.moveTo(-e+i-2*r,n),t.lineTo(e+i+r,e+n+2*r),t.lineTo(e+i+r,n-e-2*r),t.closePath(),!0}var Ed=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="triangleLeft",t.pathStr="M-0.5,0 L0.5,0.5 L0.5,-0.5 Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Cd(t,this.parseSize(e)/2,i,n,0)}},{key:"drawOffset",value:function(t,e,i,n,r){return Cd(t,this.parseSize(e)/2,i,n,r)}}])}(Uh),Pd=new Ed;function Bd(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return t.moveTo(i-e-r,e+n+2*r),t.lineTo(e+i+2*r,n),t.lineTo(i-e-r,n-e-2*r),t.closePath(),!0}var Rd=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="triangleRight",t.pathStr="M-0.5,0.5 L0.5,0 L-0.5,-0.5 Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Bd(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Bd(t,this.parseSize(e)/2,i,n,r)}}])}(Uh),Ld=new Rd;function Id(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return t.moveTo(i-e-2*r,n-e-r),t.lineTo(i+e+2*r,n-e-r),t.lineTo(i,n+e+2*r),t.closePath(),!0}var Dd=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="triangleDown",t.pathStr="M-0.5,-0.5 L0.5,-0.5 L0,0.5 Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Id(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Id(t,this.parseSize(e)/2,i,n,r)}}])}(Uh),Od=new Dd,Fd=Me(3);function zd(t,e,i,n){var r=e*Fd;return t.moveTo(i,n+-r/3*2),t.lineTo(e+i,n+r),t.lineTo(i-e,n+r),t.closePath(),!0}var Hd=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="thinTriangle",t.pathStr="M0,-0.5773502691896257L-0.5,0.28867513459481287L0.5,0.28867513459481287Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return zd(t,this.parseSize(e)/2/Fd,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return zd(t,this.parseSize(e)/2/Fd+r,i,n)}}])}(Uh),Nd=new Hd;function Vd(t,e,i,n){var r=2*e;return t.moveTo(e+i,n-r),t.lineTo(i-e,n),t.lineTo(e+i,r+n),!0}var jd=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="arrow2Left",t.pathStr="M 0.25 -0.5 L -0.25 0 l 0.25 0.5",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Vd(t,this.parseSize(e)/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Vd(t,this.parseSize(e)/4+r,i,n)}}])}(Uh),Ud=new jd;function Wd(t,e,i,n){var r=2*e;return t.moveTo(i-e,n-r),t.lineTo(i+e,n),t.lineTo(i-e,r+n),!0}var Gd=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="arrow2Right",t.pathStr="M -0.25 -0.5 l 0.25 0 l -0.25 0.5",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Wd(t,this.parseSize(e)/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Wd(t,this.parseSize(e)/4+r,i,n)}}])}(Uh),Yd=new Gd;function Xd(t,e,i,n){var r=2*e;return t.moveTo(i-r,n+e),t.lineTo(i,n-e),t.lineTo(i+r,n+e),!0}var Kd=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="arrow2Up",t.pathStr="M -0.5 0.25 L 0 -0.25 l 0.5 0.25",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Xd(t,this.parseSize(e)/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Xd(t,this.parseSize(e)/4+r,i,n)}}])}(Uh),qd=new Kd;function Zd(t,e,i,n){var r=2*e;return t.moveTo(i-r,n-e),t.lineTo(i,n+e),t.lineTo(i+r,n-e),!0}var Jd=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="arrow2Down",t.pathStr="M -0.5 -0.25 L 0 0.25 l 0.5 -0.25",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Zd(t,this.parseSize(e)/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Zd(t,this.parseSize(e)/4+r,i,n)}}])}(Uh),Qd=new Jd;function $d(t,e,i,n,r){return t.moveTo(i,n-e),t.lineTo(i,n+e),!0}var tp=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="lineV",t.pathStr="M0,-0.5L0,0.5",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return $d(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return $d(t,this.parseSize(e)/2+r,i,n)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=this.parseSize(t)/2;return"M ".concat(e,", ").concat(i-r," L ").concat(e,",").concat(i+r)}}])}(Uh),ep=new tp;function ip(t,e,i,n,r){return t.moveTo(i-e,n),t.lineTo(i+e,n),!0}var np=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="lineH",t.pathStr="M-0.5,0L0.5,0",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return ip(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return ip(t,this.parseSize(e)/2+r,i,n)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=this.parseSize(t)/2;return"M ".concat(e-r,", ").concat(i," L ").concat(e+r,",").concat(i)}}])}(Uh),rp=new np;function ap(t,e,i,n,r){return t.moveTo(i-e,n-e),t.lineTo(i+e,n+e),t.moveTo(i+e,n-e),t.lineTo(i-e,n+e),!0}var op=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="close",t.pathStr="M-0.5,-0.5L0.5,0.5,M0.5,-0.5L-0.5,0.5",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return ap(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return ap(t,this.parseSize(e)/2+r,i,n)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=this.parseSize(t)/2;return"M ".concat(e-r,", ").concat(i-r," L ").concat(e+r,",").concat(i+r," M ").concat(e+r,", ").concat(i-r," L ").concat(e-r,",").concat(i+r)}}])}(Uh),sp=new op;function lp(t,e,i,n){return t.rect(i-e[0]/2,n-e[1]/2,e[0],e[1]),!1}function up(t,e,i,n){var r=e,a=e/2;return t.rect(i-r/2,n-a/2,r,a),!1}var cp=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="rect",t.pathStr="M -0.5,0.25 L 0.5,0.25 L 0.5,-0.25,L -0.5,-0.25 Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Q(e)?up(t,e,i,n):lp(t,e,i,n)}},{key:"drawWithClipRange",value:function(t,e,i,n,r,a,o){Q(e)&&(e=[e,e/2]);var s=2*(e[0]+e[1])*r,l=[{x:i+e[0]/2,y:n-e[1]/2},{x:i+e[0]/2,y:n+e[1]/2},{x:i-e[0]/2,y:n+e[1]/2},{x:i-e[0]/2,y:n-e[1]/2}],u=0,c=l[3];t.moveTo(c.x,c.y);for(var h=0;h<l.length;h++){var d=l[h],p=Math.sqrt((d.x-c.x)*(d.x-c.x)+(d.y-c.y)*(d.y-c.y));if(u+p>s){var f=(d.x-c.x)*(s-u)/p,v=(d.y-c.y)*(s-u)/p;t.lineTo(c.x+f,c.y+v);break}t.lineTo(d.x,d.y),c=d,u+=p}return!1}},{key:"drawOffset",value:function(t,e,i,n,r){return Q(e)?up(t,e+2*r,i,n):lp(t,[e[0]+2*r,e[1]+2*r],i,n)}}])}(Uh),hp=new cp,dp=new _i,pp=function(){return o((function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,t),this.pathStr="",this.type=e,q(i)?this.svgCache=i:this.path=i,this.isSvg=n}),[{key:"drawOffset",value:function(t,e,i,n,r,a,o){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach((function(r){t.beginPath(),Dl(r.path.commandList,t,i,n,e,e),o&&o(r.path,r.attribute)})),!1):(Dl(this.path.commandList,t,i,n,e+r,e+r),!1)}},{key:"draw",value:function(t,e,i,n,r,a){return e=this.parseSize(e),this.drawOffset(t,e,i,n,0,r,a)}},{key:"parseSize",value:function(t){return Q(t)?t:Math.min(t[0],t[1])}},{key:"drawWithClipRange",value:function(t,e,i,n,r,a,o){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach((function(a){a.path.drawWithClipRange(t,e,i,n,r),o&&o(a.path,a.attribute)})),!1):(this.path.drawWithClipRange(t,e,i,n,r),!1)}},{key:"bounds",value:function(t,e){if(t=this.parseSize(t),this.isSvg){if(!this.svgCache)return;return e.clear(),void this.svgCache.forEach((function(i){var n=i.path;dp.x1=n.bounds.x1*t,dp.y1=n.bounds.y1*t,dp.x2=n.bounds.x2*t,dp.y2=n.bounds.y2*t,e.union(dp)}))}this.path.bounds&&(e.x1=this.path.bounds.x1*t,e.y1=this.path.bounds.y1*t,e.x2=this.path.bounds.x2*t,e.y2=this.path.bounds.y2*t)}}])}(),fp={};[Yh,Kh,Jh,td,Nd,ad,hd,vd,md,xd,wd,Pd,Ld,nd,Od,Ud,Yd,qd,Qd,hp,ep,rp,sp].forEach((function(t){fp[t.type]=t}));var vp={arrowLeft:"M 0.25 -0.5 L -0.25 0 l 0.5 0.5",arrowRight:"M -0.25 -0.5 l 0.5 0.5 l -0.5 0.5",rectRound:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",roundLine:"M 1.2392 -0.258 L -1.3432 -0.258 C -1.4784 -0.258 -1.588 -0.1436 -1.588 -0.002 c 0 0.1416 0.1096 0.256 0.2448 0.256 l 2.5824 0 c 0.1352 0 0.2448 -0.1144 0.2448 -0.256 C 1.484 -0.1436 1.3744 -0.258 1.2392 -0.258 z"};var gp=function(){return o((function t(e){r(this,t),this.tagname=e,this.child=[],this[":@"]={}}),[{key:"add",value:function(t,e){"__proto__"===t&&(t="#__proto__"),this.child.push(l({},t,e))}},{key:"addChild",value:function(t){"__proto__"===t.tagname&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push(l(l({},t.tagname,t.child),":@",t[":@"])):this.child.push(l({},t.tagname,t.child))}}])}();function yp(t,e,i,n){var r=t.indexOf(e,i);if(-1===r)throw new Error(n);return r+e.length-1}function mp(t,e,i){var n=function(t,e){for(var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:">",r="",a=e;a<t.length;a++){var o=t[a];if(i)o===i&&(i="");else if('"'===o||"'"===o)i=o;else if(o===n[0]){if(!n[1])return{data:r,index:a};if(t[a+1]===n[1])return{data:r,index:a}}else"\t"===o&&(o=" ");r+=o}}(t,e+1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:">");if(n){var r=n.data,a=n.index,o=r.search(/\s/),s=r,l=!0;-1!==o&&(s=r.substr(0,o).replace(/\s\s*$/,""),r=r.substr(o+1));var u=s;if(i){var c=s.indexOf(":");-1!==c&&(l=(s=s.substr(c+1))!==n.data.substr(c+1))}return{tagName:s,tagExp:r,closeIndex:a,attrExpPresent:l,rawTagName:u}}}var _p=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm"),bp=function(){return o((function t(e){r(this,t),this.currentNode=null,this.options=e,this.tagsNodeStack=[],this.docTypeEntities={}}),[{key:"addChild",value:function(t,e,i){var n=e.tagname;"string"==typeof n?(e.tagname=n,t.addChild(e)):t.addChild(e)}},{key:"buildAttributesMap",value:function(t,e,i){var n={};if(t){for(var r=function(t,e){for(var i=[],n=e.exec(t);n;){var r=[];r.startIndex=e.lastIndex-n[0].length;for(var a=n.length,o=0;o<a;o++)r.push(n[o]);i.push(r),n=e.exec(t)}return i}(t,_p),a=r.length,o=0;o<a;o++){var s=r[o][1],l=r[o][4];s&&(n[s]=void 0===l||(isNaN(l)?l:Number(l)))}return n}}},{key:"parseXml",value:function(t){t=t.replace(/\r\n?/g,"\n");for(var e=new gp("!xml"),i=e,n="",r="",a=0;a<t.length;a++)if("<"===t[a])if("/"===t[a+1]){var o=yp(t,">",a,"Closing Tag is not closed."),s=r.lastIndexOf(".");r=r.substring(0,s),(i=this.tagsNodeStack.pop())&&i.child&&n&&i.child[i.child.length-1][":@"]&&(i.child[i.child.length-1][":@"].text=n),n="",a=o}else if("?"===t[a+1])a=mp(t,a,!1,"?>").closeIndex+1;else if("!--"===t.substr(a+1,3))a=yp(t,"--\x3e",a+4,"Comment is not closed.");else{var l=mp(t,a,!1),u=l.tagName,c=l.tagExp,h=l.attrExpPresent,d=l.closeIndex;if(u!==e.tagname&&(r+=r?"."+u:u),c.length>0&&c.lastIndexOf("/")===c.length-1){"/"===u[u.length-1]?(u=u.substr(0,u.length-1),r=r.substr(0,r.length-1),c=u):c=c.substr(0,c.length-1);var p=new gp(u);u!==c&&h&&(p[":@"]=this.buildAttributesMap(c,r,u)),this.addChild(i,p,r),r=r.substr(0,r.lastIndexOf("."))}else{var f=new gp(u);this.tagsNodeStack.push(i),u!==c&&h&&(f[":@"]=this.buildAttributesMap(c,r,u)),this.addChild(i,f,r),i=f}n="",a=d}else n+=t[a];return e.child}}])}();function xp(t,e){return kp(t)}function kp(t,e){for(var i,n={},r=0;r<t.length;r++){var a=t[r],o=Sp(a);if(void 0!==o&&a[o]){var s=kp(a[o]);i=s,Object.keys(i).length,a[":@"]&&Ap(s,a[":@"]),void 0!==n[o]&&n.hasOwnProperty(o)?(Array.isArray(n[o])||(n[o]=[n[o]]),n[o].push(s)):n[o]=s}}return n}function Sp(t){for(var e=Object.keys(t),i=0;i<e.length;i++){var n=e[i];if(":@"!==n)return n}}function Ap(t,e,i){if(e)for(var n=Object.keys(e),r=n.length,a=0;a<r;a++){var o=n[a];t[o]=e[o]}}var Mp=function(){return o((function t(e){r(this,t),this.options=Object.assign({},t.defaultOptions,e)}),[{key:"valid",value:function(t){return t.startsWith("<")}},{key:"parse",value:function(t){return!!this.valid&&xp(new bp(this.options).parseXml(t),this.options)}}])}();Mp.defaultOptions={};var Tp=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};function wp(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return t.expand(e+(n/2+(i?function(t,e){return t?e:0}(i,e):0))),t}var Cp,Ep=0;function Pp(){return Ep++}!function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(Cp||(Cp={}));var Bp=new Map;["…","（","）","—","【","】","「","」","《","》"].forEach((function(t){return Bp.set(t,!0)}));var Rp=new Map;function Lp(t){if(Bp.has(t))return!0;if(Rp.has(t))return!1;var e=!1;return t.codePointAt(0)<256&&(e=!0),e}[""].forEach((function(t){return Rp.set(t,!0)}));var Ip=Pp(),Dp=Pp(),Op=Pp(),Fp=Pp(),zp=Pp(),Hp=Pp(),Np=Pp(),Vp=Pp(),jp=Pp(),Up=Pp();Pp();var Wp=Pp();Pp();var Gp=Pp();Pp();var Yp=Pp(),Xp=Pp(),Kp=Symbol.for("GraphicService"),qp=Symbol.for("GraphicCreator"),Zp={"stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-width":"lineWidth","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity",stroke:"stroke",fill:"fill"},Jp=Object.keys(Zp),Qp={duration:200,easing:"cubicOut"};function $p(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function tf(t,e,i){var n,r,a,o,s,l,u,c,h,d,p,f,v=i[0],g=i[1],y=i[2];return e===t?(t[12]=e[0]*v+e[4]*g+e[8]*y+e[12],t[13]=e[1]*v+e[5]*g+e[9]*y+e[13],t[14]=e[2]*v+e[6]*g+e[10]*y+e[14],t[15]=e[3]*v+e[7]*g+e[11]*y+e[15]):(n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],t[0]=n,t[1]=r,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=d,t[10]=p,t[11]=f,t[12]=n*v+s*g+h*y+e[12],t[13]=r*v+l*g+d*y+e[13],t[14]=a*v+u*g+p*y+e[14],t[15]=o*v+c*g+f*y+e[15]),t}function ef(t,e){t[0]=e.a,t[1]=e.b,t[2]=0,t[3]=0,t[4]=e.c,t[5]=e.d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e.e,t[13]=e.f,t[14]=0,t[15]=1}function nf(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],v=e[12],g=e[13],y=e[14],m=e[15],_=i[0],b=i[1],x=i[2],k=i[3];return t[0]=_*n+b*s+x*h+k*v,t[1]=_*r+b*l+x*d+k*g,t[2]=_*a+b*u+x*p+k*y,t[3]=_*o+b*c+x*f+k*m,_=i[4],b=i[5],x=i[6],k=i[7],t[4]=_*n+b*s+x*h+k*v,t[5]=_*r+b*l+x*d+k*g,t[6]=_*a+b*u+x*p+k*y,t[7]=_*o+b*c+x*f+k*m,_=i[8],b=i[9],x=i[10],k=i[11],t[8]=_*n+b*s+x*h+k*v,t[9]=_*r+b*l+x*d+k*g,t[10]=_*a+b*u+x*p+k*y,t[11]=_*o+b*c+x*f+k*m,_=i[12],b=i[13],x=i[14],k=i[15],t[12]=_*n+b*s+x*h+k*v,t[13]=_*r+b*l+x*d+k*g,t[14]=_*a+b*u+x*p+k*y,t[15]=_*o+b*c+x*f+k*m,t}function rf(t,e,i){var n=e[0],r=e[1],a=e[2],o=i[3]*n+i[7]*r+i[11]*a+i[15];return o=o||1,t[0]=(i[0]*n+i[4]*r+i[8]*a+i[12])/o,t[1]=(i[1]*n+i[5]*r+i[9]*a+i[13])/o,t[2]=(i[2]*n+i[6]*r+i[10]*a+i[14])/o,t}var af=function(){return o((function t(){r(this,t),this.pools=[]}),[{key:"allocate",value:function(t,e,i,n,r,a){if(!this.pools.length)return new xi(t,e,i,n,r,a);var o=this.pools.pop();return o.a=t,o.b=e,o.c=i,o.d=n,o.e=r,o.f=a,o}},{key:"allocateByObj",value:function(t){if(!this.pools.length)return new xi(t.a,t.b,t.c,t.d,t.e,t.f);var e=this.pools.pop();return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f,e}},{key:"free",value:function(t){this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}])}(),of=function(){function t(){r(this,t),this.pools=[]}return o(t,[{key:"allocate",value:function(){if(!this.pools.length)return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var e=this.pools.pop();return t.identity(e),e}},{key:"allocateByObj",value:function(t){var e;e=this.pools.length?this.pools.pop():[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];for(var i=0;i<e.length;i++)e[i]=t[i];return e}},{key:"free",value:function(t){t&&this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}],[{key:"identity",value:function(t){return $p(t)}}])}(),sf=new af,lf=new of,uf=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},cf=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},hf=new xi(1,0,0,1,0,0),df={x:0,y:0},pf=function(){return o((function t(e,i){r(this,t),this.matrix=new xi(1,0,0,1,0,0),this.stack=[],this.dpr=i,this.applyedMatrix=new xi(1,0,0,1,0,0),this.path=new Mu,this._clearMatrix=new xi(1,0,0,1,0,0)}),[{key:"nativeContext",get:function(){return this.path}},{key:"getCanvas",value:function(){throw new Error("不支持getCanvas")}},{key:"getContext",value:function(){throw new Error("不支持getContext")}},{key:"setTransformForCurrent",value:function(){!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix=this.cloneMatrix(this.matrix))}},{key:"currentMatrix",get:function(){return this.matrix}},{key:"cloneMatrix",value:function(t){return sf.allocateByObj(t)}},{key:"clear",value:function(){this.save(),this.resetTransform(),this.restore()}},{key:"reset",value:function(){this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new xi(1,0,0,1,0,0),this.stack.length=0}},{key:"restore",value:function(){this.stack.length>0&&(sf.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent())}},{key:"highPerformanceRestore",value:function(){this.stack.length>0&&(sf.free(this.matrix),this.matrix=this.stack.pop())}},{key:"rotate",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.matrix.rotate(t),e&&this.setTransformForCurrent()}},{key:"save",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t)}},{key:"highPerformanceSave",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t)}},{key:"scale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.scale(t,e),i&&this.setTransformForCurrent()}},{key:"setScale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.setScale(t,e),i&&this.setTransformForCurrent()}},{key:"scalePoint",value:function(t,e,i,n){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.translate(i,n,!1),this.scale(t,e,!1),this.translate(-i,-n,!1),r&&this.setTransformForCurrent()}},{key:"setTransform",value:function(t,e,i,n,r,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:this.dpr;this.matrix.setValue(s*t,s*e,s*i,s*n,s*r,s*a),o&&this.setTransformForCurrent()}},{key:"setTransformFromMatrix",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.dpr;this.matrix.setValue(t.a*i,t.b*i,t.c*i,t.d*i,t.e*i,t.f*i),e&&this.setTransformForCurrent()}},{key:"resetTransform",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransform(e,0,0,e,0,0),t&&this.setTransformForCurrent()}},{key:"transform",value:function(t,e,i,n,r,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];this.matrix.multiply(t,e,i,n,r,a),o&&this.setTransformForCurrent()}},{key:"transformFromMatrix",value:function(t,e){this.matrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f),e&&this.setTransformForCurrent()}},{key:"translate",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.translate(t,e),i&&this.setTransformForCurrent()}},{key:"rotateDegrees",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=t*Math.PI/180;this.rotate(i,e)}},{key:"rotateAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotate(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"rotateDegreesAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotateDegrees(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"beginPath",value:function(){this.path.clear()}},{key:"clip",value:function(t,e){}},{key:"arc",value:function(t,e,i,n,r,a){this.path.arc(t,e,i,n,r,a)}},{key:"arcTo",value:function(t,e,i,n,r){this.path.arcTo(t,e,i,n,r)}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a){this.path.bezierCurveTo(t,e,i,n,r,a)}},{key:"closePath",value:function(){this.path.closePath()}},{key:"ellipse",value:function(t,e,i,n,r,a,o,s){}},{key:"lineTo",value:function(t,e){this.path.lineTo(t,e)}},{key:"moveTo",value:function(t,e){this.path.moveTo(t,e)}},{key:"quadraticCurveTo",value:function(t,e,i,n){this.path.quadraticCurveTo(t,e,i,n)}},{key:"rect",value:function(t,e,i,n){this.path.rect(t,e,i,n)}},{key:"createImageData",value:function(t,e){return null}},{key:"createLinearGradient",value:function(t,e,i,n){throw new Error("不支持createLinearGradient")}},{key:"createPattern",value:function(t,e){throw new Error("不支持createPattern")}},{key:"createRadialGradient",value:function(t,e,i,n,r,a){throw new Error("不支持createRadialGradient")}},{key:"createConicGradient",value:function(t,e,i,n){return null}},{key:"fill",value:function(t,e){}},{key:"fillRect",value:function(t,e,i,n){this.path.rect(t,e,i,n)}},{key:"clearRect",value:function(t,e,i,n){}},{key:"fillText",value:function(t,e,i){}},{key:"getImageData",value:function(t,e,i,n){return null}},{key:"getLineDash",value:function(){return[]}},{key:"isPointInPath",value:function(t,e){return this.matrix.transformPoint({x:t,y:e},df),function(t,e,i){return Xc(t,0,!1,e,i)}(this.path.commandList,df.x,df.y)}},{key:"isPointInStroke",value:function(t,e){if(!this.lineWidth)return!1;this.matrix.transformPoint({x:t,y:e},df);var i=$u(this,this.lineWidth,this.dpr);return function(t,e,i,n){return Xc(t,e,!0,i,n)}(this.path.commandList,i,df.x,df.y)}},{key:"measureText",value:function(t){throw new Error("不支持measureText")}},{key:"putImageData",value:function(t,e,i){throw new Error("不支持measureText")}},{key:"setLineDash",value:function(t){}},{key:"stroke",value:function(t){}},{key:"strokeRect",value:function(t,e,i,n){this.path.rect(t,e,i,n)}},{key:"strokeText",value:function(t,e,i){}},{key:"drawImage",value:function(){}},{key:"setCommonStyle",value:function(t,e,i,n,r){}},{key:"_setCommonStyle",value:function(t,e,i,n){}},{key:"setStrokeStyle",value:function(t,e,i,n,r){}},{key:"_setStrokeStyle",value:function(t,e,i,n){}},{key:"setTextStyleWithoutAlignBaseline",value:function(t,e){}},{key:"setTextStyle",value:function(t,e){}},{key:"draw",value:function(){}},{key:"clearMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransformFromMatrix(hf,t,e)}},{key:"setClearMatrix",value:function(t,e,i,n,r,a){this._clearMatrix.setValue(t,e,i,n,r,a)}},{key:"onlyTranslate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dpr;return this.matrix.a===t&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===t}},{key:"release",value:function(){this.stack.forEach((function(t){return sf.free(t)})),this.stack.length=0}}])}();pf=uf([Ps(),cf("design:paramtypes",[Object,Number])],pf);var ff,vf=500,gf=500,yf=1,mf=function(){return o((function t(e){var i;r(this,t);var n=e.nativeCanvas,a=e.width,o=void 0===a?vf:a,s=e.height,l=void 0===s?gf:s,u=e.dpr,c=void 0===u?yf:u,h=e.x,d=e.y,p=e.id,f=e.canvasControled,v=void 0===f||f;this._x=null!=h?h:0,this._y=null!=d?d:0,this._pixelWidth=o*c,this._pixelHeight=l*c,this._visiable=!1!==e.visiable,this.controled=v,this._displayWidth=o,this._displayHeight=l,this._dpr=c,this._nativeCanvas=n,this._id=null!==(i=n.id)&&void 0!==i?i:p,p&&(n.id=p),this.init(e)}),[{key:"displayWidth",get:function(){return this._pixelWidth/this._dpr}},{key:"displayHeight",get:function(){return this._pixelHeight/this._dpr}},{key:"id",get:function(){return this._id}},{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}},{key:"nativeCanvas",get:function(){return this._nativeCanvas},set:function(t){this._nativeCanvas=t}},{key:"width",get:function(){return this._pixelWidth},set:function(t){this._pixelWidth=t,this._displayWidth=t/(this._dpr||1)}},{key:"height",get:function(){return this._pixelHeight},set:function(t){this._pixelHeight=t,this._displayHeight=t/(this._dpr||1)}},{key:"getContext",value:function(t){return this._context}},{key:"visiable",get:function(){return this._visiable},set:function(t){this._visiable=t,t?this.show():this.hide()}},{key:"dpr",get:function(){return this._dpr},set:function(t){this._dpr=t,this.resize(this._displayWidth,this._displayHeight)}},{key:"getNativeCanvas",value:function(){return this._nativeCanvas}},{key:"hide",value:function(){}},{key:"show",value:function(){}},{key:"applyPosition",value:function(){}},{key:"resetStyle",value:function(t){}},{key:"resize",value:function(t,e){}},{key:"toDataURL",value:function(t,e){return""}},{key:"readPixels",value:function(t,e,i,n){return this._context.getImageData(t,e,i,n)}},{key:"convertToBlob",value:function(t){throw new Error("暂未实现")}},{key:"transferToImageBitmap",value:function(){throw new Error("暂未实现")}},{key:"release",value:function(){this.controled&&this._nativeCanvas.parentElement&&this._nativeCanvas.parentElement.removeChild(this._nativeCanvas)}}])}();mf.env="browser",function(t){t[t.Color255=0]="Color255",t[t.Color1=1]="Color1"}(ff||(ff={}));var _f=function(){function t(){r(this,t)}return o(t,null,[{key:"Get",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ff.Color1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0,1];if(i===ff.Color1){var r=t.store1[e];if(r)return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n;var a=Li.parseColorString(e);if(a){var o=[a.r/255,a.g/255,a.b/255,a.opacity];t.store1[e]=o,t.store255[e]=[a.r,a.g,a.b,a.opacity],n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=o[3]}return n}var s=t.store255[e];if(s)return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n;var l=Li.parseColorString(e);return l&&(t.store1[e]=[l.r/255,l.g/255,l.b/255,l.opacity],t.store255[e]=[l.r,l.g,l.b,l.opacity],n[0]=l.r,n[1]=l.g,n[2]=l.b,n[3]=l.opacity),n}},{key:"Set",value:function(e,i,n){if(i===ff.Color1){if(t.store1[e])return;t.store1[e]=n,t.store255[e]=[Math.floor(255*n[0]),Math.floor(255*n[1]),Math.floor(255*n[2]),Math.floor(255*n[3])]}else{if(t.store255[e])return;t.store255[e]=n,t.store1[e]=[n[0]/255,n[1]/255,n[2]/255,n[3]]}}}])}();function bf(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Array.isArray(t)&&Q(t[0])?e?"rgb(".concat(Math.round(t[0]),",").concat(Math.round(t[1]),",").concat(Math.round(t[2]),",").concat(t[3].toFixed(2),")"):"rgb(".concat(Math.round(t[0]),",").concat(Math.round(t[1]),",").concat(Math.round(t[2]),")"):t}function xf(t,e,i,n,r){return Array.isArray(t)&&!Q(t[0])||Array.isArray(e)&&!Q(e[0])?new Array(4).fill(0).map((function(r,a){var o,s;return kf(q(t)?null!==(o=t[a])&&void 0!==o?o:t[0]:t,q(e)?null!==(s=e[a])&&void 0!==s?s:e[0]:e,i,n)})):kf(t,e,i,n,r)}function kf(t,e,i,n,r){if(!t||!e)return t&&bf(t)||e&&bf(e)||!1;var a,o,s=!1,l=!1;if(Array.isArray(t)?a=t:"string"==typeof t?a=_f.Get(t,ff.Color255):s=!0,Array.isArray(e)?o=e:"string"==typeof e?o=_f.Get(e,ff.Color255):l=!0,s!==l){var u=s?t:e,c=s?e:t,h=Object.assign(Object.assign({},u),{stops:u.stops.map((function(t){return Object.assign(Object.assign({},t),{color:bf(c)})}))});return s?xf(u,h,i,n,r):xf(h,u,i,n,r)}if(s){if(t.gradient===e.gradient){var d=t,p=e,f=d.stops,v=p.stops;if(f.length!==v.length)return!1;if("linear"===d.gradient)return function(t,e,i){var n=t.stops,r=e.stops;return{gradient:"linear",x0:t.x0+(e.x0-t.x0)*i,x1:t.x1+(e.x1-t.x1)*i,y0:t.y0+(e.y0-t.y0)*i,y1:t.y1+(e.y1-t.y1)*i,stops:new Array(n.length).fill(0).map((function(t,e){return{color:Tf(n[e].color,r[e].color,i),offset:n[e].offset+(r[e].offset-n[e].offset)*i}}))}}(d,p,i);if("radial"===d.gradient)return function(t,e,i){var n=t.stops,r=e.stops;return{gradient:"radial",x0:t.x0+(e.x0-t.x0)*i,x1:t.x1+(e.x1-t.x1)*i,y0:t.y0+(e.y0-t.y0)*i,y1:t.y1+(e.y1-t.y1)*i,r0:t.r0+(e.r0-t.r0)*i,r1:t.r1+(e.r1-t.r1)*i,stops:new Array(n.length).fill(0).map((function(t,e){return{color:Tf(n[e].color,r[e].color,i),offset:n[e].offset+(r[e].offset-n[e].offset)*i}}))}}(d,p,i);if("conical"===d.gradient)return function(t,e,i){var n=t.stops,r=e.stops;return{gradient:"conical",startAngle:t.startAngle+(e.startAngle-t.startAngle)*i,endAngle:t.endAngle+(e.endAngle-t.endAngle)*i,x:t.x+(e.x-t.x)*i,y:t.y+(e.y-t.y)*i,stops:new Array(n.length).fill(0).map((function(t,e){return{color:Tf(n[e].color,r[e].color,i),offset:n[e].offset+(r[e].offset-n[e].offset)*i}}))}}(d,p,i)}return!1}return r&&r(a,o),bf(function(t,e,i){return[t[0]+(e[0]-t[0])*i,t[1]+(e[1]-t[1])*i,t[2]+(e[2]-t[2])*i,t[3]+(e[3]-t[3])*i]}(a,o,i),n)}function Sf(t,e,i){return"rgba(".concat(t[0]+(e[0]-t[0])*i,",").concat(t[1]+(e[1]-t[1])*i,",").concat(t[2]+(e[2]-t[2])*i,",").concat(t[3]+(e[3]-t[3])*i,")")}_f.store255={},_f.store1={};var Af=[0,0,0,0],Mf=[0,0,0,0];function Tf(t,e,i){return _f.Get(t,ff.Color255,Af),_f.Get(e,ff.Color255,Mf),"rgba(".concat(Math.round(Af[0]+(Mf[0]-Af[0])*i),",").concat(Math.round(Af[1]+(Mf[1]-Af[1])*i),",").concat(Math.round(Af[2]+(Mf[2]-Af[2])*i),",").concat(Af[3]+(Mf[3]-Af[3])*i,")")}var wf=function(){function t(){r(this,t)}return o(t,null,[{key:"GetCanvas",value:function(){try{return t.canvas||(t.canvas=al.global.createCanvas({})),t.canvas}catch(t){return null}}},{key:"GetCtx",value:function(){if(!t.ctx){var e=t.GetCanvas();t.ctx=e.getContext("2d")}return t.ctx}}])}(),Cf=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;r(this,e),(t=n(this,e)).cacheParams={CLEAN_THRESHOLD:100,L_TIME:1e3},t.dataMap=new Map;var o=wf.GetCanvas(),s=wf.GetCtx();if(o.width=a,o.height=1,!s)return p(t);if(s.translate(0,0),!s)throw new Error("获取ctx发生错误");var l=s.createLinearGradient(0,0,a,0);return i.forEach((function(t){l.addColorStop(t[0],t[1])})),s.fillStyle=l,s.fillRect(0,0,a,1),t.rgbaSet=s.getImageData(0,0,a,1).data,t}return h(e,t),o(e,[{key:"getColor",value:function(t){var e=this.rgbaSet.slice(4*t,4*t+4);return"rgba(".concat(e[0],", ").concat(e[1],", ").concat(e[2],", ").concat(e[3]/255,")")}},{key:"GetOrCreate",value:function(t,i,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100,s="".concat(t).concat(i).concat(n).concat(r);a.forEach((function(t){return s+=t.join()})),s+=o;var l=this.dataMap.get(s);return l||(l={data:new e(a,o),timestamp:[]},this.addLimitedTimestamp(l,Date.now(),{}),this.dataMap.set(s,l)),this.clearCache(this.dataMap,this.cacheParams),l.data}}],[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}])}(ki),Ef=function(){function t(){r(this,t)}return o(t,null,[{key:"GetSize",value:function(e){for(var i=0;i<t.ImageSize.length;i++)if(t.ImageSize[i]>=e)return t.ImageSize[i];return e}},{key:"Get",value:function(e,i,n,r,a,o,s){var l=t.GenKey(e,i,n,r,a),u=t.cache[l];if(!u||0===u.length)return null;for(var c=0;c<u.length;c++)if(u[c].width>=o&&u[c].height>=s)return u[c].pattern;return null}},{key:"Set",value:function(e,i,n,r,a,o,s,l){var u=t.GenKey(e,i,n,r,a);t.cache[u]?t.cache[u].push({width:s,height:l,pattern:o}):t.cache[u]=[{width:s,height:l,pattern:o}]}},{key:"GenKey",value:function(t,e,i,n,r){return"".concat(e,",").concat(i,",").concat(n,",").concat(r,",").concat(t.join())}}])}();Ef.cache={},Ef.ImageSize=[20,40,80,160,320,640,1280,2560];var Pf=new _i,Bf=new xi;new _i;var Rf,Lf=["lineWidth","scaleX","scaleY","angle","anchor","visible"],If=["x","y"],Df=["scaleX","scaleY"],Of=["angle"],Ff=new De,zf={strokeSeg:1,boundsPadding:2,pickMode:1,boundsMode:1,customPickShape:1,pickable:1,childrenPickable:1,visible:1,zIndex:1,layout:1,keepDirIn3d:1,globalZIndex:1,outerBorder:1,innerBorder:1,lineDash:1,lineCap:1,lineJoin:1,miterLimit:2,strokeBoundsBuffer:2,scaleCenter:1,anchor:1,anchor3d:1,postMatrix:1,backgroundMode:2,background:1,texture:1,cursor:1,html:1},Hf=function(t){function e(){var t,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(this,e),(t=n(this,e))._AABBBounds=new _i,t._updateTag=bl.INIT,t.attribute=a,t.valid=t.isValid(),t.updateAABBBoundsStamp=0,a.background?t.loadImage(null!==(i=a.background.background)&&void 0!==i?i:a.background,!0):a.shadowGraphic&&t.setShadowGraphic(a.shadowGraphic),t}return h(e,t),o(e,[{key:"AABBBounds",get:function(){return this.tryUpdateAABBBounds()}},{key:"OBBBounds",get:function(){return this.tryUpdateOBBBounds()}},{key:"globalAABBBounds",get:function(){return this.tryUpdateGlobalAABBBounds()}},{key:"transMatrix",get:function(){return this.tryUpdateLocalTransMatrix(!0)}},{key:"globalTransMatrix",get:function(){return this.tryUpdateGlobalTransMatrix(!0)}},{key:"getGraphicService",value:function(){var t,e;return null!==(e=null===(t=this.stage)||void 0===t?void 0:t.graphicService)&&void 0!==e?e:al.graphicService}},{key:"getAttributes",value:function(){return this.attribute}},{key:"setMode",value:function(t){"3d"===t?this.set3dMode():this.set2dMode()}},{key:"set3dMode",value:function(){this.in3dMode=!0}},{key:"set2dMode",value:function(){this.in3dMode=!1}},{key:"getOffsetXY",value:function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.attribute,a=r.dx,o=void 0===a?t.dx:a,s=r.dy,l=void 0===s?t.dy:s;if(n&&this.parent){var u=this.parent.attribute;Ff.x=o+(null!==(e=u.scrollX)&&void 0!==e?e:0),Ff.y=l+(null!==(i=u.scrollY)&&void 0!==i?i:0)}else Ff.x=o,Ff.y=l;return Ff}},{key:"onAnimateBind",value:function(t){this._emitCustomEvent("animate-bind",t)}},{key:"tryUpdateAABBBounds",value:function(){var t="imprecise"===this.attribute.boundsMode;if(!this.shouldUpdateAABBBounds())return this._AABBBounds;if(!this.valid)return this._AABBBounds.clear(),this._AABBBounds;this.getGraphicService().beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);var e=this.doUpdateAABBBounds(t);return this.getGraphicService().afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,!0),"empty"===this.attribute.boundsMode&&e.clear(),e}},{key:"tryUpdateOBBBounds",value:function(){return this._OBBBounds||(this._OBBBounds=new bi),this.tryUpdateAABBBounds(),this.updateOBBBoundsStamp===this.updateAABBBoundsStamp?this._OBBBounds:(this.updateOBBBoundsStamp=this.updateAABBBoundsStamp,this.valid?this.doUpdateOBBBounds():(this._OBBBounds.clear(),this._OBBBounds))}},{key:"combindShadowAABBBounds",value:function(t){if(this.shadowRoot){var e=this.shadowRoot.AABBBounds.clone();t.union(e)}}},{key:"doUpdateOBBBounds",value:function(){return this._OBBBounds}},{key:"getClipPath",value:function(){var t=this.attribute.clipConfig;if(!t)return null;this.clipPathMap||(this.clipPathMap=new Map);var e=t.shape,i=this.clipPathMap.get(e)||null;return i||(this.clipPathMap.size>10&&this.clipPathMap.clear(),(i=this.parsePath(e))&&this.clipPathMap.set(e,i)),i}},{key:"parsePath",value:function(t){if(!t)return null;var i,n=fp[t];if(n)return n;if(n=e.userSymbolMap[t])return n;if(!0===((i=t=vp[t]||t).startsWith("<svg")||i.startsWith("<?xml"))){var r=(new Mp).parse(t).svg;if(!r)return null;var a=q(r.path)?r.path:[r.path];Pf.clear();var o=[];a.forEach((function(t){var e=(new Mu).fromString(t.d),i={};Jp.forEach((function(e){t[e]&&(i[Zp[e]]=t[e])})),o.push({path:e,attribute:i}),Pf.union(e.bounds)}));var s=Pf.width(),l=Pf.height(),u=1/ke(s,l);o.forEach((function(t){return t.path.transform(0,0,u,u)}));var c=new pp(t,o,!0);return e.userSymbolMap[t]=c,c}var h=(new Mu).fromString(t),d=h.bounds.width(),p=h.bounds.height(),f=1/ke(d,p);h.transform(0,0,f,f);var v=new pp(t,h);return e.userSymbolMap[t]=v,v}},{key:"doUpdateAABBBounds",value:function(t){this.updateAABBBoundsStamp++;var e=this.getGraphicTheme();this._AABBBounds.clear();var i=this.attribute,n=this.updateAABBBounds(i,e,this._AABBBounds,t),r=i.boundsPadding,a=void 0===r?e.boundsPadding:r,o=Lh(a);return o&&n.expand(o),this.clearUpdateBoundTag(),n}},{key:"updatePathProxyAABBBounds",value:function(t){var e="function"==typeof this.pathProxy?this.pathProxy(this.attribute):this.pathProxy;if(!e)return!1;var i=new wl(t);return Dl(e.commandList,i,0,0),!0}},{key:"tryUpdateGlobalAABBBounds",value:function(){var t=this.AABBBounds;return this._globalAABBBounds?this._globalAABBBounds.setValue(t.x1,t.y1,t.x2,t.y2):this._globalAABBBounds=t.clone(),this._globalAABBBounds.empty()||this.parent&&this._globalAABBBounds.transformWithMatrix(this.parent.globalTransMatrix),this._globalAABBBounds}},{key:"tryUpdateGlobalTransMatrix",value:function(){if(this._globalTransMatrix){if(this.parent){var t=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();return this.shouldUpdateGlobalMatrix()&&this.doUpdateGlobalMatrix(),this._globalTransMatrix}},{key:"shouldUpdateGlobalMatrix",value:function(){return!0}},{key:"tryUpdateLocalTransMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._transMatrix||(this._transMatrix=new xi),this.shouldUpdateLocalMatrix()&&(this.doUpdateLocalMatrix(),t&&this.clearUpdateLocalPositionTag()),this._transMatrix}},{key:"shouldUpdateAABBBounds",value:function(){return this.shadowRoot?(!!(this._updateTag&bl.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds())&&this.getGraphicService().validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this):!!(this._updateTag&bl.UPDATE_BOUNDS)&&this.getGraphicService().validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this)}},{key:"shouldSelfChangeUpdateAABBBounds",value:function(){return this.shadowRoot?!!(this._updateTag&bl.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds():!!(this._updateTag&bl.UPDATE_BOUNDS)}},{key:"shouldUpdateLocalMatrix",value:function(){return!!(this._updateTag&bl.UPDATE_LOCAL_MATRIX)}},{key:"isValid",value:function(){var t,e,i=this.attribute;return Number.isFinite((null!==(t=i.x)&&void 0!==t?t:0)+(null!==(e=i.y)&&void 0!==e?e:0))}},{key:"_validNumber",value:function(t){return null==t||Number.isFinite(t)}},{key:"shouldUpdateShape",value:function(){return!!(this._updateTag&bl.UPDATE_SHAPE)}},{key:"clearUpdateShapeTag",value:function(){this._updateTag&=bl.CLEAR_SHAPE}},{key:"containsPoint",value:function(t,e,i,n){if(!n)return!1;if(i===xl.GLOBAL){var r=new De(t,e);this.parent&&this.parent.globalTransMatrix.transformPoint(r,r),t=r.x,e=r.y}return n.containsPoint(this,{x:t,y:e})}},{key:"setWidthHeightWithoutTransform",value:function(t){this.widthWithoutTransform=t.x2-t.x1,this.heightWithoutTransform=t.y2-t.y1}},{key:"setAttributesAndPreventAnimate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.setAttributes(t,e,i),this.animates&&this.animates.forEach((function(e){(e.priority!==1/0||n)&&Object.keys(t).forEach((function(t){e.preventAttr(t)}))}))}},{key:"setAttributes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;t&&((t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t).background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._setAttributes(t,e,i))}},{key:"_setAttributes",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,n=Object.keys(t),r=0;r<n.length;r++){var a=n[r];this.attribute[a]=t[a]}this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!e&&!this.needUpdateTags(n)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)}},{key:"setAttribute",value:function(t,e,i,n){var r,a=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(l({},t,e),this.attribute,t,n);a?this._setAttributes(a,i,n):j(null===(r=this.normalAttrs)||void 0===r?void 0:r[t])?(this.attribute[t]=e,this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTag(t)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n)):this.normalAttrs[t]=e,"background"===t?this.loadImage(e,!0):"shadowGraphic"===t&&this.setShadowGraphic(e)}},{key:"needUpdateTags",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lf,i=0;i<e.length;i++){var n=e[i];if(-1!==t.indexOf(n))return!0}return!1}},{key:"needUpdateTag",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lf,i=0;i<e.length;i++)if(t===e[i])return!0;return!1}},{key:"initAttributes",value:function(t){var e={type:kl.INIT};t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,e)||t,this.attribute=t,t.background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._updateTag=bl.INIT,this.valid=this.isValid(),this.onAttributeUpdate(e)}},{key:"translate",value:function(t,e){var i,n;if(0===t&&0===e)return this;var r={type:kl.TRANSLATE},a=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,If,r);a&&(t=a.x,e=a.y,delete a.x,delete a.y,this._setAttributes(a));var o=this.attribute,s=o.postMatrix;return s?al.transformUtil.fromMatrix(s,s).translate(t,e):(o.x=(null!==(i=o.x)&&void 0!==i?i:Cu.x)+t,o.y=(null!==(n=o.y)&&void 0!==n?n:Cu.y)+e),this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r),this}},{key:"translateTo",value:function(t,e){var i=this.attribute;if(i.x===t&&i.y===e)return this;var n={type:kl.TRANSLATE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,If,n);return r?(this._setAttributes(r,!1,n),this):(i.x=t,i.y=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this)}},{key:"scale",value:function(t,e,i){var n,r;if(1===t&&1===e)return this;var a={type:kl.SCALE},o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e,scaleCenter:i},this.attribute,Df,a);o&&(t=o.scaleX,e=o.scaleY,delete o.scaleX,delete o.scaleY,this._setAttributes(o));var s=this.attribute;if(i){var l=this.attribute.postMatrix;l||(l=new xi,s.postMatrix=l),al.transformUtil.fromMatrix(l,l).scale(t,e,i)}else s.scaleX=(null!==(n=s.scaleX)&&void 0!==n?n:Cu.scaleX)*t,s.scaleY=(null!==(r=s.scaleY)&&void 0!==r?r:Cu.scaleY)*e;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(a),this}},{key:"scaleTo",value:function(t,e){var i=this.attribute;if(i.scaleX===t&&i.scaleY===e)return this;var n={type:kl.SCALE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e},this.attribute,Df,n);return r?(this._setAttributes(r,!1,n),this):(i.scaleX=t,i.scaleY=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this)}},{key:"rotate",value:function(t,e){var i;if(0===t)return this;var n={type:kl.ROTATE},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({angle:t,rotateCenter:e},this.attribute,Of,n);r&&(delete r.angle,this._setAttributes(r,!1,n));var a=this.attribute;if(e){var o=this.attribute.postMatrix;o||(o=new xi,a.postMatrix=o),al.transformUtil.fromMatrix(o,o).rotate(t,e)}else a.angle=(null!==(i=a.angle)&&void 0!==i?i:Cu.angle)+t;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this}},{key:"rotateTo",value:function(t){var e=this.attribute;if(e.angle===t)return this;var i={type:kl.ROTATE_TO},n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,Of,i);return n?(this._setAttributes(n,!1,i),this):(e.angle=t,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i),this)}},{key:"skewTo",value:function(t,e){return this}},{key:"onAttributeUpdate",value:function(t){t&&t.skipUpdateCallback||(this.getGraphicService().onAttributeUpdate(this),this._emitCustomEvent("afterAttributeUpdate",t))}},{key:"update",value:function(t){t?(t.bounds&&this.tryUpdateAABBBounds(),t.trans&&this.tryUpdateLocalTransMatrix()):(this.tryUpdateAABBBounds(),this.tryUpdateLocalTransMatrix())}},{key:"hasState",value:function(t){return!(!this.currentStates||!this.currentStates.length)&&(!!j(t)||this.currentStates.includes(t))}},{key:"getState",value:function(t){var e;return null===(e=this.states)||void 0===e?void 0:e[t]}},{key:"applyStateAttrs",value:function(t,e,i,n){var r,a,o=this;if(i){var s,l=Object.keys(t),u=this.getNoWorkAnimateAttr(),c={};l.forEach((function(e){u[e]?(s||(s={}),s[e]=t[e]):c[e]=n&&void 0===t[e]?o.getDefaultAttribute(e):t[e]}));var h=null!==(a=null!==(r=this.context&&this.context.stateAnimateConfig)&&void 0!==r?r:this.stateAnimateConfig)&&void 0!==a?a:Qp;this.applyAnimationState(["state"],[{name:"state",animation:{type:"state",to:c,duration:h.duration,easing:h.easing}}]),s&&this.setAttributesAndPreventAnimate(s,!1,{type:kl.STATE})}else this.stopStateAnimates(),this.setAttributesAndPreventAnimate(t,!1,{type:kl.STATE}),this.finalAttribute&&Object.assign(this.finalAttribute,t);this._emitCustomEvent("afterStateUpdate",{type:kl.STATE})}},{key:"updateNormalAttrs",value:function(t){var e=this,i={};this.normalAttrs?(Object.keys(t).forEach((function(t){t in e.normalAttrs?(i[t]=e.normalAttrs[t],delete e.normalAttrs[t]):i[t]=e.getNormalAttribute(t)})),Object.keys(this.normalAttrs).forEach((function(i){t[i]=e.normalAttrs[i]}))):Object.keys(t).forEach((function(t){i[t]=e.getNormalAttribute(t)})),this.normalAttrs=i}},{key:"stopStateAnimates",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"end";this.animates&&this.animates.forEach((function(i){i.stateNames&&(i.stop(e),t.animates.delete(i.id))}))}},{key:"getNormalAttribute",value:function(t){var e,i,n=this.attribute[t];return this.animates?null===(e=this.finalAttribute)||void 0===e?void 0:e[t]:null!=n?n:null===(i=this.finalAttribute)||void 0===i?void 0:i[t]}},{key:"clearStates",value:function(t){this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}},{key:"removeState",value:function(t,e){if(this.currentStates){var i=q(t)?function(e){return!t.includes(e)}:function(e){return e!==t},n=this.currentStates.filter(i);n.length!==this.currentStates.length&&this.useStates(n,e)}}},{key:"toggleState",value:function(t,e){if(this.hasState(t))this.removeState(t,e);else if((this.currentStates?this.currentStates.indexOf(t):-1)<0){var i=this.currentStates?this.currentStates.slice():[];i.push(t),this.useStates(i,e)}}},{key:"addState",value:function(t,e,i){var n;if(!this.currentStates||!this.currentStates.includes(t)||!e&&1!==this.currentStates.length){var r=e&&(null===(n=this.currentStates)||void 0===n?void 0:n.length)?this.currentStates.concat([t]):[t];this.useStates(r,i)}}},{key:"useStates",value:function(t,e){var i,n=this;if(t.length){if((null===(i=this.currentStates)||void 0===i?void 0:i.length)!==t.length||t.some((function(t,e){return n.currentStates[e]!==t}))){var r={};t.forEach((function(e){var i,a=n.stateProxy?n.stateProxy(e,t):null===(i=n.states)||void 0===i?void 0:i[e];a&&Object.assign(r,a)})),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}}else this.clearStates(e)}},{key:"addUpdateBoundTag",value:function(){this._updateTag|=bl.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}},{key:"addUpdateShapeTag",value:function(){this._updateTag|=bl.UPDATE_SHAPE}},{key:"addUpdateShapeAndBoundsTag",value:function(){this._updateTag|=bl.UPDATE_SHAPE_AND_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}},{key:"updateShapeAndBoundsTagSetted",value:function(){return(this._updateTag&bl.UPDATE_SHAPE_AND_BOUNDS)===bl.UPDATE_SHAPE_AND_BOUNDS}},{key:"clearUpdateBoundTag",value:function(){this._updateTag&=bl.CLEAR_BOUNDS}},{key:"addUpdatePositionTag",value:function(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=bl.UPDATE_GLOBAL_LOCAL_MATRIX}},{key:"addUpdateGlobalPositionTag",value:function(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=bl.UPDATE_GLOBAL_MATRIX}},{key:"clearUpdateLocalPositionTag",value:function(){this._updateTag&=bl.CLEAR_LOCAL_MATRIX}},{key:"clearUpdateGlobalPositionTag",value:function(){this._updateTag&=bl.CLEAR_GLOBAL_MATRIX}},{key:"addUpdateLayoutTag",value:function(){this._updateTag|=bl.UPDATE_LAYOUT}},{key:"clearUpdateLayoutTag",value:function(){this._updateTag&=bl.CLEAR_LAYOUT}},{key:"needUpdateLayout",value:function(){return!!(this._updateTag&bl.UPDATE_LAYOUT)}},{key:"getAnchor",value:function(t,e,i){var n=this,r=[0,0],a=function(){if(e.b)return e.b;var t=n.clone();return t.attribute.angle=0,t.attribute.scaleCenter=null,i&&(t.attribute.scaleX=1,t.attribute.scaleY=1),e.b=t.AABBBounds,e.b};if("string"==typeof t[0]){var o=parseFloat(t[0])/100,s=a();r[0]=s.x1+(s.x2-s.x1)*o}else r[0]=t[0];if("string"==typeof t[1]){var l=parseFloat(t[1])/100,u=a();r[1]=u.y1+(u.y2-u.y1)*l}else r[1]=t[1];return r}},{key:"doUpdateLocalMatrix",value:function(){var t=this.attribute,e=t.x,i=void 0===e?Cu.x:e,n=t.y,r=void 0===n?Cu.y:n,a=t.scaleX,o=void 0===a?Cu.scaleX:a,s=t.scaleY,l=void 0===s?Cu.scaleY:s,u=t.angle,c=void 0===u?Cu.angle:u,h=t.scaleCenter,d=t.anchor,p=t.postMatrix,f=[0,0],v={};if(d&&c&&(f=this.getAnchor(d,v)),!h||1===o&&1===l)!function(t,e,i,n,r,a,o,s){var l,u,c=e.a,h=e.b,d=e.c,p=e.d,f=e.e,v=e.f,g=xe(o),y=Ae(o);s?(l=s[0],u=s[1]):(l=i,u=n);var m=l-i,_=u-n,b=c*g+d*y,x=h*g+p*y,k=d*g-c*y,S=p*g-h*y;t.a=r*b,t.b=r*x,t.c=a*k,t.d=a*S,t.e=f+c*l+d*u-b*m-k*_,t.f=v+h*l+p*u-x*m-S*_}(this._transMatrix,this._transMatrix.reset(),i,r,o,l,c,d&&f);else{var g=this._transMatrix;g.reset(),g.translate(f[0],f[1]),g.rotate(c),g.translate(-f[0],-f[1]),g.translate(i,r),f=this.getAnchor(h,v,!0),al.transformUtil.fromMatrix(g,g).scale(o,l,{x:f[0],y:f[1]})}var y=this.getOffsetXY(Cu);if(this._transMatrix.e+=y.x,this._transMatrix.f+=y.y,p){var m=Bf.setValue(p.a,p.b,p.c,p.d,p.e,p.f),_=this._transMatrix;m.multiply(_.a,_.b,_.c,_.d,_.e,_.f),_.setValue(m.a,m.b,m.c,m.d,m.e,m.f)}}},{key:"doUpdateGlobalMatrix",value:function(){if(this.parent){this._globalTransMatrix.multiply(this.transMatrix.a,this.transMatrix.b,this.transMatrix.c,this.transMatrix.d,this.transMatrix.e,this.transMatrix.f);var t=this.parent.attribute,e=t.scrollX,i=void 0===e?0:e,n=t.scrollY,r=void 0===n?0:n;this._globalTransMatrix.translate(i,r)}}},{key:"setStage",value:function(t,e){if(this.stage!==t){if(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this.animates&&this.animates.size){var i=t.getTimeline();this.animates.forEach((function(t){t.timeline.isGlobal&&(t.setTimeline(i),i.addAnimate(t))}))}this._onSetStage&&this._onSetStage(this,t,e),this.getGraphicService().onSetStage(this,t)}}},{key:"setStageToShadowRoot",value:function(t,e){this.shadowRoot&&this.shadowRoot.setStage(t,e)}},{key:"onAddStep",value:function(t){}},{key:"onStop",value:function(t){t&&this.setAttributes(t,!1,{type:kl.ANIMATE_END})}},{key:"getDefaultAttribute",value:function(t){return this.getGraphicTheme()[t]}},{key:"getComputedAttribute",value:function(t){var e;return null!==(e=this.attribute[t])&&void 0!==e?e:this.getDefaultAttribute(t)}},{key:"onSetStage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._onSetStage=t,e&&this.stage&&t(this,this.stage)}},{key:"attachShadow",value:function(t){return t&&(t.shadowHost=this),this.shadowRoot=null!=t?t:al.graphicService.creator.shadowRoot(this),this.addUpdateBoundTag(),this.shadowRoot.setStage(this.stage,this.layer),this.shadowRoot}},{key:"detachShadow",value:function(){this.shadowRoot&&(this.addUpdateBoundTag(),this.shadowRoot.release(!0),this.shadowRoot=null)}},{key:"toJson",value:function(){return{attribute:this.attribute,_uid:this._uid,type:this.type,name:this.name,children:this.children.map((function(t){return t.toJson()}))}}},{key:"createPathProxy",value:function(t){return K(t,!0)?this.pathProxy=(new Mu).fromString(t):this.pathProxy=new Mu,this.pathProxy}},{key:"loadImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(!t||e&&function(t){return!(!t.fill&&!t.stroke)}(t))){var i=t;this.resources||(this.resources=new Map);var n={data:"init",state:null};this.resources.set(i,n),"string"==typeof t?(n.state="loading",t.startsWith("<svg")?(Eh.GetSvg(t,this),this.backgroundImg=this.backgroundImg||e):(it(t)||t.includes("/")||nt(t))&&(Eh.GetImage(t,this),this.backgroundImg=this.backgroundImg||e)):W(t)?(n.state="success",n.data=t,this.backgroundImg=this.backgroundImg||e):n.state="fail"}}},{key:"setShadowGraphic",value:function(t){t?this.attachShadow().add(t):this.detachShadow()}},{key:"imageLoadSuccess",value:function(t,e,i){if(this.resources){var n=this.resources.get(t);n&&(n.state="success",n.data=e,i&&i(),this.addUpdateBoundTag(),this.stage&&this.stage.renderNextFrame())}}},{key:"imageLoadFail",value:function(t,e){if(this.resources){var i=this.resources.get(t);i&&(i.state="fail",e&&e())}}},{key:"_stopAnimates",value:function(t){t&&t.forEach((function(t){t.stop()}))}},{key:"stopAnimates",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._stopAnimates(this.animates),this.shadowRoot&&this.shadowRoot.stopAnimates(!0),this.isContainer&&t&&this.forEachChildren((function(e){e.stopAnimates(t)}))}},{key:"release",value:function(){this.releaseStatus="released",this.stopAnimates(),al.graphicService.onRelease(this)}},{key:"_emitCustomEvent",value:function(t,e){var i,n;if(this._events&&t in this._events){var r=new xh(t,e);r.bubbles=!1,r.manager=null===(n=null===(i=this.stage)||void 0===i?void 0:i.eventSystem)||void 0===n?void 0:n.manager,this.dispatchEvent(r)}}},{key:"toCustomPath",value:function(){var t,e,i,n=null===(i=null===(e=(null===(t=this.stage)||void 0===t?void 0:t.renderService)||al.renderService)||void 0===e?void 0:e.drawContribution)||void 0===i?void 0:i.getRenderContribution(this);if(n){var r=new pf(null,1);return n.drawShape(this,r,0,0,{},{}),r.path}return null}}],[{key:"mixin",value:function(t){for(var i=Object.keys(t),n=0;n<i.length;++n){var r=i[n];Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}}])}(gh);Hf.userSymbolMap={},Hf.mixin(Th),function(t){t[t.LESS_GROUP=0]="LESS_GROUP",t[t.MORE_GROUP=1]="MORE_GROUP"}(Rf||(Rf={}));var Nf=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="group",i.parent=null,i.isContainer=!0,i.numberType=Hp,i._childUpdateTag=bl.UPDATE_BOUNDS,i}return h(e,t),o(e,[{key:"setMode",value:function(t){"3d"===t?this.set3dMode():this.set2dMode()}},{key:"set3dMode",value:function(){this.in3dMode=!0}},{key:"set2dMode",value:function(){this.in3dMode=!1}},{key:"setTheme",value:function(t){return this.theme||(this.theme=new dh),this.theme.setTheme(t,this)}},{key:"createTheme",value:function(){this.theme||(this.theme=new dh)}},{key:"visibleAll",value:function(t){this.setAttribute("visible",t),this.forEachChildren((function(e){e.isContainer&&e.visibleAll?e.visibleAll(t):e.setAttribute("visible",t)}))}},{key:"hideAll",value:function(){this.visibleAll(!1)}},{key:"showAll",value:function(){this.visibleAll(!0)}},{key:"containsPoint",value:function(t,e,i){if(i===xl.GLOBAL){var n=new De(t,e);return this.parent&&this.parent.globalTransMatrix.transformPoint(n,n),this.AABBBounds.contains(n.x,n.y)}return this.AABBBounds.contains(t,e)}},{key:"shouldUpdateAABBBounds",value:function(){return!!_(e,"shouldUpdateAABBBounds",this,3)([])||!!(this._childUpdateTag&bl.UPDATE_BOUNDS)}},{key:"tryUpdateAABBBounds",value:function(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.getGraphicService().beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);var t=this.shouldSelfChangeUpdateAABBBounds(),e=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),this.getGraphicService().afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,t),"empty"===this.attribute.boundsMode&&e.clear(),e}},{key:"doUpdateLocalMatrix",value:function(){var t=this.attribute,i=t.x,n=void 0===i?Cu.x:i,r=t.y,a=void 0===r?Cu.y:r,o=t.dx,s=void 0===o?Cu.dx:o,l=t.dy,u=void 0===l?Cu.dy:l,c=t.scaleX,h=void 0===c?Cu.scaleX:c,d=t.scaleY,p=void 0===d?Cu.scaleY:d,f=t.angle,v=void 0===f?Cu.angle:f,g=t.postMatrix;if(0!==n||0!==a||0!==s||0!==u||1!==h||1!==p||0!==v||g)return _(e,"doUpdateLocalMatrix",this,3)([]);this._transMatrix.reset()}},{key:"getGraphicTheme",value:function(){return fh(this).group}},{key:"updateAABBBounds",value:function(t,e,i){var n=i;i=i.clone();var r=t.width,a=t.height,o=t.path,s=t.clip,l=void 0===s?e.clip:s;if(o&&o.length?o.forEach((function(t){i.union(t.AABBBounds)})):null!=r&&null!=a&&i.set(0,0,Math.max(0,r),Math.max(0,a)),!l){this.forEachChildren((function(t){i.union(t.AABBBounds)}));var u=t.scrollX,c=void 0===u?0:u,h=t.scrollY,d=void 0===h?0:h;i.translate(c,d)}return al.graphicService.updateTempAABBBounds(i),al.graphicService.transformAABBBounds(t,i,e,!1,this),n.copy(i),n}},{key:"doUpdateAABBBounds",value:function(){this.updateAABBBoundsStamp++;var t=_(e,"doUpdateAABBBounds",this,3)([]);return this.parent&&this.parent.addChildUpdateBoundTag(),this._emitCustomEvent("AAABBBoundsChange"),t}},{key:"clearUpdateBoundTag",value:function(){this._updateTag&=bl.CLEAR_BOUNDS,this._childUpdateTag&=bl.CLEAR_BOUNDS}},{key:"addUpdateBoundTag",value:function(){this._updateTag|=bl.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag()}},{key:"addChildUpdateBoundTag",value:function(){this._childUpdateTag&bl.UPDATE_BOUNDS||(this._childUpdateTag|=bl.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag())}},{key:"getTheme",value:function(){return this.theme.getTheme(this)}},{key:"incrementalAppendChild",value:function(t){var i=_(e,"appendChild",this,3)([t]);return this.stage&&i&&(i.stage=this.stage,i.layer=this.layer),this.addUpdateBoundTag(),this.getGraphicService().onAddIncremental(t,this,this.stage),i}},{key:"incrementalClearChild",value:function(){_(e,"removeAllChild",this,3)([]),this.addUpdateBoundTag(),this.getGraphicService().onClearIncremental(this,this.stage)}},{key:"_updateChildToStage",value:function(t){return this.stage&&t&&t.setStage(this.stage,this.layer),this.addUpdateBoundTag(),t}},{key:"appendChild",value:function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=_(e,"appendChild",this,3)([t]);return i&&this.stage&&n&&n.setStage(this.stage,this.layer),this.addUpdateBoundTag(),n}},{key:"insertBefore",value:function(t,i){return this._updateChildToStage(_(e,"insertBefore",this,3)([t,i]))}},{key:"insertAfter",value:function(t,i){return this._updateChildToStage(_(e,"insertAfter",this,3)([t,i]))}},{key:"insertInto",value:function(t,i){return this._updateChildToStage(_(e,"insertInto",this,3)([t,i]))}},{key:"removeChild",value:function(t){var i=_(e,"removeChild",this,3)([t]);return this.getGraphicService().onRemove(t),t.stage=null,this.addUpdateBoundTag(),i}},{key:"removeAllChild",value:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.forEachChildren((function(e){t.getGraphicService().onRemove(e),i&&e.isContainer&&e.removeAllChild(i)})),_(e,"removeAllChild",this,3)([]),this.addUpdateBoundTag()}},{key:"setStage",value:function(t,e){var i=this;this.stage!==t&&(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this._onSetStage&&this._onSetStage(this,t,e),this.getGraphicService().onSetStage(this,t),this.forEachChildren((function(e){e.setStage(t,i.layer)})))}},{key:"addUpdatePositionTag",value:function(){_(e,"addUpdatePositionTag",this,3)([]),this.forEachChildren((function(t){t.isContainer&&t.addUpdateGlobalPositionTag()}))}},{key:"addUpdateGlobalPositionTag",value:function(){_(e,"addUpdateGlobalPositionTag",this,3)([]),this.forEachChildren((function(t){t.isContainer&&t.addUpdateGlobalPositionTag()}))}},{key:"tryUpdateGlobalTransMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.shouldUpdateGlobalMatrix()){if(this._globalTransMatrix){if(this.parent){var e=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}},{key:"shouldUpdateGlobalMatrix",value:function(){return!!(this._updateTag&bl.UPDATE_GLOBAL_MATRIX)}},{key:"_getChildByName",value:function(t,e){return this.find((function(e){return e.name===t}),e)}},{key:"createOrUpdateChild",value:function(t,e,i){var n=this._getChildByName(t);return n?n.setAttributes(e):((n=al.graphicService.creator[i](e)).name=t,this.add(n)),n}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}},{key:"release",value:function(t){t&&this.forEachChildren((function(e){e.release(t)})),_(e,"release",this,3)([])}}])}(Hf);function Vf(t){return new Nf(t)}Nf.NOWORK_ANIMATE_ATTR=zf;var jf,Uf=function(t){function e(t,a,o,s){var l,u;return r(this,e),(l=n(this,e,[{}])).stage=t,l.global=a,l.window=o,l.main=s.main,l.layerHandler=s.layerHandler,l.layerHandler.init(i(l),o,{main:s.main,canvasId:s.canvasId,width:l.viewWidth,height:l.viewHeight,zIndex:null!==(u=s.zIndex)&&void 0!==u?u:0}),l.layer=i(l),l.subLayers=new Map,l.theme=new dh,l.background="rgba(0, 0, 0, 0)",l.afterDrawCbs=[],l}return h(e,t),o(e,[{key:"offscreen",get:function(){return this.layerHandler.offscreen}},{key:"layerMode",get:function(){return this.layerHandler.type}},{key:"width",get:function(){return this.stage?this.stage.width:0}},{key:"height",get:function(){return this.stage?this.stage.height:0}},{key:"viewWidth",get:function(){return this.stage?this.stage.viewWidth:0}},{key:"viewHeight",get:function(){return this.stage?this.stage.viewHeight:0}},{key:"dirtyBound",get:function(){throw new Error("暂不支持")}},{key:"dpr",get:function(){return this._dpr}},{key:"combineSubLayer",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=Array.from(this.subLayers.values()).sort((function(t,e){return t.zIndex-e.zIndex}));this.layerHandler.merge(i.map((function(t){return t.layer.subLayers.size&&t.layer.combineSubLayer(e),t.layer.getNativeHandler()}))),e&&i.forEach((function(t){t.group&&(t.group.incremental=0)})),i.forEach((function(e){al.layerService.releaseLayer(t.stage,e.layer)})),this.subLayers.clear()}},{key:"getNativeHandler",value:function(){return this.layerHandler}},{key:"setStage",value:function(t,i){_(e,"setStage",this,3)([t,this])}},{key:"pick",value:function(t,e){throw new Error("暂不支持")}},{key:"tryRenderSecondaryLayer",value:function(t,e){var i=this;this.layerHandler.secondaryHandlers&&this.layerHandler.secondaryHandlers.length&&this.layerHandler.secondaryHandlers.forEach((function(n){n.layer.renderCount=i.renderCount,n.layer.render(t,e)}))}},{key:"render",value:function(t,e){var i,n=this;this.layerHandler.render([this],{renderService:t.renderService,stage:this.stage,layer:this,viewBox:t.viewBox,transMatrix:t.transMatrix,background:null!==(i=t.background)&&void 0!==i?i:this.background,updateBounds:t.updateBounds},e),this.afterDrawCbs.forEach((function(t){return t(n)})),this.tryRenderSecondaryLayer(t,e)}},{key:"resize",value:function(t,e){this.layerHandler.resize(t,e)}},{key:"resizeView",value:function(t,e){this.layerHandler.resizeView(t,e)}},{key:"setDpr",value:function(t){this.layerHandler.setDpr(t)}},{key:"afterDraw",value:function(t){this.afterDrawCbs.push(t)}},{key:"startAnimate",value:function(t){throw new Error("暂不支持")}},{key:"setToFrame",value:function(t){throw new Error("暂不支持")}},{key:"prepare",value:function(t,e){}},{key:"release",value:function(){var t=this;_(e,"release",this,3)([]),this.layerHandler.release(),this.subLayers&&this.subLayers.forEach((function(e){al.layerService.releaseLayer(t.stage,e.layer)}))}},{key:"drawTo",value:function(t,e){var i,n=this;this.layerHandler.drawTo(t,[this],Object.assign({background:null!==(i=e.background)&&void 0!==i?i:this.background,renderService:e.renderService,viewBox:e.viewBox,transMatrix:e.transMatrix,stage:this.stage,layer:this},e)),this.afterDrawCbs.forEach((function(t){return t(n)}))}}])}(Nf),Wf=Symbol.for("TransformUtil"),Gf=Symbol.for("GraphicUtil"),Yf=Symbol.for("LayerService"),Xf=Symbol.for("StaticLayerHandlerContribution"),Kf=Symbol.for("DynamicLayerHandlerContribution"),qf=Symbol.for("VirtualLayerHandlerContribution"),Zf=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Jf=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Qf=jf=function(){return o((function t(){r(this,t),this.layerMap=new Map,this.global=al.global}),[{key:"tryInit",value:function(){this.inited||(this.staticLayerCountInEnv=this.global.getStaticCanvasCount(),this.dynamicLayerCountInEnv=this.global.getDynamicCanvasCount(),this.inited=!0)}},{key:"getStageLayer",value:function(t){return this.layerMap.get(t)}},{key:"getRecommendedLayerType",value:function(t){return t||(0!==this.staticLayerCountInEnv?"static":0!==this.dynamicLayerCountInEnv?"dynamic":"virtual")}},{key:"getLayerHandler",value:function(t){return"static"===t?yc.get(Xf):"dynamic"===t?yc.get(Kf):yc.get(qf)}},{key:"createLayer",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{main:!1};this.tryInit();var n=this.getRecommendedLayerType(i.layerMode);n=i.main||i.canvasId?"static":n;var r=this.getLayerHandler(n),a=new Uf(t,this.global,t.window,Object.assign(Object.assign({main:!1},i),{layerMode:n,canvasId:null!==(e=i.canvasId)&&void 0!==e?e:jf.GenerateLayerId(),layerHandler:r})),o=this.layerMap.get(t)||[];return o.push(a),this.layerMap.set(t,o),this.staticLayerCountInEnv--,a}},{key:"prepareStageLayer",value:function(t){var e;t.forEachChildren((function(t){var i=t.getNativeHandler();"virtual"===i.type?(i.mainHandler=e,e.secondaryHandlers.push(i)):(e=i).secondaryHandlers=[]}))}},{key:"releaseLayer",value:function(t,e){e.release();var i=this.layerMap.get(t)||[];this.layerMap.set(t,i.filter((function(t){return t!==e})))}},{key:"layerCount",value:function(t){return(this.layerMap.get(t)||[]).length}},{key:"restLayerCount",value:function(t){return"browser"===this.global.env?10:0}},{key:"releaseStage",value:function(t){this.layerMap.delete(t)}}],[{key:"GenerateLayerId",value:function(){return"".concat(jf.idprefix,"_").concat(jf.prefix_count++)}}])}();Qf.idprefix="visactor_layer",Qf.prefix_count=0,Qf=jf=Zf([Ps(),Jf("design:paramtypes",[])],Qf);var $f=new ys((function(t){t(rl).to(pl).inSingletonScope(),t(Qc).to(th),t(Gf).to(ah).inSingletonScope(),t(Wf).to(sh).inSingletonScope(),t(Yf).to(Qf).inSingletonScope()}));function tv(t,e){return!(!t&&!e)}function ev(t,e){return(q(t)?t.some((function(t){return t||void 0===t})):!!t)&&e>0}function iv(t,e,i){return i&&t*e>0}function nv(t,e,i,n,r){return r&&t*e>0&&0!==i&&0!==n}function rv(t,e){return t*e>0}function av(t,e,i,n,r){return r?t*e>0:t*e>0&&0!==i&&0!==n}function ov(t,e,i,n,r,a,o){var s=t-i,l=e-n,u=(o?a:-a)/Math.sqrt(s*s+l*l),c=u*l,h=-u*s,d=t+c,p=e+h,f=i+c,v=n+h,g=(d+f)/2,y=(p+v)/2,m=f-d,_=v-p,b=m*m+_*_,x=r-a,k=d*v-f*p,S=(_<0?-1:1)*Math.sqrt(Math.max(0,x*x*b-k*k)),A=(k*_-m*S)/b,M=(-k*m-_*S)/b,T=(k*_+m*S)/b,w=(-k*m+_*S)/b,C=A-g,E=M-y,P=T-g,B=w-y;return C*C+E*E>P*P+B*B&&(A=T,M=w),{cx:A,cy:M,x01:-c,y01:-h,x11:A*(r/x-1),y11:M*(r/x-1)}}function sv(t,e,i,n,r){var a,o,s,l,u,c=_e(i-e),h=t.getParsedCornerRadius(),d=q(h),p=t.getParsePadAngle(e,i),f=p.outerDeltaAngle,v=p.innerDeltaAngle,g=p.outerStartAngle,y=p.outerEndAngle,m=p.innerEndAngle,_=p.innerStartAngle,b=d?h[0]:h,x=d?h[1]:h,k=d?h[2]:h,S=d?h[3]:h,A=Math.max(x,b),M=Math.max(k,S),T=A,w=M,C=r*xe(g),E=r*Ae(g),P=n*xe(m),B=n*Ae(m);if((M>fe||A>fe)&&(a=r*xe(y),o=r*Ae(y),s=n*xe(_),l=n*Ae(_),c<ve)){var R=function(t,e,i,n,r,a,o,s){var l=i-t,u=n-e,c=o-r,h=s-a,d=h*l-c*u;return d*d<fe?[]:[t+(d=(c*(e-a)-h*(t-r))/d)*l,e+d*u]}(C,E,s,l,a,o,P,B);if(R){var L=C-R[0],I=E-R[1],D=a-R[0],O=o-R[1],F=1/Ae(((u=(L*D+I*O)/(Me(L*L+I*I)*Me(D*D+O*O)))>1?0:u<-1?ve:Math.acos(u))/2),z=Me(R[0]*R[0]+R[1]*R[1]);w=Se(M,(n-z)/(F-1)),T=Se(A,(r-z)/(F+1))}}return{outerDeltaAngle:f,xors:C,yors:E,xirs:s,yirs:l,xore:a,yore:o,xire:P,yire:B,limitedOcr:T,limitedIcr:w,outerCornerRadiusStart:b,outerCornerRadiusEnd:x,maxOuterCornerRadius:A,maxInnerCornerRadius:M,outerStartAngle:g,outerEndAngle:y,innerDeltaAngle:v,innerEndAngle:m,innerStartAngle:_,innerCornerRadiusStart:S,innerCornerRadiusEnd:k}}function lv(t,e,i,n,r,a,o){var s=t.getParsedAngle(),l=s.startAngle,u=s.endAngle,c=_e(u-l),h=u>l,d=!1;if(r<a){var p=r;r=a,a=p}if(r<=fe)e.moveTo(i,n);else if(c>=me-fe)e.moveTo(i+r*xe(l),n+r*Ae(l)),e.arc(i,n,r,l,u,!h),a>fe&&(e.moveTo(i+a*xe(u),n+a*Ae(u)),e.arc(i,n,a,u,l,h));else{var f=sv(t,l,u,a,r),v=f.outerDeltaAngle,g=f.xors,y=f.yors,m=f.xirs,_=f.yirs,b=f.limitedOcr,x=f.outerCornerRadiusStart,k=f.outerCornerRadiusEnd,S=f.maxOuterCornerRadius,A=f.xore,M=f.yore,T=f.xire,w=f.yire,C=f.outerStartAngle,E=f.outerEndAngle,P=f.limitedIcr,B=f.innerDeltaAngle,R=f.innerEndAngle,L=f.innerStartAngle,I=f.innerCornerRadiusStart,D=f.innerCornerRadiusEnd,O=f.maxInnerCornerRadius;if(v<.001)o&&(o[3]||o[1])&&e.moveTo(i+g,n+y),d=!0;else if(b>fe){var F=Se(x,b),z=Se(k,b),H=ov(m,_,g,y,r,F,Number(h)),N=ov(A,M,T,w,r,z,Number(h));b<S&&F===z?!o||o[0]?(e.moveTo(i+H.cx+H.x01,n+H.cy+H.y01),e.arc(i+H.cx,n+H.cy,b,be(H.y01,H.x01),be(N.y01,N.x01),!h)):e.moveTo(i+H.cx+b*xe(be(N.y01,N.x01)),n+H.cy+b*Ae(be(N.y01,N.x01))):!o||o[0]?(e.moveTo(i+H.cx+H.x01,n+H.cy+H.y01),F>0&&e.arc(i+H.cx,n+H.cy,F,be(H.y01,H.x01),be(H.y11,H.x11),!h),e.arc(i,n,r,be(H.cy+H.y11,H.cx+H.x11),be(N.cy+N.y11,N.cx+N.x11),!h),z>0&&e.arc(i+N.cx,n+N.cy,z,be(N.y11,N.x11),be(N.y01,N.x01),!h)):z>0?e.moveTo(i+N.cx+z*xe(be(N.y01,N.x01)),n+N.cy+z*Ae(be(N.y01,N.x01))):e.moveTo(i+A,n+r*Ae(E))}else!o||o[0]?(e.moveTo(i+g,n+y),e.arc(i,n,r,C,E,!h)):e.moveTo(i+r*xe(E),n+r*Ae(E));if(!(a>fe)||B<.001)!o||o[1]?e.lineTo(i+T,n+w):e.moveTo(i+T,n+w),d=!0;else if(P>fe){var V=Se(I,P),j=Se(D,P),U=ov(T,w,A,M,a,-j,Number(h)),W=ov(g,y,m,_,a,-V,Number(h));if(!o||o[1]?e.lineTo(i+U.cx+U.x01,n+U.cy+U.y01):e.moveTo(i+U.cx+U.x01,n+U.cy+U.y01),P<O&&V===j){var G=be(W.y01,W.x01);!o||o[2]?e.arc(i+U.cx,n+U.cy,P,be(U.y01,U.x01),G,!h):e.moveTo(i+U.cx+xe(G),n+U.cy+Ae(G))}else!o||o[2]?(j>0&&e.arc(i+U.cx,n+U.cy,j,be(U.y01,U.x01),be(U.y11,U.x11),!h),e.arc(i,n,a,be(U.cy+U.y11,U.cx+U.x11),be(W.cy+W.y11,W.cx+W.x11),h),V>0&&e.arc(i+W.cx,n+W.cy,V,be(W.y11,W.x11),be(W.y01,W.x01),!h)):V>0?e.moveTo(i+W.cx+V*xe(be(W.y01,W.x01)),n+W.cy+V*Ae(be(W.y01,W.x01))):e.moveTo(i+m,n+_)}else!o||o[1]?e.lineTo(i+T,n+w):e.moveTo(i+T,n+w),!o||o[2]?e.arc(i,n,a,R,L,h):e.moveTo(i+a*xe(L),n+a*Ae(L))}return o?o[3]&&e.lineTo(i+r*xe(l),n+r*Ae(l)):e.closePath(),d}var uv=Symbol.for("ArcRenderContribution"),cv=Symbol.for("AreaRenderContribution"),hv=Symbol.for("CircleRenderContribution"),dv=Symbol.for("GroupRenderContribution"),pv=Symbol.for("ImageRenderContribution"),fv=Symbol.for("PathRenderContribution"),vv=Symbol.for("PolygonRenderContribution"),gv=Symbol.for("RectRenderContribution"),yv=Symbol.for("SymbolRenderContribution"),mv=Symbol.for("TextRenderContribution"),_v=Symbol.for("InteractiveSubRenderContribution");function bv(t,e){return"end"===t||"right"===t?-e:"center"===t?-e/2:0}function xv(t,e,i){return"middle"===t?-e/2:"top"===t?0:"bottom"===t?(arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)-e:t&&"alphabetic"!==t?0:(i||(i=e),-(e-i)/2-.79*i)}var kv=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Sv=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Av=function(t,e){return function(i,n){e(i,n,t)}};function Mv(t,e,i){var n,r=e.attribute,a=r.x,o=void 0===a?i.x:a,s=r.y,l=void 0===s?i.y:s,u=r.z,c=void 0===u?i.z:u,h=r.dx,d=void 0===h?i.dx:h,p=r.dy,f=void 0===p?i.dy:p,v=r.dz,g=void 0===v?i.dz:v,y=r.scaleX,m=void 0===y?i.scaleX:y,_=r.scaleY,b=void 0===_?i.scaleY:_,x=r.scaleZ,k=void 0===x?i.scaleZ:x,S=r.alpha,A=void 0===S?i.alpha:S,M=r.beta,T=void 0===M?i.beta:M,w=r.angle,C=void 0===w?i.angle:w,E=r.anchor3d,P=void 0===E?e.attribute.anchor:E,B=r.anchor,R=[0,0,0];if(P){if("string"==typeof P[0]){var L=parseFloat(P[0])/100,I=e.AABBBounds;R[0]=I.x1+(I.x2-I.x1)*L}else R[0]=P[0];if("string"==typeof P[1]){var D=parseFloat(P[1])/100,O=e.AABBBounds;R[1]=O.x1+(O.x2-O.x1)*D}else R[1]=P[1];R[2]=null!==(n=P[2])&&void 0!==n?n:0}if($p(t),tf(t,t,[o+d,l+f,c+g]),tf(t,t,[R[0],R[1],R[2]]),function(t,e,i){var n=Math.sin(i),r=Math.cos(i),a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*r+u*n,t[5]=o*r+c*n,t[6]=s*r+h*n,t[7]=l*r+d*n,t[8]=u*r-a*n,t[9]=c*r-o*n,t[10]=h*r-s*n,t[11]=d*r-l*n}(t,t,T),function(t,e,i){var n=Math.sin(i),r=Math.cos(i),a=e[0],o=e[1],s=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r-u*n,t[1]=o*r-c*n,t[2]=s*r-h*n,t[3]=l*r-d*n,t[8]=a*n+u*r,t[9]=o*n+c*r,t[10]=s*n+h*r,t[11]=l*n+d*r}(t,t,A),tf(t,t,[-R[0],-R[1],R[2]]),function(t,e,i){var n=i[0],r=i[1],a=i[2];t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(t,t,[m,b,k]),C){var F=lf.allocate(),z=[0,0];if(B){if("string"==typeof P[0]){var H=parseFloat(P[0])/100,N=e.AABBBounds;z[0]=N.x1+(N.x2-N.x1)*H}else z[0]=P[0];if("string"==typeof P[1]){var V=parseFloat(P[1])/100,j=e.AABBBounds;z[1]=j.x1+(j.x2-j.x1)*V}else z[1]=P[1]}tf(F,F,[z[0],z[1],0]),function(t,e,i){var n=Math.sin(i),r=Math.cos(i),a=e[0],o=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r+u*n,t[1]=o*r+c*n,t[2]=s*r+h*n,t[3]=l*r+d*n,t[4]=u*r-a*n,t[5]=c*r-o*n,t[6]=h*r-s*n,t[7]=d*r-l*n}(F,F,C),tf(F,F,[-z[0],-z[1],0]),nf(t,t,F)}}var Tv=function(){return o((function t(e){r(this,t),this.creator=e,this.hooks={onAttributeUpdate:new il(["graphic"]),onSetStage:new il(["graphic","stage"]),onRemove:new il(["graphic"]),onRelease:new il(["graphic"]),onAddIncremental:new il(["graphic","group","stage"]),onClearIncremental:new il(["graphic","group","stage"]),beforeUpdateAABBBounds:new il(["graphic","stage","willUpdate","aabbBounds"]),afterUpdateAABBBounds:new il(["graphic","stage","aabbBounds","globalAABBBounds","selfChange"]),clearAABBBounds:new il(["graphic","stage","aabbBounds"])},this.tempAABBBounds1=new _i,this.tempAABBBounds2=new _i}),[{key:"onAttributeUpdate",value:function(t){this.hooks.onAttributeUpdate.taps.length&&this.hooks.onAttributeUpdate.call(t)}},{key:"onSetStage",value:function(t,e){this.hooks.onSetStage.taps.length&&this.hooks.onSetStage.call(t,e)}},{key:"onRemove",value:function(t){this.hooks.onRemove.taps.length&&this.hooks.onRemove.call(t)}},{key:"onRelease",value:function(t){this.hooks.onRelease.taps.length&&this.hooks.onRelease.call(t)}},{key:"onAddIncremental",value:function(t,e,i){this.hooks.onAddIncremental.taps.length&&this.hooks.onAddIncremental.call(t,e,i)}},{key:"onClearIncremental",value:function(t,e){this.hooks.onClearIncremental.taps.length&&this.hooks.onClearIncremental.call(t,e)}},{key:"beforeUpdateAABBBounds",value:function(t,e,i,n){this.hooks.beforeUpdateAABBBounds.taps.length&&this.hooks.beforeUpdateAABBBounds.call(t,e,i,n)}},{key:"afterUpdateAABBBounds",value:function(t,e,i,n,r){this.hooks.afterUpdateAABBBounds.taps.length&&this.hooks.afterUpdateAABBBounds.call(t,e,i,n,r)}},{key:"clearAABBBounds",value:function(t,e,i){this.hooks.clearAABBBounds.taps.length&&this.hooks.clearAABBBounds.call(t,e,i)}},{key:"updatePathProxyAABBBounds",value:function(t,e){var i="function"==typeof e.pathProxy?e.pathProxy(e.attribute):e.pathProxy;if(!i)return!1;var n=new wl(t);return Dl(i.commandList,n,0,0),!0}},{key:"updateHTMLTextAABBBounds",value:function(t,e,i,n){var r=t.textAlign,a=t.textBaseline;if(null!=t.forceBoundsHeight){var o=Q(t.forceBoundsHeight)?t.forceBoundsHeight:t.forceBoundsHeight(),s=xv(a,o,o);i.set(i.x1,s,i.x2,s+o)}if(null!=t.forceBoundsWidth){var l=Q(t.forceBoundsWidth)?t.forceBoundsWidth:t.forceBoundsWidth(),u=bv(r,l);i.set(u,i.y1,u+l,i.y2)}}},{key:"combindShadowAABBBounds",value:function(t,e){if(e&&e.shadowRoot){var i=e.shadowRoot.AABBBounds;t.union(i)}}},{key:"transformAABBBounds",value:function(t,e,i,n,r){if(!e.empty()){var a=t.scaleX,o=void 0===a?i.scaleX:a,s=t.scaleY,l=void 0===s?i.scaleY:s,u=t.stroke,c=void 0===u?i.stroke:u,h=t.shadowBlur,d=void 0===h?i.shadowBlur:h,p=t.lineWidth,f=void 0===p?i.lineWidth:p,v=t.pickStrokeBuffer,g=void 0===v?i.pickStrokeBuffer:v,y=t.strokeBoundsBuffer,m=void 0===y?i.strokeBoundsBuffer:y,_=this.tempAABBBounds1,b=this.tempAABBBounds2;if(c&&f)wp(_,(f+g)/Math.abs(o+l),n,m),e.union(_),_.setValue(b.x1,b.y1,b.x2,b.y2);if(d){var x=t.shadowOffsetX,k=void 0===x?i.shadowOffsetX:x,S=t.shadowOffsetY,A=void 0===S?i.shadowOffsetY:S;wp(_,d/Math.abs(o+l)*2,!1,m+1),_.translate(k,A),e.union(_)}}if(this.combindShadowAABBBounds(e,r),!e.empty()){var M=!0,T=r.transMatrix;r&&r.isContainer&&(M=!(1===T.a&&0===T.b&&0===T.c&&1===T.d&&0===T.e&&0===T.f)),M&&yi(e,e,T)}}},{key:"validCheck",value:function(t,e,i,n){if(!n)return!0;if(null!=t.forceBoundsHeight||null!=t.forceBoundsWidth)return!0;if(n.shadowRoot||n.isContainer)return!0;var r=t.visible,a=void 0===r?e.visible:r;return!(!n.valid||!a)||(i.empty()||(n.parent&&i.transformWithMatrix(n.parent.globalTransMatrix),this.clearAABBBounds(n,n.stage,i),i.clear()),!1)}},{key:"updateTempAABBBounds",value:function(t){var e=this.tempAABBBounds1,i=this.tempAABBBounds2;return e.setValue(t.x1,t.y1,t.x2,t.y2),i.setValue(t.x1,t.y1,t.x2,t.y2),{tb1:e,tb2:i}}}])}();Tv=kv([Ps(),Av(0,Cs(qp)),Sv("design:paramtypes",[Object])],Tv);var wv=function(t,e,i){var n=t.outerBorder,r=t.shadowBlur,a=void 0===r?e.shadowBlur:r;if(n){var o=e.outerBorder,s=n.distance,l=void 0===s?o.distance:s,u=n.lineWidth,c=void 0===u?o.lineWidth:u;i.expand(l+(a+c)/2)}return i},Cv=["radius","startAngle","endAngle"].concat(b(Lf)),Ev=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{radius:1};return r(this,e),(t=n(this,e,[i])).type="circle",t.numberType=Fp,t}return h(e,t),o(e,[{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute,e=t.startAngle,i=t.endAngle,n=t.radius;return this._validNumber(e)&&this._validNumber(i)&&this._validNumber(n)}},{key:"getGraphicTheme",value:function(){return fh(this).circle}},{key:"updateAABBBounds",value:function(t,e,i,n){this.updatePathProxyAABBBounds(i)||(n?this.updateCircleAABBBoundsImprecise(t,e,i):this.updateCircleAABBBoundsAccurate(t,e,i));var r=al.graphicService.updateTempAABBBounds(i),a=r.tb1,o=r.tb2;return wv(t,e,a),i.union(a),a.setValue(o.x1,o.y1,o.x2,o.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,al.graphicService.transformAABBBounds(t,i,e,!1,this),i}},{key:"updateCircleAABBBoundsImprecise",value:function(t,e,i){var n=t.radius,r=void 0===n?e.radius:n;return i.set(-r,-r,r,r),i}},{key:"updateCircleAABBBoundsAccurate",value:function(t,e,i){var n=t.startAngle,r=void 0===n?e.startAngle:n,a=t.endAngle,o=void 0===a?e.endAngle:a,s=t.radius,l=void 0===s?e.radius:s;return o-r>me-fe?i.set(-l,-l,l,l):Oh(r,o,l,i),i}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,Cv])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,Cv])}},{key:"toCustomPath",value:function(){var t,i,n,r=_(e,"toCustomPath",this,3)([]);if(r)return r;var a=this.attribute,o=null!==(t=a.radius)&&void 0!==t?t:this.getDefaultAttribute("radius"),s=null!==(i=a.startAngle)&&void 0!==i?i:this.getDefaultAttribute("startAngle"),l=null!==(n=a.endAngle)&&void 0!==n?n:this.getDefaultAttribute("endAngle");return(r=new Mu).arc(0,0,o,s,l),r}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Hf);function Pv(t){return new Ev(t)}Ev.NOWORK_ANIMATE_ATTR=zf;var Bv=function(){return o((function t(e,i,n){r(this,t),this.fontFamily=e,this.textOptions=i,this.textMeasure=n}),[{key:"LayoutBBox",value:function(t,e,i,n){if(t.xOffset="left"===e||"start"===e?0:"center"===e?t.width/-2:"right"===e||"end"===e?-t.width:0,"top"===i)t.yOffset=0;else if("middle"===i)t.yOffset=t.height/-2;else if("alphabetic"===i){var r=.79;if(1===n.length){var a=n[0];r=a.ascent/(a.ascent+a.descent)}t.yOffset=t.height*-r}else t.yOffset=-t.height;return t}},{key:"GetLayoutByLines",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=null!=o?o:{},l=s.lineWidth,u=s.suffixPosition,c=void 0===u?"end":u,h=s.measureMode,d=void 0===h?Js.actualBounding:h,p=s.keepCenterInLine,f=void 0!==p&&p;t=t.map((function(t){return t.toString()}));var v=[],g=[0,0];if("number"==typeof l&&l!==1/0){for(var y,m=0,_=t.length;m<_;m++){var b=this.textMeasure.measureTextPixelADscentAndWidth(t[m],this.textOptions,d),x=t[m].toString();if(b.width>l){var k=this.textMeasure.clipTextWithSuffix(t[m],this.textOptions,l,r,a,c);x=k.str,y=k.width}else y=b.width;v.push({str:x,width:y,ascent:b.ascent,descent:b.descent,keepCenterInLine:f})}g[0]=l}else{for(var S,A,M=0,T=0,w=t.length;T<w;T++){A=t[T];var C=this.textMeasure.measureTextPixelADscentAndWidth(t[T],this.textOptions,d);S=C.width,M=Math.max(M,S),v.push({str:A,width:S,ascent:C.ascent,descent:C.descent,keepCenterInLine:f})}g[0]=M}g[1]=v.length*n,g[0]=v.reduce((function(t,e){return Math.max(t,e.width)}),0);var E={xOffset:0,yOffset:0,width:g[0],height:g[1]};return this.LayoutBBox(E,e,i,v),this.layoutWithBBox(E,v,e,i,n)}},{key:"layoutWithBBox",value:function(t,e,i,n,r){var a=[0,0],o=e.length*r;"top"===n||("middle"===n?a[1]=(t.height-o)/2:"bottom"===n&&(a[1]=t.height-o));for(var s=0;s<e.length;s++)this.lineOffset(t,e[s],i,n,r,a);return{bbox:t,lines:e,fontFamily:this.fontFamily,fontSize:this.textOptions.fontSize,fontWeight:this.textOptions.fontWeight,lineHeight:r,textAlign:i,textBaseline:n}}},{key:"lineOffset",value:function(t,e,i,n,r,a){if("left"===i||"start"===i?e.leftOffset=0:"center"===i?e.leftOffset=(t.width-e.width)/2:"right"!==i&&"end"!==i||(e.leftOffset=t.width-e.width),e.topOffset=r/2+(e.ascent-e.descent)/2+a[1],!e.keepCenterInLine){var o=e.ascent+e.descent+0;if(o<r-0&&("bottom"===n?e.topOffset+=(r-o)/2:"top"===n&&(e.topOffset-=(r-o)/2)),"alphabetic"===n){var s=r/(e.ascent+e.descent);e.topOffset=r/2+(e.ascent-e.descent)/2*s+a[1]}}return a[1]+=r,e}}])}(),Rv=["text","maxLineWidth","maxWidth","textAlign","textBaseline","heightLimit","lineClamp","fontSize","fontFamily","fontWeight","ellipsis","lineHeight","direction","wordBreak","heightLimit","lineClamp"].concat(b(Lf)),Lv=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{text:"",fontSize:16};return r(this,e),(t=n(this,e,[i])).type="text",t.numberType=Xp,t.cache={},t}return h(e,t),o(e,[{key:"font",get:function(){var t=this.getGraphicTheme();return this._font||(this._font=di(this.attribute,t)),this._font}},{key:"clipedText",get:function(){var t,e=this.attribute,i=this.getGraphicTheme(),n=this.getMaxWidth(i);return Number.isFinite(n)?(this.tryUpdateAABBBounds(),this.cache.clipedText):(null!==(t=e.text)&&void 0!==t?t:i.text).toString()}},{key:"clipedWidth",get:function(){return this.tryUpdateAABBBounds(),this.cache.clipedWidth}},{key:"cliped",get:function(){var t,e,i=this.getGraphicTheme(),n=this.attribute,r=this.getMaxWidth(i);if(!Number.isFinite(r))return!1;var a=this.attribute.text;if(this.tryUpdateAABBBounds(),null===(e=null===(t=this.cache)||void 0===t?void 0:t.layoutData)||void 0===e?void 0:e.lines){var o="";return this.cache.layoutData.lines.forEach((function(t){o+=t.str})),(Array.isArray(a)?a.join(""):a)!==o}return"vertical"===n.direction&&this.cache.verticalList&&this.cache.verticalList[0]?this.cache.verticalList[0].map((function(t){return t.text})).join("")!==n.text.toString():null!=this.clipedText&&this.clipedText!==n.text.toString()}},{key:"multilineLayout",get:function(){return this.tryUpdateAABBBounds(),this.cache.layoutData}},{key:"isMultiLine",get:function(){return Array.isArray(this.attribute.text)||"normal"===this.attribute.whiteSpace}},{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.text;return q(t)?!t.every((function(t){return null==t||""===t})):null!=t&&""!==t}},{key:"getGraphicTheme",value:function(){return fh(this).text}},{key:"doUpdateOBBBounds",value:function(){var t=this.getGraphicTheme();this._OBBBounds.clear();var i=this.attribute,n=i.angle,r=void 0===n?t.angle:n;if(!r){var a=this.AABBBounds;return this._OBBBounds.setValue(a.x1,a.y1,a.x2,a.y2),this._OBBBounds}this.obbText||(this.obbText=new e({})),this.obbText.setAttributes(Object.assign(Object.assign({},i),{angle:0}));var o=this.obbText.AABBBounds,s=i.x,l=i.y,u={x:(o.x1+o.x2)/2,y:(o.y1+o.y2)/2},c=ii(u,r,{x:s,y:l});return this._OBBBounds.copy(o),this._OBBBounds.translate(c.x-u.x,c.y-u.y),this._OBBBounds.angle=r,this._OBBBounds}},{key:"updateAABBBounds",value:function(t,e,i){var n=this.attribute.text,r=void 0===n?e.text:n;Array.isArray(r)?this.updateMultilineAABBBounds(r):this.updateSingallineAABBBounds(r);var a=al.graphicService.updateTempAABBBounds(i).tb1,o=t.scaleX,s=void 0===o?e.scaleX:o,l=t.scaleY,u=void 0===l?e.scaleY:l,c=t.shadowBlur,h=void 0===c?e.shadowBlur:c,d=t.strokeBoundsBuffer,p=void 0===d?e.strokeBoundsBuffer:d;h&&(wp(a,h/Math.abs(s+u),!0,p),i.union(a));return al.graphicService.combindShadowAABBBounds(i,this),null==t.forceBoundsHeight&&null==t.forceBoundsWidth||al.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,yi(i,i,this.transMatrix),i}},{key:"updateSingallineAABBBounds",value:function(t){this.updateMultilineAABBBounds([t]);var e=this.cache.layoutData;if(e&&e.lines&&e.lines.length){var i=e.lines[0];this.cache.clipedText=i.str,this.cache.clipedWidth=i.width}return this._AABBBounds}},{key:"updateMultilineAABBBounds",value:function(t){var e=this.getGraphicTheme(),i=this.attribute,n=i.direction,r=void 0===n?e.direction:n,a=i.underlineOffset,o=void 0===a?e.underlineOffset:a,s="horizontal"===r?this.updateHorizontalMultilineAABBBounds(t):this.updateVerticalMultilineAABBBounds(t);return"horizontal"===r&&o&&this._AABBBounds.add(this._AABBBounds.x1,this._AABBBounds.y2+o),s}},{key:"guessLineHeightBuf",value:function(t){return t?.1*t:0}},{key:"updateHorizontalMultilineAABBBounds",value:function(t){var e,i=this.getGraphicTheme(),n=this.attribute,r=n.fontFamily,a=void 0===r?i.fontFamily:r,o=n.textAlign,s=void 0===o?i.textAlign:o,l=n.textBaseline,u=void 0===l?i.textBaseline:l,c=n.fontSize,h=void 0===c?i.fontSize:c,d=n.fontWeight,p=void 0===d?i.fontWeight:d,f=n.ellipsis,v=void 0===f?i.ellipsis:f,g=n.maxLineWidth,y=n.stroke,m=void 0===y?i.stroke:y,_=n.wrap,b=void 0===_?i.wrap:_,x=n.measureMode,k=void 0===x?i.measureMode:x,S=n.lineWidth,A=void 0===S?i.lineWidth:S,M=n.whiteSpace,T=void 0===M?i.whiteSpace:M,w=n.suffixPosition,C=void 0===w?i.suffixPosition:w,E=n.ignoreBuf,P=void 0===E?i.ignoreBuf:E,B=n.keepCenterInLine,R=void 0===B?i.keepCenterInLine:B,L=P?0:this.guessLineHeightBuf(h),I=this.getLineHeight(n,i,L);if("normal"===T||b)return this.updateWrapAABBBounds(t);if(!this.shouldUpdateShape()&&(null===(e=this.cache)||void 0===e?void 0:e.layoutData)){var D=this.cache.layoutData.bbox;return this._AABBBounds.set(D.xOffset,D.yOffset,D.xOffset+D.width,D.yOffset+D.height),m&&this._AABBBounds.expand(A/2),this._AABBBounds}var O=al.graphicUtil.textMeasure,F=new Bv(a,{fontSize:h,fontWeight:p,fontFamily:a,lineHeight:I},O).GetLayoutByLines(t,s,u,I,!0===v?i.ellipsis:v||void 0,!1,{lineWidth:g,suffixPosition:C,measureMode:k,keepCenterInLine:R}),z=F.bbox;return this.cache.layoutData=F,this.clearUpdateShapeTag(),this._AABBBounds.set(z.xOffset,z.yOffset,z.xOffset+z.width,z.yOffset+z.height),m&&this._AABBBounds.expand(A/2),this._AABBBounds}},{key:"updateWrapAABBBounds",value:function(t){var e,i,n,r=this.getGraphicTheme(),a=this.attribute,o=a.fontFamily,s=void 0===o?r.fontFamily:o,l=a.textAlign,u=void 0===l?r.textAlign:l,c=a.textBaseline,h=void 0===c?r.textBaseline:c,d=a.fontSize,p=void 0===d?r.fontSize:d,f=a.ellipsis,v=void 0===f?r.ellipsis:f,g=a.maxLineWidth,y=a.stroke,m=void 0===y?r.stroke:y,_=a.lineWidth,b=void 0===_?r.lineWidth:_,x=a.wordBreak,k=void 0===x?r.wordBreak:x,S=a.fontWeight,A=void 0===S?r.fontWeight:S,M=a.ignoreBuf,T=void 0===M?r.ignoreBuf:M,w=a.measureMode,C=void 0===w?r.measureMode:w,E=a.suffixPosition,P=void 0===E?r.suffixPosition:E,B=a.heightLimit,R=void 0===B?0:B,L=a.lineClamp,I=a.keepCenterInLine,D=void 0===I?r.keepCenterInLine:I,O=T?0:this.guessLineHeightBuf(p),F=this.getLineHeight(this.attribute,r,O);if(!this.shouldUpdateShape()&&(null===(e=this.cache)||void 0===e?void 0:e.layoutData)){var z=this.cache.layoutData.bbox;return this._AABBBounds.set(z.xOffset,z.yOffset,z.xOffset+z.width,z.yOffset+z.height),m&&this._AABBBounds.expand(b/2),this._AABBBounds}var H=al.graphicUtil.textMeasure,N={fontSize:p,fontWeight:A,fontFamily:s,lineHeight:F},V=new Bv(s,N,H),j=q(t)?t.map((function(t){return t.toString()})):[t.toString()],U=[],W=[0,0],G=1/0;if(R>0&&(G=Math.max(Math.floor(R/F),1)),L&&(G=Math.min(G,L)),"number"==typeof g&&g!==1/0){if(g>0)for(var Y=0;Y<j.length;Y++){var X=j[Y],K=!0;if(Y===G-1){var Z=H.clipTextWithSuffix(X,N,g,v,!1,P,Y!==j.length-1),J=H.measureTextPixelADscentAndWidth(Z.str,N,C);U.push({str:Z.str,width:Z.width,ascent:J.ascent,descent:J.descent,keepCenterInLine:D});break}var Q=H.clipText(X,N,g,"break-all"!==k,"keep-all"===k);if(""!==X&&""===Q.str||Q.wordBreaked){if(v){var $=H.clipTextWithSuffix(X,N,g,v,!1,P);Q.str=null!==(i=$.str)&&void 0!==i?i:"",Q.width=null!==(n=$.width)&&void 0!==n?n:0}else Q.str="",Q.width=0;K=!1}var tt=H.measureTextPixelADscentAndWidth(Q.str,N,C);U.push({str:Q.str,width:Q.width,ascent:tt.ascent,descent:tt.descent,keepCenterInLine:D});var et=Q.str.length;if(!Q.wordBreaked||""!==X&&""===Q.str||(K=!0,et=Q.wordBreaked),Q.str.length===X.length);else if(K){var it=X.substring(et);"keep-all"===k&&(it=it.replace(/^\s+/g,"")),j.splice(Y+1,0,it)}}var nt=0;U.forEach((function(t){nt=Math.max(nt,t.width)})),W[0]=nt}else{for(var rt,at,ot=0,st=0,lt=j.length;st<lt;st++){if(st===G-1){var ut=H.clipTextWithSuffix(j[st],N,g,v,!1,P),ct=H.measureTextPixelADscentAndWidth(ut.str,N,C);U.push({str:ut.str,width:ut.width,ascent:ct.ascent,descent:ct.descent,keepCenterInLine:D}),ot=Math.max(ot,ut.width);break}at=j[st],rt=H.measureTextWidth(at,N),ot=Math.max(ot,rt);var ht=H.measureTextPixelADscentAndWidth(at,N,C);U.push({str:at,width:rt,ascent:ht.ascent,descent:ht.descent,keepCenterInLine:D})}W[0]=ot}W[1]=U.length*F;var dt={xOffset:0,yOffset:0,width:W[0],height:W[1]};V.LayoutBBox(dt,u,h,U);var pt=V.layoutWithBBox(dt,U,u,h,F);return this.cache.layoutData=pt,this.clearUpdateShapeTag(),this._AABBBounds.set(dt.xOffset,dt.yOffset,dt.xOffset+dt.width,dt.yOffset+dt.height),m&&this._AABBBounds.expand(b/2),this._AABBBounds}},{key:"updateVerticalMultilineAABBBounds",value:function(t){var i,n,r,a=this.getGraphicTheme(),o=al.graphicUtil.textMeasure,s=this.attribute,l=s.maxLineWidth,u=void 0===l?a.maxLineWidth:l,c=s.ellipsis,h=void 0===c?a.ellipsis:c,d=s.fontFamily,p=void 0===d?a.fontFamily:d,f=s.fontSize,v=void 0===f?a.fontSize:f,g=s.fontWeight,y=void 0===g?a.fontWeight:g,m=s.stroke,_=void 0===m?a.stroke:m,b=s.lineWidth,x=void 0===b?a.lineWidth:b,k=s.verticalMode,S=void 0===k?a.verticalMode:k,A=s.suffixPosition,M=void 0===A?a.suffixPosition:A,T=this.getLineHeight(s,a,0),w=s.textAlign,C=void 0===w?a.textAlign:w,E=s.textBaseline,P=void 0===E?a.textBaseline:E;if(!S){var B=C;C=null!==(i=e.baselineMapAlign[P])&&void 0!==i?i:"left",P=null!==(n=e.alignMapBaseline[B])&&void 0!==n?n:"top"}if(r=0,!this.shouldUpdateShape()&&this.cache){this.cache.verticalList.forEach((function(t){var e=t.reduce((function(t,e){return t+e.width}),0);r=ke(e,r)}));var R=bv(C,r),L=this.cache.verticalList.length*T,I=xv(P,L,v);return this._AABBBounds.set(I,R,I+L,R+r),_&&this._AABBBounds.expand(x/2),this._AABBBounds}var D=t.map((function(t){return function(t){for(var e=[],i=0,n="",r=0;r<t.length;r++)Lp(t[r])?i?n+=t[r]:(i=1,n=t[r]):(i&&(e.push({text:n,direction:Cp.VERTICAL}),n="",i=0),e.push({text:t[r],direction:Cp.HORIZONTAL}));return n&&e.push({text:n,direction:Cp.VERTICAL}),e}(t.toString())}));D.forEach((function(t,e){if(Number.isFinite(u))if(h){var i=!0===h?a.ellipsis:h,n=o.clipTextWithSuffixVertical(t,{fontSize:v,fontWeight:y,fontFamily:p},u,i,!1,M);D[e]=n.verticalList,r=n.width}else{var s=o.clipTextVertical(t,{fontSize:v,fontWeight:y,fontFamily:p},u,!1);D[e]=s.verticalList,r=s.width}else r=0,t.forEach((function(t){var e=t.direction===Cp.HORIZONTAL?v:o.measureTextWidth(t.text,{fontSize:v,fontWeight:y,fontFamily:p});r+=e,t.width=e}))})),this.cache.verticalList=D,this.clearUpdateShapeTag(),this.cache.verticalList.forEach((function(t){var e=t.reduce((function(t,e){return t+e.width}),0);r=ke(e,r)}));var O=bv(C,r),F=this.cache.verticalList.length*T,z=xv(P,F,v);return this._AABBBounds.set(z,O,z+F,O+r),_&&this._AABBBounds.expand(x/2),this._AABBBounds}},{key:"getMaxWidth",value:function(t){var e,i,n=this.attribute;return null!==(i=null!==(e=n.maxLineWidth)&&void 0!==e?e:n.maxWidth)&&void 0!==i?i:t.maxWidth}},{key:"getLineHeight",value:function(t,e,i){var n;return null!==(n=jh(t.lineHeight,t.fontSize||e.fontSize))&&void 0!==n?n:(t.fontSize||e.fontSize)+i}},{key:"needUpdateTags",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rv;return _(e,"needUpdateTags",this,3)([t,i])}},{key:"needUpdateTag",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rv;return _(e,"needUpdateTag",this,3)([t,i])}},{key:"_interpolate",value:function(t,e,i,n,r){"text"===t&&(r.text=n)}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}},{key:"getBaselineMapAlign",value:function(){return e.baselineMapAlign}},{key:"getAlignMapBaseline",value:function(){return e.alignMapBaseline}}])}(Hf);function Iv(t){return new Lv(t)}Lv.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,direction:1,textAlign:1,textBaseline:1,fontFamily:1,fontWeight:1},zf),Lv.baselineMapAlign={top:"left",bottom:"right",middle:"center"},Lv.alignMapBaseline={left:"top",right:"bottom",center:"middle"};var Dv=["symbolType","size"].concat(b(Lf)),Ov=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{symbolType:"circle"};return r(this,e),(t=n(this,e,[i])).type="symbol",t.numberType=Yp,t}return h(e,t),o(e,[{key:"getParsedPath",value:function(){return this.shouldUpdateShape()&&(this._parsedPath=this.doUpdateParsedPath(),this.clearUpdateShapeTag()),this._parsedPath}},{key:"getParsedPath2D",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=null;try{n=new Path2D}catch(t){return null}var r=this.getParsedPath();if(!r)return null;r.draw(n,i,t,e)}},{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.size;return q(t)?2===t.length&&t.every(this._validNumber):this._validNumber(t)}},{key:"doUpdateParsedPath",value:function(){var t=this.attribute.symbolType,i=void 0===t?"circle":t;return _(e,"parsePath",this,3)([i])}},{key:"getGraphicTheme",value:function(){return fh(this).symbol}},{key:"updateAABBBounds",value:function(t,e,i,n){this.updatePathProxyAABBBounds(i)||(n?this.updateSymbolAABBBoundsImprecise(t,e,i):this.updateSymbolAABBBoundsAccurate(t,e,i));var r=al.graphicService.updateTempAABBBounds(i),a=r.tb1,o=r.tb2;(function(t,e,i){var n=t.outerBorder,r=t.shadowBlur,a=void 0===r?e.shadowBlur:r,o=t.strokeBoundsBuffer,s=void 0===o?e.strokeBoundsBuffer:o;if(n){var l=e.outerBorder,u=n.distance,c=void 0===u?l.distance:u,h=n.lineWidth;wp(i,c+(a+(void 0===h?l.lineWidth:h))/2,!0,s)}})(t,e,a),i.union(a),a.setValue(o.x1,o.y1,o.x2,o.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,this.x1WithoutTransform=i.x1,this.y1WithoutTransform=i.y1;var s=t.lineJoin,l=void 0===s?e.lineJoin:s;return al.graphicService.transformAABBBounds(t,i,e,"miter"===l,this),i}},{key:"updateSymbolAABBBoundsImprecise",value:function(t,e,i){var n=t.size,r=void 0===n?e.size:n;if(q(r))i.set(-r[0]/2,-r[1]/2,r[0]/2,r[1]/2);else{var a=r/2;i.set(-a,-a,a,a)}return i}},{key:"updateSymbolAABBBoundsAccurate",value:function(t,e,i){var n=t.size,r=void 0===n?e.size:n;return this.getParsedPath().bounds(r,i),i}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,Dv])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,Dv])}},{key:"toCustomPath",value:function(){var t=this.getParsedPath(),e=this.attribute.size,i=q(e)?e:[e,e];return t.path?(new Mu).fromCustomPath2D(t.path,0,0,i[0],i[1]):(new Mu).fromString(t.pathStr,0,0,i[0],i[1])}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Hf);function Fv(t){return new Ov(t)}Ov.NOWORK_ANIMATE_ATTR=Object.assign({symbolType:1},zf);var zv=["segments","points","curveType","curveTension"].concat(b(Lf)),Hv=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(this,e),(t=n(this,e,[i])).type="line",t.numberType=Vp,t}return h(e,t),o(e,[{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){if(this.pathProxy)return!0;var t=this.attribute,e=t.points,i=t.segments;return i?0!==i.length:!(!e||e.length<=1)}},{key:"_interpolate",value:function(t,e,i,n,r){"points"===t&&(r.points=zh(i,n,e))}},{key:"getGraphicTheme",value:function(){return fh(this).line}},{key:"updateAABBBounds",value:function(t,e,i){this.updatePathProxyAABBBounds(i)||(t.segments?this.updateLineAABBBoundsBySegments(t,e,i):this.updateLineAABBBoundsByPoints(t,e,i)),al.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;var n=t.lineJoin,r=void 0===n?e.lineJoin:n;return al.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}},{key:"updateLineAABBBoundsByPoints",value:function(t,e,i,n){var r=t.points,a=void 0===r?e.points:r,o=t.connectedType,s=i;return a.forEach((function(t){!1===t.defined&&"connect"!==o||s.add(t.x,t.y)})),s}},{key:"updateLineAABBBoundsBySegments",value:function(t,e,i,n){var r=t.segments,a=void 0===r?e.segments:r,o=t.connectedType,s=i;return a.forEach((function(t){t.points.forEach((function(t){!1===t.defined&&"connect"!==o||s.add(t.x,t.y)}))})),s}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,zv])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,zv])}},{key:"toCustomPath",value:function(){var t=_(e,"toCustomPath",this,3)([]);if(t)return t;var i=this.attribute;t=new Mu;var n=i.segments,r=function(e){if(e&&e.length){var i=!0;e.forEach((function(e){!1!==e.defined&&(i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y),i=!1)}))}};return n&&n.length?n.forEach((function(t){r(t.points)})):i.points&&r(i.points),t}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Hf);function Nv(t){return new Hv(t)}Hv.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},zf);var Vv=function(t){if(!t)return{x:0,y:0,width:0,height:0};var e=j(t.width)?t.x1-t.x:t.width,i=j(t.height)?t.y1-t.y:t.height,n=0,r=0;return e<0?(n=e,e=-e):Number.isNaN(e)&&(e=0),i<0?(r=i,i=-i):Number.isNaN(i)&&(i=0),{x:n,y:r,width:e,height:i}},jv=["width","x1","y1","height","cornerRadius"].concat(b(Lf)),Uv=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="rect",i.numberType=Wp,i}return h(e,t),o(e,[{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){return!0}},{key:"getGraphicTheme",value:function(){return fh(this).rect}},{key:"updateAABBBounds",value:function(t,e,i){if(!this.updatePathProxyAABBBounds(i)){var n=t.width,r=t.height,a=t.x1,o=t.y1,s=t.x,l=t.y;n=null!=n?n:a-s,r=null!=r?r:o-l,(isFinite(n)||isFinite(r)||isFinite(s)||isFinite(l))&&i.set(0,0,n||0,r||0)}var u=al.graphicService.updateTempAABBBounds(i),c=u.tb1,h=u.tb2;return wv(t,e,c),i.union(c),c.setValue(h.x1,h.y1,h.x2,h.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,al.graphicService.transformAABBBounds(t,i,e,!1,this),i}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,jv])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,jv])}},{key:"toCustomPath",value:function(){var t=_(e,"toCustomPath",this,3)([]);if(t)return t;var i=this.attribute,n=Vv(i),r=n.x,a=n.y,o=n.width,s=n.height;return(t=new Mu).moveTo(r,a),t.rect(r,a,o,s),t}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Hf);function Wv(t){return new Uv(t)}Uv.NOWORK_ANIMATE_ATTR=zf;var Gv=function(t){function e(t){var a;return r(this,e),(a=n(this,e,[t])).type="glyph",a.numberType=zp,a.subGraphic=[],a._onInit&&a._onInit(i(a)),a.valid=a.isValid(),a}return h(e,t),o(e,[{key:"setSubGraphic",value:function(t){var e=this;this.detachSubGraphic(),this.subGraphic=t,t.forEach((function(t){t.glyphHost=e,Object.setPrototypeOf(t.attribute,e.attribute)})),this.valid=this.isValid(),this.addUpdateBoundTag()}},{key:"detachSubGraphic",value:function(){this.subGraphic.forEach((function(t){t.glyphHost=null,Object.setPrototypeOf(t.attribute,{})}))}},{key:"getSubGraphic",value:function(){return this.subGraphic}},{key:"onInit",value:function(t){this._onInit=t}},{key:"onUpdate",value:function(t){this._onUpdate=t}},{key:"isValid",value:function(){return!0}},{key:"setAttribute",value:function(t,i,n,r){_(e,"setAttribute",this,3)([t,i,n,r]),this.subGraphic.forEach((function(t){t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()}))}},{key:"setAttributes",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;_(e,"setAttributes",this,3)([t,i,n]),this.subGraphic.forEach((function(t){t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()}))}},{key:"translate",value:function(t,i){return _(e,"translate",this,3)([t,i]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"translateTo",value:function(t,i){return _(e,"translateTo",this,3)([t,i]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"scale",value:function(t,i,n){return _(e,"scale",this,3)([t,i,n]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"scaleTo",value:function(t,i){return _(e,"scaleTo",this,3)([t,i]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"rotate",value:function(t){return _(e,"rotate",this,3)([t]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"rotateTo",value:function(t){return _(e,"rotate",this,3)([t]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"getGraphicTheme",value:function(){return fh(this).glyph}},{key:"updateAABBBounds",value:function(t,e,i){return this.getSubGraphic().forEach((function(t){i.union(t.AABBBounds)})),i}},{key:"doUpdateAABBBounds",value:function(){this.updateAABBBoundsStamp++,this._AABBBounds.clear();var t=this.updateAABBBounds(this.attribute,this.getGraphicTheme(),this._AABBBounds);return this.clearUpdateBoundTag(),t}},{key:"needUpdateTags",value:function(t){return!1}},{key:"needUpdateTag",value:function(t){return!1}},{key:"useStates",value:function(t,e){var i,n=this;if(t.length){if((null===(i=this.currentStates)||void 0===i?void 0:i.length)!==t.length||t.some((function(t,e){return n.currentStates[e]!==t}))){this.stopStateAnimates();var r={},a=this.subGraphic.map((function(){return{}}));t.forEach((function(e){var i,o=n.glyphStateProxy?n.glyphStateProxy(e,t):n.glyphStates[e];o&&(Object.assign(r,o.attributes),(null===(i=o.subAttributes)||void 0===i?void 0:i.length)&&a.forEach((function(t,e){Object.assign(t,o.subAttributes[e])})))})),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}}else this.clearStates(e)}},{key:"clearStates",value:function(t){this.stopStateAnimates(),this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}},{key:"clone",value:function(){var t=new e(Object.assign({},this.attribute));return t.setSubGraphic(this.subGraphic.map((function(t){return t.clone()}))),t}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Hf);function Yv(t){return new Gv(t)}Gv.NOWORK_ANIMATE_ATTR=zf;var Xv=function(){return o((function t(e,i,n,a,o,s,l,u,c,h,d,p,f,v){r(this,t),this.left=e,this.top=i,this.width=n,this.height=a,this.actualHeight=0,this.bottom=i+a,this.right=e+n,this.ellipsis=o,this.wordBreak=s,this.verticalDirection=l,this.lines=[],this.globalAlign=u,this.globalBaseline=c,this.layoutDirection=h,this.directionKey=ec[this.layoutDirection],this.isWidthMax=d,this.isHeightMax=p,this.singleLine=f,v?(v.clear(),this.icons=v):this.icons=new Map}),[{key:"draw",value:function(t,e){var i=this.getActualSize(),n=i.width,r=i.height,a=this.isWidthMax?Math.min(this.width,n):this.width||n||0,o=this.isHeightMax?Math.min(this.height,r):this.height||r||0;o=Math.min(o,r);var s=0;switch(this.globalBaseline){case"top":s=0;break;case"middle":s=-o/2;break;case"bottom":s=-o}var l=0;"right"===this.globalAlign||"end"===this.globalAlign?l=-a:"center"===this.globalAlign&&(l=-a/2);var u=this[this.directionKey.height];this.singleLine&&(u=this.lines[0].height+1);var c=!1;if("middle"===this.verticalDirection)if(this.actualHeight>=u&&0!==u)for(var h=0;h<this.lines.length;h++){var d=this.lines[h],p=d.top,f=d.height;if(p+f<this[this.directionKey.top]||p+f>this[this.directionKey.top]+u)return c;var v=!1;this.ellipsis&&this.lines[h+1]&&this.lines[h+1].top+this.lines[h+1].height>this[this.directionKey.top]+u&&(v=!0,c=!0),this.lines[h].draw(t,v,this.lines[h][this.directionKey.left]+l,this.lines[h][this.directionKey.top]+s,this.ellipsis,e)}else{var g=Math.floor((u-this.actualHeight)/2);"vertical"===this.layoutDirection?l+=g:s+=g;for(var y=0;y<this.lines.length;y++)this.lines[y].draw(t,!1,this.lines[y][this.directionKey.left]+l,this.lines[y][this.directionKey.top]+s,this.ellipsis,e)}else if("bottom"===this.verticalDirection&&"vertical"!==this.layoutDirection)for(var m=0;m<this.lines.length;m++){var _=this.lines[m];_.top;var b=_.height,x=u-this.lines[m].top-this.lines[m].height;if(0===u)this.lines[m].draw(t,!1,l,x+s,this.ellipsis,e);else{if(x+b>this[this.directionKey.top]+u||x<this[this.directionKey.top])return c;var k=!1;this.ellipsis&&this.lines[m+1]&&x-this.lines[m+1].height<this[this.directionKey.top]&&(k=!0,c=!0),this.lines[m].draw(t,k,l,x+s,this.ellipsis,e)}}else{"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&this.singleLine&&this.isWidthMax&&(l+=this.lines[0].height+1);for(var S=0;S<this.lines.length;S++){"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&(l-=this.lines[S].height+this.lines[S].top);var A=this.lines[S],M=A.top,T=A.height;if(0===u)this.lines[S].draw(t,!1,this.lines[S][this.directionKey.left]+l,this.lines[S][this.directionKey.top]+s,this.ellipsis,e);else{if(M+T<this[this.directionKey.top]||M+T>this[this.directionKey.top]+u)return c;var w=!1;this.ellipsis&&this.lines[S+1]&&this.lines[S+1].top+this.lines[S+1].height>this[this.directionKey.top]+u&&(w=!0,c=!0),this.lines[S].draw(t,w,this.lines[S][this.directionKey.left]+l,this.lines[S][this.directionKey.top]+s,this.ellipsis,e)}}}return c}},{key:"getActualSize",value:function(){return this.ellipsis?this.getActualSizeWidthEllipsis():this.getRawActualSize()}},{key:"getRawActualSize",value:function(){for(var t=0,e=0,i=0;i<this.lines.length;i++){var n=this.lines[i];n.actualWidth>t&&(t=n.actualWidth),e+=n.height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}},{key:"getActualSizeWidthEllipsis",value:function(){var t=0,e=0,i=this.getRawActualSize();i.width;i.height;this.width,this.height;var n=this[this.directionKey.height];if(this.singleLine&&(n=this.lines[0].height+1),"middle"===this.verticalDirection)if(this.actualHeight>=n&&0!==n)for(var r=0;r<this.lines.length;r++){var a=this.lines[r],o=a.top,s=a.height;if(o+s<this[this.directionKey.top]||o+s>this[this.directionKey.top]+n);else if(this.ellipsis&&this.lines[r+1]&&this.lines[r+1].top+this.lines[r+1].height>this[this.directionKey.top]+n){var l=!0===this.ellipsis?"...":this.ellipsis||"",u=this.lines[r].getWidthWithEllips(l);u>t&&(t=u),e+=this.lines[r].height}else this.lines[r].actualWidth>t&&(t=this.lines[r].actualWidth),e+=this.lines[r].height}else{Math.floor((n-this.actualHeight)/2);for(var c=0;c<this.lines.length;c++)this.lines[c].actualWidth>t&&(t=this.lines[c].actualWidth),e+=this.lines[c].height}else if("bottom"===this.verticalDirection)for(var h=0;h<this.lines.length;h++){var d=this.lines[h];d.top;var p=d.height,f=n-this.lines[h].top-this.lines[h].height;if(0===n)this.lines[h].actualWidth>t&&(t=this.lines[h].actualWidth),e+=this.lines[h].height;else if(f+p>this[this.directionKey.top]+n||f<this[this.directionKey.top]);else if(this.ellipsis&&this.lines[h+1]&&f-this.lines[h+1].height<this[this.directionKey.top]){var v=!0===this.ellipsis?"...":this.ellipsis||"",g=this.lines[h].getWidthWithEllips(v);g>t&&(t=g),e+=this.lines[h].height}else this.lines[h].actualWidth>t&&(t=this.lines[h].actualWidth),e+=this.lines[h].height}else for(var y=0;y<this.lines.length;y++){var m=this.lines[y],_=m.top,b=m.height;if(0===n)this.lines[y].actualWidth>t&&(t=this.lines[y].actualWidth),e+=this.lines[y].height;else if(_+b<this[this.directionKey.top]||_+b>this[this.directionKey.top]+n);else if(this.ellipsis&&this.lines[y+1]&&this.lines[y+1].top+this.lines[y+1].height>this[this.directionKey.top]+n){var x=!0===this.ellipsis?"...":this.ellipsis||"",k=this.lines[y].getWidthWithEllips(x);k>t&&(t=k),e+=this.lines[y].height}else this.lines[y].actualWidth>t&&(t=this.lines[y].actualWidth),e+=this.lines[y].height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}}])}();function Kv(t,e,i,n){var r=Math.round(t),a=Math.round(i),o=Math.round(e),s=Math.round(n);return{left:t>r?r:r-.5,top:i>a?a:a-.5,right:o>e?o:o+.5,bottom:s>n?s:s+.5}}var qv=function(){return o((function t(e,i,n,a){var o,s;r(this,t),this.fontSize=n.fontSize||16,this.textBaseline=n.textBaseline||"alphabetic",this.ascentDescentMode=a;var l=jh(n.lineHeight,this.fontSize);this.lineHeight="number"==typeof l?l>this.fontSize?l:this.fontSize:Math.floor(1.2*this.fontSize),this.height=this.lineHeight;var u=hc(e,n,this.ascentDescentMode),c=u.ascent,h=u.height,d=u.descent,p=u.width,f=0,v=0,g=0;this.height>h&&(f=(this.height-h)/2,v=Math.ceil(f),g=Math.floor(f)),"top"===this.textBaseline?(this.ascent=f,this.descent=h-f):"bottom"===this.textBaseline?(this.ascent=h-f,this.descent=f):"middle"===this.textBaseline?(this.ascent=this.height/2,this.descent=this.height/2):(this.ascent=c+v,this.descent=d+g),this.length=e.length,this.width=p||0,this.text=e||"",this.newLine=i||!1,this.character=n,this.left=0,this.top=0,this.ellipsis="normal",this.ellipsisWidth=0,this.ellipsisOtherParagraphWidth=0,this.space=n.space,this.dx=null!==(o=n.dx)&&void 0!==o?o:0,this.dy=null!==(s=n.dy)&&void 0!==s?s:0,"vertical"===n.direction&&(this.direction=n.direction,this.widthOrigin=this.width,this.heightOrigin=this.height,this.width=this.heightOrigin,this.height=this.widthOrigin,this.lineHeight=this.height),this.ellipsisStr="..."}),[{key:"updateWidth",value:function(){var t=hc(this.text,this.character,this.ascentDescentMode).width;this.width=t,"vertical"===this.direction&&(this.widthOrigin=this.width,this.width=this.heightOrigin,this.height=this.widthOrigin)}},{key:"drawBackground",value:function(t,e,i,n,r,a,o){if(""!==this.text&&"\n"!==this.text&&this.character.background&&(!this.character.backgroundOpacity||this.character.backgroundOpacity>0)){var s=this.text,l=this.left+n;this.top;var u=this.direction;if(this.verticalEllipsis)s=this.ellipsisStr,u="vertical",this.ellipsisWidth/2;else{if("hide"===this.ellipsis)return;if("add"===this.ellipsis)s+=this.ellipsisStr,"right"!==a&&"end"!==a||(l-=this.ellipsisWidth);else if("replace"===this.ellipsis){var c=lc(s,("vertical"===u?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,s.length-1);if(s=s.slice(0,c),s+=this.ellipsisStr,"right"===a||"end"===a)if("vertical"===u);else{var h=hc(this.text.slice(c),this.character,this.ascentDescentMode).width;l-=this.ellipsisWidth-h}}}var d=Kv(l,l+(this.widthOrigin||this.width),e,e+o);return Object.assign(Object.assign({},d),{fillStyle:this.character.background,globalAlpha:this.character.backgroundOpacity})}}},{key:"draw",value:function(t,e,i,n,r,a,o){var s,l=e+i,u=this.text,c=this.left+n+(null!==(s=this.space)&&void 0!==s?s:0)/2;l+=this.top;var h=this.direction;if(this.verticalEllipsis)u=this.ellipsisStr,h="vertical",l-=this.ellipsisWidth/2;else{if("hide"===this.ellipsis)return;if("add"===this.ellipsis)u+=this.ellipsisStr,"right"!==a&&"end"!==a||(c-=this.ellipsisWidth);else if("replace"===this.ellipsis){var d=lc(u,("vertical"===h?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,u.length-1);if(u=u.slice(0,d),u+=this.ellipsisStr,"right"===a||"end"===a)if("vertical"===h);else{var p=hc(this.text.slice(d),this.character,this.ascentDescentMode).width;c-=this.ellipsisWidth-p}}}switch(this.character.script){case"super":l-=this.ascent*(1/3);break;case"sub":l+=this.descent/2}"vertical"===h&&(t.save(),t.rotateAbout(Math.PI/2,c,l),t.translate(-this.heightOrigin||-this.lineHeight/2,-this.descent/2),t.translate(c,l),c=0,l=0);var f=this.character.lineWidth,v=void 0===f?1:f;if(this.character.stroke&&v&&t.strokeText(u,c+this.dx,l+this.dy),this.character.fill&&t.fillText(u,c+this.dx,l+this.dy),this.character.fill)if(this.character.lineThrough||this.character.underline){if(this.character.underline){var g=1+l,y=Kv(c,c+(this.widthOrigin||this.width),g,g+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(y.left,1+l,y.right-y.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}if(this.character.lineThrough){var m=1+l-this.ascent/2,_=Kv(c,c+(this.widthOrigin||this.width),m,m+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(_.left,1+l-this.ascent/2,_.right-_.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}}else if("underline"===this.character.textDecoration){var b=1+l,x=Kv(c,c+(this.widthOrigin||this.width),b,b+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(x.left,1+l,x.right-x.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}else if("line-through"===this.character.textDecoration){var k=1+l-this.ascent/2,S=Kv(c,c+(this.widthOrigin||this.width),k,k+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(S.left,1+l-this.ascent/2,S.right-S.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}"vertical"===h&&t.restore()}},{key:"getWidthWithEllips",value:function(t){var e=this.text,i="vertical"===t?this.height:this.width;if("hide"===this.ellipsis)return i;if("add"===this.ellipsis)return i+this.ellipsisWidth;if("replace"===this.ellipsis){var n=lc(e,i-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,e.length-1);e=e.slice(0,n),e+=this.ellipsisStr;var r=hc(this.text.slice(n),this.character,this.ascentDescentMode).width;return i+this.ellipsisWidth-r}return i}}])}();var Zv=["width","height","image"].concat(b(Lf)),Jv=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="image",i.numberType=Np,i.loadImage(i.attribute.image),i}return h(e,t),o(e,[{key:"getImageElement",value:function(){var t=this.attribute.image;if(!t||!this.resources)return null;var e=this.resources.get(t);return"success"!==e.state?null:e.data}},{key:"width",get:function(){return this.tryUpdateAABBBounds(),this._actualWidth}},{key:"height",get:function(){return this.tryUpdateAABBBounds(),this._actualHeight}},{key:"repeatX",get:function(){var t;return null!==(t=this.attribute.repeatX)&&void 0!==t?t:"no-repeat"},set:function(t){this.attribute.repeatX===t&&(this.attribute.repeatX=t)}},{key:"repeatY",get:function(){var t;return null!==(t=this.attribute.repeatY)&&void 0!==t?t:"no-repeat"},set:function(t){this.attribute.repeatY===t&&(this.attribute.repeatY=t)}},{key:"image",get:function(){return this.attribute.image},set:function(t){t!==this.attribute.image&&(this.attribute.image=t,this.loadImage(this.attribute.image))}},{key:"imageLoadSuccess",value:function(t,i,n){var r=this;_(e,"imageLoadSuccess",this,3)([t,i,function(){r.successCallback&&r.successCallback()}]),this.addUpdateBoundTag()}},{key:"imageLoadFail",value:function(t,i){var n=this;_(e,"imageLoadFail",this,3)([t,function(){n.failCallback&&n.failCallback()}])}},{key:"setAttributes",value:function(t,i,n){return t.image&&this.loadImage(t.image),_(e,"setAttributes",this,3)([t,i,n])}},{key:"setAttribute",value:function(t,i,n,r){return"image"===t&&this.loadImage(i),_(e,"setAttribute",this,3)([t,i,n,r])}},{key:"getGraphicTheme",value:function(){return fh(this).image}},{key:"updateAABBBounds",value:function(t,e,i){if(!this.updatePathProxyAABBBounds(i)){var n=t.maxWidth,r=void 0===n?e.maxWidth:n,a=t.maxHeight,o=void 0===a?e.maxHeight:a,s=t.width,l=t.height;if(null==s||null==l){var u=this.getImageElement();if(u){var c=u.width,h=u.height;if(null!=s)l=s*(h/c);else if(null!=l)s=l*(c/h);else{var d=c/h;d>r/o?(s=r,l=r/d):(l=o,s=o*d)}}else s=r,l=o}this._actualWidth=s,this._actualHeight=l,i.set(0,0,s,l)}var p=al.graphicService.updateTempAABBBounds(i),f=p.tb1,v=p.tb2;return wv(t,e,f),i.union(f),f.setValue(v.x1,v.y1,v.x2,v.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,al.graphicService.transformAABBBounds(t,i,e,!1,this),i}},{key:"getDefaultAttribute",value:function(t){return qu[t]}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,Zv])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,Zv])}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Hf);function Qv(t){return new Jv(t)}Jv.NOWORK_ANIMATE_ATTR=Object.assign({image:1,repeatX:1,repeatY:1},zf);var $v=function(t){function e(t){var i;if(r(this,e),(i=n(this,e,[t]))._x=0,i._y=0,i._hovered=!1,i._marginArray=[0,0,0,0],"always"===t.backgroundShowMode&&(i._hovered=!0),t.margin){var a=Lh(t.margin);i._marginArray="number"==typeof a?[a,a,a,a]:a}return i.onBeforeAttributeUpdate=function(t,e,n){if(q(n)&&-1!==n.indexOf("margin")||"margin"===n)if(e.margin){var r=Lh(e.margin);i._marginArray="number"==typeof r?[r,r,r,r]:r}else i._marginArray=[0,0,0,0]},i}return h(e,t),o(e,[{key:"width",get:function(){var t;return(null!==(t=this.attribute.width)&&void 0!==t?t:0)+this._marginArray[1]+this._marginArray[3]}},{key:"height",get:function(){var t;return(null!==(t=this.attribute.height)&&void 0!==t?t:0)+this._marginArray[0]+this._marginArray[2]}},{key:"tryUpdateAABBBounds",value:function(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.doUpdateAABBBounds();var t=this.attribute,e=t.width,i=void 0===e?qu.width:e,n=t.height,r=void 0===n?qu.height:n,a=this.attribute,o=a.backgroundWidth,s=void 0===o?i:o,l=a.backgroundHeight,u=(s-i)/2,c=((void 0===l?r:l)-r)/2;return this._AABBBounds.expand([0,2*u,2*c,0]),this._AABBBounds}},{key:"setHoverState",value:function(t){"hover"===this.attribute.backgroundShowMode&&this._hovered!==t&&(this._hovered=t)}}])}(Jv),tg=function(){return o((function t(e,i,n,a,o,s,l,u){var c=this;r(this,t),this.left=e,this.width=i,this.baseline=n,this.ascent=a,this.descent=o,this.top=n-a,this.paragraphs=s.map((function(t){return t})),this.textAlign=(this.paragraphs[0]instanceof $v?this.paragraphs[0].attribute.textAlign:this.paragraphs[0].character.textAlign)||"left",this.direction=l,this.directionKey=ec[this.direction],this.actualWidth=0;var h=0;this.paragraphs.forEach((function(t,e){if(0===e&&t instanceof qv){var i=oc.exec(t.text);0!==(null==i?void 0:i.index)&&(t.text=t.text.slice(null==i?void 0:i.index),t.updateWidth())}c.actualWidth+=t[c.directionKey.width],h=Math.max(t[c.directionKey.height],h)})),this.height=h,this.blankWidth=u?0:this.width-this.actualWidth,this.calcOffset(i,u)}),[{key:"calcOffset",value:function(t,e){var i=this.directionKey,n=this.height,r=this.left,a=0;this.actualWidth<t&&!e&&("right"===this.textAlign||"end"===this.textAlign?r=t-this.actualWidth:"center"===this.textAlign?r=(t-this.actualWidth)/2:"justify"===this.textAlign&&(this.paragraphs.length<2?r=(t-this.actualWidth)/2:a=(t-this.actualWidth)/(this.paragraphs.length-1))),this.paragraphs.map((function(t){t instanceof $v?(t["_"+i.x]=r,r+=t[i.width]+a,t["_"+i.y]="top"===t.attribute.textBaseline?0:"bottom"===t.attribute.textBaseline?n-t.height:(n-t.height)/2):(t[i.left]=r,r+=t[i.width]+a)}))}},{key:"draw",value:function(t,e,i,n,r,a){var o=this;if(r&&(e||this.paragraphs.some((function(t){return t.overflow})))){for(var s=!0,l=!1,u=this.paragraphs.length-1;u>=0;u--){var c=this.paragraphs[u];if(c.overflow)s=s&&""===c.text;else if(s){l=!0;break}}var h=0;if(!l)for(var d=this.paragraphs.length-1;d>=0;d--){var p=this.paragraphs[d];if(p.overflow){if(""===p.text)break}else{if(p instanceof $v)break;if("vertical"===this.direction&&"vertical"!==p.direction){p.verticalEllipsis=!0;break}var f=!0===r?"...":r||"";p.ellipsisStr=f;var v=hc(f,p.character,p.ascentDescentMode).width||0;if(v<=this.blankWidth+h){e&&(p.ellipsis="add");break}if(v<=this.blankWidth+h+p.width){p.ellipsis="replace",p.ellipsisWidth=v,p.ellipsisOtherParagraphWidth=this.blankWidth+h;break}p.ellipsis="hide",h+=p.width}}}var g="",y=-1,m=[],_=[m];this.paragraphs.forEach((function(e,r){if(!(e instanceof $v)){var a=e.drawBackground(t,n,o.ascent,i,0===r,o.textAlign,o.height);a&&(g===a.fillStyle&&y===a.globalAlpha||(m=[],_.push(m),g=a.fillStyle,y=a.globalAlpha),m.push(a))}})),_.forEach((function(e){if(0!==e.length){var i=e[0],n=e[e.length-1];t.fillStyle=i.fillStyle,t.globalAlpha=i.globalAlpha,t.fillRect(i.left,i.top,n.right-i.left,n.bottom-i.top)}})),this.paragraphs.forEach((function(e,r){if(e instanceof $v)return e.setAttributes({x:i+e._x,y:n+e._y}),void a(e,t,i+e._x,n+e._y,o.ascent);var s={x1:o.left,y1:o.top,x2:o.left+o.actualWidth,y2:o.top+o.height};(function(t,e){var i=e&&e.stroke||nc;if(i){var n=e.strokeOpacity,r=void 0===n?1:n,a=e.opacity,o=void 0===a?1:a;t.globalAlpha=r*o,t.lineWidth=e&&"number"==typeof e.lineWidth?e.lineWidth:1,t.strokeStyle=i,sc(t,e)}else t.globalAlpha=0})(t,e.character),function(t,e,i){var n=e&&e.fill||ic;if(n){var r=e.fillOpacity,a=void 0===r?1:r,o=e.opacity,s=void 0===o?1:o;t.globalAlpha=a*s,t.fillStyle=i?tc(t,n,{AABBBounds:i}):n,sc(t,e)}else t.globalAlpha=0}(t,e.character,s),e.draw(t,n,o.ascent,i,0===r,o.textAlign,o.height)}))}},{key:"getWidthWithEllips",value:function(t){for(var e=this,i=0,n=this.paragraphs.length-1;n>=0;n--){var r=this.paragraphs[n];if(r instanceof $v)break;var a=hc(t,r.character,r.ascentDescentMode).width||0;if(a<=this.blankWidth+i){r.ellipsis="add",r.ellipsisWidth=a;break}if(a<=this.blankWidth+i+r.width){r.ellipsis="replace",r.ellipsisWidth=a,r.ellipsisOtherParagraphWidth=this.blankWidth+i;break}r.ellipsis="hide",i+=r.width}var o=0;return this.paragraphs.forEach((function(t,i){o+=t instanceof $v?t.width:t.getWidthWithEllips(e.direction)})),o}}])}(),eg=function(){return o((function t(e){r(this,t),this.frame=e,this.width=this.frame.width,this.height=this.frame.height,this.lineWidth=0,this.y=this.frame.top,this.maxAscent=0,this.maxDescent=0,this.maxAscentForBlank=0,this.maxDescentForBlank=0,this.lineBuffer=[],this.direction=e.layoutDirection,this.directionKey=ec[this.direction]}),[{key:"store",value:function(t){if(t instanceof $v){this.frame.icons.set(t.richtextId,t),this.lineBuffer.push(t),this.lineWidth+=t[this.directionKey.width];var e=0,i=0;"top"===t.attribute.textBaseline?(e=0,i=t.height):"bottom"===t.attribute.textBaseline?(e=t.height,i=0):(e=t.height/2,i=t.height/2),this.maxAscent=Math.max(this.maxAscent,e),this.maxDescent=Math.max(this.maxDescent,i)}else this.lineBuffer.push(t),0!==t.text.length?(this.lineWidth+=t[this.directionKey.width],this.maxAscent=Math.max(this.maxAscent,t.ascent),this.maxDescent=Math.max(this.maxDescent,t.descent)):(this.maxAscentForBlank=Math.max(this.maxAscentForBlank,t.ascent),this.maxDescentForBlank=Math.max(this.maxDescentForBlank,t.descent))}},{key:"send",value:function(){if(0!==this.lineBuffer.length){var t=0===this.maxAscent?this.maxAscentForBlank:this.maxAscent,e=0===this.maxDescent?this.maxDescentForBlank:this.maxDescent,i=new tg(this.frame.left,this[this.directionKey.width],this.y+t,t,e,this.lineBuffer,this.direction,"horizontal"===this.direction?this.frame.isWidthMax:this.frame.isHeightMax);this.frame.lines.push(i),this.frame.actualHeight+=i.height,this.y+=i.height,this.lineBuffer.length=0,this.lineWidth=this.maxAscent=this.maxDescent=this.maxAscentForBlank=this.maxDescentForBlank=0}}},{key:"deal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t instanceof $v?"horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):0===this.lineBuffer.length?(this.store(t),this.send()):(this.send(),this.deal(t)):"number"!=typeof this.width||this.width<0||(t.newLine&&this.send(),(0!==t.text.length||this.newLine)&&("horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):this.lineWidth===this[this.directionKey.width]?(this.send(),this.deal(t)):this.cut(t,e)))}},{key:"cut",value:function(t,e){var i=this[this.directionKey.width]-this.lineWidth||0,n=Math.ceil(i/t[this.directionKey.width]*t.length)||0,r=lc(t.text,i,t.character,n,"break-word"===this.frame.wordBreak);if(0!==r){var a=function(t,e){var i=t.text.slice(0,e),n=t.text.slice(e);return[new qv(i,t.newLine,t.character,t.ascentDescentMode),new qv(n,!0,t.character,t.ascentDescentMode)]}(t,r),o=m(a,2),s=o[0],l=o[1];this.store(s),e?this.send():this.deal(l)}else 0!==this.lineBuffer.length&&(this.send(),this.deal(t))}}])}(),ig=!1;try{ig=Intl&&"function"==typeof Intl.Segmenter}catch(t){ig=!1}var ng=["width","height","ellipsis","wordBreak","verticalDirection","maxHeight","maxWidth","textAlign","textBaseline","textConfig","layoutDirection","fill","stroke","fontSize","fontFamily","fontStyle","fontWeight","lineWidth","opacity","fillOpacity","strokeOpacity"].concat(b(Lf)),rg=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="richtext",i._currentHoverIcon=null,i.numberType=Gp,i.onBeforeAttributeUpdate=function(t,e,n){for(var r in t)if("hoverIconId"===r){if(t[r]===e[r])continue;var a=i._frameCache.icons.get(t[r]);i.updateHoverIconState(a)}},i}return h(e,t),o(e,[{key:"width",get:function(){var t;return null!==(t=this.attribute.width)&&void 0!==t?t:Ku.width},set:function(t){this.attribute.width!==t&&(this.attribute.width=t,this.addUpdateShapeAndBoundsTag())}},{key:"height",get:function(){var t;return null!==(t=this.attribute.height)&&void 0!==t?t:Ku.height},set:function(t){this.attribute.height!==t&&(this.attribute.height=t,this.addUpdateShapeAndBoundsTag())}},{key:"maxWidth",get:function(){return this.attribute.maxWidth},set:function(t){this.attribute.maxWidth!==t&&(this.attribute.maxWidth=t,this.addUpdateShapeAndBoundsTag())}},{key:"maxHeight",get:function(){return this.attribute.maxHeight},set:function(t){this.attribute.maxHeight!==t&&(this.attribute.maxHeight=t,this.addUpdateShapeAndBoundsTag())}},{key:"ellipsis",get:function(){var t;return null!==(t=this.attribute.ellipsis)&&void 0!==t?t:Ku.ellipsis},set:function(t){this.attribute.ellipsis!==t&&(this.attribute.ellipsis=t,this.addUpdateShapeAndBoundsTag())}},{key:"wordBreak",get:function(){var t;return null!==(t=this.attribute.wordBreak)&&void 0!==t?t:Ku.wordBreak},set:function(t){this.attribute.wordBreak!==t&&(this.attribute.wordBreak=t,this.addUpdateShapeAndBoundsTag())}},{key:"verticalDirection",get:function(){var t;return null!==(t=this.attribute.verticalDirection)&&void 0!==t?t:Ku.verticalDirection},set:function(t){this.attribute.verticalDirection!==t&&(this.attribute.verticalDirection=t,this.addUpdateShapeAndBoundsTag())}},{key:"textAlign",get:function(){var t;return null!==(t=this.attribute.textAlign)&&void 0!==t?t:Ku.textAlign},set:function(t){this.attribute.textAlign!==t&&(this.attribute.textAlign=t,this.addUpdateShapeAndBoundsTag())}},{key:"textBaseline",get:function(){var t;return null!==(t=this.attribute.textBaseline)&&void 0!==t?t:Ku.textBaseline},set:function(t){this.attribute.textBaseline!==t&&(this.attribute.textBaseline=t,this.addUpdateShapeAndBoundsTag())}},{key:"textConfig",get:function(){var t;return null!==(t=this.attribute.textConfig)&&void 0!==t?t:Ku.textConfig},set:function(t){this.attribute.textConfig=t,this.addUpdateShapeAndBoundsTag()}},{key:"getGraphicTheme",value:function(){return fh(this).richtext}},{key:"updateAABBBounds",value:function(t,e,i){var n,r,a,o,s=t.width,l=void 0===s?e.width:s,u=t.height,c=void 0===u?e.height:u,h=t.maxWidth,d=void 0===h?e.maxWidth:h,p=t.maxHeight,f=void 0===p?e.maxHeight:p,v=t.textAlign,g=void 0===v?e.textAlign:v,y=t.textBaseline,m=void 0===y?null!==(r=null!==(n=t.textBaseline)&&void 0!==n?n:e.textBaseline)&&void 0!==r?r:"top":y,_=t.editOptions;if(l>0&&c>0)i.set(0,0,l,c);else{var b=this.getFrameCache().getActualSize(),x=b.width,k=b.height,S=l||x||0,A=c||k||0;A="number"==typeof f&&A>f?f:A||0,S="number"==typeof d&&S>d?d:S||0,i.set(0,0,S,A)}_&&_.keepHeightWhileEmpty&&!i.height()&&!(null===(a=t.textConfig)||void 0===a?void 0:a.length)&&(i.y2=i.y1+(null!==(o=t.fontSize)&&void 0!==o?o:12),i.x2=i.x1+2);var M=0;switch(m){case"top":M=0;break;case"middle":M=-i.height()/2;break;case"bottom":M=-i.height()}var T=0;switch(g){case"left":T=0;break;case"center":T=-i.width()/2;break;case"right":T=-i.width()}return c||("middle"===this.verticalDirection?M-=i.height()/2:"bottom"===this.verticalDirection&&(M-=i.height())),i.translate(T,M),al.graphicService.updateTempAABBBounds(i),null==t.forceBoundsHeight&&null==t.forceBoundsWidth||al.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,al.graphicService.transformAABBBounds(t,i,e,!1,this),0===i.width()&&0===i.height()&&i.clear(),i}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,ng])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,ng])}},{key:"getFrameCache",value:function(){return this.shouldUpdateShape()&&(this.doUpdateFrameCache(),this.clearUpdateShapeTag()),this._frameCache}},{key:"cliped",get:function(){var t=this.getFrameCache();if(t.actualHeight>t.height)return!0;if(this.attribute.disableAutoWrapLine)for(var e=0;e<t.lines.length;e++)for(var i=t.lines[e],n=0;n<i.paragraphs.length;n++){var r=i.paragraphs[n];if(r.overflow&&""!==r.text)return!0}return!1}},{key:"combinedStyleToCharacter",value:function(t){var e=this.attribute,i=e.fill,n=e.stroke,r=e.fontSize,a=e.fontFamily,o=e.fontStyle,s=e.fontWeight,l=e.lineWidth,u=e.opacity,c=e.fillOpacity,h=e.lineHeight,d=e.strokeOpacity,p=e.upgradeAttrs,f=Object.assign({fill:i,stroke:n,fontSize:r,fontFamily:a,fontStyle:o,fontWeight:s,lineWidth:l,opacity:u,fillOpacity:c,strokeOpacity:d},t);return(null==p?void 0:p.lineHeight)&&(f.lineHeight=h),f}},{key:"doUpdateFrameCache",value:function(t){var i,n=this,r=this.attribute,a=r.maxWidth,o=r.maxHeight,s=r.width,l=r.height,u=r.ellipsis,c=r.wordBreak,h=r.verticalDirection,d=r.textAlign,p=r.textBaseline,f=r.layoutDirection,v=r.singleLine,g=r.disableAutoWrapLine,y=r.editable,m=r.ascentDescentMode,_=r.upgradeAttrs,b=_&&_.multiBreakLine,x=this.attribute.textConfig,k=void 0===x?[]:x;y&&k.length>0&&!e.AllSingleCharacter(k)&&(k=e.TransformTextConfig2SingleCharacter(k),this.attribute.textConfig=k);for(var S=[],A=null!=t?t:k,M=0;M<A.length;M++)if("image"in A[M]){var T=this.combinedStyleToCharacter(A[M]);T.lineWidth=void 0;var w=T.id&&this._frameCache&&this._frameCache.icons&&this._frameCache.icons.get(T.id);if(w)S.push(w);else{var C=new $v(T);C.successCallback=function(){var t;n.addUpdateBoundTag(),null===(t=n.stage)||void 0===t||t.renderNextFrame()},C.richtextId=T.id,S.push(C)}}else{var E=this.combinedStyleToCharacter(A[M]);if(Q(E.text)&&(E.text="".concat(E.text)),E.text&&E.text.includes("\n"))for(var P=E.text.split("\n"),B=0;B<P.length;B++)if(0===B)S.push(new qv(P[B],!1,E,m));else if(P[B]||M===A.length-1)S.push(new qv(P[B],!0,E,m));else{var R=this.combinedStyleToCharacter(A[M+1]);S.push(new qv(P[B],!0,R,m))}else E.text&&S.push(new qv(E.text,!1,E,m))}var L="number"==typeof a&&Number.isFinite(a)&&a>0,I="number"==typeof o&&Number.isFinite(o)&&o>0,D="number"==typeof s&&Number.isFinite(s)&&s>0&&(!L||s<=a),O="number"==typeof l&&Number.isFinite(l)&&l>0&&(!I||l<=o),F=new Xv(0,0,(D?s:L?a:0)||0,(O?l:I?o:0)||0,u,c,h,d,p,f||"horizontal",!D&&L,!O&&I,v||!1,null===(i=this._frameCache)||void 0===i?void 0:i.icons),z=new eg(F);if(z.newLine=b,g)for(var H=0,N=!1,V=0;V<S.length;V++){var j=S[V];N?(j.overflow=!0,j.left=1/0,j.top=1/0,!j.newLine&&F.lines[F.lines.length-1].paragraphs.push(j)):z.deal(j,!0),F.lines.length!==H&&(H=F.lines.length,z.lineBuffer.length=0,j.overflow=!0,j.left=1e3,j.top=1e3,F.lines[F.lines.length-1].paragraphs.push(j),N=!0),j.newLine&&(N=!1,z.lineWidth=0),z.send()}else for(var U=0;U<S.length;U++)z.deal(S[U]);if(z.send(),!("horizontal"===F.layoutDirection?D:O)){var W=F.getActualSizeWidthEllipsis(),G="horizontal"===F.layoutDirection?W.width:W.height;("horizontal"===F.layoutDirection?L:I)&&(G=Math.min(G,"horizontal"===F.layoutDirection?a:o)),F.lines.forEach((function(t){t.calcOffset(G,!1)}))}b&&F.lines.forEach((function(t){var e=t.paragraphs;t.paragraphs=t.paragraphs.filter((function(t){return""!==t.text})),0===t.paragraphs.length&&e.length&&(e[0].text="\n",t.paragraphs.push(e[0]))})),this._frameCache=F}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"setStage",value:function(t,i){_(e,"setStage",this,3)([t,i]),this.getFrameCache().icons.forEach((function(e){e.setStage(t,i)}))}},{key:"bindIconEvent",value:function(){var t=this;this.addEventListener("pointermove",(function(e){var i=t.pickIcon(e.global);i&&i===t._currentHoverIcon||(i?t.setAttribute("hoverIconId",i.richtextId):!i&&t._currentHoverIcon&&t.setAttribute("hoverIconId",void 0))})),this.addEventListener("pointerleave",(function(e){t._currentHoverIcon&&t.setAttribute("hoverIconId",void 0)}))}},{key:"updateHoverIconState",value:function(t){var e,i,n,r,a;t?(null===(e=this._currentHoverIcon)||void 0===e||e.setHoverState(!1),this._currentHoverIcon=t,this._currentHoverIcon.setHoverState(!0),null===(i=this.stage)||void 0===i||i.setCursor(t.attribute.cursor),null===(n=this.stage)||void 0===n||n.renderNextFrame()):(this._currentHoverIcon.setHoverState(!1),this._currentHoverIcon=null,null===(r=this.stage)||void 0===r||r.setCursor(),null===(a=this.stage)||void 0===a||a.renderNextFrame())}},{key:"pickIcon",value:function(t){var e,i=this.getFrameCache(),n=this.globalTransMatrix,r=n.e,a=n.f;return i.icons.forEach((function(i,n){var o,s,l=i.AABBBounds.clone();l.translate(i._marginArray[3],i._marginArray[0]),l.containsPoint({x:t.x-r,y:t.y-a})&&(e=i,e.globalX=(null!==(o=e.attribute.x)&&void 0!==o?o:0)+r+i._marginArray[3],e.globalY=(null!==(s=e.attribute.y)&&void 0!==s?s:0)+a+i._marginArray[0])})),e}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}],[{key:"AllSingleCharacter",value:function(t){return t.lines?t.lines.every((function(t){return t.paragraphs.every((function(t){return!(t.text&&K(t.text)&&e.splitText(t.text).length>1)}))})):t.every((function(t){return t.isComposing||!(t.text&&K(t.text)&&e.splitText(t.text).length>1)}))}},{key:"splitText",value:function(t){if(ig){var e,i=[],n=s(new Intl.Segmenter(void 0,{granularity:"grapheme"}).segment(t));try{for(n.s();!(e=n.n()).done;){var r=e.value.segment;i.push(r)}}catch(t){n.e(t)}finally{n.f()}return i}return Array.from(t)}},{key:"TransformTextConfig2SingleCharacter",value:function(t){var i=[];return t.forEach((function(t){var n=e.splitText(t.text.toString());if(K(t.text)&&n.length>1)for(var r=0;r<n.length;r++){var a=n[r];i.push(Object.assign(Object.assign({},t),{text:a}))}else i.push(t)})),i}}])}(Hf);function ag(t){return new rg(t)}rg.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,verticalDirection:1,textAlign:1,textBaseline:1,textConfig:1,layoutDirection:1},zf);var og=["path","customPath"].concat(b(Lf)),sg=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="path",i.numberType=jp,i}return h(e,t),o(e,[{key:"pathShape",get:function(){return this.tryUpdateAABBBounds(),this.getParsedPathShape()}},{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.path;return null!=t&&""!==t}},{key:"getParsedPathShape",value:function(){var t=this.getGraphicTheme();if(!this.valid)return t.path;var e=this.attribute;return e.path instanceof Mu?e.path:(j(this.cache)&&this.doUpdatePathShape(),this.cache instanceof Mu?this.cache:t.path)}},{key:"getGraphicTheme",value:function(){return fh(this).path}},{key:"updateAABBBounds",value:function(t,e,i){if(!this.updatePathProxyAABBBounds(i)){var n=this.getParsedPathShape();i.union(n.getBounds())}var r=al.graphicService.updateTempAABBBounds(i),a=r.tb1,o=r.tb2;wv(t,e,a),i.union(a),a.setValue(o.x1,o.y1,o.x2,o.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;var s=t.lineJoin,l=void 0===s?e.lineJoin:s;return al.graphicService.transformAABBBounds(t,i,e,"miter"===l,this),i}},{key:"doUpdateAABBBounds",value:function(t){return this.doUpdatePathShape(),_(e,"doUpdateAABBBounds",this,3)([t])}},{key:"doUpdatePathShape",value:function(){var t=this.attribute;K(t.path,!0)?this.cache=(new Mu).fromString(t.path):t.customPath&&(this.cache=new Mu,t.customPath(this.cache,this))}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,og])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,og])}},{key:"toCustomPath",value:function(){return(new Mu).fromCustomPath2D(this.getParsedPathShape(),0,0)}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Hf);function lg(t){return new sg(t)}sg.NOWORK_ANIMATE_ATTR=Object.assign({path:1,customPath:1},zf);var ug=["segments","points","curveType","curveTension"].concat(b(Lf)),cg=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="area",i.numberType=Op,i}return h(e,t),o(e,[{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){if(this.pathProxy)return!0;var t=this.attribute,e=t.points,i=t.segments;return i?0!==i.length:!!e&&0!==e.length}},{key:"getGraphicTheme",value:function(){return fh(this).area}},{key:"updateAABBBounds",value:function(t,e,i){this.updatePathProxyAABBBounds(i)||(t.segments?this.updateAreaAABBBoundsBySegments(t,e,i):this.updateAreaAABBBoundsByPoints(t,e,i)),al.graphicService.updateTempAABBBounds(i),this.setWidthHeightWithoutTransform(i);var n=t.lineJoin,r=void 0===n?e.lineJoin:n;return al.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}},{key:"updateAreaAABBBoundsByPoints",value:function(t,e,i,n){var r=t.points,a=void 0===r?e.points:r,o=i;return a.forEach((function(t){var e,i;o.add(t.x,t.y),o.add(null!==(e=t.x1)&&void 0!==e?e:t.x,null!==(i=t.y1)&&void 0!==i?i:t.y)})),o}},{key:"updateAreaAABBBoundsBySegments",value:function(t,e,i,n){var r=t.segments,a=void 0===r?e.segments:r,o=i;return a.forEach((function(t){t.points.forEach((function(t){var e,i;o.add(t.x,t.y),o.add(null!==(e=t.x1)&&void 0!==e?e:t.x,null!==(i=t.y1)&&void 0!==i?i:t.y)}))})),o}},{key:"_interpolate",value:function(t,e,i,n,r){"points"===t&&(r.points=zh(i,n,e))}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,ug])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,ug])}},{key:"toCustomPath",value:function(){var t=_(e,"toCustomPath",this,3)([]);if(t)return t;t=new Mu;var i=this.attribute,n=i.segments,r=function(e){if(e&&e.length){var i=!0,n=[];if(e.forEach((function(e){var r,a;!1!==e.defined&&(i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y),n.push({x:null!==(r=e.x1)&&void 0!==r?r:e.x,y:null!==(a=e.y1)&&void 0!==a?a:e.y}),i=!1)})),n.length){for(var r=n.length-1;r>=0;r--)t.lineTo(n[r].x,n[r].y);t.closePath()}}};return i.points?r(i.points):n&&n.length&&n.forEach((function(t){r(t.points)})),t}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Hf);function hg(t){return new cg(t)}cg.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},zf);var dg=["innerRadius","outerRadius","startAngle","endAngle","cornerRadius","padAngle","padRadius","cap"].concat(b(Lf)),pg=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="arc",i.numberType=Ip,i}return h(e,t),o(e,[{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute,e=t.startAngle,i=t.endAngle,n=t.outerRadius,r=t.innerRadius;return this._validNumber(e)&&this._validNumber(i)&&this._validNumber(n)&&this._validNumber(r)}},{key:"getParsedCornerRadius",value:function(){var t=this.getGraphicTheme(),e=this.attribute,i=e.cornerRadius,n=void 0===i?t.cornerRadius:i,r=e.innerPadding,a=void 0===r?t.innerPadding:r,o=e.outerPadding,s=void 0===o?t.outerPadding:o,l=this.attribute,u=l.outerRadius,c=void 0===u?t.outerRadius:u,h=l.innerRadius,d=void 0===h?t.innerRadius:h;if(c+=s,d-=a,0===n||"0%"===n)return 0;var p=Math.abs(c-d),f=function(t){return Math.min(Q(t,!0)?t:p*parseFloat(t)/100,p/2)};if(q(n)){var v=n.map((function(t){return f(t)||0}));return 0===v.length?[v[0],v[0],v[0],v[0]]:2===v.length?[v[0],v[1],v[0],v[1]]:(3===v.length&&v.push(0),v)}return f(n)}},{key:"getParsedAngle",value:function(){var t=this.getGraphicTheme(),e=this.attribute,i=e.startAngle,n=void 0===i?t.startAngle:i,r=e.endAngle,a=void 0===r?t.endAngle:r,o=this.attribute.cap,s=void 0===o?t.cap:o,l=a-n>=0?1:-1,u=a-n;if(a=(n=Ne(n))+u,s&&_e(u)<me-fe){var c=1,h=1;s.length&&(c=Number(s[0]),h=Number(s[1]));var d=this.attribute,p=d.outerRadius,f=void 0===p?t.outerRadius:p,v=d.innerRadius,g=void 0===v?t.innerRadius:v,y=this.attribute,m=y.outerPadding,_=void 0===m?t.outerPadding:m,b=y.innerPadding;f+=_,g-=void 0===b?t.innerPadding:b;var x=Math.abs(f-g)/2,k=x/f;if(x>fe&&f>fe)return{startAngle:n-l*k*c,endAngle:a+l*k*h,sc:l*k*c,ec:l*k*h}}return{startAngle:n,endAngle:a}}},{key:"getParsePadAngle",value:function(t,e){var i=this.getGraphicTheme(),n=this.attribute,r=n.innerPadding,a=void 0===r?i.innerPadding:r,o=n.outerPadding,s=void 0===o?i.outerPadding:o,l=n.padAngle,u=void 0===l?i.padAngle:l,c=this.attribute,h=c.outerRadius,d=void 0===h?i.outerRadius:h,p=c.innerRadius,f=void 0===p?i.innerRadius:p;d+=s,f-=a;var v=this.attribute.padRadius,g=void 0===v?Me(d*d+f*f):v,y=_e(e-t),m=t,_=e,b=t,x=e,k=u/2,S=y,A=y;if(k>fe&&g>fe){var M=e>t?1:-1,T=we(Number(g)/f*Ae(k)),w=we(Number(g)/d*Ae(k));return(S-=2*T)>fe?(b+=T*=M,x-=T):(S=0,b=x=(t+e)/2),(A-=2*w)>fe?(m+=w*=M,_-=w):(A=0,m=_=(t+e)/2),{outerStartAngle:m,outerEndAngle:_,innerStartAngle:b,innerEndAngle:x,innerDeltaAngle:S,outerDeltaAngle:A}}return{outerStartAngle:m,outerEndAngle:_,innerStartAngle:b,innerEndAngle:x,innerDeltaAngle:S,outerDeltaAngle:A}}},{key:"getGraphicTheme",value:function(){return fh(this).arc}},{key:"updateAABBBounds",value:function(t,e,i,n){this.updatePathProxyAABBBounds(i)||(n?this.updateArcAABBBoundsImprecise(t,e,i):this.updateArcAABBBoundsAccurate(t,e,i));var r=al.graphicService.updateTempAABBBounds(i),a=r.tb1,o=r.tb2;wv(t,e,a),i.union(a),a.setValue(o.x1,o.y1,o.x2,o.y2),this.setWidthHeightWithoutTransform(i);var s=t.lineJoin,l=void 0===s?e.lineJoin:s;return al.graphicService.transformAABBBounds(t,i,e,"miter"===l,this),i}},{key:"updateArcAABBBoundsImprecise",value:function(t,e,i){var n=t.outerRadius,r=void 0===n?e.outerRadius:n,a=t.innerRadius,o=void 0===a?e.innerRadius:a,s=t.outerPadding,l=void 0===s?e.outerPadding:s,u=t.innerPadding;return(r+=l)<(o-=void 0===u?e.innerPadding:u)&&(r=o),i.set(-r,-r,r,r),i}},{key:"updateArcAABBBoundsAccurate",value:function(t,e,i){var n=t.outerRadius,r=void 0===n?e.outerRadius:n,a=t.innerRadius,o=void 0===a?e.innerRadius:a,s=t.outerPadding,l=void 0===s?e.outerPadding:s,u=t.innerPadding;if((r+=l)<(o-=void 0===u?e.innerPadding:u)){var c=r;r=o,o=c}var h=t.endAngle,d=void 0===h?e.endAngle:h,p=t.startAngle,f=void 0===p?e.startAngle:p;if(f>d){var v=f;f=d,d=v}return r<=fe?i.set(0,0,0,0):Math.abs(d-f)>me-fe?i.set(-r,-r,r,r):(Oh(f,d,r,i),Oh(f,d,o,i)),i}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,dg])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,dg])}},{key:"toCustomPath",value:function(){var t,i,n,r,a=_(e,"toCustomPath",this,3)([]);if(a)return a;var o=this.attribute,s=this.getParsedAngle(),l=s.startAngle,u=s.endAngle,c=(null!==(t=o.innerRadius)&&void 0!==t?t:0)-(null!==(i=o.innerPadding)&&void 0!==i?i:0),h=(null!==(n=o.outerRadius)&&void 0!==n?n:0)-(null!==(r=o.outerPadding)&&void 0!==r?r:0),d=_e(u-l),p=u>l;if(h<c){var f=h;h=c,c=f}if(a=new Mu,h<=fe)a.moveTo(0,0);else if(d>=me-fe)a.moveTo(0+h*xe(l),0+h*Ae(l)),a.arc(0,0,h,l,u,!p),c>fe&&(a.moveTo(0+c*xe(u),0+c*Ae(u)),a.arc(0,0,c,u,l,p));else{var v=h*xe(l),g=h*Ae(l),y=c*xe(u),m=c*Ae(u);a.moveTo(0+v,0+g),a.arc(0,0,h,l,u,!p),a.lineTo(0+y,0+m),a.arc(0,0,c,u,l,p),a.closePath()}return a}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Hf);function fg(t){return new pg(t)}pg.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},zf);var vg=["points","cornerRadius"].concat(b(Lf)),gg=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="polygon",i.numberType=Up,i}return h(e,t),o(e,[{key:"isValid",value:function(){return _(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.points;return t&&t.length>=2}},{key:"getGraphicTheme",value:function(){return fh(this).polygon}},{key:"updateAABBBounds",value:function(t,e,i){this.updatePathProxyAABBBounds(i)||this.updatePolygonAABBBoundsImprecise(t,e,i),al.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;var n=t.lineJoin,r=void 0===n?e.lineJoin:n;return al.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}},{key:"updatePolygonAABBBoundsImprecise",value:function(t,e,i){var n=t.points;return(void 0===n?e.points:n).forEach((function(t){i.add(t.x,t.y)})),i}},{key:"_interpolate",value:function(t,e,i,n,r){"points"===t&&(r.points=zh(i,n,e))}},{key:"needUpdateTags",value:function(t){return _(e,"needUpdateTags",this,3)([t,vg])}},{key:"needUpdateTag",value:function(t){return _(e,"needUpdateTag",this,3)([t,vg])}},{key:"toCustomPath",value:function(){var t=_(e,"toCustomPath",this,3)([]);if(t)return t;var i=this.attribute.points;return t=new Mu,i.forEach((function(e,i){0===i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)})),t.closePath(),t}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Hf);function yg(t){return new gg(t)}gg.NOWORK_ANIMATE_ATTR=zf;var mg=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[{x:0,y:0}])).type="shadowroot",i.shadowHost=t,i}return h(e,t),o(e,[{key:"clearUpdateBoundTag",value:function(){_(e,"clearUpdateBoundTag",this,3)([]),this.shadowHost&&this.shadowHost.clearUpdateBoundTag()}},{key:"addUpdateBoundTag",value:function(){_(e,"addUpdateBoundTag",this,3)([]),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}},{key:"addUpdateShapeAndBoundsTag",value:function(){_(e,"addUpdateShapeAndBoundsTag",this,3)([]),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}},{key:"tryUpdateGlobalTransMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.shouldUpdateGlobalMatrix()){var e=this.transMatrix;this._globalTransMatrix?this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f):this._globalTransMatrix=e.clone(),this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}},{key:"doUpdateGlobalMatrix",value:function(){if(this.shadowHost){var t=this.shadowHost.globalTransMatrix;this._globalTransMatrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f)}}},{key:"tryUpdateGlobalAABBBounds",value:function(){return this._globalAABBBounds?this._globalAABBBounds.setValue(this._AABBBounds.x1,this._AABBBounds.y1,this._AABBBounds.x2,this._AABBBounds.y2):this._globalAABBBounds=this._AABBBounds.clone(),this.shadowHost&&this._globalAABBBounds.transformWithMatrix(this.shadowHost.globalTransMatrix),this._globalAABBBounds}}])}(Nf);function _g(t){return new mg(t)}var bg,xg,kg=new(function(){return o((function t(){r(this,t),this.store=new Map}),[{key:"RegisterGraphicCreator",value:function(t,e){this.store.set(t,e),this[t]=e}},{key:"CreateGraphic",value:function(t,e){var i=this.store.get(t);return i?i(e):null}}])}());function Sg(t){return bg||(bg=kg.CreateGraphic("text",{})),bg.initAttributes(t),bg.AABBBounds}var Ag=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Mg=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Tg=function(t,e){return function(i,n){e(i,n,t)}},wg=function(){return o((function t(){r(this,t),this.time=Ml.beforeFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p,f=t.attribute,v=f.background,g=f.backgroundOpacity,y=void 0===g?null!==(p=t.attribute.fillOpacity)&&void 0!==p?p:l.backgroundOpacity:g,m=f.opacity,_=void 0===m?l.opacity:m,b=f.backgroundMode,x=void 0===b?l.backgroundMode:b,k=f.backgroundFit,S=void 0===k?l.backgroundFit:k,A=f.backgroundKeepAspectRatio,M=void 0===A?l.backgroundKeepAspectRatio:A,T=f.backgroundScale,w=void 0===T?l.backgroundScale:T,C=f.backgroundOffsetX,E=void 0===C?l.backgroundOffsetX:C,P=f.backgroundOffsetY,B=void 0===P?l.backgroundOffsetY:P,R=f.backgroundClip,L=void 0===R?l.backgroundClip:R;if(v)if(t.backgroundImg&&t.resources){var I=t.resources.get(v);if("success"!==I.state||!I.data)return;if(e.save(),t.parent&&!t.transMatrix.onlyTranslate()){var D=fh(t.parent).group,O=t.parent.attribute,F=O.scrollX,z=void 0===F?D.scrollX:F,H=O.scrollY,N=void 0===H?D.scrollY:H;e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.translate(z,N)}L&&e.clip();var V=t.AABBBounds;e.setCommonStyle(t,t.attribute,i,n,l),e.globalAlpha=y*_,this.doDrawImage(e,I.data,V,{backgroundMode:x,backgroundFit:S,backgroundKeepAspectRatio:M,backgroundScale:w,backgroundOffsetX:E,backgroundOffsetY:B}),e.restore(),t.transMatrix.onlyTranslate()||e.setTransformForCurrent()}else e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,n,l),e.globalAlpha=y*_,e.fillStyle=v,e.fill(),e.highPerformanceRestore()}},{key:"doDrawImage",value:function(t,e,i,n){var r=n.backgroundMode,a=n.backgroundFit,o=n.backgroundKeepAspectRatio,s=n.backgroundScale,l=void 0===s?1:s,u=n.backgroundOffsetX,c=void 0===u?0:u,h=n.backgroundOffsetY,d=void 0===h?0:h,p=i.width(),f=i.height(),v=p,g=f;if("no-repeat"===r)if(a)if(o){var y=Math.max(p/e.width,f/e.height);t.drawImage(e,i.x1+c,i.y1+d,e.width*y*l,e.height*y*l)}else t.drawImage(e,i.x1,i.y1,i.width(),i.height());else{var m=e.width*l,_=e.height*l;t.drawImage(e,i.x1+c,i.y1+d,m,_)}else{if(a&&"repeat"!==r&&(e.width||e.height)){var b=e.width,x=e.height;"repeat-x"===r?(v=b*(f/x),g=f):"repeat-y"===r&&(g=x*(p/b),v=p);var k=t.dpr,S=qc.allocate({width:v,height:g,dpr:k}),A=S.getContext("2d");A&&(A.inuse=!0,A.clearMatrix(),A.setTransformForCurrent(!0),A.clearRect(0,0,v,g),A.drawImage(e,0,0,v,g),e=S.nativeCanvas),qc.free(S)}var M=t.dpr,T=t.createPattern(e,r);T.setTransform&&T.setTransform(new DOMMatrix([1/M,0,0,1/M,0,0])),t.fillStyle=T,t.translate(i.x1,i.y1),t.fillRect(0,0,p,f),t.translate(-i.x1,-i.y1)}}}])}(),Cg=new wg,Eg=function(){return o((function t(e){r(this,t),this.subRenderContribitions=e,this.time=Ml.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){this._subRenderContribitions||(this._subRenderContribitions=this.subRenderContribitions.getContributions()),this._subRenderContribitions.forEach((function(p){p.render(t,e,i,n,r,a,o,s,l,u,c,h,d)}))}}])}();Eg=Ag([Ps(),Tg(0,Cs(Xs)),Tg(0,Bs(_v)),Mg("design:paramtypes",[Object])],Eg);var Pg=function(){return o((function t(){r(this,t),this.time=Ml.beforeFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p,f;if(t.attribute.clipConfig){var v=t.getClipPath();if(v){var g=!(c||h),y=t.AABBBounds,m=null!==(p=t.attribute.width)&&void 0!==p?p:y.width(),_=null!==(f=t.attribute.height)&&void 0!==f?f:y.height();g&&e.save(),e.beginPath(),!1===v.draw(e,[m,_],i+m/2,n+_/2,0)&&e.closePath(),c&&c(e,t.attribute,l,!0),g&&e.clip()}}}}])}(),Bg=new Pg,Rg=new(function(){return o((function t(){r(this,t),this.time=Ml.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){t.attribute.clipConfig&&t.getClipPath()&&(c||h||e.restore())}}])}());var Lg=function(){return o((function t(){r(this,t),this.time=Ml.afterFillStroke,this.useStyle=!0,this.order=10,this._tempSymbolGraphic=null}),[{key:"createCommonPattern",value:function(t,e,i,n,r){var a=(t-2*e)/2,o=n.dpr,s=qc.allocate({width:t,height:t,dpr:o}),l=s.getContext("2d");if(!l)return null;l.inuse=!0,l.clearMatrix(),l.setTransformForCurrent(!0),l.clearRect(0,0,t,t),r(a,l);var u=n.createPattern(s.nativeCanvas,"repeat");return u.setTransform&&u.setTransform(new DOMMatrix([1/o,0,0,1/o,0,0])),qc.free(s),u}},{key:"createCirclePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(t,e){e.fillStyle=i,e.arc(t,t,t,0,me),e.fill()}))}},{key:"createDiamondPattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(e,n){var r=t/2,a=r;n.fillStyle=i,n.moveTo(r,a-e),n.lineTo(e+r,a),n.lineTo(r,a+e),n.lineTo(r-e,a),n.closePath(),n.fill()}))}},{key:"createRectPattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(t,n){var r=e,a=r;n.fillStyle=i,n.fillRect(r,a,2*t,2*t)}))}},{key:"createVerticalLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(n,r){var a=e;r.fillStyle=i,r.fillRect(a,0,2*n,t)}))}},{key:"createHorizontalLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(n,r){var a=e;r.fillStyle=i,r.fillRect(0,a,t,2*n)}))}},{key:"createBiasLRLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(e,n){n.strokeStyle=i,n.lineWidth=e,n.moveTo(0,0),n.lineTo(t,t);var r=t/2,a=-r;n.moveTo(r,a),n.lineTo(r+t,a+t),n.moveTo(-r,-a),n.lineTo(-r+t,-a+t),n.stroke()}))}},{key:"createBiasRLLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(e,n){n.strokeStyle=i,n.lineWidth=e,n.moveTo(t,0),n.lineTo(0,t);var r=t/2,a=r;n.moveTo(t+r,a),n.lineTo(r,a+t),n.moveTo(t-r,-a),n.lineTo(-r,-a+t),n.stroke()}))}},{key:"createGridPattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(t,n){var r=e,a=r;n.fillStyle=i,n.fillRect(r,a,t,t),n.fillRect(r+t,a+t,t,t)}))}},{key:"initTextureMap",value:function(t,e){this.textureMap=new Map}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){this.textureMap||this.initTextureMap(e,t.stage);var p=t.attribute,f=p.texture,v=void 0===f?l.texture:f,g=p.textureColor,y=void 0===g?l.textureColor:g,m=p.textureSize,_=void 0===m?l.textureSize:m,b=p.texturePadding,x=void 0===b?l.texturePadding:b;v&&this.drawTexture(v,t,e,i,n,l,y,_,x)}},{key:"drawTexture",value:function(t,e,i,n,r,a,o,s,l){var u,c=e.attribute,h=c.textureRatio,d=void 0===h?a.textureRatio:h,p=c.textureOptions,f=void 0===p?null:p,v=this.textureMap.get(t);if(!v)switch(t){case"circle":v=this.createCirclePattern(s,l,o,i);break;case"diamond":v=this.createDiamondPattern(s,l,o,i);break;case"rect":v=this.createRectPattern(s,l,o,i);break;case"vertical-line":v=this.createVerticalLinePattern(s,l,o,i);break;case"horizontal-line":v=this.createHorizontalLinePattern(s,l,o,i);break;case"bias-lr":v=this.createBiasLRLinePattern(s,l,o,i);break;case"bias-rl":v=this.createBiasRLLinePattern(s,l,o,i);break;case"grid":v=this.createGridPattern(s,l,o,i)}if(f&&f.dynamicTexture){var g=f.gridConfig,y=void 0===g?{}:g,m=f.useNewCanvas,_=e.AABBBounds;n=_.x1,r=_.y1;var b,x=i;if(m){var k=(b=qc.allocate({width:_.width(),height:_.height(),dpr:i.dpr})).getContext("2d");k.clearRect(0,0,_.width(),_.height()),n=0,r=0,i=k}if(x.save(),e.parent&&!e.transMatrix.onlyTranslate()){var S=e.parent.attribute,A=S.scrollX,M=void 0===A?0:A,T=S.scrollY,w=void 0===T?0:T;x.setTransformFromMatrix(e.parent.globalTransMatrix),x.translate(M,w,!0)}x.setCommonStyle(e,e.attribute,n,r,a),x.clip();var C=_.width(),E=_.height(),P=l,B=s,R=y.columns?y.columns:Math.ceil(C/B),L=y.rows?y.rows:Math.ceil(E/B),I=y.gutterColumn?y.gutterColumn:2*P,D=y.gutterRow?y.gutterRow:2*P;this._tempSymbolGraphic||(this._tempSymbolGraphic=Fv({}));var O=y.columns?C/y.columns:B,F=y.rows?E/y.rows:B;this._tempSymbolGraphic.setAttributes({size:[O-I,F-D],symbolType:t});for(var z=this._tempSymbolGraphic.getParsedPath(),H=0;H<L;H++)for(var N=0;N<R;N++){var V=n+B/2+N*B,j=r+B/2+H*B;null===(u=f.beforeDynamicTexture)||void 0===u||u.call(f,i,H,N,L,R,d,e,_.width(),_.height()),i.beginPath(),!1===z.draw(i,Math.min(O-I,F-D),V,j,0)&&i.closePath(),i.fillStyle=o,f.dynamicTexture(i,H,N,L,R,d,e,_.width(),_.height())}m&&(x.globalAlpha=1,x.drawImage(b.nativeCanvas,0,0,b.nativeCanvas.width,b.nativeCanvas.height,_.x1,_.y1,_.width()*x.dpr,_.height()*x.dpr)),x.restore()}else if(v)i.highPerformanceSave(),i.setCommonStyle(e,e.attribute,n,r,a),i.fillStyle=v,i.fill(),i.highPerformanceRestore();else if("wave"===t){i.save(),i.setCommonStyle(e,e.attribute,n,r,a),i.clip();var U=e.AABBBounds;(function(t,e,i,n,r,a,o){var s=r.fill,l=void 0===s?"orange":s,u=r.percent,c=void 0===u?.6:u,h=r.frequency,d=void 0===h?4:h,p=r.opacity,f=r.phi,v=void 0===f?0:f,g=r.amplitude,y=void 0===g?10:g;y*=function(t){return t<=.5?4*t-1:-4*t+3}(e);var m=n*(1-c),_=i,b=Math.max(Math.round(_/70),2);t.beginPath(),t.moveTo(0+a,n+o),t.lineTo(0+a,m+o);for(var x=_/d*e,k=_/Math.PI/(2*d),S=0;S<_;S+=b){var A=y*Math.sin((S+x+v)/k+v);t.lineTo(S+a,m+A+o)}t.lineTo(_+a,n+o),t.closePath(),t.fillStyle=l,isFinite(p)&&(t.globalAlpha=p),t.fill()})(i,d,U.width(),U.height(),Object.assign(Object.assign({},f||{}),{fill:o}),n+U.x1-n,r+U.y1-r),i.restore()}}}])}(),Ig=new Lg,Dg=function(){return o((function t(){r(this,t),this.time=Ml.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.attribute,p=d.outerBorder,f=d.innerBorder,v=p&&!1!==p.visible,g=f&&!1!==f.visible;if(v||g){var y=t.attribute,m=y.innerPadding,_=void 0===m?l.innerPadding:m,b=y.outerPadding,x=void 0===b?l.outerPadding:b,k=y.startAngle,S=void 0===k?l.startAngle:k,A=y.endAngle,M=void 0===A?l.endAngle:A,T=y.opacity,w=void 0===T?l.opacity:T,C=y.x,E=void 0===C?l.x:C,P=y.y,B=void 0===P?l.y:P,R=y.scaleX,L=void 0===R?l.scaleX:R,I=y.scaleY,D=void 0===I?l.scaleY:I,O=y.keepStrokeScale,F=void 0===O?l.keepStrokeScale:O,z=t.attribute,H=z.innerRadius,N=void 0===H?l.innerRadius:H,V=z.outerRadius,j=void 0===V?l.outerRadius:V;j+=x,N-=_;var U=function(r,a){var o=!(!r||!r.stroke),s=r.distance,u=void 0===s?l[a].distance:s,c=F?u:$u(e,u,e.dpr),d=u/j,p="outerBorder"===a?1:-1;if(t.setAttributes({outerRadius:j+p*c,innerRadius:N-p*c,startAngle:S-p*d,endAngle:M+p*d}),e.beginPath(),lv(t,e,i,n,j+p*c,N-p*c),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,r,l[a]);else if(o){var f=l[a].opacity;l[a].opacity=w,e.setStrokeStyle(t,r,(E-i)/L,(B-n)/D,l[a]),l[a].opacity=f,e.stroke()}};v&&U(p,"outerBorder"),g&&U(f,"innerBorder"),t.setAttributes({outerRadius:j,innerRadius:N,startAngle:S,endAngle:M})}}}])}(),Og=new Dg,Fg=Ig,zg=Cg,Hg=function(){return o((function t(){r(this,t),this.time=Ml.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.attribute,p=d.outerBorder,f=d.innerBorder,v=p&&!1!==p.visible,g=f&&!1!==f.visible;if(v||g){var y=t.attribute,m=y.radius,_=void 0===m?l.radius:m,b=y.startAngle,x=void 0===b?l.startAngle:b,k=y.endAngle,S=void 0===k?l.endAngle:k,A=y.opacity,M=void 0===A?l.opacity:A,T=y.x,w=void 0===T?l.x:T,C=y.y,E=void 0===C?l.y:C,P=y.scaleX,B=void 0===P?l.scaleX:P,R=y.scaleY,L=void 0===R?l.scaleY:R,I=y.keepStrokeScale,D=void 0===I?l.keepStrokeScale:I,O=function(r,a){var o=!(!r||!r.stroke),s=r.distance,u=void 0===s?l[a].distance:s,c=D?u:$u(e,u,e.dpr),d="outerBorder"===a?1:-1;if(e.beginPath(),e.arc(i,n,_+d*c,x,S),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,r,l[a]);else if(o){var p=l[a].opacity;l[a].opacity=M,e.setStrokeStyle(t,r,(w-i)/B,(E-n)/L,l[a]),l[a].opacity=p,e.stroke()}};v&&O(p,"outerBorder"),g&&O(f,"innerBorder")}}}])}(),Ng=new Hg,Vg=Ig,jg=Cg,Ug=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).time=Ml.beforeFillStroke,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.attribute,p=d.background,f=d.backgroundMode,v=void 0===f?l.backgroundMode:f,g=d.backgroundFit,y=void 0===g?l.backgroundFit:g,m=d.backgroundKeepAspectRatio,_=void 0===m?l.backgroundKeepAspectRatio:m,b=d.backgroundScale,x=void 0===b?l.backgroundScale:b,k=d.backgroundOffsetX,S=void 0===k?l.backgroundOffsetX:k,A=d.backgroundOffsetY,M=void 0===A?l.backgroundOffsetY:A;if(p)if(t.backgroundImg&&t.resources){var T=t.resources.get(p);if("success"!==T.state||!T.data)return;e.highPerformanceSave(),e.setTransformFromMatrix(t.parent.globalTransMatrix,!0);var w=t.AABBBounds;this.doDrawImage(e,T.data,w,{backgroundMode:v,backgroundFit:y,backgroundKeepAspectRatio:_,backgroundScale:x,backgroundOffsetX:S,backgroundOffsetY:M}),e.highPerformanceRestore(),e.setTransformForCurrent()}else e.highPerformanceSave(),e.fillStyle=p,e.fill(),e.highPerformanceRestore()}}])}(wg),Wg=new Ug,Gg=ve/2;function Yg(t,e,i,n,r,a){var o,s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],l=arguments.length>7?arguments[7]:void 0;if(Array.isArray(s)&&(l=s,s=!0),n<0&&(e+=n,n=-n),r<0&&(i+=r,r=-r),Q(a,!0))o=[a=_e(a),a,a,a];else if(Array.isArray(a)){var u,c,h=a;switch(h.length){case 0:o=[0,0,0,0];break;case 1:o=[u=_e(h[0]),u,u,u];break;case 2:case 3:o=[u=_e(h[0]),c=_e(h[1]),u,c];break;default:(o=h)[0]=_e(o[0]),o[1]=_e(o[1]),o[2]=_e(o[2]),o[3]=_e(o[3])}}else o=[0,0,0,0];if(n<0||o[0]+o[1]+o[2]+o[3]<1e-12)return t.rect(e,i,n,r);var d=[e,i],p=[e+n,i],f=[e+n,i+r],v=[e,i+r],g=Math.min(n/2,r/2),y=[Math.min(g,o[0]),Math.min(g,o[1]),Math.min(g,o[2]),Math.min(g,o[3])],m=[d[0]+y[0],d[1]],_=[d[0],d[1]+y[0]],b=[p[0]-y[1],p[1]],x=[p[0],p[1]+y[1]],k=[f[0]-y[2],f[1]],S=[f[0],f[1]-y[2]],A=[v[0]+y[3],v[1]],M=[v[0],v[1]-y[3]];if(t.moveTo(m[0],m[1]),s){if(l&&l[0]?l[0](m[0],m[1],b[0],b[1]):t.lineTo(b[0],b[1]),!wt(b,x)){l&&l[0]&&t.moveTo(b[0],b[1]);var T=b[0],w=b[1]+y[1];t.arc(T,w,y[1],-Gg,0,!1)}if(l&&l[1]?l[1](x[0],x[1],S[0],S[1]):t.lineTo(S[0],S[1]),!wt(k,S)){var C=S[0]-y[2],E=S[1];l&&l[1]&&t.moveTo(S[0],S[1]),t.arc(C,E,y[2],0,Gg,!1)}if(l&&l[2]?l[2](k[0],k[1],A[0],A[1]):t.lineTo(A[0],A[1]),!wt(A,M)){var P=A[0],B=A[1]-y[3];l&&l[2]&&t.moveTo(A[0],A[1]),t.arc(P,B,y[3],Gg,ve,!1)}if(l&&l[3]?l[3](M[0],M[1],_[0],_[1]):t.lineTo(_[0],_[1]),!wt(m,_)){var R=m[0],L=m[1]+y[0];l&&l[3]&&t.moveTo(_[0],_[1]),t.arc(R,L,y[0],ve,ve+Gg,!1)}}else l&&l[0]?l[0](m[0],m[1],b[0],b[1]):t.lineTo(b[0],b[1]),l&&l[1]?l[1](b[0],b[1],k[0],k[1]):t.lineTo(k[0],k[1]),l&&l[2]?l[2](k[0],k[1],A[0],A[1]):t.lineTo(A[0],A[1]),l&&l[2]?l[2](A[0],A[1],m[0],m[1]):t.lineTo(m[0],m[1]);return!l&&t.closePath(),t}var Xg=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Kg=function(){return o((function t(){r(this,t),this.time=Ml.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.attribute,p=d.outerBorder,f=d.innerBorder,v=p&&!1!==p.visible,g=f&&!1!==f.visible;if(v||g){var y=t.attribute,m=y.cornerRadius,_=void 0===m?l.cornerRadius:m,b=y.cornerType,x=void 0===b?l.cornerType:b,k=y.opacity,S=void 0===k?l.opacity:k,A=y.x,M=void 0===A?l.x:A,T=y.y,w=void 0===T?l.y:T,C=y.scaleX,E=void 0===C?l.scaleX:C,P=y.scaleY,B=void 0===P?l.scaleY:P,R=y.x1,L=y.y1,I=y.keepStrokeScale,D=void 0===I?l.keepStrokeScale:I,O=t.attribute,F=O.width,z=O.height;F=(null!=F?F:R-i)||0,z=(null!=z?z:L-n)||0;var H=function(r,a){var o=!(!r||!r.stroke),s="outerBorder"===a?-1:1,u=r.distance,c=void 0===u?l[a].distance:u,d=D?c:$u(e,c,e.dpr),p=i+s*d,f=n+s*d,v=2*d;if(0===_||q(_)&&_.every((function(t){return 0===t}))?(e.beginPath(),e.rect(p,f,F-s*v,z-s*v)):(e.beginPath(),Yg(e,p,f,F-s*v,z-s*v,_,"bevel"!==x)),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,r,l[a]);else if(o){var g=l[a].opacity;l[a].opacity=S,e.setStrokeStyle(t,r,(M-i)/E,(w-n)/B,l[a]),l[a].opacity=g,e.stroke()}};v&&H(p,"outerBorder"),g&&H(f,"innerBorder")}}}])}(),qg=function(){return o((function t(){r(this,t),this.time=Ml.beforeFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p=t.attribute.stroke,f=void 0===p?l.stroke:p;Array.isArray(f)&&f.some((function(t){return!1===t}))&&(d.doStroke=!1)}}])}();qg=Xg([Ps()],qg);var Zg=function(){return o((function t(){r(this,t),this.time=Ml.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.attribute,p=d.x1,f=d.y1,v=d.x,g=void 0===v?l.x:v,y=d.y,m=void 0===y?l.y:y,_=d.stroke,b=void 0===_?l.stroke:_,x=d.cornerRadius,k=void 0===x?l.cornerRadius:x,S=d.cornerType,A=void 0===S?l.cornerType:S,M=t.attribute,T=M.width,w=M.height;if(T=(null!=T?T:p-g)||0,w=(null!=w?w:f-m)||0,Array.isArray(b)&&b.some((function(t){return!1===t}))){if(e.setStrokeStyle(t,t.attribute,i,n,l),!(0===k||q(k)&&k.every((function(t){return 0===t})))){var C,E=0;return Yg(e,i,n,T,w,k,"bevel"!==A,new Array(4).fill(0).map((function(r,a){return function(r,o,s,u){b[a]&&(E===a-1&&b[a]===C||(e.setStrokeStyle(t,Object.assign(Object.assign({},t.attribute),{stroke:b[a]}),i,n,l),e.beginPath(),e.moveTo(r,o),C=b[a]),E=a,e.lineTo(s,u),e.stroke(),3===a&&e.beginPath())}}))),void e.stroke()}if(e.beginPath(),e.moveTo(i,n),b[0]?e.lineTo(i+T,n):e.moveTo(i+T,n),b[1]?e.lineTo(i+T,n+w):e.moveTo(i+T,n+w),b[2]?e.lineTo(i,n+w):e.moveTo(i,n+w),b[3]){var P=b[0]?n-e.lineWidth/2:n;e.lineTo(i,P)}else e.moveTo(i,n);e.stroke()}}}])}();Zg=Xg([Ps()],Zg);var Jg=new Kg,Qg=Ig,$g=Cg,ty=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).time=Ml.afterFillStroke,t.useStyle=!0,t.order=0,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,i,n,r,a,o,s,l,u,c,h,d){return _(e,"drawShape",this,3)([t,i,n,r,a,o,s,l,u,c,h,d])}}])}(Kg),ey=new ty,iy=Cg,ny=function(){return o((function t(){r(this,t),this.time=Ml.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.getParsedPath();if(d){var p=t.attribute,f=p.outerBorder,v=p.innerBorder,g=f&&!1!==f.visible,y=v&&!1!==v.visible;if(g||y){var m=t.attribute,_=m.size,b=void 0===_?l.size:_,x=m.opacity,k=void 0===x?l.opacity:x,S=m.x,A=void 0===S?l.x:S,M=m.y,T=void 0===M?l.y:M,w=m.scaleX,C=void 0===w?l.scaleX:w,E=m.scaleY,P=void 0===E?l.scaleY:E,B=m.keepStrokeScale,R=void 0===B?l.keepStrokeScale:B,L=function(r,a){var o=!(!r||!r.stroke),s=r.distance,u=void 0===s?l[a].distance:s,c=R?u:$u(e,u,e.dpr),p="outerBorder"===a?1:-1;if(e.beginPath(),!1===d.drawOffset(e,b,i,n,p*c)&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,r,l[a]);else if(o){var f=l[a].opacity;l[a].opacity=k,e.setStrokeStyle(t,r,(A-i)/C,(T-n)/P,l[a]),l[a].opacity=f,e.stroke()}};g&&L(f,"outerBorder"),y&&L(v,"innerBorder")}}}}])}(),ry=function(){return o((function t(){r(this,t),this.time=Ml.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p=t.attribute,f=p.clipRange,v=void 0===f?l.clipRange:f,g=p.x,y=void 0===g?l.x:g,m=p.y,_=void 0===m?l.y:m,b=p.z,x=void 0===b?l.z:b,k=p.size,S=void 0===k?l.size:k,A=p.scaleX,M=void 0===A?l.scaleX:A,T=p.scaleY,w=void 0===T?l.scaleY:T,C=t.getParsedPath();C&&v<1&&v>0&&(e.beginPath(),C.drawWithClipRange&&C.drawWithClipRange(e,S,i,n,v,x,(function(r,a){var o,u,c,d;if(t._parsedPath.svgCache){var p=Object.assign({},a);p.fill=null!==(o=a.fill)&&void 0!==o?o:t.attribute.fill,p.opacity=null!==(u=a.opacity)&&void 0!==u?u:t.attribute.opacity,p.fillOpacity=t.attribute.fillOpacity,p.stroke=null!==(c=a.stroke)&&void 0!==c?c:t.attribute.stroke,p.lineWidth=null!==(d=a.lineWidth)&&void 0!==d?d:t.attribute.lineWidth,a=p}a.stroke&&(h?h(e,t.attribute,l):s&&(e.setStrokeStyle(t,a,(y-i)/M,(_-n)/w,l),e.stroke()))})),a&&!C.isSvg&&(h?h(e,t.attribute,l):s&&(e.setStrokeStyle(t,t.attribute,(y-i)/M,(_-n)/w,l),e.stroke())))}}])}(),ay=new ny,oy=new ry,sy=Ig,ly=Cg,uy=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).time=Ml.afterFillStroke,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p,f,v,g;this.textureMap||this.initTextureMap(e,t.stage);var y=(d||{}).attribute,m=void 0===y?t.attribute:y,_=m.texture,b=void 0===_?null!==(p=t.attribute.texture)&&void 0!==p?p:Hh(l,"texture"):_,x=m.textureColor,k=void 0===x?null!==(f=t.attribute.textureColor)&&void 0!==f?f:Hh(l,"textureColor"):x,S=m.textureSize,A=void 0===S?null!==(v=t.attribute.textureSize)&&void 0!==v?v:Hh(l,"textureSize"):S,M=m.texturePadding,T=void 0===M?null!==(g=t.attribute.texturePadding)&&void 0!==g?g:Hh(l,"texturePadding"):M;b&&this.drawTexture(b,t,e,i,n,l,k,A,T)}}])}(Lg),cy={x:0,y:0,z:0,lastModelMatrix:null},hy=function(){return o((function t(){r(this,t)}),[{key:"init",value:function(t){var e=this;t&&(this._renderContribitions=t.getContributions()),this._renderContribitions||(this._renderContribitions=[]),this.builtinContributions||(this.builtinContributions=[]),this.builtinContributions.push(Bg),this.builtinContributions.push(Rg),this.builtinContributions.forEach((function(t){return e._renderContribitions.push(t)})),this._renderContribitions.length&&(this._renderContribitions.sort((function(t,e){return e.order-t.order})),this._beforeRenderContribitions=this._renderContribitions.filter((function(t){return t.time===Ml.beforeFillStroke})),this._afterRenderContribitions=this._renderContribitions.filter((function(t){return t.time===Ml.afterFillStroke})))}},{key:"reInit",value:function(){this.init(this.graphicRenderContributions)}},{key:"beforeRenderStep",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){this._beforeRenderContribitions&&this._beforeRenderContribitions.forEach((function(p){p.supportedAppName&&t.stage&&t.stage.params&&t.stage.params.context&&t.stage.params.context.appName&&!(Array.isArray(p.supportedAppName)?p.supportedAppName:[p.supportedAppName]).includes(t.stage.params.context.appName)||p.drawShape(t,e,i,n,r,a,o,s,l,u,c,h,d)}))}},{key:"afterRenderStep",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){this._afterRenderContribitions&&this._afterRenderContribitions.forEach((function(p){p.supportedAppName&&t.stage&&t.stage.params&&t.stage.params.context&&t.stage.params.context.appName&&!(Array.isArray(p.supportedAppName)?p.supportedAppName:[p.supportedAppName]).includes(t.stage.params.context.appName)||p.drawShape(t,e,i,n,r,a,o,s,l,u,c,h,d)}))}},{key:"drawPathProxy",value:function(t,e,i,n,r,a,o,s){if(!t.pathProxy)return!1;var l=fh(t,null==a?void 0:a.theme)[t.type.replace("3d","")],u=t.attribute,c=u.fill,h=void 0===c?l.fill:c,d=u.stroke,p=void 0===d?l.stroke:d,f=u.opacity,v=void 0===f?l.opacity:f,g=u.fillOpacity,y=void 0===g?l.fillOpacity:g,m=u.lineWidth,_=void 0===m?l.lineWidth:m,b=u.strokeOpacity,x=void 0===b?l.strokeOpacity:b,k=u.visible,S=void 0===k?l.visible:k,A=u.x,M=void 0===A?l.x:A,T=u.y,w=void 0===T?l.y:T,C=iv(v,y,h),E=rv(v,x),P=tv(h),B=ev(p,_);return!S||(!P&&!B||(!(C||E||o||s)||(e.beginPath(),Dl(("function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy).commandList,e,i,n),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,P,B,C,E,l,r,o,s),B&&(s?s(e,t.attribute,l):E&&(e.setStrokeStyle(t,t.attribute,i-M,n-w,l),e.stroke())),P&&(o?o(e,t.attribute,l):C&&(e.setCommonStyle(t,t.attribute,i-M,n-w,l),e.fill())),this.afterRenderStep(t,e,i,n,P,B,C,E,l,r,o,s),!0)))}},{key:"valid",value:function(t,e,i,n){var r=t.attribute,a=r.fill,o=void 0===a?e.fill:a,s=r.background,l=r.stroke,u=void 0===l?e.stroke:l,c=r.opacity,h=void 0===c?e.opacity:c,d=r.fillOpacity,p=void 0===d?e.fillOpacity:d,f=r.lineWidth,v=void 0===f?e.lineWidth:f,g=r.strokeOpacity,y=void 0===g?e.strokeOpacity:g,m=r.visible,_=void 0===m?e.visible:m,b=iv(h,p,o),x=rv(h,y),k=tv(o,s),S=ev(u,v);return!(!t.valid||!_)&&!(!k&&!S)&&!!(b||x||i||n||s)&&{fVisible:b,sVisible:x,doFill:k,doStroke:S}}},{key:"transform",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=t.attribute,a=r.x,o=void 0===a?e.x:a,s=r.y,l=void 0===s?e.y:s,u=r.z,c=void 0===u?e.z:u,h=r.scaleX,d=void 0===h?e.scaleX:h,p=r.scaleY,f=void 0===p?e.scaleY:p,v=r.angle,g=void 0===v?e.angle:v,y=r.postMatrix,m=i.modelMatrix,_=i.camera;cy.x=o,cy.y=l,cy.z=c,cy.lastModelMatrix=m;var b=_&&(n||function(t){var e=t.attribute,i=e.alpha,n=e.beta;return i||n}(t)),x=b?t.transMatrix.onlyTranslate()&&!y:1===d&&1===f&&0===g&&!y;if(b){var k=lf.allocate(),S=lf.allocate();Mv(S,t,e),nf(k,m||k,S),cy.x=0,cy.y=0,cy.z=0,i.modelMatrix=k,i.setTransform(1,0,0,1,0,0,!0),lf.free(S)}if(x&&!m){var A=t.getOffsetXY(e);cy.x+=A.x,cy.y+=A.y,cy.z=c,i.setTransformForCurrent()}else if(b)cy.x=0,cy.y=0,cy.z=0,i.setTransform(1,0,0,1,0,0,!0);else if(_&&i.project){var M=t.getOffsetXY(e);cy.x+=M.x,cy.y+=M.y,this.transformWithoutTranslate(i,cy.x,cy.y,cy.z,d,f,g)}else i.transformFromMatrix(t.transMatrix,!0),cy.x=0,cy.y=0,cy.z=0;return cy}},{key:"transformUseContext2d",value:function(t,e,i,n){var r=n.camera;if(this.camera=r,r){var a=t.AABBBounds,o=a.x2-a.x1,s=a.y2-a.y1,l=n.project(0,0,i),u=n.project(o,0,i),c=n.project(o,s,i),h={x:0,y:0},d={x:o,y:0},p={x:o,y:s};n.camera=null;var f=1/(h.x*(p.y-d.y)-d.x*p.y+p.x*d.y+(d.x-p.x)*h.y),v=-(h.y*(c.x-u.x)-d.y*c.x+p.y*u.x+(d.y-p.y)*l.x)*f,g=(d.y*c.y+h.y*(u.y-c.y)-p.y*u.y+(p.y-d.y)*l.y)*f,y=(h.x*(c.x-u.x)-d.x*c.x+p.x*u.x+(d.x-p.x)*l.x)*f,m=-(d.x*c.y+h.x*(u.y-c.y)-p.x*u.y+(p.x-d.x)*l.y)*f,_=(h.x*(p.y*u.x-d.y*c.x)+h.y*(d.x*c.x-p.x*u.x)+(p.x*d.y-d.x*p.y)*l.x)*f,b=(h.x*(p.y*u.y-d.y*c.y)+h.y*(d.x*c.y-p.x*u.y)+(p.x*d.y-d.x*p.y)*l.y)*f;n.setTransform(v,g,y,m,_,b,!0)}}},{key:"restoreTransformUseContext2d",value:function(t,e,i,n){this.camera&&(n.camera=this.camera)}},{key:"transformWithoutTranslate",value:function(t,e,i,n,r,a,o){var s=t.project(e,i,n);t.translate(s.x,s.y,!1),t.scale(r,a,!1),t.rotate(o,!1),t.translate(-s.x,-s.y,!1),t.setTransformForCurrent()}},{key:"_draw",value:function(t,e,i,n,r,a){var o=n.context;if(o&&!1!==t.attribute.renderable){o.highPerformanceSave();var s=this.transform(t,e,o,i),l=s.x,u=s.y,c=s.z,h=s.lastModelMatrix;this.z=c,this.drawPathProxy(t,o,l,u,n,r)||(this.drawShape(t,o,l,u,n,r,null,null,a),this.z=0,o.modelMatrix!==h&&lf.free(o.modelMatrix),o.modelMatrix=h),o.highPerformanceRestore()}}}])}(),dy=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},py=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},fy=function(t,e){return function(i,n){e(i,n,t)}},vy=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=Ip,i.builtinContributions=[Og,zg,Fg],i.init(t),i}return h(e,t),o(e,[{key:"drawArcTailCapPath",value:function(t,e,i,n,r,a,o,s){var l=s-o,u=t.getParsedAngle(),c=u.startAngle,h=u.endAngle,d=(h=s)>c,p=!1;if(r<a){var f=r;r=a,a=f}var v=sv(t,c,h,a,r);v.outerDeltaAngle;var g=v.xors,y=v.yors,m=v.xirs,_=v.yirs,b=v.limitedOcr,x=v.outerCornerRadiusStart,k=v.outerCornerRadiusEnd,S=v.maxOuterCornerRadius,A=v.xore,M=v.yore,T=v.xire,w=v.yire,C=v.limitedIcr,E=v.innerDeltaAngle,P=v.innerStartAngle,B=v.innerCornerRadiusStart,R=v.innerCornerRadiusEnd,L=v.maxInnerCornerRadius;if(b>fe){var I=Se(x,b),D=Se(k,b),O=ov(m,_,g,y,r,I,Number(d)),F=ov(A,M,T,w,r,D,Number(d));if(b<S&&I===D)e.moveTo(i+O.cx+O.x01,n+O.cy+O.y01),e.arc(i+O.cx,n+O.cy,b,be(O.y01,O.x01),be(F.y01,F.x01),!d);else{var z=h-l-.03,H=be(F.y11,F.x11);e.arc(i,n,r,z,H,!d),D>0&&e.arc(i+F.cx,n+F.cy,D,be(F.y11,F.x11),be(F.y01,F.x01),!d)}}else e.moveTo(i+g,n+y);if(!(a>fe)||E<.001)e.lineTo(i+T,n+w),p=!0;else if(C>fe){var N=Se(B,C),V=Se(R,C),j=ov(T,w,A,M,a,-V,Number(d)),U=ov(g,y,m,_,a,-N,Number(d));if(e.lineTo(i+j.cx+j.x01,n+j.cy+j.y01),C<L&&N===V){var W=be(U.y01,U.x01);e.arc(i+j.cx,n+j.cy,C,be(j.y01,j.x01),W,!d)}else{V>0&&e.arc(i+j.cx,n+j.cy,V,be(j.y01,j.x01),be(j.y11,j.x11),!d);var G=be(j.cy+j.y11,j.cx+j.x11),Y=h-l-.03;e.arc(i,n,a,G,Y,d)}}else e.lineTo(i+a*xe(P),n+a*Ae(P));return p}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l){l=null!=l?l:fh(t,null==a?void 0:a.theme).arc;var u=t.attribute,c=u.fill,h=void 0===c?l.fill:c,d=u.stroke,p=void 0===d?l.stroke:d,f=u.x,v=void 0===f?l.x:f,g=u.y,y=void 0===g?l.y:g,m=u.fillStrokeOrder,_=void 0===m?l.fillStrokeOrder:m,b=this.valid(t,l,o,s);if(b){var x=b.fVisible,k=b.sVisible,S=b.doFill,A=b.doStroke,M=t.attribute,T=M.outerPadding,w=void 0===T?l.outerPadding:T,C=M.innerPadding,E=void 0===C?l.innerPadding:C,P=M.cap,B=void 0===P?l.cap:P,R=M.forceShowCap,L=void 0===R?l.forceShowCap:R,I=t.attribute,D=I.outerRadius,O=void 0===D?l.outerRadius:D,F=I.innerRadius,z=void 0===F?l.innerRadius:F;O+=w,z-=E;var H=0,V=(N(B)&&B||B[0])&&"conical"===h.gradient;if(V){var j=t.getParsedAngle(),U=j.sc,W=j.startAngle,G=j.endAngle;_e(G-W)<me-fe&&(H=U||0,h.startAngle-=H,h.endAngle-=H)}var Y=!1,X=function(t){var e,i=!0;if(N(t,!0)){for(var n=0;n<4;n++)Bh[n]=t,i&&(i=!(null!==(e=Bh[n])&&void 0!==e&&!e));i=t}else if(Array.isArray(t))for(var r=0;r<4;r++)Bh[r]=!!t[r],i&&(i=!!Bh[r]);else Bh[0]=!1,Bh[1]=!1,Bh[2]=!1,Bh[3]=!1;return{isFullStroke:i,stroke:Bh}}(p),K=X.isFullStroke,q=X.stroke;if((S||K)&&(e.beginPath(),lv(t,e,i,n,O,z),Y=!0,e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,S,A,x,k,l,r,o,s),_?(this._runStroke(t,e,i,n,l,A,K,k,s),this._runFill(t,e,i,n,l,S,x,v,y,o)):(this._runFill(t,e,i,n,l,S,x,v,y,o),this._runStroke(t,e,i,n,l,A,K,k,s))),!K&&A&&(e.beginPath(),lv(t,e,i,n,O,z,q),Y||this.beforeRenderStep(t,e,i,n,S,A,x,k,l,r,o,s),s?s(e,t.attribute,l):k&&(e.setStrokeStyle(t,t.attribute,i,n,l),e.stroke())),(N(B)&&B||B[1])&&L){var Z=t.getParsedAngle(),J=Z.startAngle,Q=Z.endAngle;if(_e(Q-J)>=me-fe){e.beginPath();var $=Math.abs(O-z)/2/O,tt=t.attribute,et=tt.endAngle,it=void 0===et?l.endAngle:et,nt=tt.fill,rt=void 0===nt?l.fill:nt,at=it;this.drawArcTailCapPath(t,e,i,n,O,z,at,at+$),Y||this.beforeRenderStep(t,e,i,n,S,A,x,k,l,r,o,s);(function(){if(S){var r=rt;if("conical"===r.gradient){var a=function(t,e,i,n){for(var r=n.stops,a=n.startAngle,o=n.endAngle;i<0;)i+=me;for(;i>me;)i-=me;if(i<a)return r[0].color;if(i>o)return r[0].color;for(var s,l,u=(i-a)/(o-a),c=0;c<r.length;c++)if(r[c].offset>=u){s=r[c-1],l=r[c];break}return u=(u-s.offset)/(l.offset-s.offset),xf(s.color,l.color,u,!1)}(0,0,it,r);o||iv&&(e.setCommonStyle(t,t.attribute,i,n,l),e.fillStyle=a,e.fill())}}})(),A&&(s||k&&(e.setStrokeStyle(t,t.attribute,i,n,l),e.stroke()))}}this.afterRenderStep(t,e,i,n,S,A,x,k,l,r,o,s),V&&(h.startAngle+=H,h.endAngle+=H)}}},{key:"_runFill",value:function(t,e,i,n,r,a,o,s,l,u){a&&(u?u(e,t.attribute,r):o&&(e.setCommonStyle(t,t.attribute,s-i,l-n,r),e.fill()))}},{key:"_runStroke",value:function(t,e,i,n,r,a,o,s,l){a&&o&&(l||s&&(e.setStrokeStyle(t,t.attribute,i,n,r),e.stroke()))}},{key:"draw",value:function(t,e,i,n){var r=fh(t,null==n?void 0:n.theme).arc;this._draw(t,r,!1,i,n,r)}}])}(hy);vy=dy([Ps(),fy(0,Cs(Xs)),fy(0,Bs(uv)),py("design:paramtypes",[Object])],vy);var gy=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},yy=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},my=function(t,e){return function(i,n){e(i,n,t)}},_y=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=Fp,i.builtinContributions=[Ng,jg,Vg],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l=fh(t,null==a?void 0:a.theme).circle,u=t.attribute,c=u.radius,h=void 0===c?l.radius:c,d=u.startAngle,p=void 0===d?l.startAngle:d,f=u.endAngle,v=void 0===f?l.endAngle:f,g=u.x,y=void 0===g?l.x:g,m=u.y,_=void 0===m?l.y:m,b=u.fillStrokeOrder,x=void 0===b?l.fillStrokeOrder:b,k=this.valid(t,l,o,s);if(k){var S=k.fVisible,A=k.sVisible,M=k.doFill,T=k.doStroke;e.beginPath(),e.arc(i,n,h,p,v),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,M,T,S,A,l,r,o,s);var w=function(){M&&(o?o(e,t.attribute,l):S&&(e.setCommonStyle(t,t.attribute,y-i,_-n,l),e.fill()))},C=function(){T&&(s?s(e,t.attribute,l):A&&(e.setStrokeStyle(t,t.attribute,y-i,_-n,l),e.stroke()))};x?(C(),w()):(w(),C()),this.afterRenderStep(t,e,i,n,M,T,S,A,l,r,o,s)}}},{key:"draw",value:function(t,e,i,n){var r=fh(t,null==n?void 0:n.theme).circle;this._draw(t,r,!1,i,n)}}])}(hy);function by(t,e,i,n){if(e.p1){var r=n||{},a=r.offsetX,o=void 0===a?0:a,s=r.offsetY,l=void 0===s?0:s,u=r.offsetZ,c=void 0===u?0:u;if(1===i)e.p2&&e.p3?t.bezierCurveTo(o+e.p1.x,l+e.p1.y,o+e.p2.x,l+e.p2.y,o+e.p3.x,l+e.p3.y,c):t.lineTo(o+e.p1.x,l+e.p1.y,c);else if(e.p2&&e.p3){var h=m(jl(e,i),1)[0];t.bezierCurveTo(o+h.p1.x,l+h.p1.y,o+h.p2.x,l+h.p2.y,o+h.p3.x,l+h.p3.y,c)}else{var d=e.getPointAt(i);t.lineTo(o+d.x,l+d.y,c)}}}function xy(t,e,i,n,r,a,o){var s,l=e.p0,u=n;if(i&&i.originP1===i.originP2&&(l=i.p0),e.defined)n||(t.lineTo(l.x+r,l.y+a,o),u=!n);else{var c,h=e.originP1,d=e.originP2;if(h&&!1!==h.defined&&!i?c=l:h&&!1!==d.defined&&(c=null!==(s=e.p3)&&void 0!==s?s:e.p1),n){u=!n;var p=c?c.x:e.p0.x,f=c?c.y:e.p0.y;t.moveTo(p+r,f+a,o)}else c&&(u=!n,t.lineTo(c.x+r,c.y+a,o))}return u}function ky(t,e,i,n,r){var a=r||{},o=a.offsetX,s=void 0===o?0:o,l=a.offsetY,u=void 0===l?0:l,c=a.offsetZ,h=void 0===c?0:c,d=a.mode,p=void 0===d?"none":d,f=a.drawConnect,v=void 0!==f&&f;if((!v||"none"!==p)&&e){var g=!0,y=e.curves;if(i>=1)if(v){var m,_=!0;y.forEach((function(e,i){e.originP1!==e.originP2?(_=xy(t,e,m,_,s,u,h),m=e):m=e}))}else y.forEach((function(e){e.defined?(g&&t.moveTo(e.p0.x+s,e.p0.y+u,h),by(t,e,1,r),g=!1):g=!0}));else if(!(i<=0)){var b;"x"===n?b=Sl.ROW:"y"===n?b=Sl.COLUMN:"auto"===n&&(b=e.direction);for(var x=i*e.tryUpdateLength(b),k=0,S=!0,A=null,M=0,T=y.length;M<T;M++){var w=y[M],C=w.getLength(b),E=(x-k)/C;if(k+=C,E<0)break;if(v){if(w.originP1===w.originP2){A=w;continue}S=xy(t,w,A,S,s,u,h),A=w}else{if(!w.defined){g=!0;continue}g&&t.moveTo(w.p0.x+s,w.p0.y+u,h),by(t,w,Se(E,1),r),g=!1}}}}}_y=gy([Ps(),my(0,Cs(Xs)),my(0,Bs(hv)),yy("design:paramtypes",[Object])],_y);var Sy=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Ay=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).numberType=Vp,t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){var r=fh(t,null==n?void 0:n.theme).line;this._draw(t,r,!1,i,n)}},{key:"drawSegmentItem",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d,p,f){var v;if(e){t.beginPath(),ky(t,e,l,u,{offsetX:c,offsetY:h,offsetZ:null!==(v=this.z)&&void 0!==v?v:0}),d.cache&&!q(d.cache)&&d.cache.curves.every((function(t){return t.defined}))&&d.attribute.curveType&&d.attribute.curveType.includes("Closed")&&t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(d,o,s);var g=o.x,y=void 0===g?0:g,m=o.x,_=void 0===m?0:m;return!1!==i&&(p?p(t,o,s):r&&(t.setCommonStyle(d,o,y-c,_-h,s),t.fill())),!1!==n&&(f?f(t,o,s):a&&(t.setStrokeStyle(d,o,y-c,_-h,s),t.stroke())),!1}}},{key:"drawLinearLineHighPerformance",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p;e.beginPath();var f=null!==(p=this.z)&&void 0!==p?p:0,v=t.attribute.points,g=v[0];e.moveTo(g.x+o,g.y+s,f);for(var y=1;y<v.length;y++){var m=v[y];e.lineTo(m.x+o,m.y+s,f)}e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l);var _=t.attribute,b=_.x,x=void 0===b?0:b,k=_.x,S=void 0===k?0:k;!1!==i&&(h?h(e,t.attribute,l):r&&(e.setCommonStyle(t,t.attribute,x-o,S-s,l),e.fill())),!1!==n&&(d?d(e,t.attribute,l):a&&(e.setStrokeStyle(t,t.attribute,x-o,S-s,l),e.stroke()))}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l=this,u=fh(t,null==a?void 0:a.theme).line,c=t.attribute,h=c.fill,d=void 0===h?u.fill:h,p=c.stroke,f=void 0===p?u.stroke:p,v=c.fillOpacity,g=void 0===v?u.fillOpacity:v,y=c.strokeOpacity,m=void 0===y?u.strokeOpacity:y,_=c.segments,b=c.points,x=c.closePath,k=c.curveTension,S=void 0===k?u.curveTension:k,A=c.connectedType,M=void 0===A?u.connectedType:A;if(this.valid(t,u,o,s)){var T=t.attribute.curveType,w=void 0===T?u.curveType:T;x&&"linear"===w&&(w="linearClosed");var C=t.attribute,E=C.clipRange,P=void 0===E?u.clipRange:E,B=C.clipRangeByDimension,R=void 0===B?u.clipRangeByDimension:B;if(1===P&&!_&&!b.some((function(t){return!1===t.defined}))&&"linear"===w)return this.drawLinearLineHighPerformance(t,e,!!d,!!f,g,m,i,n,u,r,a,o,s);if(t.shouldUpdateShape()){var L=t.attribute,I=L.points,D=L.segments,O=I;if(D&&D.length){var F,z;if(t.cache=D.map((function(t,e){if(t.points.length<=1&&0===e)return t.points[0]&&(z={endX:t.points[0].x,endY:t.points[0].y,curves:[{defined:!1!==t.points[0].defined}]}),null;1===e?F={x:z.endX,y:z.endY,defined:z.curves[z.curves.length-1].defined}:e>1&&(F.x=z.endX,F.y=z.endY,F.defined=z.curves[z.curves.length-1].defined);var i=Au(q(t.points,M),w,{startPoint:F,curveTension:S});return z=i,i})).filter((function(t){return!!t})),"linearClosed"===w){for(var H,N=0;N<t.cache.length;N++){for(var V=t.cache[N],j=0;j<V.curves.length;j++)if(V.curves[j].defined){H=V.curves[j].p0;break}if(H)break}t.cache[t.cache.length-1]&&t.cache[t.cache.length-1].lineTo(H.x,H.y,!0)}}else{if(!I||!I.length)return t.cache=null,void t.clearUpdateShapeTag();t.cache=Au(q(O,M),w,{curveTension:S})}t.clearUpdateShapeTag()}if(Array.isArray(t.cache)){var U=t.attribute.segments.filter((function(t){return t.points.length}));if(1===U[0].points.length&&U.shift(),1===P){var W=!1;t.cache.forEach((function(r,a){W||(W=l.drawSegmentItem(e,r,!!d,!!f,g,m,U[a],[u,t.attribute],P,R,i,n,t,o,s))}))}else{var G=t.cache.reduce((function(t,e){return t+e.getLength()}),0),Y=P*G,X=0,K=!1;t.cache.forEach((function(r,a){if(!K){var c=r.getLength(),h=(Y-X)/c;X+=c,h>0&&(K=l.drawSegmentItem(e,r,!!d,!!f,g,m,U[a],[u,t.attribute],Se(h,1),R,i,n,t,o,s))}}))}}else this.drawSegmentItem(e,t.cache,!!d,!!f,g,m,t.attribute,u,P,R,i,n,t,o,s)}function q(t,e){return"none"===e?t:t.filter((function(t){return!1!==t.defined}))}}}])}(hy);function My(t,e,i,n){var r=n||{},a=r.offsetX,o=void 0===a?0:a,s=r.offsetY,l=void 0===s?0:s,u=r.offsetZ,c=void 0===u?0:u,h=!0;e.forEach((function(e){e.defined?(h&&t.moveTo(e.p0.x+o,e.p0.y+l,c),by(t,e,1,n),h=!1):h=!0})),h=!0;for(var d=i.length-1;d>=0;d--){var p=i[d];p.defined?(h&&t.lineTo(p.p0.x+o,p.p0.y+l,c),by(t,p,1,n),h=!1):h=!0}t.closePath()}Ay=Sy([Ps()],Ay);var Ty=new uy,wy=Cg,Cy=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Ey=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Py=function(t,e){return function(i,n){e(i,n,t)}},By=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=Op,i.builtinContributions=[Ty,wy],i.init(t),i}return h(e,t),o(e,[{key:"drawLinearAreaHighPerformance",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p,f,v,g=t.attribute.points;if(!(g.length<2)){e.beginPath();var y=null!==(p=this.z)&&void 0!==p?p:0,m=g[0];e.moveTo(m.x+o,m.y+s,y);for(var _=1;_<g.length;_++){var b=g[_];e.lineTo(b.x+o,b.y+s,y)}for(var x=g.length-1;x>=0;x--){var k=g[x];e.lineTo((null!==(f=k.x1)&&void 0!==f?f:k.x)+o,(null!==(v=k.y1)&&void 0!==v?v:k.y)+s,y)}e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,o,s,!!r,!1,i,!1,l,u,h,null,{attribute:t.attribute});var S=t.attribute,A=S.x,M=void 0===A?0:A,T=S.x,w=void 0===T?0:T;!1!==i&&(h?h(e,t.attribute,l):r&&(e.setCommonStyle(t,t.attribute,M-o,w-s,l),e.fill())),this.afterRenderStep(t,e,o,s,!!r,!1,i,!1,l,u,h,null,{attribute:t.attribute}),function(){var i,r;if(n){var a=t.attribute.stroke,u=void 0===a?l&&l.stroke:a;if(q(u)&&(u[0]||u[2])&&!1===u[1])if(e.beginPath(),u[0]){e.moveTo(m.x+o,m.y+s,y);for(var c=1;c<g.length;c++){var h=g[c];e.lineTo(h.x+o,h.y+s,y)}}else if(u[2]){var p=g[g.length-1];e.moveTo(p.x+o,p.y+s,y);for(var f=g.length-2;f>=0;f--){var v=g[f];e.lineTo((null!==(i=v.x1)&&void 0!==i?i:v.x)+o,(null!==(r=v.y1)&&void 0!==r?r:v.y)+s,y)}}d?d(e,t.attribute,l):(e.setStrokeStyle(t,t.attribute,M-o,w-s,l),e.stroke())}}()}}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u,c,h,d,p,f=this,v=fh(t,null==a?void 0:a.theme).area,g=t.attribute,y=g.fill,m=void 0===y?v.fill:y,_=g.stroke;void 0===_&&v.stroke;var b=g.fillOpacity,x=void 0===b?v.fillOpacity:b,k=g.z,S=void 0===k?v.z:k,A=g.strokeOpacity,M=void 0===A?v.strokeOpacity:A,T=g.curveTension,w=void 0===T?v.curveTension:T,C=g.connectedType,E=void 0===C?v.connectedType:C,P=this.valid(t,v,o,s);if(P){var B=P.doFill,R=P.doStroke&&P.sVisible,L=t.attribute,I=L.clipRange,D=void 0===I?v.clipRange:I,O=L.closePath,F=L.points,z=L.segments,H=t.attribute.curveType,N=void 0===H?v.curveType:H;if(O&&"linear"===N&&(N="linearClosed"),1===D&&!z&&!F.some((function(t){return!1===t.defined}))&&"linear"===N)return this.drawLinearAreaHighPerformance(t,e,!!m,R,x,M,i,n,v,r,a,o,s);if(t.shouldUpdateShape()){if(z&&z.length){for(var V,j,U,W=z.map((function(t,e){if(t.points.length<=1&&0===e)return t.points[0]&&(j={endX:t.points[0].x,endY:t.points[0].y}),null;1===e?V={x:j.endX,y:j.endY}:e>1&&(V.x=j.endX,V.y=j.endY);var i=Au(ut(t.points,E),N,{startPoint:V,curveTension:w});return j=i,i})).filter((function(t){return!!t})),G=[],Y=z.length-1;Y>=0;Y--){for(var X=z[Y].points,K=[],q=X.length-1;q>=0;q--)K.push({x:null!==(l=X[q].x1)&&void 0!==l?l:X[q].x,y:null!==(u=X[q].y1)&&void 0!==u?u:X[q].y});if(0!==Y){var Z=z[Y-1].points,J=Z[Z.length-1];J&&K.push({x:null!==(c=J.x1)&&void 0!==c?c:J.x,y:null!==(h=J.y1)&&void 0!==h?h:J.y})}K.length>1&&(U=Au(ut(K,E),"stepBefore"===N?"stepAfter":"stepAfter"===N?"stepBefore":N,{curveTension:w}),G.unshift(U))}t.cacheArea=G.map((function(t,e){return{top:W[e],bottom:t}}))}else{if(!F||!F.length)return t.cacheArea=null,void t.clearUpdateShapeTag();for(var Q=ut(F,E),$=[],tt=Q.length-1;tt>=0;tt--)$.push({x:null!==(d=Q[tt].x1)&&void 0!==d?d:Q[tt].x,y:null!==(p=Q[tt].y1)&&void 0!==p?p:Q[tt].y});var et=Au(Q,N,{curveTension:w}),it=Au($,"stepBefore"===N?"stepAfter":"stepAfter"===N?"stepBefore":N,{curveTension:w});t.cacheArea={top:et,bottom:it}}t.clearUpdateShapeTag()}if(Array.isArray(t.cacheArea)){var nt=t.attribute.segments.filter((function(t){return t.points.length}));if(1===nt[0].points.length&&nt.shift(),1===D){var rt=!1;t.cacheArea.forEach((function(a,l){rt||(rt=f.drawSegmentItem(e,a,B,x,R,M,nt[l],[v,t.attribute],D,i,n,S,t,r,o,s))}))}else{var at=t.cacheArea.reduce((function(t,e){return t+e.top.getLength()}),0),ot=D*at,st=0,lt=!1;t.cacheArea.forEach((function(a,l){if(!lt){var u=a.top.getLength(),c=(ot-st)/u;st+=u,c>0&&(lt=f.drawSegmentItem(e,a,B,x,R,M,nt[l],[v,t.attribute],Se(c,1),i,n,S,t,r,o,s))}}))}}else this.drawSegmentItem(e,t.cacheArea,B,x,R,M,t.attribute,v,D,i,n,S,t,r,o,s)}function ut(t,e){return"connect"!==e?t:t.filter((function(t){return!1!==t.defined}))}}},{key:"draw",value:function(t,e,i,n){var r=fh(t,null==n?void 0:n.theme).area;this._draw(t,r,!1,i,n)}},{key:"drawSegmentItem",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v){return this._drawSegmentItem(t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v)}},{key:"_drawSegmentItem",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v){if(e&&e.top&&e.bottom&&e.top.curves&&e.top.curves.length&&e.bottom.curves&&e.bottom.curves.length){t.beginPath();var g,y,m=d.attribute,_=m.points,b=m.segments,x=Sl.ROW;if(b){var k=b[b.length-1];y=b[0].points[0],g=k.points[k.points.length-1]}else y=_[0],g=_[_.length-1];var S=_e(g.x-y.x),A=_e(g.y-y.y);x=null==g.x1?Sl.ROW:null==g.y1?Sl.COLUMN:Number.isFinite(S+A)?S>A?Sl.ROW:Sl.COLUMN:Sl.ROW,function(t,e,i,n){var r,a=e.top,o=e.bottom;if(a.curves.length===o.curves.length)if(i>=1){for(var s=[],l=[],u=!0,c=0,h=a.curves.length;c<h;c++){var d=a.curves[c];u!==d.defined?(u?(My(t,s,l,n),s.length=0,l.length=0):(s.push(d),l.push(o.curves[h-c-1])),u=!u):u&&(s.push(d),l.push(o.curves[h-c-1]))}My(t,s,l,n)}else if(!(i<=0)){var p=(n||{}).direction,f=a.curves,v=null!==(r=f[f.length-1].p3)&&void 0!==r?r:f[f.length-1].p1,g=_e(v.x-f[0].p0.x),y=_e(v.y-f[0].p0.y);p=null!=p?p:g>y?Sl.ROW:Sl.COLUMN,Number.isFinite(g)||(p=Sl.COLUMN),Number.isFinite(y)||(p=Sl.ROW);for(var m=i*(p===Sl.ROW?g:y),_=0,b=!0,x=[],k=[],S=0,A=a.curves.length;S<A;S++){var M=a.curves[S],T=M.getLength(p),w=(m-_)/T;if(w<0)break;_+=T;var C=null,E=null;b!==M.defined?(b?(My(t,x,k,n),x.length=0,k.length=0):(C=M,E=o.curves[A-S-1]),b=!b):b&&(C=M,E=o.curves[A-S-1]),C&&E&&(w<1&&(C=C.p2&&C.p3?jl(C,w)[0]:Wl(C,w)[0],E=E.p2&&E.p3?jl(E,1-w)[1]:Wl(E,1-w)[1]),C.defined=b,E.defined=b,x.push(C),k.push(E)),C=null,E=null}My(t,x,k,n)}}(t,e,l,{offsetX:u,offsetY:c,offsetZ:h,direction:x}),this.beforeRenderStep(d,t,u,c,!!n,!1,i,!1,s,p,f,null,{attribute:o}),t.setShadowBlendStyle&&t.setShadowBlendStyle(d,o,s);var M=o.x,T=void 0===M?0:M,w=o.x,C=void 0===w?0:w;return!1!==i&&(f?f(t,o,s):n&&(t.setCommonStyle(d,o,T-u,C-c,s),t.fill())),this.afterRenderStep(d,t,u,c,!!n,!1,i,!1,s,p,f,null,{attribute:o}),function(){if(!1!==r)if(v)v(t,o,s);else{var i=o.stroke,n=void 0===i?s&&s[1]&&s[1].stroke:i;q(n)&&(n[0]||n[2])&&!1===n[1]&&(t.beginPath(),ky(t,n[0]?e.top:e.bottom,l,x===Sl.ROW?"x":"y",{offsetX:u,offsetY:c,offsetZ:h})),t.setStrokeStyle(d,o,T-u,C-c,s),t.stroke()}}(),!1}}}])}(hy);By=Cy([Ps(),Py(0,Cs(Xs)),Py(0,Bs(cv)),Ey("design:paramtypes",[Object])],By);var Ry=Ig,Ly=Cg,Iy=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Dy=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Oy=function(t,e){return function(i,n){e(i,n,t)}},Fy=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=jp,i.builtinContributions=[Ly,Ry],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u,c,h=null!==(l=this.tempTheme)&&void 0!==l?l:fh(t,null==a?void 0:a.theme).path,d=t.attribute,p=d.x,f=void 0===p?h.x:p,v=d.y,g=void 0===v?h.y:v,y=d.fillStrokeOrder,m=void 0===y?h.fillStrokeOrder:y,_=null!==(u=this.z)&&void 0!==u?u:0,b=this.valid(t,h,o,s);if(b){var x=b.fVisible,k=b.sVisible,S=b.doFill,A=b.doStroke;if(e.beginPath(),t.pathShape)Dl(t.pathShape.commandList,e,i,n,1,1,_);else Dl((null!==(c=t.attribute.path)&&void 0!==c?c:h.path).commandList,e,i,n,1,1,_);e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),this.beforeRenderStep(t,e,i,n,S,A,x,k,h,r,o,s);var M=function(){A&&(s?s(e,t.attribute,h):k&&(e.setStrokeStyle(t,t.attribute,f-i,g-n,h),e.stroke()))},T=function(){S&&(o?o(e,t.attribute,h):x&&(e.setCommonStyle(t,t.attribute,f-i,g-n,h),e.fill()))};m?(M(),T()):(T(),M()),this.afterRenderStep(t,e,i,n,S,A,x,k,h,r,o,s)}}},{key:"draw",value:function(t,e,i,n){var r=fh(t,null==n?void 0:n.theme).path;this.tempTheme=r,this._draw(t,r,!1,i,n),this.tempTheme=null}}])}(hy);Fy=Iy([Ps(),Oy(0,Cs(Xs)),Oy(0,Bs(fv)),Dy("design:paramtypes",[Object])],Fy);var zy=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Hy=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Ny=function(t,e){return function(i,n){e(i,n,t)}},Vy=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.type="rect",i.numberType=Wp,i.builtinContributions=[Jg,$g,Qg],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l){l=null!=l?l:fh(t,null==a?void 0:a.theme).rect;var u=t.attribute,c=u.fill,h=void 0===c?l.fill:c,d=u.background,p=u.stroke,f=void 0===p?l.stroke:p,v=u.cornerRadius,g=void 0===v?l.cornerRadius:v,y=u.cornerType,m=void 0===y?l.cornerType:y,_=u.opacity,b=void 0===_?l.opacity:_,x=u.fillOpacity,k=void 0===x?l.fillOpacity:x,S=u.lineWidth,A=void 0===S?l.lineWidth:S,M=u.strokeOpacity,T=void 0===M?l.strokeOpacity:M,w=u.visible,C=void 0===w?l.visible:w,E=u.x1,P=u.y1,B=u.x,R=void 0===B?l.x:B,L=u.y,I=void 0===L?l.y:L,D=u.fillStrokeOrder,O=void 0===D?l.fillStrokeOrder:D,F=u.drawStrokeWhenZeroWH,z=void 0===F?l.drawStrokeWhenZeroWH:F,H=t.attribute,N=H.width,V=H.height,j=nv(b,k,N=(null!=N?N:E-R)||0,V=(null!=V?V:P-I)||0,h),U=av(b,T,N,V,z),W=tv(h,d),G=ev(f,A);if(t.valid&&C&&(W||G)&&(j||U||o||s||d)){0===g||q(g)&&g.every((function(t){return 0===t}))?(e.beginPath(),e.rect(i,n,N,V)):(e.beginPath(),Yg(e,i,n,N,V,g,"bevel"!==m));var Y={doFill:W,doStroke:G};e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,W,G,j,U,l,r,o,s,Y),O?(this._runStroke(t,e,i,n,l,Y,U,R,I,s),this._runFill(t,e,i,n,l,Y,j,R,I,o)):(this._runFill(t,e,i,n,l,Y,j,R,I,o),this._runStroke(t,e,i,n,l,Y,U,R,I,s)),this.afterRenderStep(t,e,i,n,W,G,j,U,l,r,o,s)}}},{key:"_runFill",value:function(t,e,i,n,r,a,o,s,l,u){a.doFill&&(u?u(e,t.attribute,r):o&&(e.setCommonStyle(t,t.attribute,s-i,l-n,r),e.fill()))}},{key:"_runStroke",value:function(t,e,i,n,r,a,o,s,l,u){a.doStroke&&(u?u(e,t.attribute,r):o&&(e.setStrokeStyle(t,t.attribute,s-i,l-n,r),e.stroke()))}},{key:"draw",value:function(t,e,i,n){var r=fh(t,null==n?void 0:n.theme).rect;this._draw(t,r,!1,i,n,r)}}])}(hy);Vy=zy([Ps(),Ny(0,Cs(Xs)),Ny(0,Bs(gv)),Hy("design:paramtypes",[Object])],Vy);var jy=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Uy=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Wy=function(t,e){return function(i,n){e(i,n,t)}},Gy=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=Yp,i.builtinContributions=[ay,ly,sy,oy],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l){var u;l=null!=l?l:fh(t,null==a?void 0:a.theme).symbol;var c=t.attribute,h=c.size,d=void 0===h?l.size:h,p=c.x,f=void 0===p?l.x:p,v=c.y,g=void 0===v?l.y:v,y=c.scaleX,m=void 0===y?l.scaleX:y,_=c.scaleY,b=void 0===_?l.scaleY:_,x=c.fillStrokeOrder,k=void 0===x?l.fillStrokeOrder:x,S=c.clipRange,A=void 0===S?l.clipRange:S,M=this.valid(t,l,o,s);if(M){var T=M.fVisible,w=M.sVisible,C=M.doFill,E=M.doStroke,P=t.getParsedPath();if(P){var B=t.attribute.keepDirIn3d,R=void 0===B?l.keepDirIn3d:B,L=null!==(u=this.z)&&void 0!==u?u:0;e.beginPath();var I=i,D=n,O=L,F=e.camera;if(R&&F&&e.project){var z=e.project(i,n,L);e.camera=null,q(d)&&(d[0],d[1]),I=z.x,D=z.y,O=void 0}!1===P.draw(e,d,I,D,O,(function(r,a){var u,c,h,d;if(t._parsedPath.svgCache){var p=Object.assign({},a);p.fill=null!==(u=a.fill)&&void 0!==u?u:t.attribute.fill,p.opacity=null!==(c=a.opacity)&&void 0!==c?c:t.attribute.opacity,p.fillOpacity=t.attribute.fillOpacity,p.stroke=null!==(h=a.stroke)&&void 0!==h?h:t.attribute.stroke,p.lineWidth=null!==(d=a.lineWidth)&&void 0!==d?d:t.attribute.lineWidth,a=p}var v=function(){a.fill&&(o?o(e,t.attribute,l):(e.setCommonStyle(t,a,f-i,g-n,l),e.fill()))},y=function(){a.stroke&&(s?s(e,t.attribute,l):w&&A>=1&&(e.setStrokeStyle(t,a,(f-i)/m,(g-n)/b,l),e.stroke()))};k?(y(),v()):(v(),y())}))&&e.closePath(),e.camera=F,e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,C,E,T,w,l,r,o,s),k?(this._runStroke(t,e,i,n,l,E,w,f,g,P,A,m,b,s),this._runFill(t,e,i,n,l,C,T,f,g,P,o)):(this._runFill(t,e,i,n,l,C,T,f,g,P,o),this._runStroke(t,e,i,n,l,E,w,f,g,P,A,m,b,s)),this.afterRenderStep(t,e,i,n,C,E,T,w,l,r,o,s)}}}},{key:"_runFill",value:function(t,e,i,n,r,a,o,s,l,u,c){a&&!u.isSvg&&(c?c(e,t.attribute,r):o&&(e.setCommonStyle(t,t.attribute,s-i,l-n,r),e.fill()))}},{key:"_runStroke",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d,p){a&&!u.isSvg&&(p?p(e,t.attribute,r):o&&c>=1&&(e.setStrokeStyle(t,t.attribute,(s-i)/h,(l-n)/d,r),e.stroke()))}},{key:"draw",value:function(t,e,i,n){var r=fh(t,null==n?void 0:n.theme).symbol;this._draw(t,r,!1,i,n)}}])}(hy);Gy=jy([Ps(),Wy(0,Cs(Xs)),Wy(0,Bs(yv)),Uy("design:paramtypes",[Object])],Gy);var Yy=function(){return o((function t(){r(this,t),this.pools=[];for(var e=0;e<10;e++)this.pools.push(new _i)}),[{key:"allocate",value:function(t,e,i,n){if(!this.pools.length)return(new _i).setValue(t,e,i,n);var r=this.pools.pop();return r.x1=t,r.y1=e,r.x2=i,r.y2=n,r}},{key:"allocateByObj",value:function(t){if(!this.pools.length)return new _i(t);var e=this.pools.pop();return e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e}},{key:"free",value:function(t){this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}])}(),Xy=new Yy,Ky=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).time=Ml.beforeFillStroke,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d,p,f,v,g,y,m,_,b,x,k,S=t.attribute,A=S.backgroundMode,M=void 0===A?l.backgroundMode:A,T=S.backgroundFit,w=void 0===T?l.backgroundFit:T,C=S.backgroundKeepAspectRatio,E=void 0===C?l.backgroundKeepAspectRatio:C,P=t.attribute.background;if(P){var B,R=function(){"richtext"===t.type&&(e.restore(),e.save(),k&&e.setTransformFromMatrix(k,!0,1))};"richtext"===t.type&&(k=e.currentMatrix.clone(),e.restore(),e.save(),e.setTransformForCurrent());var L=W(P)&&P.background,I=t.transMatrix.onlyTranslate();if(L){var D=t.AABBBounds,O=(null!==(d=P.x)&&void 0!==d?d:D.x1)+(null!==(p=P.dx)&&void 0!==p?p:0),F=(null!==(f=P.y)&&void 0!==f?f:D.y1)+(null!==(v=P.dy)&&void 0!==v?v:0),z=null!==(g=P.width)&&void 0!==g?g:D.width(),H=null!==(y=P.height)&&void 0!==y?y:D.height();if(B=Xy.allocate(O,F,O+z,F+H),P=P.background,!I){var N=B.width(),V=B.height();B.set((null!==(m=P.x)&&void 0!==m?m:0)+(null!==(_=P.dx)&&void 0!==_?_:0),(null!==(b=P.y)&&void 0!==b?b:0)+(null!==(x=P.dy)&&void 0!==x?x:0),N,V)}}else B=t.AABBBounds,I||(B=Sg(Object.assign(Object.assign({},t.attribute),{angle:0,scaleX:1,scaleY:1,x:0,y:0,dx:0,dy:0})).clone());if(t.backgroundImg&&t.resources){var j=t.resources.get(P);if("success"!==j.state||!j.data)return void R();e.highPerformanceSave(),I&&e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.setCommonStyle(t,t.attribute,i,n,l),this.doDrawImage(e,j.data,B,{backgroundMode:M,backgroundFit:w,backgroundKeepAspectRatio:E}),e.highPerformanceRestore(),e.setTransformForCurrent()}else{var U=t.attribute.backgroundCornerRadius;e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,n,l),e.fillStyle=P,U?(Yg(e,B.x1,B.y1,B.width(),B.height(),U,!0),e.fill()):e.fillRect(B.x1,B.y1,B.width(),B.height()),e.highPerformanceRestore()}L&&Xy.free(B),R()}}}])}(wg),qy=new Ky,Zy=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Jy=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Qy=function(t,e){return function(i,n){e(i,n,t)}},$y=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=Xp,i.builtinContributions=[qy],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u,c,h=this,d=fh(t,null==a?void 0:a.theme).text,p=t.attribute;p.text;var f=p.underline,v=void 0===f?d.underline:f,g=p.lineThrough,y=void 0===g?d.lineThrough:g,m=p.keepDirIn3d,_=void 0===m?d.keepDirIn3d:m,b=p.direction,x=void 0===b?d.direction:b,k=p.fontSize,S=void 0===k?d.fontSize:k,A=p.verticalMode,M=void 0===A?d.verticalMode:A,T=p.x,w=void 0===T?d.x:T,C=p.y,E=void 0===C?d.y:C,P=null!==(l=jh(t.attribute.lineHeight,S))&&void 0!==l?l:S,B=this.valid(t,d,o,s);if(B){var R=B.fVisible,L=B.sVisible,I=B.doFill,D=B.doStroke,O=!_,F=this.z||0;e.beginPath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),this.beforeRenderStep(t,e,i,n,I,D,R,L,d,r,o,s),O&&this.transformUseContext2d(t,d,F,e);var z=function(r,a,l,u){var c=i+a,h=n+l;if(u){e.highPerformanceSave(),c+=S;var p=sf.allocate(1,0,0,1,0,0);p.rotateByCenter(Math.PI/2,c,h),e.transformFromMatrix(p,!0),sf.free(p)}D&&(s?s(e,t.attribute,d):L&&(e.setStrokeStyle(t,t.attribute,w-i,E-n,d),e.strokeText(r,c,h,F))),I&&(o?o(e,t.attribute,d):R&&(e.setCommonStyle(t,t.attribute,w-i,E-n,d),e.fillText(r,c,h,F))),u&&(e.highPerformanceRestore(),e.setTransformForCurrent())};if(e.setTextStyleWithoutAlignBaseline(t.attribute,d,F),"horizontal"===x){var H=t.multilineLayout;if(!H)return void e.highPerformanceRestore();var N=H.bbox,V=N.xOffset,j=N.yOffset;D&&(s?s(e,t.attribute,d):L&&(e.setStrokeStyle(t,t.attribute,w-i,E-n,d),H.lines.forEach((function(t){e.strokeText(t.str,(t.leftOffset||0)+V+i,(t.topOffset||0)+j+n,F)})))),I&&(o?o(e,t.attribute,d):R&&(e.setCommonStyle(t,t.attribute,w-i,E-n,d),H.lines.forEach((function(r){e.fillText(r.str,(r.leftOffset||0)+V+i,(r.topOffset||0)+j+n,F),h.drawUnderLine(v,y,t,(r.leftOffset||0)+V+i,(r.topOffset||0)+j+n,r.descent,(r.descent-r.ascent)/2,F,d,e,{width:r.width})}))))}else{var U=t.attribute,W=U.textAlign,G=void 0===W?d.textAlign:W,Y=U.textBaseline,X=void 0===Y?d.textBaseline:Y;if(!M){var K=G;G=null!==(u=t.getBaselineMapAlign()[X])&&void 0!==u?u:"left",X=null!==(c=t.getAlignMapBaseline()[K])&&void 0!==c?c:"top"}t.tryUpdateAABBBounds();var q=t.cache.verticalList;e.textAlign="left",e.textBaseline="top";var Z=P*q.length,J=0;q.forEach((function(t){var e=t.reduce((function(t,e){return t+(e.width||0)}),0);J=ke(e,J)}));var Q=0,$=0;"bottom"===X?$=-Z:"middle"===X&&($=-Z/2),"center"===G?Q-=J/2:"right"===G&&(Q-=J),q.forEach((function(t,e){var i=t.reduce((function(t,e){return t+(e.width||0)}),0),n=J-i,r=Q;"center"===G?r+=n/2:"right"===G&&(r+=n),t.forEach((function(t){var i=t.text,n=t.width,a=t.direction;z(i,Z-(e+1)*P+$,r,a),r+=n}))}))}O&&this.restoreTransformUseContext2d(t,d,F,e),this.afterRenderStep(t,e,i,n,I,D,R,L,d,r,o,s)}}},{key:"draw",value:function(t,e,i,n){var r=fh(t,null==n?void 0:n.theme).text,a=t.attribute.keepDirIn3d,o=!(void 0===a?r.keepDirIn3d:a);this._draw(t,r,o,i,n)}},{key:"drawUnderLine",value:function(t,e,i,n,r,a,o,s,l,u,c){if(!(e+t<=0)){var h=i.attribute,d=h.textAlign,p=void 0===d?l.textAlign:d,f=h.fill,v=void 0===f?l.fill:f,g=h.opacity,y=void 0===g?l.opacity:g,m=h.underlineOffset,_=void 0===m?l.underlineOffset:m,b=h.underlineDash,x=void 0===b?l.underlineDash:b,k=h.fillOpacity,S=void 0===k?l.fillOpacity:k,A=!j(c),M=A?c.width:i.clipedWidth,T=A?0:bv(p,M),w={lineWidth:0,stroke:v,opacity:y,strokeOpacity:S};if(t){w.lineWidth=t,u.setStrokeStyle(i,w,n,r,l),x&&u.setLineDash(x),u.beginPath();var C=r+a+_;u.moveTo(n+T,C,s),u.lineTo(n+T+M,C,s),u.stroke()}if(e){w.lineWidth=e,u.setStrokeStyle(i,w,n,r,l),u.beginPath();var E=r+o;u.moveTo(n+T,E,s),u.lineTo(n+T+M,E,s),u.stroke()}}}}])}(hy);function tm(t,e,i,n){if(e&&e.length){t.moveTo(e[0].x+i,e[0].y+n);for(var r=1;r<e.length;r++)t.lineTo(e[r].x+i,e[r].y+n)}}function em(t,e){return Math.sqrt(t*t+e*e)}function im(t,e,i,n,r){var a=e/i;return{x:t.x-n*a,y:t.y-r*a}}$y=Zy([Ps(),Qy(0,Cs(Xs)),Qy(0,Bs(mv)),Jy("design:paramtypes",[Object])],$y);var nm=Ig,rm=Cg,am=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},om=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},sm=function(t,e){return function(i,n){e(i,n,t)}},lm=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=Up,i.builtinContributions=[rm,nm],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l=fh(t,null==a?void 0:a.theme).polygon,u=t.attribute,c=u.points,h=void 0===c?l.points:c,d=u.cornerRadius,p=void 0===d?l.cornerRadius:d,f=u.x,v=void 0===f?l.x:f,g=u.y,y=void 0===g?l.y:g,m=u.closePath,_=void 0===m?l.closePath:m,b=u.fillStrokeOrder,x=void 0===b?l.fillStrokeOrder:b,k=this.valid(t,l,o,s);if(k){var S=k.fVisible,A=k.sVisible,M=k.doFill,T=k.doStroke;e.beginPath(),p<=0||q(p)&&p.every((function(t){return 0===t}))?tm(e.camera?e:e.nativeContext,h,i,n):function(t,e,i,n,r){var a,o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(e.length<3)tm(t,e,i,n);else{var s=0,l=e.length-1;o||(s+=1,l-=1,t.moveTo(e[0].x+i,e[0].y+n));for(var u=s;u<=l;u++){var c=e[0===u?l:(u-1)%e.length],h=e[u%e.length],d=e[(u+1)%e.length],p=h.x-c.x,f=h.y-c.y,v=h.x-d.x,g=h.y-d.y,y=(Math.atan2(f,p)-Math.atan2(g,v))/2,m=Math.abs(Math.tan(y)),_=Array.isArray(r)?null!==(a=r[u%e.length])&&void 0!==a?a:0:r,b=_/m,x=em(p,f),k=em(v,g),S=Math.min(x,k);b>S&&(b=S,_=S*m);var A=im(h,b,x,p,f),M=im(h,b,k,v,g),T=2*h.x-A.x-M.x,w=2*h.y-A.y-M.y,C=em(T,w),E=im(h,em(b,_),C,T,w),P=Math.atan2(A.y-E.y,A.x-E.x),B=Math.atan2(M.y-E.y,M.x-E.x),R=B-P;R<0&&(P=B,R=-R),R>Math.PI&&(R-=Math.PI),0===u?t.moveTo(A.x+i,A.y+n):t.lineTo(A.x+i,A.y+n),R&&t.arcTo(h.x+i,h.y+n,M.x+i,M.y+n,_),t.lineTo(M.x+i,M.y+n)}o||t.lineTo(e[l+1].x+i,e[l+1].y+n)}}(e.camera?e:e.nativeContext,h,i,n,p,_),_&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,M,T,S,A,l,r,o,s);var w=function(){M&&(o?o(e,t.attribute,l):S&&(e.setCommonStyle(t,t.attribute,v-i,y-n,l),e.fill()))},C=function(){T&&(s?s(e,t.attribute,l):A&&(e.setStrokeStyle(t,t.attribute,v-i,y-n,l),e.stroke()))};x?(C(),w()):(w(),C()),this.afterRenderStep(t,e,i,n,M,T,S,A,l,r,o,s)}}},{key:"draw",value:function(t,e,i,n){var r=fh(t,null==n?void 0:n.theme).polygon;this._draw(t,r,!1,i,n)}}])}(hy);lm=am([Ps(),sm(0,Cs(Xs)),sm(0,Bs(vv)),om("design:paramtypes",[Object])],lm);var um=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},cm=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},hm=function(t,e){return function(i,n){e(i,n,t)}},dm=function(){return o((function t(e){r(this,t),this.groupRenderContribitions=e,this.numberType=Hp}),[{key:"reInit",value:function(){this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(Wg)}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l){var u=t.attribute,c=u.clip,h=u.fill,d=u.stroke,p=u.background;if(c||h||d||p){l=null!=l?l:fh(t,null==a?void 0:a.theme).group;var f=t.attribute,v=f.opacity,g=void 0===v?l.opacity:v,y=f.width,m=void 0===y?l.width:y,_=f.height,b=void 0===_?l.height:_,x=f.fillOpacity,k=void 0===x?l.fillOpacity:x,S=f.strokeOpacity,A=void 0===S?l.strokeOpacity:S,M=f.cornerRadius,T=void 0===M?l.cornerRadius:M,w=f.path,C=void 0===w?l.path:w,E=f.lineWidth,P=void 0===E?l.lineWidth:E,B=f.visible,R=void 0===B?l.visible:B,L=f.fillStrokeOrder,I=void 0===L?l.fillStrokeOrder:L,D=f.cornerType,O=void 0===D?l.cornerType:D,F=f.x,z=void 0===F?l.x:F,H=f.y,N=void 0===H?l.y:H,V=nv(g,k,m,b,h),j=av(g,A,m,b),U=tv(h,p),W=ev(d,P);if(t.valid&&R){if(!c){if(!U&&!W)return;if(!(V||j||o||s||p))return}if(C&&C.length&&r.drawContribution){var G=e.disableFill,Y=e.disableStroke,X=e.disableBeginPath;e.disableFill=!0,e.disableStroke=!0,e.disableBeginPath=!0,C.forEach((function(t){r.drawContribution.getRenderContribution(t).draw(t,r.renderService,r,a)})),e.disableFill=G,e.disableStroke=Y,e.disableBeginPath=X}else 0===T||q(T)&&T.every((function(t){return 0===t}))?(e.beginPath(),e.rect(i,n,m,b)):(e.beginPath(),Yg(e,i,n,m,b,T,"bevel"!==O));this._groupRenderContribitions||(this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(Wg));var K={doFill:U,doStroke:W};e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this._groupRenderContribitions.forEach((function(a){a.time===Ml.beforeFillStroke&&a.drawShape(t,e,i,n,U,W,V,j,l,r,o,s,K)})),c&&e.clip();var Z=function(){K.doFill&&(o?o(e,t.attribute,l):V&&(e.setCommonStyle(t,t.attribute,z-i,N-n,l),e.fill()))},J=function(){K.doStroke&&(s?s(e,t.attribute,l):j&&(e.setStrokeStyle(t,t.attribute,z-i,N-n,l),e.stroke()))};I?(J(),Z()):(Z(),J()),this._groupRenderContribitions.forEach((function(a){a.time===Ml.afterFillStroke&&a.drawShape(t,e,i,n,U,W,V,j,l,r,o,s)}))}}}},{key:"draw",value:function(t,e,i,n){var r,a,o=i.context;if(o){var s=t.attribute,l=s.clip,u=s.baseOpacity,c=void 0===u?1:u,h=s.drawMode,d=o.nativeContext,p=o.canvas.nativeCanvas;if(h>0){var f=t.attribute,v=f.x,g=f.y,y=f.width,m=f.height,_=o.canvas,b=al.global.createCanvas({width:_.width,height:_.height,dpr:1}),x=b.getContext("2d"),k=o.nativeContext.getTransform();x.setTransform(k.a,k.b,k.c,k.d,k.e,k.f),1===h&&(x.save(),x.clearRect(0,0,_.width,_.height),x.beginPath(),x.rect(v,g,y,m),x.clip(),x.drawImage(_.nativeCanvas,0,0,_.width,_.height,0,0,_.displayWidth,_.displayHeight),x.restore()),o.nativeContext=x,_.nativeCanvas=b}l?o.save():o.highPerformanceSave();var S=o.baseGlobalAlpha;o.baseGlobalAlpha*=c;var A=o.modelMatrix;if(o.camera){var M=fh(t,null==n?void 0:n.theme).group,T=lf.allocate(),w=lf.allocate();Mv(w,t,M),nf(T,A||T,w),o.modelMatrix=T,lf.free(w),o.setTransform(1,0,0,1,0,0,!0)}else o.transformFromMatrix(t.transMatrix,!0);o.beginPath(),n.skipDraw?this.drawShape(t,o,0,0,i,n,(function(){return!1}),(function(){return!1})):this.drawShape(t,o,0,0,i,null,null,null);var C,E=t.attribute,P=E.scrollX,B=E.scrollY;if((P||B)&&o.translate(P,B),n&&n.renderInGroup&&(C=n.renderInGroup(null===(r=n.renderInGroupParams)||void 0===r?void 0:r.skipSort,t,i,null===(a=n.renderInGroupParams)||void 0===a?void 0:a.nextM)),o.modelMatrix!==A&&lf.free(o.modelMatrix),o.modelMatrix=A,o.baseGlobalAlpha=S,h>0){var R=t.attribute,L=R.x,I=R.y,D=R.width,O=R.height,F=o.nativeContext,z=o.canvas.nativeCanvas;d.save(),d.setTransform(o.dpr,0,0,o.dpr,0,0,!0),1===h&&F.rect(L,I,D,O),d.drawImage(z,0,0,z.width,z.height,0,0,o.canvas.displayWidth,o.canvas.displayHeight);var H=F.getTransform();d.setTransform(H.a,H.b,H.c,H.d,H.e,H.f),o.nativeContext=d,o.canvas.nativeCanvas=p,d.restore()}C&&C.then?C.then((function(){l?o.restore():o.highPerformanceRestore()})):l?o.restore():o.highPerformanceRestore()}}}])}();dm=um([Ps(),hm(0,Cs(Xs)),hm(0,Bs(dv)),cm("design:paramtypes",[Object])],dm);var pm=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},fm=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},vm=function(t,e){return function(i,n){e(i,n,t)}},gm=["","repeat-x","repeat-y","repeat"],ym=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).graphicRenderContributions=t,i.numberType=Np,i.builtinContributions=[ey,iy],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l=fh(t).image,u=t.attribute,c=u.repeatX,h=void 0===c?l.repeatX:c,d=u.repeatY,p=void 0===d?l.repeatY:d,f=u.x,v=void 0===f?l.x:f,g=u.y,y=void 0===g?l.y:g,m=u.cornerRadius,_=void 0===m?l.cornerRadius:m,b=u.fillStrokeOrder,x=void 0===b?l.fillStrokeOrder:b,k=u.cornerType,S=void 0===k?l.cornerType:k,A=u.image,M=this.valid(t,l,o);if(M){var T=M.fVisible,w=M.sVisible,C=M.doFill,E=M.doStroke;if(A&&t.resources){var P=t.resources.get(A);if("success"===P.state){var B=t.width,R=t.height;e.beginPath();var L=!1;0===_||q(_)&&_.every((function(t){return 0===t}))?e.rect(i,n,B,R):(Yg(e,i,n,B,R,_,"bevel"!==S),L=!0),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l);var I=function(){if(C)if(o)o(e,t.attribute,l);else if(T){e.setCommonStyle(t,t.attribute,i,n,l);var r=0;if("repeat"===h&&(r|=1),"repeat"===p&&(r|=2),r){var a=e.createPattern(P.data,gm[r]);e.fillStyle=a,e.translate(i,n,!0),e.fillRect(0,0,B,R),e.translate(-i,-n,!0)}else e.drawImage(P.data,i,n,B,R)}},D=function(){E&&(s?s(e,t.attribute,l):w&&(e.setStrokeStyle(t,t.attribute,v-i,y-n,l),e.stroke()))};x?(D(),L&&(e.save(),e.clip()),this.beforeRenderStep(t,e,i,n,C,!1,T,!1,l,r,o),I(),L&&e.restore()):(L&&(e.save(),e.clip()),this.beforeRenderStep(t,e,i,n,C,!1,T,!1,l,r,o),I(),L&&e.restore(),D()),this.afterRenderStep(t,e,i,n,C,!1,T,!1,l,r,o)}}}}},{key:"draw",value:function(t,e,i){var n=t.attribute.image;if(n&&t.resources){var r=t.resources.get(n);if("loading"===r.state&&K(n))Eh.improveImageLoading(n);else if("success"===r.state)if(e.drawParams.context){var a=fh(t).image;this._draw(t,a,!1,i)}}}}])}(hy);ym=pm([Ps(),vm(0,Cs(Xs)),vm(0,Bs(pv)),fm("design:paramtypes",[Object])],ym);var mm=Symbol.for("IncrementalDrawContribution"),_m=Symbol.for("ArcRender"),bm=Symbol.for("AreaRender"),xm=Symbol.for("CircleRender"),km=Symbol.for("GraphicRender"),Sm=Symbol.for("GroupRender"),Am=Symbol.for("LineRender"),Mm=Symbol.for("PathRender"),Tm=Symbol.for("PolygonRender"),wm=Symbol.for("RectRender"),Cm=Symbol.for("SymbolRender"),Em=Symbol.for("TextRender"),Pm=Symbol.for("RichTextRender"),Bm=Symbol.for("GlyphRender"),Rm=Symbol.for("ImageRender"),Lm=Symbol.for("DrawContribution"),Im=function(t,e,i,n){var r,a=!1,o=!1;if(e.forEachChildren((function(t){return!(a=t.numberType===Dp)})),e.forEachChildren((function(t){return!(o=!!t.findFace)})),a){var s=e.getChildren(),l=b(s);l.sort((function(t,e){for(var i,n,r,a,o=(null!==(n=null!==(i=t.attribute.startAngle)&&void 0!==i?i:0+t.attribute.endAngle)&&void 0!==n?n:0)/2,s=(null!==(a=null!==(r=e.attribute.startAngle)&&void 0!==r?r:0+e.attribute.endAngle)&&void 0!==a?a:0)/2;o<0;)o+=me;for(;s<0;)s+=me;return s-o})),l.forEach((function(t){t._next=null,t._prev=null})),e.removeAllChild(),e.update(),l.forEach((function(t){e.appendChild(t)})),n.hack_pieFace="outside",(r=i(a,o))&&r.graphic||(n.hack_pieFace="inside",r=i(a,o)),r&&r.graphic||(n.hack_pieFace="top",r=i(a,o)),e.removeAllChild(),s.forEach((function(t){t._next=null,t._prev=null})),s.forEach((function(t){e.appendChild(t)}))}else if(o){var u=e.getChildren(),c=u.map((function(e){return{ave_z:e.findFace().vertices.map((function(i){var n;return t.view(i[0],i[1],null!==(n=i[2]+e.attribute.z)&&void 0!==n?n:0)[2]})).reduce((function(t,e){return t+e}),0),g:e}}));c.sort((function(t,e){return e.ave_z-t.ave_z})),e.removeAllChild(),c.forEach((function(t){t.g._next=null,t.g._prev=null})),e.update(),c.forEach((function(t){e.add(t.g)})),r=i(a,o),e.removeAllChild(),u.forEach((function(t){t._next=null,t._prev=null})),e.update(),u.forEach((function(t){e.add(t)}))}else r=i(a,o);return r},Dm=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Om=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Fm=Symbol.for("DrawItemInterceptor"),zm=new _i,Hm=new _i,Nm=function(){return o((function t(){r(this,t),this.order=1}),[{key:"afterDrawItem",value:function(t,e,i,n,r){return null==t.attribute.shadowRootIdx&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0||(t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0)&&this.drawItem(t,e,i,n,r),!1}},{key:"beforeDrawItem",value:function(t,e,i,n,r){return null==t.attribute.shadowRootIdx&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0||(t.attribute.shadowRootIdx<0||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0)&&this.drawItem(t,e,i,n,r),!1}},{key:"drawItem",value:function(t,e,i,n,r){if(!t.shadowRoot)return!1;var a=i.context;if(a.highPerformanceSave(),a.transformFromMatrix(t.transMatrix,!0),n.dirtyBounds&&n.backupDirtyBounds){zm.copy(n.dirtyBounds),Hm.copy(n.backupDirtyBounds);var o=t.globalTransMatrix.getInverse();n.dirtyBounds.copy(n.backupDirtyBounds).transformWithMatrix(o),n.backupDirtyBounds.copy(n.dirtyBounds)}return n.renderGroup(t.shadowRoot,i,sf.allocate(1,0,0,1,0,0)),a.highPerformanceRestore(),n.dirtyBounds&&n.backupDirtyBounds&&(n.dirtyBounds.copy(zm),n.backupDirtyBounds.copy(Hm)),!0}}])}(),Vm=function(){return o((function t(){r(this,t),this.order=1}),[{key:"afterDrawItem",value:function(t,e,i,n,r){return t.attribute._debug_bounds&&this.drawItem(t,e,i,n,r),!1}},{key:"drawItem",value:function(t,e,i,n,r){if(!t.attribute._debug_bounds)return!1;var a=i.context;a.highPerformanceSave(),t.parent&&a.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&a.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);var o=t.AABBBounds;return!0!==t.attribute._debug_bounds&&t.attribute._debug_bounds(a,t),a.strokeRect(o.x1,o.y1,o.width(),o.height()),a.highPerformanceRestore(),!0}}])}(),jm=function(){return o((function t(){r(this,t),this.order=1,this.interceptors=[new Nm,new Wm,new Um,new Vm]}),[{key:"afterDrawItem",value:function(t,e,i,n,r){if((!t.in3dMode||i.in3dInterceptor)&&!t.shadowRoot&&!t.attribute._debug_bounds&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(var a=0;a<this.interceptors.length;a++)if(this.interceptors[a].afterDrawItem&&this.interceptors[a].afterDrawItem(t,e,i,n,r))return!0;return!1}},{key:"beforeDrawItem",value:function(t,e,i,n,r){if((!t.in3dMode||i.in3dInterceptor)&&!t.shadowRoot&&!t.attribute._debug_bounds&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(var a=0;a<this.interceptors.length;a++)if(this.interceptors[a].beforeDrawItem&&this.interceptors[a].beforeDrawItem(t,e,i,n,r))return!0;return!1}}])}();jm=Dm([Ps(),Om("design:paramtypes",[])],jm);var Um=function(){return o((function t(){r(this,t),this.order=1}),[{key:"beforeDrawItem",value:function(t,e,i,n,r){return!this.processing&&(t.baseGraphic?this.beforeDrawInteractive(t,e,i,n,r):this.beforeSetInteractive(t,e,i,n,r))}},{key:"beforeSetInteractive",value:function(t,e,i,n,r){var a=t.interactiveGraphic;if(t.attribute.globalZIndex){a||(a=t.clone(),t.interactiveGraphic=a,a.baseGraphic=t),a.setAttributes({globalZIndex:0,zIndex:t.attribute.globalZIndex},!1,{skipUpdateCallback:!0}),i.stage.tryInitInteractiveLayer();var o=i.stage.getLayer("_builtin_interactive");return o&&this.getShadowRoot(o).add(a),!0}if(a){i.stage.tryInitInteractiveLayer();var s=i.stage.getLayer("_builtin_interactive");s&&this.getShadowRoot(s).removeChild(a),t.interactiveGraphic=null,a.baseGraphic=null}return!1}},{key:"beforeDrawInteractive",value:function(t,e,i,n,r){for(var a=t.baseGraphic,o=!!a.stage,s=a.parent;o&&s&&s.stage!==s;)o=!!s.stage,s=s.parent;if(!o){var l=i.stage.getLayer("_builtin_interactive");return l&&this.getShadowRoot(l).removeChild(t),!0}if(a){this.processing=!0;var u=i.context;return u.highPerformanceSave(),u.setTransformFromMatrix(a.parent.globalTransMatrix,!0),a.isContainer?n.renderGroup(a,i,a.parent.globalTransMatrix):n.renderItem(a,i),u.highPerformanceRestore(),this.processing=!1,!0}return!1}},{key:"getShadowRoot",value:function(t){var e,i=t.getElementById("_interactive_group");return i||((i=kg.CreateGraphic("group",{})).id="_interactive_group",t.add(i)),null!==(e=i.shadowRoot)&&void 0!==e?e:i.attachShadow()}}])}(),Wm=function(){return o((function t(){r(this,t),this.order=1}),[{key:"beforeDrawItem",value:function(t,e,i,n,r){if(!t.in3dMode||i.in3dInterceptor)return!1;i.in3dInterceptor=!0;var a=e.drawParams,o=a.context,s=a.stage;o.canvas,o.save(),this.initCanvasCtx(o),o.camera=s.camera;var l=o.currentMatrix;l.a/=o.dpr,l.b/=o.dpr,l.c/=o.dpr,l.d/=o.dpr,l.e/=o.dpr,l.f/=o.dpr;var u=lf.allocate();ef(u,l);var c=o.modelMatrix;if(c){if(u){var h=lf.allocate();o.modelMatrix=nf(h,c,u)}}else o.modelMatrix=u;return o.setTransform(1,0,0,1,0,0,!0),t.isContainer?Im(o,t,(function(e,r){return n.renderGroup(t,i,t.parent.globalTransMatrix,!e&&r)}),i):n.renderItem(t,i),o.camera=null,o.restore(),o.modelMatrix!==c&&lf.free(o.modelMatrix),o.modelMatrix=c,i.in3dInterceptor=!1,!0}},{key:"initCanvasCtx",value:function(t){t.setTransformForCurrent()}}])}(),Gm=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Ym=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Xm=function(t,e){return function(i,n){e(i,n,t)}},Km=Symbol.for("RenderService"),qm=function(){return o((function t(e){r(this,t),this.drawContribution=e}),[{key:"prepare",value:function(t){var e=this;t&&this.renderTreeRoots.forEach((function(i){e._prepare(i,t)}))}},{key:"_prepare",value:function(t,e){var i=this;t.forEachChildren((function(t){i._prepare(t,e)})),t.update({bounds:e,trans:!0})}},{key:"prepareRenderList",value:function(){}},{key:"beforeDraw",value:function(t){}},{key:"draw",value:function(t){this.drawContribution.draw(this,Object.assign({},this.drawParams))}},{key:"afterDraw",value:function(t){this.drawContribution.afterDraw&&this.drawContribution.afterDraw(this,Object.assign({},this.drawParams))}},{key:"reInit",value:function(){this.drawContribution.reInit()}},{key:"render",value:function(t,e){this.renderTreeRoots=t,this.drawParams=e;var i=e.updateBounds;this.prepare(i),this.prepareRenderList(),this.beforeDraw(e),this.draw(e),this.afterDraw(e),this.drawParams=null}}])}();qm=Gm([Ps(),Xm(0,Cs(Lm)),Ym("design:paramtypes",[Object])],qm);var Zm=new ys((function(t){t(Km).to(qm)})),Jm=Symbol.for("PickerService"),Qm=Symbol.for("GlobalPickerService"),$m=Symbol.for("PickItemInterceptor"),t_=Symbol.for("PickServiceInterceptor"),e_=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},i_=function(){return o((function t(){r(this,t),this.order=1}),[{key:"afterPickItem",value:function(t,e,i,n,r){if(t.graphic){for(var a=t.graphic;a.parent;)a=a.parent;a.shadowHost&&(t.params={shadowTarget:t.graphic},t.graphic=a.shadowHost)}return t}}])}();i_=e_([Ps()],i_);var n_=function(){return o((function t(){r(this,t),this.order=1}),[{key:"afterPickItem",value:function(t,e,i,n,r){return t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx?this._pickItem(t,e,i,n,r):null}},{key:"beforePickItem",value:function(t,e,i,n,r){return t.attribute.shadowRootIdx<0?this._pickItem(t,e,i,n,r):null}},{key:"_pickItem",value:function(t,e,i,n,r){var a;if(!t.shadowRoot)return null;var o=(r||{}).parentMatrix;if(!o)return null;var s=e.pickContext;s.highPerformanceSave();var l=null===(a=fh(t))||void 0===a?void 0:a[t.type],u=t.attribute.shadowPickMode,c=void 0===u?null==l?void 0:l.shadowPickMode:u,h=t.shadowRoot,d=sf.allocateByObj(o),p=new De(d.a*i.x+d.c*i.y+d.e,d.b*i.x+d.d*i.y+d.f),f=e.pickGroup(h,p,d,n);return s.highPerformanceRestore(),!f.graphic&&f.group&&"full"===c&&(f.graphic=f.group),f}}])}();n_=e_([Ps()],n_);var r_=function(){return o((function t(){r(this,t),this.order=1}),[{key:"beforePickItem",value:function(t,e,i,n,r){var a=t.baseGraphic;if(a&&a.parent){var o=new De(i.x,i.y),s=e.pickContext;s.highPerformanceSave();var l=a.parent.globalTransMatrix;l.transformPoint(o,o);var u=a.isContainer?e.pickGroup(a,o.clone(),l,n):e.pickItem(a,o.clone(),l,n);return s.highPerformanceRestore(),u}return null}}])}();r_=e_([Ps()],r_);var a_=function(){return o((function t(){r(this,t),this.order=1}),[{key:"beforePickItem",value:function(t,e,i,n,r){if(!t.in3dMode||n.in3dInterceptor)return null;var a=e.pickContext,o=t.stage;if(!a||!o)return null;if(n.in3dInterceptor=!0,a.save(),this.initCanvasCtx(a),a.camera=o.camera,t.isContainer){var s=Im(a,t,(function(){return e.pickGroup(t,i,r.parentMatrix,n)}),n);return a.camera=null,n.in3dInterceptor=!1,a.restore(),s}return a.restore(),null}},{key:"initCanvasCtx",value:function(t){t.setTransformForCurrent()}}])}();a_=e_([Ps()],a_);var o_=new ys((function(t,e,i){i(Jm)||(t(Qm).toSelf(),t(Jm).toService(Qm)),t(a_).toSelf().inSingletonScope(),t($m).toService(a_),t(n_).toSelf().inSingletonScope(),t($m).toService(n_),t(r_).toSelf().inSingletonScope(),t($m).toService(r_),qs(t,$m),t(i_).toSelf().inSingletonScope(),t(t_).toService(i_),qs(t,t_)})),s_=new ys((function(t){t(Kp).to(Tv),t(qp).toConstantValue(kg)})),l_=Symbol.for("AutoEnablePlugins"),u_=Symbol.for("PluginService"),c_=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},h_=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},d_=function(t,e){return function(i,n){e(i,n,t)}},p_=function(){return o((function t(e){r(this,t),this.autoEnablePlugins=e,this.onStartupFinishedPlugin=[],this.onRegisterPlugin=[],this.actived=!1}),[{key:"active",value:function(t,e){var i=this;this.stage=t,this.actived=!0;var n=e.pluginList;n&&yc.isBound(l_)&&this.autoEnablePlugins.getContributions().forEach((function(t){n.includes(t.name)&&i.register(t)}))}},{key:"findPluginsByName",value:function(t){var e=[];return this.onStartupFinishedPlugin.forEach((function(i){i.name===t&&e.push(i)})),this.onRegisterPlugin.forEach((function(i){i.name===t&&e.push(i)})),e}},{key:"register",value:function(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.push(t):"onRegister"===t.activeEvent&&(this.onRegisterPlugin.push(t),t.activate(this))}},{key:"unRegister",value:function(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1):"onRegister"===t.activeEvent&&this.onRegisterPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1),t.deactivate(this)}},{key:"release",value:function(){var t=this;this.onStartupFinishedPlugin.forEach((function(e){e.deactivate(t)})),this.onStartupFinishedPlugin=[],this.onRegisterPlugin.forEach((function(e){e.deactivate(t)})),this.onRegisterPlugin=[]}}])}();p_=c_([Ps(),d_(0,Cs(Xs)),d_(0,Bs(l_)),h_("design:paramtypes",[Object])],p_);var f_=new ys((function(t){t(u_).to(p_),function(t,e){t(Xs).toDynamicValue((function(t){var i=t.container;return new Ks(e,i)})).whenTargetNamed(e)}(t,l_)})),v_=new ys((function(t){qs(t,nl)})),g_=new ys((function(t){t(vc).to(gc).inSingletonScope(),qs(t,vc)})),y_=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},m_=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__=function(){return o((function t(){r(this,t),this.type="static",this.offscreen=!1,this.global=al.global}),[{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"init",value:function(t,e,i){if(this.layer=t,this.window=e,i.main)this.main=!0,this.context=e.getContext(),this.canvas=this.context.getCanvas();else{var n;this.main=!1,i.canvasId&&(n=this.global.getElementById(i.canvasId)),n||(n=this.global.createCanvas({width:e.width,height:e.height})),n.style&&(n.style["pointer-events"]="none");var r=e.getContext().getCanvas().nativeCanvas,a=bc({nativeCanvas:n,width:e.width,height:e.height,dpr:e.dpr,id:i.canvasId,canvasControled:!0,container:e.getContainer(),x:r.offsetLeft,y:r.offsetTop});a.applyPosition(),this.canvas=a,this.context=a.getContext()}}},{key:"resize",value:function(t,e){this.canvas.resize(t,e)}},{key:"resizeView",value:function(t,e){}},{key:"render",value:function(t,e,i){var n;if(!this.main){var r=this.window.getContext().getCanvas().nativeCanvas;!r||this.canvas.x===r.offsetLeft&&this.canvas.y===r.offsetTop||(this.canvas.x=r.offsetLeft,this.canvas.y=r.offsetTop,this.canvas.applyPosition())}e.renderService.render(t,Object.assign(Object.assign({context:this.context,clear:null!==(n=e.background)&&void 0!==n?n:"#ffffff"},e),i))}},{key:"merge",value:function(t){var e=this;t.forEach((function(t){var i=t.getContext().canvas.nativeCanvas;e.context.drawImage(i,0,0)}))}},{key:"prepare",value:function(t,e){}},{key:"drawTo",value:function(t,e,i){var n,r=t.getContext();i.renderService.render(e,Object.assign(Object.assign({context:r},i),{clear:i.clear?null!==(n=i.background)&&void 0!==n?n:"#fff":void 0}))}},{key:"getContext",value:function(){return this.context}},{key:"release",value:function(){this.canvas.release()}}])}();__=y_([Ps(),m_("design:paramtypes",[])],__);var b_=new ys((function(t){t(__).toSelf(),t(Xf).toService(__)}));var x_=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};function k_(t,e,i){var n={},r=[];return t.forEachChildren((function(t){var i=t.attribute.zIndex,a=void 0===i?e:i;n[a]?n[a].push(t):(n[a]=[t],r.push(a))}),i),r.sort((function(t,e){return i?e-t:t-e})),{childMap:n,zIdxArray:r}}function S_(t,e,i){var n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=!1;a?o=!0:t.forEachChildren((function(t,i){var r=t.attribute.zIndex,a=void 0===r?e:r;if(0===i)n=a;else if(n!==a)return o=!0,!0;return!1}),r);if(o)for(var s=k_(t,e,r),l=s.childMap,u=s.zIdxArray,c=!1,h=0;h<u.length&&!c;h++){var d=l[u[h]];a&&d.sort((function(t,e){var i,n;return(r?-1:1)*((null!==(i=e.attribute.z)&&void 0!==i?i:0)-(null!==(n=t.attribute.z)&&void 0!==n?n:0))}));for(var p=0;p<d.length;p++)if(i(d[p],p)){c=!0;break}}else t.forEachChildren(i,r)}function A_(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return x_(this,void 0,void 0,f().m((function e(){return f().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,t.forEachChildrenAsync(i,n);case 1:return e.a(2)}}),e)})))}function M_(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=!1;t.forEachChildren((function(t,e){var n=t.attribute.zIndex;if(0===e);else if(void 0!==(void 0===n?i:n))return r=!0,!0;return!1}),n);var a=null,o=!1;if(r)for(var s=k_(t,i,n),l=s.childMap,u=s.zIdxArray,c=!1,h=0;h<u.length&&!c;h++)for(var d=l[u[h]],p=0;p<d.length;p++){if(o){c=!0,a=d[p];break}d[p]._uid!==e||(o=!0)}else t.forEachChildren((function(t){return o?(a=t,!0):(t._uid===e&&(o=!0),!1)}),n);return a}var T_=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},w_=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},C_=function(t,e){return function(i,n){e(i,n,t)}},E_=function(){return o((function t(e,i){var n=this;r(this,t),this.contributions=e,this.drawItemInterceptorContributions=i,this._renderInGroup=function(t,e,i,r){var a;t?e.forEachChildren((function(t){i.break||(t.isContainer?n.renderGroup(t,i,r):n.renderItem(t,i))})):S_(e,Du.zIndex,(function(t){i.break||(t.isContainer?n.renderGroup(t,i,r):n.renderItem(t,i))}),!1,!!(null===(a=i.context)||void 0===a?void 0:a.camera))},this.currentRenderMap=new Map,this.defaultRenderMap=new Map,this.styleRenderMap=new Map,this.dirtyBounds=new mi,this.backupDirtyBounds=new mi,this.global=al.global,this.layerService=al.layerService,q(this.contributions)||(this.contributions=[this.contributions]),this.init()}),[{key:"reInit",value:function(){this.init(),this.contributions.forEach((function(t){t.reInit()}))}},{key:"init",value:function(){var t=this;this.contributions.forEach((function(e){if(e.style){var i=t.styleRenderMap.get(e.style)||new Map;i.set(e.numberType,e),t.styleRenderMap.set(e.style,i)}else t.defaultRenderMap.set(e.numberType,e)})),this.InterceptorContributions=this.drawItemInterceptorContributions.getContributions().sort((function(t,e){return t.order-e.order}))}},{key:"prepareForDraw",value:function(t,e){e.updateBounds?this.useDirtyBounds=!0:this.useDirtyBounds=!e.stage.params.optimize.disableCheckGraphicWidthOutRange}},{key:"draw",value:function(t,e){var i,n=this;this.prepareForDraw(t,e),e.drawContribution=this,this.currentRenderMap=this.styleRenderMap.get(e.renderStyle)||this.defaultRenderMap,this.currentRenderService=t;var r=e.context,a=e.stage,o=e.viewBox,s=e.transMatrix;if(r){var l=this.dirtyBounds.setValue(0,0,o.width(),o.height());if(a.dirtyBounds&&!a.dirtyBounds.empty()){var u=Ze(l,a.dirtyBounds,!1);l.x1=Math.floor(u.x1),l.y1=Math.floor(u.y1),l.x2=Math.ceil(u.x2),l.y2=Math.ceil(u.y2)}var c=r.dpr%1;(c||.5!==c)&&(l.x1=Math.floor(l.x1*r.dpr)/r.dpr,l.y1=Math.floor(l.y1*r.dpr)/r.dpr,l.x2=Math.ceil(l.x2*r.dpr)/r.dpr,l.y2=Math.ceil(l.y2*r.dpr)/r.dpr),this.backupDirtyBounds.copy(l),r.reset(!1),r.save(),r.setClearMatrix(s.a,s.b,s.c,s.d,s.e,s.f),r.clearMatrix(!1),r.translate(o.x1,o.y1,!0),r.beginPath(),r.rect(l.x1,l.y1,l.width(),l.height()),r.clip(),a.camera&&(this.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),this.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0)),this.clearScreen(t,r,e),(null===(i=t.drawParams)||void 0===i?void 0:i.stage)&&t.drawParams.stage.hooks.afterClearScreen.call(t.drawParams),t.renderTreeRoots.sort((function(t,e){var i,n;return(null!==(i=t.attribute.zIndex)&&void 0!==i?i:Du.zIndex)-(null!==(n=e.attribute.zIndex)&&void 0!==n?n:Du.zIndex)})).forEach((function(t){t.isContainer?n.renderGroup(t,e,sf.allocate(1,0,0,1,0,0)):n.renderItem(t,e)})),r.restore(),r.draw()}}},{key:"doRegister",value:function(){throw new Error("暂不支持")}},{key:"_findNextGraphic",value:function(t){for(var e=t.parent,i=t._uid;e;){var n=M_(e,i,Du.zIndex);if(n)return n;i=e._uid,e=e.parent}return null}},{key:"renderGroup",value:function(t,e,i,n){if(!e.break&&!1!==t.attribute.visibleAll){if(t.incremental&&(null==e.startAtId||e.startAtId===t._uid))return e.break=!0,void this._increaseRender(t,e);if(!this.useDirtyBounds||$e(t.AABBBounds,this.dirtyBounds,!1)||"empty"===t.attribute.boundsMode){var r,a=i;if(this.useDirtyBounds){r=Xy.allocateByObj(this.dirtyBounds);var o=t.transMatrix;a=sf.allocateByObj(i).multiply(o.a,o.b,o.c,o.d,o.e,o.f),this.dirtyBounds.copy(this.backupDirtyBounds).transformWithMatrix(a.getInverse())}e.isGroupScroll=!(!t.attribute.scrollX&&!t.attribute.scrollY),this.renderItem(t,e,{renderInGroupParams:{skipSort:n,nextM:a},renderInGroup:this._renderInGroup}),this.useDirtyBounds&&(this.dirtyBounds.copy(r),Xy.free(r),sf.free(a))}}}},{key:"_increaseRender",value:function(t,e){var i=e.layer,n=e.stage,r=i.subLayers,a=r.get(t._uid);a||(a={layer:this.layerService.createLayer(n),zIndex:r.size,group:t},r.set(t._uid,a));var o=a.layer.getNativeHandler().getContext(),s=a.drawContribution||yc.get(mm);s.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),s.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0),s.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:s,clear:"transparent",layer:a.layer,context:o,startAtId:t._uid,break:!1})),a.drawContribution=s;var l=this._findNextGraphic(t);if(l)if(l.isContainer&&l.incremental)this._increaseRender(l,e);else{var u=r.get(l._uid);u||(u={layer:this.layerService.createLayer(n),zIndex:r.size},r.set(l._uid,u));var c=u.layer.getNativeHandler().getContext();this.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:s,clear:"transparent",layer:u.layer,context:c,startAtId:l._uid,break:!1}))}}},{key:"getRenderContribution",value:function(t){var e;return e||(e=this.selectRenderByNumberType(t.numberType,t)),e||(e=this.selectRenderByType(t.type)),e}},{key:"renderItem",value:function(t,e,i){if(this.InterceptorContributions.length)for(var n=0;n<this.InterceptorContributions.length;n++){var r=this.InterceptorContributions[n];if(r.beforeDrawItem&&r.beforeDrawItem(t,this.currentRenderService,e,this,i))return}var a=this.getRenderContribution(t);if(a){var o,s=!1;if(e.isGroupScroll){var l=t.parent.attribute,u=l.scrollX,c=void 0===u?0:u,h=l.scrollY,d=void 0===h?0:h;s=!0,this.scrollMatrix||(this.scrollMatrix=sf.allocate(1,0,0,1,0,0)),this.scrollMatrix.translate(-c,-d)}if(s&&(o=this.dirtyBounds.clone().transformWithMatrix(this.scrollMatrix)),!this.useDirtyBounds||t.isContainer||"empty"===t.attribute.boundsMode||$e(t.AABBBounds,null!=o?o:this.dirtyBounds,!1)){var p=null!=e.startAtId&&t._uid!==e.startAtId;if(t._uid===e.startAtId&&(e.startAtId=null),i&&(i.skipDraw=p),p?t.isContainer&&a.draw(t,this.currentRenderService,e,i):a.draw(t,this.currentRenderService,e,i),s&&t.parent){var f=t.parent.attribute,v=f.scrollX,g=void 0===v?0:v,y=f.scrollY,m=void 0===y?0:y;this.scrollMatrix&&this.scrollMatrix.translate(g,m)}if(this.InterceptorContributions.length)for(var _=0;_<this.InterceptorContributions.length;_++){var b=this.InterceptorContributions[_];if(b.afterDrawItem&&b.afterDrawItem(t,this.currentRenderService,e,this))return}}else if(s&&t.parent){var x=t.parent.attribute,k=x.scrollX,S=void 0===k?0:k,A=x.scrollY,M=void 0===A?0:A;this.scrollMatrix&&this.scrollMatrix.translate(S,M)}}}},{key:"selectRenderByType",value:function(t){return Ot.getInstance().warn("未知错误，不应该走到这里"),null}},{key:"selectRenderByNumberType",value:function(t,e){var i;if(e.attribute.renderStyle){var n=this.styleRenderMap.get(e.attribute.renderStyle);i=n&&n.get(t)}return i||this.currentRenderMap.get(t)||this.defaultRenderMap.get(t)}},{key:"clearScreen",value:function(t,e,i){var n,r,a,o=i.clear,s=i.viewBox,l=s.width(),u=s.height();if(o){e.clearRect(0,0,l,u),(null===(n=t.drawParams)||void 0===n?void 0:n.stage)&&t.drawParams.stage.hooks.afterClearRect.call(t.drawParams);var c=null===(r=t.drawParams)||void 0===r?void 0:r.stage;if(c&&(e.globalAlpha=null!==(a=c.attribute.opacity)&&void 0!==a?a:1),c&&c.backgroundImg&&c.resources){var h=c.resources.get(o);h&&"success"===h.state&&h.data&&e.drawImage(h.data,0,0,l,u)}else e.fillStyle=tc(e,o,{AABBBounds:{x1:0,y1:0,x2:0+l,y2:0+u}},0,0),e.fillRect(0,0,l,u)}}},{key:"afterDraw",value:function(t,e){}}])}();E_=T_([Ps(),C_(0,Es(km)),C_(1,Cs(Xs)),C_(1,Bs(Fm)),w_("design:paramtypes",[Array,Object])],E_);var P_=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},B_=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).numberType=Vp,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,i,n,r,a,o,s,l){if(t.incremental&&a.multiGraphicOptions){var u=a.multiGraphicOptions,c=u.startAtIdx,h=u.length,d=t.attribute.segments,p=void 0===d?[]:d;if(c>p.length)return;var f=fh(t).line,v=t.attribute,g=v.fill,y=void 0===g?f.fill:g,m=v.stroke,b=void 0===m?f.stroke:m,x=v.opacity,k=void 0===x?f.opacity:x,S=v.fillOpacity,A=void 0===S?f.fillOpacity:S,M=v.strokeOpacity,T=void 0===M?f.strokeOpacity:M,w=v.lineWidth,C=void 0===w?f.lineWidth:w,E=v.visible,P=void 0===E?f.visible:E,B=iv(k,A,y),R=rv(k,T),L=tv(y),I=ev(b,C);if(!t.valid||!P)return;if(!L&&!I)return;if(!(B||R||s||l))return;for(var D=a.context,O=c;O<c+h;O++)this.drawIncreaseSegment(t,D,p[O-1],p[O],t.attribute.segments[O],[f,t.attribute],n,r)}else _(e,"drawShape",this,3)([t,i,n,r,a,o,s,l])}},{key:"drawIncreaseSegment",value:function(t,e,i,n,r,a,o,s){n&&(e.beginPath(),function(t,e,i,n){var r=n||{},a=r.offsetX,o=void 0===a?0:a,s=r.offsetY,l=void 0===s?0:s,u=e?e.points[e.points.length-1]:i.points[0];t.moveTo(u.x+o,u.y+l),i.points.forEach((function(e){!1!==e.defined?t.lineTo(e.x+o,e.y+l):t.moveTo(e.x+o,e.y+l)}))}(e.nativeContext,i,n,{offsetX:o,offsetY:s}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,r,a),e.setStrokeStyle(t,r,o,s,a),e.stroke())}}])}(Ay);B_=P_([Ps()],B_);var R_=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},L_=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).numberType=Op,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,i,n,r,a,o,s){if(t.incremental&&a.multiGraphicOptions){var l=a.multiGraphicOptions,u=l.startAtIdx,c=l.length,h=t.attribute.segments,d=void 0===h?[]:h;if(u>d.length)return;var p=fh(t).area,f=t.attribute,v=f.fill,g=void 0===v?p.fill:v,y=f.fillOpacity,m=void 0===y?p.fillOpacity:y,b=f.opacity,x=void 0===b?p.opacity:b,k=f.visible,S=void 0===k?p.visible:k,A=iv(x,m,g),M=tv(g);if(!t.valid||!S)return;if(!M)return;if(!A&&!s)return;for(var T=u;T<u+c;T++)this.drawIncreaseSegment(t,i,d[T-1],d[T],t.attribute.segments[T],[p,t.attribute],n,r)}else _(e,"drawShape",this,3)([t,i,n,r,a,o,s])}},{key:"drawIncreaseSegment",value:function(t,e,i,n,r,a,o,s){n&&(e.beginPath(),function(t,e,i,n){for(var r=n||{},a=r.offsetX,o=void 0===a?0:a,s=r.offsetY,l=void 0===s?0:s,u=i.points,c=[],h=0;h<u.length;h++)u[h].defined;c.push(u),c.forEach((function(i,n){var r,a,s,u,c=e&&0===n?e.points[e.points.length-1]:i[0];t.moveTo(c.x+o,c.y+l),i.forEach((function(e){!1!==e.defined?t.lineTo(e.x+o,e.y+l):t.moveTo(e.x+o,e.y+l)}));for(var h=i.length-1;h>=0;h--){var d=i[h];t.lineTo(null!==(r=d.x1)&&void 0!==r?r:d.x,null!==(a=d.y1)&&void 0!==a?a:d.y)}t.lineTo(null!==(s=c.x1)&&void 0!==s?s:c.x,null!==(u=c.y1)&&void 0!==u?u:c.y),t.closePath()}))}(e.camera?e:e.nativeContext,i,n,{offsetX:o,offsetY:s}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,r,a),e.setCommonStyle(t,r,o,s,a),e.fill())}}])}(By);L_=R_([Ps()],L_);var I_,D_=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},O_=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},F_=function(t,e){return function(i,n){e(i,n,t)}},z_=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};!function(t){t[t.NORMAL=0]="NORMAL",t[t.STOP=1]="STOP"}(I_||(I_={}));var H_=function(t){function e(t,i,a,o){var s;return r(this,e),(s=n(this,e,[t,o])).contributions=t,s.lineRender=i,s.areaRender=a,s.drawItemInterceptorContributions=o,s.rendering=!1,s.currFrameStartAt=0,s.currentIdx=0,s.status=I_.NORMAL,s.checkingForDrawPromise=null,s.hooks={completeDraw:new il([])},s.defaultRenderMap.set(s.lineRender.numberType,s.lineRender),s.defaultRenderMap.set(s.areaRender.numberType,s.areaRender),s}return h(e,t),o(e,[{key:"draw",value:function(t,e){return z_(this,void 0,void 0,f().m((function i(){var n,r,a,o=this;return f().w((function(i){for(;;)switch(i.n){case 0:if(!this.checkingForDrawPromise){i.n=1;break}return i.a(2);case 1:return this.lastRenderService=t,this.lastDrawContext=e,this.checkingForDrawPromise=this.checkForDraw(e),i.n=2,this.checkingForDrawPromise;case 2:if(n=i.v,this.checkingForDrawPromise=null,!n){i.n=3;break}return i.a(2);case 3:this.currentRenderService=t,r=e.context,a=e.viewBox,r&&(r.inuse=!0,r.clearMatrix(),r.setTransformForCurrent(!0),r.save(),e.restartIncremental&&this.clearScreen(this.currentRenderService,r,e),r.translate(a.x1,a.y1,!0),r.save(),t.renderTreeRoots.sort((function(t,e){var i,n;return(null!==(i=t.attribute.zIndex)&&void 0!==i?i:Du.zIndex)-(null!==(n=e.attribute.zIndex)&&void 0!==n?n:Du.zIndex)})).forEach((function(t){o.renderGroup(t,e)})),this.hooks.completeDraw.tap("top-draw",(function(){r.restore(),r.restore(),r.draw(),r.inuse=!1,o.rendering=!1})));case 4:return i.a(2)}}),i,this)})))}},{key:"_increaseRender",value:function(t,e){return z_(this,void 0,void 0,f().m((function i(){return f().w((function(i){for(;;)switch(i.n){case 0:return this.rendering=!0,i.n=1,this._renderIncrementalGroup(t,e);case 1:return i.a(2)}}),i,this)})))}},{key:"_renderIncrementalGroup",value:function(t,e){return z_(this,void 0,void 0,f().m((function i(){var n=this;return f().w((function(i){for(;;)switch(i.n){case 0:return this.count=t.count,i.n=1,new Promise((function(i){n.renderItem(t,e,{drawingCb:function(){return z_(n,void 0,void 0,f().m((function n(){var r,a=this;return f().w((function(n){for(;;)switch(n.n){case 0:if(2===t.count){n.n=2;break}return n.n=1,A_(t,Du.zIndex,(function(i,n){if(a.status===I_.STOP)return!0;if(i.isContainer)return!1;if(n<a.currentIdx)return!1;var r=a.currFrameStartAt+t.incremental;return n<r&&(a.currentIdx=n+1,a.renderItem(i,e)),n===r-1&&(a.currFrameStartAt=a.currentIdx,a.waitToNextFrame())}));case 1:i(!1),n.n=8;break;case 2:if(!(r=t.getChildAt(0)).incremental||!r.attribute.segments){n.n=6;break}r.incrementalAt||(r.incrementalAt=0);case 3:if(!(r.incrementalAt<r.attribute.segments.length)){n.n=5;break}return e.multiGraphicOptions={startAtIdx:r.incrementalAt,length:r.incremental},this.renderItem(r,e),r.incrementalAt+=r.incremental,n.n=4,this.waitToNextFrame();case 4:n.n=3;break;case 5:n.n=7;break;case 6:this.renderItem(r,e);case 7:i(!1);case 8:return n.a(2)}}),n,this)})))}})}));case 1:this.hooks.completeDraw.call();case 2:return i.a(2)}}),i,this)})))}},{key:"waitToNextFrame",value:function(){return z_(this,void 0,void 0,f().m((function t(){var e=this;return f().w((function(t){for(;;)if(0===t.n)return t.a(2,new Promise((function(t){e.global.getRequestAnimationFrame()((function(){t(!1)}))})))}),t)})))}},{key:"checkForDraw",value:function(t){return z_(this,void 0,void 0,f().m((function e(){var i;return f().w((function(e){for(;;)switch(e.n){case 0:if(i=this.rendering,!t.restartIncremental){e.n=2;break}return i=!1,e.n=1,this.forceStop();case 1:this.resetToInit();case 2:return e.a(2,i)}}),e,this)})))}},{key:"forceStop",value:function(){return z_(this,void 0,void 0,f().m((function t(){var e=this;return f().w((function(t){for(;;)switch(t.n){case 0:if(!this.rendering){t.n=1;break}return this.status=I_.STOP,t.n=1,new Promise((function(t){e.hooks.completeDraw.tap("stopCb",(function(){e.status=I_.NORMAL,e.hooks.completeDraw.taps=e.hooks.completeDraw.taps.filter((function(t){return"stopCb"!==t.name})),t(!1)}))}));case 1:return t.a(2)}}),t,this)})))}},{key:"resetToInit",value:function(){this.currFrameStartAt=0,this.currentIdx=0}},{key:"renderGroup",value:function(t,e){return z_(this,void 0,void 0,f().m((function i(){var n,r=this;return f().w((function(i){for(;;)switch(i.n){case 0:if(e.break||!1===t.attribute.visibleAll){i.n=5;break}if(!t.incremental||e.startAtId!==t._uid){i.n=2;break}return i.n=1,this._increaseRender(t,e);case 1:n=void(e.break=!0),i.n=4;break;case 2:return i.n=3,new Promise((function(i){r.renderItem(t,e,{drawingCb:function(){return z_(r,void 0,void 0,f().m((function n(){var r=this;return f().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,A_(t,Du.zIndex,(function(t){return z_(r,void 0,void 0,f().m((function i(){return f().w((function(i){for(;;)switch(i.n){case 0:if(e.break){i.n=1;break}if(!t.isContainer){i.n=1;break}return i.n=1,this.renderGroup(t,e);case 1:return i.a(2)}}),i,this)})))}));case 1:i(!1);case 2:return n.a(2)}}),n)})))}})}));case 3:n=void i.v;case 4:return i.a(2,n);case 5:return i.a(2)}}),i,this)})))}}])}(E_);H_=D_([Ps(),F_(0,Es(km)),F_(1,Cs(B_)),F_(2,Cs(L_)),F_(3,Cs(Xs)),F_(3,Bs(Fm)),O_("design:paramtypes",[Array,Object,Object,Object])],H_);var N_=new ys((function(t){t(wg).toSelf().inSingletonScope(),t(Lg).toSelf().inSingletonScope(),t(Lm).to(E_),t(mm).to(H_),t(Sm).to(dm).inSingletonScope(),t(km).toService(Sm),qs(t,dv),t(Eg).toSelf().inSingletonScope(),qs(t,_v),qs(t,km),t(jm).toSelf().inSingletonScope(),t(Fm).toService(jm),qs(t,Fm)}));function V_(){V_.__loaded||(V_.__loaded=!0,yc.load($f),yc.load(s_),yc.load(Zm),yc.load(o_),yc.load(f_),function(t){t.load(v_),t.load(g_),t.load(b_)}(yc),function(t){t.load(N_)}(yc))}V_.__loaded=!1,V_();var j_=yc.get(rl);al.global=j_;var U_=yc.get(Gf);al.graphicUtil=U_;var W_=yc.get(Wf);al.transformUtil=W_;var G_=yc.get(Kp);al.graphicService=G_;var Y_=yc.get(Km);al.renderService=Y_;var X_=yc.get(Yf);al.layerService=X_;var K_,q_=function(){return o((function t(){var e=this;r(this,t),this.name="AutoRenderPlugin",this.activeEvent="onRegister",this._uid=gs.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=function(t){t.glyphHost&&(t=t.glyphHost),t.stage===e.pluginService.stage&&null!=t.stage&&t.stage.renderNextFrame()}}),[{key:"activate",value:function(t){this.pluginService=t;var e=this.pluginService.stage;e&&(e.graphicService.hooks.onAttributeUpdate.tap(this.key,this.handleChange),e.graphicService.hooks.onSetStage.tap(this.key,this.handleChange),e.graphicService.hooks.onRemove.tap(this.key,this.handleChange))}},{key:"deactivate",value:function(t){var e=this,i=function(t){return t.filter((function(t){return t.name!==e.key}))},n=this.pluginService.stage;n&&(n.graphicService.hooks.onAttributeUpdate.taps=i(n.graphicService.hooks.onAttributeUpdate.taps),n.graphicService.hooks.onSetStage.taps=i(n.graphicService.hooks.onSetStage.taps),n.graphicService.hooks.onRemove.taps=i(n.graphicService.hooks.onRemove.taps))}}])}(),Z_=function(){return o((function t(){var e=this;r(this,t),this.name="AutoRefreshPlugin",this.activeEvent="onRegister",this._uid=gs.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=function(t){t.glyphHost&&(t=t.glyphHost),t.stage===e.pluginService.stage&&null!=t.stage&&t.stage.renderNextFrame()}}),[{key:"activate",value:function(t){this.pluginService=t,this.dpr=al.global.devicePixelRatio,this.refresh()}},{key:"refresh",value:function(){this._refreshByMediaQuery()||this._refreshByRaf()}},{key:"_refreshByRaf",value:function(){var t=this,e=al.global.getRequestAnimationFrame();this.rafId=e((function(){al.global.devicePixelRatio!==t.dpr&&(t.dpr=al.global.devicePixelRatio,t.pluginService.stage.setDpr(t.dpr,!0)),t.refresh()}))}},{key:"_refreshByMediaQuery",value:function(){var t=this;try{var e="(resolution: ".concat(window.devicePixelRatio,"dppx)"),i=function(){window.devicePixelRatio!==t.dpr&&(t.dpr=window.devicePixelRatio,t.pluginService.stage.setDpr(t.dpr,!0))},n=matchMedia(e);n&&n.addEventListener("change",i),this.autoRefreshCbs||(this.autoRefreshCbs=[]),this.autoRefreshCbs.push((function(){n&&n.removeEventListener("change",i)}))}catch(t){return!1}return!0}},{key:"deactivate",value:function(t){var e,i=al.global.getCancelAnimationFrame();i&&this.rafId&&i(this.rafId),null===(e=this.autoRefreshCbs)||void 0===e||e.forEach((function(t){t()})),this.autoRefreshCbs=void 0}}])}(),J_=function(){return o((function t(){r(this,t),this.name="IncrementalAutoRenderPlugin",this.activeEvent="onRegister",this.nextFrameRenderGroupSet=new Set,this.willNextFrameRender=!1,this.nextUserParams={},this._uid=gs.GenAutoIncrementId(),this.key=this.name+this._uid}),[{key:"activate",value:function(t){var e=this;this.pluginService=t;var i=this.pluginService.stage;i&&(i.graphicService.hooks.onAddIncremental.tap(this.key,(function(i,n,r){i.glyphHost&&(i=i.glyphHost),i.stage===t.stage&&null!=i.stage&&(e.nextUserParams.startAtId=n._uid,e.renderNextFrame(n))})),i.graphicService.hooks.onClearIncremental.tap(this.key,(function(i,n){i.stage===t.stage&&null!=i.stage&&(e.nextUserParams.startAtId=i._uid,e.nextUserParams.restartIncremental=!0,e.renderNextFrame(i))})))}},{key:"deactivate",value:function(t){var e=this,i=this.pluginService.stage;i&&(i.graphicService.hooks.onAddIncremental.taps=i.graphicService.hooks.onAddIncremental.taps.filter((function(t){return t.name!==e.key})),i.graphicService.hooks.onClearIncremental.taps=i.graphicService.hooks.onClearIncremental.taps.filter((function(t){return t.name!==e.key})))}},{key:"renderNextFrame",value:function(t){var e=this;this.nextFrameRenderGroupSet.add(t),this.willNextFrameRender||(this.willNextFrameRender=!0,al.global.getRequestAnimationFrame()((function(){e._doRenderInThisFrame(),e.willNextFrameRender=!1})))}},{key:"_doRenderInThisFrame",value:function(){var t=this,e=this.pluginService.stage;this.nextFrameRenderGroupSet.size&&(this.nextFrameRenderGroupSet.forEach((function(i){var n=i.layer;if(n&&i.layer.subLayers){var r=i.layer.subLayers.get(i._uid);r&&r.drawContribution&&r.drawContribution.draw(e.renderService,Object.assign({stage:e,layer:n,viewBox:e.window.getViewBox(),transMatrix:e.window.getViewBoxTransform(),clear:"transparent",renderService:e.renderService,updateBounds:!1,startAtId:i._uid,context:r.layer.getNativeHandler().getContext()},t.nextUserParams))}})),this.nextUserParams={},this.nextFrameRenderGroupSet.clear())}}])}(),Q_=new _i,$_=function(){return o((function t(){r(this,t),this.name="DirtyBoundsPlugin",this.activeEvent="onRegister",this._uid=gs.GenAutoIncrementId(),this.key=this.name+this._uid}),[{key:"activate",value:function(t){var e=this;this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,(function(t){t&&t===e.pluginService.stage&&t.dirtyBounds.clear()}));var i=this.pluginService.stage;i&&(i.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(function(t,i,n,r){t.glyphHost&&(t=t.glyphHost),i&&i===e.pluginService.stage&&i.renderCount&&(t.isContainer&&!t.shouldSelfChangeUpdateAABBBounds()||n&&(Q_.setValue(r.x1,r.y1,r.x2,r.y2),i.dirty(Q_,t.parent&&t.parent.globalTransMatrix)))})),i.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(function(t,i,n,r,a){i&&i===e.pluginService.stage&&i.renderCount&&(t.isContainer&&!a||i.dirty(r.globalAABBBounds))})),i.graphicService.hooks.clearAABBBounds.tap(this.key,(function(t,i,n){i&&i===e.pluginService.stage&&i.renderCount&&i&&i.dirty(n)})),i.graphicService.hooks.onRemove.tap(this.key,(function(t){var i=t.stage;i&&i===e.pluginService.stage&&i.renderCount&&i&&i.dirty(t.globalAABBBounds)})))}},{key:"deactivate",value:function(t){var e=this,i=this.pluginService.stage;i&&(i.graphicService.hooks.beforeUpdateAABBBounds.taps=i.graphicService.hooks.beforeUpdateAABBBounds.taps.filter((function(t){return t.name!==e.key})),i.graphicService.hooks.afterUpdateAABBBounds.taps=i.graphicService.hooks.afterUpdateAABBBounds.taps.filter((function(t){return t.name!==e.key})),i.graphicService.hooks.clearAABBBounds.taps=i.graphicService.hooks.clearAABBBounds.taps.filter((function(t){return t.name!==e.key})),i.hooks.afterRender.taps=i.hooks.afterRender.taps.filter((function(t){return t.name!==e.key})),i.graphicService.hooks.onRemove.taps=i.graphicService.hooks.onRemove.taps.filter((function(t){return t.name!==e.key})))}}])}();function tb(){!function(){if(null==K_)try{var t=document.createElement("canvas"),e=t.getContext("2d");(K_=!!(window&&t.getBoundingClientRect&&requestAnimationFrame&&window.devicePixelRatio&&e&&e.isPointInPath&&e.isPointInStroke))&&(K_=!!document.createElement)}catch(t){K_=!1}}();var t=al.global&&al.global.env;return t?"browser"===t:K_}var eb=function(){function t(){r(this,t)}return o(t,null,[{key:"registerPlugin",value:function(e,i){t._pluginClasses[e]=i}},{key:"getPlugin",value:function(e){return t._pluginClasses[e]}}])}();eb._pluginClasses={};var ib="white",nb=function(t){function e(){var t,a,o,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(this,e),(t=n(this,e,[{}])).tickedBeforeRender=!0,t._onVisibleChange=function(e){if(!(t._skipRender<0))if(e){if(t.dirtyBounds){var i=t.window.getViewBox();t.dirtyBounds.setValue(i.x1,i.y1,i.width(),i.height())}t._skipRender>1&&t.renderNextFrame(),t._skipRender=0}else t._skipRender=1},t.beforeRender=function(e){t._beforeRenderList.forEach((function(t){return t(e)}))},t.afterClearScreen=function(e){t._afterClearScreen&&t._afterClearScreen(e)},t.afterClearRect=function(e){t._afterClearRect&&t._afterClearRect(e)},t.afterRender=function(e){t.renderCount++,t._afterRenderList.forEach((function(t){return t(e)})),t._afterNextRenderCbs&&t._afterNextRenderCbs.forEach((function(t){return t(e)})),t._afterNextRenderCbs=null,t.tickedBeforeRender=!1},t.afterTickCb=function(){t.tickedBeforeRender=!0,"rendering"!==t.state&&t.renderNextFrame()},t.params=s,t.theme=new dh,t.hooks={beforeRender:new il(["stage"]),afterRender:new il(["stage"]),afterClearScreen:new il(["stage"]),afterClearRect:new il(["stage"])},t.global=al.global,!t.global.env&&tb()&&t.global.setEnv("browser"),t.window=yc.get(Qc),t.renderService=yc.get(Km),t.pluginService=yc.get(u_),t.layerService=yc.get(Yf),t.graphicService=yc.get(Kp),t.pluginService.active(i(t),s),t._beforeRenderList=[],t._afterRenderList=[],t.window.create({width:s.width,height:s.height,viewBox:s.viewBox,container:s.container,dpr:s.dpr||t.global.devicePixelRatio,canvasControled:!1!==s.canvasControled,title:s.title||"",canvas:s.canvas}),t.state="normal",t.renderCount=0,t.tryInitEventSystem(),t._background=null!==(a=s.background)&&void 0!==a?a:ib,t.appendChild(t.layerService.createLayer(i(t),{main:!0})),t.nextFrameRenderLayerSet=new Set,t.willNextFrameRender=!1,t.stage=i(t),t.renderStyle=s.renderStyle,s.autoRender&&t.enableAutoRender(),s.autoRefresh&&t.enableAutoRefresh(),!1===s.disableDirtyBounds&&t.enableDirtyBounds(),s.enableHtmlAttribute&&t.enableHtmlAttribute(s.enableHtmlAttribute),s.ReactDOM&&t.enableReactAttribute(s.ReactDOM),s.enableLayout&&t.enableLayout(),t.hooks.beforeRender.tap("constructor",t.beforeRender),t.hooks.afterRender.tap("constructor",t.afterRender),s.beforeRender&&t._beforeRenderList.push(s.beforeRender),s.afterRender&&t._afterRenderList.push(s.afterRender),t.hooks.afterClearScreen.tap("constructor",t.afterClearScreen),t.hooks.afterClearRect.tap("constructor",t.afterClearRect),t._afterClearScreen=s.afterClearScreen,t._afterClearRect=s.afterClearRect,t.supportInteractiveLayer=!1!==s.interactiveLayer,s.optimize||(s.optimize={tickRenderMode:"effect"}),t.optmize(s.optimize),s.background&&K(t._background)&&t._background.includes("/")&&t.setAttributes({background:t._background}),t.initAnimate(s),t.rafId=null!==(o=s.rafId)&&void 0!==o?o:Math.floor(6*Math.random()),t}return h(e,t),o(e,[{key:"viewBox",get:function(){return this.window.getViewBox()},set:function(t){this.window.setViewBox(t)}},{key:"x",get:function(){return this.window.getViewBox().x1},set:function(t){var e=this.window.getViewBox();e.translate(t-e.x1,0),this.window.setViewBox(e)}},{key:"y",get:function(){return this.window.getViewBox().y1},set:function(t){var e=this.window.getViewBox();e.translate(0,t-e.y1),this.window.setViewBox(e)}},{key:"width",get:function(){return this.window.width},set:function(t){this.resize(t,this.height)}},{key:"viewWidth",get:function(){return this.window.getViewBox().width()},set:function(t){this.resizeView(t,this.viewHeight)}},{key:"viewHeight",get:function(){return this.window.getViewBox().height()},set:function(t){this.resizeView(this.viewWidth,t)}},{key:"height",get:function(){return this.window.height},set:function(t){this.resize(this.width,t)}},{key:"dpr",get:function(){return this.window.dpr},set:function(t){this.setDpr(t)}},{key:"background",get:function(){var t;return null!==(t=this._background)&&void 0!==t?t:ib},set:function(t){this._background=t}},{key:"defaultLayer",get:function(){return this.at(0)}},{key:"eventSystem",get:function(){return this._eventSystem}},{key:"ticker",get:function(){return this._ticker},set:function(t){t.bindStage(this),this._ticker&&this._ticker.removeListener("tick",this.afterTickCb),t.addTimeline(this.timeline),this._ticker=t,this._ticker.on("tick",this.afterTickCb)}},{key:"initAnimate",value:function(t){var e;this.createTicker&&this.createTimeline&&(this._ticker=t.ticker||this.createTicker(this),this._ticker.bindStage(this),"performance"===(null===(e=this.params.optimize)||void 0===e?void 0:e.tickRenderMode)&&this._ticker.setFPS(30),this.timeline=this.createTimeline(),this._ticker.addTimeline(this.timeline),this._ticker.on("tick",this.afterTickCb))}},{key:"startAnimate",value:function(){this._ticker&&this.timeline&&(this._ticker.start(),this.timeline.resume())}},{key:"pauseRender",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._skipRender=t}},{key:"resumeRender",value:function(){this._skipRender=0}},{key:"tryInitEventSystem",value:function(){this.global.supportEvent&&!this._eventSystem&&(this._eventSystem=new Ch(Object.assign({targetElement:this.window,resolution:this.window.dpr||this.global.devicePixelRatio,rootNode:this,global:this.global,supportsPointerEvents:this.params.supportsPointerEvents,supportsTouchEvents:this.params.supportsTouchEvents},this.params.event)))}},{key:"preventRender",value:function(t){t?this._skipRender=-1/0:!1!==this.params.optimize.skipRenderWithOutRange?this._skipRender=this.window.isVisible()?0:1:this._skipRender=0}},{key:"optmize",value:function(t){this.optmizeRender(t.skipRenderWithOutRange),this.params.optimize=t}},{key:"optmizeRender",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(this._skipRender=this._skipRender<0?this._skipRender:this.window.isVisible()?0:1,this.window.onVisibleChange(this._onVisibleChange))}},{key:"getTimeline",value:function(){return this.timeline}},{key:"get3dOptions",value:function(t){var e=t.center,i=void 0===e?{x:this.width/2,y:this.height/2,z:0,dx:0,dy:0,dz:0}:e,n=t.light,r=void 0===n?{}:n,a=t.alpha,o=void 0===a?0:a,s=t.beta,l=void 0===s?0:s,u=t.camera,c=t.fieldRatio,h=void 0===c?1:c,d=t.fieldDepth;return Object.assign(Object.assign({},t),{center:i,light:r,alpha:o,beta:l,camera:u,fieldRatio:h,fieldDepth:d})}},{key:"set3dOptions",value:function(t){var e,i,n,r,a,o;this.option3d=t;var s=this.get3dOptions(t),l=s.light,u=s.center,c=s.camera,h=s.alpha,d=s.beta,p=s.fieldRatio,f=s.fieldDepth,v=l.dir,g=void 0===v?[1,1,-1]:v,y=l.color,m=void 0===y?"white":y,_=l.ambient,b=(null!==(e=u.x)&&void 0!==e?e:this.width/2)+(null!==(i=u.dx)&&void 0!==i?i:0),x=(null!==(n=u.y)&&void 0!==n?n:this.height/2)+(null!==(r=u.dy)&&void 0!==r?r:0),k=[b,x,(null!==(a=u.z)&&void 0!==a?a:0)+(null!==(o=u.dz)&&void 0!==o?o:0)],S=0,A=0,M=0;c||(S=Math.sin(h)+b,A=Math.sin(d)+x,M=Math.cos(h)*Math.cos(d)*1);var T=eb.getPlugin("DirectionalLight");T&&(this.light=new T(g,m,_));var w={left:0,right:this.width,top:0,bottom:this.height,fieldRatio:p,fieldDepth:f,viewParams:{pos:[S,A,M],center:k,up:[0,1,0]}};if(this.camera)this.camera.params=w;else{var C=eb.getPlugin("OrthoCamera");C&&(this.camera=new C(w))}t.enableView3dTransform&&this.enableView3dTransform()}},{key:"setBeforeRender",value:function(t){this._beforeRenderList.push(t)}},{key:"removeBeforeRender",value:function(t){this._beforeRenderList=this._beforeRenderList.filter((function(e){return e!==t}))}},{key:"setAfterRender",value:function(t){this._afterRenderList.push(t)}},{key:"removeAfterRender",value:function(t){this._afterRenderList=this._afterRenderList.filter((function(e){return e!==t}))}},{key:"afterNextRender",value:function(t){this._afterNextRenderCbs||(this._afterNextRenderCbs=[]),this._afterNextRenderCbs.push(t)}},{key:"enableView3dTransform",value:function(){if(!this.view3dTranform){this.view3dTranform=!0;var t=eb.getPlugin("ViewTransform3dPlugin");t&&this.pluginService.register(new t)}}},{key:"disableView3dTranform",value:function(){var t=this;this.view3dTranform&&(this.view3dTranform=!1,this.pluginService.findPluginsByName("ViewTransform3dPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableAutoRender",value:function(){this.autoRender||(this.autoRender=!0,this.pluginService.register(new q_))}},{key:"disableAutoRender",value:function(){var t=this;this.autoRender&&(this.autoRender=!1,this.pluginService.findPluginsByName("AutoRenderPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableAutoRefresh",value:function(){this.autoRefresh||(this.autoRefresh=!0,this.pluginService.register(new Z_))}},{key:"disableAutoRefresh",value:function(){var t=this;this.autoRefresh&&(this.autoRefresh=!1,this.pluginService.findPluginsByName("AutoRefreshPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableIncrementalAutoRender",value:function(){this.increaseAutoRender||(this.increaseAutoRender=!0,this.pluginService.register(new J_))}},{key:"disableIncrementalAutoRender",value:function(){var t=this;this.increaseAutoRender&&(this.increaseAutoRender=!1,this.pluginService.findPluginsByName("IncrementalAutoRenderPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableDirtyBounds",value:function(){if(!this.dirtyBounds){this.dirtyBounds=new mi;var t=this.pluginService.findPluginsByName("DirtyBoundsPlugin")[0];t?t.activate(this.pluginService):(t=new $_,this.pluginService.register(t))}}},{key:"disableDirtyBounds",value:function(){var t=this;this.dirtyBounds&&(this.dirtyBounds=null,this.pluginService.findPluginsByName("DirtyBoundsPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableLayout",value:function(){if(!this._enableLayout){this._enableLayout=!0;var t=eb.getPlugin("FlexLayoutPlugin");t&&this.pluginService.register(new t)}}},{key:"disableLayout",value:function(){var t=this;this._enableLayout&&(this._enableLayout=!1,this.pluginService.findPluginsByName("FlexLayoutPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableHtmlAttribute",value:function(t){if(!this.htmlAttribute){var e=eb.getPlugin("HtmlAttributePlugin");e&&(this.htmlAttribute=t,this.pluginService.register(new e))}}},{key:"disableHtmlAttribute",value:function(){var t=this;this.htmlAttribute&&(this.htmlAttribute=!1,this.pluginService.findPluginsByName("HtmlAttributePlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableReactAttribute",value:function(t){if(!this.reactAttribute){var e=eb.getPlugin("ReactAttributePlugin");e&&(this.reactAttribute=t,this.pluginService.register(new e))}}},{key:"disableReactAttribute",value:function(){var t=this;this.reactAttribute&&(this.reactAttribute=!1,this.pluginService.findPluginsByName("ReactAttributePlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"getPluginsByName",value:function(t){return this.pluginService.findPluginsByName(t)}},{key:"tryUpdateAABBBounds",value:function(){var t=this.window.getViewBox();return this._AABBBounds.setValue(t.x1,t.y1,t.x2,t.y2),this._AABBBounds}},{key:"combineLayer",value:function(t,e){throw new Error("暂不支持")}},{key:"createLayer",value:function(t,e){if("released"!==this.releaseStatus){var i=this.layerService.createLayer(this,{main:!1,layerMode:e,canvasId:t});return this.appendChild(i),i}}},{key:"sortLayer",value:function(t){var e=this,i=this.children;i.sort(t),this.removeAllChild(),i.forEach((function(t){e.appendChild(t)}))}},{key:"removeLayer",value:function(t){return this.removeChild(this.findChildByUid(t))}},{key:"tryInitInteractiveLayer",value:function(){"released"!==this.releaseStatus&&this.supportInteractiveLayer&&!this.interactiveLayer&&(this.interactiveLayer=this.createLayer(),this.interactiveLayer.name="_builtin_interactive",this.interactiveLayer.attribute.pickable=!1,this.nextFrameRenderLayerSet.add(this.interactiveLayer))}},{key:"clearViewBox",value:function(t){this.window.clearViewBox(t)}},{key:"render",value:function(t,e){if("released"!==this.releaseStatus){this.startAnimate();var i=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this._skipRender||(this.lastRenderparams=e,this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(this.children),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=i,this._skipRender&&this._skipRender++}}},{key:"combineLayersToWindow",value:function(){if("harmony"===this.global.env){var t=this.window.getContext().nativeContext;this.forEachChildren((function(e,i){if(i>0){var n=e.getNativeHandler().getContext().canvas.nativeCanvas.nativeCanvas._c.transferToImageBitmap();t.transferFromImageBitmap(n)}}))}}},{key:"renderNextFrame",value:function(t,e){var i=this;this.nextFrameRenderLayerSet.size!==this.childrenCount&&(t||this).forEach((function(t){i.nextFrameRenderLayerSet.add(t)})),this.willNextFrameRender||(this.willNextFrameRender=!0,this.global.getSpecifiedRequestAnimationFrame(this.rafId)((function(){i._doRenderInThisFrame(),i.willNextFrameRender=!1})))}},{key:"_doRenderInThisFrame",value:function(){if("released"!==this.releaseStatus){this.startAnimate();var t=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this.nextFrameRenderLayerSet.size&&!this._skipRender&&(this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(Array.from(this.nextFrameRenderLayerSet.values()),this.lastRenderparams||{}),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=t,this._skipRender&&this._skipRender++}}},{key:"renderLayerList",value:function(t,e){for(var i=this,n=[],r=0;r<t.length;r++){var a=t[r];"virtual"===a.layerMode&&(a=a.getNativeHandler().mainHandler.layer),n.includes(a)||n.push(a)}n.forEach((function(t){t.renderCount>i.renderCount||(t.renderCount=i.renderCount+1,t===i.interactiveLayer&&i.dirtyBounds&&i.dirtyBounds.clear(),t.render({renderService:i.renderService,background:t===i.defaultLayer?i.background:void 0,updateBounds:!(!i.dirtyBounds||i.dirtyBounds.empty()),viewBox:i.window.getViewBox(),transMatrix:i.window.getViewBoxTransform()},Object.assign({renderStyle:i.renderStyle},e)))})),this.interactiveLayer&&!t.includes(this.interactiveLayer)&&(this.dirtyBounds&&this.dirtyBounds.clear(),this.interactiveLayer.render({renderService:this.renderService,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}},{key:"resizeWindow",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.window.resize(t,e),i&&this.render()}},{key:"resize",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];"released"!==this.releaseStatus&&(this.window.hasSubView()||this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.window.resize(t,e),this.forEachChildren((function(i){i.resize(t,e)})),this.camera&&this.option3d&&this.set3dOptions(this.option3d),i&&this.render())}},{key:"resizeView",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];"released"!==this.releaseStatus&&(this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.forEachChildren((function(i){i.resizeView(t,e)})),this.camera&&(this.camera.params=Object.assign(Object.assign({},this.camera.params),{right:this.width,bottom:this.height})),i&&this.render())}},{key:"setViewBox",value:function(t,e,i,n,r){var a=this,o=!0;"object"==k(t)?(this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2),!1===e&&(o=!1)):(this.viewBox.setValue(t,e,t+i,e+n),!1===r&&(o=!1)),this.forEachChildren((function(t){t.resizeView(a.viewBox.width(),a.viewBox.height())})),o&&this.render()}},{key:"setDpr",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.forEachChildren((function(e){e.setDpr(t)})),e&&this.render()}},{key:"setOrigin",value:function(t,e){throw new Error("暂不支持")}},{key:"export",value:function(t){throw new Error("暂不支持")}},{key:"pick",value:function(t,e){if("released"!==this.releaseStatus){var i=this.getPickerService().pick(this.children,new De(t,e),{bounds:this.AABBBounds});return!(!(null==i?void 0:i.graphic)&&!(null==i?void 0:i.group))&&i}}},{key:"setToFrame",value:function(t){throw new Error("暂不支持")}},{key:"release",value:function(){var t,i,n=this;_(e,"release",this,3)([]),this.hooks.beforeRender.unTap("constructor",this.beforeRender),this.hooks.afterRender.unTap("constructor",this.afterRender),this.eventSystem&&this.eventSystem.release(),this.layerService.releaseStage(this),this.pluginService.release(),this.forEach((function(t){t.release()})),this.interactiveLayer&&(this.interactiveLayer.forEachChildren((function(t){t.setStage&&t.setStage(null,null),n.interactiveLayer.removeChild(t)})),this.interactiveLayer.release()),this.window.release(),null===(t=this._ticker)||void 0===t||t.remTimeline(null==this?void 0:this.timeline),null===(i=this._ticker)||void 0===i||i.removeListener("tick",this.afterTickCb),this.renderService.renderTreeRoots=[]}},{key:"setStage",value:function(t){}},{key:"dirty",value:function(t,e){"released"!==this.releaseStatus&&(e&&t.transformWithMatrix(e),this.dirtyBounds.empty()&&this.dirtyBounds.setValue(t.x1,t.y1,t.x2,t.y2),this.dirtyBounds.union(t))}},{key:"getLayer",value:function(t){return this.children.filter((function(e){return e.name===t}))[0]}},{key:"renderTo",value:function(t){var e=this;"released"!==this.releaseStatus&&this.forEachChildren((function(i,n){i.drawTo(t,{renderService:e.renderService,viewBox:t.getViewBox(),transMatrix:t.getViewBoxTransform(),background:i===e.defaultLayer?e.background:void 0,clear:0===n,updateBounds:!(!e.dirtyBounds||e.dirtyBounds.empty())})}))}},{key:"renderToNewWindow",value:function(){var t=arguments.length>1?arguments[1]:void 0;if("released"!==this.releaseStatus){var e=yc.get(Qc),i=t?-t.x1:0,n=t?-t.y1:0,r=t?t.x2:this.viewWidth,a=t?t.y2:this.viewHeight,o=t?t.width():this.viewWidth,s=t?t.height():this.viewHeight;return e.create({viewBox:{x1:i,y1:n,x2:r,y2:a},width:o,height:s,dpr:this.window.dpr,canvasControled:!0,offscreen:!0,title:""}),this.renderTo(e),e}}},{key:"toCanvas",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0;if("released"!==this.releaseStatus){var i=this.renderToNewWindow(t,e).getNativeHandler();return i.nativeCanvas?i.nativeCanvas:null}}},{key:"setCursor",value:function(t){this._cursor=t,this.eventSystem.setCursor(t,"ignore")}},{key:"getCursor",value:function(){return this._cursor}},{key:"eventPointTransform",value:function(t){var e=this.global.mapToCanvasPoint(t,this.window);return this.stage.window.pointTransform(e.x,e.y)}},{key:"pauseTriggerEvent",value:function(){this._eventSystem&&this._eventSystem.pauseTriggerEvent()}},{key:"resumeTriggerEvent",value:function(){this._eventSystem&&this._eventSystem.resumeTriggerEvent()}},{key:"getPickerService",value:function(){return this.pickerService||(this.pickerService=yc.get(Jm)),this.pickerService}},{key:"reInit",value:function(){this.renderService.reInit(),this.pickerService.reInit()}}])}(Nf),rb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},ab=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))},ob=function(){return o((function t(){r(this,t)}),[{key:"configure",value:function(t){t.env===this.type&&t.setActiveEnvContribution(this)}},{key:"getNativeAABBBounds",value:function(t){return new _i}},{key:"removeDom",value:function(t){return!1}},{key:"createDom",value:function(t){return null}},{key:"updateDom",value:function(t,e){return!1}},{key:"getDynamicCanvasCount",value:function(){return 999}},{key:"getStaticCanvasCount",value:function(){return 999}},{key:"getElementById",value:function(t){return document.getElementById(t)}},{key:"getRootElement",value:function(){return document.body}},{key:"loadJson",value:function(t){var e=fetch(t).then((function(t){return t.json()}));return e.then((function(t){return{data:t,state:"success"}})).catch((function(){return{data:null,state:"fail"}})),e}},{key:"loadArrayBuffer",value:function(t){return fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadBlob",value:function(t){return fetch(t).then((function(t){return t.blob()})).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"getElementTop",value:function(t,e){return 0}},{key:"getElementLeft",value:function(t,e){return 0}},{key:"getElementTopLeft",value:function(t,e){return{top:0,left:0}}},{key:"loadFont",value:function(t,e,i){return ab(this,void 0,void 0,f().m((function t(){return f().w((function(t){for(;;)if(0===t.n)return t.a(2,{loadState:"fail"})}),t)})))}},{key:"isMacOS",value:function(){return!1}},{key:"copyToClipBoard",value:function(t){return Promise.resolve(null)}}])}();ob=rb([Ps()],ob);var sb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},lb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},ub=function(){return o((function t(){r(this,t),this._uid=gs.GenAutoIncrementId(),this.viewBox=new _i,this.modelMatrix=new xi(1,0,0,1,0,0)}),[{key:"onChange",value:function(t){this._onChangeCb=t}},{key:"configure",value:function(t,e){e.env===this.type&&t.setWindowHandler(this)}},{key:"release",value:function(){this.releaseWindow()}},{key:"isVisible",value:function(t){return!0}},{key:"onVisibleChange",value:function(t){}},{key:"getTopLeft",value:function(t){return{top:0,left:0}}},{key:"setViewBox",value:function(t){this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2)}},{key:"getViewBox",value:function(){return this.viewBox}},{key:"setViewBoxTransform",value:function(t,e,i,n,r,a){this.modelMatrix.setValue(t,e,i,n,r,a)}},{key:"getViewBoxTransform",value:function(){return this.modelMatrix}}])}();ub=sb([Ps(),lb("design:paramtypes",[])],ub);var cb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},hb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},db=function(t,e){return function(i,n){e(i,n,t)}},pb=function(){return o((function t(e,i){r(this,t),this.pickItemInterceptorContributions=e,this.pickServiceInterceptorContributions=i,this.type="default",this.global=al.global}),[{key:"reInit",value:function(){this._init()}},{key:"_init",value:function(){this.InterceptorContributions=this.pickItemInterceptorContributions.getContributions().sort((function(t,e){return t.order-e.order})),this.pickerServiceInterceptorContributions=this.pickServiceInterceptorContributions.getContributions().sort((function(t,e){return t.order-e.order}))}},{key:"pick",value:function(t,e,i){var n={graphic:null,group:null};i.pickerService=this;var r=i.bounds.width(),a=i.bounds.height();if(!(new _i).setValue(0,0,r,a).containsPoint(e))return n;this.pickContext&&(this.pickContext.inuse=!0),i.pickContext=this.pickContext,this.pickContext&&this.pickContext.clearMatrix(!0,1);for(var o,s=new xi(1,0,0,1,0,0),l=t.length-1;l>=0&&!(n=t[l].isContainer?this.pickGroup(t[l],e,s,i):this.pickItem(t[l],e,s,i)).graphic;l--)o||(o=n.group);if(n.graphic||(n.group=o),this.pickContext&&(this.pickContext.inuse=!1),this.pickerServiceInterceptorContributions.length)for(var u=0;u<this.pickerServiceInterceptorContributions.length;u++){var c=this.pickerServiceInterceptorContributions[u];c.afterPickItem&&(n=c.afterPickItem(n,this,e,i,{parentMatrix:s}))}return n}},{key:"containsPoint",value:function(t,e,i){var n;return!!(null===(n=this.pickItem(t,e,null,null!=i?i:{pickContext:this.pickContext,pickerService:this}))||void 0===n?void 0:n.graphic)}},{key:"pickGroup",value:function(t,e,i,n){var r=this,a={group:null,graphic:null};if(!1===t.attribute.visibleAll)return a;var o=n.pickContext,s=o.modelMatrix;if(o.camera){var l=t.transMatrix,u=lf.allocate();if(ef(u,l),s){if(u){var c=lf.allocate();o.modelMatrix=nf(c,s,u),lf.free(u)}}else ef(u,t.globalTransMatrix),o.modelMatrix=u}if(this.InterceptorContributions.length)for(var h=0;h<this.InterceptorContributions.length;h++){var d=this.InterceptorContributions[h];if(d.beforePickItem){var p=d.beforePickItem(t,this,e,n,{parentMatrix:i});if(p)return o.modelMatrix!==s&&lf.free(o.modelMatrix),o.modelMatrix=s,p}}var f=t.transMatrix,v=sf.allocateByObj(i),g=new De(e.x,e.y);v.transformPoint(g,g);var y=t.AABBBounds.containsPoint(g);if(!y&&!t.stage.camera)return a;var m=this.pickItem(t,g.clone(),i,n);m&&m.graphic&&(a.graphic=m.graphic,a.params=m.params);var _=!1!==t.attribute.pickable&&y;return v.multiply(f.a,f.b,f.c,f.d,f.e,f.f),!1===t.attribute.childrenPickable||m&&m.graphic||S_(t,Du.zIndex,(function(o){if(o.isContainer){var s=new De(e.x,e.y),l=fh(t).group,u=t.attribute,c=u.scrollX,h=void 0===c?l.scrollX:c,d=u.scrollY,p=void 0===d?l.scrollY:d;s.x-=h,s.y-=p,a=r.pickGroup(o,s,v,n)}else{var f=new De(e.x,e.y);v.transformPoint(f,f);var g=fh(t).group,y=t.attribute,m=y.scrollX,_=void 0===m?g.scrollX:m,b=y.scrollY,x=void 0===b?g.scrollY:b;f.x-=_,f.y-=x;var k=r.pickItem(o,f,i,n);k&&k.graphic&&(a.graphic=k.graphic,a.params=k.params)}return!!a.graphic||!!a.group}),!0,!!o.camera),o.modelMatrix!==s&&lf.free(o.modelMatrix),o.modelMatrix=s,a.graphic||a.group||!_||t.stage.camera||(a.group=t),sf.free(v),a}},{key:"selectPicker",value:function(t){return this.pickerMap.get(t.numberType)||null}}])}();function fb(t,e,i,n,r,a){var o=(e-t)*r+t,s=(i-e)*r+e,l=(n-i)*r+i,u=(s-o)*r+o,c=(l-s)*r+s,h=(c-u)*r+u;a[0]=t,a[1]=o,a[2]=u,a[3]=h,a[4]=h,a[5]=c,a[6]=l,a[7]=n}function vb(t,e){var i=t.length,n=e.length;if(i===n)return[t,e];for(var r=[],a=[],o=i<n?t:e,s=Math.min(i,n),l=Math.abs(n-i)/6,u=(s-2)/6,c=Math.ceil(l/u),h=[o[0],o[1]],d=l,p=2;p<s;p+=6){var f=o[p-2],v=o[p-1],g=o[p],y=o[p+1],m=o[p+2],_=o[p+3],b=o[p+4],x=o[p+5];if(d<=0)h.push(g,y,m,_,b,x);else{for(var k=Math.min(d,c)+1,S=1;S<=k;S++){var A=S/k;fb(f,g,m,b,A,r),fb(v,y,_,x,A,a),f=r[3],v=a[3],h.push(r[1],a[1],r[2],a[2],f,v),g=r[5],y=a[5],m=r[6],_=a[6]}d-=k-1}}return o===t?[h,e]:[t,h]}function gb(t,e){for(var i=t||e,n=i.length,r=i[n-2],a=i[n-1],o=[],s=0;s<e.length;s+=2)o[s]=r,o[s+1]=a;return o}function yb(t){for(var e=[],i=t.length,n=0;n<i;n+=2)e[n]=t[i-n-2],e[n+1]=t[i-n-1];return e}function mb(t){for(var e=0,i=0,n=0,r=t.length,a=0,o=r-2;a<r;o=a,a+=2){var s=t[o],l=t[o+1],u=t[a],c=t[a+1],h=s*c-u*l;e+=h,i+=(s+u)*h,n+=(l+c)*h}return 0===e?[t[0]||0,t[1]||0,0]:[i/e/3,n/e/3,e]}function _b(t,e,i,n){for(var r=(t.length-2)/6,a=1/0,o=0,s=t.length,l=s-2,u=0;u<r;u++){for(var c=6*u,h=0,d=0;d<s;d+=2){var p=0===d?c:(c+d-2)%l+2,f=t[p]-i[0],v=t[p+1]-i[1],g=e[d]-n[0]-f,y=e[d+1]-n[1]-v;h+=g*g+y*y}h<a&&(a=h,o=u)}return o}function bb(t){var e=new Mu,i=t.toString();if(!i)return[];e.fromString(i);var n=e.tryBuildCurves();if(!n||0===n.length)return[];var r=[],a=null;a=[];for(var o=0,s=0,l=0,u=0,c=!0,h=0;h<n.length;h++){var d=n[h];if(c&&(l=o=d.p0.x,u=s=d.p0.y,a=[o,s],r.push(a),c=!1),d.p1&&d.p2&&d.p3)a.push(d.p1.x,d.p1.y,d.p2.x,d.p2.y,d.p3.x,d.p3.y),l=d.p3.x,u=d.p3.y;else if(d.p1&&d.p2){var p=d.p1.x,f=d.p1.y,v=d.p2.x,g=d.p2.y;a.push(l+2/3*(p-l),u+2/3*(f-u),v+2/3*(p-v),g+2/3*(f-g),v,g),l=v,u=g}else if(d.p1){var y=d.p1.x,m=d.p1.y;Math.abs(l-y)<1e-10&&Math.abs(u-m)<1e-10||a.push(l,u,y,m,y,m),l=y,u=m}if(h===n.length-1&&Math.abs(l-o)<1e-10&&Math.abs(u-s),h<n.length-1){var _=n[h+1];(Math.abs(l-_.p0.x)>1e-10||Math.abs(u-_.p0.y)>1e-10)&&(c=!0)}}var b=r.filter((function(t){return t.length>2}));return 1===b.length?[b[0]]:b}function xb(t,e){for(var i=0;i<t.length;i++)for(var n=t[i],r=0;r<n.length;r+=2){var a=n[r],o=n[r+1],s={x:a,y:o};e.transformPoint({x:a,y:o},s),n[r]=s.x,n[r+1]=s.y}}function kb(t){for(var e=new Mu,i=0;i<t.length;i++){var n=t[i];if(n.length>2){e.moveTo(n[0],n[1]);for(var r=2;r<n.length;r+=6)e.bezierCurveTo(n[r],n[r+1],n[r+2],n[r+3],n[r+4],n[r+5])}}return e}function Sb(t,e,i){var n,r,a=t/e;t>=e?(r=Math.ceil(Math.sqrt(i*a)),0===(n=Math.floor(i/r))&&(n=1,r=i)):(n=Math.ceil(Math.sqrt(i/a)),0===(r=Math.floor(i/n))&&(r=1,n=i));for(var o=[],s=0;s<n;s++)o.push(r);var l=i-n*r;if(l>0)for(var u=0;u<l;u+=r)u+r<l?o.push(r):o.push(l-u);return o}pb=cb([Ps(),db(0,Cs(Xs)),db(0,Bs($m)),db(1,Cs(Xs)),db(1,Bs(t_)),hb("design:paramtypes",[Object,Object])],pb);var Ab=function(t,e){var i=t.filter((function(t){return!1!==t.defined&&Q(t.x)&&Q(t.y)}));if(0===i.length)return[];if(1===i.length)return new Array(e).fill(0).map((function(t){return i[0]}));var n=[];if(e<=i.length){for(var r=i.length/e,a=0,o=0;a<e;)n.push(i[Math.floor(o)]),o+=r,a++;return n}for(var s=e-i.length,l=1/(s/(i.length-1)+1),u=0,c=0,h=t.length;c<h;c++)if(n.push(t[c]),c<h-1)for(var d=l,p=t[c].x,f=t[c].y,v=t[c+1].x,g=t[c+1].y;d<1&&u<s;)n.push({x:p+(v-p)*d,y:f+(g-f)*d}),d+=l,u+=1;return n};var Mb=function(t){return t.map((function(t){return{x:t.x,y:t.y}}))},Tb=function(t,e,i){for(var n,r,a,o=t.length,s=[],l=0;l<o;l++){var u=t[l],c=l===o-1?t[0]:t[l+1],h=qe([e.x,e.y],[i.x,i.y],[u.x,u.y],[c.x,c.y]);h&&"boolean"!=typeof h&&s.push({dot:(r=[h[0]-e.x,h[1]-e.x],a=[i.x-e.x,i.y-e.x],r[0]*a[1]-r[1]*a[0]),point:{x:h[0],y:h[1]},edgeIndex:l})}if(s.length<2)return[Mb(t),Mb(t)];s.sort((function(t,e){return t.dot-e.dot}));var d=s[0],p=s[s.length-1];d.edgeIndex>p.edgeIndex&&(d=(n=[p,d])[0],p=n[1]);for(var f=d.point,v=p.point,g=[{x:f.x,y:f.y}],y=d.edgeIndex+1;y<=p.edgeIndex;y++)g.push({x:t[y].x,y:t[y].y});g.push({x:v.x,y:v.y});for(var m=[{x:v.x,y:v.y}],_=p.edgeIndex+1,b=d.edgeIndex+o;_<=b;_++){var x=t[_%o];m.push({x:x.x,y:x.y})}return m.push({x:f.x,y:f.y}),[g,m]},wb=function(t,e,i){if(1===e)i.push({points:t});else{var n=Math.floor(e/2),r=function(t){var e=new mi;t.forEach((function(t){e.add(t.x,t.y)}));var i=e.width(),n=e.height();if(i>=n){var r=e.x1+i/2;return Tb(t,{x:r,y:e.y1},{x:r,y:e.y2})}var a=e.y1+n/2;return Tb(t,{x:e.x1,y:a},{x:e.x2,y:a})}(t);wb(r[0],n,i),wb(r[1],e-n,i)}},Cb=!1,Eb=new ys((function(t){Cb||(Cb=!0,t(vy).toSelf().inSingletonScope(),t(_m).to(vy).inSingletonScope(),t(km).toService(_m),t(uv).toService(Eg),qs(t,uv))})),Pb=!1,Bb=new ys((function(t){Pb||(Pb=!0,t(Vy).toSelf().inSingletonScope(),t(wm).to(Vy).inSingletonScope(),t(km).toService(wm),t(Zg).toSelf(),t(qg).toSelf(),t(gv).toService(Zg),t(gv).toService(qg),t(gv).toService(Eg),qs(t,gv))})),Rb=!1,Lb=new ys((function(t){Rb||(Rb=!0,t(Ay).toSelf().inSingletonScope(),t(B_).toSelf().inSingletonScope(),t(Am).to(Ay).inSingletonScope(),t(km).toService(Am))})),Ib=!1,Db=new ys((function(t){Ib||(Ib=!0,t(By).toSelf().inSingletonScope(),t(bm).to(By).inSingletonScope(),t(km).toService(bm),t(cv).toService(Eg),qs(t,cv),t(L_).toSelf().inSingletonScope())})),Ob=!1,Fb=new ys((function(t){Ob||(Ob=!0,t(Gy).toSelf().inSingletonScope(),t(Cm).to(Gy).inSingletonScope(),t(km).toService(Cm),t(yv).toService(Eg),qs(t,yv))})),zb=!1,Hb=new ys((function(t){zb||(zb=!0,t(_y).toSelf().inSingletonScope(),t(xm).to(_y).inSingletonScope(),t(km).toService(xm),t(hv).toService(Eg),qs(t,hv))})),Nb=!1,Vb=new ys((function(t){Nb||(Nb=!0,t(Em).to($y).inSingletonScope(),t(km).toService(Em),t(mv).toService(Eg),qs(t,mv))})),jb=!1,Ub=new ys((function(t){jb||(jb=!0,t(Fy).toSelf().inSingletonScope(),t(Mm).to(Fy).inSingletonScope(),t(km).toService(Mm),t(fv).toService(Eg),qs(t,fv))})),Wb=!1,Gb=new ys((function(t){Wb||(Wb=!0,t(Tm).to(lm).inSingletonScope(),t(km).toService(Tm),t(vv).toService(Eg),qs(t,vv))})),Yb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Xb=function(){return o((function t(){r(this,t),this.numberType=zp}),[{key:"reInit",value:function(){}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s){r.drawContribution&&t.getSubGraphic().forEach((function(t){var l=r.drawContribution.getRenderContribution(t);l&&l.drawShape&&l.drawShape(t,e,i,n,r,a,o,s)}))}},{key:"draw",value:function(t,e,i,n){var r=i.context;if(r&&(r.highPerformanceSave(),i.drawContribution)){var a=fh(t),o=t.getSubGraphic();o.length&&o.forEach((function(t){i.drawContribution.renderItem(t,i,{theme:a})})),r.highPerformanceRestore()}}}])}();Xb=Yb([Ps()],Xb);var Kb=!1,qb=new ys((function(t){Kb||(Kb=!0,t(Bm).to(Xb).inSingletonScope(),t(km).toService(Bm))})),Zb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Jb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Qb=function(t){function e(){var t;return r(this,e),(t=n(this,e)).numberType=Gp,t.builtinContributions=[qy],t.init(),t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r){var a=fh(t).richtext,o=t.attribute,s=o.strokeOpacity,l=void 0===s?a.strokeOpacity:s,u=o.opacity,c=void 0===u?a.opacity:u,h=o.fillOpacity,d=void 0===h?a.fillOpacity:h,p=o.visible,f=void 0===p?a.visible:p;if(t.valid&&f){var v=iv(c,d,!0),g=iv(c,l,!0);v&&(e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,a),e.translate(i,n),this.beforeRenderStep(t,e,i,n,v,g,v,g,a,r),t.getFrameCache().draw(e,this.drawIcon),this.afterRenderStep(t,e,i,n,v,g,v,g,a,r))}}},{key:"drawIcon",value:function(t,e,i,n,r){var a,o=fh(t).richtextIcon,s=t.attribute,l=s.width,u=void 0===l?o.width:l,c=s.height,h=void 0===c?o.height:c,d=s.opacity,p=void 0===d?o.opacity:d,f=s.image,v=s.backgroundFill,g=void 0===v?o.backgroundFill:v,y=s.backgroundFillOpacity,m=void 0===y?o.backgroundFillOpacity:y,_=s.backgroundStroke,b=void 0===_?o.backgroundStroke:_,x=s.backgroundStrokeOpacity,k=void 0===x?o.backgroundStrokeOpacity:x,S=s.backgroundRadius,A=void 0===S?o.backgroundRadius:S,M=s.margin,T=t.attribute,w=T.backgroundWidth,C=void 0===w?u:w,E=T.backgroundHeight,P=void 0===E?h:E;if(M&&(i+=t._marginArray[3],n+=t._marginArray[0]),t._hovered){var B=(C-u)/2,R=(P-h)/2;0===A?(e.beginPath(),e.rect(i-B,n-R,C,P)):(e.beginPath(),Yg(e,i-B,n-R,C,P,A,!0)),g&&(e.globalAlpha=m,e.fillStyle=g,e.fill()),b&&(e.globalAlpha=k,e.strokeStyle=b,e.stroke())}var L=f&&(null===(a=null==t?void 0:t.resources)||void 0===a?void 0:a.get(f));L&&"success"===L.state&&(e.globalAlpha=p,e.drawImage(L.data,i,n,u,h))}},{key:"draw",value:function(t,e,i){var n=fh(t).richtext;this._draw(t,n,!1,i)}}])}(hy);Qb=Zb([Ps(),Jb("design:paramtypes",[])],Qb);var $b=!1,tx=new ys((function(t){$b||($b=!0,t(Pm).to(Qb).inSingletonScope(),t(km).toService(Pm))})),ex=!1,ix=new ys((function(t){ex||(ex=!0,t(Rm).to(ym).inSingletonScope(),t(km).toService(Rm),t(pv).toService(Eg),qs(t,pv))}));var nx=function(){return o((function t(){var e=this;r(this,t),this.name="HtmlAttributePlugin",this.activeEvent="onRegister",this._uid=gs.GenAutoIncrementId(),this.key=this.name+this._uid,this.htmlMap={},this.renderId=0,this.onWheel=function(t){try{var i=new t.constructor(t.type,t);e.pluginService.stage.window.getContext().getCanvas().nativeCanvas.dispatchEvent(i)}catch(t){return}}}),[{key:"activate",value:function(t){var e=this;this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,(function(i){i&&i===e.pluginService.stage&&e.drawHTML(b(t.stage.getChildren()))}))}},{key:"deactivate",value:function(t){var e=this;t.stage.hooks.afterRender.taps=t.stage.hooks.afterRender.taps.filter((function(t){return t.name!==e.key})),this.release()}},{key:"getWrapContainer",value:function(t,e,i){var n;return n=e?"string"==typeof e?al.global.getElementById(e):e:t.window.getContainer(),{wrapContainer:al.global.createDom(Object.assign({tagName:"div",parent:n},i)),nativeContainer:n}}},{key:"parseDefaultStyleFromGraphic",value:function(t){return function(t){var e={},i=function(t){return/^\d+(\.\d+)?$/.test("".concat(t))?"".concat(t,"px"):"".concat(t)};return["textAlign","fontFamily","fontVariant","fontStyle","fontWeight"].forEach((function(i){t[i]&&(e[Fi(i)]=t[i])})),["fontSize","lineHeight"].forEach((function(n){var r=Fi(n);j(t[n])||(e[r]=i(t[n]))})),U(t.maxLineWidth)&&(e["max-width"]=i(t.maxLineWidth)),t.underline?e["text-decoration"]="underline":t.lineThrough&&(e["text-decoration"]="line-through"),t.fill&&K(t.fill)&&(e.color=t.fill),e}("text"===t.type&&t.attribute?t.attribute:fh(t).text)}},{key:"getTransformOfText",value:function(t){var e=fh(t).text,i=t.attribute,n=i.textAlign,r=void 0===n?e.textAlign:n,a=i.textBaseline,o=void 0===a?e.textBaseline:a,s=t.globalTransMatrix.toTransformAttrs(),l=s.rotateDeg,u=s.scaleX,c=s.scaleY,h={left:"0",start:"0",end:"-100%",center:"-50%",right:"-100%",top:"0",middle:"-50%",bottom:"-100%",alphabetic:"-79%"},d={left:"0",start:"0",end:"100%",center:"50%",right:"100%",top:"0",middle:"50%",bottom:"100%",alphabetic:"79%"};return{textAlign:r,transform:"translate(".concat(h[r],",").concat(h[o],") rotate(").concat(l,"deg) scaleX(").concat(u,") scaleY(").concat(c,")"),transformOrigin:"".concat(d[r]," ").concat(d[o])}}},{key:"updateStyleOfWrapContainer",value:function(t,e,i,n,r){var a=this,o=r.pointerEvents,s=r.penetrateEventList,l=void 0===s?[]:s,u=this.parseDefaultStyleFromGraphic(t);u.display=!1!==t.attribute.visible?"block":"none",u.pointerEvents=!0===o?"all":o||"none","none"!==u.pointerEvents&&(this.removeWrapContainerEventListener(i),l.forEach((function(t){"wheel"===t&&i.addEventListener("wheel",a.onWheel)}))),i.style.position||(i.style.position="absolute",n.style.position="relative");var c=0,h=0,d=t.globalAABBBounds,p=r.anchorType;if(j(p)&&(p="text"===t.type?"position":"boundsLeftTop"),"boundsLeftTop"===p&&(p="top-left"),"position"===p||d.empty()){var f=t.globalTransMatrix;c=f.e,h=f.f}else{var v=fi(d,p);c=v.x,h=v.y}var g=al.global.getElementTopLeft(n,!1),y=e.window.getTopLeft(!1),m=e.viewBox,_=c+y.left-g.left+m.x1,b=h+y.top-g.top+m.y1;if(u.left="".concat(_,"px"),u.top="".concat(b,"px"),"text"===t.type&&"position"===p&&(u=Object.assign(Object.assign({},u),this.getTransformOfText(t))),V(r.style)){var x=r.style({top:b,left:_,width:d.width(),height:d.height()},t,i);x&&(u=Object.assign(Object.assign({},u),x))}else W(r.style)?u=Object.assign(Object.assign({},u),r.style):K(r.style)&&r.style&&(u=Object.assign(Object.assign({},u),function(){var t={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(";").forEach((function(e){if(e){var i=e.split(":");if(2===i.length){var n=i[0].trim(),r=i[1].trim();n&&r&&(t[n]=r)}}})),t}(r.style)));al.global.updateDom(i,{width:r.width,height:r.height,style:u})}},{key:"clearCacheContainer",value:function(){var t=this;this.htmlMap&&Object.keys(this.htmlMap).forEach((function(e){t.htmlMap[e]&&t.htmlMap[e].renderId!==t.renderId&&t.removeElement(e)})),this.renderId+=1}},{key:"drawHTML",value:function(t){var e=this;"browser"===al.global.env&&(t.sort((function(t,e){var i,n;return(null!==(i=t.attribute.zIndex)&&void 0!==i?i:Du.zIndex)-(null!==(n=e.attribute.zIndex)&&void 0!==n?n:Du.zIndex)})).forEach((function(t){e.renderGroupHTML(t)})),this.clearCacheContainer())}},{key:"renderGroupHTML",value:function(t){var e=this;this.renderGraphicHTML(t),t.forEachChildren((function(t){t.isContainer?e.renderGroupHTML(t):e.renderGraphicHTML(t)}))}},{key:"removeElement",value:function(t){if(this.htmlMap&&this.htmlMap[t]){var e=this.htmlMap[t].wrapContainer;e&&al.global.removeDom(e),this.htmlMap[t]=null}}},{key:"removeWrapContainerEventListener",value:function(t){t.removeEventListener("wheel",this.onWheel)}},{key:"renderGraphicHTML",value:function(t){var e,i=t.attribute.html;if(i){var n=t.stage;if(n){var r=i.dom,a=i.container;if(r){var o=j(i.id)?"".concat(null!==(e=t.id)&&void 0!==e?e:t._uid,"_react"):i.id;if(this.htmlMap&&this.htmlMap[o]&&a&&a!==this.htmlMap[o].container&&this.removeElement(o),this.htmlMap&&this.htmlMap[o])"string"==typeof r?this.htmlMap[o].wrapContainer.innerHTML=r:r!==this.htmlMap[o].wrapContainer.firstChild&&(this.htmlMap[o].wrapContainer.removeChild(this.htmlMap[o].wrapContainer.firstChild),this.htmlMap[o].wrapContainer.appendChild(r));else{var s=this.getWrapContainer(n,a),l=s.wrapContainer,u=s.nativeContainer;l&&("string"==typeof r?l.innerHTML=r:l.appendChild(r),this.htmlMap||(this.htmlMap={}),this.htmlMap[o]={wrapContainer:l,nativeContainer:u,container:a,renderId:this.renderId})}if(this.htmlMap&&this.htmlMap[o]){var c=this.htmlMap[o],h=c.wrapContainer,d=c.nativeContainer;this.updateStyleOfWrapContainer(t,n,h,d,i),this.htmlMap[o].renderId=this.renderId}}}}}},{key:"release",value:function(){"browser"===al.global.env&&this.removeAllDom(this.pluginService.stage.defaultLayer)}},{key:"removeAllDom",value:function(t){var e=this;this.htmlMap&&(Object.keys(this.htmlMap).forEach((function(t){e.removeElement(t)})),this.htmlMap=null)}}])}(),rx=function(){eb.registerPlugin("HtmlAttributePlugin",nx)},ax=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="ReactAttributePlugin",t.activeEvent="onRegister",t._uid=gs.GenAutoIncrementId(),t.key=t.name+t._uid,t.htmlMap={},t}return h(e,t),o(e,[{key:"removeElement",value:function(t){if(this.htmlMap&&this.htmlMap[t]){var e=this.htmlMap[t],i=e.root,n=e.wrapContainer,r=e.unmount;i?al.global.getRequestAnimationFrame()((function(){i.unmount()})):r&&r(),n&&al.global.removeDom(n),this.htmlMap[t]=null}}},{key:"renderGraphicHTML",value:function(t){var e,i=t.attribute.react;if(i){var n=t.stage;if(n){var r=n.params.ReactDOM,a=i.element,o=i.container;if(a&&r&&(r.createRoot||r.render)){var s=j(i.id)?"".concat(null!==(e=t.id)&&void 0!==e?e:t._uid,"_react"):i.id;if(this.htmlMap&&this.htmlMap[s]&&o&&o!==this.htmlMap[s].container&&this.removeElement(s),this.htmlMap&&this.htmlMap[s])r.createRoot?this.htmlMap[s].root.render(a):r.render(a,this.htmlMap[s].wrapContainer);else{var l=this.getWrapContainer(n,o),u=l.wrapContainer,c=l.nativeContainer;if(u)if(this.htmlMap||(this.htmlMap={}),r.createRoot){var h=r.createRoot(u);h.render(a),this.htmlMap[s]={root:h,wrapContainer:u,nativeContainer:c,container:o,renderId:this.renderId}}else r.render(a,u),this.htmlMap[s]={wrapContainer:u,nativeContainer:c,container:o,renderId:this.renderId,unmount:function(){r.unmountComponentAtNode(u)}}}if(this.htmlMap&&this.htmlMap[s]){var d=this.htmlMap[s],p=d.wrapContainer,f=d.nativeContainer;this.updateStyleOfWrapContainer(t,n,p,f,i),this.htmlMap[s].renderId=this.renderId}}}}}}])}(nx),ox=function(){eb.registerPlugin("ReactAttributePlugin",ax)};function sx(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];0!==i&&n[0]===e[e.length-1]||e.push(n[0]),e.push(n[1])}return e}function lx(t,e,i){var n=t.indexOf(e),r=t.indexOf(i);n>=0&&r>=0&&n<r&&(t.splice(n,1),t.splice(r,0,e))}var ux=function(t){for(var e,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return(e=Ot.getInstance()).info.apply(e,R(["[VChart log]: ".concat(t)],B(i),!1))},cx=function(t,e){return V(dx.warnHandler)&&dx.warnHandler.call(null,t,e),e?Ot.getInstance().warn("[VChart warn]: ".concat(t),e):Ot.getInstance().warn("[VChart warn]: ".concat(t))},hx=function(t,e,i){if(!V(dx.errorHandler))throw new Error(t);dx.errorHandler.call(null,t,e)},dx={silent:!1,warnHandler:!1,errorHandler:!1},px=tb(),fx=px&&globalThis?globalThis.document:void 0;function vx(t){return("desktop-browser"===t||"mobile-browser"===t)&&px}function gx(t){return yx(t)||"mobile-browser"===t}function yx(t){return t.includes("miniApp")||"lynx"===t||"wx"===t||"harmony"===t}var mx=0;function _x(){return mx>=9999999&&(mx=0),mx++}function bx(t){return null!=t&&""!==t&&(!!Q(t)||+t==+t)}function xx(t){return!(!t||0===t.length)&&(!j(t[0])&&!j(t[0].dataId)&&q(t[0].fields))}var kx=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","visible","clip","pickable","childrenPickable","zIndex","cursor"],Sx=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[t]))._skipRenderAttributes=kx,(null==i?void 0:i.mode)&&(a.mode=i.mode,a.setMode(i.mode)),(null==i?void 0:i.skipDefault)&&(a.skipDefault=!0),a.setTheme({common:{strokeBoundsBuffer:0}}),a.attribute=t,a.onSetStage((function(){a.render(),a.bindEvents()})),a}return h(e,t),o(e,[{key:"setAttribute",value:function(t,e,i,n){var r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(l({},t,e),this.attribute,t,n);if(r)return this._setAttributes(r,i);Y(this.attribute[t])&&Y(e)&&!V(this.attribute[t])&&!V(e)?gt(this.attribute[t],e):this.attribute[t]=e,this._skipRenderAttributes.includes(t)||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTag(t)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}},{key:"setAttributes",value:function(t,e,i){return t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t,this._setAttributes(t,e)}},{key:"_setAttributes",value:function(t,e){var i=this,n=Object.keys(t);this._mergeAttributes(t,n),n.every((function(t){return i._skipRenderAttributes.includes(t)}))||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!e&&!this.needUpdateTags(n)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}},{key:"_mergeAttributes",value:function(t,e){j(e)&&(e=Object.keys(t));for(var i=0;i<e.length;i++){var n=e[i];!Y(this.attribute[n])||V(this.attribute[n])||V(t[n])?this.attribute[n]=t[n]:gt(this.attribute[n],t[n])}}},{key:"bindEvents",value:function(){}},{key:"_getNodeId",value:function(t){var e;return"".concat(null!==(e=this.id)&&void 0!==e?e:this._uid,"-").concat(this.name,"-").concat(t)}},{key:"_dispatchEvent",value:function(t,e){var i,n=new xh(t,e);n.manager=null===(i=this.stage)||void 0===i?void 0:i.eventSystem.manager,this.dispatchEvent(n)}},{key:"eventPosToStagePos",value:function(t){var e,i,n={x:0,y:0},r=null!==(i=null===(e=this.stage)||void 0===e?void 0:e.eventPointTransform(t))&&void 0!==i?i:{x:0,y:0};return this.globalTransMatrix.transformPoint(r,n),n}}])}(Nf),Ax=Symbol.for("MathPickerContribution"),Mx=Symbol.for("MathArcPicker"),Tx=Symbol.for("MathAreaPicker"),Cx=Symbol.for("MathCirclePicker"),Ex=Symbol.for("MathImagePicker"),Px=Symbol.for("MathLinePicker"),Bx=Symbol.for("MathPathPicker"),Rx=Symbol.for("MathRectPicker"),Lx=Symbol.for("MathSymbolPicker"),Ix=Symbol.for("MathTextPicker"),Dx=Symbol.for("MathPolygonPicker"),Ox=Symbol.for("MathGlyphPicker"),Fx=Symbol.for("CanvasArcPicker"),zx=Symbol.for("CanvasAreaPicker"),Hx=Symbol.for("CanvasCirclePicker"),Nx=Symbol.for("CanvasImagePicker"),Vx=Symbol.for("CanvasLinePicker"),jx=Symbol.for("CanvasPathPicker"),Ux=Symbol.for("CanvasRectPicker"),Wx=Symbol.for("CanvasSymbolPicker"),Gx=Symbol.for("CanvasTextPicker"),Yx=Symbol.for("CanvasPolygonPicker"),Xx=Symbol.for("CanvasRichTextPicker"),Kx=Symbol.for("CanvasGlyphPicker"),qx=Symbol.for("CanvasGroupPicker"),Zx=Symbol.for("CanvasPickerContribution"),Jx=function(){return o((function t(e){var i=this;r(this,t),this.onPointerDown=function(t){var e=t.target,n=i.rootNode,r=e===n;if(e&&!r){var a,o=!1;function l(t){if(o||(t.type="dragstart",null==e||e.dispatchEvent(t),o=!0),t.type="drag",null==e||e.dispatchEvent(t),!r){e.attribute.pickable=!1;var i=(null==n?void 0:n.pick(t.global.x,t.global.y)).graphic;e.attribute.pickable=!0,a!==i&&(a&&(t.type="dragleave",t.target=a,a.dispatchEvent(t)),i&&(t.type="dragenter",t.target=i,i.dispatchEvent(t)),(a=i)&&(t.type="dragover",t.target=a,a.dispatchEvent(t)))}}null==n||n.addEventListener("pointermove",l);var s=function(){o&&(a&&(t.type="drop",t.target=a,a.dispatchEvent(t)),t.type="dragend",e.dispatchEvent(t),o=!1),null==n||n.removeEventListener("pointermove",l)};e.addEventListener("pointerup",s,{once:!0}),e.addEventListener("pointerupoutside",s,{once:!0})}},this.rootNode=e,this.initEvents()}),[{key:"initEvents",value:function(){var t;null===(t=this.rootNode)||void 0===t||t.addEventListener("pointerdown",this.onPointerDown)}},{key:"removeEvents",value:function(){var t;null===(t=this.rootNode)||void 0===t||t.removeEventListener("pointerdown",this.onPointerDown)}},{key:"release",value:function(){this.removeEvents(),this.rootNode=null}}])}(),Qx=function(t,e){var i=e.x-t.x,n=e.y-t.y;return Math.abs(i)>Math.abs(n)?i>0?"right":"left":n>0?"down":"up"},$x=function(t,e){var i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return Math.sqrt(i*i+n*n)},tk=function(t){function e(t){var a,o,s,l,u,c,h,d,p,f,v,g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,e),(a=n(this,e)).cachedEvents=[],a.startPoints=[],a.processEvent={},a.throttleTimer=0,a.emitThrottles=[],a.lastTapTarget=null,a.onStart=function(t){a.startTime=kh.now();var e=i(a),n=e.cachedEvents,r=e.startPoints;t&&n.push(t.clone()),r.length=n.length;for(var o=0;o<n.length;o++){var s=n[o],l={x:s.x,y:s.y};r[o]=l}if(1!==r.length)a.startDistance=$x(r[0],r[1]),a.center=function(t){var e=t.length;if(1===e)return{x:Math.round(t[0].x),y:Math.round(t[0].y)};for(var i=0,n=0,r=0;r<e;)i+=t[r].x,n+=t[r].y,r++;return{x:Math.round(i/e),y:Math.round(n/e)}}([r[0],r[1]]);else{var u=n[0];a.pressTimeout=setTimeout((function(){u.direction="none",u.deltaX=0,u.deltaY=0,u.points=r,a.triggerStartEvent("press",u),a.triggerEvent("press",u),a.eventType="press",a.direction="none",a.pressTimeout=null}),a.config.press.time)}},a.onMove=function(t){a.clearPressTimeout();var e=i(a),n=e.startPoints,r=e.cachedEvents;if(n.length){for(var o=t.clone(),s=o.x,l=o.y,u=o.pointerId,c=0,h=r.length;c<h;c++)if(u===r[c].pointerId){r[c]=o;break}var d={x:s,y:l},p=r.map((function(t){return{x:t.x,y:t.y}})),f=kh.now();if(a.prevMoveTime=a.lastMoveTime,a.prevMovePoint=a.lastMovePoint,a.lastMoveTime=f,a.lastMovePoint=d,1===n.length){var v=n[0],g=s-v.x,y=l-v.y,m=a.direction||Qx(v,d);a.direction=m;var _=a.getEventType(d);return o.direction=m,o.deltaX=g,o.deltaY=y,o.points=p,a.triggerStartEvent(_,o),void a.triggerEvent(_,o)}var b=i(a).startDistance,x=$x(p[0],p[1]);o.scale=x/b,o.center=a.center,o.points=p,a.triggerStartEvent("pinch",o),a.triggerEvent("pinch",o)}},a.onEnd=function(t){var e=t.clone(),n=i(a),r=n.cachedEvents,o=n.startPoints,s=r.map((function(t){return{x:t.x,y:t.y}}));if(e.points=s,a.triggerEndEvent(e),1===r.length){var l=kh.now(),u=a.lastMoveTime;if(l-u<100){var c=u-(a.prevMoveTime||a.startTime);if(c>0){var h=a.prevMovePoint||o[0],d=a.lastMovePoint||o[0],p=$x(h,d),f=p/c;if(f>a.config.swipe.velocity&&p>a.config.swipe.threshold)return e.velocity=f,e.direction=Qx(h,d),a.triggerEvent("swipe",e),a.cachedEvents=[],a.startPoints=[],void a.reset()}}l-a.startTime<a.config.press.time&&(l-a.lastTapTime<a.config.tap.interval&&t.target===a.lastTapTarget?a.tapCount++:a.tapCount=1,a.lastTapTime=l,a.lastTapTarget=t.target,1===a.tapCount?a.triggerEvent("tap",e):2===a.tapCount&&(a.triggerEvent("doubletap",e),a.tapCount=0))}for(var v=0,g=r.length;v<g;v++)if(r[v].pointerId===e.pointerId){r.splice(v,1),o.splice(v,1);break}a.reset(),r.length>0&&a.onStart()},a.element=t,a.tapCount=0,a.lastTapTime=0,a.config={press:{time:null!==(s=null===(o=null==g?void 0:g.press)||void 0===o?void 0:o.time)&&void 0!==s?s:251,threshold:null!==(u=null===(l=null==g?void 0:g.press)||void 0===l?void 0:l.threshold)&&void 0!==u?u:9},swipe:{threshold:null!==(h=null===(c=null==g?void 0:g.swipe)||void 0===c?void 0:c.threshold)&&void 0!==h?h:10,velocity:null!==(p=null===(d=null==g?void 0:g.swipe)||void 0===d?void 0:d.velocity)&&void 0!==p?p:.3},tap:{interval:null!==(v=null===(f=null==g?void 0:g.tap)||void 0===f?void 0:f.interval)&&void 0!==v?v:300}},a.initEvents(),a}return h(e,t),o(e,[{key:"initEvents",value:function(){var t=this.element;t&&(t.addEventListener("pointerdown",this.onStart),t.addEventListener("pointermove",this.onMove),t.addEventListener("pointerup",this.onEnd),t.addEventListener("pointerleave",this.onEnd),t.addEventListener("pointerupoutside",this.onEnd))}},{key:"removeEvents",value:function(){var t=this.element;t&&(t.removeEventListener("pointerdown",this.onStart),t.removeEventListener("pointermove",this.onMove),t.removeEventListener("pointerup",this.onEnd),t.removeEventListener("pointerleave",this.onEnd),t.removeEventListener("pointerupoutside",this.onEnd))}},{key:"release",value:function(){this.removeEvents(),this.element=null}},{key:"getEventType",value:function(t){var e,i=this.eventType,n=this.startTime,r=this.startPoints;return"press"===i?i:(e=kh.now()-n>this.config.press.time&&$x(r[0],t)<this.config.press.threshold?"press":"pan",this.eventType=e,e)}},{key:"enable",value:function(t){this.processEvent[t]=!0}},{key:"isProcess",value:function(t){return this.processEvent[t]}},{key:"pushEvent",value:function(t,e){for(var i=this.emitThrottles,n={type:t,ev:e},r=0,a=i.length;r<a;r++)if(i[r].type===t)return void i.splice(r,1,n);i.push(n)}},{key:"clearPressTimeout",value:function(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)}},{key:"reset",value:function(){this.clearPressTimeout(),this.startTime=0,this.startDistance=0,this.direction=null,this.eventType=null,this.prevMoveTime=0,this.prevMovePoint=null,this.lastMoveTime=0,this.lastMovePoint=null}},{key:"triggerEvent",value:function(t,e){var i=this;this.pushEvent(t,e);var n=this.throttleTimer,r=this.emitThrottles;n||(this.throttleTimer=al.global.getRequestAnimationFrame()((function(){al.global.getCancelAnimationFrame()(i.throttleTimer),i.throttleTimer=null;for(var t=0,e=r.length;t<e;t++){var n=r[t],a=n.type,o=n.ev;i.emitEvent(a,o)}i.emitThrottles.length=0})))}},{key:"triggerStartEvent",value:function(t,e){this.isProcess(t)||(this.enable(t),this.triggerEvent("".concat(t,"start"),e))}},{key:"triggerEndEvent",value:function(t){var e=this,i=this.processEvent;Object.keys(i).forEach((function(n){e.triggerEvent("".concat(n,"end"),t),"press"===n&&e.triggerEvent("".concat(n,"up"),t),delete i[n]}))}},{key:"emitEvent",value:function(t,e){if(this.element){var i=this.element._events["*"];if(i)if("fn"in i)i.fn.call(i.context,e,t);else for(var n=0,r=i.length;n<r&&!e.propagationImmediatelyStopped;n++)i[n].fn.call(i[n].context,e,t);this.emit(t,e)}}}])}(z),ek=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},ik=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},nk=[0,0,0],rk=function(){return o((function t(e,i){r(this,t),this.fillAttributes=Object.assign(Object.assign({},Eu),{opacity:1}),this.strokeAttributes=Object.assign(Object.assign({},Bu),{opacity:1}),this.textAttributes=Object.assign(Object.assign({},Ru),{opacity:1}),this._clearShadowStyle=!1,this._clearFilterStyle=!1,this._clearGlobalCompositeOperationStyle=!1;var n=e.nativeCanvas.getContext("2d");if(!n)throw new Error("发生错误，获取2d上下文失败");this.nativeContext=n,this.canvas=e,this.matrix=new xi(1,0,0,1,0,0),this.stack=[],this.dpr=i,this.applyedMatrix=new xi(1,0,0,1,0,0),this._clearMatrix=new xi(1,0,0,1,0,0),this.baseGlobalAlpha=1}),[{key:"fillStyle",get:function(){return this.nativeContext.fillStyle},set:function(t){this.nativeContext.fillStyle=t}},{key:"font",get:function(){var t;return null!==(t=this._font)&&void 0!==t?t:this.nativeContext.font},set:function(t){t!==this._font&&(this._font=t,this.nativeContext.font=t)}},{key:"globalAlpha",get:function(){return this.nativeContext.globalAlpha},set:function(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha}},{key:"lineCap",get:function(){return this.nativeContext.lineCap},set:function(t){this.nativeContext.lineCap=t}},{key:"lineDashOffset",get:function(){return this.nativeContext.lineDashOffset},set:function(t){this.nativeContext.lineDashOffset=t}},{key:"lineJoin",get:function(){return this.nativeContext.lineJoin},set:function(t){this.nativeContext.lineJoin=t}},{key:"lineWidth",get:function(){return this.nativeContext.lineWidth},set:function(t){this.nativeContext.lineWidth=t}},{key:"miterLimit",get:function(){return this.nativeContext.miterLimit},set:function(t){this.nativeContext.miterLimit=t}},{key:"shadowBlur",get:function(){return this.nativeContext.shadowBlur},set:function(t){this.nativeContext.shadowBlur=t}},{key:"shadowColor",get:function(){return this.nativeContext.shadowColor},set:function(t){this.nativeContext.shadowColor=t}},{key:"shadowOffsetX",get:function(){return this.nativeContext.shadowOffsetX},set:function(t){this.nativeContext.shadowOffsetX=t}},{key:"shadowOffsetY",get:function(){return this.nativeContext.shadowOffsetY},set:function(t){this.nativeContext.shadowOffsetY=t}},{key:"strokeStyle",get:function(){return this.nativeContext.strokeStyle},set:function(t){this.nativeContext.strokeStyle=t}},{key:"textAlign",get:function(){return this.nativeContext.textAlign},set:function(t){this.nativeContext.textAlign=t}},{key:"textBaseline",get:function(){return this.nativeContext.textBaseline},set:function(t){this.nativeContext.textBaseline=t}},{key:"inuse",get:function(){return!!this._inuse},set:function(t){t!==!!this._inuse&&(this._inuse=t,t?(this.nativeContext.save(),this.reset()):this.nativeContext.restore())}},{key:"reset",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stack.length&&Ot.getInstance().warn("可能存在bug，matrix没有清空"),this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new xi(1,0,0,1,0,0),this.stack.length=0,t&&this.nativeContext.setTransform(1,0,0,1,0,0)}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getContext",value:function(){return this.nativeContext}},{key:"setTransformForCurrent",value:function(){!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix.setValue(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f),this.nativeContext.setTransform(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f))}},{key:"currentMatrix",get:function(){return this.matrix}},{key:"cloneMatrix",value:function(t){return sf.allocateByObj(t)}},{key:"clear",value:function(){this.save(),this.resetTransform(),this.nativeContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.restore()}},{key:"restore",value:function(){this.nativeContext.restore(),this.stack.length>0&&(sf.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent(!0)),this.font="",this._clearFilterStyle=!1,this._clearShadowStyle=!1}},{key:"highPerformanceRestore",value:function(){this.stack.length>0&&(sf.free(this.matrix),this.matrix=this.stack.pop())}},{key:"rotate",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.matrix.rotate(t),e&&this.setTransformForCurrent()}},{key:"save",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t),this.nativeContext.save()}},{key:"highPerformanceSave",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t)}},{key:"scale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.scale(t,e),i&&this.setTransformForCurrent()}},{key:"setScale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.setScale(t,e),i&&this.setTransformForCurrent()}},{key:"scalePoint",value:function(t,e,i,n){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.translate(i,n,!1),this.scale(t,e,!1),this.translate(-i,-n,!1),r&&this.setTransformForCurrent()}},{key:"setTransform",value:function(t,e,i,n,r,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:this.dpr;this.matrix.setValue(s*t,s*e,s*i,s*n,s*r,s*a),o&&this.setTransformForCurrent()}},{key:"setTransformFromMatrix",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.dpr;this.matrix.setValue(t.a*i,t.b*i,t.c*i,t.d*i,t.e*i,t.f*i),e&&this.setTransformForCurrent()}},{key:"resetTransform",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransform(e,0,0,e,0,0),t&&this.setTransformForCurrent()}},{key:"transform",value:function(t,e,i,n,r,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];this.matrix.multiply(t,e,i,n,r,a),o&&this.setTransformForCurrent()}},{key:"transformFromMatrix",value:function(t,e){this.matrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f),e&&this.setTransformForCurrent()}},{key:"translate",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.translate(t,e),i&&this.setTransformForCurrent()}},{key:"rotateDegrees",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=t*Math.PI/180;this.rotate(i,e)}},{key:"rotateAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotate(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"rotateDegreesAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotateDegrees(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"beginPath",value:function(){this.disableBeginPath||this.nativeContext.beginPath()}},{key:"clip",value:function(t,e){t?"string"==typeof t?this.nativeContext.clip(t):this.nativeContext.clip(t,e):this.nativeContext.clip()}},{key:"arc",value:function(t,e,i,n,r,a,o){if(o=o||0,this.camera){var s=[];!function(t,e,i,n,r,a,o,s){if(s)for(;i>e;)i-=me;else for(;i<e;)i+=me;for(var l=ve/3*(i>e?1:-1),u=e,c=u;c!==i;){c=l>0?Math.min(c+l,i):Math.max(c+l,i);var h=Math.abs(c-u),d=4*Math.tan(h/4)/3,p=c<u?-1:1,f=Math.cos(u),v=Math.sin(u),g=Math.cos(c),y=Math.sin(c),m=f*a+n,_=v*o+r,b=g*a+n,x=y*o+r,k=a*d*p,S=o*d*p;t.push([m-k*v,_+S*f,b+k*y,x-S*g,b,x]),u=c}}(s,n,r,t,e,i,i,a);for(var l=0;l<s.length;++l){var u=s[l];this.bezierCurveTo(u[0],u[1],u[2],u[3],u[4],u[5],o)}}else this.nativeContext.arc(t,e,Math.max(0,i),n,r,a)}},{key:"arcTo",value:function(t,e,i,n,r){this.nativeContext.arcTo(t,e,i,n,r)}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a,o){if(o=o||0,this.camera){var s=o,l=o;this.modelMatrix&&(rf(nk,[t,e,o],this.modelMatrix),t=nk[0],e=nk[1],s=nk[2],rf(nk,[i,n,o],this.modelMatrix),i=nk[0],n=nk[1],l=nk[2],rf(nk,[r,a,o],this.modelMatrix),r=nk[0],a=nk[1],o=nk[2]);var u=this.camera.vp(r,a,o);r=u.x,a=u.y,t=(u=this.camera.vp(t,e,s)).x,e=u.y,i=(u=this.camera.vp(i,n,l)).x,n=u.y}this.nativeContext.bezierCurveTo(t,e,i,n,r,a)}},{key:"closePath",value:function(){this.nativeContext.closePath()}},{key:"ellipse",value:function(t,e,i,n,r,a,o,s){null==s?this.nativeContext.ellipse(t,e,i,n,r,a,o):this.nativeContext.ellipse(t,e,i,n,r,a,o,s)}},{key:"lineTo",value:function(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(rf(nk,[t,e,i],this.modelMatrix),t=nk[0],e=nk[1],i=nk[2]);var n=this.camera.vp(t,e,i);t=n.x,e=n.y}this.nativeContext.lineTo(t,e)}},{key:"moveTo",value:function(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(rf(nk,[t,e,i],this.modelMatrix),t=nk[0],e=nk[1],i=nk[2]);var n=this.camera.vp(t,e,i);t=n.x,e=n.y}this.nativeContext.moveTo(t,e)}},{key:"quadraticCurveTo",value:function(t,e,i,n,r){if(r=r||0,this.camera){var a=r;this.modelMatrix&&(rf(nk,[t,e,r],this.modelMatrix),t=nk[0],e=nk[1],a=nk[2],rf(nk,[i,n,r],this.modelMatrix),i=nk[0],n=nk[1],r=nk[2]);var o=this.camera.vp(i,n,r);i=o.x,n=o.y,t=(o=this.camera.vp(t,e,a)).x,e=o.y}this.nativeContext.quadraticCurveTo(t,e,i,n)}},{key:"rect",value:function(t,e,i,n,r){r=r||0,this.camera?(this.moveTo(t,e,r),this.lineTo(t+i,e,r),this.lineTo(t+i,e+n,r),this.lineTo(t,e+n,r),this.closePath()):this.nativeContext.rect(t,e,i,n)}},{key:"createImageData",value:function(){var t=arguments;return 2===t.length?this.nativeContext.createImageData(t[0],t[1]):1===t.length?this.nativeContext.createImageData(t[0]):null}},{key:"createLinearGradient",value:function(t,e,i,n){return isFinite(t+e+i+n)||(t=0,e=0,i=0,n=0),this.nativeContext.createLinearGradient(t,e,i,n)}},{key:"createPattern",value:function(t,e){return 0===t.width||0===t.height?null:this.nativeContext.createPattern(t,e)}},{key:"createRadialGradient",value:function(t,e,i,n,r,a){return this.nativeContext.createRadialGradient(t,e,i,n,r,a)}},{key:"createConicGradient",value:function(t,e,i,n){if(this.nativeContext.createConicGradient&&Math.abs(n-i-2*Math.PI)<.001)return this.nativeContext.createConicGradient(i,t,e);var r,a=!1,o=this;return{stops:[],addColorStop:function(t,e){this.stops.push([t,e]),a=!0},GetPattern:function(s,l,u){return a&&(u||(u=n-i),r=function(t,e,i,n,r,a,o,s,l){var u=Math.floor(180*r/Math.PI),c=wf.GetCanvas(),h=wf.GetCtx();if(!h)return null;var d=Ef.GetSize(s),p=Ef.GetSize(l),f=Ef.Get(e,i,n,a,o,d,p);if(f)return f;var v=Math.sqrt(Math.max(Math.max(Math.pow(i,2)+Math.pow(n,2),Math.pow(d-i,2)+Math.pow(n,2)),Math.max(Math.pow(d-i,2)+Math.pow(p-n,2),Math.pow(i,2)+Math.pow(p-n,2)))),g=u+1,y=r/Math.max(1,g-1),m=Cf.getInstance().GetOrCreate(i,n,d,p,e,g),_=2*Math.PI*v/360;c.width=d,c.height=p,h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,d,p),h.translate(i,n),h.rotate(a);for(var b=0,x=g-1;b<x&&!(a+b*y>o);b++){var k=m.getColor(b);h.beginPath(),h.rotate(y),h.moveTo(0,0),h.lineTo(v,-2*_),h.lineTo(v,0),h.fillStyle=k,h.closePath(),h.fill()}var S=h.getImageData(0,0,d,p);return c.width=S.width,c.height=S.height,h.putImageData(S,0,0),(f=t.createPattern(c,"no-repeat"))&&Ef.Set(e,i,n,a,o,f,d,p),f}(o,this.stops,t,e,u,i,n,s,l),a=!1),r}}}},{key:"fill",value:function(t,e){this.disableFill||(t?this.nativeContext.fill(t):this.nativeContext.fill())}},{key:"fillRect",value:function(t,e,i,n){this.nativeContext.fillRect(t,e,i,n)}},{key:"clearRect",value:function(t,e,i,n){this.nativeContext.clearRect(t,e,i,n)}},{key:"project",value:function(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(rf(nk,[t,e,i],this.modelMatrix),t=nk[0],e=nk[1],i=nk[2]);var n=this.camera.vp(t,e,i);t=n.x,e=n.y}return{x:t,y:e}}},{key:"view",value:function(t,e,i){return i=i||0,this.camera?(this.modelMatrix&&(rf(nk,[t,e,i],this.modelMatrix),t=nk[0],e=nk[1],i=nk[2]),this.camera.view(t,e,i)):[t,e,i]}},{key:"fillText",value:function(t,e,i,n){if(n=n||0,this.camera){this.modelMatrix&&(rf(nk,[e,i,n],this.modelMatrix),e=nk[0],i=nk[1],n=nk[2]);var r=this.camera.vp(e,i,n);e=r.x,i=r.y}this.nativeContext.fillText(t,e,i)}},{key:"getImageData",value:function(t,e,i,n){return this.nativeContext.getImageData(t,e,i,n)}},{key:"getLineDash",value:function(){return this.nativeContext.getLineDash()}},{key:"isPointInPath",value:function(t,e){return this.nativeContext.isPointInPath(t,e)}},{key:"isPointInStroke",value:function(t,e){return this.nativeContext.isPointInStroke(t,e)}},{key:"measureText",value:function(t){var e,i,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:al.global.measureTextMethod;if(!r||"native"===r)return this.nativeContext.measureText(t);this.mathTextMeasure||(this.mathTextMeasure=al.graphicUtil.createTextMeasureInstance({},{},(function(){return n.canvas.nativeCanvas})));var a=null!==(e=this.fontFamily)&&void 0!==e?e:Ru.fontFamily,o=null!==(i=this.fontSize)&&void 0!==i?i:Ru.fontSize;return this.mathTextMeasure.textSpec.fontFamily===a&&this.mathTextMeasure.textSpec.fontSize===o||(this.mathTextMeasure.textSpec.fontFamily=a,this.mathTextMeasure.textSpec.fontSize=o,this.mathTextMeasure._numberCharSize=null,this.mathTextMeasure._fullCharSize=null,this.mathTextMeasure._letterCharSize=null,this.mathTextMeasure._specialCharSizeMap={}),this.mathTextMeasure.measure(t,r)}},{key:"putImageData",value:function(t,e,i){this.nativeContext.putImageData(t,e,i)}},{key:"setLineDash",value:function(t){var e=arguments,i=this.nativeContext;this.nativeContext.setLineDash?e[0]&&i.setLineDash(e[0]):"mozDash"in i?i.mozDash=e[0]:"webkitLineDash"in i&&(i.webkitLineDash=e[0])}},{key:"stroke",value:function(t){this.disableStroke||(t?this.nativeContext.stroke(t):this.nativeContext.stroke())}},{key:"strokeRect",value:function(t,e,i,n){this.nativeContext.strokeRect(t,e,i,n)}},{key:"strokeText",value:function(t,e,i,n){if(n=n||0,this.camera){this.modelMatrix&&(rf(nk,[e,i,n],this.modelMatrix),e=nk[0],i=nk[1],n=nk[2]);var r=this.camera.vp(e,i,n);e=r.x,i=r.y}this.nativeContext.strokeText(t,e,i)}},{key:"drawImage",value:function(){var t=this.nativeContext,e=arguments;3===e.length?t.drawImage(e[0],e[1],e[2]):5===e.length?t.drawImage(e[0],e[1],e[2],e[3],e[4]):9===e.length&&t.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}},{key:"setCommonStyle",value:function(t,e,i,n,r){if(Array.isArray(r)){if(r.length<=1)return this._setCommonStyle(t,e,i,n,r[0]);var a=Object.create(r[0]);return r.forEach((function(t,e){0!==e&&Object.assign(a,t)})),this._setCommonStyle(t,e,i,n,a)}return this._setCommonStyle(t,e,i,n,r)}},{key:"_setCommonStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.fillAttributes);var o=e.fillOpacity,s=void 0===o?r.fillOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l,c=e.fill,h=void 0===c?r.fill:c;a.globalAlpha=s*u*this.baseGlobalAlpha,s>1e-12&&u>1e-12&&(a.fillStyle=tc(this,h,t,i,n))}},{key:"setShadowBlendStyle",value:function(t,e,i){if(Array.isArray(i)){if(i.length<=1)return this._setShadowBlendStyle(t,i[0]);var n=Object.create(i[0]);return i.forEach((function(t,e){0!==e&&Object.assign(n,t)})),this._setShadowBlendStyle(t,e,n)}return this._setShadowBlendStyle(t,e,i)}},{key:"_setShadowBlendStyle",value:function(t,e,i){var n=this.nativeContext;i||(i=this.fillAttributes);var r=e.opacity,a=void 0===r?i.opacity:r,o=e.shadowBlur,s=void 0===o?i.shadowBlur:o,l=e.shadowOffsetX,u=void 0===l?i.shadowOffsetX:l,c=e.shadowOffsetY,h=void 0===c?i.shadowOffsetY:c,d=e.blur,p=void 0===d?i.blur:d,f=e.globalCompositeOperation,v=void 0===f?i.globalCompositeOperation:f;if(!(a<=1e-12)){if(u||h||s){var g=e.shadowColor,y=void 0===g?i.shadowColor:g,m=e.shadowOffsetX,_=void 0===m?i.shadowOffsetX:m,b=e.shadowOffsetY,x=void 0===b?i.shadowOffsetY:b;n.shadowBlur=s*this.dpr,n.shadowColor=y,n.shadowOffsetX=_*this.dpr,n.shadowOffsetY=x*this.dpr,this._clearShadowStyle=!0}else this._clearShadowStyle&&(n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0);p?(n.filter="blur(".concat(p,"px)"),this._clearFilterStyle=!0):this._clearFilterStyle&&(n.filter="blur(0px)",this._clearFilterStyle=!1),v?(n.globalCompositeOperation=v,this._clearGlobalCompositeOperationStyle=!0):this._clearGlobalCompositeOperationStyle&&(n.globalCompositeOperation="source-over",this._clearGlobalCompositeOperationStyle=!1)}}},{key:"setStrokeStyle",value:function(t,e,i,n,r){if(Array.isArray(r)){if(r.length<=1)return this._setStrokeStyle(t,e,i,n,r[0]);var a=Object.create(r[0]);return r.forEach((function(t,e){0!==e&&Object.assign(a,t)})),this._setStrokeStyle(t,e,i,n,a)}return this._setStrokeStyle(t,e,i,n,r)}},{key:"_setStrokeStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.strokeAttributes);var o=e.strokeOpacity,s=void 0===o?r.strokeOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l;if(a.globalAlpha=s*u*this.baseGlobalAlpha,s>1e-12&&u>1e-12){var c=e.lineWidth,h=void 0===c?r.lineWidth:c,d=e.stroke,p=void 0===d?r.stroke:d,f=e.lineJoin,v=void 0===f?r.lineJoin:f,g=e.lineDash,y=void 0===g?r.lineDash:g,m=e.lineDashOffset,_=void 0===m?r.lineDashOffset:m,b=e.lineCap,x=void 0===b?r.lineCap:b,k=e.miterLimit,S=void 0===k?r.miterLimit:k,A=e.keepStrokeScale,M=void 0===A?r.keepStrokeScale:A;a.lineWidth=M?h:$u(this,h,this.dpr),a.strokeStyle=tc(this,p,t,i,n),a.lineJoin=v,y&&(a.setLineDash(y),a.lineDashOffset=_),a.lineCap=x,a.miterLimit=S}}},{key:"setTextStyleWithoutAlignBaseline",value:function(t,e,i){var n=this.nativeContext;e||(e=this.textAttributes);var r=t.scaleIn3d,a=void 0===r?e.scaleIn3d:r;t.font?this.font=t.font:this.font=di(t,e,a&&this.camera&&this.camera.getProjectionScale(i));var o=t.fontFamily,s=void 0===o?e.fontFamily:o,l=t.fontSize,u=void 0===l?e.fontSize:l;this.fontFamily=s,this.fontSize=u,n.textAlign="left",n.textBaseline="alphabetic"}},{key:"setTextStyle",value:function(t,e,i){var n,r,a=this.nativeContext;e||(e=this.textAttributes),t.font?this.font=t.font:this.font=di(t,e,this.camera&&this.camera.getProjectionScale(i));var o=t.fontFamily,s=void 0===o?e.fontFamily:o,l=t.fontSize,u=void 0===l?e.fontSize:l;this.fontFamily=s,this.fontSize=u,a.textAlign=null!==(n=t.textAlign)&&void 0!==n?n:e.textAlign,a.textBaseline=null!==(r=t.textBaseline)&&void 0!==r?r:e.textBaseline}},{key:"draw",value:function(){}},{key:"clearMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransformFromMatrix(this._clearMatrix,t,e)}},{key:"setClearMatrix",value:function(t,e,i,n,r,a){this._clearMatrix.setValue(t,e,i,n,r,a)}},{key:"onlyTranslate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dpr;return this.matrix.a===t&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===t}},{key:"release",value:function(){this.stack.forEach((function(t){return sf.free(t)})),this.stack.length=0}}])}();rk.env="browser",rk=ek([Ps(),ik("design:paramtypes",[Object,Number])],rk);var ak=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},ok=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},sk=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(t){var e=t.container;if("string"==typeof e){var i=al.global.getElementById(e);i&&(this._container=i)}else this._container=e;this._context=new rk(this,this._dpr),this.initStyle()}},{key:"initStyle",value:function(){if(this.controled){var t=this.nativeCanvas;t.width=this._pixelWidth,t.height=this._pixelHeight,!t.style||this.setCanvasStyle(t,this._x,this._y,this._displayWidth,this._displayHeight),this._container&&this._container.appendChild(t),this.visiable||this.hide()}}},{key:"hide",value:function(){this._nativeCanvas&&(this._nativeCanvas.style.display="none")}},{key:"show",value:function(){this._nativeCanvas&&(this._nativeCanvas.style.display="block")}},{key:"applyPosition",value:function(){var t=this._nativeCanvas;t.style.position="absolute",t.style.top="".concat(this._y,"px"),t.style.left="".concat(this._x,"px")}},{key:"resetStyle",value:function(t){if(this.controled){var e=t.width,i=void 0===e?this._displayWidth:e,n=t.height,r=void 0===n?this._displayHeight:n,a=t.dpr,o=void 0===a?this._dpr:a,s=t.x,l=void 0===s?this._x:s,u=t.y,c=void 0===u?this._y:u,h=this.nativeCanvas;h.width=i*o,h.height=r*o,!h.style||this.setCanvasStyle(h,l,c,i,r),t.id&&(h.id=t.id),this.visiable||this.hide()}}},{key:"setCanvasStyle",value:function(t,e,i,n,r){this.controled&&(t.style.width="".concat(n,"px"),t.style.height="".concat(r,"px"))}},{key:"toDataURL",value:function(t,e){return"image/jpeg"===t?this._nativeCanvas.toDataURL(t,e):"image/png"===t?this._nativeCanvas.toDataURL(t):this._nativeCanvas.toDataURL(t,e)}},{key:"resize",value:function(t,e){this.controled&&(this._pixelWidth=t*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=t,this._displayHeight=e,this._nativeCanvas.style&&(this._nativeCanvas.style.width="".concat(t,"px"),this._nativeCanvas.style.height="".concat(e,"px")),this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._context.dpr=this._dpr)}}])}(mf);function lk(t,e){return new ys((function(i){i(mc).toDynamicValue((function(){return function(e){return new t(e)}})).whenTargetNamed(t.env),i(_c).toDynamicValue((function(){return function(t,i){return new e(t,i)}})).whenTargetNamed(e.env)}))}sk.env="browser";var uk=lk(sk=ak([Ps(),ok("design:paramtypes",[Object])],sk),rk),ck=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},hk=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},dk=function(t,e){return function(i,n){e(i,n,t)}},pk=function(t){function e(t,i,a,o){var s;return r(this,e),(s=n(this,e,[a,o])).contributions=t,s.drawContribution=i,s.pickItemInterceptorContributions=a,s.pickServiceInterceptorContributions=o,s.global.hooks.onSetEnv.tap("canvas-picker-service",(function(t,e,i){s.configure(i,e)})),s.configure(s.global,s.global.env),s.pickerMap=new Map,s.init(),s}return h(e,t),o(e,[{key:"init",value:function(){var t=this;this.contributions.getContributions().forEach((function(e){t.pickerMap.set(e.numberType,e)})),_(e,"_init",this,3)([])}},{key:"configure",value:function(t,e){this.pickCanvas=qc.shareCanvas(),this.pickContext=this.pickCanvas.getContext("2d")}},{key:"pickItem",value:function(t,e,i,n){if(!1===t.attribute.pickable)return null;if(this.InterceptorContributions.length)for(var r=0;r<this.InterceptorContributions.length;r++){var a=this.InterceptorContributions[r];if(a.beforePickItem){var o=a.beforePickItem(t,this,e,n,{parentMatrix:i});if(o)return o}}var s=this.pickerMap.get(t.numberType);if(!s)return null;var l=s.contains(t,e,n),u=l?t:null,c={graphic:u,params:l};if(u)return c;if(this.InterceptorContributions.length)for(var h=0;h<this.InterceptorContributions.length;h++){var d=this.InterceptorContributions[h];if(d.afterPickItem){var p=d.afterPickItem(t,this,e,n,{parentMatrix:i});if(p)return p}}return c}}])}(pb);pk=ck([Ps(),dk(0,Cs(Xs)),dk(0,Bs(Zx)),dk(1,Cs(Lm)),dk(2,Cs(Xs)),dk(2,Bs($m)),dk(3,Cs(Xs)),dk(3,Bs(t_)),hk("design:paramtypes",[Object,Object,Object,Object])],pk);var fk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},vk=function(){return o((function t(){r(this,t),this.type="group",this.numberType=Hp}),[{key:"contains",value:function(t,e,i){return!1}}])}();vk=fk([Ps()],vk);var gk=new ys((function(t,e,i,n){gk.__vloaded||(gk.__vloaded=!0,t(qx).to(vk).inSingletonScope(),t(Zx).toService(qx),qs(t,Zx))}));gk.__vloaded=!1;var yk=gk,mk=new ys((function(t,e,i,n){i(pk)||t(pk).toSelf().inSingletonScope(),i(Jm)?n(Jm).toService(pk):t(Jm).toService(pk)}));function _k(t){t.load(yk),t.load(mk)}var bk,xk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},kk=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Sk=bk=function(t){function e(){var t;return r(this,e),(t=n(this,e)).type="browser",t._canvasIsIntersecting=!0,t.global=al.global,t.viewBox=new _i,t.modelMatrix=new xi(1,0,0,1,0,0),t}return h(e,t),o(e,[{key:"container",get:function(){return this.canvas.nativeCanvas.parentElement}},{key:"getTitle",value:function(){return this.canvas.id&&this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return this.canvas.nativeCanvas.getBoundingClientRect()}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t),this.postInit()}},{key:"postInit",value:function(){if(this.global.optimizeVisible)try{this.observerCanvas()}catch(t){console.error("发生错误，该环境不存在IntersectionObserver")}}},{key:"isElementVisible",value:function(t){var e=t.getBoundingClientRect(),i=window.innerWidth||document.documentElement.clientWidth,n=window.innerHeight||document.documentElement.clientHeight;return!(e.right<0||e.bottom<0||e.left>i||e.top>n)}},{key:"observerCanvas",value:function(){var t=this;this._canvasIsIntersecting=this.isElementVisible(this.canvas.nativeCanvas);var e=new IntersectionObserver((function(e,i){e.forEach((function(e){t._canvasIsIntersecting!==e.isIntersecting?(t._canvasIsIntersecting=e.isIntersecting,t._onVisibleChangeCb&&t._onVisibleChangeCb(e.isIntersecting)):t._canvasIsIntersecting=e.isIntersecting}))}));e&&e.observe(this.canvas.nativeCanvas)}},{key:"createWindowByConfig",value:function(t){var e,i=this.global.createCanvas({width:t.width,height:t.height});if(!(e="string"==typeof t.container?this.global.getElementById(t.container):t.container?t.container:this.global.getRootElement()))throw new Error("发生错误，containerId可能传入有误");t.offscreen?e=null:e.appendChild(i);var n={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:i,container:e,id:bk.GenerateCanvasId(),canvasControled:!0};this.canvas=new sk(n)}},{key:"createWindowByCanvas",value:function(t){var e,i;if("string"==typeof t.canvas){if(!(i=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else i=t.canvas;if(!i)throw new Error("发生错误，传入的canvas不正确");var n=t.width,r=t.height;if(null==n||null==r||!t.canvasControled){var a=i.getBoundingClientRect();n=a.width,r=a.height}var o=t.dpr;null==o&&(o=null!==(e=i.getContext("2d").pixelRatio)&&void 0!==e?e:i.width/n),this.canvas=new sk({width:n,height:r,dpr:o,nativeCanvas:i,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){this.canvas.release()}},{key:"resizeWindow",value:function(t,e){this.canvas.resize(t,e)}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e,i){return this.canvas.nativeCanvas.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,e,i){return this.canvas.nativeCanvas.removeEventListener(t,e,i)}},{key:"dispatchEvent",value:function(t){return this.canvas.nativeCanvas.dispatchEvent(t)}},{key:"getStyle",value:function(){var t;return null!==(t=this.canvas.nativeCanvas.style)&&void 0!==t?t:{}}},{key:"setStyle",value:function(t){this.canvas.nativeCanvas.style=t}},{key:"getBoundingClientRect",value:function(){var t=this.canvas.nativeCanvas,e=this.getWH();return t.parentElement?this.canvas.nativeCanvas.getBoundingClientRect():{x:0,y:0,width:e.width,height:e.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}},{key:"isVisible",value:function(t){return this._canvasIsIntersecting}},{key:"onVisibleChange",value:function(t){this._onVisibleChangeCb=t}},{key:"getTopLeft",value:function(t){return this.global.getElementTopLeft(this.canvas.nativeCanvas,t)}}],[{key:"GenerateCanvasId",value:function(){return"".concat(bk.idprefix,"_").concat(bk.prefix_count++)}}])}(ub);Sk.env="browser",Sk.idprefix="visactor_window",Sk.prefix_count=0,Sk=bk=xk([Ps(),kk("design:paramtypes",[])],Sk);var Ak=new ys((function(t){t(Sk).toSelf(),t($c).toDynamicValue((function(t){return t.container.get(Sk)})).whenTargetNamed(Sk.env)})),Mk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Tk=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},wk=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))},Ck=function(){return o((function t(e){r(this,t),this.dom=e}),[{key:"x1",get:function(){return this.dom.getBoundingClientRect().left}},{key:"x2",get:function(){return this.dom.getBoundingClientRect().right}},{key:"y1",get:function(){return this.dom.getBoundingClientRect().top}},{key:"y2",get:function(){return this.dom.getBoundingClientRect().bottom}},{key:"width",get:function(){return this.dom.getBoundingClientRect().width}},{key:"height",get:function(){return this.dom.getBoundingClientRect().height}}])}();function Ek(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=document.createElement("img");if(al.global.isImageAnonymous&&(i.crossOrigin="anonymous"),e){var n=new Blob([t],{type:"image/svg+xml"});t=window.URL.createObjectURL(n)}return i.src=t,i.complete?Promise.resolve(i):new Promise((function(t,e){i.onload=function(){t(i)},i.onerror=function(){e(new Error("加载失败"))}}))}var Pk=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="browser",t.supportEvent=!0;try{t.supportsTouchEvents="ontouchstart"in globalThis,t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsTouchEvents=!1,t.supportsPointerEvents=!1,t.supportsPointerEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"mapToCanvasPoint",value:function(t,e){var i,n,r=0,a=0,o=0,s=0;if(t.changedTouches){var l=null!==(i=t.changedTouches[0])&&void 0!==i?i:{};o=r=l.clientX||0,s=a=l.clientY||0}else r=t.clientX||0,a=t.clientY||0,o=t.offsetX||0,s=t.offsetY||0;if(e){var u,c,h=r,d=a,p=e.getBoundingClientRect(),f=null===(n=e.getNativeHandler)||void 0===n?void 0:n.call(e).nativeCanvas;return f&&(u=p.width/f.offsetWidth,c=p.height/f.offsetHeight),{x:(h-p.left)/(et(u)?u:1),y:(d-p.top)/(et(c)?c:1)}}return{x:o,y:s}}},{key:"getNativeAABBBounds",value:function(t){var e=t;if("string"==typeof t&&((e=(new DOMParser).parseFromString(t,"text/html").firstChild).lastChild&&(e=e.lastChild.firstChild)),e.getBoundingClientRect){var i=e.getBoundingClientRect();return new Ck(i)}return new _i}},{key:"removeDom",value:function(t){return t.parentElement.removeChild(t),!0}},{key:"updateDom",value:function(t,e){var i=e.width,n=e.height,r=e.style;return r&&(K(r)?t.setAttribute("style",r):Object.keys(r).forEach((function(e){t.style[e]=r[e]}))),null!=i&&(t.style.width="".concat(i,"px")),null!=n&&(t.style.height="".concat(n,"px")),!0}},{key:"createDom",value:function(t){var e=t.tagName,i=void 0===e?"div":e,n=t.parent,r=document.createElement(i);if(this.updateDom(r,t),n){var a=K(n)?this.getElementById(n):n;a&&a.appendChild&&a.appendChild(r)}return r}},{key:"loadImage",value:function(t){return Ek(t,!1).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadSvg",value:function(t){return Ek(t,!0).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"createCanvas",value:function(t){var e,i,n=document.createElement("canvas");t.id&&(n.id=null!==(e=t.id)&&void 0!==e?e:gs.GenAutoIncrementId().toString());var r=null!==(i=t.dpr)&&void 0!==i?i:window.devicePixelRatio;return t.width&&t.height&&(n.style.width="".concat(t.width,"px"),n.style.height="".concat(t.height,"px"),n.width=t.width*r,n.height=t.height*r),n}},{key:"createOffscreenCanvas",value:function(t){var e,i=null!==(e=t.dpr)&&void 0!==e?e:window.devicePixelRatio;return new OffscreenCanvas(t.width*i,t.height*i)}},{key:"releaseCanvas",value:function(t){var e;(e="string"==typeof t?document.getElementById(t):t)&&e.parentElement&&e.parentElement.removeChild(e)}},{key:"getDevicePixelRatio",value:function(){return window.devicePixelRatio}},{key:"getRequestAnimationFrame",value:function(){return window.requestAnimationFrame}},{key:"getCancelAnimationFrame",value:function(){return window.cancelAnimationFrame}},{key:"addEventListener",value:function(t,e,i){return document.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,e,i){return document.removeEventListener(t,e,i)}},{key:"dispatchEvent",value:function(t){return document.dispatchEvent(t)}},{key:"getElementById",value:function(t){return document.getElementById(t)}},{key:"getRootElement",value:function(){return document.body}},{key:"getDocument",value:function(){return document}},{key:"release",value:function(){}},{key:"getElementTop",value:function(t,e){for(var i=t.offsetTop,n=t.offsetParent;null!==n;)i+=n.offsetTop,n=n.offsetParent;return i}},{key:"getElementLeft",value:function(t,e){for(var i=t.offsetLeft,n=t.offsetParent;null!==n;)i+=n.offsetLeft,n=n.offsetParent;return i}},{key:"getElementTopLeft",value:function(t,e){for(var i=t.offsetTop,n=t.offsetLeft,r=t.offsetParent;null!==r;)i+=r.offsetTop,n+=r.offsetLeft,r=r.offsetParent;return{top:i,left:n}}},{key:"loadFont",value:function(t,e,i){return wk(this,void 0,void 0,f().m((function n(){return f().w((function(n){for(;;)if(0===n.n)return n.a(2,new FontFace(t,K(e)?"url(".concat(e,")"):e,i).load().then((function(t){return document.fonts.add(t),{loadState:"success"}})).catch((function(t){return console.error("Failed to load font:",t),{loadState:"fail"}})))}),n)})))}},{key:"isMacOS",value:function(){if(void 0===this._isMacOS)try{this._isMacOS=navigator.platform.toUpperCase().indexOf("MAC")>=0}catch(t){this._isMacOS=!1}return this._isMacOS}},{key:"copyToClipBoard",value:function(t){return navigator.clipboard.writeText(t).then((function(){})).catch((function(t){}))}}])}(ob);Pk=Mk([Ps(),Tk("design:paramtypes",[])],Pk);var Bk=new ys((function(t){Bk.isBrowserBound||(Bk.isBrowserBound=!0,t(Pk).toSelf().inSingletonScope(),t(nl).toService(Pk))}));function Rk(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Rk.__loaded||(Rk.__loaded=!0,t.load(Bk),t.load(uk),t.load(Ak),e&&_k(t))}Bk.isBrowserBound=!1,Rk.__loaded=!1;var Lk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Ik=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"globalAlpha",get:function(){return this._globalAlpha},set:function(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}},{key:"getImageData",value:function(t,e,i,n){var r=this;return new Promise((function(a,o){var s;try{tt.canvasGetImageData({canvasId:null!==(s=r.canvas.nativeCanvas.id)&&void 0!==s?s:r.canvas.id,x:t,y:e,width:i,height:n,success:function(t){a(t)}})}catch(t){o(t)}}))}},{key:"draw",value:function(){var t=this,e=this.nativeContext;e.draw&&(this.drawPromise=new Promise((function(i){e.draw(!0,(function(){t.drawPromise=null,i(null)}))})))}},{key:"createPattern",value:function(t,e){return null}}])}(rk);Ik.env="feishu",Ik=Lk([Ps()],Ik);var Dk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Ok=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Fk=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new Ik(this,this._dpr)}},{key:"release",value:function(){}}])}(mf);Fk.env="feishu";var zk=lk(Fk=Dk([Ps(),Ok("design:paramtypes",[Object])],Fk),Ik),Hk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Nk=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Vk=function(t,e){return function(i,n){e(i,n,t)}},jk=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),Uk=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="feishu",i.eventManager=new jk,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:gs.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new Fk(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var a=t.dpr;null==a&&(a=e.width/i),this.canvas=new Fk({width:i,height:n,dpr:a,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(ub);Uk.env="feishu",Uk=Hk([Ps(),Vk(0,Cs(rl)),Nk("design:paramtypes",[Object])],Uk);var Wk=new ys((function(t){t(Uk).toSelf(),t($c).toDynamicValue((function(t){return t.container.get(Uk)})).whenTargetNamed(Uk.env)})),Gk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Yk=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Xk=function(t,e){return function(i,n){e(i,n,t)}},Kk=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e,[i,a])).contributions=t,o.pickItemInterceptorContributions=i,o.pickServiceInterceptorContributions=a,o.global.hooks.onSetEnv.tap("math-picker-service",(function(t,e,i){o.configure(i,e)})),o.configure(o.global,o.global.env),o.pickerMap=new Map,o.init(),o}return h(e,t),o(e,[{key:"init",value:function(){var t=this;this.contributions.getContributions().forEach((function(e){t.pickerMap.set(e.numberType,e)})),_(e,"_init",this,3)([])}},{key:"configure",value:function(t,e){this.pickContext=new pf(null,1)}},{key:"pickItem",value:function(t,e,i,n){if(!1===t.attribute.pickable)return null;var r=this.pickerMap.get(t.numberType);if(!r)return null;var a=r.contains(t,e,n),o=a?t:null;return o?{graphic:o,params:a}:null}}])}(pb);Kk=Gk([Ps(),Xk(0,Cs(Xs)),Xk(0,Bs(Ax)),Xk(1,Cs(Xs)),Xk(1,Bs($m)),Xk(2,Cs(Xs)),Xk(2,Bs(t_)),Yk("design:paramtypes",[Object,Object,Object])],Kk);var qk=new ys((function(t){qk.__vloaded||(qk.__vloaded=!0,qs(t,Ax))}));qk.__vloaded=!1;var Zk=qk,Jk=function(){return o((function t(){r(this,t)}),[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;if(!this.canvasRenderer)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.getGraphicTheme();n.highPerformanceSave();var a=t.attribute,o=a.x,s=void 0===o?r.x:o,l=a.y,u=void 0===l?r.y:l;if(t.transMatrix.onlyTranslate()){var c=t.getOffsetXY(r);s+=c.x,u+=c.y,n.setTransformForCurrent()}else s=0,u=0,n.transformFromMatrix(t.transMatrix,!0);var h=!1,d=!1;return this.canvasRenderer.drawShape(t,n,s,u,{},null,(function(t,i,n,r){return!(!h&&!d)||(h=t.isPointInPath(e.x,e.y),d=r||d,h)}),(function(t,i,r,a){if(h||d)return!0;var o=i.lineWidth||r.lineWidth,s=i.pickStrokeBuffer||r.pickStrokeBuffer,l=i.keepStrokeScale||r.keepStrokeScale;return n.lineWidth=l?o+s:$u(n,o+s,n.dpr),h=t.isPointInStroke(e.x,e.y),d=a||d,h})),n.highPerformanceRestore(),h}}])}(),Qk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},$k=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},tS=function(t,e){return function(i,n){e(i,n,t)}},eS=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="arc",i.numberType=Ip,i}return h(e,t),o(e)}(Jk);eS=Qk([Ps(),tS(0,Cs(_m)),$k("design:paramtypes",[Object])],eS);var iS=!1,nS=new ys((function(t,e,i,n){iS||(iS=!0,t(Mx).to(eS).inSingletonScope(),t(Ax).toService(Mx))})),rS=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},aS=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},oS=function(t,e){return function(i,n){e(i,n,t)}},sS=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="area",i.numberType=Op,i}return h(e,t),o(e)}(Jk);sS=rS([Ps(),oS(0,Cs(bm)),aS("design:paramtypes",[Object])],sS);var lS=!1,uS=new ys((function(t,e,i,n){lS||(lS=!0,t(Tx).to(sS).inSingletonScope(),t(Ax).toService(Tx))})),cS=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},hS=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},dS=function(t,e){return function(i,n){e(i,n,t)}},pS=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="circle",i.numberType=Fp,i}return h(e,t),o(e)}(Jk);pS=cS([Ps(),dS(0,Cs(xm)),hS("design:paramtypes",[Object])],pS);var fS=!1,vS=new ys((function(t,e,i,n){fS||(fS=!0,t(Cx).to(pS).inSingletonScope(),t(Ax).toService(Cx))})),gS=function(){return o((function t(){r(this,t),this.type="glyph",this.numberType=zp}),[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;if(!(null!=i?i:{}).pickContext)return!1;var n=null==i?void 0:i.pickerService;if(n){var r=!1;return t.getSubGraphic().forEach((function(t){if(!r){var a=n.pickItem(t,e,null,i);r=!(!a||!a.graphic)}})),r}return!1}}])}(),yS=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},mS=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},_S=function(t,e){return function(i,n){e(i,n,t)}},bS=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i}return h(e,t),o(e)}(gS);bS=yS([Ps(),_S(0,Cs(Bm)),mS("design:paramtypes",[Object])],bS);var xS=!1,kS=new ys((function(t,e,i,n){xS||(xS=!0,t(Ox).to(bS).inSingletonScope(),t(bS).toService(Ox))})),SS=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},AS=function(){return o((function t(){r(this,t),this.type="image",this.numberType=Np}),[{key:"contains",value:function(t,e,i){return!!(null!=i?i:{}).pickContext&&!!t.AABBBounds.containsPoint(e)}}])}();AS=SS([Ps()],AS);var MS=!1,TS=new ys((function(t,e,i,n){MS||(MS=!0,t(Ex).to(AS).inSingletonScope(),t(AS).toService(Ex))})),wS=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},CS=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},ES=function(t,e){return function(i,n){e(i,n,t)}},PS=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="line",i.numberType=Vp,i}return h(e,t),o(e)}(Jk);PS=wS([Ps(),ES(0,Cs(Am)),CS("design:paramtypes",[Object])],PS);var BS=!1,RS=new ys((function(t,e,i,n){BS||(BS=!0,t(Px).to(PS).inSingletonScope(),t(Ax).toService(Px))})),LS=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},IS=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},DS=function(t,e){return function(i,n){e(i,n,t)}},OS=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="polygon",i.numberType=Up,i}return h(e,t),o(e)}(Jk);OS=LS([Ps(),DS(0,Cs(Tm)),IS("design:paramtypes",[Object])],OS);var FS=!1,zS=new ys((function(t,e,i,n){FS||(FS=!0,t(Dx).to(OS).inSingletonScope(),t(Ax).toService(Dx))})),HS=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},NS=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},VS=function(t,e){return function(i,n){e(i,n,t)}},jS=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="path",i.numberType=jp,i}return h(e,t),o(e)}(Jk);jS=HS([Ps(),VS(0,Cs(Mm)),NS("design:paramtypes",[Object])],jS);var US=!1,WS=new ys((function(t,e,i,n){US||(US=!0,t(Bx).to(jS).inSingletonScope(),t(Ax).toService(Bx))})),GS=new _i,YS=function(){return o((function t(){r(this,t),this.type="rect",this.numberType=Wp}),[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.getGraphicTheme(),a=t.attribute.cornerRadius,o=void 0===a?r.cornerRadius:a,s=t.attribute,l=s.x,u=void 0===l?r.x:l,c=s.y,h=void 0===c?r.y:c;n.highPerformanceSave();var d=!0;if(t.transMatrix.onlyTranslate()){var p=t.getOffsetXY(r);u+=p.x,h+=p.y,n.setTransformForCurrent()}else u=0,h=0,d=!1,n.transformFromMatrix(t.transMatrix,!0);var f=!0;if(!d||t.shadowRoot||Q(o,!0)&&0!==o||q(o)&&o.some((function(t){return 0!==t})))f=!1,this.canvasRenderer.drawShape(t,n,u,h,{},null,(function(t,i,n){return!!f||(f=t.isPointInPath(e.x,e.y))}),(function(t,i,r){if(f)return!0;var a=i.lineWidth||r.lineWidth,o=i.pickStrokeBuffer||r.pickStrokeBuffer,s=i.keepStrokeScale||r.keepStrokeScale;return n.lineWidth=s?a+o:$u(n,a+o,n.dpr),f=t.isPointInStroke(e.x,e.y)}));else{var v=t.attribute,g=v.fill,y=void 0===g?r.fill:g,m=v.stroke,_=void 0===m?r.stroke:m,b=v.lineWidth,x=void 0===b?r.lineWidth:b;if(y)f=!0;else if(_){var k=t.AABBBounds;GS.setValue(k.x1,k.y1,k.x2,k.y2),GS.expand(-x/2),f=!GS.containsPoint(e)}}return n.highPerformanceRestore(),f}}])}(),XS=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},KS=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},qS=function(t,e){return function(i,n){e(i,n,t)}},ZS=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i}return h(e,t),o(e)}(YS);ZS=XS([Ps(),qS(0,Cs(wm)),KS("design:paramtypes",[Object])],ZS);var JS=!1,QS=new ys((function(t,e,i,n){JS||(JS=!0,t(Rx).to(ZS).inSingletonScope(),t(Ax).toService(Rx))})),$S=!1,tA=new ys((function(t,e,i,n){$S||($S=!0,t(Ex).to(AS).inSingletonScope(),t(AS).toService(Ex))})),eA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},iA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},nA=function(t,e){return function(i,n){e(i,n,t)}},rA=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="symbol",i.numberType=Yp,i}return h(e,t),o(e)}(Jk);rA=eA([Ps(),nA(0,Cs(Cm)),iA("design:paramtypes",[Object])],rA);var aA=!1,oA=new ys((function(t,e,i,n){aA||(aA=!0,t(Lx).to(rA).inSingletonScope(),t(Ax).toService(Lx))})),sA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},lA=function(){return o((function t(){r(this,t),this.type="text",this.numberType=Xp}),[{key:"contains",value:function(t,e,i){return!!t.AABBBounds.containsPoint(e)}}])}();lA=sA([Ps()],lA);var uA=!1,cA=new ys((function(t,e,i,n){uA||(uA=!0,t(Ix).to(lA).inSingletonScope(),t(Ax).toService(Ix))})),hA=new ys((function(t,e,i,n){i(Kk)||t(Kk).toSelf().inSingletonScope(),i(Jm)?n(Jm).toService(Kk):t(Jm).toService(Kk)}));function dA(t){t.load(Zk),t.load(hA),t.load(nS),t.load(uS),t.load(vS),t.load(kS),t.load(TS),t.load(RS),t.load(zS),t.load(WS),t.load(QS),t.load(tA),t.load(oA),t.load(cA)}var pA=function(){return o((function t(e,i,n,a,o,s){r(this,t),this.nativeCanvas=e,this.ctx=i,this._w=a,this._h=o,this.id=s,e.id=s,this.dpr=n}),[{key:"width",get:function(){return this._w*this.dpr},set:function(t){}},{key:"height",get:function(){return this._h*this.dpr},set:function(t){}},{key:"offsetWidth",get:function(){return this._w},set:function(t){}},{key:"offsetHeight",get:function(){return this._h},set:function(t){}},{key:"getContext",value:function(){return this.ctx}},{key:"getBoundingClientRect",value:function(){return{width:this._w,height:this._h}}}])}(),fA=function(){return o((function t(e,i,n,a,o,s){r(this,t),this.nativeCanvas=e,this.ctx=i,this._w=a,this._h=o,this.id=s,e.id=s,this.dpr=n}),[{key:"width",get:function(){return this._w*this.dpr},set:function(t){this._w=t/this.dpr,this.nativeCanvas.width=t}},{key:"height",get:function(){return this._h*this.dpr},set:function(t){this._h=t/this.dpr,this.nativeCanvas.height=t}},{key:"offsetWidth",get:function(){return this._w},set:function(t){this._w=t,this.nativeCanvas.width=t*this.dpr}},{key:"offsetHeight",get:function(){return this._h},set:function(t){this._h=t,this.nativeCanvas.height=t*this.dpr}},{key:"getContext",value:function(){return this.ctx}},{key:"getBoundingClientRect",value:function(){return{width:this._w,height:this._h}}}])}(),vA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},gA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};var yA=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="feishu",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"getDynamicCanvasCount",value:function(){return this.freeCanvasList.length}},{key:"getStaticCanvasCount",value:function(){return 9999}},{key:"configure",value:function(t,e){var i,n,r,a,o,s,l;t.env===this.type&&(t.setActiveEnvContribution(this),i=e.domref,n=e.canvasIdLists,r=this.canvasMap,a=e.freeCanvasIdx,o=this.freeCanvasList,s=e.pixelRatio,l=null!=s?s:tt.getSystemInfoSync().pixelRatio,n.forEach((function(t,e){var n=tt.createCanvasContext(t),s=new pA(n.canvas||{},n,l,i.width,i.height,t);n.canvas=s,r.set(t,s),e>=a&&o.push(s)})))}},{key:"loadImage",value:function(t){return Promise.resolve({data:t,loadState:"success"})}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return tt.getSystemInfoSync().pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return function(t){return Vh.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){Vh.clear(t)}}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}}])}(ob);yA=vA([Ps(),gA("design:paramtypes",[])],yA);var mA=new ys((function(t){mA.isFeishuBound||(mA.isFeishuBound=!0,t(yA).toSelf().inSingletonScope(),t(nl).toService(yA))}));function _A(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];_A.__loaded||(_A.__loaded=!0,t.load(mA),t.load(zk),t.load(Wk),e&&dA(t))}mA.isFeishuBound=!1,_A.__loaded=!1;var bA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},xA=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"globalAlpha",get:function(){return this._globalAlpha},set:function(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}},{key:"setLineDash",value:function(t){var e=arguments,i=this.nativeContext;if(this.nativeContext.setLineDash){var n=e[0];if(0===n[0]&&0===n[1])return;n&&i.setLineDash(n)}}},{key:"_setStrokeStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.strokeAttributes);var o=e.strokeOpacity,s=void 0===o?r.strokeOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l;if(s>1e-12&&u>1e-12){var c=e.lineWidth,h=void 0===c?r.lineWidth:c,d=e.stroke,p=void 0===d?r.stroke:d,f=e.lineJoin,v=void 0===f?r.lineJoin:f,g=e.lineDash,y=void 0===g?r.lineDash:g,m=e.lineCap,_=void 0===m?r.lineCap:m,b=e.miterLimit,x=void 0===b?r.miterLimit:b,k=e.keepStrokeScale,S=void 0===k?r.keepStrokeScale:k,A=e.lineDashOffset,M=void 0===A?r.lineDashOffset:A;a.globalAlpha=s*u*this.baseGlobalAlpha,a.lineWidth=S?h:$u(this,h,this.dpr),a.strokeStyle=tc(this,p,t,i,n),a.lineJoin=v,0===y[0]&&0===y[1]||!y||(a.setLineDash(y),a.lineDashOffset=M),a.lineCap=_,a.miterLimit=x}}},{key:"measureText",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:al.global.measureTextMethod;return this.setTransform(1,0,0,1,0,0,!0,al.global.devicePixelRatio),{width:_(e,"measureText",this,3)([t,i]).width,fontBoundingBoxDescent:void 0,fontBoundingBoxAscent:void 0,actualBoundingBoxAscent:void 0,actualBoundingBoxDescent:void 0}}},{key:"createPattern",value:function(t,e){return null}},{key:"draw",value:function(){var t=this,e=this.nativeContext;e.draw&&(this.drawPromise=new Promise((function(i){e.draw(!0,(function(){t.drawPromise=null,i(null)}))})))}}])}(rk);xA.env="lynx",xA=bA([Ps()],xA);var kA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},SA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},AA=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new xA(this,this._dpr)}},{key:"resize",value:function(t,e){this._pixelWidth=t*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=t,this._displayHeight=e,this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._nativeCanvas.nativeCanvas&&(this._nativeCanvas.nativeCanvas.width=this._pixelWidth,this._nativeCanvas.nativeCanvas.height=this._pixelHeight),this._context.dpr=this._dpr}},{key:"release",value:function(){}}])}(mf);AA.env="lynx",AA=kA([Ps(),SA("design:paramtypes",[Object])],AA);var MA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},TA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},wA=function(t,e){return function(i,n){e(i,n,t)}},CA=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),EA=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="lynx",i.eventManager=new CA,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id&&this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:gs.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new AA(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var a=t.dpr;null==a&&(a=e.width/i),this.canvas=new AA({width:i,height:n,dpr:a,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){this.canvas.resize(t,e)}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(ub);EA.env="lynx",EA=MA([Ps(),wA(0,Cs(rl)),TA("design:paramtypes",[Object])],EA);var PA=new ys((function(t){t(EA).toSelf(),t($c).toDynamicValue((function(t){return t.container.get(EA)})).whenTargetNamed(EA.env)})),BA=lk(AA,xA),RA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},LA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},IA=!1;try{IA=!!lynx.createCanvasNG}catch(t){}var DA=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="lynx",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"configure",value:function(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),function(t,e,i,n,r,a,o){var s=null!=o?o:SystemInfo.pixelRatio;if(e.forEach((function(e,o){var l;a?l=lynx.createOffscreenCanvas():(l=IA?lynx.createCanvasNG(e):lynx.createCanvas(e),IA&&l.attachToCanvasView(e)),l.width=t.width*s,l.height=t.height*s;var u=l.getContext("2d"),c=new fA(l,u,s,t.width,t.height,e);i.set(e,c),o>n&&r.push(c)})),!r.length&&lynx.createOffscreenCanvas){var l=lynx.createOffscreenCanvas();l.width=t.width*s,l.height=t.height*s;var u=l.getContext("2d"),c=Math.random().toString(),h=new fA(l,u,s,t.width,t.height,c);i.set(c,h),r.push(h)}}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,!!e.offscreen,e.pixelRatio))}},{key:"getDynamicCanvasCount",value:function(){return this.freeCanvasList.length}},{key:"getStaticCanvasCount",value:function(){return 9999}},{key:"loadImage",value:function(t){return function(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return Promise.reject();var e=lynx.createImage(t);return new Promise((function(t,i){e.onload=function(){t(e)},e.onerror=function(){i(new Error("加载失败"))}}))}(t,!1).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return SystemInfo.pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return function(t){return Vh.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){Vh.clear(t)}}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}}])}(ob);DA=RA([Ps(),LA("design:paramtypes",[])],DA);var OA=new ys((function(t){OA.isLynxBound||(OA.isLynxBound=!0,t(DA).toSelf().inSingletonScope(),t(nl).toService(DA))}));function FA(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];FA.__loaded||(FA.__loaded=!0,t.load(OA),t.load(BA),t.load(PA),e&&dA(t))}OA.isLynxBound=!1,FA.__loaded=!1;var zA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},HA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},NA=function(t){function e(t,i){var a;r(this,e),a=n(this,e,[t,i]);var o=t.nativeCanvas.getContext("2d");if(!o)throw new Error("发生错误，获取2d上下文失败");return a.nativeContext=o,a.canvas=t,a.matrix=new xi(1,0,0,1,0,0),a.stack=[],a.dpr=null!=i?i:1,a}return h(e,t),o(e,[{key:"release",value:function(){}}])}(rk);NA.env="node",NA=zA([Ps(),HA("design:paramtypes",[Object,Number])],NA);var VA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},jA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},UA=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new NA(this,this._dpr),this.nativeCanvas.width=this._pixelWidth,this.nativeCanvas.height=this._pixelHeight}},{key:"release",value:function(){this._nativeCanvas.release&&V(this._nativeCanvas.release)&&this._nativeCanvas.release()}}])}(mf);UA.env="node";var WA=lk(UA=VA([Ps(),jA("design:paramtypes",[Object])],UA),NA),GA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},YA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},XA=function(t,e){return function(i,n){e(i,n,t)}},KA=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="node",i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return""}},{key:"getWH",value:function(){return{width:this.canvas.displayWidth,height:this.canvas.displayHeight}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:gs.GenAutoIncrementId().toString(),canvasControled:!0};this.canvas=new UA(i)}},{key:"createWindowByCanvas",value:function(t){var e,i=t.canvas,n=null!==(e=t.dpr)&&void 0!==e?e:1,r=t.width,a=t.height;null!=r&&null!=a&&t.canvasControled||(r=i.width/n,a=i.height/n),this.canvas=new UA({width:r,height:a,dpr:n,nativeCanvas:i,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){this.canvas.release()}},{key:"resizeWindow",value:function(t,e){this.canvas.resize(t,e)}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"getImageBuffer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png";return this.canvas.nativeCanvas.toBuffer(t)}},{key:"addEventListener",value:function(t,e,i){}},{key:"dispatchEvent",value:function(t){return!0}},{key:"removeEventListener",value:function(t,e,i){}},{key:"getStyle",value:function(){}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){return null}},{key:"clearViewBox",value:function(t){}}])}(ub);KA.env="node",KA=GA([Ps(),XA(0,Cs(rl)),YA("design:paramtypes",[Object])],KA);var qA=new ys((function(t){t(KA).toSelf(),t($c).toDynamicValue((function(t){return t.container.get(KA)})).whenTargetNamed(KA.env)})),ZA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},JA=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="node",t._lastTime=0,t.supportEvent=!1,t}return h(e,t),o(e,[{key:"configure",value:function(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),this.pkg=e)}},{key:"getDynamicCanvasCount",value:function(){return 0}},{key:"getStaticCanvasCount",value:function(){return 999}},{key:"loadJson",value:function(t){var e=fetch(t).then((function(t){return t.json()}));return e.then((function(t){return{data:t,state:"success"}})).catch((function(){return{data:null,state:"fail"}})),e}},{key:"loadArrayBuffer",value:function(t){return fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadImage",value:function(t){var e=this.pkg.loadImage;return e?e(t).then((function(t){return{loadState:t?"success":"fail",data:t}})).catch((function(){return{loadState:"fail",data:null}})):Promise.reject(new Error("node-canvas loadImage could not be found!"))}},{key:"loadSvg",value:function(t){var e=this.pkg.Resvg;if(!e)return Promise.reject(new Error("@resvg/resvg-js svgParser could not be found!"));var i=new e(t).render().asPng();return this.loadImage(i)}},{key:"createCanvas",value:function(t){return this.pkg.createCanvas(t.width,t.height)}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return 1}},{key:"getRequestAnimationFrame",value:function(){return function(t){return Vh.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){Vh.clear(t)}}},{key:"addEventListener",value:function(t,e,i){}},{key:"removeEventListener",value:function(t,e,i){}},{key:"getElementById",value:function(t){return null}},{key:"getRootElement",value:function(){return null}},{key:"dispatchEvent",value:function(t){}},{key:"release",value:function(){}},{key:"createOffscreenCanvas",value:function(t){}}])}(ob);JA=ZA([Ps()],JA);var QA=new ys((function(t){QA.isNodeBound||(QA.isNodeBound=!0,t(JA).toSelf().inSingletonScope(),t(nl).toService(JA))}));function $A(t){$A.__loaded||($A.__loaded=!0,t.load(QA),t.load(WA),t.load(qA))}QA.isNodeBound=!1,$A.__loaded=!1;var tM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},eM=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"globalAlpha",get:function(){return this._globalAlpha},set:function(t){this.nativeContext.setGlobalAlpha(t),this._globalAlpha=t}},{key:"draw",value:function(){this.nativeContext.draw()}},{key:"strokeText",value:function(t,e,i){}},{key:"_setCommonStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.fillAttributes);var o=e.fillOpacity,s=void 0===o?r.fillOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l,c=e.fill,h=void 0===c?r.fill:c;s>1e-12&&u>1e-12&&(a.setGlobalAlpha(s*u),a.setFillStyle(tc(this,h,t,i,n)))}},{key:"_setStrokeStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.strokeAttributes);var o=e.strokeOpacity,s=void 0===o?r.strokeOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l;if(s>1e-12&&u>1e-12){var c=e.lineWidth,h=void 0===c?r.lineWidth:c,d=e.stroke,p=void 0===d?r.stroke:d,f=e.lineJoin,v=void 0===f?r.lineJoin:f,g=e.lineDash,y=void 0===g?r.lineDash:g,m=e.lineDashOffset,_=void 0===m?r.lineDashOffset:m,b=e.lineCap,x=void 0===b?r.lineCap:b,k=e.miterLimit,S=void 0===k?r.miterLimit:k,A=e.keepStrokeScale,M=void 0===A?r.keepStrokeScale:A;a.setGlobalAlpha(s*u),a.setLineWidth(M?h:$u(this,h,this.dpr)),a.setStrokeStyle(tc(this,p,t,i,n)),a.setLineJoin(v),y&&(a.setLineDash(y),a.lineDashOffset=_),a.setLineCap(x),a.setMiterLimit(S)}}},{key:"setTextStyleWithoutAlignBaseline",value:function(t,e){var i,n=this.nativeContext;e||(e=this.textAttributes),t.font?n.font=t.font:n.font=di(t,e),n.setFontSize(null!==(i=t.fontSize)&&void 0!==i?i:e.fontSize)}},{key:"setTextStyle",value:function(t,e){var i,n,r=this.nativeContext;e||(e=this.textAttributes),t.font?r.font=t.font:r.font=di(t,e),r.setTextAlign(null!==(i=t.textAlign)&&void 0!==i?i:e.textAlign),r.setTextBaseline(null!==(n=t.textBaseline)&&void 0!==n?n:e.textBaseline)}},{key:"createConicGradient",value:function(t,e,i,n){return null}},{key:"createPattern",value:function(t,e){return null}},{key:"getImageData",value:function(t,e,i,n){var r=this,a=this.nativeContext,o=a.taro;if(a&&o)return!a.getImageData&&o.canvasGetImageData?new Promise((function(a,s){try{o.canvasGetImageData({canvasId:r.canvas.nativeCanvas.id,sx:t,sy:e,sw:i,sh:n,success:function(t){a(t)}})}catch(t){s(t)}})):void 0}},{key:"createRadialGradient",value:function(t,e,i,n,r,a){return this.nativeContext.createCircularGradient&&this.nativeContext.createCircularGradient(t,e,i,n,r,a)}}])}(rk);eM.env="taro",eM=tM([Ps()],eM);var iM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},nM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},rM=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new eM(this,this._dpr)}},{key:"release",value:function(){}}])}(mf);rM.env="taro";var aM=lk(rM=iM([Ps(),nM("design:paramtypes",[Object])],rM),eM),oM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},sM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},lM=function(t,e){return function(i,n){e(i,n,t)}},uM=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),cM=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="taro",i.eventManager=new uM,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:gs.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new rM(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var a=t.dpr;null==a&&(a=e.width/i),this.canvas=new rM({width:i,height:n,dpr:a,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches.length>0&&(t.changedTouches.forEach((function(e,i){t.changedTouches[i]=Object.assign(Object.assign({},t.changedTouches[i]),{offsetX:e.x,offsetY:e.y})})),t.offsetX=t.changedTouches[0].offsetX,t.offsetY=t.changedTouches[0].offsetY),t.touches.length>0&&t.touches.forEach((function(e,i){t.touches[i]=Object.assign(Object.assign({},t.touches[i]),{offsetX:e.x,offsetY:e.y})})),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(ub);cM.env="taro",cM=oM([Ps(),lM(0,Cs(rl)),sM("design:paramtypes",[Object])],cM);var hM=new ys((function(t){t(cM).toSelf(),t($c).toDynamicValue((function(t){return t.container.get(cM)})).whenTargetNamed(cM.env)})),dM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},pM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};var fM=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="taro",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"getDynamicCanvasCount",value:function(){return this.freeCanvasList.length}},{key:"getStaticCanvasCount",value:function(){return 9999}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}},{key:"configure",value:function(t,e){var i,n,r,a,o,s,l;t.env===this.type&&(t.setActiveEnvContribution(this),i=e.domref,n=e.canvasIdLists,r=this.canvasMap,a=e.freeCanvasIdx,o=this.freeCanvasList,s=e.taro,l=e.pixelRatio,n.forEach((function(t,e){var n=s.createCanvasContext(t),u=new pA(n.canvas||{},n,l,i.width,i.height,t);return n.canvas=u,r.set(t,u),e>=a&&o.push(u),u})),this.taro=e.taro,this.pixelRatio=e.pixelRatio)}},{key:"loadImage",value:function(t){return Promise.resolve({data:t,loadState:"success"})}},{key:"loadSvg",value:function(t){var e=window||globalThis;if(e.DOMParser){var i=(new e.DOMParser).parseFromString(t,"image/svg+xml").children[0],n=(new XMLSerializer).serializeToString(i),r="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(n));return Promise.resolve({data:r,loadState:"success"})}if(e.Blob){var a=new e.Blob([t],{type:"image/svg+xml"}),o=e.URL.createObjectURL(a);return Promise.resolve({data:o,loadState:"success"})}return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return this.pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return requestAnimationFrame}},{key:"getCancelAnimationFrame",value:function(){return cancelAnimationFrame}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}}])}(ob);fM=dM([Ps(),pM("design:paramtypes",[])],fM);var vM=new ys((function(t){vM.isTaroBound||(vM.isTaroBound=!0,t(fM).toSelf().inSingletonScope(),t(nl).toService(fM))}));function gM(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];gM.__loaded||(gM.__loaded=!0,t.load(vM),t.load(aM),t.load(hM),e&&dA(t))}vM.isTaroBound=!1,gM.__loaded=!1;var yM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},mM=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"draw",value:function(){}},{key:"createPattern",value:function(t,e){return null}}])}(rk);mM.env="wx",mM=yM([Ps()],mM);var _M=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},bM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},xM=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new mM(this,this._dpr)}},{key:"release",value:function(){}}])}(mf);xM.env="wx";var kM=lk(xM=_M([Ps(),bM("design:paramtypes",[Object])],xM),mM),SM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},AM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},MM=function(t,e){return function(i,n){e(i,n,t)}},TM=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),wM=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="wx",i.eventManager=new TM,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:gs.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new xM(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var a=t.dpr;null==a&&(a=e.width/i),this.canvas=new xM({width:i,height:n,dpr:a,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e,i,n,r,a=t.type;return!!this.eventManager.cache[a]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=null!==(e=t.changedTouches[0].x)&&void 0!==e?e:t.changedTouches[0].pageX,t.changedTouches[0].clientX=null!==(i=t.changedTouches[0].x)&&void 0!==i?i:t.changedTouches[0].pageX,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=null!==(n=t.changedTouches[0].y)&&void 0!==n?n:t.changedTouches[0].pageY,t.changedTouches[0].clientY=null!==(r=t.changedTouches[0].y)&&void 0!==r?r:t.changedTouches[0].pageY),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[a].listener&&this.eventManager.cache[a].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(ub);wM.env="wx",wM=SM([Ps(),MM(0,Cs(rl)),AM("design:paramtypes",[Object])],wM);var CM=new ys((function(t){t(wM).toSelf(),t($c).toDynamicValue((function(t){return t.container.get(wM)})).whenTargetNamed(wM.env)})),EM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},PM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},BM=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};var RM=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="wx",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"configure",value:function(t,e){if(t.env===this.type)return t.setActiveEnvContribution(this),function(t,e,i,n,r,a,o){return BM(this,void 0,void 0,f().m((function t(){var s,l,u;return f().w((function(t){for(;;)switch(t.n){case 0:s=wx.getSystemInfoSync().pixelRatio,l=f().m((function t(l){var u;return f().w((function(t){for(;;)switch(t.n){case 0:if(u=e[l],!o&&i.has(u)){t.n=1;break}return t.n=1,new Promise((function(t){var e=wx.createSelectorQuery();a&&(e=e.in(a)),e.select("#".concat(u)).fields({node:!0,size:!0}).exec((function(e){if(e[0]){var a=e[0].node,o=e[0].width,c=e[0].height;a.width=o*s,a.height=c*s,i.set(u,a),l>=n&&r.push(a),t(null)}}))}));case 1:return t.a(2)}}),t)})),u=0;case 1:if(!(u<e.length)){t.n=3;break}return t.d(g(l(u)),2);case 2:u++,t.n=1;break;case 3:return t.a(2)}}),t)})))}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.component,e.forceUpdate).then((function(){}))}},{key:"loadImage",value:function(t){return Promise.resolve({data:t,loadState:"success"})}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return wx.getSystemInfoSync().pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return function(t){return Vh.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){Vh.clear(t)}}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}}])}(ob);RM=EM([Ps(),PM("design:paramtypes",[])],RM);var LM=new ys((function(t){LM._isWxBound||(LM._isWxBound=!0,t(RM).toSelf().inSingletonScope(),t(nl).toService(RM))}));function IM(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];IM.__loaded||(IM.__loaded=!0,t.load(LM),t.load(kM),t.load(CM),e&&dA(t))}function DM(t){DM.__loaded||(DM.__loaded=!0,Rk(t,!1),_A(t,!1),FA(t,!1),$A(t),gM(t,!1),IM(t,!1),_k(t),j_.hooks.onSetEnv.tap("loadMathPicker",(function(e,i){"browser"!==i&&dA(t)})))}function OM(){!function(t){DM(t)}(yc)}LM._isWxBound=!1,IM.__loaded=!1,DM.__loaded=!1;var FM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},zM=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e)}(Ik);zM.env="tt",zM=FM([Ps()],zM);var HM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},NM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},VM=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new zM(this,this._dpr)}},{key:"release",value:function(){}}])}(mf);VM.env="tt";var jM=lk(VM=HM([Ps(),NM("design:paramtypes",[Object])],VM),zM),UM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},WM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},GM=function(t,e){return function(i,n){e(i,n,t)}},YM=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),XM=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="tt",i.eventManager=new YM,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:gs.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new VM(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var a=t.dpr;null==a&&(a=e.width/i),this.canvas=new VM({width:i,height:n,dpr:a,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(ub);XM.env="tt",XM=UM([Ps(),GM(0,Cs(rl)),WM("design:paramtypes",[Object])],XM);var KM=new ys((function(t){t(XM).toSelf(),t($c).toDynamicValue((function(t){return t.container.get(XM)})).whenTargetNamed(XM.env)})),qM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},ZM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},JM=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};var QM=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="tt",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"configure",value:function(t,e){if(t.env===this.type)return t.setActiveEnvContribution(this),function(t,e,i,n,r,a){return JM(this,void 0,void 0,f().m((function t(){var o,s,l;return f().w((function(t){for(;;)switch(t.n){case 0:o=tt.getSystemInfoSync().pixelRatio,s=f().m((function t(s){var l;return f().w((function(t){for(;;)switch(t.n){case 0:return l=e[s],t.n=1,new Promise((function(t){var e=tt.createSelectorQuery();a&&(e=e.in(a)),e.select("#".concat(l)).node().exec((function(e){var a=e[0].node,u=a.width,c=a.height;a.width=u*o,a.height=c*o,i.set(l,a),s>=n&&r.push(a),t(null)}))}));case 1:return t.a(2)}}),t)})),l=0;case 1:if(!(l<e.length)){t.n=3;break}return t.d(g(s(l)),2);case 2:l++,t.n=1;break;case 3:return t.a(2)}}),t)})))}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.component).then((function(){}))}},{key:"loadImage",value:function(t){return Promise.resolve({data:t,loadState:"success"})}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return tt.getSystemInfoSync().pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return function(t){return Vh.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){Vh.clear(t)}}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}}])}(ob);QM=qM([Ps(),ZM("design:paramtypes",[])],QM);var $M=new ys((function(t){$M.isTTBound||($M.isTTBound=!0,t(QM).toSelf().inSingletonScope(),t(nl).toService(QM))}));function tT(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];tT.__loaded||(tT.__loaded=!0,t.load($M),t.load(jM),t.load(KM),e&&dA(t))}$M.isTTBound=!1,tT.__loaded=!1;var eT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},iT=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"globalAlpha",get:function(){return this._globalAlpha},set:function(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}},{key:"setLineDash",value:function(t){var e=arguments,i=this.nativeContext;if(this.nativeContext.setLineDash){var n=e[0];if(0===n[0]&&0===n[1])return;n&&i.setLineDash(n)}}},{key:"_setStrokeStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.strokeAttributes);var o=e.strokeOpacity,s=void 0===o?r.strokeOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l;if(s>1e-12&&u>1e-12){var c=e.lineWidth,h=void 0===c?r.lineWidth:c,d=e.stroke,p=void 0===d?r.stroke:d,f=e.lineJoin,v=void 0===f?r.lineJoin:f,g=e.lineDash,y=void 0===g?r.lineDash:g,m=e.lineCap,_=void 0===m?r.lineCap:m,b=e.miterLimit,x=void 0===b?r.miterLimit:b,k=e.keepStrokeScale,S=void 0===k?r.keepStrokeScale:k,A=e.lineDashOffset,M=void 0===A?r.lineDashOffset:A;a.globalAlpha=s*u*this.baseGlobalAlpha,a.lineWidth=S?h:$u(this,h,this.dpr),a.strokeStyle=tc(this,p,t,i,n),a.lineJoin=v,0===y[0]&&0===y[1]||(y&&a.setLineDash(y),a.lineDashOffset=M),a.lineCap=_,a.miterLimit=x}}},{key:"measureText",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:al.global.measureTextMethod;return this.setTransform(1,0,0,1,0,0,!0,al.global.devicePixelRatio),_(e,"measureText",this,3)([t,i])}},{key:"setTextStyleWithoutAlignBaseline",value:function(t,e,i){var n=this.nativeContext;e||(e=this.textAttributes);var r,a=t.scaleIn3d,o=void 0===a?e.scaleIn3d:a;r=t.font?t.font:di(t,e,o&&this.camera&&this.camera.getProjectionScale(i)),n.font=(r||"").replace("px","vp");var s=t.fontFamily,l=void 0===s?e.fontFamily:s,u=t.fontSize,c=void 0===u?e.fontSize:u;this.fontFamily=l,this.fontSize=c,n.textAlign="left",n.textBaseline="alphabetic"}},{key:"setTextStyle",value:function(t,e,i){var n,r,a=this.nativeContext;e||(e=this.textAttributes);var o;o=t.font?t.font:di(t,e,this.camera&&this.camera.getProjectionScale(i)),a.font=(o||"").replace("px","vp");var s=t.fontFamily,l=void 0===s?e.fontFamily:s,u=t.fontSize,c=void 0===u?e.fontSize:u;this.fontFamily=l,this.fontSize=c,a.textAlign=null!==(n=t.textAlign)&&void 0!==n?n:e.textAlign,a.textBaseline=null!==(r=t.textBaseline)&&void 0!==r?r:e.textBaseline}},{key:"createPattern",value:function(t,e){return null}},{key:"drawImage",value:function(){var t=this.nativeContext,e=arguments;e[0].drawImage&&(e[0]=e[0].transferToImageBitmap()),3===e.length?t.drawImage(e[0],e[1],e[2]):5===e.length?t.drawImage(e[0],e[1],e[2],e[3],e[4]):9===e.length&&t.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}},{key:"draw",value:function(){}}])}(rk);iT.env="harmony",iT=eT([Ps()],iT);var nT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},rT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},aT=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new iT(this,this._dpr)}},{key:"resize",value:function(t,e){}},{key:"release",value:function(){}}])}(mf);aT.env="harmony",aT=nT([Ps(),rT("design:paramtypes",[Object])],aT);var oT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},sT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},lT=function(t,e){return function(i,n){e(i,n,t)}},uT=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),cT=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="harmony",i.eventManager=new uT,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id&&this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:gs.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new aT(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}this.canvas=new aT({width:i,height:n,dpr:1,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){this.canvas.resize(t,e)}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(ub);cT.env="harmony",cT=oT([Ps(),lT(0,Cs(rl)),sT("design:paramtypes",[Object])],cT);var hT=new ys((function(t){t(cT).toSelf(),t($c).toDynamicValue((function(t){return t.container.get(cT)})).whenTargetNamed(cT.env)})),dT=lk(aT,iT),pT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},fT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};var vT=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="harmony",t.supportEvent=!0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t.rafSTO=new Nh(0),t}return h(e,t),o(e,[{key:"configure",value:function(t,e){t.env===this.type&&t.setActiveEnvContribution(this)}},{key:"getDynamicCanvasCount",value:function(){return 9999}},{key:"getStaticCanvasCount",value:function(){return 9999}},{key:"loadImage",value:function(t){}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){return e=t.width,i=t.height,n=t.id,r=new OffscreenCanvas(e,i),a=r.getContext("2d"),new pA({width:e,height:i,context:a,_c:r,getBoundingClientRect:function(){return{width:e,height:i}},getContext:function(){return a}},a,1,e,i,n);var e,i,n,r,a}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return 1}},{key:"getRequestAnimationFrame",value:function(){var t=this;return function(e){return t.rafSTO.call(e)}}},{key:"getCancelAnimationFrame",value:function(){var t=this;return function(e){t.rafSTO.clear(e)}}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return null}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}}])}(ob);vT=pT([Ps(),fT("design:paramtypes",[])],vT);var gT=new ys((function(t){gT.isHarmonyBound||(gT.isHarmonyBound=!0,t(vT).toSelf().inSingletonScope(),t(nl).toService(vT))}));function yT(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];yT.__loaded||(yT.__loaded=!0,t.load(gT),t.load(dT),t.load(hT),e&&dA(t))}gT.isHarmonyBound=!1,yT.__loaded=!1;var mT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},_T=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},bT=function(t,e){return function(i,n){e(i,n,t)}},xT=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="arc",i.numberType=Ip,i}return h(e,t),o(e)}(Jk);xT=mT([Ps(),bT(0,Cs(_m)),_T("design:paramtypes",[Object])],xT);var kT=!1,ST=new ys((function(t,e,i,n){kT||(kT=!0,t(Fx).to(xT).inSingletonScope(),t(Zx).toService(Fx))})),AT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},MT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},TT=function(t,e){return function(i,n){e(i,n,t)}},wT=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i}return h(e,t),o(e)}(YS);wT=AT([Ps(),TT(0,Cs(wm)),MT("design:paramtypes",[Object])],wT);var CT=!1,ET=new ys((function(t,e,i,n){CT||(CT=!0,t(Ux).to(wT).inSingletonScope(),t(Zx).toService(Ux))})),PT=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;n.highPerformanceSave();var r=t.getGraphicTheme(),a=this.transform(t,r,n),o=a.x,s=a.y,l=a.z,u=a.lastModelMatrix,c=e;if(n.camera){c=e.clone();var h=t.parent.globalTransMatrix;c.x=h.a*e.x+h.c*e.y+h.e,c.y=h.b*e.x+h.d*e.y+h.f}this.canvasRenderer.z=l;var d=!1;return this.canvasRenderer.drawShape(t,n,o,s,{},null,(function(t){return!!d||(d=t.isPointInPath(c.x,c.y))}),(function(t,e,i){if(d)return!0;var r=e.lineWidth||i.lineWidth,a=e.pickStrokeBuffer||i.pickStrokeBuffer,o=e.keepStrokeScale||i.keepStrokeScale;return n.lineWidth=o?r+a:$u(n,r+a,n.dpr),d=t.isPointInStroke(c.x,c.y)})),this.canvasRenderer.z=0,n.modelMatrix!==u&&lf.free(n.modelMatrix),n.modelMatrix=u,n.highPerformanceRestore(),d}}])}(hy),BT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},RT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},LT=function(t,e){return function(i,n){e(i,n,t)}},IT=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="line",i.numberType=Vp,i}return h(e,t),o(e)}(PT);IT=BT([Ps(),LT(0,Cs(Am)),RT("design:paramtypes",[Object])],IT);var DT=!1,OT=new ys((function(t,e,i,n){DT||(DT=!0,t(Vx).to(IT).inSingletonScope(),t(Zx).toService(Vx))})),FT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},zT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},HT=function(t,e){return function(i,n){e(i,n,t)}},NT=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="area",i.numberType=Op,i}return h(e,t),o(e)}(Jk);NT=FT([Ps(),HT(0,Cs(bm)),zT("design:paramtypes",[Object])],NT);var VT=!1,jT=new ys((function(t,e,i,n){VT||(VT=!0,t(zx).to(NT).inSingletonScope(),t(Zx).toService(zx))})),UT=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"contains",value:function(t,e,i){var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.getGraphicTheme();n.highPerformanceSave();var a=this.transform(t,r,n),o=a.x,s=a.y,l=a.z,u=a.lastModelMatrix,c=e;if(n.camera){c=e.clone();var h=t.parent.globalTransMatrix;c.x=h.a*e.x+h.c*e.y+h.e,c.y=h.b*e.x+h.d*e.y+h.f}this.canvasRenderer.z=l;var d=!1;return this.canvasRenderer.drawShape(t,n,o,s,i,null,(function(t,e,i){return!!d||(d=t.isPointInPath(c.x,c.y))})),this.canvasRenderer.z=0,n.modelMatrix!==u&&lf.free(n.modelMatrix),n.modelMatrix=u,n.highPerformanceRestore(),d}}])}(hy),WT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},GT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},YT=function(t,e){return function(i,n){e(i,n,t)}},XT=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="symbol",i.numberType=Yp,i}return h(e,t),o(e,[{key:"contains",value:function(t,e,i){var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.getParsedPath();if(!n.camera){if(!t.AABBBounds.containsPoint(e))return!1;if(r.isSvg||"imprecise"===t.attribute.pickMode)return!0}n.highPerformanceSave();var a=t.getGraphicTheme(),o=this.transform(t,a,n),s=o.x,l=o.y,u=o.z,c=o.lastModelMatrix,h=e;if(n.camera){h=e.clone();var d=t.parent.globalTransMatrix;h.x=d.a*e.x+d.c*e.y+d.e,h.y=d.b*e.x+d.d*e.y+d.f}this.canvasRenderer.z=u;var p=!1;return this.canvasRenderer.drawShape(t,n,s,l,{},null,(function(t,e,i){return!!p||(p=t.isPointInPath(h.x,h.y))}),(function(t,e,i){if(p)return!0;var r=e.lineWidth||i.lineWidth,a=e.pickStrokeBuffer||i.pickStrokeBuffer,o=e.keepStrokeScale||i.keepStrokeScale;return n.lineWidth=o?r+a:$u(n,r+a,n.dpr),p=t.isPointInStroke(h.x,h.y)})),this.canvasRenderer.z=0,n.modelMatrix!==c&&lf.free(n.modelMatrix),n.modelMatrix=c,n.highPerformanceRestore(),p}}])}(UT);XT=WT([Ps(),YT(0,Cs(Cm)),GT("design:paramtypes",[Object])],XT);var KT=!1,qT=new ys((function(t,e,i,n){KT||(KT=!0,t(Wx).to(XT).inSingletonScope(),t(Zx).toService(Wx))})),ZT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},JT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},QT=function(t,e){return function(i,n){e(i,n,t)}},$T=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="circle",i.numberType=Fp,i}return h(e,t),o(e)}(Jk);$T=ZT([Ps(),QT(0,Cs(xm)),JT("design:paramtypes",[Object])],$T);var tw=!1,ew=new ys((function(t,e,i,n){tw||(tw=!0,t(Hx).to($T).inSingletonScope(),t(Zx).toService(Hx))})),iw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},nw=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},rw=function(t,e){return function(i,n){e(i,n,t)}},aw=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="text",i.numberType=Xp,i}return h(e,t),o(e,[{key:"contains",value:function(t,e,i){var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.AABBBounds;if(!n.camera)return!!r.containsPoint(e);n.highPerformanceSave();var a=t.getGraphicTheme(),o=t.attribute.keepDirIn3d,s=!(void 0===o?a.keepDirIn3d:o),l=this.transform(t,a,n,s),u=l.x,c=l.y,h=l.z,d=l.lastModelMatrix;this.canvasRenderer.z=h;var p=e;if(n.camera){p=e.clone();var f=t.parent.globalTransMatrix;p.x=f.a*e.x+f.c*e.y+f.e,p.y=f.b*e.x+f.d*e.y+f.f}var v=!1;return this.canvasRenderer.drawShape(t,n,u,c,{},null,(function(e,i,n){if(v)return!0;var r=t.attribute,o=r.fontSize,s=void 0===o?a.fontSize:o,l=r.textBaseline,d=void 0===l?a.textBaseline:l,f=r.textAlign,g=void 0===f?a.textAlign:f,y=t.AABBBounds,m=y.height(),_=y.width(),b=xv(d,m,s),x=bv(g,_);return e.rect(x+u,b+c,_,m,h),v=e.isPointInPath(p.x,p.y)}),(function(t,e,i){return v})),this.canvasRenderer.z=0,n.modelMatrix!==d&&lf.free(n.modelMatrix),n.modelMatrix=d,n.highPerformanceRestore(),v}}])}(UT);aw=iw([Ps(),rw(0,Cs(Em)),nw("design:paramtypes",[Object])],aw);var ow=!1,sw=new ys((function(t,e,i,n){ow||(ow=!0,t(Gx).to(aw).inSingletonScope(),t(Zx).toService(Gx))})),lw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},uw=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},cw=function(t,e){return function(i,n){e(i,n,t)}},hw=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="path",i.numberType=jp,i}return h(e,t),o(e)}(PT);hw=lw([Ps(),cw(0,Cs(Mm)),uw("design:paramtypes",[Object])],hw);var dw=!1,pw=new ys((function(t,e,i,n){dw||(dw=!0,t(jx).to(hw).inSingletonScope(),t(Zx).toService(jx))})),fw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},vw=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},gw=function(t,e){return function(i,n){e(i,n,t)}},yw=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="polygon",i.numberType=Up,i}return h(e,t),o(e)}(Jk);yw=fw([Ps(),gw(0,Cs(Tm)),vw("design:paramtypes",[Object])],yw);var mw=!1,_w=new ys((function(t,e,i,n){mw||(mw=!0,t(Yx).to(yw).inSingletonScope(),t(Zx).toService(Yx))})),bw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},xw=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},kw=function(t,e){return function(i,n){e(i,n,t)}},Sw=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i}return h(e,t),o(e)}(gS);Sw=bw([Ps(),kw(0,Cs(Bm)),xw("design:paramtypes",[Object])],Sw);var Aw=!1,Mw=new ys((function(t,e,i,n){Aw||(Aw=!0,t(Kx).to(Sw).inSingletonScope(),t(Zx).toService(Kx))})),Tw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},ww=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Cw=function(t,e){return function(i,n){e(i,n,t)}},Ew=function(){return o((function t(e){r(this,t),this.canvasRenderer=e,this.type="richtext",this.numberType=Gp}),[{key:"contains",value:function(t,e,i){return!!t.AABBBounds.containsPoint(e)}}])}();Ew=Tw([Ps(),Cw(0,Cs(Pm)),ww("design:paramtypes",[Object])],Ew);var Pw=!1,Bw=new ys((function(t,e,i,n){Pw||(Pw=!0,t(Xx).to(Ew).inSingletonScope(),t(Zx).toService(Xx))})),Rw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Lw=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Iw=function(t,e){return function(i,n){e(i,n,t)}},Dw=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="image",i.numberType=Np,i}return h(e,t),o(e)}(Jk);Dw=Rw([Ps(),Iw(0,Cs(Rm)),Lw("design:paramtypes",[Object])],Dw);var Ow=!1,Fw=new ys((function(t,e,i,n){Ow||(Ow=!0,t(Nx).to(Dw).inSingletonScope(),t(Zx).toService(Nx))})),zw=tb();function Hw(){Hw.__loaded||(Hw.__loaded=!0,kg.RegisterGraphicCreator("arc",fg),yc.load(Eb),yc.load(zw?ST:nS))}Hw.__loaded=!1;var Nw=Hw;function Vw(){Vw.__loaded||(Vw.__loaded=!0,kg.RegisterGraphicCreator("area",hg),yc.load(Db),yc.load(zw?jT:uS))}Vw.__loaded=!1;var jw=Vw;function Uw(){Uw.__loaded||(Uw.__loaded=!0,kg.RegisterGraphicCreator("circle",Pv),yc.load(Hb),yc.load(zw?ew:vS))}Uw.__loaded=!1;var Ww=Uw;function Gw(){Gw.__loaded||(Gw.__loaded=!0,kg.RegisterGraphicCreator("glyph",Yv),yc.load(qb),yc.load(zw?Mw:kS))}Gw.__loaded=!1;var Yw=Gw;function Xw(){Xw.__loaded||(Xw.__loaded=!0,kg.RegisterGraphicCreator("group",Vf))}Xw.__loaded=!1;var Kw=Xw;function qw(){qw.__loaded||(qw.__loaded=!0,kg.RegisterGraphicCreator("image",Qv),yc.load(ix),yc.load(zw?Fw:TS))}qw.__loaded=!1;var Zw=qw;function Jw(){Jw.__loaded||(Jw.__loaded=!0,kg.RegisterGraphicCreator("line",Nv),yc.load(Lb),yc.load(zw?OT:RS))}Jw.__loaded=!1;var Qw=Jw;function $w(){$w.__loaded||($w.__loaded=!0,kg.RegisterGraphicCreator("path",lg),yc.load(Ub),yc.load(zw?pw:WS))}$w.__loaded=!1;var tC=$w;function eC(){eC.__loaded||(eC.__loaded=!0,kg.RegisterGraphicCreator("polygon",yg),yc.load(Gb),yc.load(zw?_w:zS))}eC.__loaded=!1;var iC=eC;function nC(){nC.__loaded||(nC.__loaded=!0,kg.RegisterGraphicCreator("rect",Wv),yc.load(Bb),yc.load(zw?ET:QS))}nC.__loaded=!1;var rC=nC;function aC(){aC.__loaded||(aC.__loaded=!0,kg.RegisterGraphicCreator("richtext",ag),yc.load(tx),yc.load(zw?Bw:tA))}aC.__loaded=!1;var oC=aC;function sC(){sC.__loaded||(sC.__loaded=!0,kg.RegisterGraphicCreator("shadowRoot",_g))}sC.__loaded=!1;var lC=sC;function uC(){uC.__loaded||(uC.__loaded=!0,kg.RegisterGraphicCreator("symbol",Fv),yc.load(Fb),yc.load(zw?qT:oA))}uC.__loaded=!1;var cC=uC;function hC(){hC.__loaded||(hC.__loaded=!0,kg.RegisterGraphicCreator("text",Iv),yc.load(Vb),yc.load(zw?sw:cA))}hC.__loaded=!1;var dC=hC;function pC(t){var e=3735928559^(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0);return e=(e=3432918353*((e=(2654435769^e)+(e<<6)+(e>>2))^t))<<15|e>>>17,e^=e<<25,e+=e<<9,e^=e>>4,e^=e<<18,((e|=1)>>>0)%2147483647/2147483647}function fC(){Kw(),rC()}var vC,gC=-.5*Math.PI,yC=1.5*Math.PI,mC="PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol";!function(t){t.selected="selected",t.selectedReverse="selected_reverse",t.hover="hover",t.hoverReverse="hover_reverse"}(vC||(vC={}));var _C=l(l(l(l({},vC.selectedReverse,{}),vC.selected,{}),vC.hover,{}),vC.hoverReverse,{}),bC={container:"",width:30,height:30,style:{}},xC="scrollDrag";function kC(){return"browser"===j_.env?["pointerup","pointerleave","pointercancel"]:["pointerup","pointerleave","pointerupoutside"]}var SC={debounce:Jt,throttle:Qt};fC();var AC=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="scrollbar",a._handleTouchMove=function(t){U(a._prePos)&&t.preventDefault()},a._onRailPointerDown=function(t){var e,i=t.viewX,n=t.viewY,r=a.attribute,o=r.direction,s=r.width,l=r.height,u=r.range,c=a._sliderSize,h=m(a._getScrollRange(),2),d=h[0],p=h[1];if("vertical"===o){var f=n-a._viewPosition.y,v=Xt(f-c/2,d,p);e=f/l,a._slider.setAttribute("y",v,!0)}else{var g=i-a._viewPosition.x,y=Xt(g-c/2,d,p);e=g/s,a._slider.setAttribute("x",y,!0)}a.setScrollRange([e-(u[1]-u[0])/2,e+(u[1]-u[0])/2],!1),a.stage&&!a.stage.autoRender&&a.stage.renderNextFrame()},a._onSliderPointerDown=function(t){a._clearDragEvents();var e=a.attribute.stopSliderDownPropagation;(void 0===e||e)&&t.stopPropagation();var i=a.attribute.direction,n=a.stage.eventPointTransform(t),r=n.x,o=n.y;a._prePos="horizontal"===i?r:o,a._dispatchEvent("scrollDown",{pos:a._prePos,event:t});var s=kC(),l="browser"===j_.env?j_:a.stage;l.addEventListener("pointermove",a._onSliderPointerMoveWithDelay,{capture:!0}),s.forEach((function(t){l.addEventListener(t,a._onSliderPointerUp)}))},a._computeScrollValue=function(t){var e,i,n=a.attribute.direction,r=a.stage.eventPointTransform(t),o=r.x,s=r.y,l=a.getSliderRenderBounds(),u=l.width,c=l.height;return"vertical"===n?e=((i=s)-a._prePos)/c:e=((i=o)-a._prePos)/u,[i,e]},a._onSliderPointerMove=function(t){var e=a.attribute.stopSliderMovePropagation;(void 0===e||e)&&t.stopPropagation();var i=a.getScrollRange(),n=m(a._computeScrollValue(t),2),r=n[0],o=n[1];a.setScrollRange([i[0]+o,i[1]+o],!0),a._prePos=r},a._onSliderPointerMoveWithDelay=0===a.attribute.delayTime?a._onSliderPointerMove:SC[a.attribute.delayType](a._onSliderPointerMove,a.attribute.delayTime),a._onSliderPointerUp=function(t){var e=a.attribute,i=e.range,n=e.limitRange,r=void 0===n?[0,1]:n,o=a.getScrollRange(),s=m(a._computeScrollValue(t),2);s[0];var l=s[1],u=[o[0]+l,o[1]+l];a._prePos=null,a._dispatchEvent("scrollUp",{pre:i,value:Kt(u,r[0],r[1])}),a._clearDragEvents()},a}return h(e,t),o(e,[{key:"setScrollRange",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.attribute,n=i.direction,r=void 0===n?"horizontal":n,a=i.limitRange,o=void 0===a?[0,1]:a,s=i.range,l=i.realTime,u=void 0===l||l,c=Kt(t,o[0],o[1]);if(e){var h=this._getSliderPos(c);if(this._slider){var d=h[1]-h[0];this._sliderSize=d,"horizontal"===r?this._slider.setAttributes({x:h[0],width:d},!0):this._slider.setAttributes({y:h[0],height:d},!0),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()}}this.attribute.range=c,u&&this._dispatchEvent(xC,{pre:s,value:c})}},{key:"getScrollRange",value:function(){return this.attribute.range}},{key:"bindEvents",value:function(){if(!this.attribute.disableTriggerEvent){var t=this.attribute,e=t.delayType,i=void 0===e?"throttle":e,n=t.delayTime,r=void 0===n?0:n;this._rail&&this._rail.addEventListener("pointerdown",SC[i](this._onRailPointerDown,r)),this._slider&&this._slider.addEventListener("pointerdown",this._onSliderPointerDown),("browser"===j_.env?j_:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}}},{key:"render",value:function(){this._reset();var t=this.attribute,e=t.direction,i=void 0===e?"horizontal":e,n=t.width,r=t.height,a=t.range,o=t.limitRange,s=void 0===o?[0,1]:o,l=t.railStyle,u=t.sliderStyle,c=t.padding,h=void 0===c?2:c,d=this.createOrUpdateChild("scrollbar-container",{},"group"),p=d.createOrUpdateChild("scrollbar-rail",Object.assign({x:0,y:0,width:n,height:r},l),"rect");this._rail=p;var f,v=this.getSliderRenderBounds(),g=this._getSliderPos(Kt(a,s[0],s[1])),y=g[1]-g[0];this._sliderSize=y,f="horizontal"===i?{x:g[0],y:v.y1,width:y,height:v.height}:{x:v.x1,y:g[0],width:v.width,height:y};var m=d.createOrUpdateChild("slider",Object.assign(Object.assign(Object.assign(Object.assign({},f),{cornerRadius:this._getDefaultSliderCornerRadius()}),u),{boundsPadding:Di(h),pickMode:"imprecise"}),"rect");this._slider=m,this._container=d;var _=this._container.AABBBounds;this._viewPosition={x:_.x1,y:_.y1}}},{key:"getSliderRenderBounds",value:function(){if(this._sliderRenderBounds)return this._sliderRenderBounds;var t=this.attribute,e=t.width,i=t.height,n=t.padding,r=m(Di(void 0===n?2:n),4),a=r[0],o=r[1],s=r[2],l=r[3],u={x1:l,y1:a,x2:e-o,y2:i-s,width:Math.max(0,e-(l+o)),height:Math.max(0,i-(a+s))};return this._sliderRenderBounds=u,u}},{key:"_getDefaultSliderCornerRadius",value:function(){var t=this.attribute,e=t.direction;if(t.round){var i=this.getSliderRenderBounds(),n=i.width,r=i.height;return"horizontal"===e?r:n}return 0}},{key:"_getSliderPos",value:function(t){var e=this.attribute.direction,i=this.getSliderRenderBounds(),n=i.width,r=i.height,a=i.x1,o=i.y1;return"horizontal"===e?[n*t[0]+a,n*t[1]+a]:[r*t[0]+o,r*t[1]+o]}},{key:"_getScrollRange",value:function(){if(this._sliderLimitRange)return this._sliderLimitRange;var t=this.attribute,e=t.limitRange,i=void 0===e?[0,1]:e,n=t.direction,r=m(Kt(i,0,1),2),a=r[0],o=r[1],s=this.getSliderRenderBounds(),l=s.width,u=s.height,c=s.x1,h=s.y1,d=this._sliderSize;return"horizontal"===n?Kt([c+a*l,c+o*l],c,l-d):Kt([h+a*u,h+o*u],h,u-d)}},{key:"_clearDragEvents",value:function(){var t=this,e=kC(),i="browser"===j_.env?j_:this.stage;i.removeEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),e.forEach((function(e){i.removeEventListener(e,t._onSliderPointerUp)}))}},{key:"_reset",value:function(){this._sliderRenderBounds=null,this._sliderLimitRange=null}},{key:"release",value:function(t){_(e,"release",this,3)([t]),("browser"===j_.env?j_:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearDragEvents()}}])}(Sx);AC.defaultAttributes={direction:"horizontal",round:!0,sliderSize:20,sliderStyle:{fill:"rgba(0, 0, 0, .5)"},railStyle:{fill:"rgba(0, 0, 0, .0)"},padding:2,scrollRange:[0,1],delayType:"throttle",delayTime:0,realTime:!0};var MC,TC=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},wC=MC=function(){return o((function t(){var e=this;r(this,t),this.name="scrollbar",this.activeEvent="onRegister",this._uid=gs.GenAutoIncrementId(),this.key=this.name+this._uid,this.scroll=function(t){var i,n,r=t.target,a=e.getScrollContainer(r);if(a||e.scrollContainer){if(!a&&e.scrollContainer){if(!e.scrollContainer.g.stage||e.scrollContainer.g.stage!==r.stage)return;var o=e.formatScrollContainer(e.scrollContainer.g);if(!o)return void e.clearScrollbar(e.scrollContainer.g,"all");e.scrollContainer.showH&&!o.showH&&e.clearScrollbar(e.scrollContainer.g,"horizontal"),e.scrollContainer.showV&&!o.showV&&e.clearScrollbar(e.scrollContainer.g,"vertical"),e.scrollContainer=o}else a&&e.scrollContainer&&a.g!==e.scrollContainer.g&&e.clearScrollbar(e.scrollContainer.g,"all");if(e.scrollContainer=null!=a?a:e.scrollContainer,a){var s=a.g;if(s){var l=s.attribute,u=l.width,c=l.height,h=l.scrollX,d=void 0===h?0:h,p=l.scrollY,f=void 0===p?0:p,v=d,g=f,y=a.showH,m=a.showV;e.scrollContainerBounds=(new mi).set(0,0,s.attribute.width,s.attribute.height),y&&y&&(_e(t.deltaX)>_e(t.deltaY)?(y=y&&!0,m=m&&!1):(y=y&&!1,m=m&&!0));var _=e.childrenBounds.width(),b=e.childrenBounds.height();y&&((v=d-(null!==(i=t.deltaX)&&void 0!==i?i:0))>0?v=0:v<u-_&&(v=u-_)),m&&((g=f-(null!==(n=t.deltaY)&&void 0!==n?n:0))>0?g=0:g<c-b&&(g=c-b)),s.setAttributes({scrollX:v,scrollY:g}),e.addOrUpdateScroll(y,m,s.parent,s)}}}},this.handleScrollBarChange=function(t){if(e.scrollContainer&&e.scrollContainerBounds&&e.childrenBounds&&t&&t.target&&t.detail&&t.detail.value){var i=t.target,n=t.detail.value;if("horizontal"===i.attribute.direction){var r=e.childrenBounds.width();e.scrollContainer.g.setAttributes({scrollX:-n[0]*r})}else{var a=e.childrenBounds.height();e.scrollContainer.g.setAttributes({scrollY:-n[0]*a})}}}}),[{key:"activate",value:function(t){this.pluginService=t;var e=this.pluginService.stage;this.childrenBounds=new _i,e.addEventListener("wheel",this.scroll),this.params=MC.defaultParams}},{key:"initEventOfScrollbar",value:function(t,e,i){t.addEventListener("pointerover",(function(){e.setAttribute("visibleAll",!0)})),t.addEventListener("pointermove",(function(){e.setAttribute("visibleAll",!0)})),t.addEventListener("pointerout",(function(){e.setAttribute("visibleAll",!1)})),e.addEventListener("pointerover",(function(){e.setAttribute("visibleAll",!0)})),e.addEventListener("pointerout",(function(){e.setAttribute("visibleAll",!0)})),e.addEventListener("scrollUp",this.handleScrollBarChange),e.addEventListener(xC,this.handleScrollBarChange)}},{key:"addOrUpdateScroll",value:function(t,e,i,n){if(t){var r=this.addOrUpdateHScroll(n,i,!0),a=r.scrollBar;r.isUpdate||this.initEventOfScrollbar(n,a,!0)}else this.clearScrollbar(n,"horizontal");if(e){var o=this.addOrUpdateHScroll(n,i,!1),s=o.scrollBar;o.isUpdate||this.initEventOfScrollbar(n,s,!1)}else this.clearScrollbar(n,"vertical")}},{key:"getDirection",value:function(t){return t?"horizontal":"vertical"}},{key:"addOrUpdateHScroll",value:function(t,e,i){var n,r,a=this.getDirection(i),o="".concat(null!==(n=t.name)&&void 0!==n?n:t._uid,"_").concat(this.getDirection(i),"_").concat(this.name),s=e.children.filter((function(t){return t.name===o})),l=!0,u=s[0],c=this.scrollContainer.g.attribute,h=c.y,d=void 0===h?0:h,p=c.dy,f=void 0===p?0:p,v=c.x,g=void 0===v?0:v,y=c.dx,m=void 0===y?0:y,_=c.height,b=c.width,x=c.zIndex,k={x:0,y:0,direction:a,zIndex:(void 0===x?0:x)+1,visibleAll:!0,padding:[2,0],railStyle:{fill:"rgba(0, 0, 0, .1)"},range:[0,.05]};i?(k.width=this.scrollContainerBounds.width(),k.height=12):(k.height=this.scrollContainerBounds.height(),k.width=12),u?s.length>1&&s.forEach((function(t,e){var i;e&&(null===(i=t.parent)||void 0===i||i.removeChild(t))})):(l=!1,(u=new AC(k)).name=o,e.add(u),u.isScrollBar=!0);var S=this.childrenBounds,A=t.attribute,M=A.scrollX,T=A.scrollY;if(i){var w=Math.min(this.scrollContainerBounds.width()/S.width(),1),C=Math.max(Math.min(M/this.childrenBounds.width(),0),w-1);k.x=g+m,k.y=d+f+_-(null!==(r=k.height)&&void 0!==r?r:0),k.range=[-C,-C+w]}else{var E=Math.min(this.scrollContainerBounds.height()/S.height(),1),P=Math.max(Math.min(T/this.childrenBounds.height(),0),E-1);k.x=g+m+b-this.scrollContainerBounds.width(),k.y=d+f,k.range=[-P,-P+E]}return u.setAttributes(k),{scrollBar:u,isUpdate:l}}},{key:"clearScrollbar",value:function(t,e){t.parent&&t.parent.children.filter((function(t){return t.isScrollBar&&("all"===e||t.attribute.direction===e)})).forEach((function(t){t.parent.removeChild(t)}))}},{key:"formatScrollContainer",value:function(t){if(!t||"group"!==t.type||!t.attribute)return null;var e=t.attribute,i=e.overflow,n=e.width,r=e.height;if(!i||"hidden"===i)return null;var a=!1,o=!1;"scroll"===i?(a=!0,o=!0):o=!(a="scroll-x"===i);var s=this.childrenBounds;return s.clear(),t.forEachChildren((function(t){s.union(t.AABBBounds)})),t.AABBBounds.empty()||(a&&(a=n<s.width()),o&&(o=r<s.height())),a||o?{g:t,showH:a,showV:o}:null}},{key:"getScrollContainer",value:function(t){for(var e=t;e;){var i=this.formatScrollContainer(e);if(i)return i;e=e.parent}return null}},{key:"deactivate",value:function(t){this.pluginService.stage.removeEventListener("wheel",this.scroll)}}])}();wC.defaultParams={timeout:500},wC=MC=TC([Ps()],wC);var CC=new ys((function(t,e,i,n){i(wC)||(t(wC).toSelf(),t(l_).toService(wC))}));function EC(t,e){t.forEachChildren((function(t){var i=e(t);t.isContainer&&!i&&EC(t,e)}))}var PC=function(t){return!j(t)&&!1!==t.visible};function BC(t){return t>=0&&t<Math.PI/2||t>3*Math.PI/2&&t<=2*Math.PI}function RC(t,e,i){return Math.abs(t-e)<i}function LC(t,e,i){return t?{textAlign:"right",textBaseline:"middle"}:{textAlign:e<Math.PI&&i.toLocaleLowerCase().includes("top")||e>Math.PI&&i.toLocaleLowerCase().includes("bottom")?"left":e<Math.PI&&i.toLocaleLowerCase().includes("bottom")||e>Math.PI&&i.toLocaleLowerCase().includes("top")?"right":"center",textBaseline:e<Math.PI&&i.includes("inside")||e>Math.PI&&!i.includes("inside")?"bottom":"top"}}var IC=["#ffffff","#000000"];function DC(t,e,i,n,r,a){if("string"!=typeof t||"string"!=typeof e)return t;var o=new Li(t).toHex(),s=new Li(e).toHex();return OC(o,s,i,n,a)?o:function(t,e,i,n,r,a){var o=[];r&&(r instanceof Array?o.push.apply(o,b(r)):o.push(r)),o.push.apply(o,IC);for(var s=0,l=o;s<l.length;s++){var u=l[s];if(t!==u&&OC(u,e,i,n,a))return u}}(o,s,i,n,r,a)}function OC(t,e,i,n,r){if("lightness"===r){var a=Li.getColorBrightness(new Li(e));return Li.getColorBrightness(new Li(t))<.5?a>=.5:a<.5}return n?FC(t,e)>n:"largeText"===i?FC(t,e)>3:FC(t,e)>4.5}function FC(t,e){var i=zC(t),n=zC(e);return((i>n?i:n)+.05)/((i>n?n:i)+.05)}function zC(t){var e=function(t){for(var e="",i="",n="",r="#"===t[0]?1:0,a=r;a<t.length;a++)"#"!==t[a]&&(a<r+2?e+=t[a]:a<r+4?i+=t[a]:a<r+6&&(n+=t[a]));return[parseInt(e,16),parseInt(i,16),parseInt(n,16)]}(t),i=e[0]/255,n=e[1]/255,r=e[2]/255;return.2126*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))}function HC(t,e,i,n){var r;switch(t){case"base":r=e;break;case"invertBase":r=i;break;case"similarBase":r=n}return r}function NC(t,e){return[t[0]*e,t[1]*e]}function VC(t){var e=m(t,2),i=e[0],n=e[1];return Math.sqrt(i*i+n*n)}function jC(t,e,i){var n=function(t,e){var i=m(t,2),n=i[0],r=i[1],a=m(e,2),o=a[0],s=a[1],l=Math.sqrt((n*n+r*r)*(o*o+s*s)),u=l&&(n*o+r*s)/l;return Math.acos(Math.min(Math.max(u,-1),1))}(t,e),r=Ee(t,e)>=0;return i?r?2*Math.PI-n:n:r?n:2*Math.PI-n}var UC=function(t,e,i,n){return new pi(Object.assign({defaultFontParams:Object.assign({fontFamily:mC,fontSize:14},n),getTextBounds:i?void 0:Sg,specialCharSet:"-/: .,@%'\"~"+pi.ALPHABET_CHAR_SET+pi.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t)};function WC(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t)return{width:0,height:0};var n=Sg({text:t,fontFamily:e.fontFamily||i.fontFamily||mC,fontSize:e.fontSize||i.fontSize||12,fontWeight:e.fontWeight||i.fontWeight,textAlign:e.textAlign||"center",textBaseline:e.textBaseline,ellipsis:!!e.ellipsis,maxLineWidth:e.maxLineWidth||1/0,lineHeight:e.fontSize||i.fontSize||12});return{width:n.width(),height:n.height()}}function GC(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"type";return W(t.text)&&"type"in t.text?null!==(e=t.text.type)&&void 0!==e?e:"text":n in t&&null!==(i=t[n])&&void 0!==i?i:"text"}function YC(t){var e,i;return U(t.maxLineWidth)&&(t.maxWidth=t.maxLineWidth,delete t.maxLineWidth),t.width=null!==(e=t.width)&&void 0!==e?e:0,t.height=null!==(i=t.height)&&void 0!==i?i:0,t.textConfig=t.text.text||t.text,t}function XC(t){var e=GC(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"type");return"rich"===e?kg.richtext(YC(t)):("html"===e?t=function(t){var e=t.text,i=t._originText,n=e.text;return t.html=n,t.text=i,t.renderable=!1,t}(t):"react"===e&&(t=function(t){var e=t.text,i=t._originText,n=e.text;return t.react=n,t.text=i,t.renderable=!1,t}(t)),kg.text(t))}function KC(t,e,i,n,r){"right"===t?"center"===i?e.setAttribute("x",n-r/2):"right"===i||"end"===i?e.setAttribute("x",n):e.setAttribute("x",n-r):"center"===i?e.setAttribute("x",n+r/2):"right"===i||"end"===i?e.setAttribute("x",n+r):e.setAttribute("x",n)}var qC=function(t,e){var i=Math.atan2(t,e);return i<0?i+2*Math.PI:i};function ZC(t,e){var i=e.x1,n=e.y1,r=e.x2,a=e.y2,o=t.AABBBounds,s=o.x1,l=o.y1,u=o.x2,c=o.y2,h=0,d=0;return s<i&&(h=i-s),l<n&&(d=n-l),u>r&&(h=r-u),c>a&&(d=a-c),{dx:h,dy:d}}function JC(t,e){var i=ZC(t,e),n=i.dx,r=i.dy,a=t.attribute,o=a.dx,s=void 0===o?0:o,l=a.dy,u=void 0===l?0:l;n&&t.setAttribute("dx",n+s),r&&t.setAttribute("dy",r+u)}function QC(){Kw(),rC(),cC(),oC(),dC()}var $C=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};QC();var tE=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="tag",a._tagStates=[],a._rectStates=[],a._symbolStates=[],a._textStates=[],a}return h(e,t),o(e,[{key:"getBgRect",value:function(){return this._bgRect}},{key:"getTextShape",value:function(){return this._textShape}},{key:"render",value:function(){var t,e,i,n=this;this.cacheStates();var r,a,o,s,l=this.attribute,u=l.text,c=void 0===u?"":u,h=l.textStyle,d=void 0===h?{}:h,p=l.shape,f=void 0===p?{}:p,v=l.panel,g=void 0===v?{}:v,y=l.space,m=void 0===y?4:y,_=l.minWidth,b=l.maxWidth,x=l.padding,k=void 0===x?4:x,S=l.visible,A=l.state,M=l.type,T=l.textAlwaysCenter,w=l.containerTextAlign,C=Di(k),E=this.createOrUpdateChild("tag-content",{x:0,y:0,zIndex:1},"group"),P=-C[3],B=-C[0],R=C[1]+C[3],L=C[0]+C[2],I=0,D=0,O=f.visible,F=$C(f,["visible"]);if(N(O)){var z=(null==F?void 0:F.size)||10,H=Q(z)?z:Math.max(z[0],z[1]);r=E.createOrUpdateChild("tag-shape",Object.assign(Object.assign({symbolType:"circle",size:z,strokeBoundsBuffer:0},F),{visible:O,x:H/2,y:H/2}),"symbol"),lt(null==A?void 0:A.shape)||(r.states=A.shape),O&&(D=H+m)}if(R+=D,I+=D,function(t){return"rich"===GC(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"type")}({text:c})||"rich"===M){var V=Object.assign(Object.assign(Object.assign({},YC(Object.assign({type:M,text:c},d))),d),{visible:U(c)&&!1!==S,x:I,y:0});j(V.lineHeight)&&(V.lineHeight=d.fontSize),o=(a=E.createOrUpdateChild("tag-text",V,"richtext")).AABBBounds.width(),s=a.AABBBounds.height()}else{var G=Object.assign(Object.assign({text:W(c)&&"type"in c&&"text"===c.type?c.text:c,visible:U(c)&&!1!==S,lineHeight:null==d?void 0:d.fontSize},d),{x:I,y:0});j(G.lineHeight)&&(G.lineHeight=d.fontSize),a=E.createOrUpdateChild("tag-text",G,"text");var Y=WC(G.text,d,null===(e=null===(t=this.stage)||void 0===t?void 0:t.getTheme())||void 0===e?void 0:e.text);o=Y.width,s=Y.height}R+=o;var X=null!==(i=f.size)&&void 0!==i?i:10,K=Q(X)?X:Math.max(X[0],X[1]);L+=Math.max(s,f.visible?K:0);var q=d.textAlign,Z=d.textBaseline;(U(_)||U(b))&&(U(_)&&R<_&&(R=_),U(b)&&R>b&&(R=b,a.setAttribute("maxLineWidth",b-C[1]-C[2]))),P=0,B=0;var J=0;"left"===q||"start"===q?J=1:"right"===q||"end"===q?J=-1:"center"===q&&(J=0),J?J<0?(P-=R,r&&r.setAttribute("x",(r.attribute.x||0)-o),E.setAttribute("x",-C[1]-D)):J>0&&E.setAttribute("x",C[3]):(P-=R/2,r&&r.setAttribute("x",(r.attribute.x||0)-o/2),E.setAttribute("x",-D/2));var $="right"===w||"end"===w,tt="left"===w||"start"===w,et=function(t,e){"richtext"===a.type?a.setAttributes({x:t,textAlign:e,textConfig:St(a.attribute.textConfig).map((function(t){return Object.assign(Object.assign({},t),{textAlign:e})}))}):a.setAttributes({x:t,textAlign:e})};if((w?"center"===w:T)&&J){var it=R-C[1]-C[3],nt=o+D,rt=1===J?(it-nt)/2+D+o/2:C[0]+D-(R/2+nt/2-D)+o/2;if(et(rt,"center"),r){var at=rt-o/2-D+K/2;r.setAttributes({x:at})}}if(tt&&1!==J){var ot=R-C[1]-C[3],st=0===J?-ot/2+D/2:-R+C[3]+C[1]+D;if(et(st+D,"left"),r){var ut=st+K/2;r.setAttributes({x:ut})}}if($&&-1!==J){var ct=R-C[1]-C[3],ht=0===J?ct/2+D/2:ct;if(et(ht,"right"),r){var dt=ht-o-D+K/2;r.setAttributes({x:dt})}}"middle"===Z?(B-=L/2,r&&r.setAttribute("y",0)):"bottom"===Z?(B-=L,r&&r.setAttribute("y",-s/2),E.setAttribute("y",-C[2])):"top"===Z&&(E.setAttribute("y",C[0]),r&&r.setAttribute("y",s/2)),lt(null==A?void 0:A.text)||(a.states=A.text);var pt=g.visible,ft=$C(g,["visible"]);if(S&&N(pt)){var vt=this.createOrUpdateChild("tag-panel",Object.assign(Object.assign({},ft),{visible:pt&&!!c,width:R,height:L,x:P,y:B}),"rect");if(lt(null==A?void 0:A.panel)||(vt.states=A.panel),ft.customShape){var gt=ft.customShape;vt.pathProxy=function(t){return gt(n,t,new Mu)}}this._bgRect=vt}this._textShape=a,this._symbol=r,this.resetStates()}},{key:"initAttributes",value:function(t,i){t=(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t),_(e,"initAttributes",this,3)([t]),this.render()}},{key:"addState",value:function(t,i,n){_(e,"addState",this,3)([t,i,n]),this._textShape&&this._textShape.addState(t,i,n),this._bgRect&&this._bgRect.addState(t,i,n),this._symbol&&this._symbol.addState(t,i,n)}},{key:"removeState",value:function(t,i){_(e,"removeState",this,3)([t,i]),this._textShape&&this._textShape.removeState(t,i),this._bgRect&&this._bgRect.removeState(t,i),this._symbol&&this._symbol.removeState(t,i)}},{key:"cacheStates",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p;this._tagStates=null!==(e=null===(t=this.currentStates)||void 0===t?void 0:t.slice())&&void 0!==e?e:[],this._rectStates=null!==(r=null===(n=null===(i=this._bgRect)||void 0===i?void 0:i.currentStates)||void 0===n?void 0:n.slice())&&void 0!==r?r:[],this._symbolStates=null!==(s=null===(o=null===(a=this._symbol)||void 0===a?void 0:a.currentStates)||void 0===o?void 0:o.slice())&&void 0!==s?s:[],this._textStates=null!==(c=null===(u=null===(l=this._textShape)||void 0===l?void 0:l.currentStates)||void 0===u?void 0:u.slice())&&void 0!==c?c:[],this.clearStates(),null===(h=this._bgRect)||void 0===h||h.clearStates(),null===(d=this._symbol)||void 0===d||d.clearStates(),null===(p=this._textShape)||void 0===p||p.clearStates()}},{key:"resetStates",value:function(){var t,e,i;this._tagStates.length&&this.useStates(this._tagStates),this._rectStates.length&&(null===(t=this._bgRect)||void 0===t||t.useStates(this._rectStates)),this._symbolStates.length&&(null===(e=this._symbol)||void 0===e||e.useStates(this._symbolStates)),this._textStates.length&&(null===(i=this._textShape)||void 0===i||i.useStates(this._textStates))}}])}(Sx);tE.defaultAttributes={visible:!0,textStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},space:4,padding:4,shape:{fill:"#000"}};var eE={visible:!0,position:"auto",titleStyle:{fontSize:16,fill:"#08979c"},contentStyle:{fontSize:12,fill:"green"},panel:{visible:!0,fill:"#e6fffb",size:12,space:0,stroke:"#87e8de",lineWidth:1,cornerRadius:4}},iE={poptip:gt({},eE)};var nE=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},rE=new _i;Kw(),dC(),cC(),rC();var aE="M -0.5 -0.5, L -0.5 0.5, L 0.5 -0.5, Z",oE="M -0.5 -0.5, L -0.5 0.5, L 0.5 0.5, Z",sE="M -0.5 -0.5, L 0.5 -0.5, L 0.5 0.5, Z",lE="M 0.5 -0.5, L 0.5 0.5, L -0.5 0.5, Z",uE={tl:aE,tr:sE,bl:oE,br:lE,lt:aE,lb:oE,rt:sE,rb:lE},cE=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="poptip",a.positionList=["top","tl","tr","bottom","bl","br","left","lt","lb","right","rt","rb"],a}return h(e,t),o(e,[{key:"render",value:function(){var t,e,i,n,r,a,o,s,l,u=this.attribute,c=u.titleStyle,h=void 0===c?{}:c,d=u.position,p=u.contentStyle,f=void 0===p?{}:p,v=u.panel,g=u.logoSymbol,y=u.poptipAnchor,m=void 0===y?"position":y,_=u.logoText,b=u.logoTextStyle,x=void 0===b?{}:b,k=u.triangleMode,S=void 0===k?"default":k,A=u.space,M=void 0===A?4:A,T=u.minWidth,w=void 0===T?0:T,C=u.maxWidth,E=void 0===C?1/0:C,P=u.padding,B=void 0===P?4:P,R=u.maxWidthPercent,L=u.visible,I=u.state,D=u.dx,O=void 0===D?0:D,F=u.dy,z=void 0===F?0:F,H=u.positionBounds,V=this.attribute,j=V.title,W=void 0===j?"":j,G=V.content,Y=void 0===G?"":G;W=this.attribute.titleFormatMethod?this.attribute.titleFormatMethod(W):W,Y=this.attribute.contentFormatMethod?this.attribute.contentFormatMethod(Y):Y;var X=Di(B),K=this.createOrUpdateChild("poptip-content",{x:0,y:0,zIndex:1},"group");this.group=K;var Z=E-X[1]-X[3],J=U(W)&&!1!==L,Q=Object.assign(Object.assign({text:q(W)?W:[W],visible:J,wrap:!0},h),{x:X[3],y:X[0],maxLineWidth:Z,textAlign:"left",textBaseline:"top"}),$=K.createOrUpdateChild("poptip-title",Q,"text");lt(null==I?void 0:I.title)||($.states=I.title);var tt=$.AABBBounds,et=tt.height(),it=tt.width(),nt=et+M;J||(nt=0);var rt=U(Y)&&!1!==L,at=Object.assign(Object.assign({text:q(Y)?Y:[Y],visible:rt,wrap:!0},f),{x:X[3],y:X[0]+nt,maxLineWidth:Z,textAlign:"left",textBaseline:"top"}),ot=K.createOrUpdateChild("poptip-content",at,"text");lt(null==I?void 0:I.content)||(ot.states=I.content);var st=ot.AABBBounds,ut=st.height(),ct=st.width();rt&&(nt+=ut),this.titleShape=$,this.contentShape=ot;var ht=ke(it+X[1]+X[3],ct+X[1]+X[3]);ht>E?ht=E:ht<w&&(ht=w);var dt=X[0]+X[2]+nt,pt=v.visible,ft=v.square,vt=nE(v,["visible","square"]);if(ft){var gt=ke(ht,dt);ht=gt;var yt=gt-dt;dt=gt,$.setAttributes({dy:yt/2}),ot.setAttributes({dy:yt/2})}var mt=null!==(t=vt.size)&&void 0!==t?t:12,_t=q(mt)?[mt[0]+(null!==(e=vt.space)&&void 0!==e?e:0),mt[1]+(null!==(i=vt.space)&&void 0!==i?i:0)]:mt+(null!==(n=vt.space)&&void 0!==n?n:0),bt=null!==(r=vt.lineWidth)&&void 0!==r?r:1,xt=this.stage?[null!==(a=this.stage.viewWidth)&&void 0!==a?a:this.stage.width,null!==(o=this.stage.viewHeight)&&void 0!==o?o:this.stage.height]:void 0;if(xt){var kt=this.AABBBounds,St=null!==(s=this.attribute.x)&&void 0!==s?s:kt.x1,At=xt[0]-kt.x1,Mt=Math.max(St,At),Tt=(q(mt)?mt[0]:12)+3;if((Mt=Math.min(Mt-Tt,Mt*R))<ht){ht=Mt;var wt=X[1]+X[3];$.setAttribute("maxLineWidth",Mt-wt),ot.setAttribute("maxLineWidth",Mt-wt),dt=X[0]+X[2],J&&(dt+=$.AABBBounds.height()+M),dt+=ot.AABBBounds.height()}}for(var Ct,Et="auto"===d||q(d),Pt=q(d)?d:this.positionList,Bt=-1/0,Rt=0;Rt<Pt.length+1;Rt++){var Lt=Et?Pt[Rt===Pt.length?Ct:Rt]:d,It="arrow2Left",Dt=(q(mt)?mt[0]:mt)/4,Ot=0;"top"===Lt||"bottom"===Lt||"left"===Lt||"right"===Lt?It="arrow2Left":"concise"===S&&(It=uE[Lt],Dt=["tl","bl","rt","rb"].includes(Lt)?(q(mt)?mt[0]:mt)/2:-(q(mt)?mt[0]:mt)/2,Ot=["tl","tr","lb","rb"].includes(Lt)?-(q(mt)?mt[1]:mt)/2:(q(mt)?mt[1]:mt)/2);var Ft=this.getAngleAndOffset(Lt,ht,dt,q(_t)?_t:[_t,_t-bt],It),zt=Ft.angle,Ht=Ft.offset,Nt=void 0,Vt={x:0,y:0};if("bounds"===m&&H&&(Vt=this.calculateAnchorPoint(Lt,H)),N(pt)){var jt=void 0;Nt=K.createOrUpdateChild("poptip-symbol-panel",Object.assign(Object.assign({},vt),{visible:pt&&(rt||J),x:Dt,y:Ot,strokeBoundsBuffer:-1,boundsPadding:-2,anchor:[0,0],symbolType:It,angle:zt,dx:Ht[0],dy:Ht[1]-(null!==(l=vt.space)&&void 0!==l?l:0),size:mt,zIndex:9}),"symbol"),lt(null==I?void 0:I.panel)||(Nt.states=I.panel),jt=v.panelSymbolType?K.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},vt),{visible:pt&&(rt||J),x:0,y:0,symbolType:"rect",size:[ht,dt],zIndex:-8}),"symbol"):K.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},vt),{visible:pt&&(rt||J),x:0,y:0,width:ht,height:dt,zIndex:-8}),"rect"),lt(null==I?void 0:I.panel)||(jt.states=I.panel)}if(K.setAttributes({x:-Ht[0]+O+Vt.x,y:-Ht[1]+z+Vt.y,anchor:[Dt,Ot]}),g){var Ut=g.size,Wt=void 0===Ut?12:Ut,Gt=q(Wt)?Wt:[Wt,Wt];"auto"===Gt[1]&&(Gt[1]=dt),"auto"===Gt[0]&&(Gt[0]=dt);var Yt=Gt[0];K.createOrUpdateChild("poptip-logo",Object.assign(Object.assign({},g),{x:0,y:dt/2,visible:pt&&(rt||J),zIndex:10,size:Gt}),"symbol"),K.setAttributes({x:-Ht[0]+O+Yt/2,y:-Ht[1]+z}),_&&K.createOrUpdateChild("poptip-logo-text",Object.assign(Object.assign({},x),{x:0,y:dt/2,visible:pt&&(rt||J),text:_,textAlign:"center",textBaseline:"middle",zIndex:10}),"text")}if(!xt)break;rE.setValue(0,0,ht,dt).transformWithMatrix(K.globalTransMatrix);var Xt=rE,Kt=(new mi).setValue(0,0,xt[0],xt[1]);if(Et){if(Qe(Xt,Kt,!1))break;var qt=Ze(Xt,Kt,!1),Zt=(qt.x2-qt.x1)*(qt.y2-qt.y1);Zt>Bt&&(Bt=Zt,Ct=Rt)}if(["top","bottom","left","right"].includes(Lt)){var Jt="top"===Lt||"bottom"===Lt,Qt="left"===Lt||"right"===Lt,$t=!1;if(Jt?$t="top"===Lt&&Xt.y1<0||"bottom"===Lt&&Xt.y2>Kt.y2:Qt&&($t="left"===Lt&&Xt.x1<0||"right"===Lt&&Xt.x2>Kt.x2),!$t){var te=0,ee=(q(mt)?mt[1]:mt)/2;Jt?(Xt.x1<0?te=-Xt.x1:Xt.x2>Kt.x2&&(te=Kt.x2-Xt.x2),K.setAttribute("x",K.attribute.x+te),Nt.setAttribute("dx",Se(ke(Nt.attribute.dx-te,ee),Xt.width()-ee))):Qt&&(Xt.y1<0?te=-Xt.y1:Xt.y2>Kt.y2&&(te=Kt.y2-Xt.y2),K.setAttribute("y",K.attribute.y+te),Nt.setAttribute("dy",Se(ke(Nt.attribute.dy-te,ee),Xt.height()-ee)));break}}if(!Et)break}}},{key:"calculateAnchorPoint",value:function(t,e){if(!e)return{x:0,y:0};var i=this.attribute,n=i.x,r=i.y,a=e.x1,o=e.y1,s=e.x2,l=e.y2,u=s-a,c=l-o;switch(t){case"top":case"tl":case"tr":return{x:a+u/2-n,y:o-r};case"bottom":case"bl":case"br":return{x:a+u/2-n,y:l-r};case"left":case"lt":case"lb":return{x:a-n,y:o+c/2-r};case"right":case"rt":case"rb":return{x:s-n,y:o+c/2-r};default:return{x:0,y:0}}}},{key:"getAngleAndOffset",value:function(t,e,i,n,r){var a="arrow2Left"===r?n[1]/2:n[1];switch(t){case"tl":return{angle:"arrow2Left"===r?ve/2*3:0,offset:"arrow2Left"===r?[e/4,i+a]:[0,i+a]};case"top":return{angle:ve/2*3,offset:[e/2,i+a]};case"tr":return{angle:"arrow2Left"===r?ve/2*3:0,offset:"arrow2Left"===r?[e/4*3,i+a]:[e,i+a]};case"rt":return{angle:0,offset:"arrow2Left"===r?[-a,i/5]:[-a,0]};case"right":return{angle:0,offset:[-a,i/2]};case"rb":return{angle:0,offset:"arrow2Left"===r?[-a,i/5*4]:[-a,i]};case"bl":return{angle:"arrow2Left"===r?ve/2:0,offset:"arrow2Left"===r?[e/4,-a]:[0,-a]};case"bottom":return{angle:ve/2,offset:[e/2,-a]};case"br":return{angle:"arrow2Left"===r?ve/2:0,offset:"arrow2Left"===r?[e/4*3,-a]:[e,-a]};case"lt":return{angle:"arrow2Left"===r?ve:0,offset:"arrow2Left"===r?[e+a,i/5]:[e+a,0]};case"left":return{angle:ve,offset:[e+a,i/2]};case"lb":return{angle:"arrow2Left"===r?ve:0,offset:"arrow2Left"===r?[e+a,i/5*4]:[e+a,i]}}}}])}(Sx);cE.defaultAttributes={position:"rt",visible:!0,title:null,content:null,titleStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},contentStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},panel:{},maxWidthPercent:.8,space:8,padding:10};var hE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o};var dE=function(){return o((function t(){r(this,t)}),[{key:"render",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p,f;if(1===t._showPoptip){var v=t.attribute.poptip||{},g=v.visible,y=v.visibleCb;if(!1===g||y&&!1===y(t))return;var m={};gt(m,cE.defaultAttributes,t.attribute.poptip?t.attribute.poptip:{}),this.poptipComponent?this.poptipComponent.initAttributes(m):this.poptipComponent=new cE(m);var _=t.attribute.poptip||{};if("text"===t.type&&null==_.title&&null==_.content){var b={};gt(b,iE.poptip,_),(_=b).content=null!==(p=_.content)&&void 0!==p?p:t.attribute.text}var x=t.globalTransMatrix;this.poptipComponent.setAttributes(Object.assign(Object.assign({visibleAll:!0,pickable:!1,childrenPickable:!1,poptipAnchor:"bounds"},_),{x:x.e,y:x.f,positionBounds:t.globalAABBBounds})),u.stage.tryInitInteractiveLayer();var k=u.stage.getLayer("_builtin_interactive");k&&k.add(this.poptipComponent)}else 2===t._showPoptip&&(t._showPoptip=0,this.poptipComponent&&(this.poptipComponent.setAttributes({visibleAll:!1}),null===(f=this.poptipComponent.parent)||void 0===f||f.removeChild(this.poptipComponent),this.poptipComponent=null))}}])}();dE=hE([Ps()],dE);var pE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},fE=function(){return o((function t(){var e=this;r(this,t),this.activeEvent="onRegister",this._uid=gs.GenAutoIncrementId(),this.poptip=function(t){var i=t.target;e.needHide(i)?e.unpoptip(t):i!==e.activeGraphic&&(e.needShow(i)&&(i.setAttributes({}),i._showPoptip=1),e.activeGraphic&&(e.activeGraphic.setAttributes({}),e.activeGraphic._showPoptip=2),e.setActiveGraphic(i,!0))},this.unpoptip=function(t){e.activeGraphic&&(e.activeGraphic.setAttributes({}),e.activeGraphic._showPoptip=2,e.setActiveGraphic(null,!0))}}),[{key:"activate",value:function(t){this.pluginService=t,this.pluginService.stage.addEventListener("pointerover",this.poptip)}},{key:"needHide",value:function(t){return t.isContainer||!t.attribute}},{key:"needShow",value:function(t){return!!t.attribute.poptip}},{key:"setActiveGraphic",value:function(t,e){this.activeGraphic=t,this.pluginService.stage.renderNextFrame()}},{key:"deactivate",value:function(t){this.pluginService.stage.removeEventListener("pointerover",this.poptip)}}])}(),vE=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="poptip",t.key=t.name+t._uid,t}return h(e,t),o(e)}(fE);vE=pE([Ps()],vE);var gE=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="poptipForText",t.key=t.name+t._uid,t.pointerlave=function(e){var i=t.pluginService.stage;e.target===i&&t.unpoptip(e)},t}return h(e,t),o(e,[{key:"activate",value:function(t){_(e,"activate",this,3)([t]),this.pluginService.stage.addEventListener("pointerleave",this.pointerlave)}},{key:"needHide",value:function(t){return"text"!==t.type||!t.cliped||t.isContainer||!t.attribute||t.attribute.disableAutoClipedPoptip}},{key:"needShow",value:function(t){return!0}},{key:"deactivate",value:function(t){var i=this.pluginService.stage;_(e,"deactivate",this,3)([t]),i.removeEventListener("pointerleave",this.pointerlave)}}])}(fE);gE=pE([Ps()],gE);var yE=new ys((function(t,e,i,n){i(dE)||(t(dE).toSelf().inSingletonScope(),t(_v).toService(dE)),i(vE)||(t(vE).toSelf(),t(l_).toService(vE)),i(gE)||(t(gE).toSelf(),t(l_).toService(gE))}));var mE=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="crosshair",t}return h(e,t),o(e,[{key:"render",value:function(){this.renderCrosshair(this)}}])}(Sx);Kw(),Qw();var _E=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.start,n=e.end,r=e.lineStyle;return t.createOrUpdateChild("crosshair-line",Object.assign({points:[i,n]},r),"line")}},{key:"setLocation",value:function(t){var e=t.start,i=t.end;this.setAttributes({start:e,end:i})}}])}(mE);_E.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},Kw(),rC();var bE=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.start,n=e.end,r=e.rectStyle;return t.createOrUpdateChild("crosshair-rect",Object.assign({x:i.x,y:i.y,width:n.x-i.x,height:n.y-i.y},r),"rect")}},{key:"setLocation",value:function(t){var e=t.start,i=t.end;this.setAttributes({start:e,end:i})}}])}(mE);bE.defaultAttributes={rectStyle:{fill:"#b2bacf",opacity:.2}},Kw(),Nw();var xE=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.center,n=e.radius,r=e.lineStyle;return t.createOrUpdateChild("crosshair-circle",Object.assign(Object.assign(Object.assign(Object.assign({},i),{outerRadius:n}),this.attribute),r),"arc")}},{key:"setLocation",value:function(t){var e=this.attribute.center,i=Oe.distancePP(t,e);this.setAttribute("radius",i)}}])}(mE);xE.defaultAttributes={lineStyle:{stroke:["#b2bacf",!1,!1,!1],lineWidth:1,lineDash:[2]}},Kw(),Nw();var kE=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.center,n=e.radius,r=e.innerRadius,a=void 0===r?0:r,o=e.sectorStyle,s=this.attribute,l=s.startAngle,u=s.endAngle;return t.createOrUpdateChild("crosshair-sector",Object.assign(Object.assign(Object.assign({},i),{outerRadius:n,innerRadius:a,startAngle:l,endAngle:u}),o),"arc")}},{key:"setLocation",value:function(t){var e=this.attribute,i=e.center,n=e.startAngle,r=void 0===n?gC:n,a=e.endAngle,o=(void 0===a?yC:a)-r,s=ze(Ue(i,t));this.setAttributes({startAngle:s-o/2,endAngle:s+o/2})}}])}(mE);kE.defaultAttributes={sectorStyle:{fill:"#b2bacf",opacity:.2}},Kw(),tC();var SE=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderCrosshair",value:function(t){for(var e,i=this.attribute,n=i.center,r=i.radius,a=i.sides,o=void 0===a?6:a,s=i.lineStyle,l=this.attribute,u=l.startAngle,c=l.endAngle,h=(c-u)%(2*Math.PI)==0,d=(c-u)/o,p=0;p<=o;p++){var f=Ve(n,r,u+d*p);0===p?e="M".concat(f.x,",").concat(f.y):e+="L".concat(f.x,",").concat(f.y),p===o&&h&&(e+="Z")}return t.createOrUpdateChild("crosshair-polygon",Object.assign({path:e},s),"path")}},{key:"setLocation",value:function(t){var e=this.attribute.center,i=Oe.distancePP(t,e);this.setAttribute("radius",i)}}])}(mE);function AE(){Kw(),Qw(),iC(),cC()}function ME(){Kw(),Qw(),Nw(),cC()}SE.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},AE();var TE=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="segment",a.key="segment",a.lines=[],a}return h(e,t),o(e,[{key:"getStartAngle",value:function(){return We(this._startAngle)}},{key:"getEndAngle",value:function(){return We(this._endAngle)}},{key:"getMainSegmentPoints",value:function(){return this._mainSegmentPoints}},{key:"render",value:function(){var t=this;this.removeAllChild(!0),this._reset();var e=this.attribute,i=e.startSymbol,n=e.endSymbol,r=e.lineStyle,a=e.state,o=e.visible,s=void 0===o||o,l=e.multiSegment,u=e.mainSegmentIndex;if(s){this._computeLineAngle();var c=this._getMainSegmentPoints(),h=this._renderSymbol(i,c,"start"),d=this._renderSymbol(n,c,"end");if(this.startSymbol=h,this.endSymbol=d,l){var p=b(this.attribute.points);if(et(u))p[u]=this._clipPoints(p[u]);else{var f=this._clipPoints(Et(p));p[0][0]=f[0],p[p.length-1][p[p.length-1].length-1]=f[f.length-1]}p.forEach((function(e,i){var n,o,s=kg.line(Object.assign(Object.assign({points:e},q(r)?null!==(n=r[i])&&void 0!==n?n:r[r.length-1]:r),{fill:!1}));s.name="".concat(t.name,"-line"),s.id=t._getNodeId("line"+i),lt(null==a?void 0:a.line)||(s.states=q(a.line)?null!==(o=a.line[i])&&void 0!==o?o:a.line[a.line.length-1]:a.line),t.add(s),t.lines.push(s)}))}else{var v=kg.line;St(r)[0].cornerRadius&&(v=kg.polygon);var g=v(Object.assign(Object.assign({points:this._clipPoints(this.attribute.points)},St(r)[0]),{fill:!1,closePath:!1}));g.name="".concat(this.name,"-line"),g.id=this._getNodeId("line"),lt(null==a?void 0:a.line)||(g.states=[].concat(a.line)[0]),this.add(g),this.lines.push(g)}}}},{key:"_computeStartRotate",value:function(t){return t+Math.PI/2}},{key:"_computeEndRotate",value:function(t){return t+Math.PI/2}},{key:"_renderSymbol",value:function(t,e,i){if(e.length){var n,r=t.autoRotate,a=void 0===r||r;if(t&&t.visible){var o,s,l=this.getStartAngle(),u=this.getEndAngle(),c=this.attribute.state,h=e[0],d=e[e.length-1],p=t.refX,f=void 0===p?0:p,v=t.refY,g=void 0===v?0:v,y=t.refAngle,m=void 0===y?0:y,_=t.style,b=t.symbolType,x=t.size,k=void 0===x?12:x;"start"===i?(o={x:h.x+(et(l)?f*Math.cos(l)+g*Math.cos(l-Math.PI/2):0),y:h.y+(et(l)?f*Math.sin(l)+g*Math.sin(l-Math.PI/2):0)},s=this._computeStartRotate(this._startAngle)):(o={x:d.x+(et(u)?f*Math.cos(u)+g*Math.cos(u-Math.PI/2):0),y:d.y+(et(u)?f*Math.sin(u)+g*Math.sin(u-Math.PI/2):0)},s=this._computeEndRotate(this._endAngle)),(n=kg.symbol(Object.assign(Object.assign(Object.assign({},o),{symbolType:b,size:k,angle:a?s+m:0,strokeBoundsBuffer:0}),_))).name="".concat(this.name,"-").concat(i,"-symbol"),n.id=this._getNodeId("".concat(i,"-symbol")),lt(null==c?void 0:c.symbol)||(n.states=c.symbol),"start"===i?lt(null==c?void 0:c.startSymbol)||(n.states=c.startSymbol):lt(null==c?void 0:c.endSymbol)||(n.states=c.endSymbol),this.add(n)}return n}}},{key:"_getMainSegmentPoints",value:function(){if(this._mainSegmentPoints)return this._mainSegmentPoints;var t,e=this.attribute,i=e.points,n=e.multiSegment,r=e.mainSegmentIndex;return t=n?et(r)?i[r]:Et(i):i,this._mainSegmentPoints=t,t}},{key:"_clipPoints",value:function(t){var e=this.attribute,i=e.startSymbol,n=void 0===i?{}:i,r=e.endSymbol,a=void 0===r?{}:r,o=t;if(n.visible){var s=n.clip?n.size||10:0;o=[{x:t[0].x-s/2*(Math.cos(this._startAngle)||0),y:t[0].y-s/2*(Math.sin(this._startAngle)||0)}].concat(b(o.slice(1)))}if(a.visible){var l=a.clip?a.size||10:0,u={x:t[t.length-1].x-l/2*(Math.cos(this._endAngle)||0),y:t[t.length-1].y-l/2*(Math.sin(this._endAngle)||0)};o=[].concat(b(o.slice(0,o.length-1)),[u])}return o}},{key:"_computeLineAngle",value:function(){var t=this._getMainSegmentPoints();if(!(t.length<=1)){var e=t[0],i=t[1],n=t[t.length-2],r=t[t.length-1],a=[e.x-i.x,e.y-i.y],o=Math.atan2(a[1],a[0]),s=[r.x-n.x,r.y-n.y],l=Math.atan2(s[1],s[0]);this._startAngle=o,this._endAngle=l}}},{key:"_reset",value:function(){this.startSymbol=null,this.endSymbol=null,this._startAngle=null,this._endAngle=null,this._mainSegmentPoints=null}}])}(Sx);TE.defaultAttributes={visible:!0,lineStyle:{lineWidth:1,stroke:"#000"},startSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}},endSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}}},ME();var wE,CE,EE=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},TE.defaultAttributes,t)])).name="arc-segment",a.key="arc-segment",a.isReverseArc=!1,a}return h(e,t),o(e,[{key:"getStartAngle",value:function(){var t=this.isReverseArc?this._startAngle+Math.PI/2:this._startAngle-Math.PI/2;return t<0?t+2*Math.PI:t>2*Math.PI?t-2*Math.PI:t}},{key:"getEndAngle",value:function(){var t=this.isReverseArc?this._endAngle-Math.PI/2:this._endAngle+Math.PI/2;return t<0?t+2*Math.PI:t>2*Math.PI?t-2*Math.PI:t}},{key:"getMainSegmentPoints",value:function(){return this._mainSegmentPoints}},{key:"_computeStartRotate",value:function(t){return this.isReverseArc?t+Math.PI:t}},{key:"_computeEndRotate",value:function(t){return this.isReverseArc?t:t+Math.PI}},{key:"render",value:function(){this.removeAllChild(!0),this._reset();var t=this.attribute,e=t.startSymbol,i=t.endSymbol,n=t.lineStyle,r=t.state,a=t.visible,o=void 0===a||a,s=t.radius,l=t.startAngle,u=t.endAngle,c=t.center;if(o){this._startAngle=l,this._endAngle=u,this.isReverseArc=l>u;var h={x:c.x+s*Math.cos(this._startAngle),y:c.y+s*Math.sin(this._startAngle)},d={x:c.x+s*Math.cos(this._endAngle),y:c.y+s*Math.sin(this._endAngle)};this._mainSegmentPoints=[h,d];var p=this._renderSymbol(e,this._mainSegmentPoints,"start"),f=this._renderSymbol(i,this._mainSegmentPoints,"end");this.startSymbol=p,this.endSymbol=f;var v=kg.arc(Object.assign({x:c.x,y:c.y,startAngle:l,endAngle:u,innerRadius:s,outerRadius:s},n));v.name="".concat(this.name,"-line"),v.id=this._getNodeId("arc"),lt(null==r?void 0:r.line)||(v.states=[].concat(r.line)[0]),this.add(v),this.line=v}}}])}(TE);!function(t){t.innerView="inner-view",t.axisContainer="axis-container",t.labelContainer="axis-label-container",t.tickContainer="axis-tick-container",t.tick="axis-tick",t.subTick="axis-sub-tick",t.label="axis-label",t.title="axis-title",t.gridContainer="axis-grid-container",t.grid="axis-grid",t.gridRegion="axis-grid-region",t.line="axis-line",t.background="axis-background",t.axisLabelBackground="axis-label-background",t.axisBreak="axis-break",t.axisBreakSymbol="axis-break-symbol"}(wE||(wE={})),function(t){t.selected="selected",t.selectedReverse="selected_reverse",t.hover="hover",t.hoverReverse="hover_reverse"}(CE||(CE={}));var PE=l(l(l(l({},CE.selectedReverse,{}),CE.selected,{}),CE.hover,{}),CE.hoverReverse,{}),BE={title:{space:4,padding:0,textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1}},label:{visible:!0,inside:!1,space:4,padding:0,style:{fontSize:12,fill:"#333",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#999",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}}},RE={size:8,stroke:"#000",lineWidth:1,zIndex:1};function LE(t,e){var i,n;return(null===(i=t.OBBBounds)||void 0===i?void 0:i.empty())||(null===(n=e.OBBBounds)||void 0===n?void 0:n.empty())?$e(t.AABBBounds,e.AABBBounds,!1)&&(!t.rotatedBounds||!e.rotatedBounds||ai(t.rotatedBounds,e.rotatedBounds,!0)):t.OBBBounds.intersects(e.OBBBounds)}var IE=Math.sin(Math.PI/10);function DE(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IE,i=!j(t)&&0!==t,n=i?Math.cos(t):1;return i&&Math.abs(n)<=e}function OE(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IE,i=!j(t)&&0!==t,n=i?Math.sin(t):0;return!i||Math.abs(n)<=e}function FE(t){var e={};return EC(t,(function(t){"group"!==t.type&&t.id&&(e[t.id]=t)})),e}function zE(t,e){return{x:t.x+e[0],y:t.y+e[1]}}function HE(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=[e.x-i.x,e.y-i.y];return NC(a,(n?-1:1)*(r?-1:1)*t/VC(a))}function NE(t,e,i,n,r){for(var a=[],o=r-n,s=0;s<e;s++){var l=n+s*o/e;a.push(Ve(t,i,l))}return a}function VE(t,e){var i="";return 0===t.length||(t.forEach((function(t,e){0===e?i="M".concat(t.x,",").concat(t.y):i+="L".concat(t.x,",").concat(t.y)})),e&&(i+="Z")),i}function jE(t,e,i){var n;if(OE(null===(n=t.attribute)||void 0===n?void 0:n.angle,Number.EPSILON))return i>vi(t.AABBBounds,e.AABBBounds);var r=t.OBBBounds,a=e.OBBBounds;return!r||!a||r.empty()||a.empty()?i>vi(t.AABBBounds,e.AABBBounds):r.intersects(a)||i>gi(r,a)}function UE(t,e){for(var i,n=1,r=t.length,a=t[0];n<r;a=i,++n)if(jE(a,i=t[n],e))return!0;return!1}var WE=function(t,e,i){var n=t.target;return n!==i&&n.name&&!lt(n.states)?(n.addState(vC.hover,!0),EC(e,(function(t){t!==n&&t.name&&!lt(t.states)&&t.addState(vC.hoverReverse,!0)})),n):i},GE=function(t,e,i){return i?(EC(e,(function(t){t.name&&!lt(t.states)&&(t.removeState(vC.hoverReverse),t.removeState(vC.hover))})),null):i},YE=function(t,e,i){var n=t.target;return i===n&&n.hasState(vC.selected)?(EC(e,(function(t){t.name&&!lt(t.states)&&(t.removeState(vC.selectedReverse),t.removeState(vC.selected))})),null):n.name&&!lt(n.states)?(n.addState(vC.selected,!0),EC(e,(function(t){t!==n&&t.name&&!lt(t.states)&&t.addState(vC.selectedReverse,!0)})),n):i},XE=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"_prepareAnimate",value:function(t){if(!1!==this.attribute.animation){var e=this.attribute,i=e.animation,n=e.animationEnter,r=e.animationExit,a=e.animationUpdate,o=W(i)?i:{};this._animationConfig={enter:!1!==n&&gt({},t,o,null!=n?n:{}),exit:!1!==r&&gt({},t,o,null!=r?r:{}),update:!1!==a&&(q(a)?a:gt({},t,o,null!=a?a:{}))}}else this._animationConfig={enter:!1,exit:!1,update:!1}}}])}(Sx),KE={type:"default",duration:300,easing:"linear"},qE=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="axis",t.data=[],t.tickLineItems=[],t.subTickLineItems=[],t.axisLabelLayerSize={},t.axisLabelsContainer=null,t._onHover=function(e){t._lastHover=WE(e,t.axisContainer,t._lastHover)},t._onUnHover=function(e){t._lastHover=GE(0,t.axisContainer,t._lastHover)},t._onClick=function(e){t._lastSelect=YE(e,t.axisContainer,t._lastSelect)},t}return h(e,t),o(e,[{key:"getInnerView",value:function(){return this._innerView}},{key:"getPrevInnerView",value:function(){return this._prevInnerView}},{key:"getBoundsWithoutRender",value:function(t){var e=dt(this.attribute);e.scale=this.attribute.scale,this.attribute=t;var i=kg.group({x:this.attribute.x,y:this.attribute.y});return this.add(i),this._renderInner(i),this.removeChild(i),this.attribute=e,i.AABBBounds}},{key:"render",value:function(){this._prepare(),this._prevInnerView=this._innerView&&FE(this._innerView),this.removeAllChild(!0),this._innerView=kg.group({x:0,y:0,pickable:!1}),this.add(this._innerView),this._renderInner(this._innerView),this._bindEvent(),this.runAnimation()}},{key:"_prepare",value:function(){this._prepareAnimate(KE)}},{key:"_bindEvent",value:function(){if(!this.attribute.disableTriggerEvent){var t=this.attribute,e=t.hover,i=t.select;e&&(this._innerView.addEventListener("pointermove",this._onHover),this._innerView.addEventListener("pointerout",this._onUnHover)),i&&this._innerView.addEventListener("pointerdown",this._onClick)}}},{key:"_renderInner",value:function(t){var e=this,i=this.attribute,n=i.title,r=i.label,a=i.tick,o=i.line,s=i.items,l=kg.group({x:0,y:0,zIndex:1,pickable:!1});if(l.name=wE.axisContainer,l.id=this._getNodeId("container"),l.setMode(this.mode),this.axisContainer=l,t.add(l),o&&o.visible&&this.renderLine(l),s&&s.length&&(this.data=this._transformItems(s[0]),a&&a.visible&&this.renderTicks(l),r&&r.visible)){var u=kg.group({x:0,y:0,pickable:!1});u.name=wE.labelContainer,u.id=this._getNodeId("label-container"),this.axisLabelsContainer=u,l.add(u),s.forEach((function(t,i){var n=e.renderLabels(u,t,i),r=n.getChildren();e.beforeLabelsOverlap(r,t,n,i,s.length),e.handleLabelsOverlap(r,t,n,i,s.length),e.afterLabelsOverlap(r,t,n,i,s.length);var a=0,o=0,l="center",c="middle",h=0;r.forEach((function(t,e){var i,n=t.attribute,r=null!==(i=n.angle)&&void 0!==i?i:0,s=t.AABBBounds,u=s.width(),d=s.height();r&&(u=Math.abs(u*Math.cos(r)),d=Math.abs(d*Math.sin(r))),a=Math.max(a,u),o=Math.max(o,d),l=n.textAlign,c=n.textBaseline,0===e&&(h=n.x)})),e.axisLabelLayerSize[i]={width:a,height:o,labelPos:h,textAlign:l,textBaseline:c}}))}n&&n.visible&&this.renderTitle(l)}},{key:"renderTicks",value:function(t){var e=this,i=this.getTickLineItems(),n=kg.group({x:0,y:0,pickable:!1});n.name=wE.tickContainer,n.id=this._getNodeId("tick-container"),t.add(n),i.forEach((function(t,r){var a,o=kg.line(Object.assign({},e._getTickLineAttribute("tick",t,r,i)));if(o.name=wE.tick,o.id=e._getNodeId(t.id),lt(null===(a=e.attribute.tick)||void 0===a?void 0:a.state))o.states=_C;else{var s=e.data[r],l=gt({},_C,e.attribute.tick.state);Object.keys(l).forEach((function(t){V(l[t])&&(l[t]=l[t](s.rawValue,r,s,e.data))})),o.states=l}n.add(o)})),this.tickLineItems=i;var r=this.attribute.subTick;if(r&&r.visible){var a=this.getSubTickLineItems();a.length&&a.forEach((function(t,a){var o=kg.line(Object.assign({},e._getTickLineAttribute("subTick",t,a,i)));if(o.name=wE.subTick,o.id=e._getNodeId("".concat(a)),lt(r.state))o.states=_C;else{var s=gt({},_C,r.state);Object.keys(s).forEach((function(e){V(s[e])&&(s[e]=s[e](t.value,a,t,i))})),o.states=s}n.add(o)})),this.subTickLineItems=a}}},{key:"renderLabels",value:function(t,e,i){var n=this,r=this.attribute.label.dataFilter;r&&V(r)&&(e=r(e,i));var a=this._transformItems(e),o=kg.group({x:0,y:0,pickable:!1});return o.name="".concat(wE.labelContainer,"-layer-").concat(i),o.id=this._getNodeId("label-container-layer-".concat(i)),t.add(o),a.forEach((function(t,e){var r,s=XC(n._getLabelAttribute(t,e,a,i));if(s.name=wE.label,s.id=n._getNodeId("layer".concat(i,"-label-").concat(t.id)),lt(null===(r=n.attribute.label)||void 0===r?void 0:r.state))s.states=_C;else{var l=gt({},_C,n.attribute.label.state);Object.keys(l).forEach((function(n){V(l[n])&&(l[n]=l[n](t,e,a,i))})),s.states=l}s.data=Object.assign(Object.assign({},t),{index:e,layer:i}),o.add(s)})),o}},{key:"renderTitle",value:function(t){var e=this.getTitleAttribute(),i=new tE(Object.assign({},e));i.name=wE.title,i.id=this._getNodeId("title"),t.add(i)}},{key:"getVerticalCoord",value:function(t,e,i){return zE(t,this.getVerticalVector(e,i,t))}},{key:"getTickLineItems",value:function(){var t=this,e=this.attribute.tick,i=this.data,n=[],r=e.alignWithLabel,a=e.inside,o=void 0!==a&&a,s=e.length,l=e.dataFilter,u=1;return i.length>=2&&(u=i[1].value-i[0].value),(l&&V(l)?l(i):i).forEach((function(e){var i=e.point,a=e.value;if(!r){var l=e.value-u/2;if(t.isInValidValue(l))return;i=t.getTickCoord(l),a=l}var c=t.getVerticalCoord(i,s,o);if("3d"===t.mode){var h=t.getVerticalVector(s,o,i),d=0,p=0;_e(h[0])>_e(h[1])?d=ve/2*(c.x>i.x?1:-1):p=ve/2*(c.y>i.y?-1:1),n.push({start:i,end:c,value:a,id:"tick-".concat(e.id),anchor:[i.x,i.y],alpha:d,beta:p})}else n.push({start:i,end:c,value:a,id:"tick-".concat(e.id)})})),n}},{key:"getSubTickLineItems",value:function(){var t=this.attribute.subTick,e=[],i=t.count,n=void 0===i?4:i,r=t.inside,a=void 0!==r&&r,o=t.length,s=void 0===o?2:o,l=this.tickLineItems,u=l.length;if(u>=2)for(var c=0;c<u-1;c++)for(var h=l[c],d=l[c+1],p=0;p<n;p++){var f=(p+1)/(n+1),v=(1-f)*h.value+f*d.value,g=this.getTickCoord(v),y=this.getVerticalCoord(g,s,a);e.push({start:g,end:y,value:v,id:"sub-tick-".concat(v)})}return e}},{key:"_getTickLineAttribute",value:function(t,e,i,n){var r=ut(this.attribute,"".concat(t,".style")),a=this.data[i];r=V(r)?gt({},ut(BE,"".concat(t,".style")),"tick"===t?r(a.rawValue,i,a,this.data):r(e.value,i,e,n)):r;var o=e.start,s=e.end,l=e.anchor,u=e.alpha,c=e.beta;return Object.assign({points:[o,s],anchor:l,alpha:u,beta:c},r)}},{key:"_getLabelAttribute",value:function(t,e,i,n){var r,a,o=this.attribute.label,s=o.space,l=void 0===s?4:s,u=o.inside,c=void 0!==u&&u,h=o.formatMethod,d=o.type,p=void 0===d?"text":d,f=o.text,v=l,g=0;(null===(r=this.attribute.tick)||void 0===r?void 0:r.visible)&&this.attribute.tick.inside===c&&(g=this.attribute.tick.length||4),(null===(a=this.attribute.subTick)||void 0===a?void 0:a.visible)&&this.attribute.subTick.inside===c&&(g=Math.max(g,this.attribute.subTick.length||2)),v+=g;var y=this.getRelativeVector(t.point);n>0&&(0===y[1]?v+=(this.axisLabelLayerSize[n-1].height+ut(this.attribute,"label.space",4))*n:v+=(this.axisLabelLayerSize[n-1].width+ut(this.attribute,"label.space",4))*n);var m=this.getVerticalCoord(t.point,v,c),_=this.getVerticalVector(v||1,c,m),b=h?h("".concat(t.label),t,e,i,n):t.label,x=this.attribute.label.style;return x=V(x)?gt({},BE.label.style,x(t,e,i,n)):x,x=gt(this.getLabelAlign(_,c,x.angle),x),V(x.text)&&(x.text=x.text({label:t.label,value:t.rawValue,index:t.index,layer:n})),Object.assign(Object.assign(Object.assign({},this.getLabelPosition(m,_,b,x)),{text:null!=f?f:b,_originText:t.label,lineHeight:null==x?void 0:x.fontSize,type:p}),x)}},{key:"getLabelPosition",value:function(t,e,i,n){return t}},{key:"_transformItems",value:function(t){var e=this,i=[];return t.forEach((function(t){var n;i.push(Object.assign(Object.assign({},t),{point:e.getTickCoord(t.value),id:null!==(n=t.id)&&void 0!==n?n:t.label}))})),i}},{key:"runAnimation",value:function(){var t=this,e=this.lastScale;if(this.attribute.scale){var i=this.attribute.scale;this.lastScale=i.clone(),this.lastScale.range([0,1])}if(this.attribute.animation&&this.applyAnimationState){var n=this.getInnerView(),r=this.getPrevInnerView();if(!r)return;var a=this._animationConfig;this._newElementAttrMap={},EC(n,(function(i){var n;if("group"!==i.type&&i.id){var o=r[i.id];if(i.setFinalAttributes(i.attribute),o){o.release();var s=o.attribute,l=i.getFinalAttribute(),u=function(t,e,i){var n={};for(var r in e)r in t&&bt(t[r],e[r])||(n[r]=e[r]);if(i)for(var a in t)if(!(a in e)){var o=i(a);void 0!==o&&(n[a]=o)}return n}(s,l),c=Object.keys(u).length>0;if("opacity"in s&&l.opacity!==s.opacity&&(u.opacity=null!==(n=l.opacity)&&void 0!==n?n:1,c=!0),a.update&&c){t._newElementAttrMap[i.id]={state:"update",node:i,attrs:i.attribute};var h=o.attribute;i.setAttributes(h),i.applyAnimationState(["update"],[{name:"update",animation:Object.assign(Object.assign({selfOnly:!0},a.update),{type:"axisUpdate",customParameters:{config:a.update,diffAttrs:u,lastScale:e}})}])}}else a.enter&&(t._newElementAttrMap[i.id]={state:"enter",node:i,attrs:i.attribute},i.applyAnimationState(["enter"],[{name:"enter",animation:Object.assign(Object.assign({},a.enter),{type:"axisEnter",selfOnly:!0,customParameters:{config:a.enter,lastScale:e,getTickCoord:t.getTickCoord.bind(t)}})}]))}}))}}},{key:"release",value:function(){_(e,"release",this,3)([]),this._prevInnerView=null,this._innerView=null}}])}(XE),ZE={parity:function(t){return t.filter((function(t,e){return e%2?t.setAttribute("opacity",0):1}))},greedy:function(t,e){var i;return t.filter((function(t,n){return n&&jE(i,t,e)?t.setAttribute("opacity",0):(i=t,1)}))}};function JE(t){var e;return(e=t.OBBBounds.empty()?t.AABBBounds:t.OBBBounds).width()>1&&e.height()>1}function QE(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(i&&!t.attribute.opacity){var a=e.length;if(a>1){t.setAttribute("opacity",1);for(var o=0;o<a;o++){var s=r?e[a-1-o]:e[o];if(!n(s))break;s.setAttribute("opacity",0)}}}}function $E(t,e){if(!lt(t)){var i=t.filter(JE);if(!lt(i)){var n;n=function(t){return t.forEach((function(t){return t.setAttribute("opacity",1)})),t}(i);var r=e.method,a=void 0===r?"parity":r,o=e.separation,s=void 0===o?0:o,l=V(a)?a:ZE[a]||ZE.parity;if(n.length>=3&&UE(n,s)){do{n=l(n,s)}while(n.length>=3&&UE(n,s));var u=function(t,e){return(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&t<3||e},c=u(n.length,e.firstVisible,!1),h=u(n.length,e.lastVisible),d=i[0],p=At(i);jE(d,p,s)&&c&&h&&(p.setAttribute("opacity",0),h=!1),QE(d,n,c,(function(t){return jE(t,d,s)})),QE(p,n,h,(function(t){return jE(t,p,s)||!(!c||t===d)&&jE(t,d,s)}),!0)}i.forEach((function(t){t.setAttribute("visible",!!t.attribute.opacity)}))}}}function tP(t,e){if(!lt(t)){var i=e.orient,n=e.labelRotateAngle,r=void 0===n?[0,45,90]:n;if(0!==r.length&&!t.some((function(t){return!!t.attribute.angle}))){var a=0,o=0,s=function(){var e=r[a++];if(t.forEach((function(t){t.attribute.angle=Fe(e)})),function(t,e){"bottom"!==t&&"top"!==t||function(t,e){e.forEach((function(e){e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},iP(t,e.attribute.angle)),{angle:eP(e.attribute.angle)}))}))}(t,e),"left"!==t&&"right"!==t||function(t,e){e.forEach((function(e,i){e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},nP(t,e.attribute.angle)),{angle:eP(e.attribute.angle)}))}))}(t,e),function(t){t.forEach((function(t){if(!t.rotatedBounds&&t.attribute.angle){var e=function(t){var e=t.AABBBounds;return{x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2,centerX:t.attribute.x,centerY:t.attribute.y,angle:t.attribute.angle}}(t),i=ii({x:t.attribute.x,y:t.attribute.y},e.angle,{x:e.centerX,y:e.centerY}),n=i.x-e.centerX,r=i.y-e.centerY;e.x1+=n,e.x2+=n,e.y1+=r,e.y2+=r,e.centerX+=n,e.centerY+=r,t.rotatedBounds=e}}))}(e)}(i,t),!function(t){for(var e=1;e<t.length;e++)if(LE(t[e-1],t[e]))return!0;return!1}(t))return 1};for(r&&r.length>0&&(o=r.length);a<o&&!s(););}}}function eP(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(t<0)for(;t<0;)t+=2*Math.PI;if(t>0)for(;t>=2*Math.PI;)t-=2*Math.PI;return t}function iP(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=["center","left","left","left","center","right","right","right","left"],n=["top","top","middle","bottom","bottom","bottom","middle","top","top"];"top"===t&&(i=["center","right","right","right","center","left","left","left","right"],n=["bottom","bottom","middle","top","top","top","middle","bottom","bottom"]);var r,a=(e=eP(e))/(.5*Math.PI);return{textAlign:i[r=a===Math.floor(a)?2*Math.floor(a):2*Math.floor(a)+1],textBaseline:n[r]}}function nP(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=["right","right","center","left","left","left","center","right","right"],n=["middle","middle","top","top","middle","middle","bottom","bottom","middle"];"right"===t&&(i=["left","left","center","right","right","right","center","left","left"],n=["middle","middle","bottom","bottom","middle","middle","top","middle","middle"]);var r,a=(e=eP(e))/(.5*Math.PI);return{textAlign:i[r=a===Math.floor(a)?2*Math.floor(a):2*Math.floor(a)+1],textBaseline:n[r]}}function rP(t,e){var i=e.limitLength,n=e.verticalLimitLength,r=e.ellipsis,a=void 0===r?"...":r,o=e.orient,s=e.axisLength;if(!lt(t)&&et(i)){var l=function(t){return et(t)?{left:t,right:t}:W(t)?{left:t.left||0,right:t.right||0}:{left:0,right:0}}(e.overflowLimitLength),u=t[0],c=u.attribute.angle,h=!j(c),d=h?Math.cos(c):1,p=h?Math.sin(c):0,f=OE(c),v=DE(c),g="top"===o||"bottom"===o,y=u.attribute.direction,m=!f&&!v&&g&&(t.length<2||t.some((function(t){return Math.abs(t.AABBBounds.width()-u.AABBBounds.width())>=2})))&&u.AABBBounds.width()>Math.abs(i/p);t.forEach((function(t){var e;if(g){if(v&&Math.floor(t.AABBBounds.height())<=i)return;if(f&&Math.floor(t.AABBBounds.width())<=n)return}if(!g){if("vertical"===y&&Math.floor(t.AABBBounds.height())<=n)return;if("vertical"!==y){if(f&&Math.floor(t.AABBBounds.width())<=i)return;if(v&&Math.floor(t.AABBBounds.height())<=n)return}}var r=null;if(f||v)r=g?f?n:i:"vertical"===y||v?n:i;else if(g){var o=t.AABBBounds,u=o.x1,c=o.x2,h=p/d,_=Math.abs(i/p);if(m&&h>0&&u<=s+l.right&&i/h+u>s+l.right){var b=(s-u+l.right)/Math.abs(d);r=Math.min(b,_)}else if(m&&h<0&&c>=-l.left&&i/h+c<-l.left){var x=(c+l.left)/Math.abs(d);r=Math.min(x,_)}else r=_}else r=Math.abs(i/d);et(t.attribute.maxLineWidth)&&(r=et(r)?Math.min(t.attribute.maxLineWidth,r):t.attribute.maxLineWidth),t.setAttributes({maxLineWidth:r,ellipsis:null!==(e=t.attribute.ellipsis)&&void 0!==e?e:a})}))}}function aP(t,e,i){var n;return et(e)&&(n=Math.abs(e-t)),et(i)&&(n=et(n)?Math.min(Math.abs(t-i),n):Math.abs(t-i)),n}var oP=function(){return o((function t(){r(this,t)}),[{key:"isInValidValue",value:function(t){return t<0||t>1}},{key:"getTickCoord",value:function(t){var e=this.attribute.start,i=this.getRelativeVector();return{x:e.x+i[0]*t,y:e.y+i[1]*t}}},{key:"getRelativeVector",value:function(t){var e=this.attribute,i=e.start,n=e.end;return[n.x-i.x,n.y-i.y]}},{key:"getVerticalVector",value:function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.attribute.verticalFactor,a=void 0===r?1:r,o=this.getRelativeVector(),s=((i=VC(e=o))>0&&(i=1/i),[e[0]*i,e[1]*i]);return NC([s[1],-1*s[0]],t*(n?1:-1)*a)}}])}(),sP=function(){function t(){r(this,t)}return o(t,null,[{key:"linear",value:function(t){return t}},{key:"none",value:function(){return this.linear}},{key:"get",value:function(t){return t<-1?t=-1:t>1&&(t=1),function(e){return 0===t?e:t<0?e*(e*-t+1+t):e*((2-e)*t+(1-t))}}},{key:"getPowIn",value:function(t){return function(e){return Math.pow(e,t)}}},{key:"getPowOut",value:function(t){return function(e){return 1-Math.pow(1-e,t)}}},{key:"getPowInOut",value:function(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}}},{key:"getBackIn",value:function(t){return function(e){return e*e*((t+1)*e-t)}}},{key:"getBackOut",value:function(t){return function(e){return--e*e*((t+1)*e+t)+1}}},{key:"getBackInOut",value:function(t){return t*=1.525,function(e){return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}},{key:"sineIn",value:function(t){return 1-Math.cos(t*Math.PI/2)}},{key:"sineOut",value:function(t){return Math.sin(t*Math.PI/2)}},{key:"sineInOut",value:function(t){return-(Math.cos(Math.PI*t)-1)/2}},{key:"expoIn",value:function(t){return 0===t?0:Math.pow(2,10*t-10)}},{key:"expoOut",value:function(t){return 1===t?1:1-Math.pow(2,-10*t)}},{key:"expoInOut",value:function(t){return 0===t?0:1===t?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2}},{key:"circIn",value:function(t){return-(Math.sqrt(1-t*t)-1)}},{key:"circOut",value:function(t){return Math.sqrt(1- --t*t)}},{key:"circInOut",value:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},{key:"bounceOut",value:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},{key:"bounceIn",value:function(e){return 1-t.bounceOut(1-e)}},{key:"bounceInOut",value:function(e){return e<.5?.5*t.bounceIn(2*e):.5*t.bounceOut(2*e-1)+.5}},{key:"getElasticIn",value:function(t,e){return function(i){if(0===i||1===i)return i;var n=e/me*Math.asin(1/t);return-t*Math.pow(2,10*(i-=1))*Math.sin((i-n)*me/e)}}},{key:"getElasticOut",value:function(t,e){return function(i){if(0===i||1===i)return i;var n=e/me*Math.asin(1/t);return t*Math.pow(2,-10*i)*Math.sin((i-n)*me/e)+1}}},{key:"getElasticInOut",value:function(t,e){return function(i){var n=e/me*Math.asin(1/t);return(i*=2)<1?t*Math.pow(2,10*(i-=1))*Math.sin((i-n)*me/e)*-.5:t*Math.pow(2,-10*(i-=1))*Math.sin((i-n)*me/e)*.5+1}}},{key:"registerFunc",value:function(e,i){t[e]=i}}])}();sP.quadIn=sP.getPowIn(2),sP.quadOut=sP.getPowOut(2),sP.quadInOut=sP.getPowInOut(2),sP.cubicIn=sP.getPowIn(3),sP.cubicOut=sP.getPowOut(3),sP.cubicInOut=sP.getPowInOut(3),sP.quartIn=sP.getPowIn(4),sP.quartOut=sP.getPowOut(4),sP.quartInOut=sP.getPowInOut(4),sP.quintIn=sP.getPowIn(5),sP.quintOut=sP.getPowOut(5),sP.quintInOut=sP.getPowInOut(5),sP.backIn=sP.getBackIn(1.7),sP.backOut=sP.getBackOut(1.7),sP.backInOut=sP.getBackInOut(1.7),sP.elasticIn=sP.getElasticIn(1,.3),sP.elasticOut=sP.getElasticOut(1,.3),sP.elasticInOut=sP.getElasticInOut(1,.3*1.5),sP.easeInOutQuad=function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},sP.easeOutElastic=function(t){var e=2*Math.PI/3;return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin((10*t-.75)*e)+1},sP.easeInOutElastic=function(t){var e=2*Math.PI/4.5;return 0===t?0:1===t?1:t<.5?-Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*e)/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*e)/2+1};for(var lP=function(t){sP["flicker".concat(t)]=function(e){return function(t,e){for(var i=1/e,n=1;t>i;)t-=i,n*=-1;var r=n*t/i;return r>0?r:1+r}(e,t)}},uP=0;uP<10;uP++)lP(uP);for(var cP=function(t){sP["aIn".concat(t)]=function(e){return t*e*e+(1-t)*e}},hP=2;hP<10;hP++)cP(hP);function dP(t,e,i){return t+(e-t)*i}var pP=new(o((function t(){r(this,t),this.opacity=function(t,e,i,n,r,a){a.attribute.opacity=dP(e,i,n)},this.baseOpacity=function(t,e,i,n,r,a){a.attribute.baseOpacity=dP(e,i,n)},this.fillOpacity=function(t,e,i,n,r,a){a.attribute.fillOpacity=dP(e,i,n)},this.strokeOpacity=function(t,e,i,n,r,a){a.attribute.strokeOpacity=dP(e,i,n)},this.zIndex=function(t,e,i,n,r,a){a.attribute.zIndex=dP(e,i,n)},this.backgroundOpacity=function(t,e,i,n,r,a){a.attribute.backgroundOpacity=dP(e,i,n)},this.shadowOffsetX=function(t,e,i,n,r,a){a.attribute.shadowOffsetX=dP(e,i,n)},this.shadowOffsetY=function(t,e,i,n,r,a){a.attribute.shadowOffsetY=dP(e,i,n)},this.shadowBlur=function(t,e,i,n,r,a){a.attribute.shadowBlur=dP(e,i,n)},this.fill=function(t,e,i,n,r,a){a.attribute.fill=xf(e,i,n,!1)},this.fillPure=function(t,e,i,n,r,a){a.attribute.fill=r.fromParsedProps.fill?Sf(r.fromParsedProps.fill,r.toParsedProps.fill,n):r.toParsedProps.fill},this.stroke=function(t,e,i,n,r,a){a.attribute.stroke=xf(e,i,n,!1)},this.strokePure=function(t,e,i,n,r,a){a.attribute.stroke=r.fromParsedProps.stroke?Sf(r.fromParsedProps.stroke,r.toParsedProps.stroke,n):r.toParsedProps.stroke},this.width=function(t,e,i,n,r,a){a.attribute.width=dP(e,i,n),a.addUpdateBoundTag()},this.height=function(t,e,i,n,r,a){a.attribute.height=dP(e,i,n),a.addUpdateBoundTag()},this.x=function(t,e,i,n,r,a){a.attribute.x=dP(e,i,n),a.addUpdateBoundTag(),a.addUpdatePositionTag()},this.y=function(t,e,i,n,r,a){a.attribute.y=dP(e,i,n),a.addUpdateBoundTag(),a.addUpdatePositionTag()},this.dx=function(t,e,i,n,r,a){a.attribute.dx=dP(e,i,n),a.addUpdateBoundTag(),a.addUpdatePositionTag()},this.dy=function(t,e,i,n,r,a){a.attribute.dy=dP(e,i,n),a.addUpdateBoundTag(),a.addUpdatePositionTag()},this.angle=function(t,e,i,n,r,a){a.attribute.angle=dP(e,i,n),a.addUpdateBoundTag(),a.addUpdatePositionTag()},this.scaleX=function(t,e,i,n,r,a){a.attribute.scaleX=dP(e,i,n),a.addUpdateBoundTag(),a.addUpdatePositionTag()},this.scaleY=function(t,e,i,n,r,a){a.attribute.scaleY=dP(e,i,n),a.addUpdateBoundTag(),a.addUpdatePositionTag()},this.lineWidth=function(t,e,i,n,r,a){a.attribute.lineWidth=dP(e,i,n),a.addUpdateBoundTag()},this.startAngle=function(t,e,i,n,r,a){a.attribute.startAngle=dP(e,i,n),a.addUpdateBoundTag()},this.endAngle=function(t,e,i,n,r,a){a.attribute.endAngle=dP(e,i,n),a.addUpdateBoundTag()},this.radius=function(t,e,i,n,r,a){a.attribute.radius=dP(e,i,n),a.addUpdateBoundTag()},this.outerRadius=function(t,e,i,n,r,a){a.attribute.outerRadius=dP(e,i,n),a.addUpdateBoundTag()},this.innerRadius=function(t,e,i,n,r,a){a.attribute.innerRadius=dP(e,i,n),a.addUpdateBoundTag()},this.size=function(t,e,i,n,r,a){a.attribute.size=dP(e,i,n),a.addUpdateBoundTag()},this.points=function(t,e,i,n,r,a){a.attribute.points=zh(e,i,n),a.addUpdateBoundTag()}})));function fP(t,e,i,n,r,a){if(Number.isFinite(i)&&Number.isFinite(e))return a.attribute[t]=e+(i-e)*n,!0;if(Array.isArray(i)&&Array.isArray(e)&&i.length===e.length){for(var o=[],s=!0,l=0;l<i.length;l++){var u=e[l],c=u+(i[l]-u)*n;if(!Number.isFinite(c)){s=!1;break}o.push(c)}return s&&(a.attribute[t]=o),!0}return!1}function vP(){}var gP=function(){return o((function t(e,i,n,a){var o,s=this;r(this,t),this._startTime=0,this._hasFirstRun=!1,this._syncAttributeUpdate=function(){s.target.setAttributes(s.target.attribute)},this.type=e,this.props=i,this.duration=n,this.easing=a?"function"==typeof a?a:null!==(o=sP[a])&&void 0!==o?o:sP.linear:sP.linear,"wait"===e&&(this.onUpdate=vP),this.id=gs.GenAutoIncrementId(),this.syncAttributeUpdate=vP}),[{key:"bind",value:function(t,e){this.target=t,this.animate=e,this.onBind(),this.syncAttributeUpdate()}},{key:"append",value:function(t){this.next=t,t.prev=this,t.setStartTime(this.getStartTime()+this.duration,!1)}},{key:"updateDownstreamStartTimes",value:function(){for(var t=this.next,e=this._startTime+this.duration;t;)t.setStartTime(e,!1),e+=t.duration,t=t.next;this.animate.updateDuration()}},{key:"getLastProps",value:function(){return this.prev?this.prev.props||{}:this.animate.getStartProps()}},{key:"setDuration",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.duration=t,e&&this.updateDownstreamStartTimes()}},{key:"getDuration",value:function(){return this.duration}},{key:"determineInterpolateUpdateFunction",value:function(){var t=this;if(this.props){var e=[];this.propKeys.forEach((function(i){if("fill"===i||"stroke"===i){var n=t.fromProps[i],r=t.props[i];if(K(n)&&K(r)){var a=_f.Get(n,ff.Color255),o=_f.Get(r,ff.Color255);t.fromParsedProps||(t.fromParsedProps={}),t.toParsedProps||(t.toParsedProps={}),t.fromParsedProps[i]=a,t.toParsedProps[i]=o,e.push(pP["fill"===i?"fillPure":"strokePure"])}else pP[i]?e.push(pP[i]):e.push(fP)}else pP[i]?e.push(pP[i]):e.push(fP)})),this.interpolateUpdateFunctions=e}}},{key:"setStartTime",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._startTime=t,e&&this.updateDownstreamStartTimes()}},{key:"getStartTime",value:function(){return this._startTime}},{key:"onBind",value:function(){"glyph"===this.target.type&&(this.syncAttributeUpdate=this._syncAttributeUpdate)}},{key:"onFirstRun",value:function(){}},{key:"onStart",value:function(){var t=this;if(!this._hasFirstRun){this._hasFirstRun=!0,this.fromProps=this.getLastProps();var e=this.animate.getStartProps();this.propKeys&&this.propKeys.forEach((function(i){var n;t.fromProps[i]=null!==(n=t.fromProps[i])&&void 0!==n?n:e[i]})),this.determineInterpolateUpdateFunction(),this.tryPreventConflict(),this.trySyncStartProps(),this.onFirstRun()}}},{key:"tryPreventConflict",value:function(){var t=this,e=this.animate;this.target.animates.forEach((function(i){if(!(i===e||i.priority>e.priority||i.priority===1/0)){var n=i.getStartProps();t.propKeys.forEach((function(t){null!=n[t]&&i.preventAttr(t)}))}}))}},{key:"deleteSelfAttr",value:function(t){var e;delete this.props[t],this.fromProps&&delete this.fromProps[t];var i=this.propKeys.indexOf(t);-1!==i&&(this.propKeys.splice(i,1),null===(e=this.interpolateUpdateFunctions)||void 0===e||e.splice(i,1))}},{key:"trySyncStartProps",value:function(){var t=this;this.propKeys.forEach((function(e){t.fromProps[e]=t.animate.target.getComputedAttribute(e)}))}},{key:"update",value:function(t,e,i){var n=this;if(this.onStart(),this.props&&this.propKeys){var r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((function(t,e){if(n.animate.validAttr(n.propKeys[e])){var i=n.propKeys[e];t(i,n.fromProps[i],n.props[i],r,n,n.target)}})),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}},{key:"onUpdate",value:function(t,e,i){}},{key:"onEnd",value:function(t){this.target.setAttributes(this.props),t?this._endCb=t:this._endCb&&this._endCb(this.animate,this)}},{key:"getEndProps",value:function(){return this.props}},{key:"getFromProps",value:function(){return this.fromProps}},{key:"getMergedEndProps",value:function(){return this.getEndProps()}},{key:"stop",value:function(){}},{key:"release",value:function(){}}])}(),yP=function(t){function e(t,i,a,o){return r(this,e),n(this,e,[t,i,a,o])}return h(e,t),o(e,[{key:"onStart",value:function(){_(e,"onStart",this,3)([]);var t=this.getFromProps();this.target.setAttributes(t)}},{key:"update",value:function(t,e,i){this.onStart()}},{key:"determineInterpolateUpdateFunction",value:function(){}}])}(gP),mP=function(t){function e(){var t;return r(this,e),(t=n(this,e)).head=null,t.tail=null,t.animateMap=new Map,t._animateCount=0,t._playSpeed=1,t._totalDuration=0,t._startTime=0,t._currentTime=0,t._animationEndFlag=!0,t.id=gs.GenAutoIncrementId(),t.paused=!1,t}return h(e,t),o(e,[{key:"animateCount",get:function(){return this._animateCount}},{key:"isRunning",value:function(){return!this.paused&&this._animateCount>0}},{key:"forEachAccessAnimate",value:function(t){for(var e=this.head,i=0;e;){var n=e.next;t(e.animate,i),i++,e=n}}},{key:"addAnimate",value:function(t){var e={animate:t,next:null,prev:null};this.head?this.tail&&(this.tail.next=e,e.prev=this.tail,this.tail=e):(this.head=e,this.tail=e),this.animateMap.set(t,e),this._animateCount++,this._totalDuration=Math.max(this._totalDuration,t.getStartTime()+t.getDuration())}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"tick",value:function(t){var e=this;if(!this.paused){this._animationEndFlag&&(this._animationEndFlag=!1,this.emit("animationStart"));var i=t*this._playSpeed;this._currentTime+=i,this.forEachAccessAnimate((function(t,n){t.status===tl.END?e.removeAnimate(t,!0):t.status!==tl.RUNNING&&t.status!==tl.INITIAL||t.advance(i)})),0===this._animateCount&&(this._animationEndFlag=!0,this.emit("animationEnd"))}}},{key:"clear",value:function(){this.forEachAccessAnimate((function(t){t.release()})),this.head=null,this.tail=null,this.animateMap.clear(),this._animateCount=0,this._totalDuration=0}},{key:"removeAnimate",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.animateMap.get(t);i&&(e&&(t._onRemove&&t._onRemove.forEach((function(t){return t()})),t.release()),i.prev?i.prev.next=i.next:this.head=i.next,i.next?i.next.prev=i.prev:this.tail=i.prev,this.animateMap.delete(t),this._animateCount--,t.getStartTime()+t.getDuration()>=this._totalDuration&&this.recalculateTotalDuration())}},{key:"recalculateTotalDuration",value:function(){var t=this;this._totalDuration=0,this.forEachAccessAnimate((function(e){t._totalDuration=Math.max(t._totalDuration,e.getStartTime()+e.getDuration())}))}},{key:"getTotalDuration",value:function(){return this._totalDuration}},{key:"getPlaySpeed",value:function(){return this._playSpeed}},{key:"setPlaySpeed",value:function(t){this._playSpeed=t}},{key:"getPlayState",value:function(){return this.paused?"paused":0===this.animateCount?"stopped":"playing"}},{key:"setStartTime",value:function(t){this._startTime=t}},{key:"getStartTime",value:function(){return this._startTime}},{key:"getCurrentTime",value:function(){return this._currentTime}},{key:"setCurrentTime",value:function(t){this._currentTime=t}}])}(z),_P=new mP;_P.isGlobal=!0;var bP=function(){return o((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gs.GenAutoIncrementId(),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_P,n=arguments.length>2?arguments[2]:void 0;r(this,t),this.id=e,this.status=tl.INITIAL,this._timeline=i,i.addAnimate(this),this.slience=n,this._startTime=0,this._duration=0,this._totalDuration=0,this._loopCount=0,this._currentLoop=0,this._bounce=!1,this._firstStep=null,this._lastStep=null,this._startProps={},this._endProps={},this._preventAttrs=new Set,this.currentTime=0,this.interpolateUpdateFunction=null,this.priority=0}),[{key:"getStartProps",value:function(){return this._startProps}},{key:"getEndProps",value:function(){return this._endProps}},{key:"setTimeline",value:function(t){this._timeline=t}},{key:"getTimeline",value:function(){return this._timeline}},{key:"timeline",get:function(){return this._timeline}},{key:"bind",value:function(t){var e=this;return this.target=t,this.target.animates||(this.target.animates=new Map),this.target.animates.set(this.id,this),this.onRemove((function(){e.stop(),e.target.animates.delete(e.id)})),this.target.onAnimateBind&&!this.slience&&this.target.onAnimateBind(this),this.target.animationAttribute||(this.target.animationAttribute={}),this}},{key:"to",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"linear",n=new gP($s.to,t,e,i);return n.bind(this.target,this),this.updateStepAfterAppend(n),this}},{key:"wait",value:function(t){var e=new yP($s.wait,{},t,"linear");return e.bind(this.target,this),this.updateStepAfterAppend(e),this}},{key:"updateStepAfterAppend",value:function(t){this._firstStep?(this._lastStep.append(t),this._lastStep=t):(this._firstStep=t,this._lastStep=t),this.parseStepProps(t),this.updateDuration()}},{key:"parseStepProps",value:function(t){var e=this;this._lastStep&&(t.propKeys=t.propKeys||Object.keys(t.props),Object.keys(this._endProps).forEach((function(i){var n;t.props[i]=null!==(n=t.props[i])&&void 0!==n?n:e._endProps[i]})),t.propKeys.forEach((function(i){e._endProps[i]=t.props[i]})))}},{key:"reSyncProps",value:function(){var t=this;if(this._lastStep){this._endProps={};for(var e=this._firstStep;e;)Object.keys(this._endProps).forEach((function(i){var n;e.props[i]=null!==(n=e.props[i])&&void 0!==n?n:t._endProps[i]})),e.propKeys.forEach((function(i){t._endProps[i]=e.props[i]})),e=e.next}}},{key:"from",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"linear",n=new gP($s.from,t,e,i);return this._firstStep?(this._lastStep.append(n),this._lastStep=n):(this._firstStep=n,this._lastStep=n),this.updateDuration(),this}},{key:"play",value:function(t){return t.bind(this.target,this),this.updateStepAfterAppend(t),this}},{key:"pause",value:function(){this.status===tl.RUNNING&&(this.status=tl.PAUSED)}},{key:"resume",value:function(){this.status===tl.PAUSED&&(this.status=tl.RUNNING)}},{key:"onStart",value:function(t){var e,i=this;t?(this._onStart||(this._onStart=[]),this._onStart.push(t)):(null===(e=this._onStart)||void 0===e||e.forEach((function(t){return t()})),Object.keys(this._endProps).forEach((function(t){i._startProps[t]=i.target.getComputedAttribute(t)})))}},{key:"onEnd",value:function(t){var e;t?(this._onEnd||(this._onEnd=[]),this._onEnd.push(t)):null===(e=this._onEnd)||void 0===e||e.forEach((function(t){return t()}))}},{key:"onFrame",value:function(t){t&&(this._onFrame||(this._onFrame=[]),this._onFrame.push(t))}},{key:"onRemove",value:function(t){var e;t?(this._onRemove||(this._onRemove=[]),this._onRemove.push(t)):null===(e=this._onRemove)||void 0===e||e.forEach((function(t){return t()}))}},{key:"preventAttr",value:function(t){this._preventAttrs.add(t),delete this._startProps[t],delete this._endProps[t];for(var e=this._firstStep;e;)e.deleteSelfAttr(t),e=e.next}},{key:"preventAttrs",value:function(t){var e=this;t.forEach((function(t){return e._preventAttrs.add(t)}))}},{key:"validAttr",value:function(t){return!this._preventAttrs.has(t)}},{key:"runCb",value:function(t){var e;return null===(e=this._lastStep)||void 0===e||e.onEnd(t),this}},{key:"startAt",value:function(t){return this._startTime=t,this}},{key:"customInterpolate",value:function(t,e,i,n,r,a){return!1}},{key:"getFromValue",value:function(){return this._startProps}},{key:"getToValue",value:function(){return this._endProps}},{key:"stop",value:function(t){for(var e=this._firstStep;e;)e.stop(),e=e.next;this.status!==tl.END&&this.onEnd(),this.status=tl.END,this.target&&("start"===t?this.target.setAttributes(this._startProps):"end"===t?this.target.setAttributes(this._endProps):t&&this.target.setAttributes(t))}},{key:"release",value:function(){this.status=tl.END,this._onRemove&&this._onRemove.forEach((function(t){return t()})),this._onStart=[],this._onFrame=[],this._onEnd=[],this._onRemove=[],this.forEachStep((function(t){t.release()}))}},{key:"getDuration",value:function(){return this._duration}},{key:"getStartTime",value:function(){return this._startTime}},{key:"afterAll",value:function(t){if(!t||0===t.length)return this;var e=0;return t.forEach((function(t){var i=t.getStartTime()+t.getTotalDuration();e=Math.max(e,i)})),this.startAt(e)}},{key:"after",value:function(t){if(!t)return this;var e=t.getStartTime()+t.getTotalDuration();return this.startAt(e)}},{key:"parallel",value:function(t){return t?(this.startAt(t.getStartTime()),this):this}},{key:"loop",value:function(t){return!0===t?t=1/0:!1===t&&(t=0),this._loopCount=t,this.updateDuration(),this}},{key:"bounce",value:function(t){return this._bounce=t,this}},{key:"advance",value:function(t){var e,i,n;if(this.status!==tl.END){var r=this.currentTime+t;if(r<this._startTime)this.currentTime=r;else{if(r>=this._startTime+this._totalDuration)return null===(e=this._lastStep)||void 0===e||e.onUpdate(!0,1,{}),null===(i=this._lastStep)||void 0===i||i.onEnd(),this.onEnd(),void(this.status=tl.END);this.status=tl.RUNNING,this.currentTime<=this._startTime&&this.onStart(),this.currentTime=r;var a=r-this._startTime,o=!1,s=!1;if(this._loopCount>0){a=(r-this._startTime)%this._duration;var l=Math.floor((r-this._startTime)/this._duration);o=l>this._currentLoop,this._currentLoop=l,(s=this._bounce&&l%2==1)&&(a=this._duration-a)}o&&!s&&this.target.setAttributes(this._startProps);var u=null;if(this._lastStep===this._firstStep)u=this._firstStep;else for(var c=this._firstStep;c;){var h=c.getStartTime(),d=c.getDuration();if(a>=h&&a<=h+d){u=c;break}c=c.next}if(u){u!==this.lastRunStep&&(null===(n=this.lastRunStep)||void 0===n||n.onEnd()),this.lastRunStep=u;var p=(a-u.getStartTime())/u.getDuration(),f=p>=1;u.update(f,p,{}),f&&(u.onEnd(),this.lastRunStep=null)}}}else console.warn("aaa 动画已经结束，不能推进")}},{key:"updateDuration",value:function(){this._lastStep?(this._duration=this._lastStep.getStartTime()+this._lastStep.getDuration(),this._totalDuration=this._duration*(this._loopCount+1)):this._duration=0}},{key:"getTotalDuration",value:function(){return this._totalDuration}},{key:"getLoop",value:function(){return this._loopCount}},{key:"forEachStep",value:function(t){for(var e=this._firstStep;e;)t(e),e=e.next}}])}(),xP=new sl,kP=function(){return o((function t(){r(this,t),this.released=!1}),[{key:"tick",value:function(t,e){var i=this;xP.addAnimationFrameCb((function(){if(!i.released)return e(i)}))}},{key:"release",value:function(){this.released=!0}},{key:"getTime",value:function(){return Date.now()}}])}(),SP=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).timelines=[],i.frameTimeHistory=[],i.handleTick=function(t,e){var n=(null!=e?e:{}).once,r=void 0!==n&&n;if(i.ifCanStop())return i.stop(),!1;var a=t.getTime();i._lastTickTime=a,i.lastFrameTime<0&&(i.lastFrameTime=a-i.interval+i.timeOffset,i.frameTimeHistory.push(i.lastFrameTime));var o=a-i.lastFrameTime,s=i.checkSkip(o);return s||(i._handlerTick(o),i.lastFrameTime=a,i.frameTimeHistory.push(i.lastFrameTime)),r||t.tick(i.interval,i.handleTick),!s},i._handlerTick=function(t){i.status===Qs.RUNNING&&(i.tickCounts++,i.timelines.forEach((function(e){e.tick(t)})),i.emit("tick",t))},i.init(),i.lastFrameTime=-1,i.tickCounts=0,i.stage=t,i.autoStop=!0,i.interval=16,i.computeTimeOffsetAndJitter(),i}return h(e,t),o(e,[{key:"bindStage",value:function(t){this.stage=t}},{key:"computeTimeOffsetAndJitter",value:function(){this.timeOffset=Math.floor(Math.random()*this.interval),this._jitter=Math.min(Math.max(.2*this.interval,6),.7*this.interval)}},{key:"init",value:function(){var t=this;this.interval=16,this.status=Qs.INITIAL,al.global.hooks.onSetEnv.tap("graph-ticker",(function(){t.initHandler(!1)})),al.global.env&&this.initHandler(!1)}},{key:"addTimeline",value:function(t){this.timelines.push(t)}},{key:"remTimeline",value:function(t){this.timelines=this.timelines.filter((function(e){return e!==t}))}},{key:"getTimelines",value:function(){return this.timelines}},{key:"initHandler",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.setupTickHandler(t)}},{key:"setupTickHandler",value:function(){if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.tickerHandler)return!0;var t=new kP;return this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=t,!0}},{key:"setInterval",value:function(t){this.interval=t,this.computeTimeOffsetAndJitter()}},{key:"getInterval",value:function(){return this.interval}},{key:"setFPS",value:function(t){this.setInterval(Math.floor(1e3/t))}},{key:"getFPS",value:function(){return 1e3/this.interval}},{key:"tick",value:function(t){var e=this;this.tickerHandler.tick(t,(function(t){return e.handleTick(t,{once:!0})}))}},{key:"tickTo",value:function(t){var e=this;this.tickerHandler.tickTo&&this.tickerHandler.tickTo(t,(function(t){e.handleTick(t,{once:!0})}))}},{key:"pause",value:function(){return this.status!==Qs.INITIAL&&(this.status=Qs.PAUSE,!0)}},{key:"resume",value:function(){return this.status!==Qs.INITIAL&&(this.status=Qs.RUNNING,!0)}},{key:"ifCanStop",value:function(){if(this.autoStop){if(!this.timelines.length)return!0;if(this.timelines.every((function(t){return!t.isRunning()})))return!0}return!1}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.status===Qs.RUNNING)return!1;if(!this.tickerHandler)return!1;if(!t){if(this.status===Qs.PAUSE)return!1;if(this.ifCanStop())return!1}return this.status=Qs.RUNNING,this.tickerHandler.tick(0,this.handleTick),!0}},{key:"stop",value:function(){this.status=Qs.INITIAL,this.setupTickHandler(!0),this.lastFrameTime=-1}},{key:"trySyncTickStatus",value:function(){this.status===Qs.INITIAL&&this.timelines.some((function(t){return t.isRunning()}))?this.start():this.status===Qs.RUNNING&&this.timelines.every((function(t){return!t.isRunning()}))&&this.stop()}},{key:"release",value:function(){var t;this.stop(),this.timelines=[],null===(t=this.tickerHandler)||void 0===t||t.release(),this.tickerHandler=null,this.lastFrameTime=-1}},{key:"checkSkip",value:function(t){var e,i,n;return"performance"!==(null===(n=null===(i=null===(e=this.stage)||void 0===e?void 0:e.params)||void 0===i?void 0:i.optimize)||void 0===n?void 0:n.tickRenderMode)&&t<this.interval+2*(Math.random()-.5)*this._jitter}}])}(z),AP=function(){return o((function t(){r(this,t),this.released=!1,this.currentTime=-1}),[{key:"tick",value:function(t,e){this.currentTime<0&&(this.currentTime=0),this.currentTime+=t,e(this)}},{key:"release",value:function(){this.released=!0}},{key:"getTime",value:function(){return this.currentTime}},{key:"tickTo",value:function(t,e){this.currentTime<0&&(this.currentTime=0);var i=t-this.currentTime;this.tick(i,e)}}])}(),MP=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).lastFrameTime=0,i.status=Qs.RUNNING,i}return h(e,t),o(e,[{key:"setupTickHandler",value:function(){var t=new AP;return this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=t,!0}},{key:"checkSkip",value:function(t){return!1}},{key:"getTime",value:function(){return this.tickerHandler.getTime()}},{key:"tickAt",value:function(t){this.tickTo(t)}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.status===Qs.RUNNING)return!1;if(!this.tickerHandler)return!1;if(!t){if(this.status===Qs.PAUSE)return!1;if(this.ifCanStop())return!1}return this.status=Qs.RUNNING,!0}}])}(SP),TP=function(){function t(){r(this,t),this.transitions=new Map,this.registerDefaultTransitions()}return o(t,[{key:"registerDefaultTransitions",value:function(){this.registerTransition("appear","*",(function(){return{allowTransition:!0,stopOriginalTransition:!1}})),this.registerTransition("appear","appear",(function(){return{allowTransition:!1,stopOriginalTransition:!1}})),this.registerTransition("appear","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("appear","exit",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("normal","*",(function(){return{allowTransition:!0,stopOriginalTransition:!1}})),this.registerTransition("normal","normal",(function(){return{allowTransition:!1,stopOriginalTransition:!1}})),this.registerTransition("normal","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("normal","exit",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("exit","*",(function(){return{allowTransition:!1,stopOriginalTransition:!1}})),this.registerTransition("exit","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("exit","enter",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("exit","exit",(function(){return{allowTransition:!1,stopOriginalTransition:!1}})),this.registerTransition("enter","*",(function(){return{allowTransition:!0,stopOriginalTransition:!1}})),this.registerTransition("enter","enter",(function(){return{allowTransition:!1,stopOriginalTransition:!1}})),this.registerTransition("enter","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("enter","exit",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("disappear","*",(function(){return{allowTransition:!1,stopOriginalTransition:!1}})),this.registerTransition("disappear","appear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("update","*",(function(){return{allowTransition:!0,stopOriginalTransition:!1}})),this.registerTransition("update","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("update","exit",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("state","*",(function(){return{allowTransition:!0,stopOriginalTransition:!1}})),this.registerTransition("state","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),this.registerTransition("state","exit",(function(){return{allowTransition:!0,stopOriginalTransition:!0}}))}},{key:"isTransitionAllowed",value:function(t,e,i){var n,r,a,o,s=null===(n=this.transitions.get(t))||void 0===n?void 0:n.get(e);return s?s(i,t):(s=null===(r=this.transitions.get(t))||void 0===r?void 0:r.get("*"))?s(i,t):(s=null===(a=this.transitions.get("*"))||void 0===a?void 0:a.get(e))?s(i,t):(s=null===(o=this.transitions.get("*"))||void 0===o?void 0:o.get("*"))?s(i,t):{allowTransition:!0,stopOriginalTransition:!0}}},{key:"registerTransition",value:function(t,e,i){var n=this.transitions.get(t);n||(n=new Map,this.transitions.set(t,n)),n.set(e,i)}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}])}();TP.getInstance();var wP=function(){function t(e){r(this,t),this._animates=[],this._startCallbacks=[],this._endCallbacks=[],this._started=!1,this._activeCount=0,this._target=e}return o(t,[{key:"started",get:function(){return this._started}},{key:"onStart",value:function(t){t?(this._startCallbacks.push(t),this._started&&this._activeCount>0&&t()):this._startCallbacks.forEach((function(t){t()}))}},{key:"onEnd",value:function(t){t?this._endCallbacks.push(t):this._endCallbacks.forEach((function(t){t()}))}},{key:"_trackAnimation",value:function(t){var e=this;this._animates.push(t),this._activeCount++,1!==this._activeCount||this._started||(this._started=!0,this.onStart()),t.onEnd((function(){e._activeCount--;var i=e._animates.indexOf(t);i>=0&&e._animates.splice(i,1),0===e._activeCount&&e._started&&(e._started=!1,e.onEnd())}))}},{key:"parseParams",value:function(e,i,n){var r,a,o=this,s=this.resolveValue(e.totalTime,void 0,void 0),l=this.resolveValue(e.startTime,void 0,0),u=Object.assign({},e);u.oneByOneDelay=0,u.startTime=l,u.totalTime=s;var c=this.resolveValue(e.oneByOne,n,!1);if(i){var h=u.timeSlices;q(h)||(u.timeSlices=[h]);var d=0;u.timeSlices=u.timeSlices.map((function(t){var e=o.resolveValue(t.delay,n,0),i=o.resolveValue(t.delayAfter,n,0),r=o.resolveValue(t.duration,n,300);return d+=e+r+i,Object.assign(Object.assign({},t),{delay:e,delayAfter:i,duration:r})}));var p=0;c&&(p="number"==typeof c?c:c?d:0),u.oneByOneDelay=p;var f=1;if(s){var v=d+p*(this._target.count-2);f=s?s/v:1}u.timeSlices=u.timeSlices.map((function(e){var i=e.effects;return Array.isArray(i)||(i=[i]),Object.assign(Object.assign({},e),{delay:e.delay*f,delayAfter:e.delayAfter*f,duration:e.duration*f,effects:i.map((function(e){var i,n,r=null!==(i=e.custom)&&void 0!==i?i:t.builtInAnimateMap[null!==(n=e.type)&&void 0!==n?n:"fromTo"],a=r&&V(r)?/^class\s/.test(Function.prototype.toString.call(r))?1:2:0;return Object.assign(Object.assign({},e),{custom:r,customType:a})}))})})),u.oneByOneDelay=p*f,u.startTime=l*f}else{var g=this.resolveValue(e.delay,n,0),y=this.resolveValue(e.delayAfter,n,0),m=this.resolveValue(e.duration,n,300),_=0;c&&(_="number"==typeof c?c:c?g+y+m:0),u.oneByOneDelay=_,u.custom=null!==(r=e.custom)&&void 0!==r?r:t.builtInAnimateMap[null!==(a=e.type)&&void 0!==a?a:"fromTo"];var b=u.custom&&V(u.custom)?/^class\s/.test(Function.prototype.toString.call(u.custom))?1:2:0;if(u.customType=b,s){var x=g+y+m+_*(this._target.count-2),k=s?s/x:1;u.delay=g*k,u.delayAfter=y*k,u.duration=m*k,u.oneByOneDelay=_*k,u.startTime=l}}return u}},{key:"execute",value:function(t){var e=this;Array.isArray(t)?t.forEach((function(t){return e._execute(t)})):this._execute(t)}},{key:"_execute",value:function(t){var e=this;if(t.selfOnly)return this._executeItem(t,this._target,0,1);var i,n="timeSlices"in t;n&&t.partitioner&&(i=(null!=i?i:this._target.getChildren()).filter((function(e){var i,n;return t.partitioner(null===(n=null===(i=e.context)||void 0===i?void 0:i.data)||void 0===n?void 0:n[0],e,{})}))),n&&t.sort&&(i=null!=i?i:this._target.getChildren()).sort((function(e,i){var n,r,a,o;return t.sort(null===(r=null===(n=e.context)||void 0===n?void 0:n.data)||void 0===r?void 0:r[0],null===(o=null===(a=i.context)||void 0===a?void 0:a.data)||void 0===o?void 0:o[0],e,i,{})}));var r=n?function(i,r,a){var o=e.parseParams(t,n,i),s=e.executeTimelineItem(o,i,r,a);s&&e._trackAnimation(s)}:function(i,r,a){var o=e.parseParams(t,n,i),s=e.executeTypeConfigItem(o,i,r,a);s&&e._trackAnimation(s)};i?i.forEach((function(t,e){return r(t,e,i.length)})):this._target.count<=1?r(this._target,0,1):this._target.forEachChildren((function(t,i){return r(t,i,e._target.count-1)}))}},{key:"executeTypeConfigItem",value:function(t,e,i,n){var r,a,o,s,l,u,c,h,d=t.type,p=void 0===d?"fromTo":d,f=t.channel,v=t.customParameters,g=t.easing,y=void 0===g?"linear":g,m=t.delay,_=void 0===m?0:m,b=t.delayAfter,x=void 0===b?0:b,k=t.duration,S=void 0===k?300:k,A=t.startTime,M=void 0===A?0:A,T=t.oneByOneDelay,w=void 0===T?0:T,C=t.loop,E=t.bounce,P=t.priority,B=void 0===P?0:P,R=t.options,L=t.custom,I=t.customType,D=t.controlOptions,O=e.animate();O.priority=B;var F=V(_)?_(null===(a=null===(r=e.context)||void 0===r?void 0:r.data)||void 0===a?void 0:a[0],e,{}):_,z=null===(s=null===(o=e.context)||void 0===o?void 0:o.data)||void 0===s?void 0:s[0],H=null===(l=e.context)||void 0===l?void 0:l.indexKey;z&&H&&(i=null!==(u=z[H])&&void 0!==u?u:i),O.startAt(M);var N=i*w+F;N>0&&O.wait(N);var j=null,U=t.to,W=t.from;U||(j||(j=this.createPropsFromChannel(f,e)),U=j.props),W||(j||(j=this.createPropsFromChannel(f,e)),W=j.from),this._handleRunAnimate(O,L,I,W,U,S,y,v,D,R,p,e);var G=0;w&&(G=w*(n-i-1));var Y=V(x)?x(null===(h=null===(c=e.context)||void 0===c?void 0:c.data)||void 0===h?void 0:h[0],e,{}):x;return Y>0&&(G+=Y),G>0&&O.wait(G),C&&C>0&&O.loop(C),E&&O.bounce(!0),O}},{key:"_handleRunAnimate",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d,p,f,v,g,y;if(e&&i){var m=Object.assign({width:(null===(d=h.stage)||void 0===d?void 0:d.width)||0,height:(null===(p=h.stage)||void 0===p?void 0:p.height)||0,group:this._target.parent},this.resolveValue(s,h)),_=V(u)?u.call(null,null!==(v=m&&(null===(f=m.data)||void 0===f?void 0:f[0]))&&void 0!==v?v:null===(y=null===(g=h.context)||void 0===g?void 0:g.data)||void 0===y?void 0:y[0],h,m):u;m.options=_,m.controlOptions=l,1===i?this.createCustomAnimation(t,e,n,r,a,o,m):2===i&&this.createCustomInterpolatorAnimation(t,e,r,a,o,m)}else"to"===c?t.to(r,a,o):"from"===c&&t.from(r,a,o)}},{key:"executeTimelineItem",value:function(t,e,i,n){var r,a,o,s,l=this,u=t.timeSlices,c=t.startTime,h=void 0===c?0:c,d=t.loop,p=t.bounce,f=t.oneByOneDelay,v=t.priority,g=t.controlOptions,y=null===(a=null===(r=e.context)||void 0===r?void 0:r.data)||void 0===a?void 0:a[0],m=null===(o=e.context)||void 0===o?void 0:o.indexKey;y&&m&&(i=null!==(s=y[m])&&void 0!==s?s:i);var _=e.animate();return _.priority=v,_.startAt(h),_.wait(i*f),d&&d>0&&_.loop(d),p&&_.bounce(!0),(Array.isArray(u)?u:[u]).forEach((function(t){l.applyTimeSliceToAnimate(t,_,e,g)})),f&&_.wait(f*(n-i-1)),_}},{key:"applyTimeSliceToAnimate",value:function(e,i,n,r){var a,o,s,l,u=this,c=e.effects,h=e.duration,d=void 0===h?300:h,p=e.delay,f=void 0===p?0:p,v=e.delayAfter,g=void 0===v?0:v,y=V(f)?f(null===(o=null===(a=n.context)||void 0===a?void 0:a.data)||void 0===o?void 0:o[0],n,{}):f,m=V(g)?g(null===(l=null===(s=n.context)||void 0===s?void 0:s.data)||void 0===l?void 0:l[0],n,{}):g;y>0&&i.wait(y),(Array.isArray(c)?c:[c]).forEach((function(e){var a,o=e.type,s=void 0===o?"fromTo":o,l=e.channel,c=e.customParameters,h=e.easing,p=void 0===h?"linear":h,f=e.options,v=null,g=e.to,y=e.from;g||(v||(v=u.createPropsFromChannel(l,n)),g=v.props),y||(v||(v=u.createPropsFromChannel(l,n)),y=v.from);var m=null!==(a=e.custom)&&void 0!==a?a:t.builtInAnimateMap[s],_=e.customType;u._handleRunAnimate(i,m,_,y,g,d,p,c,r,f,s,n)})),m>0&&i.wait(m)}},{key:"createCustomInterpolatorAnimation",value:function(t,e,i,n,r,a){var o=i;Object.keys(o).forEach((function(e){t.target.getComputedAttribute(e)})),t.interpolateUpdateFunction=function(i,n,r,o,s){e(r,i,n,o,s,t.target,a)},t.to(i,n,r)}},{key:"createCustomAnimation",value:function(t,e,i,n,r,a,o){var s=new e(i,n,r,a,o);t.play(s)}},{key:"createPropsFromChannel",value:function(t,e){var i={},n=null;return t?(Array.isArray(t)?t.forEach((function(t){var n,r,a=null===(r=null===(n=e.context)||void 0===n?void 0:n.diffAttrs)||void 0===r?void 0:r[t];void 0!==a&&(i[t]=a)})):Object.keys(t).forEach((function(r){var a,o,s,l,u=t[r];void 0!==u.to&&("function"==typeof u.to?i[r]=u.to(null===(o=null===(a=e.context)||void 0===a?void 0:a.data)||void 0===o?void 0:o[0],e,{}):i[r]=u.to),void 0!==u.from&&(n||(n={}),"function"==typeof u.from?n[r]=u.from(null===(l=null===(s=e.context)||void 0===s?void 0:s.data)||void 0===l?void 0:l[0],e,{}):n[r]=u.from)})),{from:n,props:i}):{from:n,props:i}}},{key:"resolveValue",value:function(t,e,i){var n,r;return void 0===t?i:"function"==typeof t&&e?t(null===(r=null===(n=e.context)||void 0===n?void 0:n.data)||void 0===r?void 0:r[0],e,{}):t}},{key:"executeItem",value:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Array.isArray(t)?t.map((function(t){return i._executeItem(t,e,n,r)})).filter(Boolean):[this._executeItem(t,e,n,r)].filter(Boolean)}},{key:"_executeItem",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!e)return null;var r,a="timeSlices"in t,o=this.parseParams(t,a);return(r=a?this.executeTimelineItem(o,e,i,n):this.executeTypeConfigItem(o,e,i,n))&&this._trackAnimation(r),r}},{key:"stop",value:function(t){for(;this._animates.length>0;){var e=this._animates.pop();null==e||e.stop(t)}this._animates=[],this._activeCount=0,this._started&&(this._started=!1,this.onEnd())}}],[{key:"registerBuiltInAnimate",value:function(e,i){t.builtInAnimateMap[e]=i}}])}();wP.builtInAnimateMap={};var CP="appear",EP="disappear",PP="update",BP="highlight",RP="unhighlight",LP=function(){return o((function t(e){r(this,t),this.graphic=e}),[{key:"registerState",value:function(t){this.states||(this.states=new Map),this.states.set(t.name,t)}},{key:"clearStates",value:function(){var t;null===(t=this.states)||void 0===t||t.clear()}}])}(),IP=function(){return o((function t(e){r(this,t),this.stateList=null,this.graphic=e}),[{key:"applyState",value:function(t,e,i){var n,r=this,a=TP.getInstance(),o=[],s=[];if(this.stateList&&this.stateList.length?t.forEach((function(t,i){var n={allowTransition:!0,stopOriginalTransition:!0};r.stateList.forEach((function(e){var i=a.isTransitionAllowed(e.state,t,r.graphic);n.allowTransition=n.allowTransition&&i.allowTransition})),n.allowTransition&&(s.push({state:t,animationConfig:q(e[i])?e[i].map((function(t){return t.animation})):e[i].animation,executor:new wP(r.graphic)}),r.stateList.forEach((function(e){a.isTransitionAllowed(e.state,t,r.graphic).stopOriginalTransition&&o.push(e)})))})):t.forEach((function(t,i){s.push({state:t,animationConfig:q(e[i])?e[i].map((function(t){return t.animation})):e[i].animation,executor:new wP(r.graphic)})})),o.forEach((function(t){t.executor.stop()})),s.length){s[0].executor.execute(s[0].animationConfig);for(var l=function(t){var e=s[t+1],n=s[t];n.executor.onEnd((function(){e&&e.executor.execute(e.animationConfig),r.stateList=r.stateList.filter((function(t){return t!==n})),t===s.length-1&&i&&i(!1)}))},u=0;u<s.length;u++)l(u)}else i&&i(!0);this.stateList?this.stateList=this.stateList.filter((function(t){return!o.includes(t)})):this.stateList=[],(n=this.stateList).push.apply(n,s)}},{key:"applyAppearState",value:function(t,e){this.applyState([CP],[{name:CP,animation:t}],e)}},{key:"applyDisappearState",value:function(t,e){this.applyState([EP],[{name:EP,animation:t}],e)}},{key:"applyUpdateState",value:function(t,e){this.applyState([PP],[{name:PP,animation:t}],e)}},{key:"applyHighlightState",value:function(t,e){this.applyState([BP],[{name:BP,animation:t}],e)}},{key:"applyUnhighlightState",value:function(t,e){this.applyState([RP],[{name:RP,animation:t}],e)}},{key:"stopState",value:function(t,e){var i,n=null===(i=this.stateList)||void 0===i?void 0:i.find((function(e){return e.state===t}));n&&n.executor.stop(e)}},{key:"clearState",value:function(){var t;null===(t=this.stateList)||void 0===t||t.forEach((function(t){t.executor.stop()})),this.stateList=null}},{key:"reApplyState",value:function(t){var e,i=null===(e=this.stateList)||void 0===e?void 0:e.find((function(e){return e.state===t}));if(i&&i.executor.started){var n=this.stateList.slice();i.executor.stop(),this.stateList=n,i.executor.execute(i.animationConfig)}}}])}(),DP=function(){function t(){r(this,t)}return o(t,[{key:"_getAnimationStateManager",value:function(t){return t._animationStateManager||(t._animationStateManager=new IP(t)),t._animationStateManager}},{key:"_getAnimationStateStore",value:function(t){return t._animationStateStore||(t._animationStateStore=new LP(t)),t._animationStateStore}},{key:"registerAnimationState",value:function(t){return this._getAnimationStateStore(this).registerState(t),this}},{key:"applyAnimationState",value:function(t,e,i){return this._getAnimationStateManager(this).applyState(t,e,i),this}},{key:"applyAppearState",value:function(t,e){return this._getAnimationStateManager(this).applyAppearState(t,e),this}},{key:"applyDisappearState",value:function(t,e){return this._getAnimationStateManager(this).applyDisappearState(t,e),this}},{key:"applyUpdateState",value:function(t,e){return this._getAnimationStateManager(this).applyUpdateState(t,e),this}},{key:"applyHighlightState",value:function(t,e){return this._getAnimationStateManager(this).applyHighlightState(t,e),this}},{key:"applyUnhighlightState",value:function(t,e){return this._getAnimationStateManager(this).applyUnhighlightState(t,e),this}},{key:"stopAnimationState",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this._getAnimationStateManager(this).stopState(t,e),i&&this.isContainer&&this.forEachChildren((function(n){n.stopAnimationState(t,e,i)})),this}},{key:"clearAnimationStates",value:function(){var t=this._animationStateManager;return t&&t.clearState(),this}},{key:"reApplyAnimationState",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this._animationStateManager;return i&&i.reApplyState(t),e&&this.isContainer&&this.forEachChildren((function(i){i.reApplyAnimationState(t,e)})),this}}],[{key:"extend",value:function(e){return(new t)._getAnimationStateManager(e),e}}])}(),OP=function(){return o((function t(){r(this,t)}),[{key:"getAttributes",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.finalAttribute?this.finalAttribute:this.attribute}},{key:"animate",value:function(t){var e,i,n,r=new bP(null==t?void 0:t.id,null!==(i=null!==(e=null==t?void 0:t.timeline)&&void 0!==e?e:this.stage&&this.stage.getTimeline())&&void 0!==i?i:_P,null==t?void 0:t.slience);if(r.bind(this),t){var a=t.onStart,o=t.onEnd,s=t.onRemove;null!=a&&r.onStart(a),null!=o&&r.onEnd(o),null!=s&&r.onRemove(s)}return null===(n=this.stage)||void 0===n||n.ticker.start(),r}},{key:"createTimeline",value:function(){return new mP}},{key:"createTicker",value:function(t){return new SP(t)}},{key:"setFinalAttributes",value:function(t){this.finalAttribute||(this.finalAttribute={}),Object.assign(this.finalAttribute,t)}},{key:"initFinalAttributes",value:function(t){this.finalAttribute=t}},{key:"initAnimateExecutor",value:function(){this._animateExecutor||(this._animateExecutor=new wP(this))}},{key:"executeAnimation",value:function(t){return this.initAnimateExecutor(),this._animateExecutor.execute(t),this}},{key:"executeAnimations",value:function(t){var e=this;return this.initAnimateExecutor(),t.forEach((function(t){e._animateExecutor.execute(t)})),this}},{key:"getFinalAttribute",value:function(){return this.finalAttribute}},{key:"getGraphicAttribute",value:function(t){return!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&this.finalAttribute?this.finalAttribute[t]:this.attribute[t]}},{key:"pauseAnimation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.animates&&this.animates.forEach((function(t){return t.pause()})),t&&this.isContainer&&this.forEachChildren((function(e){e.pauseAnimation(t)}))}},{key:"resumeAnimation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.animates&&this.animates.forEach((function(t){return t.resume()})),t&&this.isContainer&&this.forEachChildren((function(e){e.resumeAnimation(t)}))}},{key:"stopAnimation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.animates&&this.animates.forEach((function(t){return t.stop()})),t&&this.isContainer&&this.forEachChildren((function(e){e.stopAnimation(t)}))}}])}();function FP(){kt(Hf,DP),kt(Hf,OP)}var zP=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,["customAnimate",i,a,o])).type="customAnimate",l.customFrom=t,l.params=s,l.from=t,l.to=i,l}return h(e,t),o(e,[{key:"update",value:function(t,e,i){if(this.onStart(),this.props&&this.propKeys){var n=this.easing(e);this.onUpdate(t,n,i),this.syncAttributeUpdate()}}},{key:"setProps",value:function(t){this.props=t,this.propKeys=Object.keys(t),this.animate.reSyncProps()}}])}(gP),HP=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"completeBind",value:function(t){this.setStartTime(0),this._animator&&this._animator.start(),this.setDuration(t.getDuration())}},{key:"stop",value:function(){this._animator&&this._animator.stop()}}])}(zP),NP=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).willCallBeforeStageRender=!0,l.willCallAfterStageRender=!0,l._beforeStageRender=function(){if(l.willCallBeforeStageRender){l.willCallBeforeStageRender=!1;var t=l.target.stage,e=t.window.getContext().canvas.nativeCanvas,i=l.beforeStageRender(t,e);i&&l.renderToStage(t,i)}},l._afterStageRender=function(){if(l.willCallAfterStageRender){l.willCallAfterStageRender=!1;var t=l.target.stage,e=t.window.getContext().canvas.nativeCanvas,i=l.afterStageRender(t,e);i&&l.renderToStage(t,i)}},l.props={},l}return h(e,t),o(e,[{key:"beforeStageRender",value:function(t,e){return!1}},{key:"afterStageRender",value:function(t,e){return!1}},{key:"onFirstRun",value:function(){_(e,"onFirstRun",this,3)([]),this.target.stage.setBeforeRender(this._beforeStageRender),this.target.stage.setAfterRender(this._afterStageRender),this.target.stage.disableDirtyBounds()}},{key:"stop",value:function(){_(e,"stop",this,3)([]),this.target.stage.removeBeforeRender(this._beforeStageRender),this.target.stage.removeAfterRender(this._afterStageRender)}},{key:"onUpdate",value:function(t,i,n){_(e,"onUpdate",this,3)([t,i,n]),this.willCallBeforeStageRender=!0,this.willCallAfterStageRender=!0}},{key:"renderToStage",value:function(t,e){var i=t.window.getContext().canvas.nativeCanvas,n=i.getContext("2d");return!!n&&(n.clearRect(0,0,i.width,i.height),n.drawImage(e,0,0),i)}}])}(zP),VP=function(){return o((function t(e){r(this,t),this.tasks=[],this.started=!1,this.completed=0,this.totalDuration=0,this.onStartCallbacks=[],this.onEndCallbacks=[],this.onUpdateCallbacks=[],this.component=e}),[{key:"animate",value:function(t,e){return this.started?(console.warn("Cannot add animations after animation has started"),this):(this.tasks.push({graphic:t,config:e}),this)}},{key:"onStart",value:function(t){return this.onStartCallbacks.push(t),this}},{key:"onEnd",value:function(t){return this.onEndCallbacks.push(t),this}},{key:"onUpdate",value:function(t){return this.onUpdateCallbacks.push(t),this}},{key:"start",value:function(){var t=this;return this.started?(console.warn("Animation has already started"),this):(this.started=!0,this.completed=0,this.onStartCallbacks.forEach((function(t){return t()})),0===this.tasks.length?(setTimeout((function(){t.onEndCallbacks.forEach((function(t){return t()}))}),0),this):(this.tasks.forEach((function(e){var i=new wP(e.graphic);i.onEnd((function(){t.completed++,t.completed===t.tasks.length&&t.onEndCallbacks.forEach((function(t){return t()}))}));var n=i.executeItem(e.config,e.graphic);e.animate=n,n.forEach((function(e){t.totalDuration=Math.max(t.totalDuration,e.getStartTime()+e.getDuration())}))})),this))}},{key:"deleteSelfAttr",value:function(t){this.tasks.forEach((function(e){e.animate&&e.animate.forEach((function(e){return e.preventAttr(t)}))}))}},{key:"stop",value:function(t){return this.tasks.forEach((function(e){e.animate&&e.animate.forEach((function(e){return e.stop(t)}))})),this.started&&this.completed!==this.tasks.length&&(this.onEndCallbacks.forEach((function(t){return t()})),this.completed=this.tasks.length),this}},{key:"getDuration",value:function(){return this.totalDuration}}])}();function jP(t){return new VP(t)}var UP=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).formatTemplate=null,l.decimalLength=null==s?void 0:s.decimalLength,(null==s?void 0:s.formatTemplate)&&s.formatTemplate.includes("{{var}}")&&(l.formatTemplate=s.formatTemplate),l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i,n=this.getLastProps(),r=this.getEndProps(),a=null!==(t=n.text)&&void 0!==t?t:0,o=null!==(e=r.text)&&void 0!==e?e:0;this.valid=!0;var s=0,l=0,u="",c="",h=0;if("number"==typeof a){s=a;var d=a.toString().split(".")[1]||"";h=Math.max(h,d.length)}else{if("string"!=typeof a)return void(this.valid=!1);if(a.endsWith("%")){u="%";var p=a.substring(0,a.length-1).replace(/,/g,"");if(s=parseFloat(p)/100,isNaN(s))return void(this.valid=!1);var f=p.split(".")[1]||"";h=Math.max(h,f.length+2)}else{var v=a.replace(/,/g,"");if(s=parseFloat(v),isNaN(s))return void(this.valid=!1);a.includes(",")&&(u=",");var g=v.split(".")[1]||"";h=Math.max(h,g.length)}}if("number"==typeof o){l=o;var y=o.toString().split(".")[1]||"";h=Math.max(h,y.length)}else{if("string"!=typeof o)return void(this.valid=!1);if(o.endsWith("%")){c="%";var m=o.substring(0,o.length-1).replace(/,/g,"");if(l=parseFloat(m)/100,isNaN(l))return void(this.valid=!1);var _=m.split(".")[1]||"";h=Math.max(h,_.length+2)}else{var b=o.replace(/,/g,"");if(l=parseFloat(b),isNaN(l))return void(this.valid=!1);o.includes(",")&&(c=",");var x=b.split(".")[1]||"";h=Math.max(h,x.length)}}if(null===(i=this.params)||void 0===i?void 0:i.format){switch(this.params.format){case"percent":this.format="%";break;case"thousandth":this.format=",";break;case"none":this.format="";break;default:this.format=c||u}"%"===this.format&&"%"!==c&&"%"!==u&&void 0===this.decimalLength&&(this.decimalLength=2),"%"===this.format||"%"!==c&&"%"!==u||(s*=100,l*=100)}else this.format=c||u;this.fromNumber=s,this.toNumber=l,void 0===this.decimalLength&&(this.decimalLength=h)}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t]),t||this.props&&this.target.setAttributes(this.props)}},{key:"onUpdate",value:function(t,e,i){if(this.valid){var n,r,a=this.fromNumber+(this.toNumber-this.fromNumber)*e,o=this.format,s=("%"===o?100*a:a).toFixed(this.decimalLength),l=s;if(parseFloat(s)===Math.floor(parseFloat(s))&&(l=Math.floor(parseFloat(s))),"%"===o)r="".concat(l,"%");else if(","===o){var u=l.toString().split(".");u[0]=u[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),r=u.join(".")}else r=l;n=this.formatTemplate?this.formatTemplate.replace("{{var}}",r.toString()):r,this.target.setAttribute("text",n)}}}])}(zP),WP=1e3,GP="quadInOut",YP=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","scrollX","scrollY"],XP=function(t,e,i){t.forEach((function(t){if(Number.isFinite(t.to))e[t.key]=t.from+(t.to-t.from)*i;else if("fill"===t.key||"stroke"===t.key){var n=xf(t.from,t.to,i,!1);n&&(e[t.key]=n)}}))},KP=function(t,e,i){var n=[],r=[];e.clear();for(var a=0;a<t.length;a++){var o=t[a],s=o.from,l=o.to,u=o.rotation*i,c=o.fromCp,h=o.toCp,d=Math.sin(u),p=Math.cos(u);r[0]=c[0]+(h[0]-c[0])*i,r[1]=c[1]+(h[1]-c[1])*i;for(var f=0;f<s.length;f+=2){var v=s[f],g=s[f+1],y=v*(1-i)+l[f]*i,m=g*(1-i)+l[f+1]*i;n[f]=y*p-m*d+r[0],n[f+1]=y*d+m*p+r[1]}var _=n[0],b=n[1];e.moveTo(_,b);for(var x=2;x<s.length;x+=6){var k=n[x],S=n[x+1],A=n[x+2],M=n[x+3],T=n[x+4],w=n[x+5];_===k&&b===S&&A===T&&M===w?e.lineTo(T,w):e.bezierCurveTo(k,S,A,M,T,w),_=T,b=w}}},qP=function(t,e,i){var n=t?bb(t):[],r=bb(e);i&&n&&(i.fromTransform&&xb(n,i.fromTransform.clone().getInverse()),xb(n,i.toTransfrom));var a=function(t,e){for(var i,n,r=[],a=[],o=0;o<Math.max(t.length,e.length);o++){var s,l=t[o],u=e[o],c=void 0,h=void 0;l?u?(i=c=(s=m(vb(l,u),2))[0],n=h=s[1]):(h=gb(n,l),c=l):(c=gb(i,u),h=u),r.push(c),a.push(h)}return[r,a]}(n,r),o=m(a,2),s=o[0],l=o[1];return t?function(t,e,i,n){for(var r,a=[],o=0;o<t.length;o++){var s=t[o],l=e[o],u=mb(s),c=mb(l);null==r&&(r=u[2]<0!=c[2]<0);var h=[],d=[],p=0,f=1/0,v=[],g=s.length;r&&(s=yb(s));for(var y=6*_b(s,l,u,c),m=g-2,_=0;_<m;_+=2){var b=(y+_)%m+2;h[_+2]=s[b]-u[0],h[_+3]=s[b+1]-u[1]}if(h[0]=s[y]-u[0],h[1]=s[y+1]-u[1],i>0)for(var x=n/i,k=-n/2;k<=n/2;k+=x){for(var S=Math.sin(k),A=Math.cos(k),M=0,T=0;T<s.length;T+=2){var w=h[T],C=h[T+1],E=l[T]-c[0],P=l[T+1]-c[1],B=E*A-P*S,R=E*S+P*A;v[T]=B,v[T+1]=R;var L=B-w,I=R-C;M+=L*L+I*I}if(M<f){f=M,p=k;for(var D=0;D<v.length;D++)d[D]=v[D]}}else for(var O=0;O<g;O+=2)d[O]=l[O]-c[0],d[O+1]=l[O+1]-c[1];a.push({from:h,to:d,fromCp:u,toCp:c,rotation:-p})}return a}(s,l,10,Math.PI):l.map((function(t,e){return{from:s[e],to:t,fromCp:[0,0],toCp:[0,0],rotation:0}}))},ZP=["fill","fillOpacity","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","lineDashOffset"],JP=function(t,e){if(!t||!e)return null;var i=[],n=!1;return Object.keys(t).forEach((function(r){if(ZP.includes(r)){var a=e[r];if(!j(a)&&!j(t[r])&&a!==t[r]){if("fill"===r||"stroke"===r){var o=function(t){return"string"==typeof t?_f.Get(t,ff.Color255):t};i.push({from:q(t[r])?t[r].map(o):o(t[r]),to:q(a)?a.map(o):o(a),key:r})}else i.push({from:t[r],to:a,key:r});n=!0}}})),n?i:null},QP=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e,[{},{},i,a])).morphingData=t.morphingData,o.otherAttrs=t.otherAttrs,o.saveOnEnd=t.saveOnEnd,o}return h(e,t),o(e,[{key:"getEndProps",value:function(){return{}}},{key:"onBind",value:function(){this.target.createPathProxy(),this.onUpdate(!1,0,this.target.attribute)}},{key:"onEnd",value:function(){}},{key:"onUpdate",value:function(t,e,i){var n=this.target,r="function"==typeof n.pathProxy?n.pathProxy(n.attribute):n.pathProxy;KP(this.morphingData,r,e),this.otherAttrs&&this.otherAttrs.length&&XP(this.otherAttrs,i,e),this.target.setAttributes(i),t&&!this.saveOnEnd&&(this.target.pathProxy=null)}}])}(zP),$P=function(t,e,i,n){var r,a,o;if(t&&(!t.valid||!t.toCustomPath))return __DEV__&&console.error(t," is not validate"),null;if(!e.valid||!e.toCustomPath)return __DEV__&&console.error(e," is not validate"),null;var s=null==t?void 0:t.globalTransMatrix;n&&s&&(s=n.clone().multiply(s.a,s.b,s.c,s.d,s.e,s.f));var l=qP(null===(r=null==t?void 0:t.toCustomPath)||void 0===r?void 0:r.call(t),e.toCustomPath(),{fromTransform:s,toTransfrom:e.globalTransMatrix}),u=JP(null==t?void 0:t.attribute,e.attribute),c=e.animate(i);(null==i?void 0:i.delay)&&c.wait(i.delay);var h=new QP({morphingData:l,otherAttrs:u},null!==(a=null==i?void 0:i.duration)&&void 0!==a?a:WP,null!==(o=null==i?void 0:i.easing)&&void 0!==o?o:GP);return c.play(h),c},tB=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e,[{},{},i,a])).morphingData=t.morphingData,o.otherAttrs=t.otherAttrs,o}return h(e,t),o(e,[{key:"getEndProps",value:function(){return{}}},{key:"onBind",value:function(){this.addPathProxy()}},{key:"addPathProxy",value:function(){this.target.shadowRoot.forEachChildren((function(t){t.createPathProxy()})),this.onUpdate(!1,0,this.target.attribute)}},{key:"clearPathProxy",value:function(){this.target.shadowRoot.forEachChildren((function(t){t.pathProxy=null}))}},{key:"onEnd",value:function(){}},{key:"onUpdate",value:function(t,e,i){var n=this;this.target.shadowRoot.forEachChildren((function(t,i){var r;KP(n.morphingData[i],"function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy,e),(null===(r=n.otherAttrs)||void 0===r?void 0:r[i])&&n.otherAttrs[i].length&&XP(n.otherAttrs[i],t.attribute,e)})),t&&(this.clearPathProxy(),this.morphingData=null)}}])}(zP),eB=function(t){var e={};return Object.keys(t).forEach((function(i){(function(t){return YP.includes(t)})(i)||(e[i]=t[i])})),e},iB=function(t,e,i){var n=eB(t.attribute),r=t.attachShadow();if(e.length)r.setTheme(l({},e[0].type,n)),e.forEach((function(t){t.setAttributes({pickable:!1}),r.appendChild(t)}));else{var a=t.AABBBounds,o=a.width(),s=a.height();r.setTheme({rect:n}),new Array(i).fill(0).forEach((function(t){var i=al.graphicService.creator.rect({x:0,y:0,width:o,height:s,pickable:!1});r.appendChild(i),e.push(i)}))}},nB=function(t,e,i){for(var n=[],r=i?null:eB(t.attribute),a=t.toCustomPath(),o=0;o<e;o++){var s={path:(new Mu).fromCustomPath2D(a)};n.push(al.graphicService.creator.path(i?s:Object.assign({},r,s)))}return i&&iB(t,n,e),n},rB=function(t,e,i){var n=[],r=i?null:eB(t.attribute);if("rect"===t.type)(function(t,e){for(var i=Vv(t.attribute),n=i.width,r=i.height,a=Sb(n,r,e),o=[],s=r/a.length,l=0,u=a.length;l<u;l++)for(var c=a[l],h=n/c,d=0;d<c;d++)o.push({x:0+d*h,y:0+l*s,width:h,height:s});return o})(t,e).forEach((function(t){n.push(al.graphicService.creator.rect(i?t:Object.assign({},r,t)))}));else if("arc"===t.type)(function(t,e){for(var i=t.getParsedAngle(),n=i.startAngle,r=i.endAngle,a=t.getComputedAttribute("innerRadius"),o=t.getComputedAttribute("outerRadius"),s=Math.abs(n-r),l=Math.abs(o-a),u=Sb(s*(a+o)/2,l,e),c=[],h=l/u.length,d=o>=a?1:-1,p=r>=n?1:-1,f=0,v=u.length;f<v;f++)for(var g=u[f],y=s/g,m=0;m<g;m++)c.push({innerRadius:o-h*f*d,outerRadius:o-h*(f+1)*d,startAngle:n+y*m*p,endAngle:n+y*(m+1)*p});return c})(t,e).forEach((function(t){n.push(al.graphicService.creator.arc(i?t:Object.assign({},r,t)))}));else if("circle"===t.type)(function(t,e){for(var i=t.getComputedAttribute("startAngle"),n=t.getComputedAttribute("endAngle"),r=t.getComputedAttribute("radius"),a=Math.abs(i-n),o=Sb(a*r,r,e),s=[],l=a/o[0],u=r/o.length,c=n>=i?1:-1,h=0,d=o.length;h<d;h++)for(var p=0,f=o[h];p<f;p++)s.push({innerRadius:u*h,outerRadius:u*(h+1),startAngle:i+l*p*c,endAngle:i+l*(p+1)*c});return s})(t,e).forEach((function(t){n.push(al.graphicService.creator.arc(i?t:Object.assign({},r,t)))}));else if("line"===t.type){var a=function(t,e){var i=t.attribute,n=i.points;if(n)return Ab(n,e);if(i.segments){var r=i.segments.reduce((function(t,e){var i;return t.concat(null!==(i=e.points)&&void 0!==i?i:[])}),[]);return Ab(r,e)}return[]}(t,e),o={size:10,symbolType:"circle"};a.forEach((function(t){n.push(al.graphicService.creator.symbol(i?Object.assign({},t,o):Object.assign({},r,t,o)))}))}else"polygon"===t.type?function(t,e){var i=t.attribute.points;if(!i||!i.length)return[];if(1===e)return[{points:Mb(i)}];var n=[];return wb(i,e,n),n}(t,e).forEach((function(t){n.push(al.graphicService.creator.polygon(i?t:Object.assign({},r,t)))})):"area"===t.type?function(t,e){var i,n,r=t.attribute,a=r.points,o=r.segments;a||(a=o.reduce((function(t,e){var i;return t.concat(null!==(i=e.points)&&void 0!==i?i:[])}),[]));var s=a.filter((function(t){return!1!==t.defined&&Q(t.x)&&Q(t.y)}));if(!s.length)return[];var l=[];s.forEach((function(t){l.push({x:t.x,y:t.y})}));for(var u=s.length-1;u>=0;u--){var c=s[u];l.push({x:null!==(i=c.x1)&&void 0!==i?i:c.x,y:null!==(n=c.y1)&&void 0!==n?n:c.y})}var h=[];return wb(l,e,h),h}(t,e).forEach((function(t){n.push(al.graphicService.creator.polygon(i?t:Object.assign({},r,t)))})):"path"===t.type&&function(t,e){var i=bb(t.getParsedPathShape());if(!i.length||e<0)return[];var n=i.length;if(i.length>=e){for(var r=[],a=Math.floor(i.length/e),o=0;o<e;o++){var s=i.slice(o*a,o===e-1?n:(o+1)*a);r.push({path:kb(s)})}return r}for(var l=[],u=Math.floor(e/n),c=e,h=0;h<n;h++){for(var d=[],p=2,f=i[h].length;p<f;p+=2)d.push({x:i[0][p],y:i[0][p+1]});wb(d,h===n-1?c:u,l),c-=u}return l}(t,e).forEach((function(t){"path"in t?n.push(al.graphicService.creator.path(i?t:Object.assign({},r,t))):n.push(al.graphicService.creator.polygon(i?t:Object.assign({},r,t)))}));return i&&iB(t,n,e),n},aB=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).fromText="",l.toText="",l.showCursor=!1,l.cursorChar="|",l.blinkCursor=!0,l.beforeText="",l.afterText="",void 0!==(null==s?void 0:s.showCursor)&&(l.showCursor=s.showCursor),void 0!==(null==s?void 0:s.cursorChar)&&(l.cursorChar=s.cursorChar),void 0!==(null==s?void 0:s.blinkCursor)&&(l.blinkCursor=s.blinkCursor),void 0!==(null==s?void 0:s.beforeText)&&(l.beforeText=s.beforeText),void 0!==(null==s?void 0:s.afterText)&&(l.afterText=s.afterText),l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i=this.getLastProps(),n=this.getEndProps(),r=null!==(t=i.text)&&void 0!==t?t:"",a=null!==(e=n.text)&&void 0!==e?e:"";this.valid=!0,this.fromText=r.toString(),this.toText=a.toString(),this.toText||""===this.toText||(this.valid=!1)}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t]),t||(this.showCursor&&!this.blinkCursor?this.target.setAttribute("text",this.beforeText+this.toText+this.cursorChar+this.afterText):this.target.setAttribute("text",this.beforeText+this.toText+this.afterText))}},{key:"onUpdate",value:function(t,e,i){if(this.valid){var n,r,a=this.toText.length,o=this.fromText.length;o>a?(n=Math.round(o-(o-a)*e),r=this.fromText.substring(0,n)):(n=Math.round(o+(a-o)*e),r=this.toText.startsWith(this.fromText)?this.toText.substring(0,n):n<=o?this.fromText.substring(0,n):this.toText.substring(0,n-o+Math.min(o,n)));var s=this.beforeText+r+this.afterText;if(this.showCursor)if(this.blinkCursor){Math.floor(e/.1)%2==0&&(s=this.beforeText+r+this.cursorChar+this.afterText)}else s=this.beforeText+r+this.cursorChar+this.afterText;this.target.setAttribute("text",s)}}}])}(zP),oB=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[null,{},a,o,s])).clipFromAttribute=t,l.clipToAttribute=i,l._group=null==s?void 0:s.group,l._clipGraphic=null==s?void 0:s.clipGraphic,l}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]),this._group&&this._clipGraphic&&(this._lastClip=this._group.attribute.clip,this._lastPath=this._group.attribute.path,this._group.setAttributes({clip:!0,path:[this._clipGraphic]},!1,{type:kl.ANIMATE_BIND}))}},{key:"onEnd",value:function(){this._group&&this._group.setAttributes({clip:this._lastClip,path:this._lastPath},!1,{type:kl.ANIMATE_END})}},{key:"onUpdate",value:function(t,e,i){var n=this;if(this._clipGraphic){var r={};Object.keys(this.clipFromAttribute).forEach((function(t){r[t]=n.clipFromAttribute[t]+(n.clipToAttribute[t]-n.clipFromAttribute[t])*e})),this._clipGraphic.setAttributes(r,!1,{type:kl.ANIMATE_UPDATE,animationState:{ratio:e,end:t}})}}}])}(zP),sB=function(t){function e(t,i,a,o,s){var l,u,c,h,d,p,f,v,g,y,m,_;r(this,e);var b=null!==(u=null===(l=null==s?void 0:s.group)||void 0===l?void 0:l.attribute)&&void 0!==u?u:{},x=null!==(c=b.width)&&void 0!==c?c:0,k=null!==(h=b.height)&&void 0!==h?h:0,S=null!==(d=null==s?void 0:s.animationType)&&void 0!==d?d:"in",A=null!==(p=null==s?void 0:s.startAngle)&&void 0!==p?p:0,M=null!==(f=null==s?void 0:s.orient)&&void 0!==f?f:"clockwise",T=0,w=0;"anticlockwise"===M?(w="in"===S?A+2*Math.PI:A,w=A+2*Math.PI):(T=A,w="out"===S?A+2*Math.PI:A);var C,E,P=al.graphicService.creator.arc({x:null!==(g=null===(v=null==s?void 0:s.center)||void 0===v?void 0:v.x)&&void 0!==g?g:x/2,y:null!==(m=null===(y=null==s?void 0:s.center)||void 0===y?void 0:y.y)&&void 0!==m?m:k/2,outerRadius:null!==(_=null==s?void 0:s.radius)&&void 0!==_?_:(x+k)/2,innerRadius:0,startAngle:T,endAngle:w,fill:!0});return"anticlockwise"===M?(C={startAngle:A+2*Math.PI},E={startAngle:A}):(C={endAngle:A},E={endAngle:A+2*Math.PI}),n(this,e,["in"===S?C:E,"in"===S?E:C,a,o,{group:null==s?void 0:s.group,clipGraphic:P}])}return h(e,t),o(e)}(oB),lB=function(t){function e(t,i,a,o,s){var l,u,c,h,d,p,f,v,g;r(this,e);var y=null!==(u=null===(l=null==s?void 0:s.group)||void 0===l?void 0:l.attribute)&&void 0!==u?u:{},m=null!==(h=null!==(c=null==s?void 0:s.width)&&void 0!==c?c:y.width)&&void 0!==h?h:0,_=null!==(p=null!==(d=null==s?void 0:s.height)&&void 0!==d?d:y.height)&&void 0!==p?p:0,b=null!==(f=null==s?void 0:s.animationType)&&void 0!==f?f:"in",x=null!==(v=null==s?void 0:s.direction)&&void 0!==v?v:"x",k=null!==(g=null==s?void 0:s.orient)&&void 0!==g?g:"positive",S=al.graphicService.creator.rect({x:0,y:0,width:"in"===b&&"x"===x?0:m,height:"in"===b&&"y"===x?0:_,fill:!0}),A={},M={};return"y"===x?"negative"===k?(A={y:_,height:0},M={y:0,height:_}):(A={height:0},M={height:_}):"negative"===k?(A={x:m,width:0},M={x:0,width:m}):(A={width:0},M={width:m}),n(this,e,["in"===b?A:M,"in"===b?M:A,a,o,{group:null==s?void 0:s.group,clipGraphic:S}])}return h(e,t),o(e)}(oB),uB=function(t){function e(t,i,a,o,s){var l,u,c;return r(this,e),(l=n(this,e,[t,i,a,o,s])).newPointAnimateType=null!==(u=null==s?void 0:s.newPointAnimateType)&&void 0!==u?u:"grow",l.clipRangeByDimension=null!==(c=null==s?void 0:s.clipRangeByDimension)&&void 0!==c?c:"x",l}return h(e,t),o(e,[{key:"getPoints",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.points)return t.points;if(t.segments){var n=[];return this.segmentsCache||(this.segmentsCache=[]),t.segments.map((function(t){var r,a;t.points&&n.push.apply(n,b(t.points)),i&&e.segmentsCache.push(null!==(a=null===(r=t.points)||void 0===r?void 0:r.length)&&void 0!==a?a:0)})),n}return[]}},{key:"onBind",value:function(){var t=this;_(e,"onBind",this,3)([]);var i=this.target.attribute,n=i.points,r=i.segments,a=this.target.getFinalAttribute(),o=a.points,s=a.segments;this.from={points:n,segments:r},this.to={points:o,segments:s},this.props=this.to;var l=this.getPoints(this.from),u=this.getPoints(this.to,!0);this.fromPoints=l?Array.isArray(l)?l:[l]:[],this.toPoints=u?Array.isArray(u)?u:[u]:[];var c=new Map;this.fromPoints.forEach((function(t){t.context&&c.set(t.context,t)}));for(var h,d,p=1/0,f=-1/0,v=0;v<this.toPoints.length;v+=1)if(c.has(this.toPoints[v].context)){p=v,h=c.get(this.toPoints[v].context);break}for(var g=this.toPoints.length-1;g>=0;g-=1)if(c.has(this.toPoints[g].context)){f=g,d=c.get(this.toPoints[g].context);break}"clip"===this.newPointAnimateType&&0!==this.toPoints.length&&(Number.isFinite(f)?(this.clipRange=this.toPoints[f][this.clipRangeByDimension]/this.toPoints[this.toPoints.length-1][this.clipRangeByDimension],1===this.clipRange&&(this.shrinkClipRange=this.toPoints[f][this.clipRangeByDimension]/this.fromPoints[this.fromPoints.length-1][this.clipRangeByDimension]),et(this.clipRange)?this.clipRange=Xt(this.clipRange,0,1):this.clipRange=0):this.clipRange=0);var y=this.toPoints[0];this.interpolatePoints=this.toPoints.map((function(e,i){var n=c.get(e.context);return n?(y=n,[n,e]):"appear"===t.newPointAnimateType||"clip"===t.newPointAnimateType?[e,e]:i<p&&h?[h,e]:i>f&&d?[d,e]:[y,e]})),this.points=this.interpolatePoints.map((function(t){var e=t[0],i=t[1],n=new De(e.x,e.y,e.x1,e.y1);return n.defined=i.defined,n.context=i.context,n}))}},{key:"onFirstRun",value:function(){var t=this.target.attribute.clipRange;et(t*this.clipRange)&&(this.clipRange*=t)}},{key:"onUpdate",value:function(t,e,i){var n=this;if(t)return Object.keys(this.to).forEach((function(t){n.target.attribute[t]=n.to[t]})),this.target.addUpdatePositionTag(),void this.target.addUpdateShapeAndBoundsTag();if(this.points=this.points.map((function(t,i){var r=Fh(n.interpolatePoints[i][0],n.interpolatePoints[i][1],e);return r.context=t.context,r})),this.clipRange){if(this.shrinkClipRange)return void(t?(i.points=this.toPoints,i.clipRange=1):(i.points=this.fromPoints,i.clipRange=this.clipRange-(this.clipRange-this.shrinkClipRange)*e));this.target.setAttributes({clipRange:this.clipRange+(1-this.clipRange)*e})}if(this.segmentsCache&&this.to.segments){var r=0,a=this.to.segments.map((function(t,e){var i=r+n.segmentsCache[e],a=n.points.slice(r,i);return r=i,Object.assign(Object.assign({},t),{points:a})}));this.target.attribute.segments=a}else this.target.attribute.points=this.points;this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),cB=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n;_(e,"onBind",this,3)([]);var r=this.target.getFinalAttribute(),a=null!==(t=this.target.attribute)&&void 0!==t?t:{},o={},s=null!==(i=this.from)&&void 0!==i?i:{};this.keys.forEach((function(t){var e,i,n;o[t]=null!==(e=null==r?void 0:r[t])&&void 0!==e?e:1,s[t]=null!==(n=null!==(i=s[t])&&void 0!==i?i:a[t])&&void 0!==n?n:0}));var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),this.props=o,this.propKeys=this.keys,this.from=s,this.to=o,!1!==(null===(n=this.params.controlOptions)||void 0===n?void 0:n.immediatelyApply)&&this.target.setAttributes(s)}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),hB=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=this.target.attribute,i={},n={};this.keys.forEach((function(e){var r;i[e]=0,n[e]=null!==(r=t[e])&&void 0!==r?r:1})),this.props=i,this.propKeys=this.keys,this.from=n,this.to=i,Object.assign(this.target.attribute,n),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag()}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),dB=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).keys=["clipRange"],l.from={clipRange:0},l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t;_(e,"onFirstRun",this,3)([]);var i=((null===(t=this.params)||void 0===t?void 0:t.options)||{}).clipDimension;i&&(this.target.attribute.clipRangeByDimension=i)}}])}(cB),pB=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).keys=["clipRange"],l}return h(e,t),o(e)}(hB),fB=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).keys=["opacity","fillOpacity","strokeOpacity"],l.from={opacity:0,fillOpacity:0,strokeOpacity:0},l}return h(e,t),o(e)}(cB),vB=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).keys=["opacity","fillOpacity","strokeOpacity"],l}return h(e,t),o(e)}(hB),gB=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n=t.getFinalAttribute();if(e&&"anticlockwise"===e.orient){var r=Q(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:r,endAngle:r},to:{startAngle:null==n?void 0:n.startAngle,endAngle:null==n?void 0:n.endAngle}}}var a=Q(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:a,endAngle:a},to:{startAngle:null==n?void 0:n.startAngle,endAngle:null==n?void 0:n.endAngle}}}(t,e):function(t,e,i){var n=t.getFinalAttribute();return e&&"anticlockwise"===e.orient?{from:{startAngle:null==n?void 0:n.endAngle},to:{startAngle:null==n?void 0:n.startAngle}}:{from:{endAngle:null==n?void 0:n.startAngle},to:{endAngle:null==n?void 0:n.endAngle}}}(t,e)},yB=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"determineUpdateFunction",value:function(){this.propKeys?this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateAngle:"startAngle"===this.propKeys[0]?this._updateFunction=this.updateStartAngle:"endAngle"===this.propKeys[0]?this._updateFunction=this.updateEndAngle:this.valid=!1:this.valid=!1}},{key:"deleteSelfAttr",value:function(t){delete this.props[t],this.fromProps&&delete this.fromProps[t];var e=this.propKeys.indexOf(t);-1!==e&&this.propKeys.splice(e,1),this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateAngle:"startAngle"===this.propKeys[0]?this._updateFunction=this.updateStartAngle:"endAngle"===this.propKeys[0]?this._updateFunction=this.updateEndAngle:this._updateFunction=null}},{key:"updateStartAngle",value:function(t){this.target.attribute.startAngle=this.from.startAngle+(this.to.startAngle-this.from.startAngle)*t}},{key:"updateEndAngle",value:function(t){this.target.attribute.endAngle=this.from.endAngle+(this.to.endAngle-this.from.endAngle)*t}},{key:"updateAngle",value:function(t){this.updateStartAngle(t),this.updateEndAngle(t)}},{key:"onUpdate",value:function(t,e,i){this._updateFunction&&(this._updateFunction(e),this.target.addUpdateShapeAndBoundsTag())}}])}(zP),mB=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n;_(e,"onBind",this,3)([]);var r=gB(this.target,this.params.options,this.params),a=r.from,o=r.to,s=null!==(i=null===(t=this.target.context)||void 0===t?void 0:t.lastAttrs)&&void 0!==i?i:a;this.props=o,this.propKeys=Object.keys(o).filter((function(t){return null!=o[t]})),this.from=s,this.to=o;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(n=this.params.controlOptions)||void 0===n?void 0:n.immediatelyApply)&&this.target.setAttributes(s),this.determineUpdateFunction()}}])}(yB),_B=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t,i,n,r=(t=this.target,i=this.params.options,this.params,!1!==(null!==(n=null==i?void 0:i.overall)&&void 0!==n&&n)?function(t,e,i){var n=t.attribute;if(e&&"anticlockwise"===e.orient){var r=Q(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:n.startAngle,endAngle:n.endAngle},to:{startAngle:r,endAngle:r}}}var a=Q(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:n.startAngle,endAngle:n.endAngle},to:{startAngle:a,endAngle:a}}}(t,i):function(t,e,i){var n=t.attribute;return e&&"anticlockwise"===e.orient?{from:{startAngle:n.startAngle},to:{startAngle:null==n?void 0:n.endAngle}}:{from:{endAngle:n.endAngle},to:{endAngle:null==n?void 0:n.startAngle}}}(t,i)),a=r.from,o=r.to,s=a;this.props=o,this.propKeys=Object.keys(o).filter((function(t){return null!=o[t]})),this.from=null!=s?s:this.target.attribute,this.to=o,this.determineUpdateFunction()}}])}(yB),bB=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n;_(e,"onBind",this,3)([]);var r=function(t,e,i){var n=t.getFinalAttribute();switch(null==e?void 0:e.direction){case"x":var r=n.x,a=n.x1,o=n.width;return{from:U(o)?{x:r+o/2,x1:void 0,width:0}:{x:(r+a)/2,x1:(r+a)/2,width:void 0},to:{x:r,x1:a,width:o}};case"y":var s=n.y,l=n.y1,u=n.height;return{from:U(u)?{y:s+u/2,y1:void 0,height:0}:{y:(s+l)/2,y1:(s+l)/2,height:void 0},to:{y:s,y1:l,height:u}};default:var c=n.x,h=n.x1,d=n.width,p=n.y,f=n.y1,v=n.height,g={};return U(d)?(g.x=c+d/2,g.width=0,g.x1=void 0):(g.x=(c+h)/2,g.x1=(c+h)/2,g.width=void 0),U(v)?(g.y=p+v/2,g.height=0,g.y1=void 0):(g.y=(p+f)/2,g.y1=(p+f)/2,g.height=void 0),{from:g,to:{x:c,y:p,x1:h,y1:f,width:d,height:v}}}}(this.target,this.params.options,this.params),a=r.from,o=r.to,s=null!==(i=null===(t=this.target.context)||void 0===t?void 0:t.lastAttrs)&&void 0!==i?i:a;this.props=o,this.propKeys=Object.keys(o).filter((function(t){return null!=o[t]})),this.from=s,this.to=o;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(n=this.params.controlOptions)||void 0===n?void 0:n.immediatelyApply)&&this.target.setAttributes(s)}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),xB=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=function(t,e,i){var n=t.attribute;switch(null==e?void 0:e.direction){case"x":var r=n.x,a=n.x1,o=n.width;return{to:U(o)?{x:r+o/2,x1:void 0,width:0}:{x:(r+a)/2,x1:(r+a)/2,width:void 0}};case"y":var s=n.y,l=n.y1,u=n.height;return{to:U(u)?{y:s+u/2,y1:void 0,height:0}:{y:(s+l)/2,y1:(s+l)/2,height:void 0}};default:var c=n.x,h=n.y,d=n.x1,p=n.y1,f=n.width,v=n.height,g={};return U(f)?(g.x=c+f/2,g.width=0,g.x1=void 0):(g.x=(c+d)/2,g.x1=(c+d)/2,g.width=void 0),U(v)?(g.y=h+v/2,g.height=0,g.y1=void 0):(g.y=(h+p)/2,g.y1=(h+p)/2,g.height=void 0),{to:g}}}(this.target,this.params.options,this.params),i=t.from,n=t.to;this.props=n,this.propKeys=Object.keys(n).filter((function(t){return null!=n[t]})),this.from=null!=i?i:this.target.attribute,this.to=n}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP);var kB=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n,r,a,o,s=t.getFinalAttribute(),l=s.y,u=s.y1,c=s.height;return e&&"negative"===e.orient?Q(e.overall)?o=e.overall:i.group?(o=null!==(a=null!==(n=i.groupHeight)&&void 0!==n?n:null===(r=e.layoutRect)||void 0===r?void 0:r.height)&&void 0!==a?a:i.group.getBounds().height(),i.groupHeight=o):o=i.height:o=Q(null==e?void 0:e.overall)?e.overall:0,{from:{y:o,y1:j(u)?void 0:o,height:j(c)?void 0:0},to:{y:l,y1:u,height:c}}}(t,e,i):function(t,e,i){var n=t.getFinalAttribute(),r=n.y,a=n.y1,o=n.height;if(e&&"negative"===e.orient){var s=U(o)?Math.max(r,r+o):Math.max(r,a);return{from:{y:s,y1:j(a)?void 0:s,height:j(o)?void 0:0},to:{y:r,y1:a,height:o}}}var l=U(o)?Math.min(r,r+o):Math.min(r,a);return{from:{y:l,y1:j(a)?void 0:l,height:j(o)?void 0:0},to:{y:r,y1:a,height:o}}}(t,e)},SB=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n;_(e,"onBind",this,3)([]);var r=kB(this.target,this.params.options,this.params),a=r.from,o=r.to,s=null!==(i=null===(t=this.target.context)||void 0===t?void 0:t.lastAttrs)&&void 0!==i?i:a;this.props=o,this.propKeys=Object.keys(o).filter((function(t){return null!=o[t]})),this.from=s,this.to=o;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(n=this.params.controlOptions)||void 0===n?void 0:n.immediatelyApply)&&this.target.setAttributes(s)}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP);var AB=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t,i,n,r,a=(t=this.target,i=this.params.options,n=this.params,!1!==(null!==(r=null==i?void 0:i.overall)&&void 0!==r&&r)?function(t,e,i){var n,r,a,o,s=t.getFinalAttribute(),l=s.y1,u=s.height;return e&&"negative"===e.orient?Q(e.overall)?o=e.overall:i.group?(o=null!==(a=null!==(n=i.groupHeight)&&void 0!==n?n:null===(r=e.layoutRect)||void 0===r?void 0:r.height)&&void 0!==a?a:i.group.getBounds().height(),i.groupHeight=o):o=i.height:o=Q(null==e?void 0:e.overall)?e.overall:0,{to:{y:o,y1:j(l)?void 0:o,height:j(u)?void 0:0}}}(t,i,n):function(t,e,i){var n=t.getFinalAttribute(),r=n.y,a=n.y1,o=n.height;if(e&&"negative"===e.orient){var s=U(o)?Math.max(r,r+o):Math.max(r,a);return{to:{y:s,y1:j(a)?void 0:s,height:j(o)?void 0:0}}}var l=U(o)?Math.min(r,r+o):Math.min(r,a);return{to:{y:l,y1:j(a)?void 0:l,height:j(o)?void 0:0}}}(t,i)),o=a.from,s=a.to;this.props=s,this.propKeys=Object.keys(s).filter((function(t){return null!=s[t]})),this.from=null!=o?o:this.target.attribute,this.to=s}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),MB=function(t,e,i){var n=t.getFinalAttribute().points,r={x:0,y:0};return n.forEach((function(t){r.x+=t.x,r.y+=t.y})),r.x/=n.length,r.y/=n.length,e&&e.center&&(et(e.center.x)&&(r.x=e.center.x),et(e.center.y)&&(r.y=e.center.y)),"area"===t.type&&(r.x1=r.x,r.y1=r.y),n.map((function(t){return Object.assign({},t,r)}))},TB=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onUpdate",value:function(t,e,i){var n,r,a=null===(n=this.from)||void 0===n?void 0:n.points,o=null===(r=this.to)||void 0===r?void 0:r.points;a&&o&&(this.target.attribute.points=a.map((function(t,i){return Fh(a[i],o[i],e)})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag())}}])}(zP),wB=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r;if(_(e,"onBind",this,3)([]),["area","line","polygon"].includes(this.target.type)){var a=(i=this.target,n=this.params.options,this.params,r=i.getFinalAttribute(),{from:{points:MB(i,n)},to:{points:r.points}}),o=a.from,s=a.to;this.props=s,this.propKeys=Object.keys(s).filter((function(t){return null!=s[t]})),this.from=o,this.to=s;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(t=this.params.controlOptions)||void 0===t?void 0:t.immediatelyApply)&&this.target.setAttributes(o)}else this.valid=!1}}])}(TB),CB=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){if(_(e,"onBind",this,3)([]),["area","line"].includes(this.target.type)){var t=this.target.getFinalAttribute(),i=(a=this.target,o=this.params.options,this.params,{from:{points:a.getFinalAttribute().points},to:{points:MB(a,o)}}),n=i.from,r=i.to;this.props=r,this.propKeys=Object.keys(r).filter((function(t){return null!=r[t]})),this.from=n||t,this.to=r}else this.valid=!1;var a,o}}])}(TB),EB=function(t,e,i){return t.getFinalAttribute().points.map((function(i){if(e&&"negative"===e.orient){var n=t.stage.viewWidth;return t.parent.parent.parent&&(n=t.parent.parent.parent.AABBBounds.width()),Object.assign(Object.assign({},i),{x:n,y:i.y,x1:n,y1:i.y1,defined:!1!==i.defined})}return Object.assign(Object.assign({},i),{x:0,y:i.y,x1:0,y1:i.y1,defined:!1!==i.defined})}))},PB=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r;if(_(e,"onBind",this,3)([]),["area","line","polygon"].includes(this.target.type)){var a=(i=this.target,n=this.params.options,this.params,r=i.getFinalAttribute(),{from:{points:EB(i,n)},to:{points:r.points}}),o=a.from,s=a.to;this.props=s,this.propKeys=Object.keys(s).filter((function(t){return null!=s[t]})),this.from=o,this.to=s;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(t=this.params.controlOptions)||void 0===t?void 0:t.immediatelyApply)&&this.target.setAttributes(o)}else this.valid=!1}}])}(TB),BB=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){if(_(e,"onBind",this,3)([]),["area","line"].includes(this.target.type)){var t=this.target.getFinalAttribute(),i=(a=this.target,o=this.params.options,this.params,{from:{points:a.getFinalAttribute().points},to:{points:EB(a,o)}}),n=i.from,r=i.to;this.props=r,this.propKeys=Object.keys(r).filter((function(t){return null!=r[t]})),this.from=n||t,this.to=r}else this.valid=!1;var a,o}}])}(TB),RB=function(t,e,i){return t.getFinalAttribute().points.map((function(i){if(e&&"negative"===e.orient){var n=t.stage.viewHeight;return t.parent.parent.parent&&(n=t.parent.parent.parent.AABBBounds.height()),Object.assign(Object.assign({},i),{x:i.x,y:n,x1:i.x1,y1:n,defined:!1!==i.defined})}return Object.assign(Object.assign({},i),{x:i.x,y:0,x1:i.x1,y1:0,defined:!1!==i.defined})}))},LB=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r;if(_(e,"onBind",this,3)([]),["area","line","polygon"].includes(this.target.type)){var a=(i=this.target,n=this.params.options,this.params,r=i.getFinalAttribute(),{from:{points:RB(i,n)},to:{points:r.points}}),o=a.from,s=a.to;this.props=s,this.propKeys=Object.keys(s).filter((function(t){return null!=s[t]})),this.from=o,this.to=s;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(t=this.params.controlOptions)||void 0===t?void 0:t.immediatelyApply)&&this.target.setAttributes(o)}else this.valid=!1}}])}(TB),IB=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){if(_(e,"onBind",this,3)([]),["area","line","polygon"].includes(this.target.type)){var t=(r=this.target,a=this.params.options,this.params,{from:{points:r.getFinalAttribute().points},to:{points:RB(r,a)}}),i=t.from,n=t.to;this.props=n,this.propKeys=Object.keys(n).filter((function(t){return null!=n[t]})),this.from=null!=i?i:this.target.attribute,this.to=n}else this.valid=!1;var r,a}}])}(TB),DB=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n=t.getFinalAttribute(),r=Q(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:r,outerRadius:r},to:{innerRadius:null==n?void 0:n.innerRadius,outerRadius:null==n?void 0:n.outerRadius}}}(t,e):function(t,e,i){var n=t.getFinalAttribute();return e&&"inside"===e.orient?{from:{innerRadius:null==n?void 0:n.outerRadius},to:{innerRadius:null==n?void 0:n.innerRadius}}:{from:{outerRadius:null==n?void 0:n.innerRadius},to:{outerRadius:null==n?void 0:n.outerRadius}}}(t,e)},OB=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),FB=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n;_(e,"onBind",this,3)([]);var r=DB(this.target,this.params.options,this.params),a=r.from,o=r.to,s=null!==(i=null===(t=this.target.context)||void 0===t?void 0:t.lastAttrs)&&void 0!==i?i:a;this.props=o,this.propKeys=Object.keys(o).filter((function(t){return null!=o[t]})),this.from=s,this.to=o;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(n=this.params.controlOptions)||void 0===n?void 0:n.immediatelyApply)&&this.target.setAttributes(s)}}])}(OB),zB=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t,i,n,r=(t=this.target,i=this.params.options,this.params,!1!==(null!==(n=null==i?void 0:i.overall)&&void 0!==n&&n)?function(t,e,i){var n=t.getFinalAttribute(),r=Q(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:null==n?void 0:n.innerRadius,outerRadius:null==n?void 0:n.outerRadius},to:{innerRadius:r,outerRadius:r}}}(t,i):function(t,e,i){var n=t.getFinalAttribute();return e&&"inside"===e.orient?{from:{innerRadius:null==n?void 0:n.innerRadius},to:{innerRadius:null==n?void 0:n.outerRadius}}:{from:{outerRadius:null==n?void 0:n.outerRadius},to:{outerRadius:null==n?void 0:n.innerRadius}}}(t,i)).to;this.props=r,this.propKeys=Object.keys(r).filter((function(t){return null!=r[t]})),this.from=this.target.attribute,this.to=r}}])}(OB);var HB=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n,r,a=t.getFinalAttribute(),o=a.x,s=a.x1,l=a.width;return e&&"negative"===e.orient?Q(e.overall)?r=e.overall:i.group?(r=null!==(n=i.groupWidth)&&void 0!==n?n:i.group.getBounds().width(),i.groupWidth=r):r=i.width:r=Q(null==e?void 0:e.overall)?null==e?void 0:e.overall:0,{from:{x:r,x1:j(s)?void 0:r,width:j(l)?void 0:0},to:{x:o,x1:s,width:l}}}(t,e,i):function(t,e,i){var n=t.getFinalAttribute(),r=n.x,a=n.x1,o=n.width;if(e&&"negative"===e.orient){var s=U(o)?Math.max(r,r+o):Math.max(r,a);return{from:{x:s,x1:j(a)?void 0:s,width:j(o)?void 0:0},to:{x:r,x1:a,width:o}}}var l=U(o)?Math.min(r,r+o):Math.min(r,a);return{from:{x:l,x1:j(a)?void 0:l,width:j(o)?void 0:0},to:{x:r,x1:a,width:o}}}(t,e)};var NB=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n;_(e,"onBind",this,3)([]);var r=HB(this.target,this.params.options,this.params),a=r.from,o=r.to,s=null!==(i=null===(t=this.target.context)||void 0===t?void 0:t.lastAttrs)&&void 0!==i?i:a;this.props=o,this.propKeys=Object.keys(o).filter((function(t){return null!=o[t]})),this.from=s,this.to=o;var l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),!1!==(null===(n=this.params.controlOptions)||void 0===n?void 0:n.immediatelyApply)&&this.target.setAttributes(s)}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),VB=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t,i,n,r,a=(t=this.target,i=this.params.options,n=this.params,!1!==(null!==(r=null==i?void 0:i.overall)&&void 0!==r&&r)?function(t,e,i){var n,r,a=t.getFinalAttribute(),o=a.x1,s=a.width;return e&&"negative"===e.orient?Q(e.overall)?r=e.overall:i.group?(r=null!==(n=i.groupWidth)&&void 0!==n?n:i.group.getBounds().width(),i.groupWidth=r):r=i.width:r=Q(null==e?void 0:e.overall)?e.overall:0,{to:{x:r,x1:j(o)?void 0:r,width:j(s)?void 0:0}}}(t,i,n):function(t,e,i){var n=t.getFinalAttribute(),r=n.x,a=n.x1,o=n.width;if(e&&"negative"===e.orient){var s=U(o)?Math.max(r,r+o):Math.max(r,a);return{to:{x:s,x1:j(a)?void 0:s,width:j(o)?void 0:0}}}var l=U(o)?Math.min(r,r+o):Math.min(r,a);return{to:{x:l,x1:j(a)?void 0:l,width:j(o)?void 0:0}}}(t,i)),o=a.from,s=a.to;this.props=s,this.propKeys=Object.keys(s).filter((function(t){return null!=s[t]})),this.from=null!=o?o:this.target.attribute,this.to=s}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),jB=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=jP(this.target);this._animator=t;var i,n,r=this.duration,a=this.easing,o=this.target,s=this.params,l=s.symbolStartOuterType,u=void 0===l?"scale":l,c=s.titleType,h=void 0===c?"typewriter":c,d=s.titlePanelType,p=void 0===d?"scale":d,f=r/10;if(o._symbolStart.setAttributes({scaleX:0,scaleY:0}),t.animate(o._symbolStart,{type:"to",to:{scaleX:1,scaleY:1},duration:5*f,easing:a}),"scale"===u?(i={scaleX:0,scaleY:0},n={scaleX:1,scaleY:1}):(i={clipRange:0},n={clipRange:1}),o._symbolStartOuter.setAttributes(i),t.animate(o._symbolStartOuter,{type:"to",to:n,duration:5*f,easing:a}),o._symbolEnd.setAttributes({scaleX:0,scaleY:0}),t.animate(o._symbolEnd,{type:"to",to:{scaleX:1,scaleY:1},duration:2*f,delay:8*f,easing:a}),o._line.setAttributes({clipRange:0}),t.animate(o._line,{type:"to",to:{clipRange:1},duration:9*f,easing:a}),"typewriter"===h){var v=o._titleTop.attribute.text;o._titleTop.setAttributes({text:""}),t.animate(o._titleTop,{type:"custom",delay:5*f,duration:4*f,easing:"linear",to:{text:v},custom:aB});var g=o._titleBottom.attribute.text;o._titleBottom.setAttributes({text:""}),t.animate(o._titleBottom,{type:"custom",delay:5*f,duration:4*f,easing:"linear",to:{text:g},custom:aB})}else o._titleTop.setAttributes({dy:o._titleTop.AABBBounds.height()+10}),t.animate(o._titleTop,{type:"to",to:{dy:0},delay:5*f,duration:4*f,easing:"linear"}),o._titleBottom.setAttributes({dy:-(10+o._titleBottom.AABBBounds.height())}),t.animate(o._titleBottom,{type:"to",to:{dy:0},delay:5*f,duration:4*f,easing:"linear"});"scale"===p?[o._titleTopPanel,o._titleBottomPanel].forEach((function(e){var i,n=null!==(i=e.attribute.scaleX)&&void 0!==i?i:1;e.setAttributes({scaleX:0}),t.animate(e,{type:"to",to:{scaleX:n},duration:r,easing:a})})):"stroke"===p&&[o._titleTopPanel,o._titleBottomPanel].forEach((function(e){var i=e.AABBBounds,n=2*(i.width()+i.height());e.setAttributes({lineDash:[0,10*n]}),t.animate(e,{type:"to",to:{lineDash:[n,10*n]},duration:r,easing:a})})),this.completeBind(t)}}])}(HP),UB=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=jP(this.target);this._animator=t;var i=this.duration,n=this.easing,r=this.target;"scale"===this.params.mode?t.animate(r._symbolStart,{type:"to",to:{scaleX:0,scaleY:0},duration:i,easing:n}):(t.animate(r._line,{type:"to",to:{clipRange:0},duration:i,easing:n}),t.animate(r._symbolStart,{type:"to",to:{scaleX:0,scaleY:0},duration:i/2,delay:i/2,easing:n}),t.animate(r._symbolEnd,{type:"to",to:{scaleX:0,scaleY:0},duration:i,easing:n}),t.animate(r._titleTop,{type:"to",to:{dy:r._titleTop.AABBBounds.height()+10},duration:i/2,easing:n}),t.animate(r._titleBottom,{type:"to",to:{dy:-(10+r._titleBottom.AABBBounds.height())},duration:i/2,easing:n}),t.animate(r._symbolStartOuter,{type:"to",to:{clipRange:0},duration:i/2,delay:i/2,easing:n}),t.animate(r._titleTopPanel,{type:"to",to:{scaleX:0},duration:i,easing:n}),t.animate(r._titleBottomPanel,{type:"to",to:{scaleX:0},duration:i,easing:n})),this.completeBind(t)}}])}(HP),WB=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=jP(this.target);this._animator=t;var i=this.duration,n=this.easing,r=this.target,a=this.params.wave;if(r.setAttributes({scaleX:0,scaleY:0}),t.animate(r,{type:"to",to:{scaleX:1,scaleY:1},duration:i/3*2,easing:n}),r.titleShape&&t.animate(r.titleShape,{type:"custom",to:{text:r.titleShape.attribute.text},duration:i,easing:n,custom:aB}),r.contentShape&&t.animate(r.contentShape,{type:"custom",to:{text:r.contentShape.attribute.text},duration:i,easing:n,custom:aB}),a){var o=i/6;t.animate(r.group,{timeSlices:[{duration:o,effects:{type:"to",to:{angle:a},easing:n}},{duration:2*o,effects:{type:"to",to:{angle:-a},easing:n}},{duration:2*o,effects:{type:"to",to:{angle:a},easing:n}},{duration:o,effects:{type:"to",to:{angle:0},easing:n}}]})}this.completeBind(t)}}])}(HP),GB=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=jP(this.target);this._animator=t;var i=this.duration,n=this.easing,r=this.target;t.animate(r,{type:"to",to:{scaleX:0,scaleY:0},duration:i,easing:n}),this.completeBind(t)}}])}(HP),YB=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).fromTextConfig=[],l.toTextConfig=[],l.originalTextConfig=[],l.showCursor=!1,l.cursorChar="|",l.blinkCursor=!0,l.fadeInChars=!1,l.fadeInDuration=.3,l.strokeFirst=!1,l.strokeToFillRatio=.3,void 0!==(null==s?void 0:s.showCursor)&&(l.showCursor=s.showCursor),void 0!==(null==s?void 0:s.cursorChar)&&(l.cursorChar=s.cursorChar),void 0!==(null==s?void 0:s.blinkCursor)&&(l.blinkCursor=s.blinkCursor),void 0!==(null==s?void 0:s.fadeInChars)&&(l.fadeInChars=s.fadeInChars),void 0!==(null==s?void 0:s.fadeInDuration)&&(l.fadeInDuration=s.fadeInDuration),void 0!==(null==s?void 0:s.strokeFirst)&&(l.strokeFirst=s.strokeFirst),void 0!==(null==s?void 0:s.strokeToFillRatio)&&(l.strokeToFillRatio=s.strokeToFillRatio),l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=e.textConfig?b(e.textConfig):[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=t.textConfig&&t.textConfig.length>0?rg.TransformTextConfig2SingleCharacter(t.textConfig):[],this.toTextConfig=rg.TransformTextConfig2SingleCharacter(this.originalTextConfig)):this.valid=!1}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t]),t||this.target.setAttribute("textConfig",this.originalTextConfig)}},{key:"onUpdate",value:function(t,e,i){var n=this;if(this.valid){var r,a,o=this.toTextConfig.length,s=this.fromTextConfig.length,l=this.fadeInChars?1-this.fadeInDuration:1;if(s>o)r=Math.round(s-(s-o)*e);else if(this.fadeInChars){var u=Math.min(1,e/l);r=Math.round(s+(o-s)*u)}else r=Math.round(s+(o-s)*e);if(a=s>o?this.fromTextConfig.slice(0,r):this.toTextConfig.slice(0,r).map((function(t,i){if("text"in t){var r=Object.assign({},t);if(n.strokeFirst){var a=i/o*l,s=Math.max(0,e-a),u=1-a,c=Math.min(1,s/(n.strokeToFillRatio*u));if("fill"in r&&r.fill&&(r.stroke=r.fill,c<1&&(r.fillOpacity=c)),n.fadeInChars){var h=Math.min(1,s/(n.fadeInDuration*u));r.opacity=Math.max(0,Math.min(1,h))}}else if(n.fadeInChars){var d=(e-i/o*l)/n.fadeInDuration;r.opacity=Math.max(0,Math.min(1,d))}return r}return t})),this.showCursor&&r<o){var c=!0;if(this.blinkCursor){c=Math.floor(e/.1)%2==0}if(c&&a.length>0){var h=a.length-1,d=a[h];if("text"in d)a[h]=Object.assign(Object.assign({},d),{text:String(d.text)+this.cursorChar});else{var p={text:this.cursorChar,fontSize:16};a.push(p)}}}this.target.setAttribute("textConfig",a)}}}])}(zP),XB=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).fromTextConfig=[],l.toTextConfig=[],l.originalTextConfig=[],l.showCursor=!1,l.cursorChar="|",l.blinkCursor=!0,l.beforeText="",l.afterText="",l.fadeOutChars=!1,l.fadeOutDuration=.3,l.direction="backward",void 0!==(null==s?void 0:s.showCursor)&&(l.showCursor=s.showCursor),void 0!==(null==s?void 0:s.cursorChar)&&(l.cursorChar=s.cursorChar),void 0!==(null==s?void 0:s.blinkCursor)&&(l.blinkCursor=s.blinkCursor),void 0!==(null==s?void 0:s.beforeText)&&(l.beforeText=s.beforeText),void 0!==(null==s?void 0:s.afterText)&&(l.afterText=s.afterText),void 0!==(null==s?void 0:s.fadeOutChars)&&(l.fadeOutChars=s.fadeOutChars),void 0!==(null==s?void 0:s.fadeOutDuration)&&(l.fadeOutDuration=s.fadeOutDuration),void 0!==(null==s?void 0:s.direction)&&(l.direction=s.direction),l.propKeys=["textConfig"],l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=t.textConfig?b(t.textConfig):[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=rg.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.toTextConfig=e.textConfig&&e.textConfig.length>0?rg.TransformTextConfig2SingleCharacter(e.textConfig):[]):this.valid=!1}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t]),t||(this.toTextConfig.length>0?this.target.setAttribute("textConfig",this.toTextConfig):this.target.setAttribute("textConfig",[]))}},{key:"onUpdate",value:function(t,e,i){if(this.valid){var n,r=this.fromTextConfig.length,a=this.fadeOutChars?1-this.fadeOutDuration:1;if("forward"===this.direction){if(this.fadeOutChars){var o=Math.min(1,e/a);n=Math.round(r*(1-o))}else n=Math.round(r*(1-e));var s="forward"===this.direction?this.fromTextConfig.slice(r-n):this.fromTextConfig.slice(0,n);this.fadeOutChars&&(s=this.applyFadeEffect(s,e,r,n)),this.showCursor&&n>0&&(s=this.addCursor(s,e)),this.target.setAttribute("textConfig",s)}else{if(this.fadeOutChars){var l=Math.min(1,e/a);n=Math.round(r*(1-l))}else n=Math.round(r*(1-e));var u=this.fromTextConfig.slice(0,n);this.fadeOutChars&&(u=this.applyFadeEffect(u,e,r,n)),this.showCursor&&n>0&&(u=this.addCursor(u,e)),this.target.setAttribute("textConfig",u)}}}},{key:"applyFadeEffect",value:function(t,e,i,n){var r=this;this.direction;var a=(e-(1-this.fadeOutDuration))/this.fadeOutDuration,o=Math.max(0,1-Math.min(1,a));return t.map((function(e,i){if("forward"===r.direction){if(0===i&&"text"in e)return Object.assign(Object.assign({},e),{opacity:o})}else if(i===t.length-1&&"text"in e)return Object.assign(Object.assign({},e),{opacity:o});return e}))}},{key:"addCursor",value:function(t,e){var i=!0;if(this.blinkCursor){i=Math.floor(e/.1)%2==0}if(i&&t.length>0){var n="forward"===this.direction?0:t.length-1,r=t[n];if("text"in r){var a=b(t);return"forward"===this.direction?a[n]=Object.assign(Object.assign({},r),{text:this.cursorChar+String(r.text)}):a[n]=Object.assign(Object.assign({},r),{text:String(r.text)+this.cursorChar}),a}}return t}}])}(zP),KB=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).fromTextConfig=[],l.toTextConfig=[],l.originalTextConfig=[],l.singleCharConfig=[],l.fadeInDuration=.3,l.slideDirection="right",l.slideDistance=30,l.wordByWord=!1,l.wordRegex=/[a-zA-Z]+(-[a-zA-Z]+)*|[\u4e00-\u9fa5]+|[0-9]+|[^\s\w\u4e00-\u9fa5]/g,l.wordGroups=[],void 0!==(null==s?void 0:s.fadeInDuration)&&(l.fadeInDuration=s.fadeInDuration),void 0!==(null==s?void 0:s.slideDirection)&&(l.slideDirection=s.slideDirection),void 0!==(null==s?void 0:s.slideDistance)&&(l.slideDistance=s.slideDistance),void 0!==(null==s?void 0:s.wordByWord)&&(l.wordByWord=s.wordByWord),void 0!==(null==s?void 0:s.wordRegex)&&(l.wordRegex=s.wordRegex),l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t=this,e=this.getLastProps(),i=this.getEndProps();this.originalTextConfig=i.textConfig?b(i.textConfig):[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=e.textConfig&&e.textConfig.length>0?rg.TransformTextConfig2SingleCharacter(e.textConfig):[],this.toTextConfig=rg.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.singleCharConfig=this.toTextConfig.map((function(e){return"text"in e?Object.assign(Object.assign({},e),{opacity:0,dx:t.getInitialDx(),dy:t.getInitialDy()}):Object.assign(Object.assign({},e),{opacity:0})})),this.wordByWord&&this.calculateWordGroups()):this.valid=!1}},{key:"calculateWordGroups",value:function(){this.wordGroups=[];var t,e="",i={},n=0;for(this.toTextConfig.forEach((function(t,r){if("text"in t){var a=String(t.text);e+=a,i[n]=r,n++}})),this.wordRegex.lastIndex=0;null!==(t=this.wordRegex.exec(e));){for(var r=t.index,a=t.index+t[0].length,o=[],s=r;s<a;s++)void 0!==i[s]&&o.push(i[s]);o.length>0&&this.wordGroups.push(o)}var l=new Set;this.wordGroups.forEach((function(t){t.forEach((function(t){return l.add(t)}))}));for(var u=0;u<this.toTextConfig.length;u++)"text"in this.toTextConfig[u]&&!l.has(u)&&this.wordGroups.push([u])}},{key:"getInitialDx",value:function(){switch(this.slideDirection){case"left":return-this.slideDistance;case"right":return this.slideDistance;default:return 0}}},{key:"getInitialDy",value:function(){switch(this.slideDirection){case"up":return-this.slideDistance;case"down":return this.slideDistance;default:return 0}}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t]),t||this.target.setAttribute("textConfig",this.originalTextConfig)}},{key:"onUpdate",value:function(t,e,i){if(this.valid){var n,r=1-this.fadeInDuration;n=this.wordByWord&&this.wordGroups.length>0?this.updateByWord(e,r):this.updateByCharacter(e,r),this.target.setAttribute("textConfig",n)}}},{key:"updateByWord",value:function(t,e){for(var i=this.wordGroups.length,n=b(this.singleCharConfig),r=0;r<this.wordGroups.length;r++){var a;if(t<(a="left"===this.slideDirection?(i-1-r)/i*e:r/i*e)){var o,l=s(this.wordGroups[r]);try{for(l.s();!(o=l.n()).done;){var u=o.value,c=n[u];"text"in c&&(n[u]=Object.assign(Object.assign({},c),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()}))}}catch(t){l.e(t)}finally{l.f()}}else{var h,d=(t-a)/this.fadeInDuration,p=Math.max(0,Math.min(1,d)),f=this.getInitialDx()*(1-p),v=this.getInitialDy()*(1-p),g=s(this.wordGroups[r]);try{for(g.s();!(h=g.n()).done;){var y=h.value,m=n[y];"text"in m&&(n[y]=Object.assign(Object.assign({},m),{opacity:p,dx:f,dy:v}))}}catch(t){g.e(t)}finally{g.f()}}}return n}},{key:"updateByCharacter",value:function(t,e){for(var i=this.toTextConfig.length,n=b(this.singleCharConfig),r=0;r<n.length;r++){var a=n[r];if("text"in a){var o;if(t<(o="left"===this.slideDirection?(i-1-r)/i*e:r/i*e)){n[r]=Object.assign(Object.assign({},a),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()});continue}var s=(t-o)/this.fadeInDuration,l=Math.max(0,Math.min(1,s)),u=this.getInitialDx()*(1-l),c=this.getInitialDy()*(1-l);n[r]=Object.assign(Object.assign({},a),{opacity:l,dx:u,dy:c})}}return n}}])}(zP),qB=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).fromTextConfig=[],l.toTextConfig=[],l.originalTextConfig=[],l.singleCharConfig=[],l.fadeOutDuration=.3,l.slideDirection="right",l.slideDistance=30,l.wordByWord=!1,l.wordRegex=/[a-zA-Z]+(-[a-zA-Z]+)*|[\u4e00-\u9fa5]+|[0-9]+|[^\s\w\u4e00-\u9fa5]/g,l.wordGroups=[],l.reverseOrder=!1,void 0!==(null==s?void 0:s.fadeOutDuration)&&(l.fadeOutDuration=s.fadeOutDuration),void 0!==(null==s?void 0:s.slideDirection)&&(l.slideDirection=s.slideDirection),void 0!==(null==s?void 0:s.slideDistance)&&(l.slideDistance=s.slideDistance),void 0!==(null==s?void 0:s.wordByWord)&&(l.wordByWord=s.wordByWord),void 0!==(null==s?void 0:s.wordRegex)&&(l.wordRegex=s.wordRegex),void 0!==(null==s?void 0:s.reverseOrder)&&(l.reverseOrder=s.reverseOrder),l.propKeys=["textConfig"],l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=t.textConfig?b(t.textConfig):[],this.valid=!0,this.originalTextConfig&&0!==this.originalTextConfig.length?(this.fromTextConfig=rg.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.toTextConfig=e.textConfig&&e.textConfig.length>0?rg.TransformTextConfig2SingleCharacter(e.textConfig):[],this.singleCharConfig=this.fromTextConfig.map((function(t){return"text"in t?Object.assign(Object.assign({},t),{opacity:1,dx:0,dy:0}):Object.assign(Object.assign({},t),{opacity:1})})),this.wordByWord&&this.calculateWordGroups()):this.valid=!1}},{key:"calculateWordGroups",value:function(){this.wordGroups=[];var t,e="",i={},n=0;for(this.fromTextConfig.forEach((function(t,r){if("text"in t){var a=String(t.text);e+=a,i[n]=r,n++}})),this.wordRegex.lastIndex=0;null!==(t=this.wordRegex.exec(e));){for(var r=t.index,a=t.index+t[0].length,o=[],s=r;s<a;s++)void 0!==i[s]&&o.push(i[s]);o.length>0&&this.wordGroups.push(o)}var l=new Set;this.wordGroups.forEach((function(t){t.forEach((function(t){return l.add(t)}))}));for(var u=0;u<this.fromTextConfig.length;u++)"text"in this.fromTextConfig[u]&&!l.has(u)&&this.wordGroups.push([u])}},{key:"getTargetDx",value:function(){switch(this.slideDirection){case"left":return-this.slideDistance;case"right":return this.slideDistance;default:return 0}}},{key:"getTargetDy",value:function(){switch(this.slideDirection){case"up":return-this.slideDistance;case"down":return this.slideDistance;default:return 0}}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t]),t||(this.toTextConfig.length>0?this.target.setAttribute("textConfig",this.toTextConfig):this.target.setAttribute("textConfig",[]))}},{key:"onUpdate",value:function(t,e,i){if(this.valid){var n,r=1-this.fadeOutDuration;n=this.wordByWord&&this.wordGroups.length>0?this.updateByWord(e,r):this.updateByCharacter(e,r),this.target.setAttribute("textConfig",n)}}},{key:"updateByWord",value:function(t,e){for(var i=this.wordGroups.length,n=b(this.singleCharConfig),r=0;r<this.wordGroups.length;r++){var a;if(t<(a=this.reverseOrder?"left"===this.slideDirection?r/i*e:(i-1-r)/i*e:"left"===this.slideDirection?(i-1-r)/i*e:r/i*e)){var o,l=s(this.wordGroups[r]);try{for(l.s();!(o=l.n()).done;){var u=o.value,c=n[u];"text"in c&&(n[u]=Object.assign(Object.assign({},c),{opacity:1,dx:0,dy:0}))}}catch(t){l.e(t)}finally{l.f()}}else{var h,d=(t-a)/this.fadeOutDuration,p=Math.max(0,Math.min(1,d)),f=this.getTargetDx()*p,v=this.getTargetDy()*p,g=1-p,y=s(this.wordGroups[r]);try{for(y.s();!(h=y.n()).done;){var m=h.value,_=n[m];"text"in _&&(n[m]=Object.assign(Object.assign({},_),{opacity:g,dx:f,dy:v}))}}catch(t){y.e(t)}finally{y.f()}}}return n}},{key:"updateByCharacter",value:function(t,e){for(var i=this.fromTextConfig.length,n=b(this.singleCharConfig),r=0;r<n.length;r++){var a=n[r];if("text"in a){var o;if(t<(o=this.reverseOrder?"left"===this.slideDirection?r/i*e:(i-1-r)/i*e:"left"===this.slideDirection?(i-1-r)/i*e:r/i*e)){n[r]=Object.assign(Object.assign({},a),{opacity:1,dx:0,dy:0});continue}var s=(t-o)/this.fadeOutDuration,l=Math.max(0,Math.min(1,s)),u=this.getTargetDx()*l,c=this.getTargetDy()*l,h=1-l;n[r]=Object.assign(Object.assign({},a),{opacity:h,dx:u,dy:c})}}return n}}])}(zP),ZB=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o,s,l,u,c,h,d,p;_(e,"onBind",this,3)([]);var f=this.target.getFinalAttribute(),v=null!==(t=this.target.attribute)&&void 0!==t?t:{};switch(null===(i=this.params)||void 0===i?void 0:i.direction){case"x":d={scaleX:null!==(n=v.scaleX)&&void 0!==n?n:0},p={scaleX:null!==(r=null==f?void 0:f.scaleX)&&void 0!==r?r:1},this._updateFunction=this.updateX;break;case"y":d={scaleY:null!==(a=v.scaleY)&&void 0!==a?a:0},p={scaleY:null!==(o=null==f?void 0:f.scaleY)&&void 0!==o?o:1},this._updateFunction=this.updateY;break;default:d={scaleX:null!==(s=v.scaleX)&&void 0!==s?s:0,scaleY:null!==(l=v.scaleY)&&void 0!==l?l:0},p={scaleX:null!==(u=null==f?void 0:f.scaleX)&&void 0!==u?u:1,scaleY:null!==(c=null==f?void 0:f.scaleY)&&void 0!==c?c:1},this._updateFunction=this.updateXY}var g=this.target.getFinalAttribute();g&&this.target.setAttributes(g),this.props=p,this.from=d,this.to=p,!1!==(null===(h=this.params.controlOptions)||void 0===h?void 0:h.immediatelyApply)&&this.target.setAttributes(d)}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"updateX",value:function(t){this.target.attribute.scaleX=this.from.scaleX+(this.to.scaleX-this.from.scaleX)*t}},{key:"updateY",value:function(t){this.target.attribute.scaleY=this.from.scaleY+(this.to.scaleY-this.from.scaleY)*t}},{key:"updateXY",value:function(t){this.updateX(t),this.updateY(t)}},{key:"deleteSelfAttr",value:function(t){delete this.props[t],this.fromProps&&delete this.fromProps[t];var e=this.propKeys.indexOf(t);-1!==e&&this.propKeys.splice(e,1),this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateXY:"scaleX"===this.propKeys[0]?this._updateFunction=this.updateX:"scaleY"===this.propKeys[0]?this._updateFunction=this.updateY:this._updateFunction=null}},{key:"onUpdate",value:function(t,e,i){this._updateFunction&&(this._updateFunction(e),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag())}}])}(zP),JB=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o,s;_(e,"onBind",this,3)([]);var l=this.target.attribute;switch(null===(t=this.params)||void 0===t?void 0:t.direction){case"x":o={scaleX:null!==(i=null==l?void 0:l.scaleX)&&void 0!==i?i:1},s={scaleX:0};break;case"y":o={scaleY:null!==(n=null==l?void 0:l.scaleY)&&void 0!==n?n:1},s={scaleY:0};break;default:o={scaleX:null!==(r=null==l?void 0:l.scaleX)&&void 0!==r?r:1,scaleY:null!==(a=null==l?void 0:l.scaleY)&&void 0!==a?a:1},s={scaleX:0,scaleY:0}}this.props=s,this.from=o,this.to=s}},{key:"onEnd",value:function(t){_(e,"onEnd",this,3)([t])}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag()}}])}(zP),QB=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"update",value:function(t,e,i){var n=this;if(this.onStart(),this.props&&this.propKeys){var r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((function(t,e){if(n.animate.validAttr(n.propKeys[e])){var i=n.propKeys[e];t(i,n.fromProps[i],n.props[i],r,n,n.target)}})),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}}])}(zP),$B=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o,s,l,u,c,h,d;_(e,"onBind",this,3)([]);var p=this.target.getFinalAttribute(),f=(null===(t=this.params)||void 0===t?void 0:t.direction)||"right",v=(null===(i=this.params)||void 0===i?void 0:i.distance)||50,g=null!==(r=null===(n=this.params)||void 0===n?void 0:n.fromOpacity)&&void 0!==r?r:0,y={opacity:g,baseOpacity:g},m={opacity:1,baseOpacity:1};"top"===f?(y.y=(null!==(a=p.y)&&void 0!==a?a:0)-v,m.y=null!==(o=p.y)&&void 0!==o?o:0,this.propKeys=["opacity","baseOpacity","y"]):"bottom"===f?(y.y=(null!==(s=p.y)&&void 0!==s?s:0)+v,m.y=null!==(l=p.y)&&void 0!==l?l:0,this.propKeys=["opacity","baseOpacity","y"]):"left"===f?(y.x=(null!==(u=p.x)&&void 0!==u?u:0)-v,m.x=null!==(c=p.x)&&void 0!==c?c:0,this.propKeys=["opacity","baseOpacity","x"]):(y.x=(null!==(h=p.x)&&void 0!==h?h:0)+v,m.x=null!==(d=p.x)&&void 0!==d?d:0,this.propKeys=["opacity","baseOpacity","x"]),this.from=y,this.to=m,this.props=m,this.target.setAttributes(y)}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),tR=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o,s;_(e,"onBind",this,3)([]);var l=this.target.getFinalAttribute(),u=null!==(i=null===(t=this.params)||void 0===t?void 0:t.fromScale)&&void 0!==i?i:0,c=(null===(n=this.params)||void 0===n?void 0:n.direction)||"xy",h=null!==(a=null===(r=this.params)||void 0===r?void 0:r.fromOpacity)&&void 0!==a?a:0,d={opacity:h,baseOpacity:h},p={opacity:1,baseOpacity:1};this.propKeys=["opacity","baseOpacity"],"x"!==c&&"xy"!==c||(d.scaleX=u,p.scaleX=null!==(o=l.scaleX)&&void 0!==o?o:1,this.propKeys.push("scaleX")),"y"!==c&&"xy"!==c||(d.scaleY=u,p.scaleY=null!==(s=l.scaleY)&&void 0!==s?s:1,this.propKeys.push("scaleY")),this.from=d,this.to=p,this.props=p,this.target.setAttributes(d)}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),eR=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o,s,l,u;_(e,"onBind",this,3)([]);var c=this.target.getFinalAttribute(),h=null!==(i=null===(t=this.params)||void 0===t?void 0:t.fromAngle)&&void 0!==i?i:2*Math.PI,d=null!==(r=null===(n=this.params)||void 0===n?void 0:n.fromScale)&&void 0!==r?r:0,p=null!==(o=null===(a=this.params)||void 0===a?void 0:a.fromOpacity)&&void 0!==o?o:0,f={opacity:p,baseOpacity:p,angle:h,scaleX:d,scaleY:d},v={opacity:1,baseOpacity:1,angle:null!==(s=c.angle)&&void 0!==s?s:0,scaleX:null!==(l=c.scaleX)&&void 0!==l?l:1,scaleY:null!==(u=c.scaleY)&&void 0!==u?u:1};this.propKeys=["opacity","baseOpacity","angle","scaleX","scaleY"],this.from=f,this.to=v,this.props=v,this.target.setAttributes(f)}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),iR=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).perimeter=0,l.originalAttributes={},l}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m;if(_(e,"onBind",this,3)([]),this.originalAttributes=Object.assign({},this.target.getAttributes()),"rect"===this.target.type){var b=this.target.attribute,x=null!==(t=b.width)&&void 0!==t?t:100,k=null!==(i=b.height)&&void 0!==i?i:100;this.perimeter=2*(x+k)}else if("circle"===this.target.type){var S=null!==(n=this.target.attribute.radius)&&void 0!==n?n:50;this.perimeter=2*Math.PI*S}else if("ellipse"===this.target.type){var A=this.target.attribute,M=null!==(r=A.radiusX)&&void 0!==r?r:50,T=null!==(a=A.radiusY)&&void 0!==a?a:50;this.perimeter=2*Math.PI*Math.sqrt((M*M+T*T)/2)}else this.perimeter=1e3;var w=null!==(s=null===(o=this.params)||void 0===o?void 0:o.lineWidth)&&void 0!==s?s:2,C=null!==(u=null===(l=this.params)||void 0===l?void 0:l.strokeColor)&&void 0!==u?u:"black",E=null!==(h=null===(c=this.params)||void 0===c?void 0:c.fromOpacity)&&void 0!==h?h:1,P=null!==(p=null===(d=this.params)||void 0===d?void 0:d.dashLength)&&void 0!==p?p:this.perimeter,B=null!==(v=null===(f=this.params)||void 0===f?void 0:f.showFill)&&void 0!==v&&v,R=null!==(y=null===(g=this.params)||void 0===g?void 0:g.fillOpacity)&&void 0!==y?y:0;this.from={lineDash:[P,P],lineDashOffset:P,lineWidth:w,stroke:C,strokeOpacity:E},this.to={lineDash:[P,P],lineDashOffset:0,lineWidth:w,stroke:C,strokeOpacity:E},B?(this.from.fillOpacity=R,this.to.fillOpacity=null!==(m=this.originalAttributes.fillOpacity)&&void 0!==m?m:1):(this.from.fillOpacity=0,this.to.fillOpacity=0),this.propKeys=["lineDash","lineDashOffset","lineWidth","stroke","strokeOpacity","fillOpacity"],this.props=this.to,this.target.setAttributes(this.from)}},{key:"onUpdate",value:function(t,e,i){var n,r=this.target.attribute;r.lineDashOffset=this.from.lineDashOffset+(this.to.lineDashOffset-this.from.lineDashOffset)*e,(null===(n=this.params)||void 0===n?void 0:n.showFill)&&(r.fillOpacity=this.from.fillOpacity+(this.to.fillOpacity-this.from.fillOpacity)*e)}},{key:"onEnd",value:function(){var t;if(_(e,"onEnd",this,3)([]),!(null===(t=this.params)||void 0===t?void 0:t.showFill)){var i=Object.assign({},this.originalAttributes);i.fillOpacity=0,this.target.setAttributes(i)}}}])}(zP),nR=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).perimeter=0,l.originalAttributes={},l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v;if(this.originalAttributes=Object.assign({},this.target.getAttributes()),"rect"===this.target.type){var g=this.target.attribute,y=null!==(t=g.width)&&void 0!==t?t:100,m=null!==(e=g.height)&&void 0!==e?e:100;this.perimeter=2*(y+m)}else if("circle"===this.target.type){var _=null!==(i=this.target.attribute.radius)&&void 0!==i?i:50;this.perimeter=2*Math.PI*_}else if("ellipse"===this.target.type){var b=this.target.attribute,x=null!==(n=b.radiusX)&&void 0!==n?n:50,k=null!==(r=b.radiusY)&&void 0!==r?r:50;this.perimeter=2*Math.PI*Math.sqrt((x*x+k*k)/2)}else this.perimeter=1e3;var S=null!==(o=null===(a=this.params)||void 0===a?void 0:a.lineWidth)&&void 0!==o?o:2,A=null!==(l=null===(s=this.params)||void 0===s?void 0:s.strokeColor)&&void 0!==l?l:"black",M=null!==(c=null===(u=this.params)||void 0===u?void 0:u.fromOpacity)&&void 0!==c?c:1,T=null!==(d=null===(h=this.params)||void 0===h?void 0:h.dashLength)&&void 0!==d?d:this.perimeter,w=null!==(f=null===(p=this.params)||void 0===p?void 0:p.showFill)&&void 0!==f&&f;this.from={lineDash:[T,T],lineDashOffset:0,lineWidth:S,stroke:A,strokeOpacity:M},this.to={lineDash:[T,T],lineDashOffset:-T,lineWidth:S,stroke:A,strokeOpacity:M},w?(this.from.fillOpacity=null!==(v=this.originalAttributes.fillOpacity)&&void 0!==v?v:1,this.to.fillOpacity=0):(this.from.fillOpacity=0,this.to.fillOpacity=0),this.propKeys=["lineDash","lineDashOffset","lineWidth","stroke","strokeOpacity","fillOpacity"],this.props=this.to,this.target.setAttributes(this.from)}},{key:"onUpdate",value:function(t,e,i){var n,r=this.target.attribute;r.lineDashOffset=this.from.lineDashOffset+(this.to.lineDashOffset-this.from.lineDashOffset)*e,(null===(n=this.params)||void 0===n?void 0:n.showFill)&&(r.fillOpacity=this.from.fillOpacity+(this.to.fillOpacity-this.from.fillOpacity)*e)}}])}(zP),rR=function(t){function e(t,i,a,o,s){var l,u;r(this,e),l=n(this,e,[t,i,a,o,s]);var c=null!==(u=null==s?void 0:s.slideRatio)&&void 0!==u?u:.5;return l.slideInDuration=a*c,l.growInDuration=a*(1-c),l}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o;_(e,"onBind",this,3)([]);var s=new wP(this.target);s.execute({type:"custom",custom:$B,customParameters:{direction:(null===(t=this.params)||void 0===t?void 0:t.slideDirection)||"right",distance:(null===(i=this.params)||void 0===i?void 0:i.slideDistance)||50,fromOpacity:null!==(r=null===(n=this.params)||void 0===n?void 0:n.fromOpacity)&&void 0!==r?r:0},duration:this.slideInDuration,easing:this.easing}),s.execute({type:"custom",custom:tR,customParameters:{fromScale:(null===(a=this.params)||void 0===a?void 0:a.fromScale)||.5,direction:(null===(o=this.params)||void 0===o?void 0:o.scaleDirection)||"xy",fromOpacity:1},duration:this.growInDuration,easing:this.easing,delay:this.slideInDuration})}},{key:"onUpdate",value:function(t,e,i){}}])}(zP),aR=function(t){function e(t,i,a,o,s){var l,u;r(this,e),l=n(this,e,[t,i,a,o,s]);var c=null!==(u=null==s?void 0:s.slideRatio)&&void 0!==u?u:.5;return l.slideInDuration=a*c,l.spinInDuration=a*(1-c),l}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n,r,a,o;_(e,"onBind",this,3)([]);var s=new wP(this.target);s.execute({type:"custom",custom:$B,customParameters:{direction:(null===(t=this.params)||void 0===t?void 0:t.slideDirection)||"right",distance:(null===(i=this.params)||void 0===i?void 0:i.slideDistance)||50,fromOpacity:null!==(r=null===(n=this.params)||void 0===n?void 0:n.fromOpacity)&&void 0!==r?r:0},duration:this.slideInDuration,easing:this.easing}),s.execute({type:"custom",custom:eR,customParameters:{fromAngle:(null===(a=this.params)||void 0===a?void 0:a.fromAngle)||Math.PI,fromScale:(null===(o=this.params)||void 0===o?void 0:o.fromScale)||.5,fromOpacity:1},duration:this.spinInDuration,easing:this.easing,delay:this.slideInDuration})}},{key:"onUpdate",value:function(t,e,i){}}])}(zP),oR=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f=this.target.getAttributes(),v=(null===(t=this.params)||void 0===t?void 0:t.direction)||"right",g=(null===(e=this.params)||void 0===e?void 0:e.distance)||50,y=null!==(n=null===(i=this.params)||void 0===i?void 0:i.fromOpacity)&&void 0!==n?n:1,m=null!==(a=null===(r=this.params)||void 0===r?void 0:r.toOpacity)&&void 0!==a?a:0,_={opacity:y,baseOpacity:y},b={opacity:m,baseOpacity:m};"top"===v?(_.y=null!==(o=f.y)&&void 0!==o?o:0,b.y=(null!==(s=f.y)&&void 0!==s?s:0)-g,this.propKeys=["opacity","baseOpacity","y"]):"bottom"===v?(_.y=null!==(l=f.y)&&void 0!==l?l:0,b.y=(null!==(u=f.y)&&void 0!==u?u:0)+g,this.propKeys=["opacity","baseOpacity","y"]):"left"===v?(_.x=null!==(c=f.x)&&void 0!==c?c:0,b.x=(null!==(h=f.x)&&void 0!==h?h:0)-g,this.propKeys=["opacity","baseOpacity","x"]):(_.x=null!==(d=f.x)&&void 0!==d?d:0,b.x=(null!==(p=f.x)&&void 0!==p?p:0)+g,this.propKeys=["opacity","baseOpacity","x"]),this.from=_,this.to=b,this.props=b}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),sR=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i,n,r,a,o,s,l,u=this.target.getAttributes(),c=null!==(e=null===(t=this.params)||void 0===t?void 0:t.fromScale)&&void 0!==e?e:0,h=(null===(i=this.params)||void 0===i?void 0:i.direction)||"xy",d=null!==(r=null===(n=this.params)||void 0===n?void 0:n.fromOpacity)&&void 0!==r?r:1,p=null!==(o=null===(a=this.params)||void 0===a?void 0:a.toOpacity)&&void 0!==o?o:0,f={opacity:d,baseOpacity:d},v={opacity:p,baseOpacity:p};this.propKeys=["opacity","baseOpacity"],"x"!==h&&"xy"!==h||(f.scaleX=null!==(s=u.scaleX)&&void 0!==s?s:1,v.scaleX=c,this.propKeys.push("scaleX")),"y"!==h&&"xy"!==h||(f.scaleY=null!==(l=u.scaleY)&&void 0!==l?l:1,v.scaleY=c,this.propKeys.push("scaleY")),this.from=f,this.to=v,this.props=v}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),lR=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h=this.target.getAttributes(),d=null!==(e=null===(t=this.params)||void 0===t?void 0:t.fromAngle)&&void 0!==e?e:2*Math.PI,p=null!==(n=null===(i=this.params)||void 0===i?void 0:i.fromScale)&&void 0!==n?n:0,f=null!==(a=null===(r=this.params)||void 0===r?void 0:r.fromOpacity)&&void 0!==a?a:1,v=null!==(s=null===(o=this.params)||void 0===o?void 0:o.toOpacity)&&void 0!==s?s:0,g={opacity:f,baseOpacity:f,angle:null!==(l=h.angle)&&void 0!==l?l:0,scaleX:null!==(u=h.scaleX)&&void 0!==u?u:1,scaleY:null!==(c=h.scaleY)&&void 0!==c?c:1},y={opacity:v,baseOpacity:v,angle:d,scaleX:p,scaleY:p};this.propKeys=["opacity","baseOpacity","angle","scaleX","scaleY"],this.from=g,this.to=y,this.props=y}},{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),uR=function(t){function e(t,i,a,o,s){var l,u;r(this,e),l=n(this,e,[t,i,a,o,s]);var c=null!==(u=null==s?void 0:s.slideRatio)&&void 0!==u?u:.5;return l.growOutDuration=a*(1-c),l.slideOutDuration=a*c,l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i,n,r=new wP(this.target);r.execute({type:"custom",custom:sR,customParameters:{fromScale:(null===(t=this.params)||void 0===t?void 0:t.fromScale)||.5,direction:(null===(e=this.params)||void 0===e?void 0:e.scaleDirection)||"xy",fromOpacity:1,toOpacity:1},duration:this.growOutDuration,easing:this.easing}),r.execute({type:"custom",custom:oR,customParameters:{direction:(null===(i=this.params)||void 0===i?void 0:i.slideDirection)||"right",distance:(null===(n=this.params)||void 0===n?void 0:n.slideDistance)||50,fromOpacity:1},duration:this.slideOutDuration,easing:this.easing,delay:this.growOutDuration})}},{key:"onUpdate",value:function(t,e,i){}}])}(zP),cR=function(t){function e(t,i,a,o,s){var l,u;r(this,e),l=n(this,e,[t,i,a,o,s]);var c=null!==(u=null==s?void 0:s.slideRatio)&&void 0!==u?u:.5;return l.spinOutDuration=a*(1-c),l.slideOutDuration=a*c,l}return h(e,t),o(e,[{key:"onFirstRun",value:function(){var t,e,i,n,r=new wP(this.target);r.execute({type:"custom",custom:lR,customParameters:{fromAngle:(null===(t=this.params)||void 0===t?void 0:t.fromAngle)||Math.PI,fromScale:(null===(e=this.params)||void 0===e?void 0:e.fromScale)||.5,fromOpacity:1,toOpacity:1},duration:this.spinOutDuration,easing:this.easing}),r.execute({type:"custom",custom:oR,customParameters:{direction:(null===(i=this.params)||void 0===i?void 0:i.slideDirection)||"right",distance:(null===(n=this.params)||void 0===n?void 0:n.slideDistance)||50,fromOpacity:1},duration:this.slideOutDuration,easing:this.easing,delay:this.spinOutDuration})}},{key:"onUpdate",value:function(t,e,i){}}])}(zP),hR=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).originalAttributes={},l.pulseCount=3,l.pulseOpacity=.3,l.pulseScale=1.05,l.pulseColor=null,l.pulseColorIntensity=.2,l.strokeOnly=!1,l.fillOnly=!1,l.useScale=!0,l.useOpacity=!0,l.useStroke=!0,l.useFill=!0,l.useColor=!1,l.originalFill=null,l.originalStroke=null,void 0!==(null==s?void 0:s.pulseCount)&&(l.pulseCount=s.pulseCount),void 0!==(null==s?void 0:s.pulseScale)&&(l.pulseScale=s.pulseScale),void 0!==(null==s?void 0:s.pulseColor)&&(l.pulseColor=s.pulseColor),void 0!==(null==s?void 0:s.pulseColorIntensity)&&(l.pulseColorIntensity=s.pulseColorIntensity),void 0!==(null==s?void 0:s.strokeOnly)&&(l.strokeOnly=s.strokeOnly),void 0!==(null==s?void 0:s.fillOnly)&&(l.fillOnly=s.fillOnly),void 0!==(null==s?void 0:s.useScale)&&(l.useScale=s.useScale),void 0!==(null==s?void 0:s.useOpacity)&&(l.useOpacity=s.useOpacity),void 0!==(null==s?void 0:s.useStroke)&&(l.useStroke=s.useStroke),void 0!==(null==s?void 0:s.useFill)&&(l.useFill=s.useFill),void 0!==(null==s?void 0:s.useColor)&&(l.useColor=s.useColor),l}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]),this.originalAttributes=Object.assign({},this.target.getAttributes()),this.useColor&&(this.originalFill=this.originalAttributes.fill||null,this.originalStroke=this.originalAttributes.stroke||null,this.pulseColor||(this.fillOnly&&this.originalFill?this.pulseColor=this.originalFill:this.strokeOnly&&this.originalStroke?this.pulseColor=this.originalStroke:this.originalFill?this.pulseColor=this.originalFill:this.originalStroke?this.pulseColor=this.originalStroke:this.pulseColor="#FFFFFF"))}},{key:"onUpdate",value:function(t,e,i){var n=e*Math.PI*this.pulseCount,r=Math.abs(Math.sin(n)),a=this.target.attribute;if(this.useOpacity){var o=1+(this.pulseOpacity-1)*r;this.useStroke&&(a.strokeOpacity=(this.originalAttributes.strokeOpacity||1)*o),this.useFill&&(a.fillOpacity=(this.originalAttributes.fillOpacity||1)*o)}if(this.useScale){var s=1+(this.pulseScale-1)*r;a.scaleX=(this.originalAttributes.scaleX||1)*s,a.scaleY=(this.originalAttributes.scaleY||1)*s}this.useColor&&this.pulseColor&&this.applyColorPulse(a,r),this.target.addUpdateShapeAndBoundsTag(),this.target.addUpdatePositionTag()}},{key:"applyColorPulse",value:function(t,e){var i=this.pulseColorIntensity*e;this.useFill&&this.originalFill&&this.pulseColor&&(t.fill=xf(this.originalFill,this.pulseColor,i,!0)),this.useStroke&&this.originalStroke&&this.pulseColor&&(t.stroke=xf(this.originalStroke,this.pulseColor,i,!0))}},{key:"onEnd",value:function(){_(e,"onEnd",this,3)([]),this.target.setAttributes(this.originalAttributes)}}])}(zP),dR=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i;_(e,"onBind",this,3)([]);var n=(null!==(t=this.target.context)&&void 0!==t?t:{}).diffAttrs,r=void 0===n?{}:n,a=this.params.options;r=Object.assign({},r),(null===(i=null==a?void 0:a.excludeChannels)||void 0===i?void 0:i.length)&&a.excludeChannels.forEach((function(t){delete r[t]})),this.props=r}},{key:"update",value:function(t,e,i){var n=this;if(this.onStart(),this.props&&this.propKeys){var r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((function(t,e){if(n.animate.validAttr(n.propKeys[e])){var i=n.propKeys[e];t(i,n.fromProps[i],n.props[i],r,n,n.target)}})),this.onUpdate(t,r,i)}}}])}(zP),pR=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),fR=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t;_(e,"onBind",this,3)([]);var i=function(t,e,i){var n,r,a,o,s=null!=e?e:{},l=s.offset,u=void 0===l?0:l,c=s.orient,h=s.direction,d=s.point,p=s.excludeChannels,f=void 0===p?[]:p,v=s.layoutRect,g=void 0===v?{}:v,y=0,m=0;"negative"===c&&(y=null!==(n=g.width)&&void 0!==n?n:t.stage.viewWidth,m=null!==(r=g.height)&&void 0!==r?r:t.stage.viewHeight),y+=u,m+=u;var _=V(d)?d.call(null,null===(o=null===(a=t.context)||void 0===a?void 0:a.data)||void 0===o?void 0:o[0],t,i):d,b=t.getGraphicAttribute("x"),x=t.getGraphicAttribute("y"),k=f.includes("x")?b:_&&et(_.x)?_.x:y,S=f.includes("y")?x:_&&et(_.y)?_.y:m;switch(h){case"x":return{from:{x:f.includes("x")?b:k},to:{x:b}};case"y":return{from:{y:S},to:{y:x}};default:return{from:{x:k,y:S},to:{x:b,y:x}}}}(this.target,this.params.options,this.params),n=i.from,r=i.to;this.props=r,this.propKeys=Object.keys(r).filter((function(t){return null!=r[t]})),this.from=n,this.to=r;var a=this.target.getFinalAttribute();a&&this.target.setAttributes(a),!1!==(null===(t=this.params.controlOptions)||void 0===t?void 0:t.immediatelyApply)&&this.target.setAttributes(n)}}])}(pR),vR=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=function(t,e,i){var n,r,a,o,s=null!=e?e:{},l=s.offset,u=void 0===l?0:l,c=s.orient,h=s.direction,d=s.point,p=i.group?i.group.AABBBounds:null,f=null!==(n=p.width())&&void 0!==n?n:i.width,v=null!==(r=p.height())&&void 0!==r?r:i.height,g=("negative"===c?f:0)+u,y=("negative"===c?v:0)+u,m=V(d)?d.call(null,null===(o=null===(a=t.context)||void 0===a?void 0:a.data)||void 0===o?void 0:o[0],t,i):d,_=m&&et(m.x)?m.x:g,b=m&&et(m.y)?m.y:y;switch(h){case"x":return{from:{x:t.getGraphicAttribute("x")},to:{x:_}};case"y":return{from:{y:t.getGraphicAttribute("y")},to:{y:b}};default:return{from:{x:t.getGraphicAttribute("x"),y:t.getGraphicAttribute("y")},to:{x:_,y:b}}}}(this.target,this.params.options,this.params),i=t.from,n=t.to;this.props=n,this.propKeys=Object.keys(n).filter((function(t){return null!=n[t]})),this.from=i,this.to=n}}])}(pR),gR=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"onUpdate",value:function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}])}(zP),yR=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t;_(e,"onBind",this,3)([]);var i=function(t,e){var i,n=null!==(i=t.getFinalAttribute().angle)&&void 0!==i?i:0;return{from:{angle:Ut(n/(2*Math.PI),0)?Math.round(n/(2*Math.PI))*Math.PI*2:et(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(n/(2*Math.PI))*Math.PI*2:Math.floor(n/(2*Math.PI))*Math.PI*2},to:{angle:n}}}(this.target,this.params.options),n=i.from,r=i.to;this.props=r,this.propKeys=["angle"],this.from=n,this.to=r;var a=this.target.getFinalAttribute();a&&this.target.setAttributes(a),!1!==(null===(t=this.params.controlOptions)||void 0===t?void 0:t.immediatelyApply)&&this.target.setAttributes(n)}}])}(gR),mR=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){_(e,"onBind",this,3)([]);var t=function(t,e){var i,n=null!==(i=t.getFinalAttribute().angle)&&void 0!==i?i:0;return{from:{angle:n},to:{angle:Ut(n/(2*Math.PI),0)?Math.round(n/(2*Math.PI))*Math.PI*2:et(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(n/(2*Math.PI))*Math.PI*2:Math.floor(n/(2*Math.PI))*Math.PI*2}}}(this.target,this.params.options),i=t.from,n=t.to;this.props=n,this.propKeys=["angle"],this.from=i,this.to=n}}])}(gR),_R=function(t){function e(t,i,a,o,s){var l,u;return r(this,e),l=n(this,e,[t,i,a,o,s]),s&&(l.pathLength=s.path.getLength(),l.path=s.path,l.distance=s.distance,l.totalLength=l.distance*l.pathLength,l.initAngle=null!==(u=s.initAngle)&&void 0!==u?u:0,l.changeAngle=!!s.changeAngle,l.cb=s.cb),l}return h(e,t),o(e,[{key:"onBind",value:function(){this.from={x:0,y:0},this.to=this.path.getAttrAt(this.totalLength).pos,this.props=this.to}},{key:"onUpdate",value:function(t,e,i){var n={},r=this.totalLength*e,a=this.path.getAttrAt(r),o=a.pos,s=a.angle;n.x=o.x,n.y=o.y,this.changeAngle&&(n.angle=s+this.initAngle),this.cb&&this.cb(this.from,this.to,e,this.target),this.target.setAttributes(n)}}])}(zP),bR=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).from=null!=t?t:{},l}return h(e,t),o(e,[{key:"onBind",value:function(){var t,i,n=this;_(e,"onBind",this,3)([]),Object.keys(this.from).forEach((function(t){null==n.props[t]&&(n.props[t]=n.target.getGraphicAttribute(t))}));var r=this.target.getFinalAttribute();"appear"===(null===(t=this.target.context)||void 0===t?void 0:t.animationState)&&r&&this.target.setAttributes(r),!1!==(null===(i=this.params.controlOptions)||void 0===i?void 0:i.immediatelyApply)&&this.target.setAttributes(this.from)}},{key:"onFirstRun",value:function(){var t=this;this.from=Object.assign(Object.assign({},this.getLastProps()),this.from);var e=this.animate.getStartProps();this.propKeys&&this.propKeys.forEach((function(i){var n;t.from[i]=null!==(n=t.from[i])&&void 0!==n?n:e[i]})),this.target.setAttributes(this.from)}},{key:"deleteSelfAttr",value:function(t){_(e,"deleteSelfAttr",this,3)([t]),delete this.from[t]}},{key:"update",value:function(t,e,i){var n=this;if(this.onStart(),this.props&&this.propKeys){var r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.from,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((function(t,e){if(n.animate.validAttr(n.propKeys[e])){var i=n.propKeys[e];t(i,n.from[i],n.props[i],r,n,n.target)}})),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}}])}(zP),xR=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"getEndProps",value:function(){return{}}},{key:"onStart",value:function(){this.target&&("rect"===this.target.type?this.onStartRect():"line"===this.target.type?this.onStartLineOrArea("line"):"area"===this.target.type&&this.onStartLineOrArea("area"))}},{key:"onStartLineOrArea",value:function(t){var e,i=this.target.attachShadow(),n=al.graphicService.creator[t](Object.assign({},null===(e=this.params)||void 0===e?void 0:e.attribute));this[t]=n,n.pathProxy=new Mu,i.add(n)}},{key:"onStartRect",value:function(){var t,e,i,n=this.target.attachShadow(),r=null===(e=null===(t=this.params)||void 0===t?void 0:t.isHorizontal)||void 0===e||e,a=r?"height":"width",o=r?"width":"height",s=this.target.AABBBounds[a](),u=r?0:this.target.AABBBounds.y1,c=al.graphicService.creator.rect(Object.assign(Object.assign(l(l(l(l({},a,s),"fill","#bcdeff"),"shadowBlur",30),"shadowColor","#bcdeff"),null===(i=this.params)||void 0===i?void 0:i.attribute),l({x:0,y:u},o,0)));this.rect=c,n.add(c)}},{key:"onBind",value:function(){}},{key:"onEnd",value:function(){this.target.detachShadow()}},{key:"onUpdate",value:function(t,e,i){return this.rect?this.onUpdateRect(t,e,i):this.line||this.area?this.onUpdateLineOrArea(t,e,i):void 0}},{key:"onUpdateRect",value:function(t,e,i){var n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_=null===(r=null===(n=this.params)||void 0===n?void 0:n.isHorizontal)||void 0===r||r,b=this.target.attribute;if(_){var x=null!==(o=null!==(a=b.width)&&void 0!==a?a:Math.abs(b.x1-b.x))&&void 0!==o?o:250,k=null!==(l=null===(s=this.params)||void 0===s?void 0:s.streamLength)&&void 0!==l?l:x,S=null!==(h=null===(c=null===(u=this.params)||void 0===u?void 0:u.attribute)||void 0===c?void 0:c.width)&&void 0!==h?h:60,A=-S,M=A+(k-A)*e,T=Math.max(M,0),w=Math.min(Math.min(M+S,S),k-M),C=w+T>x?Math.max(x-T,0):w;this.rect.setAttributes({x:T+Math.min(b.x1-b.x,0),width:C},!1,{type:kl.ANIMATE_PLAY,animationState:{ratio:e,end:t}})}else{var E,P=null!==(p=null!==(d=b.height)&&void 0!==d?d:Math.abs(b.y1-b.y))&&void 0!==p?p:250,B=null!==(v=null===(f=this.params)||void 0===f?void 0:f.streamLength)&&void 0!==v?v:P,R=null!==(m=null===(y=null===(g=this.params)||void 0===g?void 0:g.attribute)||void 0===y?void 0:y.height)&&void 0!==m?m:60,L=P-(B+R)*e,I=Math.min(L,P),D=Math.min(P-L,R);I<=0?(E=Math.max(I+D,0),I=0):E=D,this.rect.setAttributes({y:I+Math.min(b.y1-b.y,0),height:E},!1,{type:kl.ANIMATE_PLAY,animationState:{ratio:e,end:t}})}}},{key:"onUpdateLineOrArea",value:function(t,e,i){var n=this.line||this.area;if(n){var r=n.pathProxy,a=this.target;a.cache||a.cacheArea?this._onUpdateLineOrAreaWithCache(r,a,t,e,i):this._onUpdateLineWithoutCache(r,a,t,e,i);var o=a.attribute;n.setAttributes(Object.assign({stroke:o.stroke},n.attribute)),n.addUpdateBoundTag()}}},{key:"_onUpdateLineOrAreaWithCache",value:function(t,e,i,n,r){var a,o;if(t.clear(),"line"===e.type){var s=e.cache;Array.isArray(s)||(s=[s]);var l=s.reduce((function(t,e){return t+e.getLength()}),0),u=[];return s.forEach((function(t){t.curves.forEach((function(t){return u.push(t)}))})),this._updateCurves(t,u,l,n)}if("area"===e.type&&(null===(o=null===(a=e.cacheArea)||void 0===a?void 0:a.top)||void 0===o?void 0:o.curves)){var c=e.cacheArea,h=c.top.curves.reduce((function(t,e){return t+e.getLength()}),0);return this._updateCurves(t,c.top.curves,h,n)}}},{key:"_updateCurves",value:function(t,e,i,n){for(var r,a,o=i*n,s=Math.min(o+(null!==(a=null===(r=this.params)||void 0===r?void 0:r.streamLength)&&void 0!==a?a:10),i),l=0,u=!1,c=0;c<e.length;c++)if(!1!==e[c].defined){var h=e[c],d=h.getLength(),p=1-(l+d-o)/d,f=void 0,v=1-(l+d-s)/d;if(l<o&&l+d>o)if(u=!0,h.p2&&h.p3){var g=m(jl(h,p),2);g[0];var y=g[1];t.moveTo(y.p0.x,y.p0.y),f=y}else{var _=h.getPointAt(p);t.moveTo(_.x,_.y)}if(l<s&&l+d>s){if(h.p2&&h.p3){f&&(v=(s-o)/f.getLength());var b=m(jl(f||h,v),1)[0];t.bezierCurveTo(b.p1.x,b.p1.y,b.p2.x,b.p2.y,b.p3.x,b.p3.y)}else{var x=h.getPointAt(v);t.lineTo(x.x,x.y)}break}if(u)if(h.p2&&h.p3){var k=f||h;t.bezierCurveTo(k.p1.x,k.p1.y,k.p2.x,k.p2.y,k.p3.x,k.p3.y)}else t.lineTo(h.p1.x,h.p1.y);l+=d}}},{key:"_onUpdateLineWithoutCache",value:function(t,e,i,n,r){var a,o,s=e.attribute,l=s.points,u=s.curveType;if(l&&!(l.length<2)&&"linear"===u){for(var c=0,h=1;h<l.length;h++)c+=Oe.distancePP(l[h],l[h-1]);for(var d=c*n,p=Math.min(d+(null!==(o=null===(a=this.params)||void 0===a?void 0:a.streamLength)&&void 0!==o?o:10),c),f=[],v=0,g=1;g<l.length;g++){var y=Oe.distancePP(l[g],l[g-1]);if(v<d&&v+y>d&&f.push(Oe.pointAtPP(l[g-1],l[g],1-(v+y-d)/y)),v<p&&v+y>p){f.push(Oe.pointAtPP(l[g-1],l[g],1-(v+y-p)/y));break}f.length&&f.push(l[g]),v+=y}if(f.length&&!(f.length<2)){t.clear(),t.moveTo(f[0].x,f[0].y);for(var m=1;m<f.length;m++)t.lineTo(f[m].x,f[m].y)}}}}])}(zP),kR=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s])).webglCanvas=null,l.gl=null,l.program=null,l.currentAnimationRatio=0,l.animationTime=0,l}return h(e,t),o(e,[{key:"onUpdate",value:function(t,i,n){_(e,"onUpdate",this,3)([t,i,n]),this.currentAnimationRatio=i,this.animationTime=i*Math.PI*2}},{key:"getAnimationTime",value:function(){return this.currentAnimationRatio>0?this.animationTime:Date.now()/1e3}},{key:"getDurationFromParent",value:function(){return this.duration||1e3}},{key:"initWebGL",value:function(t){try{if(this.webglCanvas=j_.createCanvas({width:t.width,height:t.height,dpr:j_.devicePixelRatio}),!this.webglCanvas)return console.warn("WebGL canvas creation failed"),!1;this.webglCanvas.style.width=t.style.width||"".concat(t.width,"px"),this.webglCanvas.style.height=t.style.height||"".concat(t.height,"px");var e=null;try{(e=this.webglCanvas.getContext("webgl"))||(e=this.webglCanvas.getContext("experimental-webgl"))}catch(t){console.warn("Failed to get WebGL context:",t)}if(this.gl=e,!this.gl)return console.warn("WebGL not supported"),!1;var i=this.getShaderSources();return this.program=this.createShaderProgram(i.vertex,i.fragment),null!==this.program}catch(t){return console.warn("Failed to initialize WebGL:",t),!1}}},{key:"createShaderProgram",value:function(t,e){if(!this.gl)return null;var i=this.createShader(this.gl.VERTEX_SHADER,t),n=this.createShader(this.gl.FRAGMENT_SHADER,e);if(!i||!n)return null;var r=this.gl.createProgram();return r?(this.gl.attachShader(r,i),this.gl.attachShader(r,n),this.gl.linkProgram(r),this.gl.getProgramParameter(r,this.gl.LINK_STATUS)?r:(console.error("Shader program link error:",this.gl.getProgramInfoLog(r)),null)):null}},{key:"createShader",value:function(t,e){if(!this.gl)return null;var i=this.gl.createShader(t);return i?(this.gl.shaderSource(i,e),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)?i:(console.error("Shader compile error:",this.gl.getShaderInfoLog(i)),this.gl.deleteShader(i),null)):null}},{key:"setupWebGLState",value:function(t){this.gl&&this.webglCanvas&&(this.webglCanvas.width===t.width&&this.webglCanvas.height===t.height||(this.webglCanvas.width=t.width,this.webglCanvas.height=t.height),this.gl.viewport(0,0,this.webglCanvas.width,this.webglCanvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT))}},{key:"createFullScreenQuad",value:function(){if(!this.gl)return null;var t=new Float32Array([-1,-1,0,1,1,-1,1,1,-1,1,0,0,1,1,1,0]),e=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW),e}},{key:"createTextureFromCanvas",value:function(t){if(!this.gl)return null;var e=this.gl.createTexture();return this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),e}},{key:"setupVertexAttributes",value:function(){if(this.gl&&this.program){var t=this.gl.getAttribLocation(this.program,"a_position"),e=this.gl.getAttribLocation(this.program,"a_texCoord");this.gl.enableVertexAttribArray(t),this.gl.vertexAttribPointer(t,2,this.gl.FLOAT,!1,16,0),this.gl.enableVertexAttribArray(e),this.gl.vertexAttribPointer(e,2,this.gl.FLOAT,!1,16,8)}}},{key:"createOutputCanvas",value:function(t){var e=j_.createCanvas({width:t.width,height:t.height,dpr:j_.devicePixelRatio}),i=e.getContext("2d");return i?(i.clearRect(0,0,t.width,t.height),i.drawImage(t,0,0),{canvas:e,ctx:i}):null}},{key:"getShaderSources",value:function(){return null}},{key:"applyWebGLEffect",value:function(t){return null}},{key:"applyCanvas2DEffect",value:function(t){return null}},{key:"supportsWebGL",value:function(){return null!==this.getShaderSources()}},{key:"supportsCanvas2D",value:function(){return this.applyCanvas2DEffect!==e.prototype.applyCanvas2DEffect}},{key:"release",value:function(){_(e,"release",this,3)([]),this.gl&&(this.program&&(this.gl.deleteProgram(this.program),this.program=null),this.gl=null),this.webglCanvas&&(this.webglCanvas=null),this.currentAnimationRatio=0,this.animationTime=0}},{key:"afterStageRender",value:function(t,e){var i=null;if(this.supportsWebGL()&&(this.gl||this.initWebGL(e)||console.warn("WebGL初始化失败，尝试Canvas 2D回退"),this.gl)){if(i=this.applyWebGLEffect(e))return i;console.warn("WebGL特效执行失败，尝试Canvas 2D回退")}if(this.supportsCanvas2D()){if(i=this.applyCanvas2DEffect(e))return i;console.warn("Canvas 2D特效执行失败")}return this.supportsWebGL()||this.supportsCanvas2D()||console.error("特效类 ".concat(this.constructor.name," 未实现任何渲染方法。请实现 applyWebGLEffect 或 applyCanvas2DEffect 方法。")),e}}])}(NP),SR=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"getShaderSources",value:function(){return null}},{key:"applyWebGLEffect",value:function(t){return null}}])}(kR),AR=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"getShaderSources",value:function(){return null}},{key:"applyWebGLEffect",value:function(t){return null}},{key:"applyCanvas2DEffect",value:function(t){return null}},{key:"supportsWebGL",value:function(){return this.getShaderSources!==e.prototype.getShaderSources&&null!==this.getShaderSources()}},{key:"supportsCanvas2D",value:function(){return this.applyCanvas2DEffect!==e.prototype.applyCanvas2DEffect}},{key:"afterStageRender",value:function(t,e){var i,n,r=null;if(!1!==(null===(n=null===(i=this.params)||void 0===i?void 0:i.options)||void 0===n?void 0:n.useWebGL)){if(this.supportsWebGL()&&(this.gl||this.initWebGL(e)||console.warn("WebGL初始化失败，尝试Canvas 2D回退"),this.gl)){if(r=this.applyWebGLEffect(e))return r;console.warn("WebGL特效执行失败，尝试Canvas 2D回退")}if(this.supportsCanvas2D()){if(r=this.applyCanvas2DEffect(e))return r;console.warn("Canvas 2D特效执行失败")}}else if(this.supportsCanvas2D()){if(r=this.applyCanvas2DEffect(e))return r;console.warn("Canvas 2D特效执行失败")}else console.warn("".concat(this.constructor.name,": useWebGL=false 但未实现Canvas 2D方法"));return this.supportsWebGL()||this.supportsCanvas2D()||console.error("特效类 ".concat(this.constructor.name," 未实现任何渲染方法。请实现 applyWebGLEffect 或 applyCanvas2DEffect 方法。")),e}}])}(kR),MR=function(){return o((function t(){r(this,t)}),null,[{key:"createTempCanvas",value:function(t,e,i){return j_.createCanvas({width:t,height:e,dpr:i||j_.devicePixelRatio})}},{key:"cloneImageData",value:function(t){var e=new Uint8ClampedArray(t.data);return new ImageData(e,t.width,t.height)}},{key:"lerp",value:function(t,e,i){return t*(1-i)+e*i}},{key:"smoothstep",value:function(t,e,i){var n=Math.max(0,Math.min(1,(i-t)/(e-t)));return n*n*(3-2*n)}},{key:"distance",value:function(t,e,i,n){var r=i-t,a=n-e;return Math.sqrt(r*r+a*a)}},{key:"normalizeAngle",value:function(t){return(t+Math.PI)/(2*Math.PI)}},{key:"pixelNoise",value:function(t,e,i){if(i<=0)return 0;var n=Math.floor(t/i)*i,r=Math.floor(e/i)*i,a=43758.5453*Math.sin(12.9898*n+78.233*r);return a-Math.floor(a)}},{key:"generateNoiseTexture",value:function(t,e){for(var i=new Uint8Array(t*e),n=0;n<i.length;n++)i[n]=Math.floor(256*Math.random());return i}},{key:"applyCSSFilter",value:function(t,e){var i=this.createTempCanvas(t.width,t.height),n=i.getContext("2d");return n?(n.filter=e,n.drawImage(t,0,0),n.filter="none",i):t}},{key:"extractChannel",value:function(t,e){for(var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length),o=0;o<i.length;o+=4)a[o]=0,a[o+1]=0,a[o+2]=0,a[o+3]=i[o+3],e>=0&&e<=2&&(a[o+e]=i[o+e]);return new ImageData(a,n,r)}},{key:"blendImageData",value:function(t,e,i){for(var n=t.data,r=t.width,a=t.height,o=e.data,s=new Uint8ClampedArray(n.length),l=0;l<n.length;l+=4)s[l]=Math.round(this.lerp(n[l],o[l],i)),s[l+1]=Math.round(this.lerp(n[l+1],o[l+1],i)),s[l+2]=Math.round(this.lerp(n[l+2],o[l+2],i)),s[l+3]=Math.round(this.lerp(n[l+3],o[l+3],i));return new ImageData(s,r,a)}},{key:"getLuminance",value:function(t,e,i){return.299*t+.587*e+.114*i}},{key:"applySepiaToPixel",value:function(t,e,i){return[Math.min(255,.393*t+.769*e+.189*i),Math.min(255,.349*t+.686*e+.168*i),Math.min(255,.272*t+.534*e+.131*i)]}},{key:"calculateDynamicStrength",value:function(t,e){return t*(e/(2*Math.PI))}}])}(),TR=o((function t(){r(this,t)}));TR.STANDARD_VERTEX_SHADER="\n    attribute vec2 a_position;\n    attribute vec2 a_texCoord;\n    varying vec2 v_texCoord;\n\n    void main() {\n      gl_Position = vec4(a_position, 0.0, 1.0);\n      v_texCoord = a_texCoord;\n    }\n  ",TR.SHADER_FUNCTIONS="\n    // 亮度计算函数\n    float luminance(vec3 color) {\n      return dot(color, vec3(0.299, 0.587, 0.114));\n    }\n\n    // 褐色调函数\n    vec3 sepia(vec3 color) {\n      float r = color.r * 0.393 + color.g * 0.769 + color.b * 0.189;\n      float g = color.r * 0.349 + color.g * 0.686 + color.b * 0.168;\n      float b = color.r * 0.272 + color.g * 0.534 + color.b * 0.131;\n      return vec3(r, g, b);\n    }\n\n    // 线性插值函数\n    float lerp(float a, float b, float t) {\n      return a * (1.0 - t) + b * t;\n    }\n\n\n    // 简单噪声函数\n    float pixelNoise(vec2 coord, float pixelSize) {\n      vec2 gridCoord = floor(coord / pixelSize) * pixelSize;\n      return fract(sin(dot(gridCoord, vec2(12.9898, 78.233))) * 43758.5453123);\n    }\n\n    // 动态强度计算\n    float calculateDynamicStrength(float baseStrength, float time) {\n      return baseStrength * (time / 6.28318531); // 2π\n    }\n  ";var wR=function(t){function e(t,i,a,o,s){var l,u,c,h,d;r(this,e),(l=n(this,e,[t,i,a,o,s])).noiseData=null;var p=null===(u=null==s?void 0:s.options)||void 0===u?void 0:u.noiseScale,f=void 0!==p?Math.max(0,Math.floor(p)):8;return l.dissolveConfig={dissolveType:(null===(c=null==s?void 0:s.options)||void 0===c?void 0:c.dissolveType)||"outward",useWebGL:void 0===(null===(h=null==s?void 0:s.options)||void 0===h?void 0:h.useWebGL)||s.options.useWebGL,noiseScale:f,fadeEdge:void 0===(null===(d=null==s?void 0:s.options)||void 0===d?void 0:d.fadeEdge)||s.options.fadeEdge},l}return h(e,t),o(e,[{key:"getShaderSources",value:function(){return{vertex:TR.STANDARD_VERTEX_SHADER,fragment:"\n      precision mediump float;\n      uniform sampler2D u_texture;\n      uniform sampler2D u_noiseTexture;\n      uniform float u_time;\n      uniform int u_dissolveType;\n      uniform vec2 u_resolution;\n      uniform float u_noiseScale;\n      uniform bool u_fadeEdge;\n      varying vec2 v_texCoord;\n\n      ".concat(TR.SHADER_FUNCTIONS,"\n\n      // 向外溶解函数\n      float outwardDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {\n        vec2 center = vec2(0.5, 0.5);\n        float distFromCenter = length(uv - center);\n        float maxDist = length(vec2(0.5, 0.5));\n\n        // 归一化距离 (0为中心，1为边缘)\n        float normalizedDist = distFromCenter / maxDist;\n\n        // 向外溶解：从边缘开始溶解，time控制溶解进度\n        // 增加安全边距，确保动画结束时完全溶解\n        float edgeThreshold = 1.2 - time * 1.5;\n\n        // 当pixelSize > 0时添加颗粒效果\n        if (pixelSize > 0.0) {\n          // 添加基于像素大小的噪声，让边缘呈现颗粒状\n          vec2 pixelCoord = uv * resolution; // 转换为像素坐标\n          float noiseValue = pixelNoise(pixelCoord, pixelSize);\n          float noiseInfluence = (noiseValue - 0.5) * 0.4; // 增强噪声影响\n          edgeThreshold += noiseInfluence;\n          return normalizedDist > edgeThreshold ? 0.0 : 1.0;\n        } else {\n          // 平滑溶解：根据fadeEdge决定是否使用渐变\n          if (u_fadeEdge) {\n            // 柔和边缘：返回渐变值\n            float fadeWidth = 0.15; // 渐变宽度\n            return 1.0 - smoothstep(edgeThreshold - fadeWidth, edgeThreshold, normalizedDist);\n          } else {\n            // 硬边缘：返回0或1\n            return normalizedDist > edgeThreshold ? 0.0 : 1.0;\n          }\n        }\n      }\n\n      // 向内溶解函数\n      float inwardDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {\n        vec2 center = vec2(0.5, 0.5);\n        float distFromCenter = length(uv - center);\n        float maxDist = length(vec2(0.5, 0.5));\n\n        float normalizedDist = distFromCenter / maxDist;\n\n        // 向内溶解：从中心开始溶解，time控制溶解进度\n        // 增加系数，确保动画结束时完全溶解\n        float centerThreshold = time * 1.4;\n\n        // 当pixelSize > 0时添加颗粒效果\n        if (pixelSize > 0.0) {\n          vec2 pixelCoord = uv * resolution;\n          float noiseValue = pixelNoise(pixelCoord, pixelSize);\n          float noiseInfluence = (noiseValue - 0.5) * 0.4;\n          centerThreshold += noiseInfluence;\n          return normalizedDist < centerThreshold ? 0.0 : 1.0;\n        } else {\n          // 平滑溶解：根据fadeEdge决定是否使用渐变\n          if (u_fadeEdge) {\n            // 柔和边缘：返回渐变值\n            float fadeWidth = 0.15; // 渐变宽度\n            return smoothstep(centerThreshold, centerThreshold + fadeWidth, normalizedDist);\n          } else {\n            // 硬边缘：返回0或1\n            return normalizedDist < centerThreshold ? 0.0 : 1.0;\n          }\n        }\n      }\n\n      // 径向溶解函数\n      float radialDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {\n        vec2 center = vec2(0.5, 0.5);\n        float angle = atan(uv.y - center.y, uv.x - center.x);\n        float normalizedAngle = (angle + 3.14159) / (2.0 * 3.14159);\n\n        // 径向溶解：按角度顺序溶解，time控制溶解进度\n        // 增加系数，确保动画结束时完全溶解\n        float angleThreshold = time * 1.2;\n\n        // 当pixelSize > 0时添加颗粒效果\n        if (pixelSize > 0.0) {\n          vec2 pixelCoord = uv * resolution;\n          float noiseValue = pixelNoise(pixelCoord, pixelSize);\n          float noiseInfluence = (noiseValue - 0.5) * 0.3;\n          angleThreshold += noiseInfluence;\n          return normalizedAngle < angleThreshold ? 0.0 : 1.0;\n        } else {\n          // 平滑溶解：根据fadeEdge决定是否使用渐变\n          if (u_fadeEdge) {\n            // 柔和边缘：返回渐变值\n            float fadeWidth = 0.08; // 渐变宽度\n            return smoothstep(angleThreshold, angleThreshold + fadeWidth, normalizedAngle);\n          } else {\n            // 硬边缘：返回0或1\n            return normalizedAngle < angleThreshold ? 0.0 : 1.0;\n          }\n        }\n      }\n\n      // 从左到右溶解函数\n      float leftToRightDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {\n        // 左到右溶解：从x=0开始向x=1溶解\n        float dissolvePosition = time * 1.2; // 增加系数确保完全溶解\n\n        // 当pixelSize > 0时添加颗粒效果\n        if (pixelSize > 0.0) {\n          vec2 pixelCoord = uv * resolution;\n          float noiseValue = pixelNoise(pixelCoord, pixelSize);\n          float noiseInfluence = (noiseValue - 0.5) * 0.3;\n          dissolvePosition += noiseInfluence;\n          return uv.x < dissolvePosition ? 0.0 : 1.0;\n        } else {\n          // 平滑溶解：根据fadeEdge决定是否使用渐变\n          if (u_fadeEdge) {\n            // 柔和边缘：返回渐变值\n            float fadeWidth = 0.08; // 渐变宽度\n            return smoothstep(dissolvePosition, dissolvePosition + fadeWidth, uv.x);\n          } else {\n            // 硬边缘：返回0或1\n            return uv.x < dissolvePosition ? 0.0 : 1.0;\n          }\n        }\n      }\n\n      // 从右到左溶解函数\n      float rightToLeftDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {\n        // 右到左溶解：从x=1开始向x=0溶解\n        float dissolvePosition = 1.0 - time * 1.2; // 增加系数确保完全溶解\n\n        // 当pixelSize > 0时添加颗粒效果\n        if (pixelSize > 0.0) {\n          vec2 pixelCoord = uv * resolution;\n          float noiseValue = pixelNoise(pixelCoord, pixelSize);\n          float noiseInfluence = (noiseValue - 0.5) * 0.3;\n          dissolvePosition += noiseInfluence;\n          return uv.x > dissolvePosition ? 0.0 : 1.0;\n        } else {\n          // 平滑溶解：根据fadeEdge决定是否使用渐变\n          if (u_fadeEdge) {\n            // 柔和边缘：返回渐变值\n            float fadeWidth = 0.08; // 渐变宽度\n            return smoothstep(dissolvePosition - fadeWidth, dissolvePosition, uv.x);\n          } else {\n            // 硬边缘：返回0或1\n            return uv.x > dissolvePosition ? 0.0 : 1.0;\n          }\n        }\n      }\n\n      // 从上到下溶解函数\n      float topToBottomDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {\n        // 上到下溶解：从y=0开始向y=1溶解\n        float dissolvePosition = time * 1.2; // 增加系数确保完全溶解\n\n        // 当pixelSize > 0时添加颗粒效果\n        if (pixelSize > 0.0) {\n          vec2 pixelCoord = uv * resolution;\n          float noiseValue = pixelNoise(pixelCoord, pixelSize);\n          float noiseInfluence = (noiseValue - 0.5) * 0.3;\n          dissolvePosition += noiseInfluence;\n          return uv.y < dissolvePosition ? 0.0 : 1.0;\n        } else {\n          // 平滑溶解：根据fadeEdge决定是否使用渐变\n          if (u_fadeEdge) {\n            // 柔和边缘：返回渐变值\n            float fadeWidth = 0.08; // 渐变宽度\n            return smoothstep(dissolvePosition, dissolvePosition + fadeWidth, uv.y);\n          } else {\n            // 硬边缘：返回0或1\n            return uv.y < dissolvePosition ? 0.0 : 1.0;\n          }\n        }\n      }\n\n      // 从下到上溶解函数\n      float bottomToTopDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {\n        // 下到上溶解：从y=1开始向y=0溶解\n        float dissolvePosition = 1.0 - time * 1.2; // 增加系数确保完全溶解\n\n        // 当pixelSize > 0时添加颗粒效果\n        if (pixelSize > 0.0) {\n          vec2 pixelCoord = uv * resolution;\n          float noiseValue = pixelNoise(pixelCoord, pixelSize);\n          float noiseInfluence = (noiseValue - 0.5) * 0.3;\n          dissolvePosition += noiseInfluence;\n          return uv.y > dissolvePosition ? 0.0 : 1.0;\n        } else {\n          // 平滑溶解：根据fadeEdge决定是否使用渐变\n          if (u_fadeEdge) {\n            // 柔和边缘：返回渐变值\n            float fadeWidth = 0.08; // 渐变宽度\n            return smoothstep(dissolvePosition - fadeWidth, dissolvePosition, uv.y);\n          } else {\n            // 硬边缘：返回0或1\n            return uv.y > dissolvePosition ? 0.0 : 1.0;\n          }\n        }\n      }\n\n      void main() {\n        vec2 uv = v_texCoord;\n        vec4 texColor = texture2D(u_texture, uv);\n\n        float alpha = 1.0;\n\n        // 根据溶解类型选择对应的溶解函数\n        if (u_dissolveType == 0) {\n          alpha = outwardDissolve(uv, u_time, u_noiseScale, u_resolution);\n        } else if (u_dissolveType == 1) {\n          alpha = inwardDissolve(uv, u_time, u_noiseScale, u_resolution);\n        } else if (u_dissolveType == 2) {\n          alpha = radialDissolve(uv, u_time, u_noiseScale, u_resolution);\n        } else if (u_dissolveType == 3) {\n          alpha = leftToRightDissolve(uv, u_time, u_noiseScale, u_resolution);\n        } else if (u_dissolveType == 4) {\n          alpha = rightToLeftDissolve(uv, u_time, u_noiseScale, u_resolution);\n        } else if (u_dissolveType == 5) {\n          alpha = topToBottomDissolve(uv, u_time, u_noiseScale, u_resolution);\n        } else if (u_dissolveType == 6) {\n          alpha = bottomToTopDissolve(uv, u_time, u_noiseScale, u_resolution);\n        }\n\n        gl_FragColor = vec4(texColor.rgb, texColor.a * alpha);\n      }\n    ")}}},{key:"applyWebGLEffect",value:function(t){if(!this.gl||!this.program||!this.webglCanvas)return t;this.setupWebGLState(t);var e=this.createTextureFromCanvas(t);if(!e)return t;this.noiseData||(this.noiseData=MR.generateNoiseTexture(256,256));var i=this.gl.createTexture();this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,256,256,0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,this.noiseData),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);var n=this.createFullScreenQuad();return n?(this.gl.useProgram(this.program),this.setupVertexAttributes(),this.setUniforms(),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.deleteTexture(e),this.gl.deleteTexture(i),this.gl.deleteBuffer(n),this.webglCanvas):t}},{key:"setUniforms",value:function(){if(this.gl&&this.program&&this.webglCanvas){var t=this.gl.getUniformLocation(this.program,"u_texture"),e=this.gl.getUniformLocation(this.program,"u_noiseTexture"),i=this.gl.getUniformLocation(this.program,"u_time"),n=this.gl.getUniformLocation(this.program,"u_dissolveType"),r=this.gl.getUniformLocation(this.program,"u_resolution"),a=this.gl.getUniformLocation(this.program,"u_noiseScale"),o=this.gl.getUniformLocation(this.program,"u_fadeEdge");this.gl.uniform1i(t,0),this.gl.uniform1i(e,1),this.gl.uniform1f(i,this.currentAnimationRatio),this.gl.uniform2f(r,this.webglCanvas.width,this.webglCanvas.height),this.gl.uniform1f(a,this.dissolveConfig.noiseScale),this.gl.uniform1i(o,this.dissolveConfig.fadeEdge?1:0),this.gl.uniform1i(n,{outward:0,inward:1,radial:2,leftToRight:3,rightToLeft:4,topToBottom:5,bottomToTop:6}[this.dissolveConfig.dissolveType]||0)}}},{key:"applyCanvas2DEffect",value:function(t){var e=this.createOutputCanvas(t);if(!e)return t;var i,n=e.canvas,r=e.ctx,a=r.getImageData(0,0,t.width,t.height),o=this.currentAnimationRatio;switch(this.dissolveConfig.dissolveType){case"outward":i=this.applyOutwardDissolve(a,o);break;case"inward":i=this.applyInwardDissolve(a,o);break;case"radial":i=this.applyRadialDissolve(a,o);break;case"leftToRight":i=this.applyLeftToRightDissolve(a,o);break;case"rightToLeft":i=this.applyRightToLeftDissolve(a,o);break;case"topToBottom":i=this.applyTopToBottomDissolve(a,o);break;case"bottomToTop":i=this.applyBottomToTopDissolve(a,o);break;default:i=a}return r.putImageData(i,0,0),n}},{key:"applyOutwardDissolve",value:function(t,e){var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length);a.set(i);for(var o=n/2,s=r/2,l=Math.sqrt(o*o+s*s),u=this.dissolveConfig.noiseScale,c=0;c<r;c++)for(var h=0;h<n;h++){var d=h-o,p=c-s,f=Math.sqrt(d*d+p*p)/l,v=1.2-1.4*e,g=1;if(u>0)g=f>(v+=.4*(MR.pixelNoise(h,c,u)-.5))?0:1;else if(this.dissolveConfig.fadeEdge){var y=v-.15;g=f<y?1:f>v?0:1-(f-y)/(v-y)}else g=f>v?0:1;var m=4*(c*n+h);a[m+3]=Math.floor(a[m+3]*g)}return new ImageData(a,n,r)}},{key:"applyInwardDissolve",value:function(t,e){var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length);a.set(i);for(var o=n/2,s=r/2,l=Math.sqrt(o*o+s*s),u=this.dissolveConfig.noiseScale,c=0;c<r;c++)for(var h=0;h<n;h++){var d=h-o,p=c-s,f=Math.sqrt(d*d+p*p)/l,v=1.4*e,g=1;if(u>0)g=f<(v+=.4*(MR.pixelNoise(h,c,u)-.5))?0:1;else if(this.dissolveConfig.fadeEdge){var y=v+.15;g=f<v?0:f>y?1:(f-v)/(y-v)}else g=f<v?0:1;var m=4*(c*n+h);a[m+3]=Math.floor(a[m+3]*g)}return new ImageData(a,n,r)}},{key:"applyRadialDissolve",value:function(t,e){var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length);a.set(i);for(var o=n/2,s=r/2,l=this.dissolveConfig.noiseScale,u=0;u<r;u++)for(var c=0;c<n;c++){var h=c-o,d=u-s,p=(Math.atan2(d,h)+Math.PI)/(2*Math.PI),f=1.2*e,v=1;if(l>0)v=p<(f+=.3*(MR.pixelNoise(c,u,l)-.5))?0:1;else if(this.dissolveConfig.fadeEdge){var g=f+.08;v=p<f?0:p>g?1:(p-f)/(g-f)}else v=p<f?0:1;var y=4*(u*n+c);a[y+3]=Math.floor(a[y+3]*v)}return new ImageData(a,n,r)}},{key:"applyLeftToRightDissolve",value:function(t,e){var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length);a.set(i);for(var o=this.dissolveConfig.noiseScale,s=0;s<r;s++)for(var l=0;l<n;l++){var u=l/n,c=1.2*e,h=1;if(o>0)h=u<(c+=.3*(MR.pixelNoise(l,s,o)-.5))?0:1;else if(this.dissolveConfig.fadeEdge){var d=c+.08;h=u<c?0:u>d?1:(u-c)/(d-c)}else h=u<c?0:1;var p=4*(s*n+l);a[p+3]=Math.floor(a[p+3]*h)}return new ImageData(a,n,r)}},{key:"applyRightToLeftDissolve",value:function(t,e){var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length);a.set(i);for(var o=this.dissolveConfig.noiseScale,s=0;s<r;s++)for(var l=0;l<n;l++){var u=l/n,c=1-1.2*e,h=1;if(o>0)h=u>(c+=.3*(MR.pixelNoise(l,s,o)-.5))?0:1;else if(this.dissolveConfig.fadeEdge){var d=c-.08;h=u<d?1:u>c?0:1-(u-d)/(c-d)}else h=u>c?0:1;var p=4*(s*n+l);a[p+3]=Math.floor(a[p+3]*h)}return new ImageData(a,n,r)}},{key:"applyTopToBottomDissolve",value:function(t,e){var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length);a.set(i);for(var o=this.dissolveConfig.noiseScale,s=0;s<r;s++)for(var l=0;l<n;l++){var u=s/r,c=1.2*e,h=1;if(o>0)h=u<(c+=.3*(MR.pixelNoise(l,s,o)-.5))?0:1;else if(this.dissolveConfig.fadeEdge){var d=c+.08;h=u<c?0:u>d?1:(u-c)/(d-c)}else h=u<c?0:1;var p=4*(s*n+l);a[p+3]=Math.floor(a[p+3]*h)}return new ImageData(a,n,r)}},{key:"applyBottomToTopDissolve",value:function(t,e){var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i.length);a.set(i);for(var o=this.dissolveConfig.noiseScale,s=0;s<r;s++)for(var l=0;l<n;l++){var u=s/r,c=1-1.2*e,h=1;if(o>0)h=u>(c+=.3*(MR.pixelNoise(l,s,o)-.5))?0:1;else if(this.dissolveConfig.fadeEdge){var d=c-.08;h=u<d?1:u>c?0:1-(u-d)/(c-d)}else h=u>c?0:1;var p=4*(s*n+l);a[p+3]=Math.floor(a[p+3]*h)}return new ImageData(a,n,r)}}])}(AR),CR=function(t){function e(t,i,a,o,s){var l,u,c,h;r(this,e),l=n(this,e,[t,i,a,o,s]);var d=void 0!==(null===(u=null==s?void 0:s.options)||void 0===u?void 0:u.strength)?s.options.strength:1,p=Math.max(0,Math.min(1,d));return l.colorConfig={effectType:(null===(c=null==s?void 0:s.options)||void 0===c?void 0:c.effectType)||"grayscale",strength:p,useWebGL:void 0===(null===(h=null==s?void 0:s.options)||void 0===h?void 0:h.useWebGL)||s.options.useWebGL},l}return h(e,t),o(e,[{key:"getShaderSources",value:function(){return{vertex:TR.STANDARD_VERTEX_SHADER,fragment:"\n      precision mediump float;\n      uniform sampler2D u_texture;\n      uniform float u_time;\n      uniform float u_strength;\n      uniform int u_effectType;\n      uniform vec2 u_resolution;\n      varying vec2 v_texCoord;\n\n      ".concat(TR.SHADER_FUNCTIONS,"\n\n      void main() {\n        vec2 uv = v_texCoord;\n        vec4 originalColor = texture2D(u_texture, uv);\n        vec3 color = originalColor.rgb;\n\n        // 计算动态强度\n        float dynamicStrength = calculateDynamicStrength(u_strength, u_time);\n\n        if (u_effectType == 0) {\n          // 灰度效果\n          float gray = luminance(color);\n          vec3 grayColor = vec3(gray);\n          color = mix(color, grayColor, dynamicStrength);\n        } else if (u_effectType == 1) {\n          // 褐色调效果\n          vec3 sepiaColor = sepia(color);\n          color = mix(color, sepiaColor, dynamicStrength);\n        }\n\n        gl_FragColor = vec4(color, originalColor.a);\n      }\n    ")}}},{key:"applyWebGLEffect",value:function(t){if(!this.gl||!this.program||!this.webglCanvas)return null;this.setupWebGLState(t);var e=this.createTextureFromCanvas(t);if(!e)return null;var i=this.createFullScreenQuad();if(!i)return this.gl.deleteTexture(e),null;try{return this.gl.useProgram(this.program),this.setupVertexAttributes(),this.setColorUniforms(),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.webglCanvas}finally{this.gl.deleteTexture(e),this.gl.deleteBuffer(i)}}},{key:"setColorUniforms",value:function(){if(this.gl&&this.program){var t=this.getAnimationTime(),e=this.gl.getUniformLocation(this.program,"u_time"),i=this.gl.getUniformLocation(this.program,"u_strength"),n=this.gl.getUniformLocation(this.program,"u_effectType"),r=this.gl.getUniformLocation(this.program,"u_resolution");this.gl.uniform1f(e,t),this.gl.uniform1f(i,this.colorConfig.strength),this.gl.uniform2f(r,this.webglCanvas.width,this.webglCanvas.height),this.gl.uniform1i(n,{grayscale:0,sepia:1}[this.colorConfig.effectType]||0)}}},{key:"applyCanvas2DEffect",value:function(t){if(this.colorConfig.strength<=0){var e=this.createOutputCanvas(t);return e?e.canvas:null}if(this.canUseCSSFilter())return this.applyCSSFilter(t);var i=this.createOutputCanvas(t);if(!i)return null;var n=i.ctx;try{var r,a=n.getImageData(0,0,t.width,t.height),o=this.getAnimationTime();switch(this.colorConfig.effectType){case"grayscale":default:r=this.applyGrayscaleEffect(a,this.colorConfig.strength,o);break;case"sepia":r=this.applySepiaEffect(a,this.colorConfig.strength,o)}return n.clearRect(0,0,t.width,t.height),n.putImageData(r,0,0),i.canvas}catch(t){return console.warn("Canvas 2D color effect failed:",t),null}}},{key:"canUseCSSFilter",value:function(){var t;return!!window.useFilterAPI&&"undefined"!=typeof CSS&&(null===(t=CSS.supports)||void 0===t?void 0:t.call(CSS,"filter","grayscale(1)"))}},{key:"applyCSSFilter",value:function(t){try{var e=MR.createTempCanvas(t.width,t.height),i=e.getContext("2d");if(!i)return null;var n=this.getAnimationTime(),r=MR.calculateDynamicStrength(this.colorConfig.strength,n),a="";return"grayscale"===this.colorConfig.effectType?a="grayscale(".concat(Math.min(1,r),")"):"sepia"===this.colorConfig.effectType&&(a="sepia(".concat(Math.min(1,r),")")),i.filter=a,i.drawImage(t,0,0),i.filter="none",e}catch(t){return console.warn("CSS Filter API failed, falling back to pixel processing:",t),null}}},{key:"applyGrayscaleEffect",value:function(t,e,i){for(var n=t.data,r=t.width,a=t.height,o=new Uint8ClampedArray(n.length),s=MR.calculateDynamicStrength(e,i),l=0;l<n.length;l+=4){var u=n[l],c=n[l+1],h=n[l+2],d=n[l+3],p=MR.getLuminance(u,c,h);o[l]=Math.round(MR.lerp(u,p,s)),o[l+1]=Math.round(MR.lerp(c,p,s)),o[l+2]=Math.round(MR.lerp(h,p,s)),o[l+3]=d}return new ImageData(o,r,a)}},{key:"applySepiaEffect",value:function(t,e,i){for(var n=t.data,r=t.width,a=t.height,o=new Uint8ClampedArray(n.length),s=MR.calculateDynamicStrength(e,i),l=0;l<n.length;l+=4){var u=n[l],c=n[l+1],h=n[l+2],d=n[l+3],p=m(MR.applySepiaToPixel(u,c,h),3),f=p[0],v=p[1],g=p[2];o[l]=Math.round(MR.lerp(u,f,s)),o[l+1]=Math.round(MR.lerp(c,v,s)),o[l+2]=Math.round(MR.lerp(h,g,s)),o[l+3]=d}return new ImageData(o,r,a)}},{key:"afterStageRender",value:function(t,i){if(this.canUseCSSFilter()&&this.colorConfig.strength>0){var n=this.applyCSSFilter(i);if(n)return n}return _(e,"afterStageRender",this,3)([t,i])}}])}(AR),ER=function(t){function e(t,i,a,o,s){var l,u,c,h;return r(this,e),(l=n(this,e,[t,i,a,o,s])).distortionConfig={distortionType:(null===(u=null==s?void 0:s.options)||void 0===u?void 0:u.distortionType)||"wave",strength:(null===(c=null==s?void 0:s.options)||void 0===c?void 0:c.strength)||.3,useWebGL:void 0===(null===(h=null==s?void 0:s.options)||void 0===h?void 0:h.useWebGL)||s.options.useWebGL},l}return h(e,t),o(e,[{key:"getShaderSources",value:function(){return{vertex:"\n      attribute vec2 a_position;\n      attribute vec2 a_texCoord;\n      varying vec2 v_texCoord;\n\n      void main() {\n        gl_Position = vec4(a_position, 0.0, 1.0);\n        v_texCoord = a_texCoord;\n      }\n    ",fragment:"\n      precision mediump float;\n      uniform sampler2D u_texture;\n      uniform float u_time;\n      uniform float u_strength;\n      uniform int u_distortionType;\n      uniform vec2 u_resolution;\n      varying vec2 v_texCoord;\n\n      // 波浪扭曲函数\n      vec2 wave(vec2 uv, float time, float strength) {\n        float waveX = sin(uv.y * 10.0 + time * 3.0) * strength * 0.1;\n        float waveY = sin(uv.x * 10.0 + time * 2.0) * strength * 0.1;\n        return uv + vec2(waveX, waveY);\n      }\n\n      // 涟漪扭曲函数\n      vec2 ripple(vec2 uv, float time, float strength) {\n        vec2 center = vec2(0.5, 0.5);\n        float distance = length(uv - center);\n        float ripple = sin(distance * 20.0 - time * 5.0) * strength * 0.1;\n        vec2 direction = normalize(uv - center);\n        return uv + direction * ripple;\n      }\n\n      // 漩涡扭曲函数\n      vec2 swirl(vec2 uv, float time, float strength) {\n        vec2 center = vec2(0.5, 0.5);\n        vec2 delta = uv - center;\n        float dist = length(delta);\n        float originalAngle = atan(delta.y, delta.x);\n        float rotationAngle = dist * strength * time * 2.0;\n        float finalAngle = originalAngle + rotationAngle;\n        return center + dist * vec2(cos(finalAngle), sin(finalAngle));\n      }\n\n      void main() {\n        vec2 uv = v_texCoord;\n\n        // 根据扭曲类型应用相应变换\n        if (u_distortionType == 0) {\n          uv = wave(uv, u_time, u_strength);\n        } else if (u_distortionType == 1) {\n          uv = ripple(uv, u_time, u_strength);\n        } else if (u_distortionType == 2) {\n          uv = swirl(uv, u_time, u_strength);\n        }\n\n        // 边界检查\n        if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        } else {\n          gl_FragColor = texture2D(u_texture, uv);\n        }\n      }\n    "}}},{key:"applyWebGLEffect",value:function(t){if(!this.gl||!this.program||!this.webglCanvas)return null;this.setupWebGLState(t);var e=this.createTextureFromCanvas(t);if(!e)return null;var i=this.createFullScreenQuad();if(!i)return this.gl.deleteTexture(e),null;try{return this.gl.useProgram(this.program),this.setupVertexAttributes(),this.setDistortionUniforms(),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.webglCanvas}finally{this.gl.deleteTexture(e),this.gl.deleteBuffer(i)}}},{key:"setDistortionUniforms",value:function(){if(this.gl&&this.program){var t=this.getAnimationTime(),e=this.gl.getUniformLocation(this.program,"u_time"),i=this.gl.getUniformLocation(this.program,"u_strength"),n=this.gl.getUniformLocation(this.program,"u_distortionType"),r=this.gl.getUniformLocation(this.program,"u_resolution");this.gl.uniform1f(e,t),this.gl.uniform1f(i,this.distortionConfig.strength),this.gl.uniform2f(r,this.webglCanvas.width,this.webglCanvas.height),this.gl.uniform1i(n,{wave:0,ripple:1,swirl:2}[this.distortionConfig.distortionType]||0)}}},{key:"applyCanvas2DEffect",value:function(t){var e=this.createOutputCanvas(t);if(!e)return null;var i=e.ctx;try{var n,r=i.getImageData(0,0,t.width,t.height),a=this.getAnimationTime();switch(this.distortionConfig.distortionType){case"wave":n=this.applyWaveDistortion(r,this.distortionConfig.strength,a);break;case"ripple":n=this.applyRippleDistortion(r,this.distortionConfig.strength,a);break;case"swirl":n=this.applySwirlDistortion(r,this.distortionConfig.strength,a);break;default:n=r}return i.clearRect(0,0,t.width,t.height),i.putImageData(n,0,0),e.canvas}catch(t){return console.warn("Canvas 2D distortion effect failed:",t),null}}},{key:"applyWaveDistortion",value:function(t,e,i){for(var n=t.data,r=t.width,a=t.height,o=new Uint8ClampedArray(n.length),s=0;s<a;s++)for(var l=0;l<r;l++){var u=Math.sin(.1*s+3*i)*e*20,c=Math.sin(.1*l+2*i)*e*20,h=Math.round(l-u),d=Math.round(s-c),p=4*(s*r+l);if(h>=0&&h<r&&d>=0&&d<a){var f=4*(d*r+h);o[p]=n[f],o[p+1]=n[f+1],o[p+2]=n[f+2],o[p+3]=n[f+3]}else o[p+3]=0}return new ImageData(o,r,a)}},{key:"applyRippleDistortion",value:function(t,e,i){for(var n=t.data,r=t.width,a=t.height,o=new Uint8ClampedArray(n.length),s=r/2,l=a/2,u=0;u<a;u++)for(var c=0;c<r;c++){var h=c-s,d=u-l,p=Math.sqrt(h*h+d*d),f=Math.sin(.2*p-5*i)*e*10,v=Math.atan2(d,h),g=Math.round(c-Math.cos(v)*f),y=Math.round(u-Math.sin(v)*f),m=4*(u*r+c);if(g>=0&&g<r&&y>=0&&y<a){var _=4*(y*r+g);o[m]=n[_],o[m+1]=n[_+1],o[m+2]=n[_+2],o[m+3]=n[_+3]}else o[m+3]=0}return new ImageData(o,r,a)}},{key:"applySwirlDistortion",value:function(t,e,i){for(var n=t.data,r=t.width,a=t.height,o=new Uint8ClampedArray(n.length),s=r/2,l=a/2,u=0;u<a;u++)for(var c=0;c<r;c++){var h=c-s,d=u-l,p=Math.sqrt(h*h+d*d),f=Math.atan2(d,h)+p*e*i*.02,v=Math.round(s+p*Math.cos(f)),g=Math.round(l+p*Math.sin(f)),y=4*(u*r+c);if(v>=0&&v<r&&g>=0&&g<a){var m=4*(g*r+v);o[y]=n[m],o[y+1]=n[m+1],o[y+2]=n[m+2],o[y+3]=n[m+3]}else o[y+3]=0}return new ImageData(o,r,a)}},{key:"afterStageRender",value:function(t,i){return this.distortionConfig.strength<=0?i:_(e,"afterStageRender",this,3)([t,i])}}])}(AR),PR=function(t){function e(t,i,a,o,s){var l,u,c,h,d,p;return r(this,e),(l=n(this,e,[t,i,a,o,s])).particles=[],l.positionBuffer=null,l.colorBuffer=null,l.particleConfig={effectType:(null===(u=null==s?void 0:s.options)||void 0===u?void 0:u.effectType)||"gravity",count:(null===(c=null==s?void 0:s.options)||void 0===c?void 0:c.count)||4e3,size:(null===(h=null==s?void 0:s.options)||void 0===h?void 0:h.size)||20,strength:(null===(d=null==s?void 0:s.options)||void 0===d?void 0:d.strength)||1.5,useWebGL:void 0===(null===(p=null==s?void 0:s.options)||void 0===p?void 0:p.useWebGL)||s.options.useWebGL},l}return h(e,t),o(e,[{key:"getShaderSources",value:function(){return{vertex:"\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_size;\n\n      uniform vec2 u_resolution;\n      uniform float u_time;\n      uniform float u_forceStrength;\n      uniform int u_effectType;\n\n      varying vec4 v_color;\n\n      void main() {\n        // 将像素坐标转换为剪辑空间坐标\n        vec2 clipSpace = ((a_position / u_resolution) * 2.0) - 1.0;\n        clipSpace.y = -clipSpace.y; // 翻转Y轴\n\n        gl_Position = vec4(clipSpace, 0.0, 1.0);\n        gl_PointSize = a_size;\n        v_color = a_color;\n      }\n    ",fragment:"\n      precision mediump float;\n      varying vec4 v_color;\n\n      void main() {\n        // 创建圆形粒子\n        vec2 coord = gl_PointCoord - vec2(0.5);\n        float distance = length(coord);\n\n        if (distance > 0.5) {\n          discard;\n        }\n\n        // 保持原始颜色，只调整透明度渐变\n        gl_FragColor = vec4(v_color.rgb, v_color.a);\n      }\n    "}}},{key:"applyWebGLEffect",value:function(t){if(!this.gl||!this.program||!this.webglCanvas)return null;this.setupWebGLState(t),0===this.particles.length&&this.extractParticles(t),this.updateParticles(t);var e=this.gl;return e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.useProgram(this.program),this.prepareAndDrawParticles(e),this.webglCanvas}},{key:"applyCanvas2DEffect",value:function(t){var e=this.createOutputCanvas(t);if(!e)return null;var i=e.canvas,n=e.ctx,r=this.currentAnimationRatio;switch(this.particleConfig.effectType){case"explode":this.applyCanvas2DExplode(n,t,r);break;case"gravity":this.applyCanvas2DGravity(n,t,r);break;case"vortex":this.applyCanvas2DVortex(n,t,r);break;default:n.globalAlpha=Math.max(0,1-r),n.drawImage(t,0,0)}return i}},{key:"extractParticles",value:function(t){var e=MR.createTempCanvas(t.width,t.height,1),i=e.getContext("2d");if(i){i.drawImage(t,0,0,e.width,e.height);var n=i.getImageData(0,0,e.width,e.height).data;this.particles=[];for(var r=Math.max(1,Math.floor(Math.sqrt(e.width*e.height/(1.5*this.particleConfig.count)))),a=0;a<e.height;a+=r)for(var o=0;o<e.width;o+=r){var s=4*(a*e.width+o),l=n[s],u=n[s+1],c=n[s+2],h=n[s+3];if(h>5){var d=o/e.width*t.width,p=a/e.height*t.height,f={x:d,y:p,originX:d,originY:p,vx:0,vy:0,r:l/255,g:u/255,b:c/255,a:Math.max(.6,h/255),life:1,size:this.particleConfig.size*(1+.5*Math.random())};this.particles.push(f)}}}}},{key:"updateParticles",value:function(t){var e=this,i=t.width/2,n=t.height/2,r=this.currentAnimationRatio,a=this.getDurationFromParent(),o=a<2e3,s=o?Math.max(1.5,3e3/a):1,l=o?Math.min(2,2e3/a):1;this.particles.forEach((function(a){var u=a.x-i,c=a.y-n,h=Math.sqrt(u*u+c*c),d=Math.atan2(c,u);e.applyParticleForces(a,d,h,r,l,t),e.updateParticleProperties(a,r,o,s,l)}))}},{key:"applyParticleForces",value:function(t,e,i,n,r,a){var o=this.getAnimationTime();switch(this.particleConfig.effectType){case"explode":var s=n*this.particleConfig.strength*r*5;t.vx+=Math.cos(e)*s,t.vy+=Math.sin(e)*s;break;case"gravity":this.applyGravityEffect(t,n,r,a,o);break;case"vortex":this.applyVortexEffect(t,n,r,a,e,i)}}},{key:"applyGravityEffect",value:function(t,e,i,n,r){var a=(t.originX+.7*t.originY)/(n.width+n.height)*.8;if(e>a){var o=(e-a)/(1-a),s=this.particleConfig.strength*o*o*12*i;t.vy+=s;var l=Math.sin(3*r+.02*t.originX)*Math.cos(2*r+.015*t.originY);t.vx+=l*this.particleConfig.strength*2*i}}},{key:"applyVortexEffect",value:function(t,e,i,n,r,a){var o=n.width/2,s=n.height/2,l=r+e*Math.PI*.8,u=a+e*Math.max(n.width,n.height)*.7*1.8,c=o+Math.cos(l)*u,h=s+Math.sin(l)*u,d=e*this.particleConfig.strength*.08*i;t.vx+=(c-t.x)*d,t.vy+=(h-t.y)*d}},{key:"updateParticleProperties",value:function(t,e,i,n,r){var a=i?.99:.98;if(t.vx*=a,t.vy*=a,t.x+=t.vx,t.y+=t.vy,i){var o=Math.max(.1,.5/n);t.life=Math.max(0,1-e*o),t.a=Math.max(.2,t.life*Math.min(1,1.2*t.a)),t.size=Math.max(.7*this.particleConfig.size,this.particleConfig.size*(.5+.5*t.life))}else t.life=Math.max(0,1-.2*e),t.a=Math.max(.1,t.life*Math.min(1,1.5*t.a)),t.size=Math.max(.5*this.particleConfig.size,this.particleConfig.size*(.3+.7*t.life))}},{key:"prepareAndDrawParticles",value:function(t){var e=new Float32Array(2*this.particles.length),i=new Float32Array(4*this.particles.length),n=new Float32Array(this.particles.length);this.particles.forEach((function(t,r){e[2*r]=t.x,e[2*r+1]=t.y,i[4*r]=t.r,i[4*r+1]=t.g,i[4*r+2]=t.b,i[4*r+3]=Math.max(.1,t.a),n[r]=Math.max(6,1.5*t.size)})),this.updateParticleBuffers(t,e,i,n),this.setParticleUniforms(t),t.drawArrays(t.POINTS,0,this.particles.length),this.cleanupTempBuffers(t)}},{key:"updateParticleBuffers",value:function(t,e,i,n){this.positionBuffer||(this.positionBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,e,t.DYNAMIC_DRAW);var r=t.getAttribLocation(this.program,"a_position");t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),this.colorBuffer||(this.colorBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,i,t.DYNAMIC_DRAW);var a=t.getAttribLocation(this.program,"a_color");t.enableVertexAttribArray(a),t.vertexAttribPointer(a,4,t.FLOAT,!1,0,0);var o=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,n,t.DYNAMIC_DRAW);var s=t.getAttribLocation(this.program,"a_size");t.enableVertexAttribArray(s),t.vertexAttribPointer(s,1,t.FLOAT,!1,0,0),this._tempSizeBuffer=o}},{key:"setParticleUniforms",value:function(t){var e=t.getUniformLocation(this.program,"u_resolution"),i=t.getUniformLocation(this.program,"u_time"),n=t.getUniformLocation(this.program,"u_forceStrength"),r=t.getUniformLocation(this.program,"u_effectType");t.uniform2f(e,this.webglCanvas.width,this.webglCanvas.height),t.uniform1f(i,this.getAnimationTime()),t.uniform1f(n,this.particleConfig.strength),t.uniform1i(r,{explode:0,vortex:1,gravity:2}[this.particleConfig.effectType]||0)}},{key:"cleanupTempBuffers",value:function(t){var e=this._tempSizeBuffer;e&&(t.deleteBuffer(e),delete this._tempSizeBuffer)}},{key:"applyCanvas2DExplode",value:function(t,e,i){var n=e.width/2,r=e.height/2;t.save(),t.globalAlpha=Math.max(0,1-i),t.translate(n,r);var a=1+.5*i;t.scale(a,a),t.translate(-n,-r),t.drawImage(e,0,0),t.restore()}},{key:"applyCanvas2DGravity",value:function(t,e,i){t.save(),t.globalAlpha=Math.max(0,1-i);var n=i*e.height*.3;t.drawImage(e,0,n),t.restore()}},{key:"applyCanvas2DVortex",value:function(t,e,i){var n=e.width/2,r=e.height/2;t.save(),t.globalAlpha=Math.max(0,1-i),t.translate(n,r),t.rotate(i*Math.PI*2),t.translate(-n,-r),t.drawImage(e,0,0),t.restore()}}])}(AR),BR=function(t){function e(t,i,a,o,s){var l,u,c;return r(this,e),(l=n(this,e,[t,i,a,o,s])).glitchConfig={effectType:(null===(u=null==s?void 0:s.options)||void 0===u?void 0:u.effectType)||"rgb-shift",intensity:void 0!==(null===(c=null==s?void 0:s.options)||void 0===c?void 0:c.intensity)?s.options.intensity:.5},l}return h(e,t),o(e,[{key:"applyCanvas2DEffect",value:function(t){if(this.glitchConfig.intensity<=0){var e=this.createOutputCanvas(t);return e?e.canvas:null}try{switch(this.glitchConfig.effectType){case"rgb-shift":default:return this.applyRGBShiftGlitch(t);case"digital-distortion":return this.applyDigitalDistortionGlitch(t);case"scan-lines":return this.applyScanLineGlitch(t);case"data-corruption":return this.applyDataCorruptionGlitch(t)}}catch(t){return console.warn("Glitch effect failed:",t),null}}},{key:"applyRGBShiftGlitch",value:function(t){var e=this.createOutputCanvas(t);if(!e)return null;var i=e.ctx;try{i.clearRect(0,0,t.width,t.height);var n=MR.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),r=Math.floor(20*n),a=this.generateRandomOffset(r),o=this.generateRandomOffset(r,.3),s=this.generateRandomOffset(-r),l=MR.createTempCanvas(t.width,t.height),u=l.getContext("2d");u.drawImage(t,0,0);var c=u.getImageData(0,0,t.width,t.height),h=MR.extractChannel(c,0),d=MR.extractChannel(c,1),p=MR.extractChannel(c,2);return i.globalCompositeOperation="screen",u.clearRect(0,0,t.width,t.height),u.putImageData(h,0,0),i.drawImage(l,a.x,a.y),u.clearRect(0,0,t.width,t.height),u.putImageData(d,0,0),i.drawImage(l,o.x,o.y),u.clearRect(0,0,t.width,t.height),u.putImageData(p,0,0),i.drawImage(l,s.x,s.y),i.globalCompositeOperation="source-over",e.canvas}catch(t){return console.warn("RGB shift glitch failed:",t),null}}},{key:"applyDigitalDistortionGlitch",value:function(t){var e=this.createOutputCanvas(t);if(!e)return null;var i=e.ctx;try{var n=i.getImageData(0,0,t.width,t.height),r=MR.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),a=this.processDigitalDistortion(n,r);return i.clearRect(0,0,t.width,t.height),i.putImageData(a,0,0),e.canvas}catch(t){return console.warn("Digital distortion glitch failed:",t),null}}},{key:"applyScanLineGlitch",value:function(t){var e=this.createOutputCanvas(t);if(!e)return null;var i=e.ctx;try{var n=MR.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),r=Math.max(2,Math.floor(10-8*n));i.globalCompositeOperation="multiply";for(var a=0;a<t.height;a+=r)if(Math.random()<n){var o=.1+.4*n;i.fillStyle="rgba(0, 0, 0, ".concat(o,")"),i.fillRect(0,a,t.width,1)}i.globalCompositeOperation="screen";for(var s=Math.floor(20*n),l=0;l<s;l++){var u=Math.random()*t.height,c=.3*n;i.fillStyle="rgba(255, 255, 255, ".concat(c,")"),i.fillRect(0,Math.floor(u),t.width,1)}return i.globalCompositeOperation="source-over",e.canvas}catch(t){return console.warn("Scan line glitch failed:",t),null}}},{key:"applyDataCorruptionGlitch",value:function(t){var e=this.createOutputCanvas(t);if(!e)return null;var i=e.ctx;try{var n=i.getImageData(0,0,t.width,t.height),r=MR.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),a=this.processDataCorruption(n,r);return i.clearRect(0,0,t.width,t.height),i.putImageData(a,0,0),e.canvas}catch(t){return console.warn("Data corruption glitch failed:",t),null}}},{key:"generateRandomOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{x:(Math.random()-.5)*t,y:(Math.random()-.5)*t*e}}},{key:"processDigitalDistortion",value:function(t,e){for(var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i),o=Math.floor(20*e)+5,s=Math.floor(r/o),l=0;l<o;l++)if(Math.random()<e){var u=l*s,c=Math.min(u+s,r),h=Math.floor((Math.random()-.5)*n*e*.1);this.shiftSliceHorizontal(a,n,r,u,c,h)}for(var d=.3*e,p=0;p<i.length;p+=4)Math.random()<d&&(a[p]=255*Math.random(),a[p+1]=255*Math.random(),a[p+2]=255*Math.random());return new ImageData(a,n,r)}},{key:"shiftSliceHorizontal",value:function(t,e,i,n,r,a){for(var o=new Uint8ClampedArray(4*e),s=n;s<r;s++){for(var l=s*e*4,u=0;u<4*e;u++)o[u]=t[l+u];for(var c=0;c<e;c++){var h=l+4*c,d=(c-a+e)%e*4;t[h]=o[d],t[h+1]=o[d+1],t[h+2]=o[d+2],t[h+3]=o[d+3]}}}},{key:"processDataCorruption",value:function(t,e){for(var i=t.data,n=t.width,r=t.height,a=new Uint8ClampedArray(i),o=Math.floor(15*e)+5,s=0;s<o;s++)if(Math.random()<e)for(var l=Math.floor(Math.random()*n),u=Math.floor(5*Math.random())+1,c=Math.random()<.5?0:255,h=0;h<r;h++)for(var d=0;d<u&&l+d<n;d++){var p=4*(h*n+l+d);a[p]=c,a[p+1]=c,a[p+2]=c}for(var f=Math.floor(20*e),v=0;v<f;v++){var g=Math.floor(Math.random()*n),y=Math.floor(Math.random()*r),m=Math.floor(20*Math.random())+5,_=Math.floor(10*Math.random())+2;this.corruptBlock(a,n,r,g,y,m,_)}return new ImageData(a,n,r)}},{key:"corruptBlock",value:function(t,e,i,n,r,a,o){for(var s=0;s<o&&r+s<i;s++)for(var l=0;l<a&&n+l<e;l++){var u=4*((r+s)*e+(n+l));Math.random()<.7&&(t[u]=255*Math.random(),t[u+1]=255*Math.random(),t[u+2]=255*Math.random())}}}])}(SR),RR=function(t){function e(t,i,a,o,s){var l,u,c;return r(this,e),(l=n(this,e,[t,i,a,o,s])).blurConfig={blurRadius:(null===(u=null==s?void 0:s.options)||void 0===u?void 0:u.blurRadius)||8,useOptimizedBlur:void 0===(null===(c=null==s?void 0:s.options)||void 0===c?void 0:c.useOptimizedBlur)||s.options.useOptimizedBlur},l}return h(e,t),o(e,[{key:"applyCSSBlur",value:function(t,e){var i=j_.createCanvas({width:t.width,height:t.height,dpr:j_.devicePixelRatio}),n=i.getContext("2d");return n?(n.filter="blur(".concat(e,"px)"),n.drawImage(t,0,0),n.filter="none",i):t}},{key:"applyDownsampleBlur",value:function(t,e){var i=t.width,n=t.height,r=Math.max(1,Math.floor(e/2)),a=Math.floor(i/r),o=Math.floor(n/r),s=j_.createCanvas({width:a,height:o,dpr:1}),l=s.getContext("2d");if(!l)return t;var u=j_.createCanvas({width:i,height:n,dpr:1}),c=u.getContext("2d");return c?(c.putImageData(t,0,0),l.drawImage(u,0,0,a,o),l.filter="blur(".concat(e/r,"px)"),l.drawImage(s,0,0),l.filter="none",c.clearRect(0,0,i,n),c.drawImage(s,0,0,i,n),c.getImageData(0,0,i,n)):t}},{key:"afterStageRender",value:function(t,e){if(this.blurConfig.blurRadius<=0)return e;var i;if(this.blurConfig.useOptimizedBlur)i=this.applyCSSBlur(e,this.blurConfig.blurRadius);else{var n=j_.createCanvas({width:e.width,height:e.height,dpr:j_.devicePixelRatio}),r=n.getContext("2d");if(!r)return!1;r.clearRect(0,0,e.width,e.height),r.drawImage(e,0,0);var a=r.getImageData(0,0,e.width,e.height),o=this.applyDownsampleBlur(a,this.blurConfig.blurRadius);r.putImageData(o,0,0),i=n}var s=i.getContext("2d");return s&&(s.globalCompositeOperation="overlay",s.fillStyle="rgba(255, 255, 255, 0.1)",s.fillRect(0,0,i.width,i.height),s.globalCompositeOperation="source-over"),i}}])}(NP),LR=function(t){function e(t,i,a,o,s){var l,u,c;return r(this,e),(l=n(this,e,[t,i,a,o,s])).pixelationConfig={maxPixelSize:(null===(u=null==s?void 0:s.options)||void 0===u?void 0:u.maxPixelSize)||20,method:(null===(c=null==s?void 0:s.options)||void 0===c?void 0:c.method)||"out"},l}return h(e,t),o(e,[{key:"applyDownsamplePixelation",value:function(t,e){if(e<=1)return t;var i=t.width,n=t.height,r=Math.ceil(i/e),a=Math.ceil(n/e),o=j_.createCanvas({width:r,height:a,dpr:1}),s=o.getContext("2d");if(!s)return t;var l=j_.createCanvas({width:i,height:n,dpr:j_.devicePixelRatio}),u=l.getContext("2d");return u?(s.imageSmoothingEnabled=!1,u.imageSmoothingEnabled=!1,s.drawImage(t,0,0,r,a),u.drawImage(o,0,0,i,n),l):t}},{key:"updateAnimationProgress",value:function(){return"in"===this.pixelationConfig.method?this.pixelationConfig.maxPixelSize-this.currentAnimationRatio*(this.pixelationConfig.maxPixelSize-1):1+this.currentAnimationRatio*(this.pixelationConfig.maxPixelSize-1)}},{key:"afterStageRender",value:function(t,e){var i=this.updateAnimationProgress();return i<=1?e:this.applyDownsamplePixelation(e,i)}}])}(kR),IR=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t,e=jP(this.target);this._animator=e;var i=this.duration,n=this.easing,r=this.params,a=r.config,o=r.lastScale,s=r.getTickCoord,l=1,u=this.target.data;if(o&&s&&u){l=.7;var c=s(o.scale(u.rawValue)),h=this.target.attribute.x,d=this.target.attribute.y;this.target.setAttributes({x:c.x,y:c.y}),e.animate(this.target,{type:"to",to:{x:h,y:d},duration:i,easing:n})}e.animate(this.target,{type:null!==(t=a.type)&&void 0!==t?t:"fadeIn",to:a.to,duration:i*l,easing:n}),this.completeBind(e)}}])}(HP),DR=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t=jP(this.target);this._animator=t;var e=this.duration,i=this.easing,n=this.params;n.config;var r=n.diffAttrs;t.animate(this.target,{type:"to",to:Object.assign({},r),duration:e,easing:i,customParameters:{diffAttrs:Object.assign({},r)}}),this.completeBind(t)}},{key:"deleteSelfAttr",value:function(t){_(e,"deleteSelfAttr",this,3)([t]),this._animator.deleteSelfAttr(t)}},{key:"tryPreventConflict",value:function(){}}])}(HP);function OR(){Kw(),Qw(),oC(),dC(),wP.registerBuiltInAnimate("axisEnter",IR),wP.registerBuiltInAnimate("axisUpdate",DR)}var FR=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};OR(),rC();var zR=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t),i])}return h(e,t),o(e,[{key:"_renderInner",value:function(t){var i,n=this;if(this._breaks=null,this.attribute.breaks&&this.attribute.breaks.length){for(var r=[],a=0;a<this.attribute.breaks.length;a++){var o=this.attribute.breaks[a],s=o.range,l=o.breakSymbol,u=o.rawRange;r.push({startPoint:this.getTickCoord(s[0]),endPoint:this.getTickCoord(s[1]),range:s,breakSymbol:l,rawRange:u})}this._breaks=r}_(e,"_renderInner",this,3)([t]),this._breaks&&this._breaks.length&&this._breaks.forEach((function(e,i){var r=e.startPoint,a=e.endPoint,o=e.breakSymbol,s=e.rawRange;if(!1!==(null==o?void 0:o.visible)){var l=kg.group({zIndex:999});l.name=wE.axisBreak,l.id=n._getNodeId("".concat(wE.axisBreak,"-").concat(i)),l.data=s;var u=function(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=i.style,r=void 0===n?{}:n,a=i.angle,o=void 0===a?.5*Math.PI:a,s=gt({},RE,r),l=null!==(t=s.size)&&void 0!==t?t:RE.size;return Object.assign(Object.assign({},s),{symbolType:null!==(e=s.symbolType)&&void 0!==e?e:"M ".concat(-l/2," ").concat(l*Math.sin(o)," L ").concat(l/2," ").concat(-l*Math.sin(o)),symbolSize:l})}(o),c=kg.symbol(Object.assign({x:r.x,y:r.y},u));c.name=wE.axisBreakSymbol;var h=kg.symbol(Object.assign({x:a.x,y:a.y},u));h.name=wE.axisBreakSymbol,l.add(c),l.add(h),t.add(l)}}));var c=this.attribute.panel;if(c&&c.visible){var h=this.axisContainer,d=h.AABBBounds,p=kg.rect(Object.assign({x:d.x1,y:d.y1,width:d.width(),height:d.height()},c.style));p.name=wE.background,p.id=this._getNodeId("background"),p.states=gt({},PE,null!==(i=c.state)&&void 0!==i?i:{}),h.insertBefore(p,h.firstChild)}}},{key:"renderLine",value:function(t){var e=this.attribute,i=e.start,n=e.end,r=e.line,a=r.startSymbol,o=r.endSymbol,s=r.style,l=r.state,u=FR(r,["startSymbol","endSymbol","style","state"]),c=Object.assign({startSymbol:a,endSymbol:o,lineStyle:s},u);if(this._breaks&&this._breaks.length){var h=[],d=i;this._breaks.forEach((function(t){var e=t.startPoint,i=t.endPoint;h.push([d,e]),d=i})),h.push([d,n]),c.points=h,c.multiSegment=!0}else c.points=[i,n];lt(l)||(c.state={line:gt({},PE,l),symbol:gt({},PE,l)});var p=new TE(c);p.name=wE.line,p.id=this._getNodeId("line"),t.add(p)}},{key:"getTextAlign",value:function(t){var e="center";return Ut(t[0],0)?Ut(t[1],0)?Object.is(t[1],-0)?e="start":Object.is(t[0],-0)&&(e="end"):e="center":t[0]>0?e="start":t[0]<0&&(e="end"),e}},{key:"getTitleAttribute",value:function(){var t,e,i,n=this,r=this.attribute.title,a=r.position,o=void 0===a?"middle":a,s=r.space,l=void 0===s?4:s,u=r.textStyle,c=void 0===u?{}:u,h=r.autoRotate,d=void 0===h||h,p=r.shape,f=r.background,v=r.state,g=void 0===v?{}:v,y=r.maxWidth,m=FR(r,["position","space","textStyle","autoRotate","shape","background","state","maxWidth"]),_=.5;"start"===o?_=0:"end"===o&&(_=1);var b=this.attribute.verticalFactor,x=-1*(void 0===b?1:b),k=this.getTickCoord(_),S=this.getRelativeVector(),A=0;if((null===(t=this.attribute.label)||void 0===t?void 0:t.visible)&&!1===this.attribute.label.inside){var M=+ut(this.attribute,"label.space",4);A+=M;var T=Object.keys(this.axisLabelLayerSize).length;if(0===S[1]){var w=this.axisLabelsContainer?this.axisLabelsContainer.AABBBounds.height():0;isFinite(w)?A+=w+(T-1)*M:A=0}else if(0===S[0])if(this.axisLabelsContainer&&this.axisLabelsContainer.AABBBounds&&!this.axisLabelsContainer.AABBBounds.empty()){var C=this.axisLabelLayerSize[0].labelPos,E=this.axisLabelsContainer.AABBBounds;A+=(1===x?E.x2>C?Math.min(E.x2-C,E.width()):0:E.x1<C?Math.min(C-E.x1,E.width()):0)+(T-1)*M}else A=0;else Object.keys(this.axisLabelLayerSize).forEach((function(t,e){A+=n.axisLabelLayerSize[t].width+(e>0?M:0)}))}var P=0;(null===(e=this.attribute.tick)||void 0===e?void 0:e.visible)&&!1===this.attribute.tick.inside&&(P=this.attribute.tick.length||4),(null===(i=this.attribute.subTick)||void 0===i?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(P=Math.max(P,this.attribute.subTick.length||2));var B,R,L=P+A+l,I=this.getVerticalCoord(k,L,!1),D=this.getVerticalVector(L,!1,{x:0,y:0}),O=m.angle;if(B="start"===o?"start":"end"===o?"end":"center",j(O)&&d){O=jC(S,[1,0],!0);var F=this.attribute.verticalFactor;R=1==-1*(void 0===F?1:F)?"bottom":"top"}else B=this.getTextAlign(D),R=this.getTextBaseline(D,!1);var z=y;if(j(z)){var H=this.attribute,N=H.verticalLimitSize,V=H.verticalMinSize,U=H.orient,W=Math.min(N||1/0,V||1/0);if(et(W))if("bottom"===U||"top"===U)if(O!==Math.PI/2){var G=Math.abs(Math.cos(null!=O?O:0));z=G<1e-6?1/0:this.attribute.end.x/G}else z=W-L;else if(O&&0!==O){var Y=Math.abs(Math.sin(O));z=Y<1e-6?1/0:this.attribute.end.y/Y}else z=W-L}var X=Object.assign(Object.assign(Object.assign({},I),m),{maxWidth:z,textStyle:Object.assign({textAlign:B,textBaseline:R},c),state:{text:gt({},PE,g.text),shape:gt({},PE,g.shape),panel:gt({},PE,g.background)}});return X.angle=O,p&&p.visible&&(X.shape=Object.assign({visible:!0},p.style),p.space&&(X.space=p.space)),f&&f.visible&&(X.panel=Object.assign({visible:!0},f.style)),X}},{key:"getTextBaseline",value:function(t,e){var i="middle",n=this.attribute.verticalFactor,r=(e?1:-1)*(void 0===n?1:n);return Ut(t[1],0)?i=!Ut(t[0],0)||Object.is(t[0],-0)||Object.is(t[1],-0)?"middle":1===r?"bottom":"top":t[1]>0?i="top":t[1]<0&&(i="bottom"),i}},{key:"getLabelAlign",value:function(t,e,i){var n=this.attribute.orient;if(["top","bottom","right","left"].includes(n)||0===t[0]&&0===t[1]){if("top"===n||"bottom"===n)return iP(e?"bottom"===n?"top":"bottom":n,i);if("left"===n||"right"===n)return nP(e?"left"===n?"right":"left":n,i)}return{textAlign:this.getTextAlign(t),textBaseline:this.getTextBaseline(t,e)}}},{key:"beforeLabelsOverlap",value:function(t,e,i,n,r){var a,o,s,l,u=(this.attribute.label||{}).flush;if(void 0!==u&&u&&t.length){var c=this.attribute,h=c.orient,d=c.start,p=c.end,f="bottom"===h||"top"===h,v=t[0],g=At(t),y=f?v.attribute.x>g.attribute.x:v.attribute.y<g.attribute.y;if(f){var m=y?g:v,_=y?v:g,b=d.x,x=p.x,k=m.AABBBounds.x1,S=_.AABBBounds.x2;k<b&&(m.attribute.angle?m.setAttributes({dx:(null!==(a=m.attribute.dx)&&void 0!==a?a:0)+b-k}):m.setAttributes({x:b,textAlign:"left"})),S>x&&(_.attribute.angle?_.setAttributes({dx:(null!==(o=_.attribute.dx)&&void 0!==o?o:0)+x-S}):_.setAttributes({x:x,textAlign:"right"}))}else{var A=y?g:v,M=y?v:g,T=A.AABBBounds.y2,w=M.AABBBounds.y1,C=d.y,E=p.y;w<C&&(M.attribute.angle?M.setAttributes({dy:(null!==(s=M.attribute.dy)&&void 0!==s?s:0)+C-w}):M.setAttributes({y:C,textBaseline:"top"})),T>E&&(A.attribute.angle?A.setAttributes({dy:(null!==(l=A.attribute.dy)&&void 0!==l?l:0)+E-T}):A.setAttributes({y:E,textBaseline:"bottom"}))}}}},{key:"handleLabelsOverlap",value:function(t,e,i,n,r){if(!lt(t)){var a=this.attribute,o=a.verticalLimitSize,s=a.label,l=a.orient,u=this._getAxisLabelLimitLength(o,r),c=s.layoutFunc,h=s.autoRotate,d=s.autoRotateAngle,p=s.autoLimit,f=s.limitEllipsis,v=s.autoHide,g=s.autoHideMethod,y=s.autoHideSeparation,m=s.lastVisible,_=s.firstVisible,b=s.autoWrap,x=s.overflowLimitLength;if(V(c))c(t,e,n,this);else{if(h)tP(t,{labelRotateAngle:d,orient:l});else if(b){!function(t,e){var i=e.limitLength,n=e.axisLength,r=e.ellipsis,a=void 0===r?"...":r,o=e.orient;if(!lt(t)&&et(i)){var s=t[0].attribute.angle,l=OE(s),u=DE(s),c="top"===o||"bottom"===o,h=n/t.length;t.forEach((function(e,n){var r,o,s,d,p;if(c){if(u&&Math.floor(e.AABBBounds.height())<=i)return;if(l){var f=aP(e.attribute.x,null===(r=t[n+1])||void 0===r?void 0:r.attribute.x,null===(o=t[n-1])||void 0===o?void 0:o.attribute.x);et(f)&&(h=Se(h,f))}}else{if(u){var v=aP(e.attribute.y,null===(s=t[n+1])||void 0===s?void 0:s.attribute.y,null===(d=t[n-1])||void 0===d?void 0:d.attribute.y);et(v)&&(h=Se(h,v))}if(l&&Math.floor(e.AABBBounds.width())<=i)return}var g=null,y=null;c?u?(g=i,y=h):(g=h,y=i):u?(g=h,y=i):(g=i,y=h),e.setAttributes({maxLineWidth:g,ellipsis:null!==(p=e.attribute.ellipsis)&&void 0!==p?p:a,whiteSpace:"normal",heightLimit:y})}))}}(t,{orient:l,limitLength:u,axisLength:"left"===l||"right"===l?Math.abs(this.attribute.start.y-this.attribute.end.y):Math.abs(this.attribute.start.x-this.attribute.end.x),ellipsis:f})}if(!b&&p&&et(u)&&u>0){var k="left"===l||"right"===l,S=k?Math.abs(this.attribute.start.y-this.attribute.end.y):Math.abs(this.attribute.start.x-this.attribute.end.x);rP(t,{limitLength:u,verticalLimitLength:k?S/t.length:v||h?1/0:S/t.length,ellipsis:f,orient:l,axisLength:S,overflowLimitLength:x})}v&&$E(t,{orient:l,method:g,separation:y,lastVisible:m,firstVisible:_})}}}},{key:"afterLabelsOverlap",value:function(t,e,i,n,r){var a,o=this.attribute,s=o.verticalLimitSize,l=o.orient,u="bottom"===l||"top"===l,c=i.AABBBounds,h=u?c.height():c.width(),d=this.attribute.verticalMinSize;if(et(d)&&(!et(s)||d<=s)){var p,f,v=this._getAxisLabelLimitLength(d,r);h=Math.max(h,v),"left"===l?(p=c.x2-h,f=c.y1):"right"===l?(p=c.x1,f=c.y1):"top"===l?(p=c.x1,f=c.y2-h):"bottom"===l&&(p=c.x1,f=c.y1);var g=kg.rect({x:p,y:f,width:u?c.width():h,height:u?h:c.height(),pickable:!1});g.name=wE.axisLabelBackground,g.id=this._getNodeId("axis-label-background"),i.insertBefore(g,i.firstChild)}U(this.attribute.label.containerAlign)&&("left"===l?a=c.x2-h:"right"===l?a=c.x1:"top"===l?a=c.y2-h:"bottom"===l&&(a=c.y1),function(t,e,i,n,r){"left"===n||"right"===n?"left"===r?t.forEach((function(t){var i;t.setAttributes({dx:(null!==(i=t.attribute.dx)&&void 0!==i?i:0)+e-t.AABBBounds.x1})})):"right"===r?t.forEach((function(t){var n;t.setAttributes({dx:(null!==(n=t.attribute.dx)&&void 0!==n?n:0)+e+i-t.AABBBounds.x2})})):"center"===r&&t.forEach((function(t){var n;t.setAttributes({dx:(null!==(n=t.attribute.dx)&&void 0!==n?n:0)+e+i/2-(t.AABBBounds.x1+t.AABBBounds.x2)/2})})):"bottom"!==n&&"top"!==n||("top"===r?t.forEach((function(t){var i;t.setAttributes({dy:(null!==(i=t.attribute.dy)&&void 0!==i?i:0)+e-t.AABBBounds.y1})})):"bottom"===r?t.forEach((function(t){var n;t.setAttributes({dy:(null!==(n=t.attribute.dy)&&void 0!==n?n:0)+e+i-t.AABBBounds.y2})})):"middle"===r&&t.forEach((function(t){var n;t.setAttributes({dy:(null!==(n=t.attribute.dy)&&void 0!==n?n:0)+e+i/2-(t.AABBBounds.y1+t.AABBBounds.y2)/2})})))}(t,a,h,l,this.attribute.label.containerAlign))}},{key:"_getAxisLabelLimitLength",value:function(t,e){var i,n,r,a,o,s=this.attribute,l=s.label,u=s.title,c=s.line,h=s.tick,d=null!==(i=l.space)&&void 0!==i?i:4,p=t,f=0,v=0,g=c&&c.visible?null!==(n=c.style.lineWidth)&&void 0!==n?n:1:0,y=h&&h.visible?null!==(r=h.length)&&void 0!==r?r:4:0;if(u&&u.visible&&"string"==typeof u.text){f=WC(u.text,u.textStyle,null===(o=null===(a=this.stage)||void 0===a?void 0:a.getTheme())||void 0===o?void 0:o.text).height;var m=Di(u.padding);v=u.space+m[0]+m[2]}return p&&(p=(p-d-v-f-g-y)/e),p}},{key:"release",value:function(){_(e,"release",this,3)([]),this._breaks=null}}])}(qE);zR.defaultAttributes=BE,kt(zR,oP);var HR=function(){return o((function t(){r(this,t)}),[{key:"isInValidValue",value:function(t){var e=this.attribute,i=e.startAngle,n=void 0===i?gC:i,r=e.endAngle,a=void 0===r?yC:r;return Math.abs(a-n)%(2*Math.PI)==0?t>1:t<0||t>1}},{key:"getTickCoord",value:function(t){var e=this.attribute,i=e.startAngle,n=void 0===i?gC:i,r=e.endAngle,a=void 0===r?yC:r,o=e.center,s=e.radius,l=e.inside,u=void 0!==l&&l,c=e.innerRadius,h=void 0===c?0:c;return Ve(o,u&&h>0?h:s,n+(a-n)*t)}},{key:"getVerticalVector",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return HE(t,arguments.length>2?arguments[2]:void 0,this.attribute.center,e,this.attribute.inside)}},{key:"getRelativeVector",value:function(t){var e=this.attribute.center;return[t.y-e.y,-1*(t.x-e.x)]}}])}();function NR(t,e){var i=t.length;return{prevLabel:e>=1?t[e-1]:t[i-1],nextLabel:e<i-1?t[e+1]:t[0]}}function VR(t,e,i){var n;t.setAttributes({maxLineWidth:e,ellipsis:null!==(n=t.attribute.ellipsis)&&void 0!==n?n:i})}function jR(t,e,i){var n=[];if(t.length>=3){var r=NR(t,e),a=r.prevLabel,o=r.nextLabel;n.push(a,o)}else 2===t.length&&n.push(t[0===e?1:0]);var s=t[e],l=Math.min(Math.abs(s.attribute.y-i.y1),Math.abs(s.attribute.y-i.y2));n.forEach((function(t){l=Math.min(l,Math.abs(t.attribute.y-s.attribute.y))})),l>0&&s.setAttributes({whiteSpace:"normal",heightLimit:l})}var UR=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};OR(),Ww();var WR=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderLine",value:function(t){var e,i=this.attribute,n=i.startAngle,r=void 0===n?gC:n,a=i.endAngle,o=void 0===a?yC:a,s=i.radius,l=i.center,u=i.innerRadius,c=void 0===u?0:u,h=i.line,d=void 0===h?{}:h,p=i.inside,f=void 0!==p&&p,v=i.sides,g=s,y=c;if(f&&c>0&&(g=c,y=0),et(v)&&v>=3){var m=NE(l,v,g,r,o);e=kg.path(Object.assign(Object.assign({},d.style),{path:VE(m,!0)}))}else{var _=Object.assign(Object.assign(Object.assign({},l),{startAngle:r,endAngle:o,radius:g,innerRadius:y}),d.style);e=kg.circle(_)}e.name=wE.line,e.id=this._getNodeId("line"),lt(d.state)||(e.states=gt({},PE,d.state)),t.add(e)}},{key:"getTitleAttribute",value:function(){var t,e,i,n=this.attribute,r=n.center,a=n.radius,o=n.innerRadius,s=void 0===o?0:o,l=this.attribute.title,u=l.space,c=void 0===u?4:u,h=l.textStyle,d=void 0===h?{}:h,p=l.shape,f=l.background,v=l.state,g=void 0===v?{}:v,y=UR(l,["space","textStyle","shape","background","state"]),m=r,_=0;(null===(t=this.attribute.label)||void 0===t?void 0:t.visible)&&!1===this.attribute.label.inside&&(_=ut(this.attribute.label,"style.fontSize",12)+ut(this.attribute.label,"space",4));var b=0;(null===(e=this.attribute.tick)||void 0===e?void 0:e.visible)&&!1===this.attribute.tick.inside&&(b=this.attribute.tick.length||4),(null===(i=this.attribute.subTick)||void 0===i?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(b=Math.max(b,this.attribute.subTick.length||2));var x=a+b+_+c,k="middle",S=this.attribute.title.position;j(S)&&(S=0===s?"end":"middle"),"start"===S?(k="bottom",m={x:r.x,y:r.y-x}):"end"===S&&(k="top",m={x:r.x,y:r.y+x});var A=Object.assign(Object.assign(Object.assign({},m),y),{textStyle:Object.assign({textBaseline:k,textAlign:"center"},d),state:{text:gt({},PE,g.text),shape:gt({},PE,g.shape),panel:gt({},PE,g.background)}}),M=y.angle;return A.angle=M,p&&p.visible&&(A.shape=Object.assign({visible:!0},p.style),p.space&&(A.space=p.space)),f&&f.visible&&(A.panel=Object.assign({visible:!0},f.style)),A}},{key:"getSubTickLineItems",value:function(){var t,e,i=this.attribute.subTick,n=[],r=i.count,a=void 0===r?4:r,o=i.inside,s=void 0!==o&&o,l=i.length,u=void 0===l?2:l,c=this.tickLineItems,h=c.length;if(h>=2)for(var d=this.data[1].value-this.data[0].value,p=null===(e=null===(t=this.attribute)||void 0===t?void 0:t.tick)||void 0===e?void 0:e.alignWithLabel,f=0;f<h;f++)for(var v=c[f],g=c[f+1],y=0;y<a;y++){var m=(y+1)/(a+1),_=(1-m)*v.value+m*(g?g.value:p?1:v.value+d),b=this.getTickCoord(_),x=this.getVerticalCoord(b,u,s);n.push({start:b,end:x,value:_})}return n}},{key:"beforeLabelsOverlap",value:function(t,e,i,n,r){}},{key:"handleLabelsOverlap",value:function(t,e,i,n,r){if(!lt(t)){var a=this.attribute,o=a.inside,s=a.radius,l=a.center,u=a.size,c=a.label,h=a.orient,d=u?{x1:0,y1:0,x2:u.width,y2:u.height}:{x1:l.x-s,y1:l.y-s,x2:l.x+s,y2:l.y+s},p=c.layoutFunc,f=c.autoLimit,v=c.limitEllipsis,g=c.autoHide,y=c.autoHideMethod,m=c.autoHideSeparation,_=c.autoWrap;V(p)?p(t,e,n,this):((f||_)&&function(t,e){var i=e.ellipsis,n=e.inside,r=e.bounds,a=e.autoWrap,o=e.center;n||t.forEach((function(e,n){var s=e.attribute,l=s.x,u=s.y,c=e.AABBBounds;if(Ut(l,o.x)){if(u>r.y2||u<r.y1)return void VR(e,0,i);var h=r.x2-r.x1;if(t.length>=3){var d=NR(t,n),p=d.prevLabel,f=d.nextLabel,v=p.attribute.x,g=f.attribute.x;v>g&&(v=f.attribute.x,g=p.attribute.x);var y=v===g?h:l>=v&&l<=g?g-v:Math.min(Math.abs(v-l),Math.abs(g-l));e.AABBBounds.width()>y&&VR(e,y,i)}else e.AABBBounds.width()>h&&VR(e,h,i)}else l>o.x&&c.x2>r.x2?(VR(e,r.x2-l,i),a&&jR(t,n,r)):l<o.x&&c.x1<r.x1&&(VR(e,l-r.x1,i),a&&jR(t,n,r))}))}(t,{inside:o,autoWrap:_,bounds:d,ellipsis:v,center:l}),g&&$E(t,{orient:h,method:y,separation:m}))}}},{key:"afterLabelsOverlap",value:function(t,e,i,n,r){}},{key:"getTextBaseline",value:function(t){return Math.abs(t[1]/t[0])<.3?"middle":t[1]<0?"bottom":t[1]>0?"top":"middle"}},{key:"getLabelAlign",value:function(t,e,i){return Ut(t[0],0)?{textAlign:"center",textBaseline:t[1]>0?"top":"bottom"}:t[0]<0?{textAlign:"right",textBaseline:this.getTextBaseline(t)}:t[0]>0?{textAlign:"left",textBaseline:this.getTextBaseline(t)}:{textAlign:"center",textBaseline:"middle"}}},{key:"getLabelPosition",value:function(t,e,i,n){return t}}])}(qE);WR.defaultAttributes=BE,kt(WR,HR);var GR,YR=function(t){return t.map((function(t,e){return{index:e,value:t}}))},XR=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=new _i(t).expand(i/2),r=new _i(e).expand(i/2);return n.intersects(r)},KR=function(t,e,i,n){return i<t?Math.max(t-e/2,i):i>t?Math.min(t-e/2,i-e):i<n?i:i-e},qR=function(t,e,i){var n,r,a,o=i.labelStyle,s=i.axisOrientType,l=i.labelFlush,u=i.labelFormatter,c=i.startAngle,h=void 0===c?0:c,d=null!==(n=o.angle)&&void 0!==n?n:0;"vertical"===o.direction&&(d+=Fe(90));var p=["bottom","top"].includes(s),f=["left","right"].includes(s),v=1,g=0;p||(f?(v=0,g=1):h&&(v=Math.cos(h),g=-Math.sin(h)));for(var y=UC(o),m=t.range(),_=[],b=0;b<e.length;b++){var x=e[b],k=u?u(x):"".concat(x);if(Y(k)){_=void 0;break}var S=y.quickMeasure(k),A=S.width,M=S.height,T=Math.max(A,12),w=Math.max(M,12),C=t.scale(x),E=v*C,P=g*C,B=void 0,R=void 0,L=E,I=P;l&&p&&0===b?L=KR(E,T,m[0],m[m.length-1]):l&&p&&b===e.length-1?L=KR(E,T,m[m.length-1],m[0]):B=null!==(r=o.textAlign)&&void 0!==r?r:"center","right"===B?L-=T:"center"===B&&(L-=T/2),l&&f&&0===b?I=KR(P,w,m[0],m[m.length-1]):l&&f&&b===e.length-1?I=KR(P,w,m[m.length-1],m[0]):R=null!==(a=o.textBaseline)&&void 0!==a?a:"middle","bottom"===R?I-=w:"middle"===R&&(I-=w/2);var D=(new _i).set(L,I,L+T,I+w);d&&D.rotate(d,E,P),_.push(D)}return _};!function(t){t.Identity="identity",t.Linear="linear",t.Log="log",t.Pow="pow",t.Sqrt="sqrt",t.Symlog="symlog",t.Time="time",t.Quantile="quantile",t.Quantize="quantize",t.Threshold="threshold",t.Ordinal="ordinal",t.Point="point",t.Band="band"}(GR||(GR={}));var ZR={};function JR(t){switch(t){case GR.Linear:case GR.Log:case GR.Pow:case GR.Sqrt:case GR.Symlog:case GR.Time:return!0;default:return!1}}function QR(t){return!!ZR[t]}function $R(t){switch(t){case GR.Ordinal:case GR.Point:case GR.Band:return!0;default:return!1}}function tL(t){return t}Object.values(GR).forEach((function(t){ZR[t]=!0}));var eL=function(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)},iL=function(t){return t<0?-t*t:t*t},nL=function(t){return-Math.log(-t)},rL=function(t){return-Math.exp(-t)},aL=function(t){return isFinite(t)?Math.pow(10,t):t<0?0:t},oL=function(t){return 10===t?aL:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}},sL=function(t){return t===Math.E?Math.log:10===t?Math.log10:2===t?Math.log2:(t=Math.log(t),function(e){return Math.log(e)/t})},lL=function(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}},uL=function(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}};function cL(t,e){if(t=Number(t),e=Number(e),e-=t)return function(i){return(i-t)/e};var i=Number.isNaN(e)?NaN:.5;return function(){return i}}function hL(t,e,i){var n,r,a=t[0],o=t[1],s=e[0],l=e[1];return o<a?(n=cL(o,a),r=i(l,s)):(n=cL(a,o),r=i(s,l)),function(t){return r(n(t))}}function dL(t,e,i){var n;return n=1===t?t+2*i:t-e+2*i,t?n>0?n:1:0}function pL(t,e,i,n){return 1===i&&(i=0),dL(t,i,n)*(e/(1-i))}function fL(t,e){var i=(t[1]-t[0])/(e[1]-e[0]),n=t[0]-i*e[0];return[n,i+n]}function vL(t,e,i){var n=Math.min(t.length,e.length)-1,r=new Array(n),a=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)r[o]=cL(t[o],t[o+1]),a[o]=i(e[o],e[o+1]);return function(e){var i=Ft(t,e,1,n)-1;return a[i](r[i](e))}}var gL=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=Math.floor(Math.log10(t)),n=t/Math.pow(10,i);return(e?n<1.5?1:n<3?2:n<7?5:10:n<=1?1:n<=2?2:n<=5?5:10)*Math.pow(10,i)},yL=function(){return o((function t(){r(this,t),this._rangeFactorStart=null,this._rangeFactorEnd=null}),[{key:"_calculateWholeRange",value:function(t){return this._wholeRange?this._wholeRange:U(this._rangeFactorStart)&&U(this._rangeFactorEnd)&&2===t.length?(this._wholeRange=fL(t,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):t}},{key:"rangeFactor",value:function(t,e,i){return t?(2===t.length&&t.every((function(t){return t>=0&&t<=1}))&&(this._wholeRange=null,0===t[0]&&1===t[1]?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t[0],this._rangeFactorEnd=t[1])),this):i?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):U(this._rangeFactorStart)&&U(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}},{key:"rangeFactorStart",value:function(t,e){var i;return j(t)?this._rangeFactorStart:(t>=0&&t<=1&&(this._wholeRange=null,0!==t||!j(this._rangeFactorEnd)&&1!==this._rangeFactorEnd?(this._rangeFactorStart=t,this._rangeFactorEnd=null!==(i=this._rangeFactorEnd)&&void 0!==i?i:1):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}},{key:"rangeFactorEnd",value:function(t,e){var i;return j(t)?this._rangeFactorEnd:(t>=0&&t<=1&&(this._wholeRange=null,0!==t||!j(this._rangeFactorStart)&&0!==this._rangeFactorStart?(this._rangeFactorEnd=t,this._rangeFactorStart=null!==(i=this._rangeFactorStart)&&void 0!==i?i:0):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}},{key:"generateFishEyeTransform",value:function(){var t;if(this._fishEyeOptions){var e=this._fishEyeOptions,i=e.distortion,n=void 0===i?2:i,r=e.radiusRatio,a=void 0===r?.1:r,o=e.radius,s=this.range(),l=s[0],u=s[s.length-1],c=Math.min(l,u),h=Math.max(l,u),d=Xt(null!==(t=this._fishEyeOptions.focus)&&void 0!==t?t:0,c,h),p=j(o)?(h-c)*a:o,f=Math.exp(n);f=f/(f-1)*p;var v=n/p;this._fishEyeTransform=function(t){var e=Math.abs(t-d);if(e>=p)return t;if(e<=1e-6)return d;var i=f*(1-Math.exp(-e*v))/e*.75+.25;return d+(t-d)*i}}else this._fishEyeTransform=null}},{key:"unknown",value:function(t){return arguments.length?(this._unknown=t,this):this._unknown}},{key:"get",value:function(t,e){var i;return null!==(i=null==this?void 0:this[t])&&void 0!==i?i:e}}])}(),mL=Symbol("implicit"),_L=function(t){function e(){var t;return r(this,e),(t=n(this,e)).type=GR.Ordinal,t._index=new Map,t._domain=[],t._ordinalRange=[],t._unknown=mL,t}return h(e,t),o(e,[{key:"specified",value:function(t){var e;return t?(this._specified=Object.assign(null!==(e=this._specified)&&void 0!==e?e:{},t),this):Object.assign({},this._specified)}},{key:"_getSpecifiedValue",value:function(t){if(this._specified)return this._specified[t]}},{key:"clone",value:function(){var t=(new e).domain(this._domain).range(this._ordinalRange).unknown(this._unknown);return this._specified&&t.specified(this._specified),t}},{key:"calculateVisibleDomain",value:function(t){return U(this._rangeFactorStart)&&U(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:this._domain}},{key:"scale",value:function(t){var e="".concat(t),i=this._getSpecifiedValue(e);if(void 0!==i)return i;var n=this._index.get(e);if(!n){if(this._unknown!==mL)return this._unknown;n=this._domain.push(t),this._index.set(e,n)}var r=this._ordinalRange[(n-1)%this._ordinalRange.length];return this._fishEyeTransform?this._fishEyeTransform(r):r}},{key:"invert",value:function(t){for(var e=0;e<this._ordinalRange.length&&this._ordinalRange[e]!==t;)e++;return this._domain[(e-1)%this._domain.length]}},{key:"domain",value:function(t){if(!t)return this._domain.slice();this._domain=[],this._index=new Map;var e,i=s(t);try{for(i.s();!(e=i.n()).done;){var n=e.value,r="".concat(n);this._index.has(r)||this._index.set(r,this._domain.push(n))}}catch(t){i.e(t)}finally{i.f()}return this}},{key:"range",value:function(t){if(!t)return this._ordinalRange.slice();var e=Array.from(t);return this._ordinalRange=e,this}},{key:"index",value:function(t){var e;return this._index&&null!==(e=this._index.get("".concat(t)))&&void 0!==e?e:-1}}])}(yL);function bL(t,e,i,n){for(var r=[],a=t;a<=e;)r.push(a),a+=i;return n&&r.reverse(),r}function xL(t,e,i,n){var r,a;if(e=Math.floor(+e),t=Math.floor(+t),!(i=Math.floor(+i)))return[];if(t===e)return[t];if(r=e<t){var o=t;t=e,e=o}var s=qt(1,e-t+1)(i);if(a=Math.floor((e-t+1)/s),!n)for(;Math.ceil((e-t+1)/a)>i&&s>1;)s-=1,a=Math.floor((e-t)/s);return bL(t,e,a,r)}var kL=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).type=GR.Band,i._range=[0,1],i._step=void 0,i._bandwidth=void 0,i._isFixed=!1,i._round=!1,i._paddingInner=0,i._paddingOuter=0,i._align=.5,i._unknown=void 0,delete i.unknown,i.rescale(t),i}return h(e,t),o(e,[{key:"rescale",value:function(t,i){if(t)return this;this._wholeRange=null;var n=this._calculateWholeRange(this._range,i),r=_(e,"domain",this,3)([]).length,a=n[1]<n[0],o=n[Number(a)-0],s=n[1-Number(a)],l=dL(r,this._paddingInner,this._paddingOuter);return this._step=(s-o)/Math.max(1,l||1),this._round&&(this._step=Math.floor(this._step)),o+=(s-o-this._step*(r-this._paddingInner))*this._align,this.isBandwidthFixed()||(this._bandwidth=this._step*(1-this._paddingInner)),this._round&&(o=Math.round(o),this.isBandwidthFixed()||(this._bandwidth=Math.round(this._bandwidth))),this._bandRangeState={reverse:a,start:a?o+this._step*(r-1):o,count:r},this.generateFishEyeTransform(),this}},{key:"scale",value:function(t){if(this._bandRangeState){var e="".concat(t),i=this._getSpecifiedValue(e);if(void 0!==i)return i;var n=this._index.get(e);if(!n){if(this._unknown!==mL)return this._unknown;n=this._domain.push(t),this._index.set(e,n)}var r=this._bandRangeState,a=r.count,o=r.start+(n-1)%a*(r.reverse?-1:1)*this._step;return this._fishEyeTransform?this._fishEyeTransform(o):o}}},{key:"_calculateWholeRange",value:function(t,i){if(this._wholeRange)return this._wholeRange;if((this._minBandwidth||this._maxBandwidth)&&!this._isBandwidthFixedByUser()){var n;if(U(this._rangeFactorStart)&&U(this._rangeFactorEnd)&&2===t.length){var r=fL(t,[this._rangeFactorStart,this._rangeFactorEnd]);n=Math.abs(r[1]-r[0])}else n=Math.abs(t[1]-t[0]);var a=function(t,e,i,n,r){var a=dL(t,i,n),o=e/Math.max(1,a||1);r&&(o=Math.floor(o));var s=o*(1-i);return r&&(s=Math.round(s)),s}(_(e,"domain",this,3)([]).length,n,this._paddingInner,this._paddingOuter,this._round);a<this._minBandwidth?(this._bandwidth=this._minBandwidth,this._isFixed=!0):a>this._maxBandwidth?(this._bandwidth=this._maxBandwidth,this._isFixed=!0):(this._bandwidth=a,this._isFixed=!1)}if(this.isBandwidthFixed()){var o=pL(_(e,"domain",this,3)([]).length,this._bandwidth,this._paddingInner,this._paddingOuter)*Math.sign(t[1]-t[0]),s=Math.min((t[1]-t[0])/o,1);if(U(this._rangeFactorStart)&&U(this._rangeFactorEnd)){var l=this._rangeFactorStart+s<=1,u=this._rangeFactorEnd-s>=0;if("rangeFactorStart"===i&&l?this._rangeFactorEnd=this._rangeFactorStart+s:"rangeFactorEnd"===i&&u?this._rangeFactorStart=this._rangeFactorEnd-s:t[0]<=t[1]?l?this._rangeFactorEnd=this._rangeFactorStart+s:u?this._rangeFactorStart=this._rangeFactorEnd-s:(this._rangeFactorStart=0,this._rangeFactorEnd=s):u?this._rangeFactorStart=this._rangeFactorEnd-s:l?this._rangeFactorEnd=this._rangeFactorStart+s:(this._rangeFactorStart=1-s,this._rangeFactorEnd=1),o>0){var c=t[0]-o*this._rangeFactorStart,h=c+o;this._wholeRange=[c,h]}else{var d=t[1]+o*(1-this._rangeFactorEnd),p=d-o;this._wholeRange=[p,d]}}else this._rangeFactorStart=0,this._rangeFactorEnd=s,this._wholeRange=[t[0],t[0]+o];return this._wholeRange}return _(e,"_calculateWholeRange",this,3)([t])}},{key:"calculateWholeRangeSize",value:function(){var t=this._calculateWholeRange(this._range);return Math.abs(t[1]-t[0])}},{key:"calculateVisibleDomain",value:function(t){var e=this._domain;if(U(this._rangeFactorStart)&&U(this._rangeFactorEnd)&&e.length){var i=this._getInvertIndex(t[0]),n=this._getInvertIndex(t[1]);return e.slice(Math.min(i,n),Math.max(i,n)+1)}return e}},{key:"domain",value:function(t,i){return t?(_(e,"domain",this,3)([t]),this.rescale(i)):_(e,"domain",this,3)([])}},{key:"range",value:function(t,e){return t?(this._range=[Rt(t[0]),Rt(t[1])],this.rescale(e)):this._range}},{key:"rangeRound",value:function(t,e){return this._range=[Rt(t[0]),Rt(t[1])],this._round=!0,this.rescale(e)}},{key:"ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return-1===t?e:xL(0,e.length-1,t,!1).map((function(t){return e[t]}))}},{key:"tickData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this.ticks(e).map((function(e,i){return{index:i,tick:e,value:(t.scale(e)-t._range[0]+t._bandwidth/2)/(t._range[1]-t._range[0])}}))}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return xL(0,e.length-1,t,!0).filter((function(t){return t<e.length})).map((function(t){return e[t]}))}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return function(t,e,i){var n;if(i=qt(1,(e=Math.floor(+e))-(t=Math.floor(+t))+1)(Math.floor(+i)),n=e<t){var r=t;t=e,e=r}return bL(t,e,i,n)}(0,e.length-1,t).map((function(t){return e[t]}))}},{key:"_getInvertIndex",value:function(t){var e=0,i=this.step()/2,n=this.bandwidth()/2,r=this._domain.length,a=this.range(),o=a[0]>a[a.length-1];for(e=0;e<r;e++){var s=this.scale(this._domain[e])+n;if(0===e&&(!o&&!Wt(t,s+i)||o&&!Gt(t,s-i)))break;if(e===r-1)break;if(!Gt(t,s-i)&&!Wt(t,s+i))break}return e>=0&&e<=r-1?e:r-1}},{key:"invert",value:function(t){return this._domain[this._getInvertIndex(t)]}},{key:"padding",value:function(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(Array.isArray(t)?Math.min.apply(null,t):t)),this._paddingInner=this._paddingOuter,this.rescale(e)):this._paddingInner}},{key:"paddingInner",value:function(t,e){return void 0!==t?(this._paddingInner=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingInner}},{key:"paddingOuter",value:function(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingOuter}},{key:"step",value:function(){return this._step}},{key:"round",value:function(t,e){return void 0!==t?(this._round=t,this.rescale(e)):this._round}},{key:"align",value:function(t,e){return void 0!==t?(this._align=Math.max(0,Math.min(1,t)),this.rescale(e)):this._align}},{key:"rangeFactor",value:function(t,i){return t?(_(e,"rangeFactor",this,3)([t]),this.rescale(i)):_(e,"rangeFactor",this,3)([])}},{key:"rangeFactorStart",value:function(t,i){return j(t)?_(e,"rangeFactorStart",this,3)([]):(_(e,"rangeFactorStart",this,3)([t]),this.rescale(i,"rangeFactorStart"))}},{key:"rangeFactorEnd",value:function(t,i){return j(t)?_(e,"rangeFactorEnd",this,3)([]):(_(e,"rangeFactorEnd",this,3)([t]),this.rescale(i,"rangeFactorEnd"))}},{key:"bandwidth",value:function(t,e){return t?("auto"===t?(this._bandwidth=void 0,this._isFixed=!1):(this._bandwidth=t,this._isFixed=!0),this._userBandwidth=t,this.rescale(e)):this._bandwidth}},{key:"maxBandwidth",value:function(t,e){return t?(this._maxBandwidth="auto"===t?void 0:t,this.rescale(e)):this._maxBandwidth}},{key:"minBandwidth",value:function(t,e){return t?(this._minBandwidth="auto"===t?void 0:t,this.rescale(e)):this._minBandwidth}},{key:"fishEye",value:function(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}},{key:"isBandwidthFixed",value:function(){return this._isFixed&&!!this._bandwidth}},{key:"_isBandwidthFixedByUser",value:function(){return this._isFixed&&this._userBandwidth&&Q(this._userBandwidth)}},{key:"clone",value:function(){var t,i,n;return new e(!0).domain(this._domain,!0).range(this._range,!0).round(this._round,!0).paddingInner(this._paddingInner,!0).paddingOuter(this._paddingOuter,!0).align(this._align,!0).bandwidth(null!==(t=this._userBandwidth)&&void 0!==t?t:"auto",!0).maxBandwidth(null!==(i=this._maxBandwidth)&&void 0!==i?i:"auto",!0).minBandwidth(null!==(n=this._maxBandwidth)&&void 0!==n?n:"auto")}}])}(_L),SL=function(t,e){var i=t.r,n=e.r,r=t.g,a=e.g,o=t.b,s=e.b,l=t.opacity,u=e.opacity;return function(t){var e=Math.round(i*(1-t)+n*t),c=Math.round(r*(1-t)+a*t),h=Math.round(o*(1-t)+s*t);return new Ii(e,c,h,l*(1-t)+u*t)}};function AL(t,e){var i,n=k(e);if(j(e)||"boolean"===n)return function(){return e};if("number"===n)return $t(t,e);if("string"===n){if(i=Li.parseColorString(e)){var r=SL(Li.parseColorString(t),i);return function(t){return r(t).formatRgb()}}return $t(Number(t),Number(e))}return e instanceof Ii?SL(t,e):e instanceof Li?SL(t.color,e.color):e instanceof Date?function(t,e){var i=t.valueOf(),n=e.valueOf(),r=new Date;return function(t){return r.setTime(i*(1-t)+n*t),r}}(t,e):$t(Number(t),Number(e))}var ML=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tL,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tL;return r(this,e),(t=n(this,e))._unknown=void 0,t.transformer=i,t.untransformer=a,t._forceAlign=!0,t._domain=[0,1],t._range=[0,1],t._clamp=tL,t._piecewise=hL,t._interpolate=AL,t}return h(e,t),o(e,[{key:"calculateVisibleDomain",value:function(t){var e;return U(this._rangeFactorStart)&&U(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:null!==(e=this._niceDomain)&&void 0!==e?e:this._domain}},{key:"fishEye",value:function(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}},{key:"scale",value:function(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!==(e=this._niceDomain)&&void 0!==e?e:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));var i=this._output(this.transformer(this._clamp(t)));return this._fishEyeTransform?this._fishEyeTransform(i):i}},{key:"invert",value:function(t){var e;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),(null!==(e=this._niceDomain)&&void 0!==e?e:this._domain).map(this.transformer),$t)),this._clamp(this.untransformer(this._input(t)))}},{key:"domain",value:function(t,e){var i;if(!t)return(null!==(i=this._niceDomain)&&void 0!==i?i:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;var n=Array.from(t,Rt);return this._domain=n,this.rescale(e)}},{key:"range",value:function(t,e){if(!t)return this._range.slice();var i=Array.from(t);return this._range=i,this.rescale(e)}},{key:"rangeRound",value:function(t,e){var i=Array.from(t);return this._range=i,this._interpolate=te,this.rescale(e)}},{key:"rescale",value:function(t){var e;if(t)return this;var i=null!==(e=this._niceDomain)&&void 0!==e?e:this._domain,n=i.length,r=this._range.length,a=Math.min(n,r);if(n&&n<r&&this._forceAlign){for(var o=r-n+1,s=i[n-1],l=n>=2?(s-i[n-2])/o:0,u=1;u<=o;u++)i[n-2+u]=s-l*(o-u);a=r}return this._autoClamp&&(this._clamp=qt(i[0],i[a-1])),this._piecewise=a>2?vL:hL,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}},{key:"clamp",value:function(t,e,i){return arguments.length?(e?(this._autoClamp=!1,this._clamp=e):(this._autoClamp=!!t,this._clamp=t?void 0:tL),this.rescale(i)):this._clamp!==tL}},{key:"interpolate",value:function(t,e){return arguments.length?(this._interpolate=t,this.rescale(e)):this._interpolate}},{key:"ticks",value:function(){return[]}},{key:"tickData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=this.ticks(e);return(null!=i?i:[]).map((function(e,i){return{index:i,tick:e,value:(t.scale(e)-t._range[0])/(t._range[1]-t._range[0])}}))}},{key:"rangeFactor",value:function(t,i){return t?(_(e,"rangeFactor",this,3)([t]),this._output=this._input=null,this):_(e,"rangeFactor",this,3)([])}},{key:"rangeFactorStart",value:function(t,i){return j(t)?_(e,"rangeFactorStart",this,3)([]):(_(e,"rangeFactorStart",this,3)([t]),this._output=this._input=null,this)}},{key:"rangeFactorEnd",value:function(t,i){return j(t)?_(e,"rangeFactorEnd",this,3)([]):(_(e,"rangeFactorEnd",this,3)([t]),this._output=this._input=null,this)}},{key:"forceAlignDomainRange",value:function(t){return arguments.length?(this._forceAlign=t,this):this._forceAlign}}])}(yL),TL=Math.sqrt(50),wL=Math.sqrt(10),CL=Math.sqrt(2),EL=[1,2,5,10],PL=function(t,e,i){var n=1,r=t,a=Math.floor((e-1)/2),o=Math.abs(t);return t>=0&&t<=Number.MIN_VALUE?r=0:t<0&&t>=-Number.MIN_VALUE?r=-(e-1):!i&&o<1?n=IL(o).step:(i||o>1)&&(r=Math.floor(t)-a*n),n>0?(t>0?r=Math.max(r,0):t<0&&(r=Math.min(r,-(e-1)*n)),Pt(0,e).map((function(t){return r+t*n}))):t>0?RL(0,-(e-1)/n,n):RL((e-1)/n,0,n)},BL=Yt((function(t,e,i,n){var r,a,o,s,l=-1;if(i=+i,(t=+t)==(e=+e))return[t];if(Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return[t];if((r=e<t)&&(a=t,t=e,e=a),s=DL(t,e,i).step,!isFinite(s))return[];if(s>0){var u=Math.round(t/s),c=Math.round(e/s);for(u*s<t&&++u,c*s>e&&--c,o=new Array(a=c-u+1);++l<a;)o[l]=(u+l)*s}else if(s<0&&(null==n?void 0:n.noDecimals)){s=1;var h=Math.ceil(t),d=Math.floor(e);if(!(h<=d))return[];for(o=new Array(a=d-h+1);++l<a;)o[l]=h+l}else{s=-s;var p=Math.round(t*s),f=Math.round(e*s);for(p/s<t&&++p,f/s>e&&--f,o=new Array(a=f-p+1);++l<a;)o[l]=(p+l)/s}return r&&o.reverse(),o})),RL=function(t,e,i){var n,r,a=-1;if(i>0){var o=Math.floor(t/i),s=Math.ceil(e/i);for((o+1)*i<t&&++o,(s-1)*i>e&&--s,r=new Array(n=s-o+1);++a<n;)r[a]=(o+a)*i}else{i=-i;var l=Math.floor(t*i),u=Math.ceil(e*i);for((l+1)/i<t&&++l,(u-1)/i>e&&--u,r=new Array(n=u-l+1);++a<n;)r[a]=(l+a)/i}return r},LL=Yt((function(t,e,i,n){var r,a,o;if(i=+i,(t=+t)==(e=+e))return PL(t,i,null==n?void 0:n.noDecimals);if(Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return PL(t,i,null==n?void 0:n.noDecimals);(r=e<t)&&(o=t,t=e,e=o);var s=DL(t,e,i),l=s.step;if(!isFinite(l))return[];if(l>0){for(var u=1,c=s.power,h=10===s.gap?2*Math.pow(10,c):1*Math.pow(10,c);u<=5&&(a=RL(t,e,l)).length>i+1&&i>2;)l+=h,u+=1;i>2&&a.length<i-1&&(a=function(t,e,i){var n,r=t[0],a=t[t.length-1],o=e-t.length;if(a<=0){var s=[];for(n=o;n>=1;n--)s.push(r-n*i);return s.concat(t)}if(r>=0){for(n=1;n<=o;n++)t.push(a+n*i);return t}var l=[],u=[];for(n=1;n<=o;n++)n%2==0?l=[r-Math.floor(n/2)*i].concat(l):u.push(a+Math.ceil(n/2)*i);return l.concat(t).concat(u)}(a,i,l))}else(null==n?void 0:n.noDecimals)&&l<0&&(l=1),a=RL(t,e,l);return r&&a.reverse(),a})),IL=function(t){var e=Math.floor(Math.log(t)/Math.LN10),i=t/Math.pow(10,e),n=EL[0];return i>=TL?n=EL[3]:i>=wL?n=EL[2]:i>=CL&&(n=EL[1]),e>=0?{step:n*Math.pow(10,e),gap:n,power:e}:{step:-Math.pow(10,-e)/n,gap:n,power:e}};function DL(t,e,i){var n=(e-t)/Math.max(0,i);return IL(n)}function OL(t,e,i){var n;if(i=+i,(t=+t)==(e=+e)&&i>0)return[t];if(i<=0||0===(n=function(t,e,i){return(e-t)/Math.max(1,i-1)}(t,e,i))||!isFinite(n))return[];for(var r=new Array(i),a=0;a<i;a++)r[a]=t+a*n;return r}function FL(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=0,a=t.length-1,o=t[r],s=t[a],l=10;for(s<o&&(i=o,o=s,s=i,i=r,r=a,a=i);l-- >0;){if((i=DL(o,s,n).step)===e)return t[r]=o,t[a]=s,t;if(i>0)o=Math.floor(o/i)*i,s=Math.ceil(s/i)*i;else{if(!(i<0))break;o=Math.ceil(o*i)/i,s=Math.floor(s*i)/i}e=i}}function zL(t,e){var i=Q(e.forceMin),n=Q(e.forceMax),r=null,a=[],o=null,s=i&&n?function(t){return t>=e.forceMin&&t<=e.forceMax}:i?function(t){return t>=e.forceMin}:n?function(t){return t<=e.forceMax}:null;return i?a[0]=e.forceMin:Q(e.min)&&e.min<=Math.min(t[0],t[t.length-1])&&(a[0]=e.min),n?a[1]=e.forceMax:Q(e.max)&&e.max>=Math.max(t[0],t[t.length-1])&&(a[1]=e.max),Q(a[0])&&Q(a[1])?((o=t.slice())[0]=a[0],o[o.length-1]=a[1]):r=Q(a[0])||Q(a[1])?Q(a[0])?"max":"min":"all",{niceType:r,niceDomain:o,niceMinMax:a,domainValidator:s}}var HL=function(t,e,i){return Math.abs(e-t)<1?+i.toFixed(1):Math.round(+i)},NL=Yt((function(t,e,i,n,r,a,o){var s,l=t,u=e,c=u<l;c&&(l=(s=[u,l])[0],u=s[1]);var h,d,p=r(l),f=r(u),v=[];if(!(n%1)&&f-p<i){if(p=Math.floor(p),f=Math.ceil(f),l>0){for(;p<=f;++p)for(h=1;h<n;++h)if(!((d=p<0?h/a(-p):h*a(p))<l)){if(d>u)break;v.push(d)}}else for(;p<=f;++p)for(h=n-1;h>=1;--h)if(!((d=p>0?h/a(-p):h*a(p))<l)){if(d>u)break;v.push(d)}2*v.length<i&&(v=LL(l,u,i))}else v=LL(p,f,Math.min(f-p,i)).map(a);return v=v.filter((function(t){return 0!==t})),(null==o?void 0:o.noDecimals)&&(v=Array.from(new Set(v.map((function(t){return Math.floor(t)}))))),c?v.reverse():v})),VL=Yt((function(t,e,i,n,r,a){var o=[],s={},l=r(t),u=r(e),c=[];if(Number.isInteger(n))c=LL(l,u,i);else for(var h=(u-l)/(i-1),d=0;d<i;d++)c.push(l+d*h);return c.forEach((function(i){var r=a(i),l=Number.isInteger(n)?HL(t,e,r):HL(t,e,gL(r)),u=HL(t,e,function(t,e){var i,n;return e[0]<e[1]?(i=e[0],n=e[1]):(i=e[1],n=e[0]),Math.min(Math.max(t,i),n)}(l,[t,e]));!s[u]&&!isNaN(u)&&c.length>1&&(s[u]=1,o.push(u))})),o})),jL=Yt((function(t,e,i,n,r){return OL(n(t),n(e),i).map((function(t){return gL(r(t))}))})),UL=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type=GR.Linear,t}return h(e,t),o(e,[{key:"clone",value:function(){var t,i=new e;return i.domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate),this._niceType&&(i._niceType=this._niceType,i._domainValidator=this._domainValidator,i._niceDomain=null===(t=this._niceDomain)||void 0===t?void 0:t.slice()),i}},{key:"tickFormat",value:function(){return function(){}}},{key:"d3Ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1?arguments[1]:void 0,i=this.calculateVisibleDomain(this._range);return BL(i[0],i[i.length-1],t,e)}},{key:"ticks",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=arguments.length>1?arguments[1]:void 0;if(V(null==i?void 0:i.customTicks))return i.customTicks(this,e);if(U(this._rangeFactorStart)&&U(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&2===this._range.length||!this._niceType)return this.d3Ticks(e,i);var n=null!==(t=this._niceDomain)&&void 0!==t?t:this._domain,r=this._domain,a=n[0],o=n[n.length-1],s=LL(r[0],r[r.length-1],e,i);if(!s.length)return s;if(this._domainValidator)s=s.filter(this._domainValidator);else if((s[0]!==a||s[s.length-1]!==o)&&this._niceType){var l=n.slice();if("all"===this._niceType?(l[0]=s[0],l[l.length-1]=s[s.length-1],this._niceDomain=l,this.rescale()):"min"===this._niceType&&s[0]!==a?(l[0]=s[0],this._niceDomain=l,this.rescale()):"max"===this._niceType&&s[s.length-1]!==o&&(l[l.length-1]=s[s.length-1],this._niceDomain=l,this.rescale()),"all"!==this._niceType){var u=Math.min(l[0],l[l.length-1]),c=Math.max(l[0],l[l.length-1]);s=s.filter((function(t){return t>=u&&t<=c}))}}return s}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return OL(e[0],e[e.length-1],t)}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return function(t,e,i){var n,r,a=-1;if(i=+i,(r=(e=+e)<(t=+t))&&(n=t,t=e,e=n),!isFinite(i)||e-t<=i)return[t];for(var o=Math.floor((e-t)/i+1),s=new Array(o);++a<o;)s[a]=t+a*i;return r&&s.reverse(),s}(e[0],e[e.length-1],t)}},{key:"nice",value:function(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=arguments.length>1?arguments[1]:void 0,r=this._domain,a=[];if(n){var o=zL(r,n);if(a=o.niceMinMax,this._domainValidator=o.domainValidator,this._niceType=o.niceType,o.niceDomain)return this._niceDomain=o.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){var s=FL(r.slice(),i);"min"===this._niceType?s[s.length-1]=null!==(t=a[1])&&void 0!==t?t:s[s.length-1]:"max"===this._niceType&&(s[0]=null!==(e=a[0])&&void 0!==e?e:s[0]),this._niceDomain=s,this.rescale()}return this}},{key:"niceMin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;this._niceType="min";var e=this._domain[this._domain.length-1],i=FL(this.domain(),t);return i&&(i[i.length-1]=e,this._niceDomain=i,this.rescale()),this}},{key:"niceMax",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;this._niceType="max";var e=this._domain[0],i=FL(this._domain.slice(),t);return i&&(i[0]=e,this._niceDomain=i,this.rescale()),this}}])}(ML),WL=function(){return o((function t(){r(this,t)}),[{key:"nice",value:function(){var t,e,i,n,r=arguments.length>1?arguments[1]:void 0,a=this._domain,o=[],s=null;if(r){var l=zL(a,r);if(o=l.niceMinMax,this._domainValidator=l.domainValidator,s=l.niceType,l.niceDomain)return this._niceDomain=l.niceDomain,this.rescale(),this}else s="all";if(s){var u=function(t,e){var i,n,r=t.slice(),a=0,o=r.length-1,s=r[a],l=r[o];return l<s&&(a=(i=[o,a])[0],o=i[1],s=(n=[l,s])[0],l=n[1]),r[a]=e.floor(s),r[o]=e.ceil(l),r}(a.slice(),null!==(e=null===(t=this.getNiceConfig)||void 0===t?void 0:t.call(this))&&void 0!==e?e:{floor:function(t){return Math.floor(t)},ceil:function(t){return Math.ceil(t)}});return"min"===s?u[u.length-1]=null!==(i=o[1])&&void 0!==i?i:u[u.length-1]:"max"===s&&(u[0]=null!==(n=o[0])&&void 0!==n?n:u[0]),this._niceDomain=u,this.rescale(),this}return this}},{key:"niceMin",value:function(){var t=this._domain[this._domain.length-1];this.nice();var e=this._domain.slice();return this._domain&&(e[e.length-1]=t,this._niceDomain=e,this.rescale()),this}},{key:"niceMax",value:function(){var t=this._domain[0];this.nice();var e=this._domain.slice();return this._domain&&(e[0]=t,this._niceDomain=e,this.rescale()),this}}])}();function GL(t){return function(e){return-t(-e)}}function YL(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.EPSILON;return function(e){return Math.max(e,t)}}var XL=function(t){function e(){var t;return r(this,e),(t=n(this,e,[sL(10),oL(10)])).type=GR.Log,t._limit=YL(),t._logs=t.transformer,t._pows=t.untransformer,t._domain=[1,10],t._base=10,t}return h(e,t),o(e,[{key:"clone",value:function(){return(new e).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).base(this._base)}},{key:"rescale",value:function(t){var i;if(t)return this;_(e,"rescale",this,3)([]);var n=sL(this._base),r=oL(this._base);return(null!==(i=this._niceDomain)&&void 0!==i?i:this._domain)[0]<0?(this._logs=GL(n),this._pows=GL(r),this._limit=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.EPSILON;return function(e){return Math.min(e,-t)}}(),this.transformer=nL,this.untransformer=rL):(this._logs=n,this._pows=r,this._limit=YL(),this.transformer=this._logs,this.untransformer=r),this}},{key:"scale",value:function(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!==(e=this._niceDomain)&&void 0!==e?e:this._domain).map(this._limit).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));var i=this._output(this.transformer(this._limit(this._clamp(t))));return this._fishEyeTransform?this._fishEyeTransform(i):i}},{key:"base",value:function(t,e){return arguments.length?(this._base=t,this.rescale(e)):this._base}},{key:"tickFormat",value:function(){return tL}},{key:"d3Ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1?arguments[1]:void 0,i=this.domain(),n=this._limit(i[0]),r=this._limit(i[i.length-1]);return NL(n,r,t,this._base,this.transformer,this.untransformer,e)}},{key:"ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return VL(this._limit(e[0]),this._limit(e[e.length-1]),t,this._base,this.transformer,this.untransformer)}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return jL(e[0],e[e.length-1],t,this.transformer,this.untransformer)}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return jL(this._limit(e[0]),this._limit(e[e.length-1]),t,this.transformer,this.untransformer)}},{key:"getNiceConfig",value:function(){var t=this;return{floor:function(e){return t._pows(Math.floor(t._logs(t._limit(e))))},ceil:function(e){return Math.abs(e)>=1?Math.ceil(e):t._pows(Math.ceil(t._logs(t._limit(e))))}}}}])}(ML);kt(XL,WL);var KL=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[!1])).type=GR.Point,i._padding=0,i.paddingInner(1,t),i.padding=i.paddingOuter,i.paddingInner=void 0,i.paddingOuter=void 0,i}return h(e,t),o(e)}(kL),qL=function(t){function e(){var t;return r(this,e),(t=n(this,e,[eL,iL])).type=GR.Sqrt,t}return h(e,t),o(e,[{key:"clone",value:function(){return(new e).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}}])}(UL),ZL=function(t){function e(){var t;return r(this,e),(t=n(this,e,[lL(1),uL(1)])).type=GR.Symlog,t._const=1,t}return h(e,t),o(e,[{key:"clone",value:function(){return(new e).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).constant(this._const)}},{key:"constant",value:function(t,e){return arguments.length?(this._const=t,this.transformer=lL(t),this.untransformer=uL(t),this.rescale(e)):this._const}},{key:"d3Ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1?arguments[1]:void 0,i=this.domain(),n=i[0],r=i[i.length-1];return NL(n,r,t,this._const,this.transformer,this.untransformer,e)}},{key:"ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return VL(e[0],e[e.length-1],t,this._const,this.transformer,this.untransformer)}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return jL(e[0],e[e.length-1],t,this.transformer,this.untransformer)}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return jL(e[0],e[e.length-1],t,this.transformer,this.untransformer)}}])}(UL);kt(ZL,WL);var JL=function(){function t(){r(this,t),this.type=GR.Threshold,this._range=[0,1],this._domain=[.5],this.n=1}return o(t,[{key:"unknown",value:function(t){return arguments.length?(this._unknown=t,this):this._unknown}},{key:"scale",value:function(t){return!j(t)&&et(+t)?this._range[Ft(this._domain,t,0,this.n)]:this._unknown}},{key:"invertExtent",value:function(t){var e=this._range.indexOf(t);return[this._domain[e-1],this._domain[e]]}},{key:"domain",value:function(t){return t?(this._domain=Array.from(t),this.n=Math.min(this._domain.length,this._range.length-1),this):this._domain.slice()}},{key:"range",value:function(t){return t?(this._range=Array.from(t),this.n=Math.min(this._domain.length,this._range.length-1),this):this._range.slice()}},{key:"clone",value:function(){return(new t).domain(this._domain).range(this._range).unknown(this._unknown)}}])}();function QL(t,e,i,n){var r,a=t.breakData;if(a&&a()){var o=a().breakDomains,s=e.domain();r=[];for(var l=0;l<s.length-1;l++)n(i,[s[l],s[l+1]]).forEach((function(t){o.some((function(e){return t>=e[0]&&t<=e[1]}))||r.push(t)}));e.domain(s)}else r=n(i);return r}function $L(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(i&&!e.includes(t)){var a=e.length;if(a>1){r?e.push(t):e.unshift(t);for(var o=0;o<a;o++){var s=r?a-1-o:o;if(!n(e[s]))break;e.splice(s,1),o--,a--}}}}var tI=function(t,e){var i,n,r,a;if(!JR(t.type))return YR(t.domain());var o=t.range(),s=Math.abs(o[o.length-1]-o[0]);if(s<2)return YR([t.domain()[0]]);var l,u,c,h=e.tickCount,d=e.forceTickCount,p=e.tickStep,f=e.noDecimals,v=void 0!==f&&f,g=e.labelStyle,y=e.breakData;if(U(p))u=t.stepTicks(p),c=y&&y()?y().breakDomains:null,l=c&&c.length?u.filter((function(t){return c.every((function(e){return t<e[0]||t>e[1]}))})):u;else if(U(d))l=QL(e,t,d,(function(e,i){return i&&i.length?t.domain(i,!0).forceTicks(e):t.forceTicks(e)}));else if("d3"===e.tickMode){var m=null!==(i=V(h)?h({axisLength:s,labelStyle:g}):h)&&void 0!==i?i:5;l=QL(e,t,m,(function(e,i){return i&&i.length?t.domain(i,!0).d3Ticks(e,{noDecimals:v}):t.d3Ticks(e,{noDecimals:v})}))}else{var _=null!==(n=V(h)?h({axisLength:s,labelStyle:g}):h)&&void 0!==n?n:5,b=V(e.tickMode)?e.tickMode:void 0;l=QL(e,t,_,(function(e,i){return i&&i.length?t.domain(i,!0).ticks(e,{noDecimals:v,customTicks:b}):t.ticks(e,{noDecimals:v,customTicks:b})}))}var x=t.domain();if(e.labelFirstVisible&&x[0]!==l[0]&&!l.includes(x[0])&&l.unshift(x[0]),e.labelLastVisible&&x[x.length-1]!==l[l.length-1]&&!l.includes(x[x.length-1])&&l.push(x[x.length-1]),e.sampling&&l.length>1&&("cartesian"===e.coordinateType||"polar"===e.coordinateType&&"radius"===e.axisOrientType)){var k,S=e.labelGap,A=void 0===S?4:S,M=e.labelFlush;if(6*l.length>s){var T=[],w=Math.floor(6*l.length/s);l.forEach((function(t,e){e%w!=0&&e!==l.length-1||T.push(t)})),k=null===(r=qR(t,T,e))||void 0===r?void 0:r.map((function(t,e){return{AABBBounds:t,value:T[e]}}))}else k=null===(a=qR(t,l,e))||void 0===a?void 0:a.map((function(t,e){return{AABBBounds:t,value:l[e]}}));if(k){for(var C=k[0],E=At(k),P=y&&y()?eI.greedy:eI.parity;k.length>=3&&UE(k,A);)k=P(k,A);var B=e.labelFirstVisible,R=e.labelLastVisible;jE(C,E,A)&&k.includes(E)&&k.length>1&&B&&R&&(k.splice(k.indexOf(E),1),R=!1),$L(C,k,B,(function(t){return jE(t,C,A)})),$L(E,k,R,(function(t){return jE(t,E,A)||!(!B||t===C)&&jE(t,C,A)}),!0);var L=k.map((function(t){return t.value}));L.length<3&&M&&(L.length>1&&L.pop(),At(L)!==At(l)&&L.push(At(l))),l=L}}return YR(l)},eI={parity:function(t){return t.filter((function(t,e){return e%2==0}))},greedy:function(t,e){var i;return t.filter((function(t,n){return!(n&&jE(i,t,e)||(i=t,0))}))}},iI=function(t,e,i,n){var r=qR(t,e,i);return r&&r.map((function(t){return n?[t.x1,t.x2,t.width()]:[t.y1,t.y2,t.height()]}))},nI=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.max(t[0],e[0])-i/2<=Math.min(t[1],e[1])+i/2},rI=function(t,e){return t[1]<e[0]?e[0]-t[1]:e[1]<t[0]?t[0]-e[1]:0},aI=function(t,e){var i,n=t.domain();if(!n.length)return[];var r,a=e.tickCount,o=e.forceTickCount,s=e.tickStep,l=e.labelGap,u=void 0===l?4:l,c=e.axisOrientType,h=e.labelStyle,d=function(t){return["bottom","top","z"].includes(t)}(c),p=t.range(),f=t.calculateWholeRangeSize();if(f<2)return e.labelLastVisible?YR([n[n.length-1]]):YR([n[0]]);if(U(s))r=t.stepTicks(s);else if(U(o))r=t.forceTicks(o);else if(U(a)){var v=V(a)?a({axisLength:f,labelStyle:h}):a;r=t.ticks(v)}else if(e.sampling){var g=(null!==(i=e.labelStyle.fontSize)&&void 0!==i?i:12)+2,y=Tt(p),m=Mt(p);if(n.length<=f/g){var _=iI(t,n,e,d);if(_){var x=Math.min.apply(Math,b(_.map((function(t){return t[2]})))),k=(m-y)/n.length,S=oI(n,_,u,e.labelLastVisible,Math.floor(x/k),!1);r=t.stepTicks(S.step),e.labelLastVisible&&(S.delCount&&(r=r.slice(0,r.length-S.delCount)),r.push(n[n.length-1]))}}else{var A=[n[0],n[Math.floor(n.length/2)],n[n.length-1]],M=iI(t,A,e,d);if(M){var T=null;M.forEach((function(t){T?T[2]<t[2]&&(T=t):T=t}));var w=m-y-u>0?Math.ceil(n.length*(u+T[2])/(m-y-u)):n.length-1;r=t.stepTicks(w),!e.labelLastVisible||r.length&&r[r.length-1]===n[n.length-1]||(r.length&&Math.abs(t.scale(r[r.length-1])-t.scale(n[n.length-1]))<T[2]&&(r=r.slice(0,-1)),r.push(n[n.length-1]))}}}return j(r)&&(r=t.domain()),YR(r)},oI=function(t,e,i,n,r,a){var o=0,s=0,l=-1,u=Number.MAX_VALUE,c=function(n){var r=!0,a=0;do{a+n<t.length&&nI(e[a],e[a+n],i)&&(r=!1),a+=n}while(r&&a<t.length);return r},h=Ht(r,t.length,(function(t){return c(t)?1:-1})),d=h;do{if(d>h&&!a&&!c(d))d++;else{if(!n){s=d;break}var p=t.length-1,f=void 0,v=0;f=t.length%d>0?t.length-t.length%d+d:t.length;do{if((f-=d)!==p&&!nI(e[f],e[p],i))break;v++}while(f>0);if(f===p){s=d,o=v;break}var g=Math.floor(t.length/d)-v+1;if(g<l)break;l=g;var y=rI(e[f],e[p]),m=f-d>=0?rI(e[f-d],e[f]):y,_=Math.abs(y-m);if(_<u&&(u=_,s=d,o=v),y<=m)break;d++}}while(d<=t.length);return{step:s,delCount:o}},sI=function(t,e,i){var n,r=i.labelStyle,a=i.getRadius,o=i.labelOffset,s=i.labelFormatter,l=i.inside,u=null==a?void 0:a(),c=null!==(n=r.angle)&&void 0!==n?n:0,h=UC(r);return e.map((function(e){var i,n,a=s?s(e):"".concat(e),d=h.quickMeasure(a),p=d.width,f=d.height,v=Math.max(p,12),g=Math.max(f,12),y=t.scale(e),m={x:0,y:0},_={align:r.textAlign,baseline:r.textBaseline},b=function(t,e,i,n,r){var a,o,s=Ve({x:0,y:0},i,t),l=zE(s,HE(n,s,e,r));return a=l,o=HE(n||1,l,e,r),{x:a.x+o[0],y:a.y+o[1]}}(y,m,u,o,l),x=b.x,k=b.y;return _.align||(Ut(x,m.x)?_.baseline||(_.baseline=k>m.y?"top":"bottom"):x>m.x?_.align="left":x<m.x&&(_.align="right")),i=x+("right"===_.align?-v:"left"===_.align?0:-v/2),n=k+("bottom"===_.baseline?-g:"top"===_.baseline?0:-g/2),(new _i).set(i,n,i+v,n+g).rotate(c,i+v/2,n+g/2)}))},lI=function(t,e){var i,n=e.tickCount,r=e.forceTickCount,a=e.tickStep,o=e.getRadius,s=e.labelOffset,l=e.labelGap,u=void 0===l?0:l,c=e.labelStyle,h=null==o?void 0:o();if(!h)return YR(t.domain());if(U(a))i=t.stepTicks(a);else if(U(r))i=t.forceTicks(r);else if(U(n)){var d=t.range(),p=Math.abs(d[d.length-1]-d[0]),f=V(n)?n({axisLength:p,labelStyle:c}):n;i=t.ticks(f)}else if(e.sampling){var v=t.domain(),g=t.range(),y=sI(t,v,e),m=Tt(g),_=Mt(g),b=Math.abs(_-m)*(h+s)/v.length,x=uI(v,y,u,Math.floor(y.reduce((function(t,e){return Math.min(t,e.width(),e.height())}),Number.MAX_VALUE)/b)),k=x.step,S=x.delCount;i=(i=t.stepTicks(k)).slice(0,i.length-S)}else i=t.domain();return YR(i)},uI=function(t,e,i,n){var r=n;do{var a=!0;r++;var o=0;do{o+r<t.length&&XR(e[o],e[o+r],i)&&(a=!1),o+=r}while(a&&o<t.length);if(a)break}while(r<=t.length);var s=0;if(t.length>2){var l=t.length-t.length%r;for(l>=t.length&&(l-=r);l>0&&XR(e[0],e[l]);)s++,l-=r}return{step:r,delCount:s}},cI=new Uint32Array(33),hI=new Uint32Array(33);hI[0]=0,cI[0]=~hI[0];for(var dI=1;dI<=32;++dI)hI[dI]=hI[dI-1]<<1|1,cI[dI]=~hI[dI];function pI(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{top:0,left:0,right:0,bottom:0},n=i.top,r=void 0===n?0:n,a=i.left,o=void 0===a?0:a,s=i.right,l=void 0===s?0:s,u=i.bottom,c=void 0===u?0:u,h=Math.max(1,Math.sqrt(t*e/1e6)),d=~~((t+o+l+h)/h),p=~~((e+r+c+h)/h),f=function(t){return~~(t/h)};return f.bitmap=function(){return function(t,e){var i=new Uint32Array(~~((t*e+32)/32));function n(t,e){i[t]|=e}function r(t,e){i[t]&=e}return{array:i,get:function(e,n){var r=n*t+e;return i[r>>>5]&1<<(31&r)},set:function(e,i){var r=i*t+e;n(r>>>5,1<<(31&r))},clear:function(e,i){var n=i*t+e;r(n>>>5,~(1<<(31&n)))},getRange:function(n){var r=n.x1,a=n.y1,o=n.x2,s=n.y2;if(o<0||s<0||r>t||a>e)return!0;for(var l,u,c,h,d=s;d>=a;--d)if((c=(l=d*t+r)>>>5)==(h=(u=d*t+o)>>>5)){if(i[c]&cI[31&l]&hI[1+(31&u)])return!0}else{if(i[c]&cI[31&l])return!0;if(i[h]&hI[1+(31&u)])return!0;for(var p=c+1;p<h;++p)if(i[p])return!0}return!1},setRange:function(i){var r=i.x1,a=i.y1,o=i.x2,s=i.y2;if(!(o<0||s<0||r>t||a>e))for(var l,u,c,h,d;a<=s;++a)if((c=(l=a*t+r)>>>5)==(h=(u=a*t+o)>>>5))n(c,cI[31&l]&hI[1+(31&u)]);else for(n(c,cI[31&l]),n(h,hI[1+(31&u)]),d=c+1;d<h;++d)n(d,4294967295)},clearRange:function(e){for(var i,n,a,o,s,l=e.x1,u=e.y1,c=e.x2,h=e.y2;u<=h;++u)if((a=(i=u*t+l)>>>5)==(o=(n=u*t+c)>>>5))r(a,hI[31&i]|cI[1+(31&n)]);else for(r(a,hI[31&i]),r(o,cI[1+(31&n)]),s=a+1;s<o;++s)r(s,0)},outOfBounds:function(i){var n=i.x1,r=i.y1,a=i.x2,o=i.y2;return n<0||r<0||o>=e||a>=t},toImageData:function(n){for(var r=n.createImageData(t,e),a=r.data,o=0;o<e;++o)for(var s=0;s<t;++s){var l=o*t+s,u=4*l,c=i[l>>>5]&1<<(31&l);a[u+0]=255*c,a[u+1]=255*c,a[u+2]=255*c,a[u+3]=31}return r}}}(d,p)},f.x=function(t){return~~((t+o)/h)},f.y=function(t){return~~((t+r)/h)},f.ratio=h,f.padding=i,f.width=t,f.height=e,f}function fI(t,e){var i=e.x1,n=e.x2,r=e.y1,a=e.y2,o=t.padding,s=o.top,l=void 0===s?0:s,u=o.left,c=void 0===u?0:u,h=o.right,d=void 0===h?0:h,p=o.bottom,f=void 0===p?0:p,v=Xt(i,-c,t.width+d),g=Xt(n,-c,t.width+d),y=Xt(r,-l,t.height+f),m=Xt(a,-l,t.height+f);return{x1:t.x(v),x2:t.x(g),y1:t.y(y),y2:t.y(m)}}function vI(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?fI(t,e):{x1:t.x(e.x1),x2:t.x(e.x2),y1:t.y(e.y1),y2:t.y(e.y2)}}function gI(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=i;r>0&&(a={x1:i.x1-r,x2:i.x2+r,y1:i.y1-r,y2:i.y2+r}),a=vI(t,a);var o=e.outOfBounds(a);return!(n&&o||(o&&(a=fI(t,a)),e.getRange(a)))}function yI(t,e,i){for(var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]).filter((function(t){return U(t)})),s=0;s<o.length;s++){var l=void 0;if((l=a?i:i.clone()).setAttributes(o[s]),gI(t,e,l.AABBBounds,n,r))return e.setRange(vI(t,l.AABBBounds,!0)),o[s]}return!1}function mI(t,e,i,n,r,a,o){var s,l,u=null===(s=n.overlap)||void 0===s?void 0:s.clampForce,c=null===(l=n.overlap)||void 0===l?void 0:l.overlapPadding;if("bound"===i.type||"position"===i.type){if(V(o)){var h=((V(i.position)?i.position(r.attribute):i.position)||function(t){return"rect"===t?bI:_I}(n.type)).map((function(t){return o(r.AABBBounds,a,t,n.offset)})),d=!1===i.restorePosition;return yI(t,e,r,h,u,c,d)}return!1}if("moveY"===i.type){var p=(i.offset?V(i.offset)?i.offset(r.attribute):i.offset:[]).map((function(t){return{x:r.attribute.x,y:r.attribute.y+t}}));return yI(t,e,r,p,u,c)}if("moveX"===i.type){var f=(i.offset?V(i.offset)?i.offset(r.attribute):i.offset:[]).map((function(t){return{x:r.attribute.x+t,y:r.attribute.y}}));return yI(t,e,r,f,u,c)}return!1}var _I=["top","bottom","right","left","top-right","bottom-right","top-left","bottom-left"],bI=["top","inside-top","inside"];function xI(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=t.AABBBounds,a=r.x1,o=r.x2,s=r.y1,l=r.y2,u=n.top,c=void 0===u?0:u,h=n.left,d=void 0===h?0:h,p=n.right,f=void 0===p?0:p,v=n.bottom,g=void 0===v?0:v,y=Math.min(a,o),m=Math.max(a,o),_=Math.min(s,l),b=Math.max(s,l),x=e+f,k=i+g,S=0,A=0;return y<0-d?S=-y:m>x&&(S=x-m),_<0-c?A=-_:b>k&&(A=k-b),{dx:S,dy:A}}var kI={mode:"same-time",duration:300,easing:"linear"};function SI(t){return 3===t||4===t}var AI=function(t){if(!t||!t.attribute)return[];var e=t.attribute,i=e.points,n=e.segments;if(n&&n.length){var r=[];return n.forEach((function(t){t.points.forEach((function(t){r.push(t)}))})),r}return i};function MI(t,e,i,n,r,a){return Math.abs(e/t)<a/r?{x:i+(t>0?r:-r),y:n+e*r/Math.abs(t)}:{x:i+t*a/Math.abs(e),y:n+(e>0?a:-a)}}var TI=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},wI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t=jP(this.target);this._animator=t;var e=this.duration,i=this.easing,n=this.params,r=n.prevText,a=n.curText,o=n.prevLabelLine,s=n.curLabelLine,l=n.increaseEffect,u=void 0===l||l,c={};for(var h in a.attribute)r.attribute[h]!==a.attribute[h]&&(c[h]=a.attribute[h]);c.text;var d=TI(c,["text"]);t.animate(r,{type:"to",to:d,duration:e,easing:i}),!1!==u&&t.animate(r,{type:"increaseCount",to:{text:a.attribute.text},duration:e,easing:i}),o&&t.animate(o,{type:"to",to:s.attribute,duration:e,easing:i}),this.completeBind(t)}},{key:"tryPreventConflict",value:function(){}}])}(HP),CI=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t=jP(this.target);this._animator=t;var e=this.duration,i=this.easing,n=this.params,r=n.relatedGraphic,a=n.relatedGraphics,o=n.config,s=o.mode,l=o.type,u=void 0===l?"fadeIn":l,c=this.target,h=0;"after"===s?r.animates&&r.animates.forEach((function(t){h=Math.max(h,t.getStartTime()+t.getTotalDuration())})):"after-all"===s?a&&a.forEach((function(t){t.animates&&t.animates.forEach((function(t){h=Math.max(h,t.getStartTime()+t.getTotalDuration())}))})):r.animates&&r.animates.forEach((function(t){h=Math.max(h,t.getStartTime())})),t.animate(c,Object.assign(Object.assign({},o),{duration:e,easing:i,startTime:h,type:u})),this.completeBind(t)}},{key:"tryPreventConflict",value:function(){}}])}(HP);var EI=function(t,e){return Math.ceil(t)>Math.floor(e)},PI=function(t,e){var i=m(t,2),n=i[0],r=i[1],a=m(e,2),o=a[0];return a[1]>n&&r>o};function BI(t,e){var i=m(t,2),n=i[0],r=i[1],a=m(e,2),o=a[0],s=a[1],l=Math.max(n,o),u=Math.min(r,s);return Math.max(0,u-l)}var RI=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};Kw(),dC(),oC(),Qw(),wP.registerBuiltInAnimate("increaseCount",UP),wP.registerBuiltInAnimate("labelUpdate",wI),wP.registerBuiltInAnimate("labelEnter",CI);var LI=function(t){function e(t,a){var o;r(this,e);var s=t.data,l=RI(t,["data"]);return(o=n(this,e,[(null==a?void 0:a.skipDefault)?t:Object.assign({data:s},gt({},e.defaultAttributes,l))])).name="label",o._onHover=function(t){var e=t.target;e===o._lastHover||lt(e.states)||(e.addState(vC.hover,!0),EC(i(o),(function(t){t===e||lt(t.states)||t.addState(vC.hoverReverse,!0)})),o._lastHover=e)},o._onUnHover=function(t){o._lastHover&&(EC(i(o),(function(t){lt(t.states)||(t.removeState(vC.hoverReverse),t.removeState(vC.hover))})),o._lastHover=null)},o._onClick=function(t){var e=t.target;if(o._lastSelect===e&&e.hasState("selected"))return o._lastSelect=null,void EC(i(o),(function(t){lt(t.states)||(t.removeState(vC.selectedReverse),t.removeState(vC.selected))}));lt(e.states)||(e.addState(vC.selected,!0),EC(i(o),(function(t){t===e||lt(t.states)||t.addState(vC.selectedReverse,!0)})),o._lastSelect=e)},o._handleRelatedGraphicSetState=function(t){var e,i,n,r,a;if((null===(e=t.detail)||void 0===e?void 0:e.type)===kl.STATE||(null===(i=t.detail)||void 0===i?void 0:i.type)===kl.ANIMATE_UPDATE&&(null===(n=t.detail.animationState)||void 0===n?void 0:n.isFirstFrameOfStep)){var s=null!==(a=null===(r=t.target)||void 0===r?void 0:r.currentStates)&&void 0!==a?a:[],l=o._isCollectionBase?b(o._graphicToText.values()):[o._graphicToText.get(t.target)];o.updateStatesOfLabels(l,s)}},o}return h(e,t),o(e,[{key:"setBitmap",value:function(t){this._bitmap=t}},{key:"setBitmapTool",value:function(t){this._bmpTool=t}},{key:"labeling",value:function(t,e,i,n){}},{key:"_getLabelLinePoints",value:function(t,e){return function(t,e){if(t&&e&&!$e(t,e,!0)){var i=Math.min(t.x1,t.x2),n=Math.min(t.y1,t.y2),r=Math.min(e.x1,e.x2),a=Math.min(e.y1,e.y2),o=Math.abs(t.x2-i)/2,s=Math.abs(t.y2-n)/2,l=Math.abs(e.x2-r)/2,u=Math.abs(e.y2-a)/2,c=i+o,h=n+s,d=r+l,p=a+u,f=d-c,v=p-h;return[MI(f,v,c,h,o,s),MI(-f,-v,d,p,l,u)]}}(t.AABBBounds,null==e?void 0:e.AABBBounds)}},{key:"_createLabelLine",value:function(t,e){var i=this._getLabelLinePoints(t,e);if(i){var n=kg.line({points:i}),r=t.attribute.line,a=void 0===r?{}:r;if(a.customShape){var o=a.customShape;n.pathProxy=function(i){return o({text:t,baseMark:e},i,new Mu)}}return e&&e.getAttributes(!0).fill&&n.setAttribute("stroke",e.getAttributes(!0).fill),this.attribute.line&&!lt(this.attribute.line.style)&&n.setAttributes(this.attribute.line.style),this._setStatesOfLabelLine(n),n}}},{key:"render",value:function(){var t=this;if(this._prepare(),!(j(this._idToGraphic)||this._isCollectionBase&&j(this._idToPoint))){var e=[];!1!==this._enableAnimation&&this._baseMarks.forEach((function(t){e.push(t.attribute),t.initAttributes(t.getAttributes(!0))}));var i=this.attribute,n=i.overlap,r=i.smartInvert,a=i.dataFilter,o=i.customLayoutFunc,s=i.customOverlapFunc,l=this.attribute.data;if(V(a)&&(l=a(l)),l&&l.length){var u=new Set;l=l.filter((function(t){return!u.has(t.id)&&u.add(t.id)}))}var c=this._initText(l);c=V(o)?o(l,c,this.getRelatedGraphic.bind(this),this._isCollectionBase?function(e){return t._idToPoint.get(e.id)}:null,this):this._layout(c),V(s)?c=s(c,this.getRelatedGraphic.bind(this),this._isCollectionBase?function(e){return t._idToPoint.get(e.id)}:null,this):!1!==n&&(c=this._overlapping(c)),V(this.attribute.onAfterOverlapping)&&this.attribute.onAfterOverlapping(c,this.getRelatedGraphic.bind(this),this._isCollectionBase?function(e){return t._idToPoint.get(e.id)}:null,this),c&&c.length&&c.forEach((function(e){t._bindEvent(e),t._setStatesOfText(e)})),!1!==r&&this._smartInvert(c),this._renderLabels(c),!1!==this._enableAnimation&&this._baseMarks.forEach((function(t,i){t.initAttributes(e[i])}))}}},{key:"_bindEvent",value:function(t){if(!this.attribute.disableTriggerEvent&&t){var e=this.attribute,i=e.hover,n=e.select;i&&(t.addEventListener("pointermove",this._onHover),t.addEventListener("pointerout",this._onUnHover)),n&&t.addEventListener("pointerdown",this._onClick)}}},{key:"_setStatesOfText",value:function(t){if(t){var e=this.attribute.state;e&&!lt(e)&&(t.states=e)}}},{key:"_setStatesOfLabelLine",value:function(t){if(t){var e=this.attribute.labelLineState;e&&!lt(e)&&(t.states=e)}}},{key:"_createLabelText",value:function(t){var e,i;return XC(Object.assign(Object.assign({},null===(i=null===(e=this.stage)||void 0===e?void 0:e.getTheme())||void 0===i?void 0:i.text),t),"textType")}},{key:"_prepare",value:function(){var t,e,i=[];if((V(this.attribute.getBaseMarks)?this.attribute.getBaseMarks():function(t,e){if(!e)return[];var i=t.find((function(t){return t.name===e}),!0);return i?i.getChildren():[]}(this.getRootNode(),this.attribute.baseMarkGroupName)).forEach((function(t){"willRelease"!==t.releaseStatus&&i.push(t)})),null===(t=this._idToGraphic)||void 0===t||t.clear(),null===(e=this._idToPoint)||void 0===e||e.clear(),this._baseMarks=i,this._isCollectionBase="line-data"===this.attribute.type,i&&0!==i.length){var n=this.attribute.data;if(n&&0!==n.length){if(this._idToGraphic||(this._idToGraphic=new Map),this._isCollectionBase){this._idToPoint||(this._idToPoint=new Map);for(var r=0,a=0;a<i.length;a++){var o=i[a],s=AI(o);if(s&&s.length)for(var l=0;l<s.length;l++){var u=n[r];u&&s[l]&&(U(u.id)||(u.id="vrender-component-".concat(this.name,"-").concat(r)),this._idToPoint.set(u.id,s[l]),this._idToGraphic.set(u.id,o)),r++}}}else for(var c=0;c<i.length;c++){var h=n[c],d=i[c];h&&d&&(U(h.id)||(h.id="vrender-component-".concat(this.name,"-").concat(c)),this._idToGraphic.set(h.id,d))}this._prepareAnimate(kI)}}}},{key:"getRelatedGraphic",value:function(t){return this._idToGraphic.get(t.id)}},{key:"_initText",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this.attribute.textStyle,i=void 0===e?{}:e,n=[],r=0;r<t.length;r++){var a=t[r],o=this.getRelatedGraphic(a);if(o){var s=o.getAttributes(!0),l=Object.assign(Object.assign({fill:this._isCollectionBase?q(s.stroke)?s.stroke.find((function(t){return!!t&&!0!==t})):s.stroke:s.fill},i),a),u=this._createLabelText(l);n.push(u)}}return n}},{key:"_layout",value:function(t){for(var e=this.attribute,i=e.position,n=e.offset,r=0;r<t.length;r++){var a=t[r];if(!a)return;var o=a.attribute,s=this.getRelatedGraphic(o);if(s){a.attachedThemeGraphic=this;var l=this.getGraphicBounds(a);a.attachedThemeGraphic=null;var u=V(i)?i(o):i,c=this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(o.id),u):this.getGraphicBounds(s,{x:o.x,y:o.y},u),h=this.labeling(l,c,u,n);h&&a.setAttributes(h)}}return t}},{key:"_overlapping",value:function(t){var e,i,n;if(0===t.length)return[];var r=W(this.attribute.overlap)?this.attribute.overlap:{},a=this.getBaseMarkGroup(),o=null!==(e=r.size)&&void 0!==e?e:{width:null!==(i=null==a?void 0:a.AABBBounds.width())&&void 0!==i?i:0,height:null!==(n=null==a?void 0:a.AABBBounds.height())&&void 0!==n?n:0};if(0===o.width||0===o.height)return t;var s=r.strategy,l=r.priority,u=this._bmpTool||pI(o.width,o.height),c=this._bitmap||u.bitmap();return l&&(t=t.sort((function(t,e){return l(e.attribute.data)-l(t.attribute.data)}))),"shiftY"===(null==s?void 0:s.type)?this._overlapGlobal(t,r,u,c):this._overlapByStrategy(t,r,u,c)}},{key:"_overlapGlobal",value:function(t,e,i,n){var r=this,a=t.filter((function(t){return t.attribute.visible&&0!==t.attribute.opacity&&r.isMarkInsideRect(r.getRelatedGraphic(t.attribute),i)})),o=e.clampForce,l=void 0===o||o,u=e.hideOnHit,c=void 0===u||u,h=e.hideOnOverflow,d=void 0!==h&&h,p=e.overlapPadding,f=e.strategy;if(l||d)for(var v=0;v<a.length;v++){var g=t[v],y=xI(g,i.width,i.height,i.padding),_=y.dx,b=void 0===_?0:_,x=y.dy,k=void 0===x?0:x;0===b&&0===k||(d?g.setAttributes({visible:!1}):(g.setAttributes({x:g.attribute.x+b,y:g.attribute.y+k}),g._isClamped=!0))}a=function(t,e){var i=e.maxY,n=void 0===i?Number.MAX_VALUE:i,r=e.labelling,a=e.globalShiftY,o=void 0===a?{enable:!0,maxIterations:10,maxError:.1,padding:1}:a,l=t.length;if(l<=1)return t;var u=new Map,c=new Map,h=function(t){return c.get(t).y1Initial},d=function(t){return c.get(t).height},p=function(t){return c.get(t).y1},f=function(t){return c.get(t).x},v=function(t){return c.get(t).x1},g=function(t){return c.get(t).x2},y=function(t){return c.get(t).attempts},_=function(t,e){c.get(t).y1=e},b=function(t,e){c.get(t).attempts=e};function x(t){for(var e=t.length-1;e>=0;e--){var i=t[e],a=t[e-1],o=t[e+1];if(a&&EI(p(a)+d(a),p(i))||0===p(i)&&i._isClamped){var s=r(i).y;o&&EI(s+d(i)/2,p(o))||s+d(i)/2<=n&&_(i,p(i)+s-(l=i,c.get(l).y))}}var l}t.sort((function(t,e){return t.attribute.x-e.attribute.x}));var k,S=s(t);try{for(S.s();!(k=S.n()).done;){var A=k.value,M=A.AABBBounds,T=M.y1,w=M.y2,C=M.x1,E=M.x2,P=A.attribute,B=P.x,R=P.y;c.set(A,{y1Initial:T,y1:T,y2:w,y:R,height:w-T,x1:C,x2:E,x:B,attempts:0});var L,I=!1,D=s(u);try{for(D.s();!(L=D.n()).done;){var O=m(L.value,2),F=O[0],z=O[1],H=F.start,N=F.end;if(C>=H&&E<=N)z.push(A),I=!0;else if(Ut(B,f(z[0]),void 0,5)){var V={start:Math.min(H,C),end:Math.max(N,E)};z.push(A),u.set(V,z),u.delete(F),I=!0}else if(BI([H,N],[C,E])/(N-H)>.5){var j={start:Math.min(H,C),end:Math.max(N,E)};z.push(A),u.set(j,z),u.delete(F),I=!0}if(I)break}}catch(t){D.e(t)}finally{D.f()}I||u.set({start:C,end:E},[A])}}catch(t){S.e(t)}finally{S.f()}var U,W=s(u.values());try{for(W.s();!(U=W.n()).done;){var G=U.value;G.sort((function(t,e){return h(t)-h(e)})),x(G)}}catch(t){W.e(t)}finally{W.f()}if(!1!==o.enable)for(var Y=o.maxIterations,X=void 0===Y?10:Y,K=o.maxError,q=void 0===K?.1:K,Z=o.padding,J=void 0===Z?1:Z,Q=o.maxAttempts,$=void 0===Q?1e3:Q,tt=o.deltaYTolerance,et=void 0===tt?Number.MAX_VALUE:tt,it=0;it<X;it++){t.sort((function(t,e){return h(t)-h(e)}));for(var nt=0,rt=0;rt<l-1;rt++){var at=t[rt];if(!(y(at)>=$)){for(var ot=void 0,st=rt+1;(ot=t[st])&&!PI([v(at),g(at)],[v(ot),g(ot)]);)st+=1;if(ot){var lt=p(at),ut=d(at),ct=p(ot),ht=ct-(lt+ut);if(ht<J){var dt=(J-ht)/2;if(nt=Math.max(nt,dt),lt+dt+d(ot)>n){var pt=lt-(J-ht),ft=h(at)-pt;Math.abs(ft)<=et&&(_(at,pt),b(at,y(at)+1))}else if(lt-dt<0){var vt=ct+(J-ht),gt=h(ot)-vt;Math.abs(gt)<=et&&(_(ot,vt),b(ot,y(ot)+1))}else{var yt=lt-dt,mt=h(at)-yt,_t=ct+dt,bt=h(ot)-_t;Math.abs(mt)<=et&&Math.abs(bt)<=et&&(_(at,yt),_(ot,_t),b(at,y(at)+1),b(ot,y(ot)+1))}}}}}if(nt<q)break}var xt,kt=s(t);try{for(kt.s();!(xt=kt.n()).done;){var St=xt.value,At=St.attribute.y+p(St)-h(St);St.setAttribute("y",At)}}catch(t){kt.e(t)}finally{kt.f()}var Mt=[];t.sort((function(t,e){return t.attribute.x-e.attribute.x}));for(var Tt=0,wt=t.length-1;Tt<=wt;)Tt===wt?Mt.push(t[Tt]):(Mt.push(t[Tt]),Mt.push(t[wt])),Tt++,wt--;return Mt}(a,Object.assign(Object.assign({maxY:i.height},f),{labelling:function(t){var e=r.getRelatedGraphic(t.attribute),i=r._isCollectionBase?r.getGraphicBounds(null,r._idToPoint.get(t.attribute.id)):r.getGraphicBounds(e,t);return r.labeling(t.AABBBounds,i,"bottom",r.attribute.offset)}}));for(var S=0;S<a.length;S++){var A=a[S],M=A.AABBBounds,T=vI(i,M,!0);if(gI(i,n,M,l,p))n.setRange(T);else{if(d){if(this._processHideOnOverflow(A,i))continue}else if(l&&this._processClampForce(A,i,n,p))continue;c?A.setAttributes({visible:!1}):n.setRange(T)}}return a}},{key:"_processHideOnOverflow",value:function(t,e){var i=xI(t,e.width,e.height,e.padding),n=i.dy,r=void 0===n?0:n,a=i.dx;return 0===(void 0===a?0:a)&&0===r||(t.setAttributes({visible:!1}),!1)}},{key:"_processClampForce",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=xI(t,e.width,e.height,e.padding),a=r.dy,o=void 0===a?0:a,s=r.dx,l=void 0===s?0:s;if(0===l&&0===o){if(gI(e,i,t.AABBBounds,!1,n))return i.setRange(vI(e,t.AABBBounds,!0)),!0}else if(gI(e,i,{x1:t.AABBBounds.x1+l,x2:t.AABBBounds.x2+l,y1:t.AABBBounds.y1+o,y2:t.AABBBounds.y2+o}))return t.setAttributes({x:t.attribute.x+l,y:t.attribute.y+o}),i.setRange(vI(e,t.AABBBounds,!0)),!0;return!1}},{key:"_overlapByStrategy",value:function(t,e,i,n){var r,a=this,o=e.avoidBaseMark,s=e.strategy,l=void 0===s?[]:s,u=e.hideOnHit,c=void 0===u||u,h=e.clampForce,d=void 0===h||h,p=e.avoidMarks,f=void 0===p?[]:p,v=e.overlapPadding,g=e.hideOnOverflow,y=void 0!==g&&g,m=[],_=l.some((function(t){return"bound"===t.type}));o&&(null===(r=this._baseMarks)||void 0===r||r.forEach((function(t){t.AABBBounds&&n.setRange(vI(i,t.AABBBounds,!0))}))),f.length>0&&f.forEach((function(t){K(t)?function(t,e){if(!e)return[];var i=t.find((function(t){return t.name===e}),!0);return i?i.findAll((function(t){return"group"!==t.type}),!0):[]}(a.getRootNode(),t).forEach((function(t){t.AABBBounds&&n.setRange(vI(i,t.AABBBounds,!0))})):t.AABBBounds&&n.setRange(vI(i,t.AABBBounds,!0))}));for(var b=0;b<t.length;b++)if(!1!==t[b].attribute.visible){var x=t[b],k=this.getRelatedGraphic(x.attribute);if(x.update(),this.isMarkInsideRect(k,i)){if(gI(i,n,x.AABBBounds,d,v)){if(!_){n.setRange(vI(i,x.AABBBounds,!0)),m.push(x);continue}if(_&&k&&k.AABBBounds&&this._canPlaceInside(x.AABBBounds,k.AABBBounds)){n.setRange(vI(i,x.AABBBounds,!0)),m.push(x);continue}}for(var S=!1,A=0;A<l.length;A++)if(!1!==(S=mI(i,n,l[A],this.attribute,x,this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(t[b].attribute.id)):this.getGraphicBounds(k,t[b].attribute),this.labeling))&&(x.setAttributes({x:S.x,y:S.y}),!y||this._processHideOnOverflow(x,i))){m.push(x);break}if(!S){if(y&&!this._processHideOnOverflow(x,i))continue;if(d&&this._processClampForce(x,i,n,v)){m.push(x);continue}}!S&&!c&&m.push(x)}}return m}},{key:"isMarkInsideRect",value:function(t,e){var i=e.padding,n=i.left,r=i.right,a=i.top,o=i.bottom,s={x1:-n,x2:e.width+r,y1:-a,y2:e.height+o},l=t.AABBBounds;if(0!==l.width()&&0!==l.height())return $e(t.AABBBounds,s,!0);var u=t.attribute;if("rect"===t.type){var c=u.x,h=u.x1,d=u.y,p=u.y1;return ti({x:null!=c?c:h,y:null!=d?d:p},s,!0)}return"x"in u&&"y"in u&&ti({x:u.x,y:u.y},s,!0)}},{key:"getBaseMarkGroup",value:function(){var t=this.attribute.baseMarkGroupName;if(t)return this.getRootNode().find((function(e){return e.name===t}),!0)}},{key:"getGraphicBounds",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(t){if(!1!==t.attribute.visible){if(null===(e=t.context)||void 0===e?void 0:e.animationState){var r=t.clone();return Object.assign(r.attribute,t.getAttributes(!0)),r.AABBBounds}return t.AABBBounds}var a=t.attribute,o=a.x,s=a.y;return{x1:o,x2:o,y1:s,y2:s}}if(i&&n&&"inside-middle"===n){var l=i.x,u=i.y,c=i.x1,h=void 0===c?l:c,d=i.y1,p=void 0===d?u:d;return{x1:(l+h)/2,x2:(l+h)/2,y1:(u+p)/2,y2:(u+p)/2}}var f=i.x,v=i.y;return{x1:f,x2:f,y1:v,y2:v}}},{key:"_renderLabels",value:function(t){var e,i=this,n=this.attribute.syncState,r=new Map,a=this._graphicToText||new Map,o=[],s=[],l=(null!==(e=this.attribute.line)&&void 0!==e?e:{}).visible;t&&t.forEach((function(t,e){var u,c,h=i.getRelatedGraphic(t.attribute),d=i._isCollectionBase?t.attribute.id:h,p=(null==a?void 0:a.get(d))?"update":"enter";l&&(c=i._createLabelLine(t,h));var f=c?{text:t,labelLine:c}:{text:t};if(n&&i.updateStatesOfLabels([f],null!==(u=h.currentStates)&&void 0!==u?u:[]),"enter"===p)o.push(t),r.set(d,f),i._addLabel(f,o,s,e);else if("update"===p){var v=a.get(d);a.delete(d),r.set(d,v),i._updateLabel(v,f)}})),this._removeLabel(a),this._graphicToText=r}},{key:"runEnterAnimation",value:function(t,e){var i=this;if(!1!==this._enableAnimation&&this._animationConfig.enter){var n=this.getRelatedGraphic(t.attribute),r=this._animationConfig.enter;[t,e].filter(Boolean).forEach((function(e){return e.applyAnimationState(["enter"],[{name:"enter",animation:Object.assign(Object.assign({},r),{type:"labelEnter",selfOnly:!0,customParameters:{relatedGraphic:n,relatedGraphics:i._idToGraphic,config:Object.assign(Object.assign({},r),{type:e===t?r.type:"fadeIn"})}})}])}))}}},{key:"_runUpdateAnimation",value:function(t,e){var i=t.text,n=t.labelLine,r=e.text,a=e.labelLine;i.applyAnimationState(["update"],[{name:"update",animation:{type:"labelUpdate",customParameters:Object.assign(Object.assign({},this._animationConfig.update),{prevText:i,curText:r,prevLabelLine:n,curLabelLine:a})}}])}},{key:"_syncStateWithRelatedGraphic",value:function(t){this.attribute.syncState&&t&&t.on("afterStateUpdate",this._handleRelatedGraphicSetState)}},{key:"_addLabel",value:function(t,e,i,n){var r=t.text,a=t.labelLine,o=this.getRelatedGraphic(r.attribute);this._syncStateWithRelatedGraphic(o),r&&this.add(r),a&&this.add(a),this.runEnterAnimation(r,a)}},{key:"_updateLabel",value:function(t,e){t.text;var i=t.labelLine,n=e.text,r=e.labelLine;!1===this._enableAnimation||!1===this._animationConfig.update?(t.text.setAttributes(n.attribute),i&&r&&t.labelLine.setAttributes(r.attribute)):this._runUpdateAnimation(t,e)}},{key:"_removeLabel",value:function(t){var e=this,i=function(t){e.removeChild(t.text),t.labelLine&&e.removeChild(t.labelLine)};!1!==this._enableAnimation&&!1!==this._animationConfig.exit?t.forEach((function(t){var n;t.text.applyAnimationState(["exit"],[{name:"exit",animation:Object.assign(Object.assign({},e._animationConfig.exit),{type:"fadeOut"})}],(function(){i(t)})),null===(n=t.labelLine)||void 0===n||n.applyAnimationState(["exit"],[{name:"exit",animation:Object.assign(Object.assign({},e._animationConfig.exit),{type:"fadeOut"})}],(function(){}))})):t.forEach((function(t){i(t)}))}},{key:"updateStatesOfLabels",value:function(t,e){t.forEach((function(t){t&&(t.text&&t.text.useStates(e),t.labelLine&&t.labelLine.useStates(e))}))}},{key:"_smartInvert",value:function(t){var e,i,n,r,a,o,s,l=W(this.attribute.smartInvert)?this.attribute.smartInvert:{},u=l.textType,c=l.contrastRatiosThreshold,h=l.alternativeColors,d=l.mode,p=l.interactInvertType,f=null!==(e=l.fillStrategy)&&void 0!==e?e:"invertBase",v=null!==(i=l.strokeStrategy)&&void 0!==i?i:"base",g=null!==(n=l.brightColor)&&void 0!==n?n:"#ffffff",y=null!==(r=l.darkColor)&&void 0!==r?r:"#000000",m=null!==(a=l.outsideEnable)&&void 0!==a&&a;if("null"!==f||"null"!==v)for(var _=0;_<t.length;_++){var b=t[_];if(b){var x=this.getRelatedGraphic(b.attribute),k=x.getAttributes(!0).fill,S=b.attribute.fill;if(W(k)&&k.gradient){var A=null===(s=null===(o=k.stops)||void 0===o?void 0:o[0])||void 0===s?void 0:s.color;A&&(k=A,S=A)}var M=DC(S,k,u,c,h,d),T=OC(M,g)?g:y,w=this._canPlaceInside(b.AABBBounds,x.AABBBounds),C=!w&&b.AABBBounds&&x.AABBBounds&&x.AABBBounds.intersects(b.AABBBounds);if(w||m||C&&"inside"===p){var E=HC(f,k,M,T);if(E&&b.setAttributes({fill:E}),0===b.attribute.lineWidth||0===b.attribute.strokeOpacity)continue;var P=HC(v,k,M,T);P&&b.setAttributes({stroke:P})}else if(C&&"none"!==p){if(0===b.attribute.lineWidth||0===b.attribute.strokeOpacity)continue;if(b.attribute.stroke){b.setAttributes({fill:DC(b.attribute.fill,b.attribute.stroke,u,c,h,d)});continue}var B=HC(f,k,M,T);B&&b.setAttributes({fill:B});var R=HC(v,k,M,T);R&&b.setAttributes({stroke:R})}}}}},{key:"_canPlaceInside",value:function(t,e){return!(!t||!e)&&e.encloses(t)}},{key:"setLocation",value:function(t){this.translateTo(t.x,t.y)}},{key:"disableAnimation",value:function(){this._enableAnimation=!1}},{key:"enableAnimation",value:function(){this._enableAnimation=!0}}])}(XE);LI.defaultAttributes={textStyle:{fontSize:12,textAlign:"center",textBaseline:"middle",boundsPadding:[-2,-1,-2,-1]},offset:0,pickable:!1};var II={},DI=function(t,e){II[t]=e},OI=function(t){return II[t]},FI=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},zI=function(t){function e(t,i){var a;r(this,e);var o=t.data,s=FI(t,["data"]);return(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:Object.assign({data:o},gt({},e.defaultAttributes,s))])).name="symbol-label",a}return h(e,t),o(e,[{key:"labeling",value:function(t,e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t){var r=t.x1,a=t.y1,o=t.x2,s=t.y2,l=Math.abs(o-r),u=Math.abs(s-a),c=(e.x1+e.x2)/2,h=(e.y1+e.y2)/2,d=0,p=0,f=0,v=0;e&&(f=Math.abs(e.x1-e.x2)/2,v=Math.abs(e.y1-e.y2)/2);var g={"top-right":-235,"top-left":235,"bottom-right":45,"bottom-left":-45};switch(i){case"top":p=-1;break;case"bottom":p=1;break;case"left":d=-1;break;case"right":d=1;break;case"bottom-left":case"bottom-right":case"top-left":case"top-right":d=Math.sin(g[i]*(Math.PI/180)),p=Math.cos(g[i]*(Math.PI/180));break;case"center":d=0,p=0}return{x:c+d*(n+f)+Math.sign(d)*(l/2),y:h+p*(n+v)+Math.sign(p)*(u/2)}}}(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)}}])}(LI);zI.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};var HI=function(){DI("symbol",zI),DI("line-data",zI)},NI=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},VI=function(t){function e(t,i){r(this,e);var a=t.data,o=NI(t,["data"]);return n(this,e,[(null==i?void 0:i.skipDefault)?t:Object.assign({data:a},gt({},e.defaultAttributes,o))])}return h(e,t),o(e,[{key:"labeling",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t&&e){var r=t.x1,a=t.y1,o=t.x2,s=t.y2,l=Math.abs(o-r),u=Math.abs(s-a),c=fi(e,i),h=c.x,d=c.y,p=0,f=0,v=i.includes("inside");switch(i.includes("top")?f=v?1:-1:i.includes("bottom")?f=v?-1:1:i.includes("left")?p=v?1:-1:i.includes("right")&&(p=v?-1:1),i){case"top-right":case"bottom-right":p=-1;break;case"top-left":case"bottom-left":p=1}return{x:h+p*n+p*l/2,y:d+f*n+f*u/2}}}}])}(LI);VI.tag="rect-label",VI.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};var jI=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},UI=function(t){function e(t,i){var a;r(this,e);var o=t.data,s=jI(t,["data"]);return(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:Object.assign({data:o},gt({},e.defaultAttributes,s))])).name="line-label",a}return h(e,t),o(e,[{key:"getGraphicBounds",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"end";if(!t||"line"!==t.type&&"area"!==t.type)return _(e,"getGraphicBounds",this,3)([t,i]);var r=t.attribute.points,a=t.attribute.segments;!r&&a&&a.length&&(r=a.reduce((function(t,e){var i;return t.concat(null!==(i=e.points)&&void 0!==i?i:[])}),[])),r&&0!==r.length||(r=[i]);var o="start"===n?0:r.length-1;return r[o]?{x1:r[o].x,x2:r[o].x,y1:r[o].y,y2:r[o].y}:void 0}},{key:"labeling",value:function(t,e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"end",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!t||!e)return{x:1/0,y:1/0};var r=t.x1,a=t.x2,o=Math.abs(a-r),s=e.x1,l=s;return"end"===i?l=s+o/2+n:"start"===i&&(l=s-o/2-n),{x:l,y:e.y1}}(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"end",arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)}}])}(LI);UI.defaultAttributes={textStyle:{fill:"#000"},position:"end",offset:6};var WI=function(){DI("line",UI),DI("area",UI)},GI=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},YI=function(){return o((function t(e,i,n,a,o,s,l,u,c){r(this,t),this.refDatum=e,this.center=i,this.outerCenter=n,this.quadrant=a,this.radian=o,this.middleAngle=s,this.innerRadius=l,this.outerRadius=u,this.circleCenter=c,this.labelVisible=!0}),[{key:"getLabelBounds",value:function(){return this.labelPosition&&this.labelSize?{x1:this.labelPosition.x-this.labelSize.width/2,y1:this.labelPosition.y-this.labelSize.height/2,x2:this.labelPosition.x+this.labelSize.width/2,y2:this.labelPosition.y+this.labelSize.height/2}:{x1:0,x2:0,y1:0,y2:0}}}])}(),XI=function(t){function e(t,i){var a;r(this,e);var o=t.data,s=GI(t,["data"]);return(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:Object.assign({data:o},gt({},e.defaultAttributes,s))])).name="arc-label",a._ellipsisWidth=0,a._arcLeft=new Map,a._arcRight=new Map,a._line2MinLength=0,a._alignOffset=0,a}return h(e,t),o(e,[{key:"_overlapping",value:function(t){return["inside","inside-center"].includes(this.attribute.position)?_(e,"_overlapping",this,3)([t]):t}},{key:"labeling",value:function(t,e){if(t&&e)return{x:0,y:0}}},{key:"_layout",value:function(t){var i,n,r,a=this;if(t&&t.length){var o=_(e,"_layout",this,3)([t]),s=o.map((function(t){return a.getGraphicBounds(t)})),l=Object.assign(Object.assign({},this.attribute.textStyle),{text:"…"}),u=1/0;if(!1!==l.ellipsis){var c=this._createLabelText(l),h=this.getGraphicBounds(c);u=h.x2-h.x1}var d=o.map((function(t){return t.attribute})),p=Array.from(this._idToGraphic.values());this._line2MinLength=V(this.attribute.line.line2MinLength)?this.attribute.line.line2MinLength(t,p,this.attribute):this.attribute.line.line2MinLength,this._alignOffset=null!==(i=V(this.attribute.layout.alignOffset)?this.attribute.layout.alignOffset(t,p,this.attribute):this.attribute.layout.alignOffset)&&void 0!==i?i:0;for(var f=this.layoutArcLabels(this.attribute.position,this.attribute,p,d,s,u),v=function(){var t=d[g],e=f.find((function(e){var i;return(null===(i=e.refDatum)||void 0===i?void 0:i.id)===t.id}));if(e){var i={visible:e.labelVisible,x:e.labelPosition.x,y:e.labelPosition.y,angle:e.angle,points:e.pointA&&e.pointB&&e.pointC?[e.pointA,e.pointB,e.pointC]:void 0,line:e.labelLine};"richtext"===o[g].type?i.width=null!==(n=e.labelLimit)&&void 0!==n?n:o[g].attribute.width:i.maxLineWidth=null!==(r=e.labelLimit)&&void 0!==r?r:o[g].attribute.maxLineWidth,e.refArc&&"arc3d"===e.refArc.type&&(i.anchor3d=[e.circleCenter.x-i.x,e.circleCenter.y-i.y],i.beta=e.refArc.attribute.beta),o[g].setAttributes(i)}},g=0;g<d.length;g++)v();return o}}},{key:"layoutArcLabels",value:function(t,e,i,n,r,a){var o=this;this._arcLeft.clear(),this._arcRight.clear(),this._ellipsisWidth=a;var s=0;i.forEach((function(t){t.attribute.outerRadius>s&&(s=t.attribute.outerRadius)})),n.forEach((function(t,i){var a,l,u,c=o._idToGraphic.get(t.id),h=c.getAttributes(!0),d={x:null!==(a=null==h?void 0:h.x)&&void 0!==a?a:0,y:null!==(l=null==h?void 0:h.y)&&void 0!==l?l:0};if(!j(n[i])&&!j(r[i])){var p=n[i]?n[i]:null,f=r[i]?r[i]:{x1:0,x2:0,y1:0,y2:0},v=(h.startAngle+h.endAngle)/2,g=h.endAngle-h.startAngle,y=Ye(h.endAngle-g/2),m=Ve(d,h.outerRadius,v),_=Ve(d,s+e.line.line1MinLength,v),b=new YI(p,m,_,y,g,v,h.innerRadius,h.outerRadius,d);b.refArc=c,b.pointA=Ve(d,o.computeDatumRadius(2*d.x,2*d.y,h.outerRadius),b.middleAngle),b.labelSize={width:f.x2-f.x1,height:f.y2-f.y1},1===(u=b.quadrant)||2===u?o._arcRight.set(b.refDatum,b):SI(b.quadrant)&&o._arcLeft.set(b.refDatum,b)}}));var l=Array.from(this._arcLeft.values()),u=Array.from(this._arcRight.values()),c=[];switch(t){case"inside":case"inside-inner":case"inside-outer":case"inside-center":c.push.apply(c,b(this._layoutInsideLabels(u,e,i))),c.push.apply(c,b(this._layoutInsideLabels(l,e,i)));break;default:c.push.apply(c,b(this._layoutOutsideLabels(u,e,i))),c.push.apply(c,b(this._layoutOutsideLabels(l,e,i)))}return c}},{key:"_layoutInsideLabels",value:function(t,e,i){var n,r,a=this,o=e,s=o.spaceWidth,l=null!==(n=o.position)&&void 0!==n?n:"inside",u=null!==(r=o.offsetRadius)&&void 0!==r?r:-s;return t.forEach((function(t){var i,n,r,c,h=t.labelSize,d=t.radian,p=t.innerRadius,f=t.outerRadius;d<function(t,e){return e>2*t?NaN:2*Math.asin(e/2/t)}(f,h.height)?c=0:c=f-(d>=Math.PI?p:Math.max(p,h.height/2/Math.tan(d/2)))-s;!0!==o.rotate&&(c=f-s);var v=a._getFormatLabelText(t.refDatum,c);t.labelText=v;var g,y=Math.min(c,t.labelSize.width),m=a._computeAlign(t,e),_=0;if("inside"===l&&(_="left"===m?y:"right"===m?0:y/2),g="inside-inner"===l?p-u+_:"inside-center"===l?p+(f-p)/2:f+u-_,t.labelPosition=Ve(t.circleCenter,g,t.middleAngle),t.labelLimit=y,Wt(y,0)||(t.labelVisible=!1),!1!==o.rotate){t.angle=null!==(n=null===(i=e.textStyle)||void 0===i?void 0:i.angle)&&void 0!==n?n:t.middleAngle;var b=null!==(r=o.offsetAngle)&&void 0!==r?r:0;["inside-inner","inside-outer"].includes(l)&&(b+=Math.PI/2),t.angle+=b}})),t}},{key:"_layoutOutsideLabels",value:function(t,e,i){var n,r,a,o=this,l=null!==(n=i[0].attribute.x)&&void 0!==n?n:0,u=2*(null!==(r=i[0].attribute.y)&&void 0!==r?r:0),c=e.layout,h=e.spaceWidth;if(t.forEach((function(t){var e=SI(t.quadrant)?-1:1;t.labelPosition={x:t.outerCenter.x+e*(t.labelSize.width/2+o._line2MinLength+h),y:t.outerCenter.y}})),t.sort((function(t,e){return t.labelPosition.y-e.labelPosition.y})),!1!==e.coverEnable||"none"===c.strategy){var d,p=s(t);try{for(p.s();!(d=p.n()).done;){var f=d.value,v=f.labelPosition,g=f.labelSize;f.labelLimit=g.width,f.pointB=SI(f.quadrant)?{x:v.x+g.width/2+this._line2MinLength+h,y:v.y}:{x:v.x-g.width/2-this._line2MinLength-h,y:v.y},this._computeX(f,e,i)}}catch(t){p.e(t)}finally{p.f()}!1===e.coverEnable&&"none"===c.strategy&&this._coverLabels(t)}else{var y=u/((null===(a=e.textStyle)||void 0===a?void 0:a.fontSize)||16);this._adjustY(t,y,e,i);var m,_=t.reduce((function(t,e){var i=e.getLabelBounds(),n=i.y1,r=i.y2;return t.minY=Math.max(0,Math.min(n,t.minY)),t.maxY=Math.min(u,Math.max(r,t.maxY)),t}),{minY:1/0,maxY:-1/0}),b=_.minY,x=_.maxY,k=Math.max(Math.abs(u/2-b),Math.abs(x-u/2)),S=this._computeLayoutRadius(k,e,i),A=s(t);try{for(A.s();!(m=A.n()).done;){var M=m.value;this._computePointB(M,S,e,i),this._computeX(M,e,i)}}catch(t){A.e(t)}finally{A.f()}}var T=2*l;return t.forEach((function(t){var i,n;t.labelVisible&&(Gt(t.pointB.x,o._line2MinLength+h)||Wt(t.pointB.x,T-o._line2MinLength-h))&&(t.labelVisible=!1),t.angle=null!==(n=null===(i=e.textStyle)||void 0===i?void 0:i.angle)&&void 0!==n?n:0,e.offsetAngle&&(t.angle+=e.offsetAngle),t.labelLine=Object.assign(Object.assign({},e.line),{visible:t.labelVisible})})),t}},{key:"_computeX",value:function(t,e,i){var n,r=t.circleCenter,a=this.attribute.width;this.attribute.height;var o=0;i.forEach((function(t){t.getAttributes(!0).outerRadius>o&&(o=t.getAttributes(!0).outerRadius)}));var s=this.computeLayoutOuterRadius(o,e.width,e.height),l=e.line.line1MinLength,u=null===(n=e.layout)||void 0===n?void 0:n.align,c=e.spaceWidth,h=t.labelPosition,d=t.quadrant,p=t.pointB;et(p.x*p.y)||(t.pointC={x:NaN,y:NaN},h.x=NaN,t.labelLimit=0);var f=this.computeRadius(s,e.width,e.height),v=SI(d)?-1:1,g=0,y=(v>0?a-p.x:p.x-0)+this._alignOffset-this._line2MinLength-c;"labelLine"===u&&(g=(f+l+this._line2MinLength)*v+r.x,y=(v>0?a-g:g-0)-c);var m=this._getFormatLabelText(t.refDatum,y);t.labelText=m;var _=Math.min(y,t.labelSize.width);switch(u){case"labelLine":break;case"edge":g=v>0?a-_-c:0+_+c;break;default:g=p.x+v*this._line2MinLength}var b=(_=Math.max(this._ellipsisWidth,_))<t.labelSize.width-1;t.labelLimit=b?_:null,t.pointC={x:g,y:h.y};var x=function(t){return"left"===t?0:"right"===t?1:.5}(this._computeAlign(t,e))*(b?_:t.labelSize.width);"edge"===u?(h.x=(v>0?a:0)-v*x+v*this._alignOffset,t.pointC.x+=v*this._alignOffset):h.x=g+v*(this._alignOffset+c+x)}},{key:"_computeAlign",value:function(t,e){var i,n,r,a,o,s,l=e,u=null!==(n=null===(i=l.textStyle)||void 0===i?void 0:i.textAlign)&&void 0!==n?n:null===(r=l.textStyle)||void 0===r?void 0:r.align,c=null!==(o=null===(a=l.layout)||void 0===a?void 0:a.textAlign)&&void 0!==o?o:null===(s=l.layout)||void 0===s?void 0:s.align;return"inside"!==l.position?j(u)||"auto"===u?"edge"===c?SI(t.quadrant)?"left":"right":SI(t.quadrant)?"right":"left":u:j(u)||"auto"===u?"center":u}},{key:"_getFormatLabelText",value:function(t,e){var i;return null!==(i=null==t?void 0:t.text)&&void 0!==i?i:""}},{key:"_adjustY",value:function(t,e,i,n){var r;n[0].attribute.x;var a=2*(null!==(r=n[0].attribute.y)&&void 0!==r?r:0),o=i.layout;if("vertical"===o.strategy){var s,l=0,u=t.length;if(u<=0)return;for(var c=0;c<u;c++){if(Gt(s=t[c].getLabelBounds().y1-l,0)){var h=this._shiftY(t,c,u-1,-s);this._shiftY(t,h,0,s/2)}l=t[c].getLabelBounds().y2}Gt(s=t[0].getLabelBounds().y1-0,0)&&this._shiftY(t,0,u-1,-s);for(var d=t.length-1;d>=0&&t[d].getLabelBounds().y2>a;d--)t[d].labelVisible=!1}else if("none"!==o.strategy){var p=t.map((function(t,e){return{arc:t,originIndex:e,priorityIndex:0}}));p.sort((function(t,e){return e.arc.radian-t.arc.radian})),p.forEach((function(t,e){t.priorityIndex=e,t.arc.labelVisible=!1}));for(var f=1/0,v=-1/0,g=0;g<e&&g<t.length;g++){this._storeY(t);var y=p[g].arc;this._computeYRange(y,i,n),y.labelVisible=!0;var m=y.labelPosition.y,_=this._findNeighborIndex(t,p[g]),b=_.lastIndex,x=_.nextIndex,k=t[b],S=t[x];if(-1===b&&-1!==x){var A=S.labelPosition.y;m>A?y.labelPosition.y=A-S.labelSize.height/2-y.labelSize.height/2:this._twoWayShift(t,y,S,x)}else if(-1!==b&&-1===x){var M=k.labelPosition.y;m<M?y.labelPosition.y=M+k.labelSize.height/2+y.labelSize.height/2:this._twoWayShift(t,k,y,p[g].originIndex)}else if(-1!==b&&-1!==x){var T=k.labelPosition.y,w=S.labelPosition.y;m>w?(y.labelPosition.y=w-S.labelSize.height/2-y.labelSize.height/2,this._twoWayShift(t,k,y,p[g].originIndex)):m<T?(y.labelPosition.y=T+k.labelSize.height/2+y.labelSize.height/2,this._twoWayShift(t,y,S,x)):(this._twoWayShift(t,k,y,p[g].originIndex),this._twoWayShift(t,y,S,x))}var C=Math.min(f,p[g].originIndex),E=Math.max(v,p[g].originIndex),P=void 0;if(Wt(P=t[E].getLabelBounds().y2-a,0)&&this._shiftY(t,E,0,-P),Gt(P=t[C].getLabelBounds().y1-0,0)&&this._shiftY(t,C,t.length-1,-P),Wt(P=t[E].getLabelBounds().y2-a,0)){y.labelVisible=!1,this._restoreY(t);break}o.tangentConstraint&&!this._checkYRange(t)?(y.labelVisible=!1,this._restoreY(t)):(f=C,v=E)}}}},{key:"_shiftY",value:function(t,e,i,n){for(var r=e<i?1:-1,a=e;-1!==a;){t[a].labelPosition.y+=n;var o=this._findNextVisibleIndex(t,a,i,r);if(o>=0&&o<t.length){var s=t[a].getLabelBounds(),l=s.y1,u=s.y2,c=t[o].getLabelBounds(),h=c.y1,d=c.y2;if(r>0&&u<h||r<0&&l>d)return a}a=o}return i}},{key:"_findNextVisibleIndex",value:function(t,e,i,n){for(var r=(i-e)*n,a=1;a<=r;a++){var o=e+a*n;if(t[o].labelVisible)return o}return-1}},{key:"_computePointB",value:function(t,e,i,n){var r=i,a=0;n.forEach((function(t){t.getAttributes(!0).outerRadius>a&&(a=t.getAttributes(!0).outerRadius)}));var o=this.computeLayoutOuterRadius(a,i.width,i.height),s=r.line.line1MinLength;if("none"===r.layout.strategy)t.pointB={x:t.outerCenter.x,y:t.outerCenter.y};else{var l=t.circleCenter,u=this.computeRadius(o,i.width,i.height),c=t.labelPosition,h=t.quadrant,d=e-Math.max(u+s,t.outerRadius),p=Math.sqrt(Math.pow(e,2)-Math.pow(Math.abs(l.y-c.y),2))-d;et(p)?t.pointB={x:l.x+p*(SI(h)?-1:1),y:c.y}:t.pointB={x:NaN,y:NaN}}}},{key:"_storeY",value:function(t){var e,i=s(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;n.labelVisible&&(n.lastLabelY=n.labelPosition.y)}}catch(t){i.e(t)}finally{i.f()}}},{key:"_computeYRange",value:function(t,e,i){var n=t.circleCenter,r={width:2*n.x,height:2*n.y},a=0;i.forEach((function(t){t.getAttributes(!0).outerRadius>a&&(a=t.getAttributes(!0).outerRadius)}));var o,s,l,u=this.computeLayoutOuterRadius(a,e.width,e.height),c=e.line.line1MinLength,h=r.width,d=r.height,p=this.computeRadius(u,e.width,e.height),f=this._computeLayoutRadius(d/2,e,i),v=Math.abs(t.center.x-h/2),g=t.center.y-d/2;if(Ut(h/2,v))o=0,s=1,l=-g;else if(Ut(d/2,g))o=1,s=0,l=-v;else{var y=-1/(g/v);o=y,s=-1,l=g-y*v}var m,_,b=function(t,e,i,n,r,a){if(0===t&&0===e||a<=0)return[];if(0===t){var o=-i/e,s=Math.pow(a,2)-Math.pow(o-r,2);return s<0?[]:0===s?[{x:n,y:o}]:[{x:Math.sqrt(s)+n,y:o},{x:-Math.sqrt(s)+n,y:o}]}if(0===e){var l=-i/t,u=Math.pow(a,2)-Math.pow(l-n,2);return u<0?[]:0===u?[{x:l,y:r}]:[{x:l,y:Math.sqrt(u)+r},{x:l,y:-Math.sqrt(u)+r}]}var c=Math.pow(e/t,2)+1,h=2*((i/t+n)*(e/t)-r),d=Math.pow(h,2)-4*c*(Math.pow(i/t+n,2)+Math.pow(r,2)-Math.pow(a,2));if(d<0)return[];var p=(-h+Math.sqrt(d))/(2*c),f=(-h-Math.sqrt(d))/(2*c),v=-(e*p+i)/t;return 0===d?[{x:v,y:p}]:[{x:v,y:p},{x:-(e*f+i)/t,y:f}]}(o,s,l,c+p-f,0,f);b.length<2||(b[0].x>b[1].x&&b.reverse(),b[0].x<0?Ut(b[0].y,b[1].y)?Wt(t.middleAngle,-Math.PI)&&Gt(t.middleAngle,0)||Wt(t.middleAngle,Math.PI)&&Gt(t.middleAngle,2*Math.PI)?(m=0,_=b[1].y+d/2):(m=b[1].y+d/2,_=d):b[0].y<b[1].y?(m=0,_=b[1].y+d/2):(m=b[1].y+d/2,_=r.height):(m=Math.min(b[0].y,b[1].y)+d/2,_=Math.max(b[0].y,b[1].y)+d/2),t.labelYRange=[m,_])}},{key:"_computeLayoutRadius",value:function(t,e,i){var n=e,r=n.layoutArcGap,a=n.line.line1MinLength,o=0;i.forEach((function(t){t.getAttributes(!0).outerRadius>o&&(o=t.getAttributes(!0).outerRadius)}));var s=this.computeLayoutOuterRadius(o,e.width,e.height),l=this.computeRadius(s,e.width,e.height)+a,u=l-r;return Math.max((Math.pow(u,2)+Math.pow(t,2))/(2*u),l)}},{key:"_findNeighborIndex",value:function(t,e){for(var i=e.originIndex,n=-1,r=-1,a=i-1;a>=0;a--)if(t[a].labelVisible){n=a;break}for(var o=i+1;o<t.length;o++)if(t[o].labelVisible){r=o;break}return{lastIndex:n,nextIndex:r}}},{key:"_twoWayShift",value:function(t,e,i,n){var r=i.getLabelBounds().y1-e.getLabelBounds().y2;if(Gt(r,0)){var a=this._shiftY(t,n,t.length-1,-r);this._shiftY(t,a,0,r/2)}}},{key:"_restoreY",value:function(t){var e,i=s(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;n.labelVisible&&(n.labelPosition.y=n.lastLabelY)}}catch(t){i.e(t)}finally{i.f()}}},{key:"_checkYRange",value:function(t){var e,i=s(t);try{for(i.s();!(e=i.n()).done;){var n=e.value,r=n.labelYRange,a=n.labelPosition;if(n.labelVisible&&r&&(Gt(a.y,r[0])||Wt(a.y,r[1])))return!1}}catch(t){i.e(t)}finally{i.f()}return!0}},{key:"_coverLabels",value:function(t){if(!(t.length<=1))for(var e,i,n,r,a,o,s,l,u,c,h=t[0].getLabelBounds(),d=1;d<t.length;d++){var p=t[d].getLabelBounds();i=p,n=void 0,r=void 0,a=void 0,o=void 0,s=void 0,l=void 0,u=void 0,c=void 0,n=(e=h).x1,r=e.y1,a=e.x2,o=e.y2,s=i.x1,l=i.y1,u=i.x2,c=i.y2,n<=s&&a<=s||n>=u&&a>=u||r<=l&&o<=l||r>=c&&o>=c?h=p:t[d].labelVisible=!1}}},{key:"_getLabelLinePoints",value:function(t,e){return t.attribute.points}},{key:"_createLabelLine",value:function(t,i){var n,r,a,o,s,l=t.attribute,u=l.line,c=void 0===u?{}:u,h=l.visible,d=_(e,"_createLabelLine",this,3)([t,i]);if(d&&(d.setAttributes({visible:null===(a=null!==(n=c.visible&&h)&&void 0!==n?n:null===(r=t.attribute)||void 0===r?void 0:r.visible)||void 0===a||a,lineWidth:null!==(s=null===(o=c.style)||void 0===o?void 0:o.lineWidth)&&void 0!==s?s:1}),c.smooth&&d.setAttributes({curveType:"basis"}),"arc3d"===i.type&&i)){var p=i.getAttributes(!0),f=p.beta,v=p.x,g=p.y;d.setAttributes({beta:f,anchor3d:[v,g]})}return d}},{key:"computeRadius",value:function(t,e,i,n){return this.computeLayoutRadius(e||0,i||0)*t*(j(n)?1:n)}},{key:"computeLayoutRadius",value:function(t,e){return Math.min(t/2,e/2)}},{key:"_canPlaceInside",value:function(t,e){return"inside"===this.attribute.position||"inside-center"===this.attribute.position}},{key:"computeLayoutOuterRadius",value:function(t,e,i){return t/(Math.min(e,i)/2)}},{key:"computeDatumRadius",value:function(t,e,i){var n=this.computeLayoutOuterRadius(i,t,e);return this.computeLayoutRadius(t||0,e||0)*n}}])}(LI);XI.defaultAttributes={coverEnable:!1,spaceWidth:5,layoutArcGap:6,textStyle:{visible:!0,fontSize:14,fontWeight:"normal",fillOpacity:1,boundsPadding:[-1,0,-1,0],ellipsis:!0},position:"outside",line:{visible:!0,line1MinLength:20,line2MinLength:10},layout:{align:"arc",strategy:"priority",tangentConstraint:!0}};var KI=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},qI=function(t){function e(t,i){var a;r(this,e);var o=t.dataLabels,s=KI(t,["dataLabels"]);return(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:Object.assign({dataLabels:o},gt({},e.defaultAttributes,s))])).name="data-label",a}return h(e,t),o(e,[{key:"render",value:function(){var t,e=this,i=this.attribute,n=i.dataLabels,r=i.size;if(n&&0!==n.length){var a=r||{},o=a.width,s=void 0===o?0:o,l=a.height,u=void 0===l?0:l,c=a.padding;if(s&&u&&et(u*s)){this._componentMap||(this._componentMap=new Map);for(var h=pI(s,u,c),d=h.bitmap(),p=new Map,f=this._componentMap,v=0;v<n.length;v++){var g=n[v],y=OI(g.type)||LI;if(y){var m=g.baseMarkGroupName,_=g.type,b=null!==(t=g.id)&&void 0!==t?t:"".concat(m,"-").concat(_,"-").concat(v);"arc"===g.type&&(g.width=r.width,g.height=r.height);var x=this._componentMap.get(b);x?(x.setBitmapTool(h),x.setBitmap(d),x.setAttributes(g),p.set(b,x)):((x=new y(g)).setBitmap(d),x.setBitmapTool(h),this.add(x),p.set(b,x))}}f.forEach((function(t,i){p.get(i)||e.removeChild(t)})),this._componentMap=p}}}},{key:"setLocation",value:function(t){this.translateTo(t.x,t.y)}},{key:"disableAnimation",value:function(){this._componentMap.forEach((function(t){t.disableAnimation()}))}},{key:"enableAnimation",value:function(){this._componentMap.forEach((function(t){t.enableAnimation()}))}}])}(Sx);function ZI(t,e,i,n){var r="";if(!t||0===e.length)return r;var a=e[0],o=Oe.distancePP(t,a),s=i?0:1;return n?r+="M".concat(t.x,",").concat(t.y-o,"A").concat(o,",").concat(o,",0,0,").concat(s,",").concat(t.x,",").concat(t.y+o,"A").concat(o,",").concat(o,",0,0,").concat(s,",").concat(t.x,",").concat(t.y-o,"Z"):e.forEach((function(t,e){0===e?r="M".concat(t.x,",").concat(t.y):r+="A".concat(o,",").concat(o,",0,0,").concat(s,",").concat(t.x,",").concat(t.y)})),r}function JI(t,e,i){var n=i.type,r=i.closed,a=e.slice(0).reverse(),o="",s="";if("line"===n&&i.smoothLink&&i.center){var l=t[0],u=a[0],c=i.center;o=VE(t,!!r),s=VE(a,!!r);var h=Oe.distancePP(u,c),d=Oe.distancePP(l,c);o+="A".concat(h,",").concat(h,",0,0,1,").concat(u.x,",").concat(u.y,"L").concat(u.x,",").concat(u.y),s+="A".concat(d,",").concat(d,",0,0,0,").concat(l.x,",").concat(l.y)}else if("circle"===n){var p=i.center;o=ZI(p,t,!1,!!r),s=ZI(p,a,!0,!!r)}else"line"!==n&&"polygon"!==n||(o=VE(t,!!r),s=VE(a,!!r));return r?o+=s:(o+=s="L"+s.substring(1),o+="Z"),o}qI.defaultAttributes={pickable:!1};var QI=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="axis-grid",t.data=[],t}return h(e,t),o(e,[{key:"getInnerView",value:function(){return this._innerView}},{key:"getPrevInnerView",value:function(){return this._prevInnerView}},{key:"render",value:function(){this._prevInnerView=this._innerView&&FE(this._innerView),this.removeAllChild(!0),this._innerView=kg.group({x:0,y:0,pickable:!1}),this.add(this._innerView);var t=this.attribute,e=t.items,i=t.visible;e&&e.length&&!1!==i&&(this.data=this._transformItems(e),this._renderGrid(this._innerView))}},{key:"getVerticalCoord",value:function(t,e,i){return zE(t,this.getVerticalVector(e,i,t))}},{key:"_transformItems",value:function(t){var e=this,i=[];return t.forEach((function(t){var n;i.push(Object.assign(Object.assign({},t),{point:e.getTickCoord(t.value),id:null!==(n=t.id)&&void 0!==n?n:t.label}))})),i}},{key:"_renderGrid",value:function(t){(this.attribute.subGrid||{}).visible&&this._renderGridByType(!0,t),this._renderGridByType(!1,t)}},{key:"_renderGridByType",value:function(t,i){var n=this,r=gt({},this.attribute,this.getGridAttribute(t)),a=r.type,o=r.items,s=r.style,l=r.closed,u=r.alternateColor,c=r.depth,h=void 0===c?0:c,d=t?"".concat(wE.grid,"-sub"):"".concat(wE.grid);if(o.forEach((function(t,r){var o=t.id,u=t.points,c="";if("line"===a||"polygon"===a)c=VE(u,!!l);else if("circle"===a){c=ZI(n.attribute.center,u,!1,!!l)}var p=kg.path(Object.assign({path:c,z:h},V(s)?gt({},n.skipDefault?null:e.defaultAttributes.style,s(t,r)):s));p.name="".concat(d,"-line"),p.id=n._getNodeId("".concat(d,"-path-").concat(o)),i.add(p)})),h&&"line"===a&&o.forEach((function(t,r){var a=t.id,o=t.points,u=[];u.push(o[0]);var c=o[1].x-o[0].x,p=o[1].y-o[0].y,f=Math.sqrt(c*c+p*p),v=h/f;u.push({x:o[0].x+c*v,y:o[0].y+p*v});var g=VE(u,!!l),y=_e(u[0].x-u[1].x),m=_e(u[0].y-u[1].y),_=kg.path(Object.assign({path:g,z:0,alpha:y>m?(o[1].x-o[0].x>0?-1:1)*ve/2:0,beta:y<m?-ve/2:0,anchor3d:y>m?[u[0].x,0]:[0,u[0].y]},V(s)?gt({},n.skipDefault?null:e.defaultAttributes.style,s(t,r)):s));_.name="".concat(d,"-line"),_.id=n._getNodeId("".concat(d,"-path-").concat(a)),i.add(_)})),o.length>1&&u){var p=q(u)?u:[u,"transparent"],f=function(t){return p[t%p.length]},v=this.attribute.items,g=v[0],y=v[v.length-1],m=!Ut(g.value,0)&&!Ut(y.value,0),_=!Ut(g.value,1)&&!Ut(y.value,1),b=[],x=g.value>y.value;(x&&_||!x&&m)&&b.push(this.getGridPointsByValue(x?1:0)),o.forEach((function(t){b.push(t.points)})),(x&&m||!x&&_)&&b.push(this.getGridPointsByValue(x?0:1));for(var k=0;k<b.length-1;k++){var S=JI(b[k],b[k+1],r),A=kg.path({path:S,fill:f(k)});A.name="".concat(d,"-region"),A.id=this._getNodeId("".concat(d,"-region-").concat(k)),i.add(A)}}}},{key:"_getNodeId",value:function(t){return"".concat(this.id,"-").concat(t)}},{key:"_parseTickSegment",value:function(){var t=1;return this.data.length>=2&&(t=this.data[1].value-this.data[0].value),t}},{key:"_getPointsOfSubGrid",value:function(t,e){var i=this,n=this.data.length,r=[];return n>=2&&this.data.forEach((function(n){var a=n.value;if(!e){var o=n.value-t/2;if(i.isInValidValue(o))return;a=o}r.push({value:a})})),r}},{key:"release",value:function(){_(e,"release",this,3)([]),this._prevInnerView=null,this._innerView=null}}])}(Sx);QI.defaultAttributes={style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]}}},Kw(),tC();var $I=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},QI.defaultAttributes,t),i])}return h(e,t),o(e,[{key:"_getGridPoint",value:function(t,e){var i;if("line"===t){var n=this.attribute.length;i=[e,this.getVerticalCoord(e,n,!0)]}else if("circle"===t||"polygon"===t){var r=this.attribute,a=r.center,o=r.sides,s=void 0===o?6:o,l=r.startAngle,u=void 0===l?gC:l,c=r.endAngle,h=void 0===c?yC:c;i=NE(a,s,Oe.distancePP(a,e),u,h)}return i}},{key:"getGridPointsByValue",value:function(t){var e=this.getTickCoord(t);return this._getGridPoint(this.attribute.type,e)}},{key:"getGridAttribute",value:function(t){var e,i=this,n=this.attribute,r=n.type,a=n.alignWithLabel,o=void 0===a||a,s=this._parseTickSegment(),l=[];if(t){var u=[],c=(e=gt({},this.attribute,this.attribute.subGrid)).count,h=void 0===c?4:c;if(this.data.length>=2){for(var d=this._getPointsOfSubGrid(s,o),p=0;p<d.length-1;p++){var f=d[p],v=d[p+1];u.push({id:"sub-".concat(p,"-0"),points:this.getGridPointsByValue(f.value),datum:{}});for(var g=0;g<h;g++){var y=(g+1)/(h+1),m=(1-y)*f.value+y*v.value;u.push({id:"sub-".concat(p,"-").concat(g+1),points:this.getGridPointsByValue(m),datum:{}})}p===d.length-2&&u.push({id:"sub-".concat(p,"-").concat(h+1),points:this.getGridPointsByValue(v.value),datum:{}})}l=u}}else{e=this.attribute;var _=[];this.data.forEach((function(t){var e=t.point;if(!o){var n=t.value-s/2;if(i.isInValidValue(n))return;e=i.getTickCoord(n)}_.push({id:t.label,datum:t,points:i._getGridPoint(r,e)})})),l=_}return Object.assign(Object.assign({},e),{items:l})}}])}(QI);kt($I,oP);var tD=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};Kw(),tC();var eD=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},QI.defaultAttributes,t),i])}return h(e,t),o(e,[{key:"getGridPointsByValue",value:function(t){var e=this.getTickCoord(t),i=this.attribute,n=i.radius,r=i.innerRadius,a=void 0===r?0:r;return[e,this.getVerticalCoord(e,n-a,!0)]}},{key:"getGridAttribute",value:function(t){var e,i=this,n=[],r=this.attribute,a=r.radius,o=r.innerRadius,s=void 0===o?0:o,l=r.startAngle,u=void 0===l?gC:l,c=r.endAngle,h=void 0===c?yC:c,d=r.center,p=r.subGrid,f=tD(r,["radius","innerRadius","startAngle","endAngle","center","subGrid"]),v=(f||{}).alignWithLabel,g=void 0===v||v,y=a-s,m=this._parseTickSegment();if(t){e=gt({},f,p);var _=[],x=(p||{}).count,k=void 0===x?4:x,S=this.data.length;if(S>=2){for(var A=this._getPointsOfSubGrid(m,g),M=0;M<S;M++){var T=A[M],w=A[M+1];_.push({id:"sub-".concat(M,"-0"),points:[this.getTickCoord(T.value),this.getVerticalCoord(this.getTickCoord(T.value),y,!0)],datum:{}});for(var C=0;C<k;C++){var E=(C+1)/(k+1),P=(1-E)*T.value+E*(w?w.value:g?1:T.value+m),B=this.getTickCoord(P),R=this.getVerticalCoord(B,y,!0);_.push({id:"sub-".concat(M,"-").concat(C+1),points:[B,R],datum:{}})}}Math.abs(h-u)%(2*Math.PI)==0&&_.push(_[0]),n=_}}else{e=f;var L=[];(Math.abs(h-u)%(2*Math.PI)==0?b(this.data).concat(this.data[0]):this.data).forEach((function(t){var e=t.point;if(!g){var n=t.value-m/2;if(i.isInValidValue(n))return;e=i.getTickCoord(n)}var r=i.getVerticalCoord(e,y,!0);L.push({id:t.id,points:[e,r],datum:t})})),n=L}return Object.assign(Object.assign({},e),{items:n,center:d,type:"line"})}}])}(QI);kt(eD,HR);var iD,nD="M -0.0544 0.25 C -0.0742 0.25 -0.0901 0.234 -0.0901 0.2143 L -0.0901 -0.1786 C -0.0901 -0.1983 -0.0742 -0.2143 -0.0544 -0.2143 L -0.0187 -0.2143 L -0.0187 -0.5 L 0.017 -0.5 L 0.017 -0.2143 L 0.0527 -0.2143 C 0.0724 -0.2143 0.0884 -0.1983 0.0884 -0.1786 L 0.0884 0.2143 C 0.0884 0.234 0.0724 0.25 0.0527 0.25 L 0.017 0.25 L 0.017 0.5 L -0.0187 0.5 L -0.0187 0.25 L -0.0544 0.25 Z M -0.0187 -0.1429 L -0.0544 -0.1429 L -0.0544 0.1786 L -0.0187 0.1786 L -0.0187 -0.1429 Z M 0.0527 -0.1429 L 0.017 -0.1429 L 0.017 0.1786 L 0.0527 0.1786 L 0.0527 -0.1429 Z",rD={orient:"bottom",showDetail:"auto",brushSelect:!0,zoomLock:!1,minSpan:0,maxSpan:1,delayType:"throttle",delayTime:0,realTime:!0,backgroundStyle:{fill:"white",stroke:"#D1DBEE",lineWidth:1,cornerRadius:2},dragMaskStyle:{fill:"#B0C8F9",fillOpacity:.2},backgroundChartStyle:{area:{visible:!0,stroke:"#D1DBEE",lineWidth:1,fill:"#F6F8FC"},line:{visible:!0,stroke:"#D1DBEE",lineWidth:1}},selectedBackgroundStyle:{fill:"#B0C8F9",fillOpacity:.5},selectedBackgroundChartStyle:{area:{visible:!0,stroke:"#B0C8F9",lineWidth:1,fill:"#fbb934"},line:{visible:!0,stroke:"#fbb934",lineWidth:1}},middleHandlerStyle:{visible:!0,background:{size:8,style:{fill:"white",stroke:"#B0C8F9",cornerRadius:2}},icon:{size:6,fill:"white",stroke:"#B0C8F9",symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}},startHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:nD,fill:"white",stroke:"#B0C8F9",lineWidth:.5},endHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:nD,fill:"white",stroke:"#B0C8F9",lineWidth:.5},startTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}},endTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}}},aD={horizontal:{angle:0,strokeBoundsBuffer:0,boundsPadding:2,pickMode:"imprecise",cursor:"ew-resize"},vertical:{angle:Math.PI/180*90,cursor:"ns-resize",boundsPadding:2,pickMode:"imprecise",strokeBoundsBuffer:0}};!function(t){t.startHandler="startHandler",t.endHandler="endHandler",t.middleHandler="middleHandler",t.background="background"}(iD||(iD={}));var oD=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},sD={debounce:Jt,throttle:Qt};QC(),rC(),cC(),jw(),Qw();var lD,uD,cD,hD,dD=function(t){function e(t,i){var a;r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="dataZoom",a._previewData=[],a._activeState=!1,a._activeCache={startPos:{x:0,y:0},lastPos:{x:0,y:0}},a._layoutCache={attPos:"x",attSize:"width",max:0},a.state={start:0,end:1},a._statePointToData=function(t){return t},a._handleTouchMove=function(t){a._activeState&&t.preventDefault()},a._onHandlerPointerDown=function(t,e){a._clearDragEvents(),"start"===e?(a._activeTag=iD.startHandler,a._activeItem=a._startHandlerMask):"end"===e?(a._activeTag=iD.endHandler,a._activeItem=a._endHandlerMask):"middleRect"===e?(a._activeTag=iD.middleHandler,a._activeItem=a._middleHandlerRect):"middleSymbol"===e?(a._activeTag=iD.middleHandler,a._activeItem=a._middleHandlerSymbol):"background"===e&&(a._activeTag=iD.background,a._activeItem=a._background),a._activeState=!0,a._activeCache.startPos=a.eventPosToStagePos(t),a._activeCache.lastPos=a.eventPosToStagePos(t);var i="browser"===j_.env?j_:a.stage,n=kC();i.addEventListener("pointermove",a._onHandlerPointerMove,{capture:!0}),a.addEventListener("pointermove",a._onHandlerPointerMove,{capture:!0}),n.forEach((function(t){i.addEventListener(t,a._onHandlerPointerUp)}))},a._pointerMove=function(t){var e=a.attribute,i=e.start,n=e.end,r=e.brushSelect,o=e.realTime,s=void 0===o||o,l=a.eventPosToStagePos(t),u=a._layoutCache,c=u.attPos,h=u.max,d=(l[c]-a._activeCache.lastPos[c])/h,p=a.state,f=p.start,v=p.end;a._activeState&&(a._activeTag===iD.middleHandler?a.moveZoomWithMiddle((a.state.start+a.state.end)/2+d):a._activeTag===iD.startHandler?f+d>v?(v=(f=v)+d,a._activeTag=iD.endHandler):f+=d:a._activeTag===iD.endHandler&&(v+d<f?(f=(v=f)+d,a._activeTag=iD.startHandler):v+=d),a._activeCache.lastPos=l,r&&a.renderDragMask()),f=Math.min(Math.max(f,0),1),v=Math.min(Math.max(v,0),1),i===f&&n===v||(a.setStateAttr(f,v,!0),s&&a._dispatchEvent("change",{start:f,end:v,tag:a._activeTag}))},a._onHandlerPointerMove=0===a.attribute.delayTime?a._pointerMove:sD[a.attribute.delayType](a._pointerMove,a.attribute.delayTime),a._onHandlerPointerUp=function(t){var e=a.attribute;e.start,e.end;var i=e.brushSelect;if(e.realTime,a._activeState&&a._activeTag===iD.background){var n=a.eventPosToStagePos(t);a.backgroundDragZoom(a._activeCache.startPos,n)}a._activeState=!1,i&&a.renderDragMask(),a._dispatchEvent("change",{start:a.state.start,end:a.state.end,tag:a._activeTag}),a._clearDragEvents()};var o=t.position,s=t.showDetail;return a._activeCache.startPos=o,a._activeCache.lastPos=o,a._showText="auto"!==s&&s,a.setPropsFromAttrs(),a}return h(e,t),o(e,[{key:"setPropsFromAttrs",value:function(){var t=this.attribute,e=t.start,i=t.end,n=t.orient,r=t.previewData,a=t.previewPointsX,o=t.previewPointsY,s=t.previewPointsX1,l=t.previewPointsY1;e&&(this.state.start=e),i&&(this.state.end=i);var u=this.getLayoutAttrFromConfig(),c=u.width,h=u.height;this._spanCache=this.state.end-this.state.start,this._isHorizontal="top"===n||"bottom"===n,this._layoutCache.max=this._isHorizontal?c:h,this._layoutCache.attPos=this._isHorizontal?"x":"y",this._layoutCache.attSize=this._isHorizontal?"width":"height",r&&(this._previewData=r),V(a)&&(this._previewPointsX=a),V(o)&&(this._previewPointsY=o),V(s)&&(this._previewPointsX1=s),V(l)&&(this._previewPointsY1=l)}},{key:"setAttributes",value:function(t,i){_(e,"setAttributes",this,3)([t,i]),this.setPropsFromAttrs()}},{key:"bindEvents",value:function(){var t=this;if(this.attribute.disableTriggerEvent)this.setAttribute("childrenPickable",!1);else{var e=this.attribute,i=e.showDetail,n=e.brushSelect;this._startHandlerMask&&this._startHandlerMask.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"start")})),this._endHandlerMask&&this._endHandlerMask.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"end")})),this._middleHandlerSymbol&&this._middleHandlerSymbol.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"middleSymbol")})),this._middleHandlerRect&&this._middleHandlerRect.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"middleRect")}));var r=n?"background":"middleRect";this._selectedBackground&&this._selectedBackground.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,r)})),n&&this._background&&this._background.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"background")})),n&&this._previewGroup&&this._previewGroup.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"background")})),this._selectedPreviewGroup&&this._selectedPreviewGroup.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,r)})),"auto"===i&&(this.addEventListener("pointerenter",this._onHandlerPointerEnter),this.addEventListener("pointerleave",this._onHandlerPointerLeave)),("browser"===j_.env?j_:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}}},{key:"dragMaskSize",value:function(){var t=this.attribute.position,e=this._layoutCache,i=e.attPos,n=e.max;return this._activeCache.lastPos[i]-t[i]>n?n+t[i]-this._activeCache.startPos[i]:this._activeCache.lastPos[i]-t[i]<0?t[i]-this._activeCache.startPos[i]:this._activeCache.lastPos[i]-this._activeCache.startPos[i]}},{key:"setStateAttr",value:function(t,e,i){var n=this.attribute,r=n.zoomLock,a=void 0!==r&&r,o=n.minSpan,s=void 0===o?0:o,l=n.maxSpan,u=void 0===l?1:l,c=e-t;c!==this._spanCache&&(a||c<s||c>u)||(this._spanCache=c,this.state.start=t,this.state.end=e,i&&this.setAttributes({start:t,end:e}))}},{key:"_clearDragEvents",value:function(){var t=this,e="browser"===j_.env?j_:this.stage,i=kC();e.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),i.forEach((function(i){e.removeEventListener(i,t._onHandlerPointerUp)})),this.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0})}},{key:"_onHandlerPointerEnter",value:function(t){this._showText=!0,this.renderText()}},{key:"_onHandlerPointerLeave",value:function(t){this._showText=!1,this.renderText()}},{key:"backgroundDragZoom",value:function(t,e){var i=this._layoutCache,n=i.attPos,r=i.max,a=this.attribute.position,o=t[n]-a[n],s=e[n]-a[n],l=Math.min(Math.max(Math.min(o,s)/r,0),1),u=Math.min(Math.max(Math.max(o,s)/r,0),1);Math.abs(l-u)<.01?this.moveZoomWithMiddle(l):this.setStateAttr(l,u,!1)}},{key:"moveZoomWithMiddle",value:function(t){var e=t-(this.state.start+this.state.end)/2;0!==e&&(e>0?this.state.end+e>1&&(e=1-this.state.end):e<0&&this.state.start+e<0&&(e=-this.state.start),this.setStateAttr(this.state.start+e,this.state.end+e,!1))}},{key:"renderDragMask",value:function(){var t=this.attribute.dragMaskStyle,e=this.getLayoutAttrFromConfig(),i=e.position,n=e.width,r=e.height;this._isHorizontal?this._dragMask=this._container.createOrUpdateChild("dragMask",Object.assign({x:Xt(this.dragMaskSize()<0?this._activeCache.lastPos.x:this._activeCache.startPos.x,i.x,i.x+n),y:i.y,width:this._activeState&&this._activeTag===iD.background&&Math.abs(this.dragMaskSize())||0,height:r},t),"rect"):this._dragMask=this._container.createOrUpdateChild("dragMask",Object.assign({x:i.x,y:Xt(this.dragMaskSize()<0?this._activeCache.lastPos.y:this._activeCache.startPos.y,i.y,i.y+r),width:n,height:this._activeState&&this._activeTag===iD.background&&Math.abs(this.dragMaskSize())||0},t),"rect")}},{key:"isTextOverflow",value:function(t,e,i){if(!e)return!1;if(this._isHorizontal){if("start"===i){if(e.x1<t.x1)return!0}else if(e.x2>t.x2)return!0}else if("start"===i){if(e.y1<t.y1)return!0}else if(e.y2>t.y2)return!0;return!1}},{key:"setTextAttr",value:function(t,e){var i,n,r,a,o,s,l,u,c=this.attribute,h=c.startTextStyle,d=c.endTextStyle,p=h.formatMethod,f=oD(h,["formatMethod"]),v=d.formatMethod,g=oD(d,["formatMethod"]),y=this.state,m=y.start,_=y.end;this._startValue=this._statePointToData(m),this._endValue=this._statePointToData(_);var b,x,k,S,A=this.getLayoutAttrFromConfig(),M=A.position,T=A.width,w=A.height,C=p?p(this._startValue):this._startValue,E=v?v(this._endValue):this._endValue,P={x1:M.x,y1:M.y,x2:M.x+T,y2:M.y+w};this._isHorizontal?(b={x:M.x+m*T,y:M.y+w/2},x={x:M.x+_*T,y:M.y+w/2},k={textAlign:this.isTextOverflow(P,t,"start")?"left":"right",textBaseline:null!==(n=null===(i=null==f?void 0:f.textStyle)||void 0===i?void 0:i.textBaseline)&&void 0!==n?n:"middle"},S={textAlign:this.isTextOverflow(P,e,"end")?"right":"left",textBaseline:null!==(a=null===(r=null==g?void 0:g.textStyle)||void 0===r?void 0:r.textBaseline)&&void 0!==a?a:"middle"}):(b={x:M.x+T/2,y:M.y+m*w},x={x:M.x+T/2,y:M.y+_*w},k={textAlign:null!==(s=null===(o=null==f?void 0:f.textStyle)||void 0===o?void 0:o.textAlign)&&void 0!==s?s:"center",textBaseline:this.isTextOverflow(P,t,"start")?"top":"bottom"},S={textAlign:null!==(u=null===(l=null==g?void 0:g.textStyle)||void 0===l?void 0:l.textAlign)&&void 0!==u?u:"center",textBaseline:this.isTextOverflow(P,e,"end")?"bottom":"top"}),this._startText=this.maybeAddLabel(this._container,gt({},f,{text:C,x:b.x,y:b.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:k}),"data-zoom-start-text-".concat(M)),this._endText=this.maybeAddLabel(this._container,gt({},g,{text:E,x:x.x,y:x.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:S}),"data-zoom-end-text-".concat(M))}},{key:"renderText",value:function(){var t=null,e=null;this.setTextAttr(t,e),t=this._startText.AABBBounds,e=this._endText.AABBBounds,this.setTextAttr(t,e),t=this._startText.AABBBounds,e=this._endText.AABBBounds;var i=t,n=i.x1,r=i.x2,a=i.y1,o=i.y2,s=this.attribute.startTextStyle,l=s.dx,u=void 0===l?0:l,c=s.dy,h=void 0===c?0:c;if((new mi).set(n,a,r,o).intersects(e)){var d="bottom"===this.attribute.orient||"right"===this.attribute.orient?-1:1;if(this._isHorizontal){var p=Math.abs(e.y1-e.y2);this._startText.setAttribute("dy",h+d*(Number.isFinite(p)?p:0))}else{var f=Math.abs(e.x1-e.x2);this._startText.setAttribute("dx",u+d*(Number.isFinite(f)?f:0))}}else this._isHorizontal?this._startText.setAttribute("dy",h):this._startText.setAttribute("dx",u)}},{key:"getLayoutAttrFromConfig",value:function(){var t,e,i,n,r,a;if(this._layoutAttrFromConfig)return this._layoutAttrFromConfig;var o,s,l,u=this.attribute,c=u.position,h=u.size,d=u.orient,p=u.middleHandlerStyle,f=void 0===p?{}:p,v=u.startHandlerStyle,g=void 0===v?{}:v,y=u.endHandlerStyle,m=void 0===y?{}:y,_=u.backgroundStyle,b=void 0===_?{}:_,x=h.width,k=h.height,S=null!==(e=null===(t=f.background)||void 0===t?void 0:t.size)&&void 0!==e?e:10;f.visible?this._isHorizontal?(o=x,s=k-S,l={x:c.x,y:c.y+S}):(o=x-S,s=k,l={x:c.x+("left"===d?S:0),y:c.y}):(o=x,s=k,l=c);var A=null!==(i=g.size)&&void 0!==i?i:this._isHorizontal?s:o,M=null!==(n=m.size)&&void 0!==n?n:this._isHorizontal?s:o;return g.visible&&(this._isHorizontal?(o-=(A+M)/2,l={x:l.x+A/2,y:l.y}):(s-=(A+M)/2,l={x:l.x,y:l.y+A/2})),s+=null!==(r=b.lineWidth/2)&&void 0!==r?r:1,o+=null!==(a=b.lineWidth/2)&&void 0!==a?a:1,this._layoutAttrFromConfig={position:l,width:o,height:s},this._layoutAttrFromConfig}},{key:"render",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b,x,k,S,A,M,T,w,C,E,P,B,R,L;this._layoutAttrFromConfig=null;var I=this.attribute,D=I.orient,O=I.backgroundStyle,F=I.backgroundChartStyle,z=void 0===F?{}:F,H=I.selectedBackgroundStyle,N=void 0===H?{}:H,V=I.selectedBackgroundChartStyle,j=void 0===V?{}:V,U=I.middleHandlerStyle,W=void 0===U?{}:U,G=I.startHandlerStyle,Y=void 0===G?{}:G,X=I.endHandlerStyle,K=void 0===X?{}:X,q=I.brushSelect,Z=I.zoomLock,J=this.state,Q=J.start,$=J.end,tt=this.getLayoutAttrFromConfig(),et=tt.position,it=tt.width,nt=tt.height,rt=null!==(t=Y.triggerMinSize)&&void 0!==t?t:40,at=null!==(e=K.triggerMinSize)&&void 0!==e?e:40,ot=this.createOrUpdateChild("dataZoom-container",{},"group");if(this._container=ot,this._background=ot.createOrUpdateChild("background",Object.assign(Object.assign({x:et.x,y:et.y,width:it,height:nt,cursor:q?"crosshair":"auto"},O),{pickable:!Z&&(null===(i=O.pickable)||void 0===i||i)}),"rect"),(null===(n=z.line)||void 0===n?void 0:n.visible)&&this.setPreviewAttributes("line",ot),(null===(r=z.area)||void 0===r?void 0:r.visible)&&this.setPreviewAttributes("area",ot),q&&this.renderDragMask(),this._isHorizontal?this._selectedBackground=ot.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:et.x+Q*it,y:et.y,width:($-Q)*it,height:nt,cursor:q?"crosshair":"move"},N),{pickable:!Z&&(null===(a=j.pickable)||void 0===a||a)}),"rect"):this._selectedBackground=ot.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:et.x,y:et.y+Q*nt,width:it,height:($-Q)*nt,cursor:q?"crosshair":"move"},N),{pickable:!Z&&(null===(o=N.pickable)||void 0===o||o)}),"rect"),(null===(s=j.line)||void 0===s?void 0:s.visible)&&this.setSelectedPreviewAttributes("line",ot),(null===(l=j.area)||void 0===l?void 0:l.visible)&&this.setSelectedPreviewAttributes("area",ot),this._isHorizontal){if(W.visible){var st=(null===(u=W.background)||void 0===u?void 0:u.size)||10;this._middleHandlerRect=ot.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:et.x+Q*it,y:et.y-st,width:($-Q)*it,height:st},null===(c=W.background)||void 0===c?void 0:c.style),{pickable:!Z&&(null===(p=null===(d=null===(h=W.background)||void 0===h?void 0:h.style)||void 0===d?void 0:d.pickable)||void 0===p||p)}),"rect"),this._middleHandlerSymbol=ot.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:et.x+(Q+$)/2*it,y:et.y-st/2,strokeBoundsBuffer:0,angle:0,symbolType:null!==(v=null===(f=W.icon)||void 0===f?void 0:f.symbolType)&&void 0!==v?v:"square"},W.icon),{pickable:!Z&&(null===(g=W.icon.pickable)||void 0===g||g)}),"symbol")}this._startHandler=ot.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:et.x+Q*it,y:et.y+nt/2,size:nt,symbolType:null!==(y=Y.symbolType)&&void 0!==y?y:"square"},aD.horizontal),Y),{pickable:!Z&&(null===(m=Y.pickable)||void 0===m||m)}),"symbol"),this._endHandler=ot.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:et.x+$*it,y:et.y+nt/2,size:nt,symbolType:null!==(_=K.symbolType)&&void 0!==_?_:"square"},aD.horizontal),K),{pickable:!Z&&(null===(b=K.pickable)||void 0===b||b)}),"symbol");var lt=Math.max(this._startHandler.AABBBounds.width(),rt),ut=Math.max(this._startHandler.AABBBounds.height(),rt),ct=Math.max(this._endHandler.AABBBounds.width(),at),ht=Math.max(this._endHandler.AABBBounds.height(),at);this._startHandlerMask=ot.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:et.x+Q*it-lt/2,y:et.y+nt/2-ut/2,width:lt,height:ut,fill:"white",fillOpacity:0,zIndex:999},aD.horizontal),{pickable:!Z}),"rect"),this._endHandlerMask=ot.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:et.x+$*it-ct/2,y:et.y+nt/2-ht/2,width:ct,height:ht,fill:"white",fillOpacity:0,zIndex:999},aD.horizontal),{pickable:!Z}),"rect")}else{if(W.visible){var dt=(null===(x=W.background)||void 0===x?void 0:x.size)||10;this._middleHandlerRect=ot.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:"left"===D?et.x-dt:et.x+it,y:et.y+Q*nt,width:dt,height:($-Q)*nt},null===(k=W.background)||void 0===k?void 0:k.style),{pickable:!Z&&(null===(M=null===(A=null===(S=W.background)||void 0===S?void 0:S.style)||void 0===A?void 0:A.pickable)||void 0===M||M)}),"rect"),this._middleHandlerSymbol=ot.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:"left"===D?et.x-dt/2:et.x+it+dt/2,y:et.y+(Q+$)/2*nt,angle:Math.PI/180*90,symbolType:null!==(w=null===(T=W.icon)||void 0===T?void 0:T.symbolType)&&void 0!==w?w:"square",strokeBoundsBuffer:0},W.icon),{pickable:!Z&&(null===(E=null===(C=W.icon)||void 0===C?void 0:C.pickable)||void 0===E||E)}),"symbol")}this._startHandler=ot.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:et.x+it/2,y:et.y+Q*nt,size:it,symbolType:null!==(P=Y.symbolType)&&void 0!==P?P:"square"},aD.vertical),Y),{pickable:!Z&&(null===(B=Y.pickable)||void 0===B||B)}),"symbol"),this._endHandler=ot.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:et.x+it/2,y:et.y+$*nt,size:it,symbolType:null!==(R=K.symbolType)&&void 0!==R?R:"square"},aD.vertical),K),{pickable:!Z&&(null===(L=K.pickable)||void 0===L||L)}),"symbol");var pt=Math.max(this._startHandler.AABBBounds.width(),rt),ft=Math.max(this._startHandler.AABBBounds.height(),rt),vt=Math.max(this._endHandler.AABBBounds.width(),at),gt=Math.max(this._endHandler.AABBBounds.height(),at);this._startHandlerMask=ot.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:et.x+it/2+pt/2,y:et.y+Q*nt-ft/2,width:gt,height:vt,fill:"white",fillOpacity:0,zIndex:999},aD.vertical),{pickable:!Z}),"rect"),this._endHandlerMask=ot.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:et.x+it/2+vt/2,y:et.y+$*nt-gt/2,width:gt,height:vt,fill:"white",fillOpacity:0,zIndex:999},aD.vertical),{pickable:!Z}),"rect")}this._showText&&this.renderText()}},{key:"computeBasePoints",value:function(){var t,e,i=this.attribute.orient,n=this.getLayoutAttrFromConfig(),r=n.position,a=n.width,o=n.height;return this._isHorizontal?(t=[{x:r.x,y:r.y+o}],e=[{x:r.x+a,y:r.y+o}]):"left"===i?(t=[{x:r.x+a,y:r.y}],e=[{x:r.x+a,y:r.y+o}]):(t=[{x:r.x,y:r.y+o}],e=[{x:r.x,y:r.y}]),{basePointStart:t,basePointEnd:e}}},{key:"simplifyPoints",value:function(t){var e;return t.length>1e4?function(t,e,i){return t.length<=10||i?t:function(t,e){for(var i,n,r=t[0].x,a=t[0].y,o=[t[0]],s=1,l=t.length;s<l;s++)(i=t[s].x-r)*i+(n=t[s].y-a)*n>e&&(r=t[s].x,a=t[s].y,o.push(t[s]));return t[t.length-1].x===r&&t[t.length-1].y===a||o.push(t[t.length-1]),o}(t,void 0!==e?e*e:1)}(t,null!==(e=this.attribute.tolerance)&&void 0!==e?e:this._previewData.length/1e4,!1):t}},{key:"getPreviewLinePoints",value:function(){var t=this,e=this._previewData.map((function(e){return{x:t._previewPointsX&&t._previewPointsX(e),y:t._previewPointsY&&t._previewPointsY(e)}}));if(0===e.length)return e;e=this.simplifyPoints(e);var i=this.computeBasePoints(),n=i.basePointStart,r=i.basePointEnd;return n.concat(e).concat(r)}},{key:"getPreviewAreaPoints",value:function(){var t=this,e=this._previewData.map((function(e){return{x:t._previewPointsX&&t._previewPointsX(e),y:t._previewPointsY&&t._previewPointsY(e),x1:t._previewPointsX1&&t._previewPointsX1(e),y1:t._previewPointsY1&&t._previewPointsY1(e)}}));if(0===e.length)return e;e=this.simplifyPoints(e);var i=this.computeBasePoints(),n=i.basePointStart,r=i.basePointEnd;return n.concat(e).concat(r)}},{key:"setPreviewAttributes",value:function(t,e){this._previewGroup||(this._previewGroup=e.createOrUpdateChild("previewGroup",{pickable:!1},"group")),"line"===t?this._previewLine=this._previewGroup.createOrUpdateChild("previewLine",{},"line"):this._previewArea=this._previewGroup.createOrUpdateChild("previewArea",{curveType:"basis"},"area");var i=this.attribute.backgroundChartStyle,n=void 0===i?{}:i;"line"===t&&this._previewLine.setAttributes(Object.assign({points:this.getPreviewLinePoints(),curveType:"basis",pickable:!1},n.line)),"area"===t&&this._previewArea.setAttributes(Object.assign({points:this.getPreviewAreaPoints(),curveType:"basis",pickable:!1},n.area))}},{key:"setSelectedPreviewAttributes",value:function(t,e){this._selectedPreviewGroupClip||(this._selectedPreviewGroupClip=e.createOrUpdateChild("selectedPreviewGroupClip",{pickable:!1},"group"),this._selectedPreviewGroup=this._selectedPreviewGroupClip.createOrUpdateChild("selectedPreviewGroup",{},"group")),"line"===t?this._selectedPreviewLine=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewLine",{},"line"):this._selectedPreviewArea=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewArea",{curveType:"basis"},"area");var i=this.attribute.selectedBackgroundChartStyle,n=void 0===i?{}:i,r=this.state,a=r.start,o=r.end,s=this.getLayoutAttrFromConfig(),l=s.position,u=s.width,c=s.height;this._selectedPreviewGroupClip.setAttributes({x:this._isHorizontal?l.x+a*u:l.x,y:this._isHorizontal?l.y:l.y+a*c,width:this._isHorizontal?(o-a)*u:u,height:this._isHorizontal?c:(o-a)*c,clip:!0,pickable:!1}),this._selectedPreviewGroup.setAttributes({x:-(this._isHorizontal?l.x+a*u:l.x),y:-(this._isHorizontal?l.y:l.y+a*c),width:this._isHorizontal?(o-a)*u:u,height:this._isHorizontal?c:(o-a)*c,pickable:!1}),"line"===t&&this._selectedPreviewLine.setAttributes(Object.assign({points:this.getPreviewLinePoints(),curveType:"basis",pickable:!1},n.line)),"area"===t&&this._selectedPreviewArea.setAttributes(Object.assign({points:this.getPreviewAreaPoints(),curveType:"basis",pickable:!1},n.area))}},{key:"maybeAddLabel",value:function(t,e,i){var n=this.find((function(t){return t.name===i}),!0);return n?n.setAttributes(e):(n=new tE(e)).name=i,t.add(n),n}},{key:"setStartAndEnd",value:function(t,e){var i=this.attribute,n=i.start,r=i.end;U(t)&&U(e)&&(t!==this.state.start||e!==this.state.end)&&(this.state.start=t,this.state.end=e,n===this.state.start&&r===this.state.end||(this.setStateAttr(t,e,!0),this._dispatchEvent("change",{start:t,end:e,tag:this._activeTag})))}},{key:"setPreviewData",value:function(t){this._previewData=t}},{key:"setText",value:function(t,e){"start"===e?this._startText.setAttribute("text",t):this._endText.setAttribute("text",t)}},{key:"getStartValue",value:function(){return this._startValue}},{key:"getEndTextValue",value:function(){return this._endValue}},{key:"getMiddleHandlerSize",value:function(){var t,e,i,n,r=this.attribute.middleHandlerStyle,a=void 0===r?{}:r,o=null!==(e=null===(t=a.background)||void 0===t?void 0:t.size)&&void 0!==e?e:10,s=null!==(n=null===(i=a.icon)||void 0===i?void 0:i.size)&&void 0!==n?n:10;return Math.max.apply(Math,[o].concat(b(St(s))))}},{key:"setPreviewPointsX",value:function(t){V(t)&&(this._previewPointsX=t)}},{key:"setPreviewPointsY",value:function(t){V(t)&&(this._previewPointsY=t)}},{key:"setPreviewPointsX1",value:function(t){V(t)&&(this._previewPointsX1=t)}},{key:"setPreviewPointsY1",value:function(t){V(t)&&(this._previewPointsY1=t)}},{key:"setStatePointToData",value:function(t){V(t)&&(this._statePointToData=t)}},{key:"release",value:function(t){_(e,"release",this,3)([t]),("browser"===j_.env?j_:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearDragEvents()}}])}(Sx);function pD(){Kw(),QC(),FP()}dD.defaultAttributes=rD,function(t){t.start="start",t.startTop="startTop",t.startBottom="startBottom",t.insideStart="insideStart",t.insideStartTop="insideStartTop",t.insideStartBottom="insideStartBottom",t.middle="middle",t.insideMiddleTop="insideMiddleTop",t.insideMiddleBottom="insideMiddleBottom",t.end="end",t.endTop="endTop",t.endBottom="endBottom",t.insideEnd="insideEnd",t.insideEndTop="insideEndTop",t.insideEndBottom="insideEndBottom"}(lD||(lD={})),function(t){t.left="left",t.right="right",t.top="top",t.bottom="bottom",t.topLeft="topLeft",t.topRight="topRight",t.bottomLeft="bottomLeft",t.bottomRight="bottomRight",t.middle="middle",t.insideLeft="insideLeft",t.insideRight="insideRight",t.insideTop="insideTop",t.insideBottom="insideBottom",t.insideTopLeft="insideTopLeft",t.insideTopRight="insideTopRight",t.insideBottomLeft="insideBottomLeft",t.insideBottomRight="insideBottomRight"}(uD||(uD={})),function(t){t.arcInnerStart="arcInnerStart",t.arcInnerEnd="arcInnerEnd",t.arcInnerMiddle="arcInnerMiddle",t.arcOuterStart="arcOuterStart",t.arcOuterEnd="arcOuterEnd",t.arcOuterMiddle="arcOuterMiddle",t.center="center"}(cD||(cD={})),function(t){t.top="top",t.bottom="bottom",t.middle="middle",t.insideTop="insideTop",t.insideBottom="insideBottom",t.insideMiddle="insideMiddle"}(hD||(hD={}));var fD=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="marker",t._onHover=function(e){t._lastHover=WE(e,t._container,t._lastHover)},t._onUnHover=function(e){t._lastHover=GE(0,t._container,t._lastHover)},t._onClick=function(e){t._lastSelect=YE(e,t._container,t._lastSelect)},t}return h(e,t),o(e,[{key:"transAnimationConfig",value:function(){var t,e,i;if(!1!==this.attribute.animation){var n=W(this.attribute.animation)?this.attribute.animation:{};this._animationConfig={enter:gt({},this.defaultUpdateAnimation,n,null!==(t=this.attribute.animationEnter)&&void 0!==t?t:{}),exit:gt({},this.defaultExitAnimation,n,null!==(e=this.attribute.animationExit)&&void 0!==e?e:{}),update:gt({},this.defaultUpdateAnimation,n,null!==(i=this.attribute.animationUpdate)&&void 0!==i?i:{})}}}},{key:"setAttribute",value:function(t,i,n){_(e,"setAttribute",this,3)([t,i,n]),"visible"===t&&this.render()}},{key:"_bindEvent",value:function(){var t,e,i;if(this.attribute.interactive){var n=this.attribute,r=n.hover,a=n.select;r&&(null===(t=this._container)||void 0===t||t.addEventListener("pointermove",this._onHover),null===(e=this._container)||void 0===e||e.addEventListener("pointerout",this._onUnHover)),a&&(null===(i=this._container)||void 0===i||i.addEventListener("pointerdown",this._onClick))}}},{key:"_releaseEvent",value:function(){var t,e,i;null===(t=this._container)||void 0===t||t.removeEventListener("pointermove",this._onHover),null===(e=this._container)||void 0===e||e.removeEventListener("pointerout",this._onUnHover),null===(i=this._container)||void 0===i||i.removeEventListener("pointerdown",this._onClick)}},{key:"_initContainer",value:function(){var t,e,i,n=this.attribute,r=n.limitRect,a=void 0===r?{}:r;if(n.clipInRange){var o=kg.group(Object.assign(Object.assign({},a),{clip:!0,pickable:!1}));i=kg.group({x:-(null!==(t=a.x)&&void 0!==t?t:0),y:-(null!==(e=a.y)&&void 0!==e?e:0),pickable:!1}),o.add(i),this._containerClip=o,this.add(o)}else i=kg.group({x:0,y:0,pickable:!1}),this.add(i);i.name="marker-container",this._container=i}},{key:"_updateContainer",value:function(){var t,e,i=this.attribute,n=i.limitRect,r=void 0===n?{}:n,a=i.clipInRange;this._containerClip&&this._containerClip.setAttributes(Object.assign({},r)),this._container.setAttributes({x:a?-(null!==(t=r.x)&&void 0!==t?t:0):0,y:a?-(null!==(e=r.y)&&void 0!==e?e:0):0})}},{key:"render",value:function(){var t;this.transAnimationConfig(),this.setAttribute("pickable",!1);var e=null===(t=this.attribute.visible)||void 0===t||t;!1===this.attribute.interactive&&this.setAttribute("childrenPickable",!1),e&&this.isValidPoints()?this._container?(this._updateContainer(),this.updateMarker(),this.markerAnimate("update")):(this._initContainer(),this.initMarker(this._container),this.markerAnimate("enter")):(this.markerAnimate("exit"),this._container=null,this.removeAllChild(!0)),this._releaseEvent(),this._bindEvent()}},{key:"release",value:function(){this.markerAnimate("exit"),_(e,"release",this,3)([]),this._releaseEvent(),this._container=null}}])}(Sx);function vD(t,e,i,n){var r,a,o,s,l;if(t){null===(r=null==t?void 0:t.animates)||void 0===r||r.forEach((function(t){return t.stop("end")}));var u=null!==(o=null===(a=t.attribute)||void 0===a?void 0:a.fillOpacity)&&void 0!==o?o:1,c=null!==(l=null===(s=t.attribute)||void 0===s?void 0:s.strokeOpacity)&&void 0!==l?l:1;t.setAttributes({fillOpacity:0,strokeOpacity:0}),t.animate().wait(e).to({fillOpacity:u,strokeOpacity:c},i,n)}}function gD(t,e,i,n){t&&(vD(t.startSymbol,e,i,n),t.lines.forEach((function(t){return vD(t,e,i,n)})),vD(t.line,e,i,n),vD(t.endSymbol,e,i,n))}function yD(t,e,i,n){t&&(vD(t.getTextShape(),e,i,n),vD(t.getBgRect(),e,i,n))}function mD(t,e,i,n){var r,a,o,s;t&&(t.setAttributes({fillOpacity:null!==(a=null===(r=t.attribute)||void 0===r?void 0:r.fillOpacity)&&void 0!==a?a:1,strokeOpacity:null!==(s=null===(o=t.attribute)||void 0===o?void 0:o.strokeOpacity)&&void 0!==s?s:1}),t.animate().wait(e).to({fillOpacity:0,strokeOpacity:0},i,n))}function _D(t,e,i,n){t&&(mD(t.startSymbol,e,i,n),t.lines.forEach((function(t){return mD(t,e,i,n)})),mD(t.line,e,i,n),mD(t.endSymbol,e,i,n))}function bD(t,e,i,n){t&&(mD(t.getTextShape(),e,i,n),mD(t.getBgRect(),e,i,n))}function xD(t,e,i,n,r){var a=.1*i,o=.7*i,s=.1*i,l=.1*i;vD(t.startSymbol,n,a,r),t.lines.forEach((function(t){return t.setAttribute("clipRange",0)})),t.lines.forEach((function(e,i){var s=o/t.lines.length;e.animate().wait(n+a+i*s).to({clipRange:1},s,r)})),vD(t.endSymbol,n+a+o,s,r),St(e).forEach((function(t){var e=n+a+o+s;vD(t.getTextShape(),e,l,r),vD(t.getBgRect(),e,l,r)}))}function kD(t,e,i,n,r){gD(t,n,i,r),St(e).forEach((function(t){yD(t,n,i,r)}))}function SD(t,e,i,n,r){vD(t,n,i,r),St(e).forEach((function(t){yD(t,n,i,r)}))}function AD(t,e,i,n,r){vD(t,n,i,r),St(e).forEach((function(t){yD(t,n,i,r)}))}function MD(t,e,i,n,r,a){var o;gD(t,r,n,a),vD(e,r,n,a),(null===(o=i.getTextShape)||void 0===o?void 0:o.call(i))?yD(i,r,n,a):vD(i,r,n,a)}function TD(t,e,i,n,r,a){var o,s=.1*n,l=.65*n,u=.05*n,c=.1*n,h=.1*n;vD(t.startSymbol,r,s,a),t.lines.forEach((function(t){return t.setAttribute("clipRange",0)})),t.lines.forEach((function(e,i){var n=l/t.lines.length;e.animate().wait(r+s+i*n).to({clipRange:1},n,a)})),vD(e,r+s+l,u,a),vD(t.endSymbol,r+s+l+u,c,a),(null===(o=i.getTextShape)||void 0===o?void 0:o.call(i))?(vD(i.getTextShape(),r+s+l+u+c,h,a),vD(i.getBgRect(),r+s+l+c,h,a)):vD(i,r+s+l+c,h,a)}function wD(t,e,i,n){var r=i.enter,a=i.update,o=i.exit;if("enter"===n){var s=r.type,l=r.duration,u=r.delay,c=r.easing;"clipIn"===s?xD(t,e,l,u,c):"fadeIn"===s&&kD(t,e,l,u,c)}else if("update"===n){var h=a.type,d=a.duration,p=a.delay,f=a.easing;"clipIn"===h?xD(t,e,d,p,f):"fadeIn"===h&&kD(t,e,d,p,f)}else if("exit"===n){!function(t,e,i,n,r){_D(t,n,i,r),St(e).forEach((function(t){bD(t,n,i,r)}))}(t,e,o.duration,o.delay,o.easing)}}function CD(t,e,i,n){var r=i.enter,a=i.update,o=i.exit;if("enter"===n){var s=r.type,l=r.duration,u=r.delay,c=r.easing;"fadeIn"===s&&SD(t,e,l,u,c)}else if("update"===n){var h=a.type,d=a.duration,p=a.delay,f=a.easing;"fadeIn"===h&&SD(t,e,d,p,f)}else if("exit"===n){!function(t,e,i,n,r){mD(t,n,i,r),St(e).forEach((function(t){bD(t,n,i,r)}))}(t,e,o.duration,o.delay,o.easing)}}function ED(t,e,i,n){var r=i.enter,a=i.update,o=i.exit;if("enter"===n){var s=r.type,l=r.duration,u=r.delay,c=r.easing;"fadeIn"===s&&AD(t,e,l,u,c)}else if("update"===n){var h=a.type,d=a.duration,p=a.delay,f=a.easing;"fadeIn"===h&&AD(t,e,d,p,f)}else if("exit"===n){!function(t,e,i,n,r){mD(t,n,i,r),St(e).forEach((function(t){bD(t,n,i,r)}))}(t,e,o.duration,o.delay,o.easing)}}function PD(t,e,i,n){var r=m(t,2),a=r[0],o=r[1],s=i.enter,l=i.update,u=i.exit;if("enter"===n){var c=s.type,h=s.duration,d=s.delay,p=s.easing;"fadeIn"===c?MD(a,o,e,h,d,p):"callIn"===c&&TD(a,o,e,h,d,p)}else if("update"===n){var f=l.type,v=l.duration,g=l.delay,y=l.easing;"fadeIn"===f?MD(a,o,e,v,g,y):"callIn"===f&&TD(a,o,e,v,g,y)}else if("exit"===n){!function(t,e,i,n,r,a){var o;_D(t,r,n,a),mD(e,r,n,a),(null===(o=i.getTextShape)||void 0===o?void 0:o.call(i))?bD(i,r,n,a):mD(i,r,n,a)}(a,o,e,u.duration,u.delay,u.easing)}}var BD={type:"clipIn",duration:500,easing:"linear",delay:0},RD={type:"fadeIn",duration:500,easing:"linear",delay:0},LD={type:"callIn",duration:500,easing:"linear",delay:0},ID={type:"fadeOut",duration:500,easing:"linear",delay:0},DD=function(){return o((function t(){r(this,t)}),[{key:"getLabel",value:function(){return this._label}},{key:"_addMarkLabels",value:function(t,e,i){var n=this,r=this.attribute,a=r.label,o=r.state,s=St(null==o?void 0:o.label),l=St(null==o?void 0:o.labelBackground),u=St(a).map((function(r,a){var o,u,c=gt({},i,r),h=new tE(Object.assign(Object.assign({},c),{state:{panel:gt({},_C,null!==(o=l[a])&&void 0!==o?o:At(l)),text:gt({},_C,null!==(u=s[a])&&void 0!==u?u:At(s))}}));return h.name=e,t.add(h),n.setLabelPos(h,c),h}));this._label=1===St(u).length?u[0]:u}},{key:"_updateMarkLabels",value:function(t){var e=this,i=this.attribute,n=i.label,r=i.state,a=St(this._label),o=St(null==r?void 0:r.label),s=St(null==r?void 0:r.labelBackground);if(a.length){var l=St(n);a.forEach((function(i,n){var r,a,u=gt({},t,l[n]);i.setAttributes(Object.assign(Object.assign({dx:0,dy:0},u),{state:{panel:gt({},_C,null!==(r=s[n])&&void 0!==r?r:At(s)),text:gt({},_C,null!==(a=o[n])&&void 0!==a?a:At(o))}})),e.setLabelPos(i,u)}))}}}])}(),OD=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="markCommonLine",t.defaultUpdateAnimation=BD,t.defaultExitAnimation=ID,t}return h(e,t),o(e,[{key:"getLine",value:function(){return this._line}},{key:"setLabelPos",value:function(t,e){var i=this.attribute.limitRect,n=e.position,r=e.confine,a=e.autoRotate,o=this.getPointAttrByPosition(n,e),s=n.toString().toLocaleLowerCase().includes("start")?this._line.getStartAngle()||0:this._line.getEndAngle()||0;if(t.setAttributes(Object.assign(Object.assign({},o.position),{angle:a?this.getRotateByAngle(o.angle,e):0,textStyle:Object.assign(Object.assign({},this.getTextStyle(n,s,a)),e.textStyle)})),i&&r){var l=i.x,u=i.y;JC(t,{x1:l,y1:u,x2:l+i.width,y2:u+i.height})}}},{key:"initMarker",value:function(t){var e=this.createSegment();e.name="mark-common-line-line",this._line=e,t.add(e),this.addMarkLineLabels(t)}},{key:"updateMarker",value:function(){this.setLineAttributes(),this.updateMarkLineLabels()}}])}(fD);kt(OD,DD);var FD=.001,zD={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{position:lD.end,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},HD={postiveXAxis:{start:{textAlign:"left",textBaseline:"middle"},startTop:{textAlign:"left",textBaseline:"bottom"},startBottom:{textAlign:"left",textBaseline:"top"},insideStart:{textAlign:"right",textBaseline:"middle"},insideStartTop:{textAlign:"right",textBaseline:"bottom"},insideStartBottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"left",textBaseline:"middle"},endTop:{textAlign:"left",textBaseline:"bottom"},endBottom:{textAlign:"left",textBaseline:"top"},insideEnd:{textAlign:"right",textBaseline:"middle"},insideEndTop:{textAlign:"right",textBaseline:"bottom"},insideEndBottom:{textAlign:"right",textBaseline:"top"}},negativeXAxis:{start:{textAlign:"right",textBaseline:"middle"},startTop:{textAlign:"right",textBaseline:"bottom"},startBottom:{textAlign:"right",textBaseline:"top"},insideStart:{textAlign:"left",textBaseline:"middle"},insideStartTop:{textAlign:"left",textBaseline:"bottom"},insideStartBottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"right",textBaseline:"middle"},endTop:{textAlign:"right",textBaseline:"bottom"},endBottom:{textAlign:"right",textBaseline:"top"},insideEnd:{textAlign:"left",textBaseline:"middle"},insideEndTop:{textAlign:"left",textBaseline:"bottom"},insideEndBottom:{textAlign:"left",textBaseline:"top"}}},ND={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{autoRotate:!0,position:cD.arcOuterMiddle,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},VD={interactive:!0,label:{position:uD.right,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},jD={interactive:!0,label:{autoRotate:!0,position:cD.arcOuterMiddle,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},UD={arcInnerStart:{textAlign:"center",textBaseline:"bottom"},arcInnerEnd:{textAlign:"center",textBaseline:"bottom"},arcInnerMiddle:{textAlign:"center",textBaseline:"bottom"},arcOuterStart:{textAlign:"center",textBaseline:"top"},arcOuterEnd:{textAlign:"center",textBaseline:"top"},arcOuterMiddle:{textAlign:"center",textBaseline:"top"},center:{textAlign:"center",textBaseline:"middle"}},WD={left:{textAlign:"right",textBaseline:"middle"},insideLeft:{textAlign:"left",textBaseline:"middle"},right:{textAlign:"left",textBaseline:"middle"},insideRight:{textAlign:"right",textBaseline:"middle"},top:{textAlign:"center",textBaseline:"bottom"},insideTop:{textAlign:"center",textBaseline:"top"},bottom:{textAlign:"center",textBaseline:"top"},insideBottom:{textAlign:"center",textBaseline:"bottom"},middle:{textAlign:"center",textBaseline:"middle"},topLeft:{textAlign:"right",textBaseline:"top"},insideTopLeft:{textAlign:"left",textBaseline:"top"},topRight:{textAlign:"left",textBaseline:"top"},insideTopRight:{textAlign:"right",textBaseline:"top"},bottomLeft:{textAlign:"right",textBaseline:"bottom"},insideBottomLeft:{textAlign:"left",textBaseline:"bottom"},bottomRight:{textAlign:"left",textBaseline:"bottom"},insideBottomRight:{textAlign:"right",textBaseline:"bottom"}},GD={postiveXAxis:{top:{textAlign:"left",textBaseline:"bottom"},bottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"left",textBaseline:"middle"},insideTop:{textAlign:"right",textBaseline:"bottom"},insideBottom:{textAlign:"right",textBaseline:"top"},insideMiddle:{textAlign:"right",textBaseline:"middle"}},negativeXAxis:{top:{textAlign:"right",textBaseline:"bottom"},bottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"right",textBaseline:"middle"},insideTop:{textAlign:"left",textBaseline:"bottom"},insideBottom:{textAlign:"left",textBaseline:"top"},insideMiddle:{textAlign:"left",textBaseline:"middle"}}};function YD(){XD._animate=wD}pD(),AE(),FP();var XD=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="markLine",a}return h(e,t),o(e,[{key:"markerAnimate",value:function(t){e._animate&&this._animationConfig&&e._animate(this._line,this._label,this._animationConfig,t)}},{key:"getPointAttrByPosition",value:function(t,e){var i,n=e.refX,r=void 0===n?0:n,a=e.refY,o=void 0===a?0:a,s=this._line.getMainSegmentPoints(),l=null!==(i=this._line.getEndAngle())&&void 0!==i?i:0,u=r*Math.cos(l)+o*Math.cos(l-Math.PI/2),c=r*Math.sin(l)+o*Math.sin(l-Math.PI/2);return t.includes("start")||t.includes("Start")?{position:{x:s[0].x+u,y:s[0].y+c},angle:l}:t.includes("middle")||t.includes("Middle")?{position:{x:(s[0].x+s[s.length-1].x)/2+u,y:(s[0].y+s[s.length-1].y)/2+c},angle:l}:{position:{x:s[s.length-1].x+u,y:s[s.length-1].y+c},angle:l}}},{key:"getRotateByAngle",value:function(t,e){var i;return(BC(t)?t:t-Math.PI)+(null!==(i=e.refAngle)&&void 0!==i?i:0)}},{key:"getTextStyle",value:function(t,e,i){return RC(Math.abs(e),Math.PI/2,FD)||RC(Math.abs(e),3*Math.PI/2,FD)?LC(i,e,t):BC(e)?HD.postiveXAxis[t]:HD.negativeXAxis[t]}},{key:"createSegment",value:function(){var t=this.attribute,e=t.points,i=t.startSymbol,n=t.endSymbol,r=t.lineStyle,a=t.mainSegmentIndex,o=t.multiSegment,s=t.state;return new TE({points:e,startSymbol:i,endSymbol:n,lineStyle:r,mainSegmentIndex:a,multiSegment:o,pickable:!1,state:{line:gt({},_C,null==s?void 0:s.line),startSymbol:gt({},_C,null==s?void 0:s.lineStartSymbol),endSymbol:gt({},_C,null==s?void 0:s.lineEndSymbol)}})}},{key:"setLineAttributes",value:function(){var t=this.attribute,e=t.points,i=t.startSymbol,n=t.endSymbol,r=t.lineStyle,a=t.mainSegmentIndex,o=t.multiSegment,s=t.state;this._line&&this._line.setAttributes({points:e,startSymbol:i,endSymbol:n,lineStyle:r,mainSegmentIndex:a,multiSegment:o,state:{line:gt({},_C,null==s?void 0:s.line),startSymbol:gt({},_C,null==s?void 0:s.lineStartSymbol),endSymbol:gt({},_C,null==s?void 0:s.lineEndSymbol)}})}},{key:"isValidPoints",value:function(){var t=this.attribute.points;if(!t||t.length<2)return!1;var e=!0;return t.forEach((function(t){if(t.length)t.forEach((function(t){et(t.x)&&et(t.y)||(e=!1)}));else if(!et(t.x)||!et(t.y))return void(e=!1)})),e}},{key:"addMarkLineLabels",value:function(t){this._addMarkLabels(t,"mark-common-line-label",e.defaultAttributes.label)}},{key:"updateMarkLineLabels",value:function(){this._updateMarkLabels(e.defaultAttributes.label)}}])}(OD);function KD(){qD._animate=CD}XD.defaultAttributes=zD,pD(),iC(),FP();var qD=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="markArea",a.defaultUpdateAnimation=RD,a.defaultExitAnimation=ID,a}return h(e,t),o(e,[{key:"markerAnimate",value:function(t){e._animate&&this._animationConfig&&e._animate(this._area,this._label,this._animationConfig,t)}},{key:"getArea",value:function(){return this._area}},{key:"getPointAttrByPosition",value:function(t){var e=this._area.AABBBounds,i=e.x1,n=e.x2,r=e.y1,a=e.y2,o={x:(i+n)/2,y:(r+a)/2};return(t.includes("left")||t.includes("Left"))&&(o.x=i),(t.includes("right")||t.includes("Right"))&&(o.x=n),(t.includes("top")||t.includes("Top"))&&(o.y=r),(t.includes("bottom")||t.includes("Bottom"))&&(o.y=a),o}},{key:"setLabelPos",value:function(t,e){var i;if(this._area){var n=null!==(i=e.position)&&void 0!==i?i:"middle",r=this.getPointAttrByPosition(n);if(t.setAttributes(Object.assign(Object.assign({},r),{textStyle:Object.assign(Object.assign({},WD[n]),e.textStyle)})),this.attribute.limitRect&&e.confine){var a=this.attribute.limitRect,o=a.x,s=a.y;JC(t,{x1:o,y1:s,x2:o+a.width,y2:s+a.height})}}}},{key:"initMarker",value:function(t){var i=this.attribute,n=i.points,r=i.areaStyle,a=i.state,o=kg.polygon(Object.assign({points:n},r));o.states=gt({},_C,null==a?void 0:a.area),o.name="mark-area-polygon",this._area=o,t.add(o),this._addMarkLabels(t,"mark-area-label",e.defaultAttributes.label)}},{key:"updateMarker",value:function(){var t=this.attribute,i=t.points,n=t.areaStyle,r=t.state;this._area&&(this._area.setAttributes(Object.assign({points:i},n)),this._area.states=gt({},_C,null==r?void 0:r.area)),this._updateMarkLabels(e.defaultAttributes.label)}},{key:"isValidPoints",value:function(){var t=this.attribute.points;if(!t||t.length<3)return!1;var e=!0;return t.forEach((function(t){et(t.x)&&et(t.y)||(e=!1)})),e}}])}(fD);qD.defaultAttributes=VD,kt(qD,DD),pD(),ME(),FP();var ZD=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="markArcLine",a}return h(e,t),o(e,[{key:"markerAnimate",value:function(t){e._animate&&this._animationConfig&&e._animate(this._line,this._label,this._animationConfig,t)}},{key:"getPointAttrByPosition",value:function(t,e){var i,n=this.attribute,r=n.center,a=n.radius,o=n.startAngle,s=n.endAngle,l=e.refX,u=void 0===l?0:l,c=e.refY,h=void 0===c?0:c;switch(t){case cD.arcInnerStart:i=o;case cD.arcOuterStart:i=o;break;case cD.arcInnerEnd:i=s;case cD.arcOuterEnd:i=s;break;case cD.center:case cD.arcInnerMiddle:case cD.arcOuterMiddle:default:i=(o+s)/2}return{position:{x:r.x+(a+h)*Math.cos(i)+u*Math.cos(i-Math.PI/2),y:r.y+(a+h)*Math.sin(i)+u*Math.sin(i-Math.PI/2)},angle:i}}},{key:"getTextStyle",value:function(t){return UD[t]}},{key:"getRotateByAngle",value:function(t,e){var i;return t-Math.PI/2+(null!==(i=e.refAngle)&&void 0!==i?i:0)}},{key:"createSegment",value:function(){var t=this.attribute,e=t.center,i=t.radius,n=t.startAngle,r=t.endAngle,a=t.startSymbol,o=t.endSymbol,s=t.lineStyle,l=t.state;return new EE({center:e,radius:i,startAngle:n,endAngle:r,startSymbol:a,endSymbol:o,lineStyle:s,state:{line:gt({},_C,null==l?void 0:l.line),startSymbol:gt({},_C,null==l?void 0:l.lineStartSymbol),endSymbol:gt({},_C,null==l?void 0:l.lineEndSymbol)}})}},{key:"setLineAttributes",value:function(){var t=this.attribute,e=t.center,i=t.radius,n=t.startAngle,r=t.endAngle,a=t.startSymbol,o=t.endSymbol,s=t.lineStyle,l=t.state;this._line&&this._line.setAttributes({center:e,radius:i,startAngle:n,endAngle:r,startSymbol:a,endSymbol:o,lineStyle:s,state:{line:gt({},_C,null==l?void 0:l.line),startSymbol:gt({},_C,null==l?void 0:l.lineStartSymbol),endSymbol:gt({},_C,null==l?void 0:l.lineEndSymbol)}})}},{key:"isValidPoints",value:function(){return!0}},{key:"addMarkLineLabels",value:function(t){this._addMarkLabels(t,"mark-common-line-label",e.defaultAttributes.label)}},{key:"updateMarkLineLabels",value:function(){this._updateMarkLabels(e.defaultAttributes.label)}}])}(OD);ZD.defaultAttributes=ND,pD(),Nw(),FP();var JD=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="markArcArea",a.defaultUpdateAnimation=RD,a.defaultExitAnimation=ID,a}return h(e,t),o(e,[{key:"markerAnimate",value:function(t){e._animate&&this._animationConfig&&e._animate(this._area,this._label,this._animationConfig,t)}},{key:"getArea",value:function(){return this._area}},{key:"getPointAttrByPosition",value:function(t,e){var i,n,r=this.attribute,a=r.center,o=r.innerRadius,s=r.outerRadius,l=r.startAngle,u=r.endAngle,c=e.refX,h=void 0===c?0:c,d=e.refY,p=void 0===d?0:d;switch(t){case cD.center:i=(o+s)/2,n=(l+u)/2;break;case cD.arcInnerStart:i=o,n=l;break;case cD.arcOuterStart:i=s,n=l;break;case cD.arcInnerEnd:i=o,n=u;break;case cD.arcOuterEnd:i=s,n=u;break;case cD.arcInnerMiddle:i=o,n=(l+u)/2;break;case cD.arcOuterMiddle:i=s,n=(l+u)/2;break;default:i=o,n=(l+u)/2}return{position:{x:a.x+(i+p)*Math.cos(n)+h*Math.cos(n-Math.PI/2),y:a.y+(i+p)*Math.sin(n)+h*Math.sin(n-Math.PI/2)},angle:n}}},{key:"setLabelPos",value:function(t,e){var i;if(this._area){var n=e.position,r=void 0===n?"arcInnerMiddle":n,a=e.autoRotate,o=this.getPointAttrByPosition(r,e);if(t.setAttributes(Object.assign(Object.assign({},o.position),{angle:a?o.angle-Math.PI/2+(null!==(i=e.refAngle)&&void 0!==i?i:0):0,textStyle:Object.assign(Object.assign({},UD[r]),e.textStyle)})),this.attribute.limitRect&&e.confine){var s=this.attribute.limitRect,l=s.x,u=s.y;JC(t,{x1:l,y1:u,x2:l+s.width,y2:u+s.height})}}}},{key:"initMarker",value:function(t){var i=this.attribute,n=i.center,r=i.innerRadius,a=i.outerRadius,o=i.startAngle,s=i.endAngle,l=i.areaStyle,u=i.state,c=kg.arc(Object.assign({x:n.x,y:n.y,innerRadius:r,outerRadius:a,startAngle:o,endAngle:s},l));c.states=gt({},_C,null==u?void 0:u.area),c.name="polar-mark-area-area",this._area=c,t.add(c),this._addMarkLabels(t,"mark-area-label",e.defaultAttributes.label)}},{key:"updateMarker",value:function(){var t=this.attribute,i=t.center,n=t.innerRadius,r=t.outerRadius,a=t.startAngle,o=t.endAngle,s=t.areaStyle;t.label;var l=t.state;this._area&&(this._area.setAttributes(Object.assign({x:i.x,y:i.y,innerRadius:n,outerRadius:r,startAngle:a,endAngle:o},s)),this._area.states=gt({},_C,null==l?void 0:l.area)),this._updateMarkLabels(e.defaultAttributes.label)}},{key:"isValidPoints",value:function(){return!0}}])}(fD);function QD(){$D._animate=PD}JD.defaultAttributes=jD,kt(JD,DD),pD(),AE(),ME(),cC(),Zw(),Qw(),FP();var $D=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="markPoint",a.defaultUpdateAnimation=LD,a.defaultExitAnimation=ID,a._isArcLine=!1,a._isStraightLine=!1,a}return h(e,t),o(e,[{key:"markerAnimate",value:function(t){e._animate&&this._animationConfig&&e._animate([this._line,this._decorativeLine],this._item,this._animationConfig,t)}},{key:"setLabelPos",value:function(){}},{key:"getTextAlignAttr",value:function(t,e,i,n,r){return RC(Math.abs(n),Math.PI/2,FD)||RC(Math.abs(n),3*Math.PI/2,FD)?LC(t,n,r):BC(n)?GD.postiveXAxis[r]:GD.negativeXAxis[r]}},{key:"setItemAttributes",value:function(t,e,i,n,r){var a,o;if(t){var s=e.autoRotate,l=void 0===s||s,u=e.refX,c=void 0===u?0:u,h=e.refY,d=void 0===h?0:h,p=e.refAngle,f=void 0===p?0:p,v=e.style,g=e.position,y=void 0===g?hD.middle:g,m=this.attribute.state,_=(null===(a=this._line)||void 0===a?void 0:a.getEndAngle())||0,b=c*Math.cos(_)+d*Math.cos(_-Math.PI/2),x=c*Math.sin(_)+d*Math.sin(_-Math.PI/2);if("text"===r){var k=n.x-i.x,S=n.y-i.y;t.setAttributes(Object.assign(Object.assign({},v),{textStyle:Object.assign(Object.assign({},this.getTextAlignAttr(l,k,S,_,null!==(o=e.position)&&void 0!==o?o:"end")),v.textStyle),state:{panel:gt({},_C,null==m?void 0:m.textBackground),text:gt({},_C,null==m?void 0:m.itemContent)}}))}else("richText"===r||"image"===r)&&(t.setAttributes({dx:this.getItemDx(t,y,v)+(v.dx||0),dy:this.getItemDy(t,y,v)+(v.dy||0)}),t.states=gt({},_C,null==m?void 0:m.itemContent));var A=BC(_)?_:_-Math.PI;t.setAttributes({x:n.x+(b||0),y:n.y+(x||0),angle:l&&A+f})}}},{key:"getItemDx",value:function(t,e,i){var n,r,a=null!==(r=null===(n=null==t?void 0:t.AABBBounds)||void 0===n?void 0:n.width())&&void 0!==r?r:(null==i?void 0:i.width)||0;return e.includes("inside")?-a:0}},{key:"getItemDy",value:function(t,e,i){var n,r,a=null!==(r=null===(n=null==t?void 0:t.AABBBounds)||void 0===n?void 0:n.height())&&void 0!==r?r:(null==i?void 0:i.height)||0;return e.includes("top")||e.includes("Top")?-a:e.includes("middle")||e.includes("Middle")?-a/2:0}},{key:"initItem",value:function(t,e,i){var n,r=this.attribute.state,a=t.type,o=void 0===a?"text":a,s=t.style,l=t.renderCustomCallback;return"symbol"===o?(n=kg.symbol(Object.assign(Object.assign({},i),s))).states=gt({},_C,null==r?void 0:r.itemContent):"text"===o?n=new tE(Object.assign(Object.assign({},i),{state:{panel:gt({},_C,null==r?void 0:r.textBackground),text:gt({},_C,null==r?void 0:r.itemContent)}})):"richText"===o?(n=kg.richtext(Object.assign(Object.assign({},i),s))).states=gt({},_C,null==r?void 0:r.itemContent):"image"===o?(n=kg.image(Object.assign(Object.assign({},i),s))).states=gt({},_C,null==r?void 0:r.itemContent):"custom"===o&&l&&((n=l()).states=gt({},_C,null==r?void 0:r.itemContent)),n.name="mark-point-".concat(o),this.setItemAttributes(n,t,e,i,o),n}},{key:"getItemLineAttr",value:function(t,e,i){var n=[],r={x:0,y:0},a=0,o=0,s=0,l=t.type,u=void 0===l?"type-s":l,c=t.arcRatio,h=void 0===c?.8:c,d=i.x-e.x,p=i.y-e.y;if(this._isStraightLine=RC(d,0,FD)||RC(p,0,FD),this._isArcLine){var f=this.attribute.position,v=f.x,g=f.y,y=i.x,m=i.y,_=(v+y)/2,b=_+h*(m>g?-1:1)*_,x=(g===m?0:-(v-y)/(g-m))*(b-_)+(g+m)/2;o=qC(g-x,v-b),s=qC(m-x,y-b),r={x:b,y:x};var k=Math.sqrt((b-v)*(b-v)+(x-g)*(x-g)),S=this.attribute.targetSymbol.style.size/2;o+=2*Math.acos(Math.sqrt(1-S*S/(4*k*k))),h>0?s<o&&(s+=2*Math.PI):o<s&&(o+=2*Math.PI),a=Math.sqrt((b-v)*(b-v)+(x-g)*(x-g))}else n="type-do"!==u||this._isStraightLine?"type-po"!==u||this._isStraightLine?"type-op"!==u||this._isStraightLine?[e,i]:[e,{x:e.x,y:i.y},i]:[e,{x:i.x,y:e.y},i]:[e,{x:(e.x+i.x)/2,y:i.y},i];return n=function(t){for(var e=[t[0]],i=1;i<t.length;i++)t[i].x===t[i-1].x&&t[i].y===t[i-1].y||e.push(t[i]);return e}(n),{points:n,center:r,radius:a,startAngle:o,endAngle:s}}},{key:"reDrawLine",value:function(t,e){this._line.release();var i=t.startSymbol,n=t.endSymbol,r=t.lineStyle;t.type;var a=this.attribute.state,o=this._isArcLine?EE:TE;this._container.removeChild(this._line),this._line=new o(Object.assign(Object.assign({},e),{pickable:!1,startSymbol:i,endSymbol:n,lineStyle:r,visible:t.visible,state:{line:gt({},_C,null==a?void 0:a.line),startSymbol:gt({},_C,null==a?void 0:a.lineStartSymbol),endSymbol:gt({},_C,null==a?void 0:a.lineEndSymbol)}})),this._container.add(this._line)}},{key:"setItemLineAttr",value:function(t,e,i){if(this._line){var n=t.startSymbol,r=t.endSymbol,a=t.lineStyle;t.type;var o=this.attribute.state,s=this.getItemLineAttr(t,e,i);this._isArcLine&&"arc-segment"===this._line.key||!this._isArcLine&&"segment"===this._line.key?this._line.setAttributes(Object.assign(Object.assign({},s),{startSymbol:n,endSymbol:r,lineStyle:a,visible:t.visible,state:{line:gt({},_C,null==o?void 0:o.line),startSymbol:gt({},_C,null==o?void 0:o.lineStartSymbol),endSymbol:gt({},_C,null==o?void 0:o.lineEndSymbol)}})):this.reDrawLine(t,s)}}},{key:"getDecorativeLineAttr",value:function(t){var e,i=(null===(e=null==t?void 0:t.decorativeLine)||void 0===e?void 0:e.length)||10,n=this._line.getEndAngle()||0;return{startPointOffsetX:i/2*Math.cos(n-Math.PI/2),startPointOffsetY:i/2*Math.sin(n-Math.PI/2),endPointOffsetX:-i/2*Math.cos(n-Math.PI/2),endPointOffsetY:-i/2*Math.sin(n-Math.PI/2)}}},{key:"setDecorativeLineAttr",value:function(t,e,i){var n;if(this._decorativeLine){var r=t.lineStyle,a=this.getDecorativeLineAttr(t),o=a.startPointOffsetX,s=a.startPointOffsetY,l=a.endPointOffsetX,u=a.endPointOffsetY;this._decorativeLine.setAttributes(Object.assign(Object.assign({points:[{x:e.x+o,y:e.y+s},{x:e.x+l,y:e.y+u}]},r),{visible:i})),this._decorativeLine.states=gt({},_C,null===(n=this.attribute.state)||void 0===n?void 0:n.line)}}},{key:"setTargetItemAttributes",value:function(t,e){var i,n;this._targetItem&&(this._targetItem.setAttributes(Object.assign({x:e.x,y:e.y,visible:null!==(i=t.visible)&&void 0!==i&&i,size:t.size},t.style)),this._targetItem.states=gt({},_C,null===(n=this.attribute.state)||void 0===n?void 0:n.targetItem))}},{key:"setAllOfItemsAttr",value:function(t,e){var i,n=this.attribute,r=n.position,a=n.itemLine,o=void 0===a?{}:a,s=n.itemContent,l=void 0===s?{}:s,u=n.limitRect,c=n.targetSymbol,h=l.type,d=void 0===h?"text":h,p=l.confine;if(u&&p){var f=u.x,v=u.y,g=u.width,y=u.height,m=ZC(this._item,{x1:f,y1:v,x2:f+g,y2:v+y}),_=m.dx,b=m.dy;e.x=e.x+_,e.y=e.y+b}this.setTargetItemAttributes(c,r),this.setItemLineAttr(o,t,e),this.setItemAttributes(this._item,l,t,e,d),this.setDecorativeLineAttr(o,e,null===(i=o.decorativeLine)||void 0===i?void 0:i.visible)}},{key:"computeNewPositionAfterTargetItem",value:function(t){var e,i,n,r=this.attribute,a=r.itemContent,o=void 0===a?{}:a,s=r.targetSymbol,l=r.itemLine,u=o.offsetX,c=void 0===u?0:u,h=o.offsetY,d=void 0===h?0:h,p=s.offset,f=void 0===p?0:p,v=s.style,g=s.visible,y=void 0!==g&&g,m=s.size,_=y?null!==(i=null!==(e=v.size)&&void 0!==e?e:m)&&void 0!==i?i:20:0;return n="type-do"===l.type?qC(d,c/2):"type-po"===l.type?qC(0,c):"type-op"===l.type?qC(d,0):qC(d,c),{newPosition:{x:t.x+(_/2+f)*Math.cos(n),y:t.y+(_/2+f)*Math.sin(n)},newItemPosition:{x:t.x+(_/2+f)*Math.cos(n)+c,y:t.y+(_/2+f)*Math.sin(n)+d}}}},{key:"initMarker",value:function(t){var e=this.attribute,i=e.position,n=e.itemContent,r=void 0===n?{}:n,a=e.itemLine,o=a.type,s=void 0===o?"type-s":o,l=a.arcRatio,u=void 0===l?.8:l,c=r.offsetX,h=void 0===c?0:c,d=r.offsetY,p=void 0===d?0:d;this._isStraightLine=RC(h,0,FD)||RC(p,0,FD),this._isArcLine="type-arc"===s&&0!==u&&!this._isStraightLine;var f=this.computeNewPositionAfterTargetItem(i),v=f.newPosition,g=f.newItemPosition,y=new(this._isArcLine?EE:TE)({points:[],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0});y.name="mark-point-line",this._line=y,t.add(y);var m=kg.line({points:[]});m.name="mark-point-decorativeLine",this._decorativeLine=m,t.add(m);var _=kg.symbol({});_.name="mark-point-targetItem",this._targetItem=_,t.add(this._targetItem);var b=this.initItem(r,v,g);this._item=b,t.add(b),this.setAllOfItemsAttr(v,g)}},{key:"updateMarker",value:function(){var t=this.attribute,e=t.position,i=t.itemContent,n=void 0===i?{}:i,r=t.itemLine,a=n.type,o=void 0===a?"text":a,s=r.type,l=void 0===s?"type-s":s,u=r.arcRatio,c=void 0===u?.8:u,h=n.offsetX,d=void 0===h?0:h,p=n.offsetY,f=void 0===p?0:p;this._isStraightLine=RC(d,0,FD)||RC(f,0,FD);var v="type-arc"===l&&0!==c&&!this._isStraightLine,g=this.computeNewPositionAfterTargetItem(e),y=g.newPosition,m=g.newItemPosition;v!==this._isArcLine?(this._isArcLine=v,this.reDrawLine(r,{points:[{x:0,y:0}],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0})):this._isArcLine=v,this.setItemAttributes(this._item,n,y,m,o),this.setAllOfItemsAttr(y,m)}},{key:"isValidPoints",value:function(){var t=this.attribute.position;return!(!et(t.x)||!et(t.y))}}])}(fD);function tO(){Kw(),cC(),dC()}$D.defaultAttributes={interactive:!0,targetSymbol:{visible:!1,offset:0,style:{symbolType:"circle",size:20,fill:!1,stroke:"rgba(46, 47, 50)"}},itemLine:{visible:!0,decorativeLine:{visible:!1,length:30},startSymbol:{visible:!0,clip:!0,symbolType:"circle",size:20,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},endSymbol:{visible:!1,clip:!0,symbolType:"triangle",size:12,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},lineStyle:{stroke:"#000",lineWidth:1}},itemContent:{type:"text",position:"middle",refX:10}};var eO={space:8,style:{fill:"rgb(47, 69, 84)",cursor:"pointer",size:15},state:{disable:{fill:"rgb(170, 170, 170)",cursor:"not-allowed"},hover:{}}};tO();var iO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="pager",a._current=1,a._onHover=function(t){var e=t.target;e.hasState("disable")||e.addState("hover")},a._onUnHover=function(t){t.target.removeState("hover")},a._onClick=function(t){var e=t.target;if("preHandler"===e.name){if(1===a._current)return;a._current-=1,1===a._current?e.addState("disable"):e.removeState("disable"),a._dispatchEvent("toPrev",{current:a._current,total:a._total,direction:"pre",event:t})}if("nextHandler"===e.name){if(a._current===a._total)return;a._current+=1,a._current===a._total?e.addState("disable"):e.removeState("disable"),a._dispatchEvent("toNext",{current:a._current,total:a._total,direction:"next",event:t})}a._current>1&&a.preHandler.removeState("disable"),a._current<a._total&&a.nextHandler.removeState("disable"),a.text.setAttribute("text",a._getPageText(a._current))},a}return h(e,t),o(e,[{key:"getCurrent",value:function(){return this._current}},{key:"render",value:function(){var t,e,i;this._reset();var n=this.attribute,r=n.layout,a=void 0===r?"horizontal":r,o=n.handler,s=void 0===o?eO:o,l=n.total,u=n.defaultCurrent,c=void 0===u?1:u,h=n.textStyle,d=n.padding,p=void 0===d?0:d;this._current=c;var f=Di(p),v="horizontal"===a,g=kg.group({x:0,y:0}),y=s.style||{},m=y.size||15,_=null!==(t=s.space)&&void 0!==t?t:8,b=s.state||{},x=s.preShape,k=s.nextShape;x||(x=v?"triangleLeft":"triangleUp"),k||(k=v?"triangleRight":"triangleDown");var S=kg.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},y),{x:0,y:0,symbolType:x,size:m}));S.states=b,S.name="preHandler",this.preHandler=S,g.add(S);var A=WC(this._getPageText(l),Object.assign({textAlign:"center",textBaseline:"middle"},h),null===(i=null===(e=this.stage)||void 0===e?void 0:e.getTheme())||void 0===i?void 0:i.text),M=A.width,T=A.height,w=Q(m)?m:m[0],C=Q(m)?m:m[1],E=kg.text(Object.assign({x:v?w/2+_+M/2:0,y:v?0:C/2+_+T/2,text:this._getPageText(c),textAlign:"center",textBaseline:"middle",lineHeight:null==h?void 0:h.fontSize},h));this.text=E,g.add(E);var P=kg.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},y),{x:v?w+2*_+M:0,y:v?0:C+2*_+T,symbolType:k,size:m}));P.name="nextHandler",P.states=b,this.nextHandler=P,g.add(P),1===this._total?(S.addState("disable"),P.addState("disable")):1===this._current?S.addState("disable"):this._current===l&&P.addState("disable");var B=g.AABBBounds,R=B.width(),L=B.height();g.translateTo(0-B.x1+f[3],0-B.y1+f[0]),this.add(g),this.attribute.width=R+f[1]+f[3],this.attribute.height=L+f[0]+f[2],this._bindEvents()}},{key:"_bindEvents",value:function(){this.attribute.disableTriggerEvent||(this.preHandler&&(this.preHandler.addEventListener("pointerenter",this._onHover),this.preHandler.addEventListener("pointerleave",this._onUnHover),this.preHandler.addEventListener("pointerdown",this._onClick)),this.nextHandler&&(this.nextHandler.addEventListener("pointerenter",this._onHover),this.nextHandler.addEventListener("pointerleave",this._onUnHover),this.nextHandler.addEventListener("pointerdown",this._onClick)))}},{key:"_reset",value:function(){this.removeAllChild(!0),this._current=1,this._total=this.attribute.total,this.preHandler=this.nextHandler=this.text=null}},{key:"_getPageText",value:function(t){var e=this.attribute.pageFormatter;return e?V(e)?e(t,this._total):"".concat(e).replace("{current}","".concat(t)).replace("{total}","".concat(this._total)):"".concat(t,"/").concat(this._total)}},{key:"setTotal",value:function(t){t!==this.attribute.total&&(this._total=t,1!==this._current&&this._current<=t?this.setAttributes({total:t,defaultCurrent:this._current}):this.setAttribute("total",t))}}])}(Sx);iO.defaultAttributes={handler:eO,textStyle:{fill:"rgb(51, 51, 51)",fontSize:12}};var nO,rO,aO;!function(t){t.selected="selected",t.unSelected="unSelected",t.selectedHover="selectedHover",t.unSelectedHover="unSelectedHover",t.focus="focus"}(nO||(nO={})),function(t){t.legendItemHover="legendItemHover",t.legendItemUnHover="legendItemUnHover",t.legendItemClick="legendItemClick",t.legendItemAttributeUpdate="legendItemAttributeUpdate"}(rO||(rO={})),function(t){t.innerView="innerView",t.title="legendTitle",t.item="legendItem",t.itemShape="legendItemShape",t.itemLabel="legendItemLabel",t.itemValue="legendItemValue",t.focus="legendItemFocus"}(aO||(aO={}));var oO=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="legend",t._title=null,t}return h(e,t),o(e,[{key:"render",value:function(){this.removeAllChild(!0);var t=this.attribute,e=t.interactive,i=void 0===e||e,n=t.title,r=t.padding,a=void 0===r?0:r;this._parsedPadding=Di(a);var o=kg.group({x:this._parsedPadding[3],y:this._parsedPadding[0],pickable:i,childrenPickable:i});o.name=aO.innerView,this.add(o),this._innerView=o,(null==n?void 0:n.visible)&&this._renderTitle(n),this._renderContent(),this._adjustLayout(),i&&this._bindEvents();var s=this._innerView.AABBBounds;this.attribute.width=s.width()+this._parsedPadding[1]+this._parsedPadding[3],this.attribute.height=s.height()+this._parsedPadding[0]+this._parsedPadding[2]}},{key:"_renderTitle",value:function(t){var e=t.text,i=void 0===e?"":e,n=t.textStyle,r=t.padding,a=void 0===r?0:r,o=t.background,s=t.minWidth,l=t.maxWidth,u=t.shape,c={x:0,y:0,text:i,textStyle:n,padding:Di(a),minWidth:s,maxWidth:l};u&&u.visible&&(c.shape=Object.assign({visible:!0},u.style),U(u.space)&&(c.space=u.space)),o&&o.visible&&(c.panel=Object.assign({visible:!0},o.style));var h=new tE(c);h.name=aO.title,this._title=h,this._innerView.add(h)}},{key:"_adjustLayout",value:function(){var t;if(this._title){var e=this._innerView.AABBBounds.width(),i=this._title.AABBBounds.width(),n=null===(t=this.attribute.title)||void 0===t?void 0:t.align;"center"===n?this._title.setAttribute("x",(e-i)/2):"end"===n&&this._title.setAttribute("x",e-i)}}}])}(Sx);function sO(){Kw(),dC(),rC(),cC()}function lO(){Kw(),QC()}var uO=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},cO=l(l(l(l(l({},nO.focus,{}),nO.selected,{}),nO.selectedHover,{}),nO.unSelected,{}),nO.unSelectedHover,{});lO(),tO(),fC();var hO,dO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="discreteLegend",a._itemsContainer=null,a._itemHeightByUser=void 0,a._itemHeight=0,a._itemMaxWidth=0,a._contentMaxHeight=0,a._onHover=function(t){var e=t.target;if(e&&e.name&&e.name.startsWith(aO.item)){var i=e.delegate;if(a._lastActiveItem){if(a._lastActiveItem.id===i.id)return;a._unHover(a._lastActiveItem,t)}a._hover(i,t)}else a._lastActiveItem&&(a._unHover(a._lastActiveItem,t),a._lastActiveItem=null)},a._onUnHover=function(t){a._lastActiveItem&&(a._unHover(a._lastActiveItem,t),a._lastActiveItem=null)},a._onClick=function(t){var e,i,n,r,o=t.target;if(o&&o.name&&o.name.startsWith(aO.item)){var s=o.delegate,l=a.attribute.selectMode,u=void 0===l?"multiple":l;if(o.name===aO.focus||"focus"===u){var c=s.hasState(nO.focus);s.toggleState(nO.focus),c?null===(e=a._itemsContainer)||void 0===e||e.getChildren().forEach((function(e){a._removeLegendItemState(e,[nO.unSelected,nO.unSelectedHover,nO.focus],t),a._setLegendItemState(e,nO.selected,t)})):(a._setLegendItemState(s,nO.selected,t),a._removeLegendItemState(s,[nO.unSelected,nO.unSelectedHover],t),null===(i=a._itemsContainer)||void 0===i||i.getChildren().forEach((function(e){s!==e&&(a._removeLegendItemState(e,[nO.selected,nO.selectedHover,nO.focus],t),a._setLegendItemState(e,nO.unSelected,t))})))}else{null===(n=a._itemsContainer)||void 0===n||n.getChildren().forEach((function(t){t.removeState(nO.focus)}));var h=a.attribute.allowAllCanceled,d=void 0===h||h,p=s.hasState(nO.selected),f=a._getSelectedLegends();if("multiple"===u){if(!1===d&&p&&1===f.length)return void a._dispatchLegendEvent(rO.legendItemClick,s,t);p?(a._removeLegendItemState(s,[nO.selected,nO.selectedHover],t),a._setLegendItemState(s,nO.unSelected,t)):(a._setLegendItemState(s,nO.selected,t),a._removeLegendItemState(s,[nO.unSelected,nO.unSelectedHover],t))}else a._setLegendItemState(s,nO.selected,t),a._removeLegendItemState(s,[nO.unSelected,nO.unSelectedHover],t),null===(r=a._itemsContainer)||void 0===r||r.getChildren().forEach((function(e){s!==e&&(a._removeLegendItemState(e,[nO.selected,nO.selectedHover],t),a._setLegendItemState(e,nO.unSelected,t))}))}a._dispatchLegendEvent(rO.legendItemClick,s,t)}},a}return h(e,t),o(e,[{key:"render",value:function(){_(e,"render",this,3)([]),this._lastActiveItem=null}},{key:"setSelected",value:function(t){var e,i=this;(null===(e=this._itemsContainer)||void 0===e?void 0:e.getChildren()).forEach((function(e){var n=e.data;t.includes(n.label)?(i._setLegendItemState(e,nO.selected),i._removeLegendItemState(e,[nO.unSelected,nO.unSelectedHover])):(i._removeLegendItemState(e,[nO.selected,nO.selectedHover]),i._setLegendItemState(e,nO.unSelected))}))}},{key:"_renderItems",value:function(){for(var t,e=this.attribute,i=e.item,n=void 0===i?{}:i,r=e.maxCol,a=void 0===r?1:r,o=e.maxRow,s=void 0===o?2:o,l=e.maxWidth,u=e.defaultSelected,c=e.lazyload,h=e.autoPage,d=n.spaceCol,p=void 0===d?16:d,f=n.spaceRow,v=void 0===f?8:f,g=n.verticalAlign,y=void 0===g?"middle":g,m=this._itemsContainer,_=this._itemContext,b=_.items,x=_.isHorizontal,k=_.startIndex,S=_.isScrollbar,A=S?1:x?s:a,M=this._contentMaxHeight,T=this._itemContext,w=T.doWrap,C=T.maxWidthInCol,E=T.startX,P=T.startY,B=T.pages,R=0,L=0,I=[],D=k,O=b.length;D<O&&!(c&&B>this._itemContext.currentPage*A);D++){c&&(this._itemContext.startIndex=D+1),(t=b[D]).id||(t.id=t.label),t.index=D;var F=!0;q(u)&&(F=u.includes(t.label));var z=this._renderEachItem(t,F,D,b),H=z.attribute.width,N=z.attribute.height;this._itemHeight=Math.max(this._itemHeight,N),C=Math.max(H,C),this._itemMaxWidth=Math.max(H,this._itemMaxWidth),x?(U(l)&&(S&&h?w=(B=Math.ceil((E+H)/l))>1:E+H>l&&(w=!0,E>0&&("middle"!==y&&"bottom"!==y||I.forEach((function(t){t.setAttributes({y:t.attribute.y+(L-t.attribute.height)/("middle"===y?2:1)})})),B+=1,E=0,P+=L+v,L=0,I.length=0))),0===E&&0===P||z.setAttributes({x:E,y:P}),E+=p+H,L=Math.max(L,N),I.push(z)):(U(M)&&(S&&h?w=(B=Math.ceil((P+N)/M))>1:M<=N?(B+=1,w=!0,P=0,D>0&&(E+=R+p)):M<P+N&&(B+=1,w=!0,P=0,E+=C+p,C=0)),0===E&&0===P||z.setAttributes({x:E,y:P}),P+=v+N),m.add(z),R=H}return!x||"middle"!==y&&"bottom"!==y||I.forEach((function(t){t.setAttributes({y:t.attribute.y+(L-t.attribute.height)/("middle"===y?2:1)})})),this._itemContext.doWrap=w,this._itemContext.startX=E,this._itemContext.startY=P,this._itemContext.maxWidthInCol=C,this._itemContext.pages=B,this._itemContext.maxPages=A,S&&(this._itemContext.totalPage=B),c||(this._itemContext.startIndex=b.length),this._itemContext}},{key:"_renderContent",value:function(){var t=this.attribute,e=t.item,i=void 0===e?{}:e,n=t.items,r=t.reversed,a=t.maxWidth,o=t.maxHeight;if(!1!==i.visible&&!lt(n)){var s=n;r&&(s=null==n?void 0:n.reverse()),this._contentMaxHeight=Math.max(0,o-this._parsedPadding[0]-this._parsedPadding[2]);var l=kg.group({x:0,y:0});this._itemsContainer=l;var u=this.attribute,c=u.layout,h=u.autoPage,d="horizontal"===c,p=i.maxWidth,f=i.width,v=i.height,g=[];U(p)&&g.push(p),U(f)&&g.push(f),g.length&&(U(a)&&g.push(a),this._itemWidthByUser=Tt(g)),U(v)&&(this._itemHeightByUser=v);var y=this.attribute.pager;this._itemContext={currentPage:y&&y.defaultCurrent||1,doWrap:!1,maxWidthInCol:0,maxPages:1,pages:1,startX:0,startY:0,startIndex:0,items:s,isHorizontal:d,totalPage:1/0,isScrollbar:y&&"scrollbar"===y.type,clipContainer:void 0},this._itemContext=this._renderItems();var m=!1;this._itemContext.doWrap&&h&&this._itemContext.pages>this._itemContext.maxPages&&(m=this._renderPagerComponent()),m||(l.setAttribute("y",this._title?this._title.AABBBounds.height()+ut(this.attribute,"title.space",8):0),this._innerView.add(l))}}},{key:"_bindEvents",value:function(){if(!this.attribute.disableTriggerEvent&&this._itemsContainer){var t=this.attribute,e=t.hover,i=void 0===e||e,n=t.select,r=void 0===n||n;if(i){var a="pointermove",o="pointerleave";W(i)&&(i.trigger&&(a=i.trigger),i.triggerOff&&(o=i.triggerOff)),this._itemsContainer.addEventListener(a,this._onHover),this._itemsContainer.addEventListener(o,this._onUnHover)}if(r){var s="pointerdown";W(r)&&r.trigger&&(s=r.trigger),this._itemsContainer.addEventListener(s,this._onClick)}}}},{key:"_autoEllipsis",value:function(t,e,i,n){var r,a,o=this.attribute.item,s=o.label,l=o.value,u=n.AABBBounds,c=i.AABBBounds,h=u.width(),d=c.width(),p=!1;"labelFirst"===t?d>e?p=!0:n.setAttribute("maxLineWidth",e-d):"valueFirst"===t?h>e?p=!0:i.setAttribute("maxLineWidth",e-h):h+d>e&&(p=!0),p&&(n.setAttribute("maxLineWidth",Math.max(e*(null!==(r=s.widthRatio)&&void 0!==r?r:.5),e-d)),i.setAttribute("maxLineWidth",Math.max(e*(null!==(a=l.widthRatio)&&void 0!==a?a:.5),e-h)))}},{key:"_renderEachItem",value:function(t,e,i,n){var r,a,o,s=t.id,l=t.label,u=t.value,c=t.shape,h=this.attribute.item,d=h.padding,p=void 0===d?0:d,f=h.focus,v=h.focusIconStyle,g=h.align,y=h.autoEllipsisStrategy,m=this.attribute.item,_=m.shape,b=m.label,x=m.value,k=m.background,S=this._handleStyle(_,t,e,i,n),A=this._handleStyle(b,t,e,i,n),M=this._handleStyle(x,t,e,i,n),T=this._handleStyle(k,t,e,i,n),w=Di(p);!1===k.visible?(o=kg.group({x:0,y:0,cursor:null===(r=T.style)||void 0===r?void 0:r.cursor}),this._appendDataToShape(o,aO.item,t,o)):(o=kg.group(Object.assign({x:0,y:0},T.style)),this._appendDataToShape(o,aO.item,t,o,T.state)),o.id="".concat(null!=s?s:l,"-").concat(i),o.addState(e?nO.selected:nO.unSelected);var C=kg.group({x:0,y:0,pickable:!1});o.add(C);var E,P=0,B=0,R=0;if(_&&!1!==_.visible){var L=ut(S,"style.size",10);B=q(L)?L[0]||0:L,R=ut(_,"space",8);var I=kg.symbol(Object.assign(Object.assign({x:0,y:0,symbolType:"circle",strokeBoundsBuffer:0},c),S.style));Object.keys(S.state||{}).forEach((function(t){var e=S.state[t].fill||S.state[t].stroke;c.fill&&j(S.state[t].fill)&&e&&(S.state[t].fill=e),c.stroke&&j(S.state[t].stroke)&&e&&(S.state[t].stroke=e)})),this._appendDataToShape(I,aO.itemShape,t,o,S.state),I.addState(e?nO.selected:nO.unSelected),C.add(I)}var D=0;if(f){var O=ut(v,"size",10);E=kg.symbol(Object.assign(Object.assign({x:0,y:-O/2-1,strokeBoundsBuffer:0,boundsPadding:w},v),{visible:!0,pickMode:"imprecise"})),this._appendDataToShape(E,aO.focus,t,o),D=O}var F=b.formatMethod?b.formatMethod(l,t,i):l,z=XC(Object.assign(Object.assign({x:B/2+R,y:0,textAlign:"start",textBaseline:"middle",lineHeight:null===(a=A.style)||void 0===a?void 0:a.fontSize},A.style),{text:F,_originText:b.formatMethod?l:void 0}));this._appendDataToShape(z,aO.itemLabel,t,o,A.state),z.addState(e?nO.selected:nO.unSelected),C.add(z);var H=ut(b,"space",8);if(U(u)){var N=ut(x,"space",f?8:0),V=x.formatMethod?x.formatMethod(u,t,i):u,W=XC(Object.assign(Object.assign({x:0,y:0,textAlign:"start",textBaseline:"middle",lineHeight:M.style.fontSize},M.style),{text:V,_originText:x.formatMethod?u:void 0}));if(this._appendDataToShape(W,aO.itemValue,t,o,M.state),W.addState(e?nO.selected:nO.unSelected),this._itemWidthByUser){var G=this._itemWidthByUser-w[1]-w[3]-B-R-H-D-N;this._autoEllipsis(y,G,z,W),x.alignRight?W.setAttributes({textAlign:"right",x:this._itemWidthByUser-B/2-w[1]-w[3]-D-N}):W.setAttribute("x",H+(z.AABBBounds.empty()?0:z.AABBBounds.x2))}else W.setAttribute("x",H+(z.AABBBounds.empty()?0:z.AABBBounds.x2));P=N+(W.AABBBounds.empty()?0:W.AABBBounds.x2),C.add(W)}else this._itemWidthByUser?(z.setAttribute("maxLineWidth",this._itemWidthByUser-w[1]-w[3]-B-R-D),P=H+(z.AABBBounds.empty()?0:z.AABBBounds.x2)):P=H+(z.AABBBounds.empty()?0:z.AABBBounds.x2);E&&(E.setAttribute("x",P),C.add(E));var Y=C.AABBBounds,X=Y.width();if("right"===g){var K=Y.x2,Z=Y.x1;C.forEachChildren((function(t,e){"symbol"!==t.type&&"right"!==t.attribute.textAlign||t===E?t.setAttribute("x",Z+K-t.attribute.x-t.AABBBounds.width()):"symbol"!==t.type?t.setAttributes({x:Z+K-t.attribute.x,textAlign:"left"}):t.setAttribute("x",Z+K-t.attribute.x)}))}var J=Y.height(),Q=U(this.attribute.item.width)?this.attribute.item.width:X+w[1]+w[3],$=this._itemHeightByUser||J+w[0]+w[2];return o.attribute.width=Q,o.attribute.height=$,E&&E.setAttribute("visible",!1),C.translateTo(-Y.x1+w[3],-Y.y1+w[0]),o}},{key:"_createPager",value:function(t){var e,i,n=this.attribute,r=n.disableTriggerEvent,a=n.maxRow,o=function(t){return t<=99?99:t<=999?999:9999};return this._itemContext.isHorizontal?new iO(Object.assign(Object.assign({layout:1===a?"horizontal":"vertical",total:o(this._itemContext.pages)},gt({handler:{preShape:"triangleUp",nextShape:"triangleDown"}},t)),{defaultCurrent:null===(e=this.attribute.pager)||void 0===e?void 0:e.defaultCurrent,disableTriggerEvent:r})):new iO(Object.assign({layout:"horizontal",total:o(this._itemContext.pages),disableTriggerEvent:r,defaultCurrent:null===(i=this.attribute.pager)||void 0===i?void 0:i.defaultCurrent},t))}},{key:"_createScrollbar",value:function(t,e){var i=this.attribute.disableTriggerEvent;return this._itemContext.isHorizontal?new AC(Object.assign(Object.assign({direction:"horizontal",disableTriggerEvent:i,range:[0,.5],height:!1===t.visible?0:12},t),{width:e})):new AC(Object.assign(Object.assign({direction:"vertical",width:!1===t.visible?0:12,range:[0,.5]},t),{height:e,disableTriggerEvent:i}))}},{key:"_updatePositionOfPager",value:function(t,e,i){var n,r,a=this.attribute.pager,o=this._itemContext,s=o.totalPage,l=o.isHorizontal,u=a&&a.position||"middle";(this._pagerComponent.setTotal(s),l)?(n="start"===u?t:"end"===u?t+i-this._pagerComponent.AABBBounds.height()/2:t+i/2-this._pagerComponent.AABBBounds.height()/2,this._pagerComponent.setAttributes({x:e-this._pagerComponent.AABBBounds.width(),y:n})):(r="start"===u?0:"end"===u?e-this._pagerComponent.AABBBounds.width():(e-this._pagerComponent.AABBBounds.width())/2,this._pagerComponent.setAttributes({x:r,y:i-this._pagerComponent.AABBBounds.height()}))}},{key:"_computeScrollbarDelta",value:function(){var t,e=this._itemContext,i=e.isHorizontal,n=e.clipContainer,r=this._itemsContainer.AABBBounds,a=n.AABBBounds;return i?t=a.width()/r.width():t=a.height()/r.height(),t}},{key:"_updatePositionOfScrollbar",value:function(t,e,i){var n=this._itemContext,r=n.isHorizontal,a=(n.currentPage-1)/n.totalPage;this._pagerComponent.setScrollRange([a,a+this._computeScrollbarDelta()]),r?this._pagerComponent.setAttributes({x:0,y:i+e}):this._pagerComponent.setAttributes({x:t,y:i})}},{key:"_bindEventsOfPager",value:function(t,e){var i=this,n=this.attribute.pager||{},r=n.animation,a=void 0===r||r,o=n.animationDuration,s=void 0===o?450:o,u=n.animationEasing,c=void 0===u?"quadIn":u,h=this._itemContext.isScrollbar?function(t){var e=t.detail.value;return 0===e[0]?1:1===e[1]?i._itemContext.totalPage:e[0]*i._itemContext.totalPage+1}:function(t){return t.detail.current},d=function(n){var r=h(n);if(r!==i._itemContext.currentPage){if(i._itemContext.currentPage=r,i._itemContext&&i._itemContext.startIndex<i._itemContext.items.length){i._renderItems();var o=Math.ceil(i._itemContext.pages/i._itemContext.maxPages);if(i._itemContext.totalPage=o,i._itemContext.isScrollbar&&i._pagerComponent){var u=i._computeScrollbarDelta(),d=m(i._pagerComponent.getScrollRange(),1)[0];i._pagerComponent.setScrollRange([d,d+u])}}if(i._itemContext.isScrollbar){var p=m(i._pagerComponent.getScrollRange(),1)[0],f=(i._itemContext.isHorizontal?i._itemsContainer.AABBBounds.width():i._itemsContainer.AABBBounds.height())*p;i.updateScrollMask(),a?i._itemsContainer.animate().to(l({},e,-f),s,c):i._itemsContainer.setAttribute(e,-f)}else a?i._itemsContainer.animate().to(l({},e,-(r-1)*t),s,c):i._itemsContainer.setAttribute(e,-(r-1)*t)}};if(this._itemContext.isScrollbar){if(this._pagerComponent.addEventListener("scrollDrag",d),this._pagerComponent.addEventListener("scrollUp",d),this.attribute.pager.roamScroll){this.addEventListener("wheel",(function(t){return t.nativeEvent.preventDefault()})),this.addEventListener("wheel",Qt((function(t){var e=i._pagerComponent,n=e.getScrollRange(),r=e.attribute.direction,a=e.getSliderRenderBounds(),o=a.width,s=a.height,l="vertical"===r?t.deltaY/s:t.deltaX/o;e.setScrollRange([n[0]+l,n[1]+l],!0),i.updateScrollMask()}),50))}}else this._pagerComponent.addEventListener("toPrev",d),this._pagerComponent.addEventListener("toNext",d)}},{key:"_renderPager",value:function(){var t,e=this,i=this._title?this._title.AABBBounds.height()+ut(this.attribute,"title.space",8):0,n=this.attribute,r=n.maxWidth,a=n.maxCol,o=void 0===a?1:a,s=n.maxRow,l=void 0===s?2:s,u=n.item,c=void 0===u?{}:u,h=n.pager,d=void 0===h?{}:h,p=c.spaceCol,f=void 0===p?16:p,v=c.spaceRow,g=void 0===v?8:v,y=this._itemsContainer,m=d.space,_=void 0===m?12:m,b=d.defaultCurrent,x=void 0===b?1:b,k=uO(d,["space","defaultCurrent"]),S=this._itemContext.isHorizontal,A=this._contentMaxHeight,M=0,T=0,w=0,C=0,E=0,P=0,B=1;if(S){if(T=(l-1)*g+this._itemHeight*l,M=r,t=this._createPager(k),this._pagerComponent=t,this._innerView.add(t),(w=r-t.AABBBounds.width()-_)<=0)return this._innerView.removeChild(t),!1;y.getChildren().forEach((function(t,e){var i=t.attribute,n=i.width,r=i.height;w<E+n&&(E=0,P+=r+g,B+=1),e>0&&t.setAttributes({x:E,y:P}),E+=f+n})),this._itemContext.startX=E,this._itemContext.startY=P,this._itemContext.pages=B;var R=Math.ceil(B/l);this._itemContext.totalPage=R,this._updatePositionOfPager(i,M,T)}else{if(M=this._itemMaxWidth*o+(o-1)*f,T=A,w=M,t=this._createPager(k),this._pagerComponent=t,this._innerView.add(t),(C=A-t.AABBBounds.height()-_-i)<=0)return this._innerView.removeChild(t),!1;y.getChildren().forEach((function(t,i){var n=t.attribute.height;C<P+n&&(P=0,E+=e._itemMaxWidth+f,B+=1),i>0&&t.setAttributes({x:E,y:P}),P+=g+n}));var L=Math.ceil(B/o);this._itemContext.totalPage=L,this._updatePositionOfPager(i,M,T)}x>1&&(S?y.setAttribute("y",-(x-1)*(T+g)):y.setAttribute("x",-(x-1)*(M+f)));var I=kg.group({x:0,y:i,width:S?w:M,height:S?T:C,clip:!0,pickable:!1});return I.add(y),this._innerView.add(I),this._itemContext.clipContainer=I,this._bindEventsOfPager(S?T+g:M+f,S?"y":"x"),!0}},{key:"_renderScrollbar",value:function(){var t,e=this._title?this._title.AABBBounds.height()+ut(this.attribute,"title.space",8):0,i=this.attribute,n=i.maxWidth,r=i.item,a=void 0===r?{}:r,o=i.pager,s=void 0===o?{}:o,l=a.spaceCol,u=void 0===l?16:l,c=a.spaceRow,h=void 0===c?8:c,d=this._itemsContainer;s.space;var p,f=s.defaultCurrent,v=void 0===f?1:f,g=uO(s,["space","defaultCurrent"]),y=this._itemContext.isHorizontal,m=this._contentMaxHeight,_=0,b=0,x=0,k=1;if(y)_=n,b=this._itemHeight,p=this._createScrollbar(g,_),this._pagerComponent=p,this._innerView.add(p);else{if(b=m-e,_=this._itemMaxWidth,p=this._createScrollbar(g,b),this._pagerComponent=p,this._innerView.add(p),b<=0)return this._innerView.removeChild(p),!1;var S=d.getChildren(),A=S.map((function(t){return t.attribute.height}));if(1===A.length||A.every((function(t){return t===A[0]}))){var M=A[0],T=b,w=Math.floor(T/(h+M));b=w*(h+M),k=Math.ceil(S.length/w)}else S.forEach((function(t,e){var i=t.attribute.height,n=k,r=x;k=Math.floor((x+i)/b)+1,x+=h+i,n!==k&&e===d.getChildren().length-1&&x-b>=1/3*i&&(b=r+i,k-=1)}));this._itemContext.totalPage=k,this._itemContext.pages=k}if(v>1)if(y){var C=this._itemsContainer.AABBBounds.width()-_;d.setAttribute("x",-Math.min((v-1)*(_+u),C))}else{var E=this._itemsContainer.AABBBounds.height()-b;d.setAttribute("y",-Math.min((v-1)*(b+h),E))}var P=kg.group({x:0,y:e,width:_,height:b,clip:!0,pickable:!1});return P.add(d),this._innerView.add(P),this._itemContext.clipContainer=P,this._updatePositionOfScrollbar(_,b,e),(null===(t=s.scrollMask)||void 0===t?void 0:t.visible)&&this.renderScrollMask(P),this._bindEventsOfPager(y?_:b,y?"x":"y"),!0}},{key:"renderScrollMask",value:function(t){var e=this.attribute.pager.scrollMask,i=void 0===e?{}:e,n=i.visible,r=void 0===n||n,a=i.gradientLength,o=void 0===a?16:a,s=i.gradientStops;if(r&&s){var l=t.AABBBounds.width(),u=t.AABBBounds.height(),c=this._itemContext.isHorizontal?l:u,h=s.map((function(t){return{offset:o*t.offset/c,color:t.color}})),d=s.map((function(t){return{offset:(c-o*t.offset)/c,color:t.color}})),p=kg.rect({x:0,y:0,width:l,height:u});this._scrollMask=p,this._scrollMaskContext={startStops:h,endStops:d},this.updateScrollMask(),t.add(p)}}},{key:"updateScrollMask",value:function(){if(this._scrollMask&&this._pagerComponent&&this._itemContext.isScrollbar){var t=m(this._pagerComponent.getScrollRange(),2),e=t[0],i=t[1],n=[];Ut(Xt(i,0,1),1)||n.push.apply(n,b(this._scrollMaskContext.endStops)),Ut(Xt(e,0,1),0)||n.push.apply(n,b(this._scrollMaskContext.startStops)),n.length&&(this._itemContext.isHorizontal?this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:n}}):this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:0,y1:1,stops:n}}))}}},{key:"_renderPagerComponent",value:function(){return this._itemContext.isScrollbar?this._renderScrollbar():this._renderPager(),!0}},{key:"_hover",value:function(t,e){this._lastActiveItem=t,t.hasState(nO.selected)?this._setLegendItemState(t,nO.selectedHover,e):this._setLegendItemState(t,nO.unSelectedHover,e);var i=t.getChildren()[0].find((function(t){return t.name===aO.focus}),!1);i&&i.setAttribute("visible",!0),this._dispatchLegendEvent(rO.legendItemHover,t,e)}},{key:"_unHover",value:function(t,e){var i=!1;(t.hasState(nO.unSelectedHover)||t.hasState(nO.selectedHover))&&(i=!0),t.removeState(nO.unSelectedHover),t.removeState(nO.selectedHover),t.getChildren()[0].getChildren().forEach((function(t){i||!t.hasState(nO.unSelectedHover)&&!t.hasState(nO.selectedHover)||(i=!0),t.removeState(nO.unSelectedHover),t.removeState(nO.selectedHover)}));var n=t.getChildren()[0].find((function(t){return t.name===aO.focus}),!1);n&&n.setAttribute("visible",!1),i&&this._dispatchLegendEvent(rO.legendItemAttributeUpdate,t,e),this._dispatchLegendEvent(rO.legendItemUnHover,t,e)}},{key:"_setLegendItemState",value:function(t,e,i){var n=!1;t.hasState(e)||(n=!0),t.addState(e,!0),t.getChildren()[0].getChildren().forEach((function(t){t.name!==aO.focus&&(n||t.hasState(e)||(n=!0),t.addState(e,!0))})),n&&this._dispatchLegendEvent(rO.legendItemAttributeUpdate,t,i)}},{key:"_removeLegendItemState",value:function(t,e,i){var n=!1;e.forEach((function(e){!n&&t.hasState(e)&&(n=!0),t.removeState(e)})),t.getChildren()[0].getChildren().forEach((function(t){t.name!==aO.focus&&e.forEach((function(e){!n&&t.hasState(e)&&(n=!0),t.removeState(e)}))})),n&&this._dispatchLegendEvent(rO.legendItemAttributeUpdate,t,i)}},{key:"_getSelectedLegends",value:function(){var t,e=[];return null===(t=this._itemsContainer)||void 0===t||t.getChildren().forEach((function(t){t.hasState(nO.selected)&&e.push(t.data)})),e}},{key:"_appendDataToShape",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};t.name=e,t.data=i,t.delegate=n,t.states=gt({},cO,r)}},{key:"_dispatchLegendEvent",value:function(t,e,i){var n=this._getSelectedLegends();n.sort((function(t,e){return t.index-e.index}));var r=n.map((function(t){return t.label}));this._dispatchEvent(t,{item:e,data:e.data,selected:e.hasState(nO.selected),currentSelectedItems:n,currentSelected:r,event:i})}},{key:"_handleStyle",value:function(t,e,i,n,r){var a={};return t.style&&(V(t.style)?a.style=t.style(e,i,n,r):a.style=t.style),t.state&&(a.state={},Object.keys(t.state).forEach((function(o){t.state[o]&&(V(t.state[o])?a.state[o]=t.state[o](e,i,n,r):a.state[o]=t.state[o])}))),a}},{key:"release",value:function(){_(e,"release",this,3)([]),this.removeAllEventListeners()}}])}(oO);function pO(t){return q(t)?t:[t,t]}function fO(t){return t?"ew-resize":"ns-resize"}dO.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:16,spaceRow:8,shape:{space:8,style:{size:10,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{opacity:.5}}},label:{space:8,style:{fontSize:12,fill:"#2C3542",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"}},focus:!1,focusIconStyle:{size:10,symbolType:"M8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1ZM8.75044 2.55077L8.75 3.75H7.25L7.25006 2.5507C4.81247 2.88304 2.88304 4.81247 2.5507 7.25006L3.75 7.25V8.75L2.55077 8.75044C2.8833 11.1878 4.81264 13.117 7.25006 13.4493L7.25 12.25H8.75L8.75044 13.4492C11.1876 13.1167 13.1167 11.1876 13.4492 8.75044L12.25 8.75V7.25L13.4493 7.25006C13.117 4.81264 11.1878 2.8833 8.75044 2.55077ZM8 5.5C9.38071 5.5 10.5 6.61929 10.5 8C10.5 9.38071 9.38071 10.5 8 10.5C6.61929 10.5 5.5 9.38071 5.5 8C5.5 6.61929 6.61929 5.5 8 5.5ZM8 7C7.44772 7 7 7.44772 7 8C7 8.55228 7.44772 9 8 9C8.55228 9 9 8.55228 9 8C9 7.44772 8.55228 7 8 7Z",fill:"#333",cursor:"pointer"}},autoPage:!0,pager:{space:12,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!0},function(t){t.innerView="innerView",t.railContainer="sliderRailContainer",t.rail="sliderRail",t.startText="sliderStartText",t.endText="sliderEndText",t.startHandler="sliderStartHandler",t.startHandlerText="startHandlerText",t.endHandler="sliderEndHandler",t.endHandlerText="sliderEndHandlerText",t.track="sliderTrack",t.trackContainer="sliderTrackContainer"}(hO||(hO={})),sO();var vO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="slider",a._isHorizontal=!0,a._startHandler=null,a._endHandler=null,a._startHandlerText=null,a._endHandlerText=null,a._currentHandler=null,a._currentValue={},a._onTooltipShow=function(t){a._isChanging||a._tooltipState&&a._tooltipState.isActive||(a._tooltipState?a._tooltipState.isActive=!0:a._tooltipState={isActive:!0},a._onTooltipUpdate(t),a._dispatchTooltipEvent("sliderTooltipShow"))},a._onTooltipUpdate=function(t){if(!a._isChanging&&a._tooltipState&&a._tooltipState.isActive){var e=a._isHorizontal?a._rail.globalAABBBounds.width():a._rail.globalAABBBounds.height(),i=Xt(a._isHorizontal?(t.viewX-a._rail.globalAABBBounds.x1)/e:(t.viewY-a._rail.globalAABBBounds.y1)/e,0,1);i!==a._tooltipState.pos&&(a._tooltipState.pos=i,a._tooltipState.value=a.calculateValueByPos(i*e),a._updateTooltip(),a._dispatchTooltipEvent("sliderTooltipUpdate"))}},a._onTooltipHide=function(){var t=a.attribute.tooltip;t&&t.alwaysShow||(a._tooltipState=null,a._tooltipShape&&a._tooltipShape.setAttribute("visible",!1),a._tooltipText&&a._tooltipText.setAttribute("visible",!1),a._dispatchTooltipEvent("sliderTooltipHide"))},a._onHandlerPointerdown=function(t){a._clearAllDragEvents(),a._isChanging=!0;var e=a.stage.eventPointTransform(t),i=e.x,n=e.y;a._currentHandler=t.target,a._prePos=a._isHorizontal?i:n;var r=kC(),o="browser"===j_.env?j_:a.stage;o.addEventListener("pointermove",a._onHandlerPointerMove,{capture:!0}),r.forEach((function(t){o.addEventListener(t,a._onHandlerPointerUp)}))},a._onHandlerPointerMove=function(t){var e,i;a._isChanging=!0;var n=a.attribute,r=n.railWidth,o=n.railHeight,s=n.min;if(n.max!==s){var l,u,c,h=a.stage.eventPointTransform(t),d=h.x,p=h.y,f=0;a._isHorizontal?(f=(l=d)-a._prePos,u=null===(i=a._currentHandler)||void 0===i?void 0:i.attribute.x,c=r):(f=(l=p)-a._prePos,u=null===(e=a._currentHandler)||void 0===e?void 0:e.attribute.y,c=o);var v=Xt(u+f,0,c),g=a.calculateValueByPos(v);"text"===a._currentHandler.type?a._updateHandlerText(a._currentHandler,v,g):a._updateHandler(a._currentHandler,v,g),a._updateTrack(),a._prePos=l,a._dispatchChangeEvent()}},a._onHandlerPointerUp=function(t){a._isChanging=!1,a._currentHandler=null,a._clearAllDragEvents()},a._handleTouchMove=function(t){a._isChanging&&t.preventDefault()},a._onTrackPointerdown=function(t){a._clearAllDragEvents(),a._isChanging=!0;var e=a.stage.eventPointTransform(t),i=e.x,n=e.y;a._prePos=a._isHorizontal?i:n;var r=kC(),o="browser"===j_.env?j_:a.stage;o.addEventListener("pointermove",a._onTrackPointerMove,{capture:!0}),r.forEach((function(t){o.addEventListener(t,a._onTrackPointerUp)}))},a._onTrackPointerMove=function(t){a._isChanging=!0;var e=a.attribute,i=e.railWidth,n=e.railHeight,r=e.min,o=e.max,s=e.inverse;if(o!==r){var l,u,c,h=a._getHandlers(),d=h.startHandler,p=h.endHandler,f=a.stage.eventPointTransform(t),v=f.x,g=f.y;a._isHorizontal?(l=v,u=a._track.attribute.width,c=i):(l=g,u=a._track.attribute.height,c=n);var y=l-a._prePos;if(d){var m=a._isHorizontal?d.attribute.x:d.attribute.y,_=s?Xt(m+y,u,c):Xt(m+y,0,c-u),b=a.calculateValueByPos(_);a._updateHandler(d,_,b)}if(p){var x=a._isHorizontal?p.attribute.x:p.attribute.y,k=s?Xt(x+y,0,c-u):Xt(x+y,u,c),S=a.calculateValueByPos(k),A=null==d?void 0:d.attribute;a._updateHandler(p,k,S),a._track.setAttributes(a._isHorizontal?{x:Math.min(A.x,p.attribute.x),width:Math.abs(A.x-p.attribute.x)}:{y:Math.min(A.y,p.attribute.y),height:Math.abs(A.y-p.attribute.y)})}a._prePos=l,a._dispatchChangeEvent()}},a._onTrackPointerUp=function(t){a._isChanging=!1,a._clearAllDragEvents()},a._onRailPointerDown=function(t){a._clearAllDragEvents(),a._isChanging=!0;var e=a.attribute,i=(e.railWidth,e.railHeight,e.min);if(e.max!==i){var n,r,o,s=a._startHandler,l=a._endHandler;a._isHorizontal?(n=t.viewX-a._rail.globalAABBBounds.x1,r=null==s?void 0:s.attribute.x,o=null==l?void 0:l.attribute.x):(n=t.viewY-a._rail.globalAABBBounds.y1,r=null==s?void 0:s.attribute.y,o=null==l?void 0:l.attribute.y);var u=a.calculateValueByPos(n);if(U(o)){var c=Math.abs(n-r)>Math.abs(n-o)?l:s;a._updateHandler(c,n,u)}else a._updateHandler(s,n,u);a._updateTrack(),a._dispatchChangeEvent()}},a}return h(e,t),o(e,[{key:"track",get:function(){return this._track}},{key:"currentValue",get:function(){return this._currentValue}},{key:"startHandler",get:function(){return this._startHandler}},{key:"endHandler",get:function(){return this._endHandler}},{key:"tooltipShape",get:function(){return this._tooltipShape}},{key:"calculatePosByValue",value:function(t,e){var i,n=this.attribute,r=n.layout,a=n.railWidth,o=n.railHeight,s=n.min,l=n.max;return i=s===l?"start"===e?0:"end"===e?1:0:(t-s)/(l-s),(n.inverse?1-i:i)*("vertical"===r?o:a)}},{key:"calculateValueByPos",value:function(t){var e=this.attribute,i=e.layout,n=e.railWidth,r=e.railHeight,a=e.min,o="vertical"===i?r:n;return a+(e.max-a)*(e.inverse?1-t/o:t/o)}},{key:"setValue",value:function(t){var e=this.attribute,i=e.min;if(e.max!==i){var n=m(St(t),2),r=n[0],a=n[1],o=this._getHandlers(),s=o.startHandler,l=o.endHandler;s&&this._updateHandler(s,this.calculatePosByValue(r),r),l&&this._updateHandler(l,this.calculatePosByValue(a),a),this._updateTrack()}}},{key:"render",value:function(){var t,e;this.removeAllChild(!0);var i=this.attribute,n=i.layout,r=void 0===n?"horizontal":n,a=i.railWidth,o=i.railHeight,s=i.startText,l=i.endText,u=i.min,c=i.max,h=i.showHandler,d=void 0===h||h,p=i.showTooltip,f=this.attribute.value;j(f)&&(f=[u,c]),this._currentValue={startValue:pO(f)[0],endValue:pO(f)[1]};var v="horizontal"===r;this._isHorizontal=v;var g=kg.group({x:0,y:0});g.name=hO.innerView,this.add(g),this._innerView=g;var y,m=0;if(s&&s.visible){(y=kg.text(Object.assign({x:v?0:a/2,y:v?o/2:0,textAlign:v?"start":"center",textBaseline:v?"middle":"top",text:s.text,lineHeight:null===(t=s.style)||void 0===t?void 0:t.fontSize},s.style))).name=hO.startText,g.add(y);var _=U(s.space)?s.space:0;m+=(v?y.AABBBounds.width():y.AABBBounds.height())+_}var b=kg.group({x:v?m:0,y:v?0:m});g.add(b);var x,k=kg.group({x:0,y:0});if(k.name=hO.railContainer,this._railContainer=k,b.add(k),this._mainContainer=b,this._renderRail(k),m+=v?a:o,l&&l.visible){var S=U(l.space)?l.space:0;(x=kg.text(Object.assign({x:v?m+S:a/2,y:v?o/2:m+S,textAlign:v?"start":"center",textBaseline:v?"middle":"top",text:l.text,lineHeight:null===(e=l.style)||void 0===e?void 0:e.fontSize},l.style))).name=hO.endText,g.add(x)}this._renderTrack(k),d&&(this._renderHandlers(b),this._bindEvents()),p&&(this._renderTooltip(),this._bindTooltipEvents())}},{key:"_renderRail",value:function(t){var e=this.attribute,i=e.railWidth,n=e.railHeight,r=e.railStyle,a="default";!1!==e.slidable&&(a="pointer");var o=kg.rect(Object.assign({x:0,y:0,width:i,height:n,cursor:a},r));return o.name=hO.rail,t.add(o),this._rail=o,o}},{key:"_renderHandlers",value:function(t){var e=this.attribute,i=e.range,n=e.min,r=e.max,a=e.handlerSize,o=void 0===a?14:a,s=e.handlerStyle,l=e.handlerText,u=e.railHeight,c=e.railWidth,h=e.slidable,d=this.attribute.value;j(d)&&(d=[n,r]);var p=l&&l.visible,f=this._isHorizontal,v=m(pO(d),2),g=v[0],y=v[1],_=this.calculatePosByValue(g,i?"start":"end"),b=this._renderHandler(Object.assign({x:f?_:c/2,y:f?u/2:_,size:o,strokeBoundsBuffer:0,cursor:!1===h?"default":fO(f)},s));if(b.name=hO.startHandler,this._startHandler=b,t.add(b),this._currentValue.startPos=_,p){var x=this._renderHandlerText(g,i?"start":"end");x.name=hO.startHandlerText,t.add(x),this._startHandlerText=x}if(i){var k=this.calculatePosByValue(y,"end"),S=this._renderHandler(Object.assign({x:f?k:c/2,y:f?u/2:k,size:o,strokeBoundsBuffer:0,cursor:!1===h?"default":fO(f)},s));if(S.name=hO.endHandler,this._endHandler=S,t.add(S),this._currentValue.endPos=k,p){var A=this._renderHandlerText(y,"end");A.name=hO.endHandlerText,t.add(A),this._endHandlerText=A}}}},{key:"_renderTrack",value:function(t){var e,i,n=this.attribute,r=n.range,a=n.min,o=n.max,s=n.railHeight,l=n.railWidth,u=n.trackStyle,c=n.railStyle,h=n.slidable,d=n.value;if(j(d))r?(e=a,i=o):e=i=a;else if(r){var p=Kt(d,a,o);e=p[0],i=p[1]}else e=a,i=Xt(d,a,o);var f=this._isHorizontal;r||(e=a);var v=kg.group({x:0,y:0,width:l,height:s,cornerRadius:null==c?void 0:c.cornerRadius,clip:!0,pickable:!1});v.name=hO.trackContainer;var g,y=W(r)&&!0===r.draggableTrack;g=!1===h?"default":!1===r||!1===y?"pointer":fO(f);var m=this.calculatePosByValue(e,"start"),_=this.calculatePosByValue(i,r?"end":"start"),b=kg.rect(Object.assign({x:f?Math.min(m,_):0,y:f?0:Math.min(m,_),width:f?Math.abs(_-m):l,height:f?s:Math.abs(_-m),cursor:g},u));b.name=hO.track,this._track=b,v.add(b),t.add(v)}},{key:"_renderHandler",value:function(t){return kg.symbol(t)}},{key:"_renderHandlerText",value:function(t,e){var i,n,r,a=this.attribute,o=a.align,s=a.handlerSize,l=void 0===s?14:s,u=a.handlerText,c=void 0===u?{}:u,h=a.railHeight,d=a.railWidth,p=a.slidable,f=this._isHorizontal,v=this.calculatePosByValue(t,e),g=null!==(i=c.space)&&void 0!==i?i:4,y={text:c.formatter?c.formatter(t):t.toFixed(null!==(n=c.precision)&&void 0!==n?n:0),lineHeight:null===(r=c.style)||void 0===r?void 0:r.lineHeight,cursor:!1===p?"default":fO(f)};return f?"top"===o?(y.textBaseline="bottom",y.textAlign="center",y.x=v,y.y=(h-l)/2-g):(y.textBaseline="top",y.textAlign="center",y.x=v,y.y=(h+l)/2+g):"left"===o?(y.textBaseline="middle",y.textAlign="end",y.x=(d-l)/2-g,y.y=v):(y.textBaseline="middle",y.textAlign="start",y.x=(d+l)/2+g,y.y=v),kg.text(Object.assign(Object.assign({},y),c.style))}},{key:"_renderTooltip",value:function(){var t,e=this.attribute,i=e.tooltip,n=e.railHeight,r=e.railWidth,a=e.align;i&&i.alwaysShow?this._tooltipState={value:this._currentValue.startValue,pos:this._currentValue.startPos}:this._tooltipState=null;var o=this._isHorizontal?0:r/2,s=this._isHorizontal?n/2:0;if(i&&i.shape){var l=kg.symbol(Object.assign({pickable:!1,visible:!!this._tooltipState,x:o,y:s,symbolType:"circle"},i.shapeStyle));this._tooltipShape=l,this._mainContainer.add(l)}var u=i&&i.text||{},c=null!==(t=u.space)&&void 0!==t?t:6,h={pickable:!1,visible:!!this._tooltipState,text:""};this._isHorizontal?(h.x=o,h.y="top"===a?s-n/2-c:s+n/2+c,h.textAlign="center",h.textBaseline="top"===a?"bottom":"top"):(h.y=s,h.x="left"===a?o-r/2-c:s+r/2+c,h.textAlign="left"===a?"end":"start",h.textBaseline="middle");var d=kg.text(Object.assign(Object.assign({},h),u.style));this._mainContainer.add(d),this._tooltipText=d,this._tooltipState&&this._updateTooltip()}},{key:"_updateTooltip",value:function(){var t,e;if((this._tooltipShape||this._tooltipText)&&this._tooltipState){var i=this.attribute,n=i.railWidth,r=i.railHeight,a=this._isHorizontal?n:r,o=this._tooltipState.pos*a,s=this._isHorizontal?"x":"y";this._tooltipShape&&this._tooltipShape.setAttributes(l({visible:!0},s,o));var u=this.attribute.align;if(this._tooltipText){var c=this.attribute.tooltip&&this.attribute.tooltip.text||{};this._tooltipText.setAttributes(l(l({visible:!0},s,o),"text",c.formatter?c.formatter(this._tooltipState.value):this._isHorizontal||"left"!==u?"≈ ".concat(this._tooltipState.value.toFixed(null!==(e=c.precision)&&void 0!==e?e:0)):"".concat(this._tooltipState.value.toFixed(null!==(t=c.precision)&&void 0!==t?t:0)," ≈")))}}}},{key:"_bindEvents",value:function(){if(!this.attribute.disableTriggerEvent){var t=this.attribute,e=t.slidable,i=t.range;e&&(this._startHandler&&this._startHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._startHandlerText&&this._startHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandler&&this._endHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandlerText&&this._endHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),W(i)&&i.draggableTrack&&this._track.addEventListener("pointerdown",this._onTrackPointerdown),this._railContainer.addEventListener("pointerdown",this._onRailPointerDown),("browser"===j_.env?j_:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}))}}},{key:"_bindTooltipEvents",value:function(){this.attribute.disableTriggerEvent||(this._mainContainer.addEventListener("pointerenter",this._onTooltipShow),this._mainContainer.addEventListener("pointermove",this._onTooltipUpdate),this._mainContainer.addEventListener("pointerleave",this._onTooltipHide))}},{key:"_clearAllDragEvents",value:function(){var t=this,e=kC(),i="browser"===j_.env?j_:this.stage;i.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),e.forEach((function(e){i.removeEventListener(e,t._onHandlerPointerUp)})),i.removeEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),e.forEach((function(e){i.removeEventListener(e,t._onTrackPointerUp)}))}},{key:"_updateTrack",value:function(){var t=this.attribute,e=t.inverse,i=t.railWidth,n=t.railHeight,r=this._startHandler,a=this._endHandler;if(this._isHorizontal){var o=null==r?void 0:r.attribute.x;if(a){var s=null==a?void 0:a.attribute.x;this._track.setAttributes({x:Math.min(o,s),width:Math.abs(o-s)})}else e?this._track.setAttributes({x:o,width:i-o}):this._track.setAttributes({width:o})}else{var l=null==r?void 0:r.attribute.y;if(a){var u=null==a?void 0:a.attribute.y;this._track.setAttributes({y:Math.min(l,u),height:Math.abs(l-u)})}else e?this._track.setAttributes({y:l,height:n-l}):this._track.setAttributes({height:l})}}},{key:"_updateHandler",value:function(t,e,i){var n,r=this._isHorizontal;t.setAttribute(r?"x":"y",e);var a=t.name===hO.startHandler?this._startHandlerText:this._endHandlerText;if(a){var o=this.attribute.handlerText,s=void 0===o?{}:o;a.setAttributes(l({text:s.formatter?s.formatter(i):i.toFixed(null!==(n=s.precision)&&void 0!==n?n:0)},r?"x":"y",e))}t.name===hO.startHandler?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}},{key:"_updateHandlerText",value:function(t,e,i){var n,r=this._isHorizontal,a=this.attribute.handlerText,o=void 0===a?{}:a;t.setAttributes(l(l({},r?"x":"y",e),"text",o.formatter?o.formatter(i):i.toFixed(null!==(n=o.precision)&&void 0!==n?n:0)));var s=t.name===hO.startHandlerText?this._startHandler:this._endHandler;s&&s.setAttributes(l({},r?"x":"y",e)),t.name===hO.startHandlerText?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}},{key:"_dispatchChangeEvent",value:function(){var t=!!this.attribute.range,e=this._currentValue;this._dispatchEvent("change",{value:t?[Math.min(e.endValue,e.startValue),Math.max(e.endValue,e.startValue)]:e.startValue,position:t?[Math.min(e.endPos,e.startPos),Math.max(e.endPos,e.startPos)]:e.startPos})}},{key:"_dispatchTooltipEvent",value:function(t){this._dispatchEvent("sliderTooltip",{type:t,position:this._tooltipState&&this._tooltipState.pos,value:this._tooltipState&&this._tooltipState.value})}},{key:"_getHandlers",value:function(){var t,e,i=this.attribute.inverse,n=this._startHandler,r=this._endHandler;return r?(this._isHorizontal?(!i&&r.attribute.x<(null==n?void 0:n.attribute.x)||i&&r.attribute.x>(null==n?void 0:n.attribute.x))&&(n=(t=[r,n])[0],r=t[1]):(!i&&r.attribute.y<(null==n?void 0:n.attribute.y)||i&&r.attribute.y>(null==n?void 0:n.attribute.y))&&(n=(e=[r,n])[0],r=e[1]),{startHandler:n,endHandler:r}):{startHandler:n,endHandler:r}}},{key:"release",value:function(t){_(e,"release",this,3)([t]),("browser"===j_.env?j_:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearAllDragEvents()}}])}(Sx);vO.defaultAttributes={slidable:!0,layout:"horizontal",align:"bottom",height:8,showHandler:!0,handlerSize:14,handlerStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},tooltip:{shapeStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},text:{style:{fill:"#2C3542",fontSize:12}}},railStyle:{fill:"rgba(0,0,0,.04)"},trackStyle:{fill:"#91caff"},showValue:!0,valueStyle:{fill:"#2C3542",fontSize:12},startText:{style:{fill:"#2C3542",fontSize:12}},endText:{style:{fill:"#2C3542",fontSize:12}},handlerText:{visible:!0,space:4,precision:0,style:{fill:"#2C3542",fontSize:12}}},lO(),sO();var gO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="colorLegend",a._onSliderToolipChange=function(t){var e=a._slider.tooltipShape;if(e&&t.detail&&!j(t.detail.value)){var i=a._colorScale.scale(t.detail.value);e.setAttribute("fill",i)}a.dispatchEvent(t)},a._onSliderChange=function(t){a._updateColor(),a.dispatchEvent(t)},a}return h(e,t),o(e,[{key:"setSelected",value:function(t){this._slider&&(this._slider.setValue(t),this._updateColor())}},{key:"_renderContent",value:function(){for(var t=this.attribute,e=t.colors,i=t.slidable,n=t.layout,r=t.align,a=t.min,o=t.max,s=t.value,l=t.railWidth,u=t.railHeight,c=t.showHandler,h=void 0===c||c,d=t.handlerSize,p=t.handlerStyle,f=t.railStyle,v=t.trackStyle,g=t.startText,y=t.endText,m=t.handlerText,_=t.showTooltip,b=t.tooltip,x=t.inverse,k=t.disableTriggerEvent,S=[],A=(o-a)/(e.length-1),M=0;M<e.length;M++)S.push(a+A*M);this._colorScale=(new UL).domain(S,!0).range(e),this._color=this._getTrackColor();var T=new vO({x:0,y:0,range:{draggableTrack:!0},slidable:i,layout:n,align:r,min:a,max:o,value:s,railWidth:l,railHeight:u,showHandler:h,handlerSize:d,handlerStyle:p,railStyle:f,trackStyle:Object.assign({fill:this._color},v),startText:g,endText:y,handlerText:m,showTooltip:_,tooltip:b,disableTriggerEvent:k,inverse:x});this._innerView.add(T),this._slider=T,T.translateTo(0-T.AABBBounds.x1,(this._title?this._title.AABBBounds.height()+ut(this.attribute,"title.space",12):0)-T.AABBBounds.y1),this._updateColor()}},{key:"_bindEvents",value:function(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}},{key:"_getTrackColor",value:function(){var t=this.attribute,e=t.colors,i=t.layout,n=t.inverse;if(!lt(e)){var r=e.length;if(1===r)return e[0];for(var a=[],o=0;o<r;o++){var s=o/(r-1);a.push({offset:s,color:e[o]})}var l="horizontal"===i,u={gradient:"linear",stops:a,x0:0,y0:0,x1:l?1:0,y1:l?0:1};return n&&(l?(u.x0=1,u.x1=0):(u.y0=1,u.y1=0)),u}}},{key:"_updateColor",value:function(){var t,e=this.attribute,i=e.layout,n=void 0===i?"horizontal":i,r=e.colors,a=e.railWidth,o=e.railHeight,s=this._slider,l=s.startHandler,u=s.endHandler,c=s.track,h=s.attribute,d=this._slider.currentValue,p=d.startValue,f=d.endValue,v=d.startPos,g=d.endPos,y=null===(t=h.handlerStyle)||void 0===t?void 0:t.fill;if(l&&!y){var m=this._colorScale.scale(p);l.setAttribute("fill",m)}if(u&&!y){var _=this._colorScale.scale(f);u.setAttribute("fill",_)}var b="horizontal"===n?a:o;if(Math.abs(v-g)!==b&&r&&r.length>1){var x=this._color.stops,k=Math.min(v,g),S=Math.max(v,g),A=k/b,M=S/b,T=M-A,w=x.filter((function(t){return t.offset>A&&t.offset<M})),C=Math.min(p,f),E=Math.max(p,f),P=this._colorScale.scale(C),B=this._colorScale.scale(E),R=[{offset:0,color:P}];w.forEach((function(t){R.push({offset:(t.offset-A)/T,color:t.color})})),R.push({offset:1,color:B}),c.setAttribute("fill",Object.assign(Object.assign({},this._color),{stops:R}))}}}])}(oO);function yO(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bottom",e=0;return"top"===t?"\n    M".concat(e,",-6L").concat(e-3.5,",-2.5\n    v5\n    h7\n    v-5\n    Z\n"):"left"===t?"\n    M".concat((e=1)-6,",0L").concat(e-6+2.5,",-3.5\n    h5\n    v7\n    h-5\n    Z\n"):"right"===t?"\n    M".concat((e=-1)+6,",0L").concat(e+6-2.5,",-3.5\n    h-5\n    v7\n    h5\n    Z\n  "):"\n    M".concat(e,",6L").concat(e-3.5,",2.5\n    v-5\n    h7\n    v5\n    Z\n")}gO.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{fill:null,lineWidth:4,stroke:"#fff",outerBorder:{distance:2,lineWidth:1,stroke:"#ccc"}},tooltip:{shapeStyle:{lineWidth:4,stroke:"#fff"}}},lO(),sO(),tC();var mO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="sizeLegend",a._onSliderChange=function(t){a.dispatchEvent(t)},a._onSliderToolipChange=function(t){a.dispatchEvent(t)},a}return h(e,t),o(e,[{key:"setSelected",value:function(t){this._slider&&this._slider.setValue(t)}},{key:"_renderContent",value:function(){var t=this.attribute,e=t.slidable,i=t.layout,n=t.align,r=t.min,a=t.max,o=t.value,s=t.railWidth,l=t.railHeight,u=t.showHandler,c=void 0===u||u,h=t.handlerSize,d=t.handlerStyle,p=t.railStyle,f=t.trackStyle,v=t.startText,g=t.endText,y=t.handlerText,m=t.showTooltip,_=t.tooltip,b=t.sizeBackground,x=t.disableTriggerEvent,k=t.inverse,S=kg.group({x:0,y:0});this._innerView.add(S);var A=new vO({x:0,y:0,zIndex:1,range:{draggableTrack:!0},slidable:e,layout:i,align:n,min:r,max:a,value:o,railWidth:s,railHeight:l,showHandler:c,handlerSize:h,handlerStyle:Object.assign({symbolType:yO(n)},d),railStyle:p,trackStyle:f,startText:v,endText:g,handlerText:y,showTooltip:m,tooltip:_,disableTriggerEvent:x,inverse:k});S.add(A);var M,T=0;"horizontal"===i?"top"===n?(M="M0,0L".concat(s,",0L").concat(k?0:s,",12Z"),T=l):(M="M0,12L".concat(s,",12L").concat(k?0:s,",0Z"),A.setAttribute("y",12)):"left"===n?M="M".concat(s,",0L").concat(s+12,",").concat(k?0:l,"L").concat(s,",").concat(l,"Z"):(M="M0,".concat(k?0:l,"L12,").concat(l,"L12,0Z"),A.setAttribute("x",12));var w=kg.path(Object.assign(Object.assign({x:0,y:T,path:M},b),{zIndex:0}));S.add(w);var C=this._title?this._title.AABBBounds.height()+ut(this.attribute,"title.space",12):0;S.translate(0-S.AABBBounds.x1,C-S.AABBBounds.y1),this._slider=A}},{key:"_bindEvents",value:function(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}}])}(oO);mO.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{lineWidth:1,stroke:"#ccc",fill:"#fff"},sizeBackground:{fill:"rgba(20,20,20,0.1)"}},Kw(),dC(),oC();var _O=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="title",a}return h(e,t),o(e,[{key:"render",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b=this.attribute,x=b.textType,k=b.text,S=b.subtextType,A=b.textStyle,M=void 0===A?{}:A,T=b.subtext,w=b.subtextStyle,C=void 0===w?{}:w,E=b.width,P=b.height,B=b.minWidth,R=b.maxWidth,L=b.minHeight,I=b.maxHeight,D=b.align,O=b.verticalAlign,F=b.padding,z=Di(void 0===F?0:F),H=this.createOrUpdateChild("title-container",{x:z[3],y:z[0],zIndex:1},"group"),N=null!==(t=M.height)&&void 0!==t?t:P;if(!1!==this.attribute.visible&&!1!==M.visible){var V=M.width,j=M.maxHeight,W=M.maxWidth,G=M.x,Y=void 0===G?0:G,X=M.y,K=void 0===X?0:X,Z=M.ellipsis,J=void 0===Z||Z,Q=M.wordBreak,$=void 0===Q?"break-word":Q,tt=M.maxWidth,et=M.lineClamp;if("rich"===x||U(M.character)){var it=Object.assign({x:Y,y:K,width:null!==(e=null!=V?V:E)&&void 0!==e?e:0,height:null!=N?N:0,ellipsis:null==J||J,wordBreak:null!=$?$:"break-word",maxHeight:null!=j?j:I,maxWidth:null!=W?W:tt,textConfig:null!==(i=M.character)&&void 0!==i?i:k},M);this._mainTitle=H.createOrUpdateChild("mainTitle",it,"richtext")}else if("html"===x){var nt=Object.assign({html:Object.assign(Object.assign({dom:k},bC),M),x:Y,y:K,width:null!==(n=null!=V?V:E)&&void 0!==n?n:0,height:null!=N?N:0,ellipsis:J,wordBreak:$,maxHeight:null!=j?j:I,maxWidth:null!=W?W:tt,textConfig:[]},M);this._mainTitle=H.createOrUpdateChild("mainTitle",nt,"richtext")}else U(k)&&(this._mainTitle=H.createOrUpdateChild("mainTitle",Object.assign(Object.assign({text:q(k)?k:[k],whiteSpace:"normal"},M),{maxLineWidth:null!==(a=null!==(r=M.maxLineWidth)&&void 0!==r?r:V)&&void 0!==a?a:E,heightLimit:null!==(o=M.height)&&void 0!==o?o:I,lineClamp:et,ellipsis:J,x:Y,y:K}),"text"))}var rt=this._mainTitle?this._mainTitle.AABBBounds.height():0,at=this._mainTitle?this._mainTitle.AABBBounds.width():0;if(!1!==this.attribute.visible&&!1!==C.visible){var ot=C.width,st=C.height,lt=C.maxWidth,ut=C.maxHeight,ct=C.x,ht=void 0===ct?0:ct,dt=C.y,pt=void 0===dt?0:dt,ft=C.ellipsis,vt=void 0===ft||ft,gt=C.wordBreak,yt=void 0===gt?"break-word":gt,mt=C.lineClamp,_t=Math.max(Number.MIN_VALUE,I-rt);if("rich"===S||U(C.character)){var bt=Object.assign({x:ht,y:pt,width:null!==(s=null!=ot?ot:E)&&void 0!==s?s:0,height:null!==(l=null!=st?st:P)&&void 0!==l?l:0,ellipsis:vt,wordBreak:yt,maxHeight:null!=ut?ut:_t,maxWidth:null!=lt?lt:R,textConfig:null!==(u=C.character)&&void 0!==u?u:T},C);this._subTitle=H.createOrUpdateChild("subTitle",bt,"richtext")}else if("html"===S){var xt=Object.assign({html:Object.assign(Object.assign({dom:T},bC),C),x:ht,y:pt,width:null!==(c=null!=ot?ot:E)&&void 0!==c?c:0,height:null!==(h=null!=st?st:P)&&void 0!==h?h:0,ellipsis:vt,wordBreak:yt,maxHeight:null!=ut?ut:_t,maxWidth:null!=lt?lt:R,textConfig:[]},C);this._subTitle=H.createOrUpdateChild("subTitle",xt,"richtext")}else U(T)&&(this._subTitle=H.createOrUpdateChild("subTitle",Object.assign(Object.assign({text:q(T)?T:[T],whiteSpace:"normal"},C),{maxLineWidth:null!==(d=C.maxLineWidth)&&void 0!==d?d:E,heightLimit:null!==(p=C.heightLimit)&&void 0!==p?p:_t,lineClamp:mt,ellipsis:vt,x:0,y:rt}),"text"))}var kt=this._subTitle?this._subTitle.AABBBounds.height():0,St=this._subTitle?this._subTitle.AABBBounds.width():0,At=Math.max(at,St),Mt=rt+(null!==(f=C.height)&&void 0!==f?f:kt);if(U(E)&&(At=E),U(P)&&(Mt=P),U(B)&&At<B&&(At=B),U(R)&&At>R&&(At=R),U(L)&&Mt<L&&(Mt=L),U(I)&&Mt>I&&(Mt=I),H.attribute.width=At,H.attribute.height=Mt,H.attribute.boundsPadding=z,this._mainTitle){if(U(D)||U(M.align)){var Tt=M.align?M.align:D,wt=null!==(v=M.width)&&void 0!==v?v:At;"center"===Tt?(this._mainTitle.setAttribute("x",wt/2),this._mainTitle.setAttribute("textAlign","center")):"right"===Tt?(this._mainTitle.setAttribute("x",wt),this._mainTitle.setAttribute("textAlign","right")):(this._mainTitle.setAttribute("x",0),this._mainTitle.setAttribute("textAlign","left"))}var Ct=M.verticalAlign?M.verticalAlign:O,Et=null!=N?N:this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height();"middle"===Ct?(this._mainTitle.setAttribute("y",Et/2),this._mainTitle.setAttribute("textBaseline","middle")):"bottom"===Ct?(this._mainTitle.setAttribute("y",Et),this._mainTitle.setAttribute("textBaseline","bottom")):(this._mainTitle.setAttribute("y",0),this._mainTitle.setAttribute("textBaseline","top"))}if(this._subTitle){if(U(D)||U(C.align)){var Pt=C.align?C.align:D,Bt=null!==(y=null!==(g=C.width)&&void 0!==g?g:M.width)&&void 0!==y?y:At;"center"===Pt?(this._subTitle.setAttribute("x",Bt/2),this._subTitle.setAttribute("textAlign","center")):"right"===Pt?(this._subTitle.setAttribute("x",Bt),this._subTitle.setAttribute("textAlign","right")):(this._subTitle.setAttribute("x",0),this._subTitle.setAttribute("textAlign","left"))}var Rt=C.verticalAlign?C.verticalAlign:O,Lt=this._mainTitle?U(N)?this._mainTitle.AABBBounds.y1+Math.max(this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height(),N):this._mainTitle.AABBBounds.y2:0,It=null!==(_=null!==(m=C.height)&&void 0!==m?m:P)&&void 0!==_?_:this._subTitle.AABBBounds.empty()?0:this._subTitle.AABBBounds.height();"middle"===Rt?(this._subTitle.setAttribute("y",Lt+It/2),this._subTitle.setAttribute("textBaseline","middle")):"bottom"===Rt?(this._subTitle.setAttribute("y",Lt+It),this._subTitle.setAttribute("textBaseline","bottom")):(this._subTitle.setAttribute("y",Lt),this._subTitle.setAttribute("textBaseline","top"))}}}])}(Sx);_O.defaultAttributes={textStyle:{ellipsis:"...",fill:"#333",fontSize:20,fontWeight:"bold",textAlign:"left",textBaseline:"top"},subtextStyle:{ellipsis:"...",fill:"#6F6F6F",fontSize:16,fontWeight:"normal",textAlign:"left",textBaseline:"top"}};var bO={title:{style:{text:"",fontSize:20,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}},content:{style:{text:"",fontSize:16,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}}};Kw(),dC(),oC();var xO,kO,SO=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="indicator",t}return h(e,t),o(e,[{key:"_renderText",value:function(t,e,i,n,r,a){if(!1!==e.visible){var o=gt({},ut(bO,r),e.style,{visible:e.visible});o.lineHeight=U(o.lineHeight)?o.lineHeight:o.fontSize,e.formatMethod&&(o._originText=o.text,o.text=e.formatMethod(o.text,o));var s=XC(o);return s.name=a,t.appendChild(s),e.autoFit&&et(i)&&this._setLocalAutoFit(i,s,e),e.autoLimit&&et(n)&&s.setAttribute("maxLineWidth",i),s}}},{key:"render",value:function(){var t,e,i=this;if(this.removeAllChild(!0),!0===this.attribute.visible){var n=this.attribute,r=n.title,a=void 0===r?{}:r,o=n.content,s=n.size,l=n.limitRatio,u=void 0===l?1/0:l,c=Math.min(s.width,s.height)*u,h=this.createOrUpdateChild("indicator-container",{x:0,y:0,zIndex:1,pickable:null===(t=this.attribute.pickable)||void 0===t||t},"group");if(U(a)&&(this._title=this._renderText(h,a,c,u,"title.style","indicator-title")),U(o)){var d=St(o),p=[];d.forEach((function(t,e){!1!==t.visible&&p.push(i._renderText(h,t,c,u,"content.style","indicator-content-"+e))})),this._content=p}this._setGlobalAutoFit(c),this._setYPosition();var f=null!==(e=null==h?void 0:h.AABBBounds.height())&&void 0!==e?e:0;h.setAttribute("y",s.height/2-f/2),h.setAttribute("x",s.width/2)}}},{key:"_setLocalAutoFit",value:function(t,e,i){var n,r,a,o,s,l,u,c,h;if("default"===(null!==(n=i.fitStrategy)&&void 0!==n?n:"default")){var d=WC(null!==(a=null===(r=i.style)||void 0===r?void 0:r.text)&&void 0!==a?a:"",null!==(o=i.style)&&void 0!==o?o:{},null===(l=null===(s=this.stage)||void 0===s?void 0:s.getTheme())||void 0===l?void 0:l.text).width;if(d>0){var p=t*(null!==(u=i.fitPercent)&&void 0!==u?u:.5)/d,f=Math.floor((null!==(h=null===(c=i.style)||void 0===c?void 0:c.fontSize)&&void 0!==h?h:20)*p);e.setAttribute("fontSize",f),e.setAttribute("lineHeight",U(i.style.lineHeight)?i.style.lineHeight:f)}}}},{key:"_setGlobalAutoFit",value:function(t){var e,i,n,r,a,o,s,l=this,u=t/2,c=[],h=0,d=null!==(e=this.attribute.title)&&void 0!==e?e:{};d.autoFit&&"inscribed"===d.fitStrategy?(this._title.setAttribute("fontSize",12),c.push({text:this._title,spec:null!==(i=this.attribute.title)&&void 0!==i?i:{}})):h+=null!==(o=null===(a=null===(r=null===(n=this._title)||void 0===n?void 0:n.AABBBounds)||void 0===r?void 0:r.height)||void 0===a?void 0:a.call(r))&&void 0!==o?o:0;var p=null!==(s=d.space)&&void 0!==s?s:0;if(h+=p,St(this.attribute.content).filter((function(t){return!1!==t.visible})).forEach((function(t,e){var i,n,r,a,o=l._content[e];t.autoFit&&"inscribed"===t.fitStrategy?(o.setAttribute("fontSize",12),c.push({text:o,spec:t})):h+=null!==(r=null===(n=null===(i=null==o?void 0:o.AABBBounds)||void 0===i?void 0:i.height)||void 0===n?void 0:n.call(i))&&void 0!==r?r:0;var s=null!==(a=t.space)&&void 0!==a?a:0;h+=s})),!(c.length<=0)){var f=12/c.reduce((function(t,e){return Math.max(t,e.text.AABBBounds.width())}),0)*c.length,v=h/2,g=Math.pow(f,2)+1,y=2*v*f,m=Math.pow(v,2)-Math.pow(u,2),_=2*(f*((-y+Math.sqrt(Math.pow(y,2)-4*g*m))/(2*g))+v),b=(_-h)/c.length;et(_)&&c.forEach((function(t){var e,i=null===(e=t.spec.style)||void 0===e?void 0:e.lineHeight;t.text.setAttribute("fontSize",b),t.text.setAttribute("lineHeight",U(i)?i:b)}))}}},{key:"_setYPosition",value:function(){var t,e,i,n,r,a,o=this,s=0,l=null!==(n=null===(i=null===(e=null===(t=this._title)||void 0===t?void 0:t.AABBBounds)||void 0===e?void 0:e.height)||void 0===i?void 0:i.call(e))&&void 0!==n?n:0,u=null!==(a=null===(r=this.attribute.title)||void 0===r?void 0:r.space)&&void 0!==a?a:0;St(this.attribute.content).filter((function(t){return!1!==t.visible})).forEach((function(t,e){var i,n=o._content[e];n.setAttribute("y",l+u+s);var r=null!==(i=t.space)&&void 0!==i?i:0;s+=n.AABBBounds.height()+r}))}}])}(Sx),AO=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e)}(Ov);!function(t){t.OnPlay="onPlay",t.OnPause="onPause",t.OnForward="onForward",t.OnBackward="onBackward"}(xO||(xO={})),function(t){t.Start="start",t.Pause="pause",t.Forward="forward",t.Backward="backward"}(kO||(kO={}));var MO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)]))._isPaused=!0,a.updateAttributes=function(){a._startAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -73.1429 161.4994 a 48.7619 48.7619 0 0 1 25.9901 7.5093 l 201.7524 127.1223 a 48.7619 48.7619 0 0 1 0.3657 82.2613 l -201.7524 129.6335 A 48.7619 48.7619 0 0 1 292.5952 540.1838 v -256.7314 a 48.7619 48.7619 0 0 1 48.7619 -48.7619 z m 24.381 92.9402 v 167.9116 l 131.9497 -84.7726 L 365.7381 327.6063 z"},e.defaultControllerAttr),{visible:a.attribute.start.visible}),a.attribute.start.style)},a._pauseAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -48.7619 195.0476 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z m 158.4762 0 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z"},e.defaultControllerAttr),{visible:a.attribute.pause.visible}),a.attribute.pause.style)},a._forwardAttr={style:Object.assign(Object.assign(Object.assign({},e.defaultControllerAttr),{visible:a.attribute.forward.visible}),a.attribute.forward.style)},a._backwardAttr={style:Object.assign(Object.assign(Object.assign({},e.defaultControllerAttr),{visible:a.attribute.backward.visible}),a.attribute.backward.style)},a.updateLayout()},a.updateLayout=function(){var t,e,i,n;a._layout=a.attribute.layout,"horizontal"===a._layout?(a._backwardAttr.style.symbolType=null!==(t=a._backwardAttr.style.symbolType)&&void 0!==t?t:"M 521.29 734.276 L 230.929 448.019 L 521.29 161.762 c 37.685 -37.153 38.003 -97.625 0.707 -134.384 c -37.297 -36.758 -98.646 -36.435 -136.331 0.718 l -357.43 352.378 c -0.155 0.153 -0.297 0.314 -0.451 0.468 c -0.084 0.082 -0.172 0.157 -0.256 0.239 c -18.357 18.092 -27.581 41.929 -27.743 65.902 c -0.004 0.311 -0.017 0.623 -0.018 0.934 c 0.001 0.316 0.014 0.632 0.018 0.948 c 0.165 23.97 9.389 47.803 27.743 65.892 c 0.083 0.082 0.171 0.157 0.255 0.239 c 0.154 0.154 0.296 0.315 0.452 0.468 l 357.43 352.378 c 37.685 37.153 99.034 37.476 136.331 0.718 c 37.297 -36.758 36.979 -97.231 -0.707 -134.384 z",a._forwardAttr.style.symbolType=null!==(e=a._forwardAttr.style.symbolType)&&void 0!==e?e:"M 30 163 L 320.361 449.257 L 30 735.514 c -37.685 37.153 -38.003 97.625 -0.707 134.384 c 37.297 36.758 98.646 36.435 136.331 -0.718 l 357.43 -352.378 c 0.155 -0.153 0.297 -0.314 0.451 -0.468 c 0.084 -0.082 0.172 -0.157 0.256 -0.239 c 18.357 -18.092 27.581 -41.929 27.743 -65.902 c 0.004 -0.311 0.017 -0.623 0.018 -0.934 c -0.001 -0.316 -0.014 -0.632 -0.018 -0.948 c -0.165 -23.97 -9.389 -47.803 -27.743 -65.892 c -0.083 -0.082 -0.171 -0.157 -0.255 -0.239 c -0.154 -0.154 -0.296 -0.315 -0.452 -0.468 l -357.43 -352.378 c -37.685 -37.153 -99.034 -37.476 -136.331 -0.718 c -37.297 36.758 -36.979 97.231 0.707 134.384 z"):"vertical"===a._layout&&(a._backwardAttr.style.symbolType=null!==(i=a._backwardAttr.style.symbolType)&&void 0!==i?i:"m 161.724 521.29 l 286.257 -290.361 l 286.257 290.361 c 37.153 37.685 97.625 38.003 134.384 0.707 c 36.758 -37.297 36.435 -98.646 -0.718 -136.331 l -352.378 -357.43 c -0.153 -0.155 -0.314 -0.297 -0.468 -0.451 c -0.082 -0.084 -0.157 -0.172 -0.239 -0.256 c -18.092 -18.357 -41.929 -27.581 -65.902 -27.743 c -0.311 -0.004 -0.623 -0.017 -0.934 -0.018 c -0.316 0.001 -0.632 0.014 -0.948 0.018 c -23.97 0.165 -47.803 9.389 -65.892 27.743 c -0.082 0.083 -0.157 0.171 -0.239 0.255 c -0.154 0.154 -0.315 0.296 -0.468 0.452 l -352.378 357.43 c -37.153 37.685 -37.476 99.034 -0.718 136.331 c 36.758 37.297 97.231 36.979 134.384 -0.707 z",a._forwardAttr.style.symbolType=null!==(n=a._forwardAttr.style.symbolType)&&void 0!==n?n:"M 734.276 28.71 L 448.019 319.071 L 161.762 28.71 c -37.153 -37.685 -97.625 -38.003 -134.384 -0.707 c -36.758 37.297 -36.435 98.646 0.718 136.331 l 352.378 357.43 c 0.153 0.155 0.314 0.297 0.468 0.451 c 0.082 0.084 0.157 0.172 0.239 0.256 c 18.092 18.357 41.929 27.581 65.902 27.743 c 0.311 0.004 0.623 0.017 0.934 0.018 c 0.316 -0.001 0.632 -0.014 0.948 -0.018 c 23.97 -0.165 47.803 -9.389 65.892 -27.743 c 0.082 -0.083 0.157 -0.171 0.239 -0.255 c 0.154 -0.154 0.315 -0.296 0.468 -0.452 l 352.378 -357.43 c 37.153 -37.685 37.476 -99.034 0.718 -136.331 c -36.758 -37.297 -97.231 -36.979 -134.384 0.707 z")},a._initPlay=function(){j(a._playController)&&(a._playController=new AO(Object.assign({},a._startAttr.style)),a.add(a._playController))},a._initBackward=function(){j(a._backwardController)&&(a._backwardController=new AO(Object.assign({},a._backwardAttr.style)),a.add(a._backwardController))},a._initForward=function(){j(a._forwardController)&&(a._forwardController=new AO(Object.assign({},a._forwardAttr.style)),a.add(a._forwardController))},a._initEvents=function(){a.attribute.disableTriggerEvent||(a._playController.addEventListener("pointerdown",(function(t){t.stopPropagation(),!0===a._isPaused?a.play():a.pause()})),a._backwardController.addEventListener("pointerdown",(function(t){t.stopPropagation(),a.backward()})),a._forwardController.addEventListener("pointerdown",(function(t){t.stopPropagation(),a.forward()})))},a.renderPlay=function(){a._isPaused?a._playController.setAttributes(Object.assign({symbolType:a._playController.getComputedAttribute("symbolType")},a._startAttr.style)):a._playController.setAttributes(Object.assign({symbolType:a._playController.getComputedAttribute("symbolType")},a._pauseAttr.style))},a.renderBackward=function(){a._backwardController.setAttributes(a._backwardAttr.style)},a.renderForward=function(){a._forwardController.setAttributes(a._forwardAttr.style)},a.play=function(){a._dispatchEvent(xO.OnPlay)},a.pause=function(){a._dispatchEvent(xO.OnPause)},a.forward=function(){a._dispatchEvent(xO.OnForward)},a.backward=function(){a._dispatchEvent(xO.OnBackward)},a.togglePlay=function(){a._playController.setAttributes(a._startAttr.style),a._isPaused=!0},a.togglePause=function(){a._playController.setAttributes(a._pauseAttr.style),a._isPaused=!1},a.updateAttributes(),a._initPlay(),a._initBackward(),a._initForward(),a._initEvents(),a}return h(e,t),o(e,[{key:"render",value:function(){this.updateAttributes(),this.renderPlay(),this.renderBackward(),this.renderForward()}}])}(Sx);MO.defaultControllerAttr={visible:!0,x:0,y:0,size:20,fill:"#91caff",pickMode:"imprecise",cursor:"pointer"},MO.defaultAttributes=l(l(l(l({},kO.Start,{}),kO.Pause,{}),kO.Backward,{}),kO.Forward,{});var TO,wO,CO={visible:!0,style:{x:0,y:0,dx:0,dy:0,size:20},order:0,space:10},EO=[200,10];!function(t){t.Default="default",t.Reverse="reverse"}(TO||(TO={})),function(t){t.change="change",t.play="play",t.pause="pause",t.backward="backward",t.forward="forward",t.end="end",t.OnChange="change",t.OnPlay="play",t.OnPause="pause",t.OnBackward="backward",t.OnForward="forward",t.OnEnd="end"}(wO||(wO={}));var PO=function(t){var e=t.direction,i=t.maxIndex,n=t.minIndex,r=t.dataIndex;return function(t){var e=t.direction,i=t.maxIndex,n=t.dataIndex;return e===TO.Default&&n===i}({direction:e,maxIndex:i,dataIndex:r})||function(t){var e=t.direction,i=t.minIndex,n=t.dataIndex;return e===TO.Reverse&&n===i}({direction:e,minIndex:n,dataIndex:r})},BO=function(t){var e=t.direction,i=t.maxIndex,n=t.minIndex,r=t.dataIndex;return function(t){var e=t.direction,i=t.minIndex,n=t.dataIndex;return e===TO.Default&&n===i}({direction:e,minIndex:n,dataIndex:r})||function(t){var e=t.direction,i=t.maxIndex,n=t.dataIndex;return e===TO.Reverse&&n===i}({direction:e,maxIndex:i,dataIndex:r})},RO=function(t){return"top"===t||"bottom"===t},LO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)]))._data=[],a._dataIndex=0,a._layoutInfo={},a._updateSliderAttrs=function(){var t,e,i;et(a._handlerStyle.size)?i=a._handlerStyle.size:a._handlerStyle.size&&a._handlerStyle.size.length&&(i=ke(a._handlerStyle.size[0],a._handlerStyle.size[1]));var n={visible:a._sliderVisible,min:a._minIndex,max:a._maxIndex,value:a._dataIndex,railWidth:a._railStyle.width,railHeight:a._railStyle.height,railStyle:a._railStyle,trackStyle:a._trackStyle,handlerSize:et(i)?i:void 0,handlerStyle:a._handlerStyle,dy:a.attribute.slider.dy,dx:a.attribute.slider.dx,slidable:!0,range:!1,handlerText:{visible:!1},startText:{visible:!1},endText:{visible:!1},disableTriggerEvent:a.attribute.disableTriggerEvent};if(RO(a._orient)){var r=Math.max(0,a._layoutInfo.slider.size),o=null!==(t=a._railStyle.height)&&void 0!==t?t:EO[1];n.layout="horizontal",n.railHeight=o,n.railWidth=r,n.x=a._layoutInfo.slider.x,n.y=a._layoutInfo.slider.y}else{var s=Math.max(0,a._layoutInfo.slider.size),l=null!==(e=a._railStyle.width)&&void 0!==e?e:EO[1];n.layout="vertical",n.railWidth=l,n.railHeight=s,n.x=a._layoutInfo.slider.x,n.y=a._layoutInfo.slider.y}return n},a._initSlider=function(){var t=a._updateSliderAttrs();a._slider=new vO(t),a._sliderVisible&&a.add(a._slider)},a._updateControllerAttrs=function(){var t={start:a._start,pause:a._pause,forward:a._forward,backward:a._backward,disableTriggerEvent:a.attribute.disableTriggerEvent};return t.layout=RO(a._orient)?"horizontal":"vertical",t.start=Object.assign(Object.assign({},t.start),{style:Object.assign(Object.assign({},t.start.style),{x:a._layoutInfo.start.x,y:a._layoutInfo.start.y})}),t.pause=Object.assign(Object.assign({},t.pause),{style:Object.assign(Object.assign({},t.pause.style),{x:a._layoutInfo.start.x,y:a._layoutInfo.start.y})}),t.backward=Object.assign(Object.assign({},t.backward),{style:Object.assign(Object.assign({},t.backward.style),{x:a._layoutInfo.backward.x,y:a._layoutInfo.backward.y})}),t.forward=Object.assign(Object.assign({},t.forward),{style:Object.assign(Object.assign({},t.forward.style),{x:a._layoutInfo.forward.x,y:a._layoutInfo.forward.y})}),t},a._initController=function(){var t=a._updateControllerAttrs();a._controller=new MO(t),a._controllerVisible&&a.add(a._controller)},a._initAttributes(),a._initDataIndex(),a._initLayoutInfo(),a._initController(),a._initSlider(),a}return h(e,t),o(e,[{key:"getMinIndex",value:function(){return this._minIndex}},{key:"getMaxIndex",value:function(){return this._maxIndex}},{key:"getDataIndex",value:function(){return this._dataIndex}},{key:"_initAttributes",value:function(){this._size=this.attribute.size,this._orient=this.attribute.orient,this._data=this.attribute.data,this._minIndex=0,this._maxIndex=this._data.length-1;var t=this.attribute,e=t.slider,i=void 0===e?{}:e,n=t.controller,r=void 0===n?{}:n;this._sliderVisible=i.visible,this._railStyle=Object.assign({},i.railStyle),this._trackStyle=Object.assign({},i.trackStyle),this._handlerStyle=Object.assign({},i.handlerStyle),this._controllerVisible=r.visible,this._start=Object.assign({},r.start),this._pause=Object.assign({},r.pause),this._forward=Object.assign({},r.forward),this._backward=Object.assign({},r.backward)}},{key:"_initDataIndex",value:function(){var t;this._dataIndex=null!==(t=this.attribute.dataIndex)&&void 0!==t?t:0}},{key:"_initLayoutInfo",value:function(){var t,e,i,n=this,r=[this._start,this._backward,this._forward].sort((function(t,e){return t.order-e.order})),a=r.filter((function(t){return"end"!==t.position})),o=r.filter((function(t){return"end"===t.position})),s=null!==(t=RO(this._orient)?this._railStyle.height:this._railStyle.width)&&void 0!==t?t:EO[1],l=r.reduce((function(t,e){var i=e.style.size,n=Q(i)?i:ke(i[0],i[1]);return t+e.space+n}),0),u=this._sliderVisible?(RO(this._orient)?null===(e=this._size)||void 0===e?void 0:e.width:null===(i=this._size)||void 0===i?void 0:i.height)-l:0,c=u-this.attribute.slider.space,h=a.reduce((function(t,e){var i=e.key,r=e.space,a=e.style.size,o=Q(a)?a:ke(a[0],a[1]);return n._layoutInfo[i]=Object.assign(Object.assign({},n._layoutInfo[i]),{size:o,x:RO(n._orient)?t+r:(n._size.width-o)/2,y:RO(n._orient)?(n._size.height-o)/2:t+r}),t+r+o}),0);this._layoutInfo.slider=Object.assign(Object.assign({},this._layoutInfo.slider),{size:c,x:RO(this._orient)?h+this.attribute.slider.space:(this._size.width-s)/2,y:RO(this._orient)?(this._size.height-s)/2:h+this.attribute.slider.space}),o.reduce((function(t,e){var i=e.key,r=e.space,a=e.style.size,o=Q(a)?a:ke(a[0],a[1]);return n._layoutInfo[i]=Object.assign(Object.assign({},n._layoutInfo[i]),{size:o,x:RO(n._orient)?t+r:(n._size.width-o)/2,y:RO(n._orient)?(n._size.height-o)/2:t+r}),t+r+o}),h+u)}},{key:"render",value:function(){this._initLayoutInfo(),this.renderSlider(),this.renderController()}},{key:"renderSlider",value:function(){var t=this._updateSliderAttrs();this._slider.setAttributes(t)}},{key:"renderController",value:function(){var t=this._updateControllerAttrs();this._controller.setAttributes(t)}},{key:"dispatchCustomEvent",value:function(t,e){this._dispatchEvent(t,{eventType:t,index:e,value:this._data[e]})}}])}(Sx);function IO(){sO(),Kw(),cC()}LO.defaultAttributes={visible:!0,data:[],interval:1e3,orient:"bottom",align:"center",size:{height:20,width:300},slider:{visible:!0,space:10,dx:0,dy:0,railStyle:{cornerRadius:5},trackStyle:{},handlerStyle:{}},controller:{visible:!0,start:Object.assign(Object.assign({},CO),{key:"start",position:"start",space:0}),pause:Object.assign(Object.assign({},CO),{key:"pause",position:"start"}),forward:Object.assign(Object.assign({},CO),{key:"forward",position:"end"}),backward:Object.assign(Object.assign({},CO),{key:"backward",position:"start"})}},IO();var DO=function(t){function e(t,a){var o;return r(this,e),(o=n(this,e,[(null==a?void 0:a.skipDefault)?t:gt({},t)]))._activeIndex=-1,o._isReachEnd=!1,o._initAttributes=function(){var t,n,r;_((i(o),e),"_initAttributes",o,3)([]),o._alternate=null!==(t=o.attribute.alternate)&&void 0!==t&&t,o._interval=null!==(n=o.attribute.interval)&&void 0!==n?n:1e3,o._direction=null!==(r=o.attribute.direction)&&void 0!==r?r:TO.Default},o._initDataIndex=function(){var t;o._dataIndex=j(o.attribute.dataIndex)?"default"===o._direction?o._minIndex:o._maxIndex:null!==(t=o.attribute.dataIndex)&&void 0!==t?t:0,o._slider.setAttribute("value",o._dataIndex)},o._initEvents=function(){o.attribute.disableTriggerEvent||(o._controller.addEventListener(xO.OnPlay,(function(t){t.stopPropagation(),o.play()})),o._controller.addEventListener(xO.OnPause,(function(t){t.stopPropagation(),o.pause()})),o._controller.addEventListener(xO.OnForward,(function(t){t.stopPropagation(),o.forward()})),o._controller.addEventListener(xO.OnBackward,(function(t){t.stopPropagation(),o.backward()})),o._slider.addEventListener("change",(function(t){var e=Math.floor(t.detail.value)+.5;o._dataIndex=t.detail.value>=e?Math.ceil(t.detail.value):Math.floor(t.detail.value),o._slider.setValue(o._dataIndex),o.dispatchCustomEvent(wO.change)})))},o.play=function(){o._isPlaying||1!==o._data.length&&(o._controller.togglePause(),o._isPlaying=!0,(PO({dataIndex:o._dataIndex,maxIndex:o._maxIndex,minIndex:o._minIndex,direction:o._direction})||BO({dataIndex:o._dataIndex,maxIndex:o._maxIndex,minIndex:o._minIndex,direction:o._direction}))&&(o._direction===TO.Default?o._updateDataIndex(o._minIndex):o._updateDataIndex(o._maxIndex)),o.dispatchCustomEvent(wO.play),o._isReachEnd=!1,o._tickTime=Date.now(),o._rafId=j_.getRequestAnimationFrame()(o._play.bind(i(o),!0)))},o._play=function(t){var e=Date.now();if(o._isReachEnd&&e-o._tickTime>=o._interval)return o._isReachEnd=!1,void o._playEnd();t&&o._activeIndex!==o._dataIndex?(o.dispatchCustomEvent(wO.change),o._activeIndex=o._dataIndex):e-o._tickTime>=o._interval&&(o._tickTime=e,o._updateDataIndex(function(t,e,i,n){return"default"===t?Math.min(e+1,n):Math.max(e-1,i)}(o._direction,o._dataIndex,o._minIndex,o._maxIndex)),o._activeIndex=o._dataIndex,o.dispatchCustomEvent(wO.change)),("default"===o._direction&&o._dataIndex>=o._maxIndex||"reverse"===o._direction&&o._dataIndex<=o._minIndex)&&(o._isReachEnd=!0),o._rafId=j_.getRequestAnimationFrame()(o._play.bind(i(o),!1))},o._updateDataIndex=function(t){o._dataIndex=t,o._slider.setValue(o._dataIndex)},o._playEnd=function(){o._isPlaying=!1,o._controller.togglePlay(),j_.getCancelAnimationFrame()(o._rafId),o._activeIndex=-1,o.dispatchCustomEvent(wO.end)},o.pause=function(){o._isPlaying&&(o._isPlaying=!1,j_.getCancelAnimationFrame()(o._rafId),o._controller.togglePlay(),o.dispatchCustomEvent(wO.pause))},o.backward=function(){var t,e=o.attribute.loop;t=void 0!==e&&e?o._dataIndex-1<o._minIndex?o._maxIndex:o._dataIndex-1:Math.max(o._dataIndex-1,o._minIndex),o._updateDataIndex(t),o.dispatchCustomEvent(wO.change),o.dispatchCustomEvent(wO.backward)},o.forward=function(){var t,e=o.attribute.loop;t=void 0!==e&&e?o._dataIndex+1>o._maxIndex?o._minIndex:o._dataIndex+1:Math.min(o._dataIndex+1,o._maxIndex),o._updateDataIndex(t),o.dispatchCustomEvent(wO.change),o.dispatchCustomEvent(wO.forward)},o._initAttributes(),o._initDataIndex(),o._initEvents(),o}return h(e,t),o(e,[{key:"setAttributes",value:function(t,i){_(e,"setAttributes",this,3)([t,i]),this._initAttributes()}},{key:"dispatchCustomEvent",value:function(t){_(e,"dispatchCustomEvent",this,3)([t,this._dataIndex])}}])}(LO),OO=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};IO();var FO,zO=function(t){function e(t){var a;return r(this,e),(a=n(this,e,[t]))._isPlaying=!1,a._startTime=Date.now(),a._initAttributes=function(){var t;_((i(a),e),"_initAttributes",a,3)([]),a._maxIndex=a._data.length,a._slider.setAttribute("max",a._maxIndex),a._isPlaying=!1,a._elapsed=0,a._interval=null!==(t=a.attribute.interval)&&void 0!==t?t:1e3;var n=a._data.length;a.attribute.totalDuration&&a._data.length?(a._totalDuration=a.attribute.totalDuration,a._interval=a._totalDuration/(null!=n?n:1)):(a._totalDuration=a._interval*n,a._interval=a.attribute.interval)},a._initDataIndex=function(){var t;a._dataIndex=null!==(t=a.attribute.dataIndex)&&void 0!==t?t:a._minIndex},a._initEvents=function(){a.attribute.disableTriggerEvent||(a._controller.addEventListener(xO.OnPlay,(function(t){t.stopPropagation(),a.play()})),a._controller.addEventListener(xO.OnPause,(function(t){t.stopPropagation(),a.pause()})),a._controller.addEventListener(xO.OnForward,(function(t){t.stopPropagation(),a.forward()})),a._controller.addEventListener(xO.OnBackward,(function(t){t.stopPropagation(),a.backward()})),a._slider.addEventListener("change",(function(t){var e;t.stopPropagation();var i=null===(e=t.detail)||void 0===e?void 0:e.value,n=i/a._maxIndex;a._elapsed=n*a._totalDuration,a._startTime=Date.now()-a._elapsed,a._dispatchChange(i)})))},a._getSliderValue=function(){var t=a._elapsed/a._totalDuration;return Math.min(t*a._maxIndex,a._maxIndex)},a._updateSlider=function(){var t=a._getSliderValue();a._dataIndex=Math.floor(t),a._slider.setValue(Math.min(t,a._maxIndex)),a._dispatchChange(Math.floor(t))},a._dispatchChange=function(t){var e=Math.floor(t);e!==a._activeIndex&&(a._dataIndex=e,a._activeIndex=e,e!==a._maxIndex&&a.dispatchCustomEvent(wO.change))},a.play=function(){return OO(i(a),void 0,void 0,f().m((function t(){return f().w((function(t){for(;;)switch(t.n){case 0:this._isPlaying||(this._controller.togglePause(),this._isPlaying=!0,this._elapsed>=this._totalDuration&&(this._elapsed=0),this._startTime=Date.now()-this._elapsed,this.dispatchCustomEvent(wO.play),this._rafId=j_.getRequestAnimationFrame()(this._play.bind(this)));case 1:return t.a(2)}}),t,this)})))},a._play=function(){a._elapsed=Date.now()-a._startTime;var t=a._getSliderValue();a._updateSlider(),t>=a._maxIndex?a._playEnd():a._rafId=j_.getRequestAnimationFrame()(a._play.bind(i(a)))},a._playEnd=function(){a._isPlaying=!1,j_.getCancelAnimationFrame()(a._rafId),a._controller.togglePlay(),a.dispatchCustomEvent(wO.end)},a.pause=function(){a._isPlaying&&(a._isPlaying=!1,a._elapsed=Date.now()-a._startTime,j_.getCancelAnimationFrame()(a._rafId),a._controller.togglePlay(),a.dispatchCustomEvent(wO.pause))},a.backward=function(){var t=Date.now(),e=1*a._interval,i=a._elapsed-e;i<=0?(a._elapsed=0,a._startTime=t):(a._elapsed=i,a._startTime=a._startTime+a._interval),a._updateSlider(),a.dispatchCustomEvent(wO.backward)},a.forward=function(){var t=Date.now(),e=1*a._interval,i=a._elapsed+e;i>=a._totalDuration?(a._startTime=t-a._totalDuration,a._elapsed=a._totalDuration):(a._startTime=a._startTime-e,a._elapsed=i),a._updateSlider(),a.dispatchCustomEvent(wO.forward)},a._initAttributes(),a._initDataIndex(),a._initEvents(),a}return h(e,t),o(e,[{key:"dispatchCustomEvent",value:function(t){_(e,"dispatchCustomEvent",this,3)([t,this._dataIndex])}},{key:"render",value:function(){_(e,"render",this,3)([])}}])}(LO);!function(t){t.drawStart="drawStart",t.drawEnd="drawEnd",t.drawing="drawing",t.moving="moving",t.moveStart="moveStart",t.moveEnd="moveEnd",t.brushActive="brushActive",t.brushClear="brushClear"}(FO||(FO={}));var HO={trigger:"pointerdown",updateTrigger:"pointermove",endTrigger:["pointerup","pointerleave"],resetTrigger:"pointerupoutside",hasMask:!0,brushMode:"single",brushType:"rect",brushStyle:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",strokeWidth:2},brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:10,interactiveRange:{minY:-1/0,maxY:1/0,minX:-1/0,maxX:1/0}};var NO={debounce:Jt,throttle:Qt};Kw(),iC();var VO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t)])).name="brush",a._activeBrushState=!1,a._activeDrawState=!1,a._cacheDrawPoints=[],a._activeMoveState=!1,a._operatingMaskMoveDx=0,a._operatingMaskMoveDy=0,a._operatingMaskMoveRangeX=[-1/0,1/0],a._operatingMaskMoveRangeY=[-1/0,1/0],a._brushMaskAABBBoundsDict={},a._firstUpdate=!0,a._onBrushStart=function(t){var e=a.attribute,i=e.updateTrigger,n=void 0===i?HO.updateTrigger:i,r=e.endTrigger,o=void 0===r?HO.endTrigger:r,s=e.brushMoved,l=void 0===s||s;St(n).forEach((function(t){return a.stage.addEventListener(t,a._onBrushingWithDelay)})),St(o).forEach((function(t){return a.stage.addEventListener(t,a._onBrushEnd)})),t.stopPropagation(),a._firstUpdate=!0,a._activeMoveState=l&&a._isPosInBrushMask(t),a._activeDrawState=!a._activeMoveState,a._startPos=a.eventPosToStagePos(t),a._cacheDrawPoints=[a._startPos]},a._onBrushing=function(t){a._outOfInteractiveRange(t)||(t.stopPropagation(),a._firstUpdate?(a._activeDrawState&&a._initDraw(t),a._activeMoveState&&a._initMove(t),a._firstUpdate=!1):(a._activeDrawState&&a._drawing(t),a._activeMoveState&&a._moving(t)))},a._onBrushingWithDelay=0===a.attribute.delayTime?a._onBrushing:NO[a.attribute.delayType](a._onBrushing,a.attribute.delayTime),a._onBrushEnd=function(t){a._releaseBrushUpdateEvents(),t.preventDefault(),a._activeDrawState&&a._drawEnd(t),a._activeMoveState&&a._moveEnd(t),a._activeDrawState=!1,a._activeMoveState=!1},a._onBrushClear=function(t){t.preventDefault(),a._isEmptyMask()||(a._clearMask(),a._dispatchBrushEvent(FO.brushClear,t)),a._activeDrawState=!1,a._activeMoveState=!1},a}return h(e,t),o(e,[{key:"_bindBrushEvents",value:function(){var t=this;if(this.releaseBrushEvents(),!this.attribute.disableTriggerEvent){var e=this.attribute,i=e.trigger,n=void 0===i?HO.trigger:i,r=e.resetTrigger,a=void 0===r?HO.resetTrigger:r;St(n).forEach((function(e){return t.stage.addEventListener(e,t._onBrushStart)})),St(a).forEach((function(e){return t.stage.addEventListener(e,t._onBrushClear)}))}}},{key:"_initDraw",value:function(t){var e=this.attribute.brushMode,i=this.eventPosToStagePos(t);this._cacheDrawPoints.push(i),"single"===e&&this._clearMask(),this._addBrushMask(),this._dispatchBrushEvent(FO.drawStart,t),this._activeBrushState=!1}},{key:"_initMove",value:function(t){var e,i;this._cacheMovePoint=this.eventPosToStagePos(t),this._operatingMaskMoveDx=null!==(e=this._operatingMask.attribute.dx)&&void 0!==e?e:0,this._operatingMaskMoveDy=null!==(i=this._operatingMask.attribute.dy)&&void 0!==i?i:0;var n=this.attribute.interactiveRange,r=n.minY,a=void 0===r?-1/0:r,o=n.maxY,s=void 0===o?1/0:o,l=n.minX,u=void 0===l?-1/0:l,c=n.maxX,h=void 0===c?1/0:c,d=this._operatingMask.globalAABBBounds,p=u-d.x1,f=h-d.x2,v=a-d.y1,g=s-d.y2;this._operatingMaskMoveRangeX=[p,f],this._operatingMaskMoveRangeY=[v,g],this._operatingMask.setAttribute("pickable",!0),this._dispatchBrushEvent(FO.moveStart,t)}},{key:"_drawing",value:function(t){var e,i=this.eventPosToStagePos(t),n=this.attribute,r=n.brushType,a=n.sizeThreshold,o=void 0===a?5:a,s=this._cacheDrawPoints.length;if(s>0){var l=null!==(e=this._cacheDrawPoints[this._cacheDrawPoints.length-1])&&void 0!==e?e:{};if(i.x===l.x&&i.y===l.y)return}"polygon"===r||s<=1?this._cacheDrawPoints.push(i):this._cacheDrawPoints[s-1]=i;var u=this._computeMaskPoints();this._operatingMask.setAttribute("points",u);var c=this._startPos,h=c.x,d=c.y,p=this.eventPosToStagePos(t),f=p.x,v=p.y;(Math.abs(f-h)>o||Math.abs(d-v)>o)&&(1!==Object.keys(this._brushMaskAABBBoundsDict).length||this._activeBrushState?this._dispatchBrushEvent(FO.drawing,t):(this._activeBrushState=!0,this._dispatchBrushEvent(FO.brushActive,t)))}},{key:"_moving",value:function(t){var e=this._cacheMovePoint,i=this.eventPosToStagePos(t);if(i.x!==(null==e?void 0:e.x)||i.y!==(null==e?void 0:e.y)){var n=i.x-e.x,r=i.y-e.y,a=Math.min(this._operatingMaskMoveRangeX[1],Math.max(this._operatingMaskMoveRangeX[0],n))+this._operatingMaskMoveDx,o=Math.min(this._operatingMaskMoveRangeY[1],Math.max(this._operatingMaskMoveRangeY[0],r))+this._operatingMaskMoveDy;this._operatingMask.setAttributes({dx:a,dy:o}),this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchBrushEvent(FO.moving,t)}}},{key:"_drawEnd",value:function(t){var e=this.attribute,i=e.removeOnClick,n=void 0===i||i,r=e.sizeThreshold,a=void 0===r?5:r;if(this._outOfInteractiveRange(t))this._isEmptyMask()||(this._clearMask(),this._dispatchBrushEvent(FO.brushClear,t));else{var o=this._startPos,s=o.x,l=o.y,u=this.eventPosToStagePos(t),c=u.x,h=u.y;Math.abs(c-s)<=1&&Math.abs(h-l)<=1&&n?this._isEmptyMask()||(this._clearMask(),this._dispatchBrushEvent(FO.brushClear,t)):Math.abs(c-s)<a&&Math.abs(l-h)<a?(delete this._brushMaskAABBBoundsDict[this._operatingMask.name],this._container.setAttributes({}),this._container.removeChild(this._operatingMask),this._isEmptyMask()&&this._dispatchBrushEvent(FO.brushClear,t)):(this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchBrushEvent(FO.drawEnd,t))}}},{key:"_moveEnd",value:function(t){this._operatingMask&&this._operatingMask.setAttribute("pickable",!1),this._dispatchBrushEvent(FO.moveEnd,t)}},{key:"render",value:function(){this._bindBrushEvents();var t=this.createOrUpdateChild("brush-container",{},"group");this._container=t}},{key:"releaseBrushEvents",value:function(){var t=this,e=this.attribute,i=e.trigger,n=void 0===i?HO.trigger:i,r=e.resetTrigger,a=void 0===r?HO.resetTrigger:r;St(n).forEach((function(e){return t.stage.removeEventListener(e,t._onBrushStart)})),St(a).forEach((function(e){return t.stage.removeEventListener(e,t._onBrushClear)})),this._releaseBrushUpdateEvents()}},{key:"_releaseBrushUpdateEvents",value:function(){var t=this,e=this.attribute,i=e.updateTrigger,n=void 0===i?HO.updateTrigger:i,r=e.endTrigger,a=void 0===r?HO.endTrigger:r;St(n).forEach((function(e){return t.stage.removeEventListener(e,t._onBrushingWithDelay)})),St(a).forEach((function(e){return t.stage.removeEventListener(e,t._onBrushEnd)}))}},{key:"_computeMaskPoints",value:function(){var t=this.attribute,e=t.brushType,i=t.xRange,n=void 0===i?[0,0]:i,r=t.yRange,a=void 0===r?[0,0]:r,o=this._cacheDrawPoints[0],s=this._cacheDrawPoints[this._cacheDrawPoints.length-1];return"rect"===e?[o,{x:s.x,y:o.y},s,{x:o.x,y:s.y}]:"x"===e?[{x:o.x,y:a[0]},{x:s.x,y:a[0]},{x:s.x,y:a[1]},{x:o.x,y:a[1]}]:"y"===e?[{x:n[0],y:o.y},{x:n[0],y:s.y},{x:n[1],y:s.y},{x:n[1],y:o.y}]:dt(this._cacheDrawPoints)}},{key:"_addBrushMask",value:function(){var t,e=this.attribute,i=e.brushStyle,n=e.hasMask,r=kg.polygon(Object.assign(Object.assign({points:dt(this._cacheDrawPoints),cursor:"move",pickable:!1},i),{opacity:n?null!==(t=i.opacity)&&void 0!==t?t:1:0}));r.name="brush-".concat(Date.now()),this._operatingMask=r,this._container.add(r),this._brushMaskAABBBoundsDict[r.name]=r.AABBBounds}},{key:"_isPosInBrushMask",value:function(t){for(var e,i=this,n=this.eventPosToStagePos(t),r=this._container.getChildren(),a=function(){var t=r[o].attribute,e=t.points,a=void 0===e?[]:e,s=t.dx,l=void 0===s?0:s,u=t.dy,c=void 0===u?0:u,h=a.map((function(t){return{x:t.x+l,y:t.y+c}}));if(li(h,n.x,n.y))return{v:(i._operatingMask=r[o],!0)}},o=0;o<r.length;o++)if(e=a())return e.v;return!1}},{key:"_outOfInteractiveRange",value:function(t){var e=this.attribute.interactiveRange,i=e.minY,n=void 0===i?-1/0:i,r=e.maxY,a=void 0===r?1/0:r,o=e.minX,s=void 0===o?-1/0:o,l=e.maxX,u=void 0===l?1/0:l,c=this.eventPosToStagePos(t);return c.x>u||c.x<s||c.y>a||c.y<n}},{key:"_dispatchBrushEvent",value:function(t,e){this._dispatchEvent(t,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:e})}},{key:"_clearMask",value:function(){this._brushMaskAABBBoundsDict={},this._container.removeAllChild(),this._operatingMask=null}},{key:"_isEmptyMask",value:function(){var t=this;return lt(this._brushMaskAABBBoundsDict)||Object.keys(this._brushMaskAABBBoundsDict).every((function(e){return t._brushMaskAABBBoundsDict[e].empty()}))}}])}(Sx);VO.defaultAttributes=HO;var jO=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];var r=[t.shape].concat(b(i.map((function(t){return null==t?void 0:t.shape})))),a=[t.key].concat(b(i.map((function(t){return null==t?void 0:t.key})))),o=[t.value].concat(b(i.map((function(t){return null==t?void 0:t.value}))));return gt.apply(void 0,[t].concat(i,[{shape:r.every(j)?void 0:gt.apply(void 0,[{}].concat(b(r))),key:a.every(j)?void 0:gt.apply(void 0,[{}].concat(b(a))),value:o.every(j)?void 0:gt.apply(void 0,[{}].concat(b(o)))}]))},UO=function(t){var e=t.width,i=t.height,n=t.wordBreak,r=void 0===n?"break-word":n,a=t.textAlign,o=t.textBaseline,s=t.text;return Array.isArray(s)?{width:e,height:i,wordBreak:r,textAlign:a,textBaseline:o,singleLine:!1,textConfig:St(s).map((function(e){return Object.assign(Object.assign({},t),{text:e})}))}:{width:e,height:i,wordBreak:r,textAlign:a,textBaseline:o,singleLine:!1,textConfig:null==s?void 0:s.text}},WO={panel:{visible:!0,cornerRadius:[3,3,3,3],fill:"white",shadow:!0,shadowBlur:12,shadowColor:"rgba(0, 0, 0, 0.1)",shadowOffsetX:0,shadowOffsetY:4,shadowSpread:0,stroke:"white"},titleStyle:{value:{fill:"#4E5969",fontFamily:mC,fontSize:14,lineHeight:18,textAlign:"left",textBaseline:"middle"},spaceRow:6},contentStyle:{shape:{fill:"black",size:8,symbolType:"circle",spacing:6},key:{fill:"#4E5969",fontFamily:mC,fontSize:12,lineHeight:18,textAlign:"left",textBaseline:"middle",spacing:26},value:{fill:"#4E5969",fontFamily:mC,fontSize:12,lineHeight:18,textAlign:"right",textBaseline:"middle",spacing:0},spaceRow:6},padding:10,positionX:"right",positionY:"bottom",offsetX:10,offsetY:10,parentBounds:(new _i).setValue(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),autoCalculatePosition:!0,autoMeasure:!0,pickable:!1,childrenPickable:!1,zIndex:500},GO=["pointerX","pointerY","offsetX","offsetY","positionX","positionY","parentBounds"];Kw(),rC(),cC(),dC(),oC();var YO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:gt({},e.defaultAttributes,t),i])).name="tooltip",a}return h(e,t),o(e,[{key:"render",value:function(){var t,i=this,n=this.attribute,r=n.visible,a=n.content,o=n.panel,s=n.keyWidth,l=n.valueWidth,u=n.hasContentShape,c=n.autoCalculatePosition,h=n.autoMeasure,d=n.align;if(r){h&&e.measureTooltip(this.attribute),c&&e.calculateTooltipPosition(this.attribute);var p=Di(this.attribute.padding);this._tooltipPanel=this.createOrUpdateChild("tooltip-background",Object.assign({visible:!0},o),"rect"),this._tooltipTitleContainer=this.createOrUpdateChild("tooltip-title",{visible:!0,x:p[3],y:p[0]},"group");var f=e.getTitleAttr(this.attribute);this._tooltipTitleSymbol=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-shape",gt({symbolType:"circle"},f.shape,{visible:PC(f)&&PC(f.shape)}),"symbol"),"object"!=k(f.value.text)||null===f.value.text||"rich"!==f.value.text.type&&"html"!==f.value.text.type?f.value.multiLine?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:PC(f)&&PC(f.value)},UO(f.value)),"richtext"):this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({text:null!==(t=f.value.text)&&void 0!==t?t:"",visible:PC(f)&&PC(f.value)},f.value),"text"):"rich"===f.value.text.type?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:PC(f)&&PC(f.value)},UO(f.value)),"richtext"):"html"===f.value.text.type&&(this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({html:Object.assign(Object.assign({dom:f.value.text.text},bC),f.value),visible:PC(f)&&PC(f.value),width:f.value.width,height:f.value.height,wordBreak:f.value.wordBreak,textAlign:f.value.textAlign,textBaseline:f.value.textBaseline,singleLine:!1,textConfig:[]},f.value),"richtext"));var v=PC(f.shape)?f.shape.size+f.shape.spacing:0,g=f.value,y=g.textAlign,m=g.textBaseline,_=o.width-p[3]-p[0]-v;"center"===y?this._tooltipTitle.setAttribute("x",v+_/2):"right"===y||"end"===y?this._tooltipTitle.setAttribute("x",v+_):this._tooltipTitle.setAttribute("x",v),"bottom"===m?this._tooltipTitle.setAttribute("y",f.height):"middle"===m?this._tooltipTitle.setAttribute("y",f.height/2):this._tooltipTitle.setAttribute("y",0);var b=PC(f)?f.height+f.spaceRow:0;if(this._tooltipContent=this.createOrUpdateChild("tooltip-content",{visible:!0},"group"),this._tooltipContent.removeAllChild(!0),a&&a.length){this._tooltipContent.setAttribute("x",p[3]),this._tooltipContent.setAttribute("y",p[0]+b);var x=0;a.forEach((function(t,n){var r=e.getContentAttr(i.attribute,n);if(PC(r)){var a="tooltip-content-".concat(n),o=i._tooltipContent.createOrUpdateChild(a,{visible:!0,x:0,y:x},"group"),c=r.shape.size+r.shape.spacing,h="right"===d?(u?c:0)+(PC(r.key)?s+r.key.spacing:0)+(PC(r.value)?l:0):0;i._createShape("right"===d?h-r.shape.size/2:h+r.shape.size/2,r,o,a),u&&("right"===d?h-=c:h+=c);var p=i._createKey(r,o,a);p&&(KC(d,p,r.key.textAlign,h,s),p.setAttribute("y",0),"right"===d?h-=s+r.key.spacing:h+=s+r.key.spacing);var f=i._createValue(r,o,a);if(f){var v="right";U(r.value.textAlign)?v=r.value.textAlign:PC(r.key)||"right"===d||(v="left"),f.setAttribute("textAlign",v),KC(d,f,v,h,l),f.setAttribute("y",0)}x+=r.height+r.spaceRow}}))}}else this.hideAll()}},{key:"_createShape",value:function(t,e,i,n){var r;if(PC(e.shape))return i.createOrUpdateChild("".concat(n,"-shape"),Object.assign({visible:!0,x:t,y:e.shape.size/2+((null!==(r=jh(e.key.lineHeight,e.key.fontSize))&&void 0!==r?r:e.key.fontSize)-e.shape.size)/2},e.shape),"symbol")}},{key:"_createKey",value:function(t,e,i){var n;if(PC(t.key))return t.key.multiLine?e.createOrUpdateChild("".concat(i,"-key"),Object.assign(Object.assign({visible:!0},UO(t.key)),{textBaseline:"top"}),"richtext"):"object"!=k(t.key.text)||null===t.key.text||"rich"!==t.key.text.type&&"html"!==t.key.text.type?e.createOrUpdateChild("".concat(i,"-key"),Object.assign(Object.assign({visible:!0,text:null!==(n=t.key.text)&&void 0!==n?n:""},t.key),{textBaseline:"top"}),"text"):"rich"===t.key.text.type?e.createOrUpdateChild("".concat(i,"-value"),Object.assign(Object.assign({visible:!0},UO(t.key)),{textBaseline:"top"}),"richtext"):e.createOrUpdateChild("".concat(i,"-value"),{html:Object.assign(Object.assign({dom:t.key.text.text},bC),t.key)},"richtext")}},{key:"_createValue",value:function(t,e,i){var n;if(PC(t.value))return t.value.multiLine?e.createOrUpdateChild("".concat(i,"-value"),Object.assign(Object.assign({visible:!0},UO(t.value)),{textBaseline:"top"}),"richtext"):"object"!=k(t.value.text)||null===t.value.text||"rich"!==t.value.text.type&&"html"!==t.value.text.type?e.createOrUpdateChild("".concat(i,"-value"),Object.assign(Object.assign({visible:!0,text:null!==(n=t.value.text)&&void 0!==n?n:""},t.value),{textBaseline:"top"}),"text"):"rich"===t.value.text.type?e.createOrUpdateChild("".concat(i,"-value"),Object.assign(Object.assign({visible:!0},UO(t.value)),{textBaseline:"top"}),"richtext"):e.createOrUpdateChild("".concat(i,"-value"),{html:Object.assign({dom:t.value.text.text,container:"",width:30,height:30,style:{}},t.value)},"richtext")}},{key:"setAttributes",value:function(t,i){var n=Object.keys(t);this.attribute.autoCalculatePosition&&n.every((function(t){return GO.includes(t)}))?(this._mergeAttributes(t,n),j(this.attribute.panel.width)&&this.attribute.autoMeasure&&e.measureTooltip(this.attribute),e.calculateTooltipPosition(this.attribute),_(e,"setAttributes",this,3)([{x:this.attribute.x,y:this.attribute.y},i])):_(e,"setAttributes",this,3)([t,i])}}],[{key:"calculateTooltipPosition",value:function(t){var e=t.panel,i=e.width,n=void 0===i?0:i,r=e.height,a=void 0===r?0:r,o=t.offsetX,s=t.offsetY,l=t.pointerX,u=t.pointerY,c=t.positionX,h=t.positionY,d=t.parentBounds,p=l,f=u;return"left"===c?p-=n+o:"center"===c?p-=n/2:p+=o,"top"===h?f-=a+s:"middle"===h?f-=a/2:f+=s,p+n>d.x2&&(p-=n+o),f+a>d.y2&&(f-=a+s),p<d.x1&&(p=d.x1),f<d.y1&&(f=d.y1),t.x=p,t.y=f,t}},{key:"measureTooltip",value:function(t){var i=t.content,n=t.contentStyle,r=Di(t.padding),a=e.getTitleAttr(t),o=0,s=r[0]+r[2],l=0,u=a.value,c=a.shape,h=null!=c?c:{},d=h.visible,p=void 0!==d&&d,f=h.symbolType,v=void 0===f?"":f;if(U(u)&&"object"!=k(a.value.text)){var g=UC(u).quickMeasure(u.text),y=g.width,_=g.height;o=y,l=_}if(p&&fp[v]&&(o+=c.size+c.spacing,l=Math.max(c.size,l)),t.title&&(t.title.width=o,t.title.height=l),PC(a)&&(s+=l+a.spaceRow),i&&i.length){var b=[];if(i.forEach((function(i,n){var r=e.getContentAttr(t,n);(i.key||i.value)&&PC(r)&&b.push([i,r])})),b.length){var x=!1,S=[],A=[],M=[];b.forEach((function(t,e){var i,r=m(t,2),a=r[0],o=r[1],l=o.key,u=o.value,c=o.shape,h=o.spaceRow,d=PC(c),p=null!==(i=null==c?void 0:c.symbolType)&&void 0!==i?i:"",f=UC(l),v=UC(u),g=0;if(PC(l)){var y=f.quickMeasure(l.text),_=y.width,k=y.height;A.push(_),g=Math.max(g,k)}if(PC(u)){var T=v.quickMeasure(u.text),w=T.width,C=T.height;M.push(w),g=Math.max(g,C)}d&&fp[p]&&(x=!0,S.push(c.size),g=Math.max(c.size,g)),a.height=g,s+=g,e<b.length-1&&(s+=null!=h?h:n.spaceRow)}));var T=S.length?Math.max.apply(Math,S):0,w=A.length?Math.max.apply(Math,A):0,C=M.length?Math.max.apply(Math,M):0;o=Math.max(w+C+n.key.spacing+n.value.spacing+(x?T+n.shape.spacing:0),o),i.forEach((function(t){t.width=o})),t.hasContentShape=x,t.keyWidth=w,t.valueWidth=C}}return t.panel.width=o+r[1]+r[3],t.panel.height=s,t}},{key:"getTitleAttr",value:function(t){return jO({},e.defaultAttributes.titleStyle,e.defaultAttributes.title,t.titleStyle,t.title)}},{key:"getContentAttr",value:function(t,i){return jO({},e.defaultAttributes.contentStyle,t.contentStyle,t.content[i])}}])}(Sx);YO.defaultAttributes=WO;var XO=Ut;function KO(t,e){var i=[];return t.forEach((function(t){var n=+t[e];et(n)&&i.push(n)})),0===i.length?null:Tt(i)}function qO(t,e){var i=[];return t.forEach((function(t){var n=+t[e];et(n)&&i.push(n)})),0===i.length?null:Mt(i)}function ZO(t,e){return t.reduce((function(t,i){var n=e?+i[e]:+i;return et(n)&&(t+=n),t}),0)}function JO(t,e){var i=0,n=0;return t.forEach((function(t){var r=e?+t[e]:+t;et(r)&&(i+=r,n++)})),i/n}function QO(t,e){var i=JO(t,e);if(t.length<=1)return 0;var n=t.reduce((function(t,n){return t+Math.pow(e?+n[e]:+n-i,2)}),0);return n/(t.length-1)}function $O(t,e){var i=tF(t),n=tF(e),r=Math.asin((t.x*e.y-e.x*t.y)/i/n),a=Math.acos((t.x*e.x+t.y*e.y)/i/n);return r<0?-a:a}function tF(t,e){return void 0===e&&(e={x:0,y:0}),Oe.distancePP(t,e)}function eF(t){return et(t.x)&&et(t.y)}function iF(t,e,i){var n,r,a,o,s=!1;if(e&&V(e))try{for(var l=P(t),u=l.next();!u.done;u=l.next()){var c=u.value;try{for(var h=(a=void 0,P(c.getSeries(i))),d=h.next();!d.done;d=h.next()){var p=d.value;if(s=!!e.call(null,p))return s}}catch(t){a={error:t}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(a)throw a.error}}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return s}function nF(t,e){var i,n,r,a,o=[];try{for(var s=P(t),l=s.next();!l.done;l=s.next()){var u=l.value;try{for(var c=(r=void 0,P(u.getSeries(e))),h=c.next();!h.done;h=c.next()){var d=h.value;o.push(d)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(a=c.return)&&a.call(c)}finally{if(r)throw r.error}}}}catch(t){i={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}var rF,aF,oF,sF=function(t,e){for(var i=0;i<t.length;i++)for(var n=t[i].getSeries(),r=0;r<n.length;r++){var a=n[r];if(e&&a&&a.coordinate===e)return a;if(!e&&a)return a}return null};function lF(t){return function(e){return q(t)?t.reduce((function(t,e){return null==t?void 0:t[e]}),e):null==e?void 0:e[t]}}function uF(t,e){if(void 0===e&&(e=!1),null===t||"object"!=typeof t)return t;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(void 0===t[i]){delete t[i];continue}e&&uF(t[i],e)}}function cF(e){var i,n;return e.type===t.SeriesTypeEnum.sankey?null!==(i=e.direction)&&void 0!==i?i:"horizontal":null!==(n=e.direction)&&void 0!==n?n:"vertical"}t.SeriesTypeForThemeEnum=void 0,(rF=t.SeriesTypeForThemeEnum||(t.SeriesTypeForThemeEnum={})).area_horizontal="area_horizontal",rF.area_vertical="area_vertical",rF.area_stack="area_stack",rF.line_horizontal="line_horizontal",rF.line_vertical="line_vertical",rF.line_stack="line_stack",rF.bar_horizontal="bar_horizontal",rF.bar_vertical="bar_vertical",rF.bar_stack="bar_stack",rF.rangeColumn_horizontal="rangeColumn_horizontal",rF.rangeColumn_vertical="rangeColumn_vertical",rF.rangeArea_horizontal="rangeArea_horizontal",rF.rangeArea_vertical="rangeArea_vertical",rF.linearProgress_horizontal="linearProgress_horizontal",rF.linearProgress_vertical="linearProgress_vertical",rF.linearProgress_stack="linearProgress_stack",rF.boxPlot_horizontal="boxPlot_horizontal",rF.boxPlot_vertical="boxPlot_vertical",rF.sankey_horizontal="sankey_horizontal",rF.sankey_vertical="sankey_vertical",rF.waterfall_horizontal="waterfall_horizontal",rF.waterfall_vertical="waterfall_vertical",rF.circularProgress_stack="circularProgress_stack",rF.radar_stack="radar_stack",rF.rose_stack="rose_stack",t.SeriesTypeEnum=void 0,(aF=t.SeriesTypeEnum||(t.SeriesTypeEnum={})).area="area",aF.line="line",aF.bar="bar",aF.rangeColumn="rangeColumn",aF.rangeArea="rangeArea",aF.dot="dot",aF.geo="geo",aF.link="link",aF.map="map",aF.pie="pie",aF.radar="radar",aF.rose="rose",aF.scatter="scatter",aF.circularProgress="circularProgress",aF.wordCloud="wordCloud",aF.funnel="funnel",aF.linearProgress="linearProgress",aF.boxPlot="boxPlot",aF.sankey="sankey",aF.gaugePointer="gaugePointer",aF.gauge="gauge",aF.treemap="treemap",aF.sunburst="sunburst",aF.circlePacking="circlePacking",aF.waterfall="waterfall",aF.heatmap="heatmap",aF.correlation="correlation",aF.liquid="liquid",aF.venn="venn",aF.mosaic="mosaic",aF.pictogram="pictogram",t.SeriesMarkNameEnum=void 0,(oF=t.SeriesMarkNameEnum||(t.SeriesMarkNameEnum={})).label="label",oF.point="point",oF.line="line",oF.area="area",oF.bar="bar",oF.boxPlot="boxPlot",oF.outlier="outlier",oF.circlePacking="circlePacking",oF.group="group",oF.gridBackground="gridBackground",oF.grid="grid",oF.dot="dot",oF.title="title",oF.subTitle="subTitle",oF.symbol="symbol",oF.funnel="funnel",oF.transform="transform",oF.transformLabel="transformLabel",oF.outerLabel="outerLabel",oF.outerLabelLine="outerLabelLine",oF.pin="pin",oF.pinBackground="pinBackground",oF.pointer="pointer",oF.segment="segment",oF.track="track",oF.cell="cell",oF.cellBackground="cellBackground",oF.link="link",oF.arrow="arrow",oF.pie="pie",oF.labelLine="labelLine",oF.progress="progress",oF.minLabel="minLabel",oF.maxLabel="maxLabel",oF.rose="rose",oF.node="node",oF.sunburst="sunburst",oF.nonLeaf="nonLeaf",oF.leaf="leaf",oF.nonLeafLabel="nonLeafLabel",oF.leaderLine="leaderLine",oF.stackLabel="stackLabel",oF.word="word",oF.fillingWord="fillingWord",oF.wordMask="wordMask",oF.nodePoint="nodePoint",oF.ripplePoint="ripplePoint",oF.centerPoint="centerPoint",oF.centerLabel="centerLabel",oF.barBackground="barBackground",oF.lineLabel="lineLabel",oF.areaLabel="areaLabel",oF.liquidGroup="liquidGroup",oF.liquid="liquid",oF.liquidBackground="liquidBackground",oF.liquidOutline="liquidOutline",oF.circle="circle",oF.overlap="overlap",oF.overlapLabel="overlapLabel";var hF={primaryFontColor:"titleFontColor",tertiaryFontColor:"labelFontColor",axisLabelFontColor:"axisFontColor",axisMarkerFontColor:"labelReverseFontColor",dataZoomHandleStrokeColor:"dataZoomHandlerStrokeColor",sliderHandleColor:"dataZoomHandlerFillColor",sliderRailColor:"dataZoomBackgroundColor",sliderTrackColor:"dataZoomSelectedColor",playerControllerColor:"dataZoomSelectedColor",popupBackgroundColor:"tooltipBackgroundColor",hoverBackgroundColor:"axisGridColor"},dF={titleFontColor:"primaryFontColor",labelFontColor:"tertiaryFontColor",axisFontColor:"axisLabelFontColor",labelReverseFontColor:"axisMarkerFontColor",dataZoomHandlerStrokeColor:"dataZoomHandleStrokeColor",dataZoomHandlerFillColor:"sliderHandleColor",dataZoomBackgroundColor:"sliderRailColor",dataZoomSelectedColor:"sliderTrackColor",tooltipBackgroundColor:"popupBackgroundColor"};function pF(t,e){var i;if(!t)return[];var n=bF(t,e);if(!n||q(n))return null!==(i=n)&&void 0!==i?i:[];if(W(n)){var r=n.dataScheme;return r?mF(r)?r.map((function(i){return T(T({},i),{scheme:i.scheme.map((function(i){return yF(i)?vF(t,i,e):i})).filter(U)})})):r.map((function(i){return yF(i)?vF(t,i,e):i})).filter(U):[]}return[]}function fF(t,e){var i,n;return mF(t)?null!==(n=null===(i=t.find((function(t){return U(t.isAvailable)?V(t.isAvailable)?t.isAvailable(e):!!t.isAvailable:!U(t.maxDomainLength)||(null==e?void 0:e.length)<=t.maxDomainLength})))||void 0===i?void 0:i.scheme)&&void 0!==n?n:t[t.length-1].scheme:t}function vF(t,e,i){var n,r=bF(t,i);if(r){var a,o=r.palette;if(W(o)&&(a=null!==(n=function(t,e){var i=hF[e];if(i&&t[i])return t[i];if(t[e])return t[e];var n=dF[e];return n?t[n]:void 0}(o,e.key))&&void 0!==n?n:e.default),a){if(j(e.a)&&j(e.l)||!K(a))return a;var s=new Li(a);if(U(e.l)){var l=s.color,u=Ai(l.r,l.g,l.b),c=Si(u.h,u.s,e.l),h=new Li("rgb(".concat(c.r,", ").concat(c.g,", ").concat(c.b,")"));h.setOpacity(s.color.opacity),s=h}return U(e.a)&&s.setOpacity(e.a),s.toRGBA()}}}var gF=function(t,e){if(e&&yF(t)){var i=vF(e,t);if(i)return i}return t};function yF(t){return t&&"palette"===t.type&&!!t.key}function mF(t){return!(!q(t)||0===t.length)&&t.every((function(t){return U(t.scheme)}))}function _F(t){return q(t)?{dataScheme:t}:t}function bF(t,e){var i,n,r,a=(null!=e?e:{}).type;if(!e||j(a))r=null==t?void 0:t.default;else{var o=cF(e);r=null!==(n=null!==(i=null==t?void 0:t["".concat(a,"_").concat(o)])&&void 0!==i?i:null==t?void 0:t[a])&&void 0!==n?n:null==t?void 0:t.default}return r}var xF=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.range=function(e){return e?(this._range=e,this._resetRange(),this):t.prototype.range.call(this)},e.prototype.domain=function(e){return e?(t.prototype.domain.call(this,e),this._resetRange(),this):t.prototype.domain.call(this)},e.prototype._resetRange=function(){if(mF(this._range)){var e=fF(this._range,this._domain);t.prototype.range.call(this,e)}else t.prototype.range.call(this,this._range)},e}(_L),kF={linear:UL,band:kL,point:KL,ordinal:_L,threshold:JL,colorOrdinal:xF};function SF(t){var e=kF[t];return e?new e:null}function AF(t,e){if("scale"in t&&t.scale)return K(t.scale)&&(null==e?void 0:e.globalScale)?e.globalScale.registerMarkAttributeScale(t,e.seriesId):t.scale;var i=SF(t.type);return i&&function(t,e){if(!t||!e)return;e.domain&&t.domain(e.domain);e.range&&t.range(e.range);e.specified&&t.specified&&t.specified(e.specified);e.clamp&&t.clamp&&t.clamp(e.clamp)}(i,t),i}function MF(t,e,i){if(!e)return t;var n=e.range(),r=i&&e._calculateWholeRange?e._calculateWholeRange(n):e.range(),a=Math.min(r[0],r[r.length-1]),o=Math.max(r[0],r[r.length-1]);return Math.min(Math.max(a,t),o)}function TF(t,e,i){if(!e)return!0;var n=e.range(),r=(i&&e._calculateWholeRange?e._calculateWholeRange(n):e.range()).map((function(t){return e.invert(t)})),a=Math.min(r[0],r[r.length-1]),o=Math.max(r[0],r[r.length-1]);return Array.isArray(t)?t.every((function(t){return t>=a&&t<=o})):t>=a&&t<=o}function wF(t){return U(null==t?void 0:t.field)&&U(null==t?void 0:t.scale)}function CF(t){switch(t){case"left":case"right":case"top":case"bottom":return!0;default:return!1}}function EF(t){return!!K(t)&&(!!t.endsWith("%")&&bx(t.substring(0,t.length-1)))}function PF(t){return!!W(t)&&("percent"in t||"offset"in t)}function BF(t,e,i,n){var r,a;return void 0===n&&(n=0),Q(t)?t:EF(t)?Number(t.substring(0,t.length-1))*e/100:V(t)?t(i):W(t)?e*(null!==(r=t.percent)&&void 0!==r?r:0)+(null!==(a=t.offset)&&void 0!==a?a:0):n}function RF(t,e,i){var n,r,a,o,s={top:0,bottom:0,left:0,right:0};return Object.values(t).every((function(t){return Q(t)}))?(s.top=null!==(n=t.top)&&void 0!==n?n:0,s.right=null!==(r=t.right)&&void 0!==r?r:0,s.bottom=null!==(a=t.bottom)&&void 0!==a?a:0,s.left=null!==(o=t.left)&&void 0!==o?o:0,s):([{orients:["left","right"],size:e.width},{orients:["top","bottom"],size:e.height}].forEach((function(e){e.orients.forEach((function(n){s[n]=BF(t[n],e.size,i)}))})),s)}function LF(t,e){return t?{width:Math.ceil(Math.min(t.x2-t.x1,e.width)),height:Math.ceil(Math.min(t.y2-t.y1,e.height))}:{width:0,height:0}}function IF(t){var e={};return q(t)?(j(t[0])||(e.top=e.left=e.bottom=e.right=t[0]),j(t[1])||(e.left=e.right=t[1]),j(t[2])||(e.bottom=t[2]),j(t[3])||(e.left=t[3]),e):Q(t)||EF(t)||V(t)||PF(t)?(e.top=e.left=e.bottom=e.right=t,e):W(t)?e=T({},t):e}function DF(t,e,i){return i?{x:t.x+e.x,y:t.y+e.y}:t}var OF=function(t,e){var i=Number(t),n=t.toString();return isNaN(i)&&"%"===n[n.length-1]?e*(Number(n.slice(0,n.length-1))/100):i},FF=[{maxDomainLength:10,scheme:["#1664FF","#1AC6FF","#FF8A00","#3CC780","#7442D4","#FFC400","#304D77","#B48DEB","#009488","#FF7DDA"]},{scheme:["#1664FF","#B2CFFF","#1AC6FF","#94EFFF","#FF8A00","#FFCE7A","#3CC780","#B9EDCD","#7442D4","#DDC5FA","#FFC400","#FAE878","#304D77","#8B959E","#B48DEB","#EFE3FF","#009488","#59BAA8","#FF7DDA","#FFCFEE"]}];function zF(t,e){return t&&e.key in t?t[e.key]:e.default}function HF(t){return t&&"token"===t.type&&!!t.key}var NF={fontFamily:"PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",fontSize:14,l1FontSize:32,l1LineHeight:"150%",l2FontSize:20,l2LineHeight:"140%",l3FontSize:16,l3LineHeight:"150%",l4FontSize:14,l4LineHeight:"150%",l5FontSize:12,l5LineHeight:"130%",l6FontSize:10,l6LineHeight:"120%"},VF={name:"light",background:{type:"palette",key:"backgroundColor"},padding:20,fontFamily:{type:"token",key:"fontFamily"},colorScheme:{default:{dataScheme:FF,palette:{backgroundColor:"#ffffff",borderColor:"#e3e5e8",shadowColor:"rgba(33,37,44,0.1)",hoverBackgroundColor:"#f1f2f5",sliderRailColor:"#f1f3f4",sliderHandleColor:"#ffffff",sliderTrackColor:"#0040ff",popupBackgroundColor:"#ffffff",primaryFontColor:"#21252c",secondaryFontColor:"#606773",tertiaryFontColor:"#89909d",axisLabelFontColor:"#89909d",disableFontColor:"#bcc1cb",axisMarkerFontColor:"#ffffff",axisGridColor:"#f1f2f5",axisDomainColor:"#d9dde4",dataZoomHandleStrokeColor:"#aeb5be",dataZoomChartColor:"#c9ced8",playerControllerColor:"#0040ff",scrollBarSliderColor:"rgba(0,0,0,0.3)",axisMarkerBackgroundColor:"#21252c",markLabelBackgroundColor:"#f1f2f5",markLineStrokeColor:"#606773",dangerColor:"#e33232",warningColor:"#ffc528",successColor:"#07a35a",infoColor:"#3073f2",discreteLegendPagerTextColor:"rgb(51, 51, 51)",discreteLegendPagerHandlerColor:"rgb(47, 69, 84)",discreteLegendPagerHandlerDisableColor:"rgb(170, 170, 170)",emptyCircleColor:"#e3e5e8",linearProgressTrackColor:"#E7EBED"}}},token:NF,component:{poptip:{visible:!0,position:"auto",padding:8,titleStyle:{fontSize:{type:"token",key:"l5FontSize"},fontWeight:"bold",fill:{type:"palette",key:"primaryFontColor"}},contentStyle:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"primaryFontColor"}},panel:{visible:!0,fill:{type:"palette",key:"popupBackgroundColor"},cornerRadius:3,lineWidth:0,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"},size:0,space:12}}},mark:{text:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1}}},markByName:{label:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1,lineJoin:"bevel"}},area:{style:{fillOpacity:.2}},line:{style:{lineWidth:2,lineCap:"round",lineJoin:"round"}},point:{style:{size:8,stroke:{type:"palette",key:"backgroundColor"},lineWidth:1,fillOpacity:1}},word:{style:{fontWeight:null,fontSize:null}},fillingWord:{style:{fontWeight:null,fontSize:null}},barBackground:{visible:!1,style:{fill:{type:"palette",key:"primaryFontColor",a:.06},stroke:"transparent"}}},animationThreshold:2e3},jF={name:"dark",colorScheme:{default:{dataScheme:FF,palette:{backgroundColor:"#202226",borderColor:"#404349",shadowColor:"rgba(0,0,0,0.1)",hoverBackgroundColor:"#404349",sliderRailColor:"#404349",sliderHandleColor:"#202226",sliderTrackColor:"#4284FF",popupBackgroundColor:"#404349",primaryFontColor:"#fdfdfd",secondaryFontColor:"#bbbdc3",tertiaryFontColor:"#888c93",axisLabelFontColor:"#888c93",disableFontColor:"#55595f",axisMarkerFontColor:"#202226",axisGridColor:"#404349",axisDomainColor:"#4b4f54",dataZoomHandleStrokeColor:"#bbbdc3",dataZoomChartColor:"#55595F",playerControllerColor:"#4284FF",scrollBarSliderColor:"rgba(255,255,255,0.3)",axisMarkerBackgroundColor:"#fdfdfd",markLabelBackgroundColor:"#404349",markLineStrokeColor:"#bbbdc3",dangerColor:"#eb4b4b",warningColor:"#f0bd30",successColor:"#14b267",infoColor:"#4284ff",discreteLegendPagerTextColor:"#BBBDC3",discreteLegendPagerHandlerColor:"#BBBDC3",discreteLegendPagerHandlerDisableColor:"#55595F",emptyCircleColor:"#bbbdc3",linearProgressTrackColor:"#404349"}}},component:{dataZoom:{selectedBackground:{style:{fillOpacity:.4,outerBorder:{strokeOpacity:.4}}}}}},UF=function(t,e){return t===e||!V(t)&&!V(e)&&(q(t)&&q(e)?e.every((function(e){return t.some((function(t){return UF(t,e)}))})):!(!W(t)||!W(e))&&Object.keys(e).every((function(i){return UF(t[i],e[i])})))},WF=function(t,e,i){if(j(e))return t;var n=e[0];return j(n)?t:1===e.length?(t[n]=i,t):(j(t[n])&&("number"==typeof e[1]?t[n]=[]:t[n]={}),WF(t[n],e.slice(1),i))},GF=function(t){return t instanceof hs||function(t){try{return t instanceof Element}catch(i){var e=Object.keys(t);return["children","innerHTML","classList","setAttribute","tagName","getBoundingClientRect"].every((function(t){return e.includes(t)}))}}(t)};function YF(t){return dt(t,GF,arguments.length>1&&void 0!==arguments[1]?arguments[1]:["data"])}function XF(t){for(var e=-1,i=arguments.length<=1?0:arguments.length-1;++e<i;){pt(t,e+1<1||arguments.length<=e+1?void 0:arguments[e+1],!0,!0)}return t}var KF=function(){function t(){}return t.registerChart=function(e,i){t._charts[e]=i},t.registerSeries=function(e,i){t._series[e]=i},t.registerComponent=function(e,i,n,r){t._components[e]={cmp:i,alwaysCheck:n,createOrder:null!=r?r:0}},t.registerGraphicComponent=function(e,i){t._graphicComponents[e]=i},t.createGraphicComponent=function(e,i,n){var r=t._graphicComponents[e];return r?r(i,n):null},t.registerMark=function(e,i){t._marks[e]=i},t.registerRegion=function(e,i){t._regions[e]=i},t.registerTransform=function(e,i){t.transforms[e]=i},t.registerGrammarTransform=function(e,i){t._grammarTransforms[e]=i},t.getGrammarTransform=function(e){return t._grammarTransforms[e]},t.registerLayout=function(e,i){t._layout[e]=i},t.registerAnimation=function(e,i){t._animations[e]=i},t.registerImplement=function(e,i){t._implements[e]=i},t.registerChartPlugin=function(e,i){t._chartPlugin[e]=i},t.registerVChartPlugin=function(e,i){t._vChartPlugin[e]=i},t.registerComponentPlugin=function(e,i){t._componentPlugin[e]=i},t.createChart=function(e,i,n){return t._charts[e]?new(0,t._charts[e])(i,n):null},t.getChart=function(e){return t._charts[e]},t.createChartSpecTransformer=function(e,i){if(!t._charts[e])return null;var n=t._charts[e];return new(0,n.transformerConstructor)(T({seriesType:n.seriesType},i))},t.createRegion=function(e,i,n){return t._regions[e]?new(0,t._regions[e])(i,n):null},t.createRegionSpecTransformer=function(e,i){return t._regions[e]?new(0,t._regions[e].transformerConstructor)(i):null},t.createSeries=function(e,i,n){return t._series[e]?new(0,t._series[e])(i,n):null},t.createSeriesSpecTransformer=function(e,i){return t._series[e]?new(0,t._series[e].transformerConstructor)(i):null},t.createMark=function(e,i,n){if(!t._marks[e])return null;var r=new(0,t._marks[e])(i,n);return"group"===r.type&&r.setMarkConfig({interactive:!1}),r},t.getComponents=function(){return Object.values(t._components)},t.getComponentInKey=function(e){return t._components[e].cmp},t.getLayout=function(){return Object.values(t._layout)},t.getLayoutInKey=function(e){return t._layout[e]},t.getSeries=function(){return Object.values(t._series)},t.getSeriesInType=function(e){return t._series[e]},t.getRegionInType=function(e){return t._regions[e]},t.getAnimationInKey=function(e){return t._animations[e]},t.getImplementInKey=function(e){return t._implements[e]},t.getSeriesMarkMap=function(e){return t._series[e]?t._series[e].mark:{}},t.getSeriesBuiltInTheme=function(e){for(var i in t._series){var n=t._series[i];if(n&&n.builtInTheme&&n.builtInTheme[e])return n.builtInTheme[e]}return null},t.getComponentBuiltInTheme=function(e){for(var i in t._components){var n=t._components[i];if(n&&n.cmp&&n.cmp.builtInTheme&&n.cmp.builtInTheme[e])return n.cmp.builtInTheme[e]}return null},t.getChartPlugins=function(){return Object.values(t._chartPlugin)},t.getVChartPlugins=function(){return Object.values(t._vChartPlugin)},t.getComponentPlugins=function(){return Object.values(t._componentPlugin)},t.getComponentPluginInType=function(e){return t._componentPlugin[e]},t.registerFormatter=function(t){this._formatter=t},t.getFormatter=function(){return this._formatter},t.createInteractionTrigger=function(e,i){var n=t._interactionTriggers[e];return n?new n(i):null},t.hasInteractionTrigger=function(e){return!!t._interactionTriggers[e]},t.getComposedEvent=function(e){return t._composedEventMap[e]},t._charts={},t._series={},t._components={},t._graphicComponents={},t._marks={},t._regions={},t._animations={},t._implements={},t._chartPlugin={},t._vChartPlugin={},t._componentPlugin={},t.transforms={fields:wo,filter:hn,fold:To},t.dataParser={csv:Ho,dsv:zo,tsv:No},t._layout={},t._grammarTransforms={},t._stageEventPlugins={},t.registerStageEventPlugin=function(e,i){t._stageEventPlugins[e]=i},t.getStageEventPlugin=function(e){return t._stageEventPlugins[e]},t._interactionTriggers={},t.registerInteractionTrigger=function(e,i){t._interactionTriggers[e]=i},t._composedEventMap={},t.registerComposedEvent=function(e,i){t._composedEventMap[e]=i},t._tooltipProcessors={},t.registerTooltipProcessor=function(e,i){t._tooltipProcessors[e]=i},t.createTooltipProcessor=function(e,i){var n=t._tooltipProcessors[e];return n?new n(i):null},t}();function qF(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return XF.apply(void 0,R([ZF(t)],B(e.map(ZF)),!1))}function ZF(t){var e;if(!t)return t;var i=function(t){t&&(t=Object.keys(t).reduce((function(e,i){var n=t[i];return e[i]=_F(n),e}),{}));return t}(t.colorScheme);return Object.assign({},t,{colorScheme:i,token:null!==(e=t.token)&&void 0!==e?e:{},series:Object.assign({},t.series)})}var JF,QF=function(t){var e={label:{style:{fill:"white",textBaseline:"middle",lineWidth:2}},outerLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"}},line:{style:{stroke:{type:"palette",key:"axisDomainColor"}}}},transformLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle"}}};return e[t?"transform3d":"transform"]={style:{fill:{type:"palette",key:"axisGridColor"}}},e},$F=QF(),tz=((JF={})[VF.name]=VF,JF),ez=VF.name,iz=new Map(Object.keys(tz).map((function(t){return[t,tz[t]]}))),nz=new Map,rz=new Map(Object.keys(tz).map((function(t){return[t,t===ez]}))),az=function(t,e){if(t){var i=uz(e);iz.set(t,i),rz.set(t,!0)}},oz=function(t){return void 0===t&&(t=ez),rz.has(t)&&!rz.get(t)&&az(t,iz.get(t)),iz.get(t)},sz=function(t){return iz.delete(t)&&nz.delete(t)&&rz.delete(t)},lz=function(t){return!!K(t)&&iz.has(t)},uz=function(t){var e,i=null!==(e=t.type)&&void 0!==e?e:ez;return qF({},oz(i),t)},cz=function(){function t(){}return t.registerInstance=function(e){t.instances.set(e.id,e)},t.unregisterInstance=function(e){t.instances.delete(e.id)},t.getInstance=function(e){return t.instances.get(e)},t.instanceExist=function(e){return t.instances.has(e)},t.forEach=function(e,i,n){void 0===i&&(i=[]);var r=St(i);return t.instances.forEach((function(t,i,n){r.includes(i)||e(t,i,n)}),n)},t.instances=new Map,t}(),hz=function(){function t(){}return t.registerTheme=function(t,e){az(t,e)},t.getTheme=function(t,e){return oz(t)},t.removeTheme=function(t){return sz(t)},t.themeExist=function(t){return lz(t)},t.getDefaultTheme=function(){return t.themes.get(ez)},t.setCurrentTheme=function(e){t.themeExist(e)&&(t._currentThemeName=e,cz.forEach((function(t){return null==t?void 0:t.setCurrentTheme(e)})))},t.getCurrentTheme=function(e){return void 0===e&&(e=!1),t.getTheme(t._currentThemeName,e)},t.getCurrentThemeName=function(){return t._currentThemeName},t.themes=iz,t._currentThemeName=ez,t}();function dz(t){return K(t)?hz.themeExist(t)?hz.getTheme(t):{}:W(t)?t:{}}var pz=["animationThreshold","colorScheme","name","padding"];function fz(t,e,i){if(!t)return t;e||(e=t.colorScheme),i||(i=t.token);var n={};return Object.keys(t).forEach((function(r){var a=t[r];pz.includes(r)?n[r]=a:Y(a)?yF(a)?n[r]=gF(a,e):HF(a)?n[r]=zF(i,a):n[r]=fz(a,e,i):n[r]=a})),n}function vz(t,e){if(void 0===e&&(e={data:function(t){return t}}),!t)return t;if(t.constructor===Object){var i={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e[n]){i[n]=e[n](t[n]);continue}i[n]=vz(t[n],e)}return i}return q(t)?t.map((function(t){return vz(t,e)})):t}function gz(t,e){if(!t)return t;if(Y(t)){var i={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(K(t[n])&&e.getFunction(t[n])){i[n]=e.getFunction(t[n]);continue}i[n]=gz(t[n],e)}return i}return q(t)?t.map((function(t){return gz(t,e)})):t}var yz=function(t,e,i,n){return function(t,e,i){return UC(t,e,i,{fontFamily:NF.fontFamily,fontSize:NF.fontSize})}(e,i,n).measure(t)},mz="__VCHART",_z=500,bz=500,xz="".concat(mz,"_MEASURE_CANVAS_ID"),kz="".concat(mz,"_DEFAULT_DATA_INDEX"),Sz="".concat(mz,"_DEFAULT_DATA_KEY"),Az="".concat(mz,"_DEFAULT_DATA_SERIES_FIELD"),Mz="".concat(mz,"_DEFAULT_SERIES_STYLE_NAME"),Tz="".concat(mz,"_STACK_KEY"),wz="".concat(mz,"_STACK_START"),Cz="".concat(mz,"_STACK_END"),Ez="".concat(mz,"_STACK_START_PERCENT"),Pz="".concat(mz,"_STACK_END_PERCENT"),Bz="".concat(mz,"_STACK_START_OffsetSilhouette"),Rz="".concat(mz,"_STACK_END_OffsetSilhouette"),Lz="".concat(mz,"_STACK_TOTAL"),Iz="".concat(mz,"_STACK_TOTAL_PERCENT"),Dz="".concat(mz,"_STACK_TOTAL_TOP"),Oz="".concat(mz,"_STACK_TOTAL_BOTTOM"),Fz="".concat(mz,"_MOSAIC_VALUE_START_PERCENT"),zz="".concat(mz,"_MOSAIC_VALUE_END_PERCENT"),Hz="".concat(mz,"_MOSAIC_CAT_START_PERCENT"),Nz="".concat(mz,"_MOSAIC_CAT_END_PERCENT"),Vz="".concat(mz,"_SEGMENT_START"),jz="".concat(mz,"_SEGMENT_END"),Uz="".concat(mz,"_KEY");function Wz(t,e){for(var i=0;i<e.length;i++){var n=e[i],r=Gz(t,n.key);r?r.operations=R([],B(new Set(r.operations.concat(n.operations))),!1):t.push(n)}return t}function Gz(t,e){return t.find((function(t){return t.key===e}))}function Yz(t,e){var i;if(!t)return null!=e?e:null;var n=t.getFields();return n&&n[e]?null!==(i=n[e].alias)&&void 0!==i?i:e:null!=e?e:null}function Xz(t,e,i){var n=t.getStackSort(),r={},a=null;return n&&(a={},t.getSeries().forEach((function(t){var e=t.getSeriesField();if(e){var i=t.getRawDataStatisticsByField(e);i.values&&(a[e]||(a[e]={lastIndex:0,sort:{}}),i.values.forEach((function(t,i){t in a[e].sort||(a[e].sort[t]=a[e].lastIndex,a[e].lastIndex++)})))}}))),t.getSeries().forEach((function(t){var n,o=t.getStackData(),s=t.getStackValue(),l=t.getStackValueField(),u=!i||i(t);o&&l&&u&&(r[s]=null!==(n=r[s])&&void 0!==n?n:{groupField:o.groupField,nodes:{}},tH(t,o,r[s],l,e,a))})),n?Kz(r):r}function Kz(t,e){var i;for(var n in t)(null===(i=t[n].sortDatums)||void 0===i?void 0:i.length)?(t[n].sortDatums.sort((function(t,e){return t.index-e.index})),t[n].values=t[n].sortDatums.map((function(t){return t.datum}))):Kz(t[n].nodes);return t}function qz(t,e){if("values"in t&&t.values.length){var i=ZO(t.values,e),n=qO(t.values,Pz);t.values.forEach((function(t){t[Lz]=i,t[Iz]=n}))}else for(var r in t.nodes)qz(t.nodes[r],e)}function Zz(t,e){var i,n;if("values"in t&&t.values.length)U(null===(i=t.values[0])||void 0===i?void 0:i[Lz])?t.total=null===(n=t.values[0])||void 0===n?void 0:n[Lz]:t.total=ZO(t.values,e);else{for(var r in t.nodes)Zz(t.nodes[r],e);t.nodes&&(t.total=ZO(Object.keys(t.nodes).map((function(e){return t.nodes[e]})),"total"))}}function Jz(t,e,i){var n;if(e.groupField&&e.nodes){var r=(null===(n=t.getRawDataStatisticsByField(e.groupField,!1))||void 0===n?void 0:n.values)||[],a={key:"".concat(e.groupField),values:r.map((function(i){var n,r,a,o=e.nodes[i];return{groupValue:i,value:a=t.bandWidthField&&null!==(r=null===(n=o.values.find((function(e){return U(e[t.bandWidthField])})))||void 0===n?void 0:n[t.bandWidthField])&&void 0!==r?r:o.total,end:a}}))};$z(a,!1,!0,!1,{key:"groupField",start:"start",end:"end",startPercent:"startPercent",endPercent:"endPercent"}),a.values.forEach((function(t){e.nodes[t.groupValue].mosaicData=t}))}else if("values"in e&&e.values.length&&i&&i.length){for(var o=i.length,s=0,l=1,u=0,c=1,h=0;h<o;h++)if(h%2==0){var d=l-s;l=s+i[h].endPercent*d,s+=i[h].startPercent*d}else{var p=c-u;c=u+i[h].endPercent*p,u+=i[h].startPercent*p}o%2==0?e.values.forEach((function(t){var e=l-s;t[Nz]=s+e*t[Pz],t[Hz]=s+e*t[Ez],t[zz]=c,t[Fz]=u})):e.values.forEach((function(t){var e=c-u;t[zz]=u+e*t[Pz],t[Fz]=u+e*t[Ez],t[Nz]=l,t[Hz]=s}))}for(var f in e.nodes)Jz(t,e.nodes[f],e.nodes[f].mosaicData?i?R(R([],B(i),!1),[e.nodes[f].mosaicData],!1):[e.nodes[f].mosaicData]:null)}function Qz(t){if(t.values.length)for(var e=t.values[t.values.length-1][Cz]/2,i=0;i<t.values.length;i++)t.values[i][Bz]=t.values[i][wz]-e,t.values[i][Rz]=t.values[i][Cz]-e}function $z(t,e,i,n,r){void 0===r&&(r={key:Tz,start:wz,end:Cz,startPercent:Ez,endPercent:Pz,max:Dz,min:Oz});var a=n&&U(r.min),o=n&&U(r.max);if(t.values.length>0){for(var s=0,l=0,u=1,c=0,h=null,d=null,p=t.values.length,f=0;f<p;f++){(c=(v=t.values[e?p-1-f:f])[r.end])>=0?(v[r.start]=s,s+=v[r.end],v[r.end]=s):(v[r.start]=l,l+=v[r.end],v[r.end]=l),v[r.key]=t.key,o&&(delete v[r.max],(!d||v[r.end]>d[r.end])&&(d=v)),a&&(delete v[r.min],(!h||v[r.start]<h[r.start])&&(h=v))}if(o&&d&&(d[r.max]=!0),a&&h&&(h[r.min]=!0),i)for(f=0;f<p;f++){var v,g=(c=(v=t.values[e?p-1-f:f])[r.end])>=0?s:l;u=c>=0?1:-1,v[r.startPercent]=0===g?0:Math.min(1,v[r.start]/g)*u,v[r.endPercent]=0===g?0:Math.min(1,v[r.end]/g)*u}}for(var y in t.nodes)$z(t.nodes[y],e,i,n,r)}function tH(t,e,i,n,r,a,o){var s,l;if("values"in e)if(r&&e.values.forEach((function(t){return t[Cz]=function(t){if(et(t))return t;var e=+t;return et(e)?e:0}(t[n])})),i.series.push({s:t,values:e.values}),a){var u=t.getSeriesField();e.values.forEach((function(e){i.sortDatums.push({series:t,datum:e,index:u?a[u].sort[e[u]]:0})}))}else(s=i.values).push.apply(s,R([],B(e.values),!1));else for(var c in e.nodes){var h=o?"".concat(o,"_").concat(c):c;i.nodes[c]||(i.nodes[c]={values:[],series:[],nodes:{},sortDatums:[],key:h},U(null===(l=e.nodes[c])||void 0===l?void 0:l.groupField)&&(i.nodes[c].groupField=e.nodes[c].groupField)),tH(t,e.nodes[c],i.nodes[c],n,r,a,h)}}var eH=function(t,e,i,n){void 0===i&&(i="key"),void 0===n&&(n="children");for(var r=0;r<t.length;r++){var a=t[r];if(a[i]===e)return a;if(a[n]){var o=eH(a[n],e,i,n);if(o)return o}}return null},iH=function(t,e,i,n){void 0===i&&(i="key"),void 0===n&&(n="children");for(var r=0;r<t.length;r++){var a=t[r];if(a[n])for(var o=0;o<a[n].length;o++){var s=a[n][o];if(s[i]===e)return a;var l=iH([s],e,i,n);if(l)return l}}return null};function nH(t,e,i,n,r){return void 0===n&&(n="value"),void 0===r&&(r="children"),Array.isArray(t)?t.map((function(t){var a=T({},t);return Array.isArray(a[r])&&(a[r]=nH(a[r],e,i,n,r)),a})).filter((function(t){return+t[n]>=e&&+t[n]<=i||t[r]&&t[r].length>0})):t}function rH(t){void 0===t&&(t={});var e=T({},t);if(V(t.style)?e.style=function(e,i,n,r){return sH(t.style(e,i,n,r))}:lt(t.style)||(e.style=sH(t.style)),!lt(t.state)){var i={};Object.keys(t.state).forEach((function(e){V(t.state[e])?i[e]=function(i,n,r,a){return sH(t.state[e](i,n,r,a))}:lt(t.state[e])||(i[e]=sH(t.state[e]))})),e.state=i}return e}function aH(t){if(lt(t))return null;var e={};return Object.keys(t).forEach((function(i){V(t[i])?e[i]=function(e,n,r,a){return sH(t[i](e,n,r,a))}:lt(t[i])||(e[i]=sH(t[i]))})),e}function oH(t,e){if(lt(t))return null;var i={};return Object.keys(t).forEach((function(n){V(t[n])?i[n]=t[n](e):i[n]=t[n]})),sH(i)}function sH(t){return(null==t?void 0:t.angle)?T(T({},t),{angle:Fe(t.angle)}):t}var lH,uH=function(t){return"line"===t||"area"===t},cH=function(t){if(!t||!t.context)return null;var e=t.context,i=e.data,n=e.markType;return uH(n)?i:null==i?void 0:i[0]},hH=function(t,e){for(var i=e;(null==i?void 0:i.parent)&&i.parent!==t;)if((i=i.parent).context)return i;return null},dH=function(t,e){var i=t.getAttributes(!0),n={};return Object.keys(e).forEach((function(t){i[t]!==e[t]&&(n[t]=e[t])})),n},pH=function(){function t(t,e){this._composedEventMap=new Map,this._eventDispatcher=t,this._mode=e}return t.prototype.getComposedEventMap=function(){return this._composedEventMap},t.prototype.on=function(t,e,i){var n="function"==typeof e?{query:null,callback:e}:{query:e,callback:i},r=KF.getComposedEvent(t);if(r){var a=new r(this._eventDispatcher,this._mode);a.register(t,n),this._composedEventMap.set(i,{eventType:t,event:a})}else this._eventDispatcher.register(t,n);return this},t.prototype.off=function(t,e,i){var n,r,a,o,s=null!=i?i:e;if(KF.getComposedEvent(t))if(s)null===(a=this._composedEventMap.get(s))||void 0===a||a.event.unregister(),this._composedEventMap.delete(s);else try{for(var l=P(this._composedEventMap.entries()),u=l.next();!u.done;u=l.next()){var c=u.value;c[1].eventType===t&&(null===(o=this._composedEventMap.get(c[0]))||void 0===o||o.event.unregister(),this._composedEventMap.delete(c[0]))}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}else if(s){var h={callback:s,query:null,filter:{nodeName:null,type:t,level:null,source:e.source,markName:null,filter:null,userId:null}};this._eventDispatcher.unregister(t,h)}else this._eventDispatcher.unregister(t);return this},t.prototype.emit=function(t,e,i){return this._eventDispatcher.dispatch(t,e,i),this},t.prototype.prevent=function(t,e){return this._eventDispatcher.prevent(t,e),this},t.prototype.allow=function(t){return this._eventDispatcher.allow(t),this},t.prototype.release=function(){this._eventDispatcher.clear(),this._composedEventMap.clear()},t}();!function(t){t.BEFORE_EVALUATE_DATA="beforeEvaluateData",t.AFTER_EVALUATE_DATA="afterEvaluateData",t.BEFORE_EVALUATE_SCALE="beforeEvaluateScale",t.AFTER_EVALUATE_SCALE="afterEvaluateScale",t.BEFORE_PARSE_VIEW="beforeParseView",t.AFTER_PARSE_VIEW="afterParseView",t.BEFORE_TRANSFORM="beforeTransform",t.AFTER_TRANSFORM="afterTransform",t.BEFORE_CREATE_VRENDER_STAGE="beforeCreateVRenderStage",t.AFTER_CREATE_VRENDER_STAGE="afterCreateVRenderStage",t.BEFORE_CREATE_VRENDER_LAYER="beforeCreateVRenderLayer",t.AFTER_CREATE_VRENDER_LAYER="afterCreateVRenderLayer",t.BEFORE_STAGE_RESIZE="beforeStageResize",t.AFTER_STAGE_RESIZE="afterStageResize",t.BEFORE_VRENDER_DRAW="beforeVRenderDraw",t.AFTER_VRENDER_DRAW="afterVRenderDraw",t.BEFORE_MARK_JOIN="beforeMarkJoin",t.AFTER_MARK_JOIN="afterMarkJoin",t.BEFORE_MARK_UPDATE="beforeMarkUpdate",t.AFTER_MARK_UPDATE="afterMarkUpdate",t.BEFORE_MARK_STATE="beforeMarkState",t.AFTER_MARK_STATE="afterMarkState",t.BEFORE_MARK_ENCODE="beforeMarkEncode",t.AFTER_MARK_ENCODE="afterMarkEncode",t.BEFORE_DO_LAYOUT="beforeDoLayout",t.AFTER_DO_LAYOUT="afterDoLayout",t.BEFORE_MARK_LAYOUT_END="beforeMarkLayoutEnd",t.AFTER_MARK_LAYOUT_END="afterMarkLayoutEnd",t.BEFORE_DO_RENDER="beforeDoRender",t.AFTER_DO_RENDER="afterDoRender",t.BEFORE_MARK_RENDER_END="beforeMarkRenderEnd",t.AFTER_MARK_RENDER_END="afterMarkRenderEnd",t.BEFORE_CREATE_VRENDER_MARK="beforeCreateVRenderMark",t.AFTER_CREATE_VRENDER_MARK="afterCreateVRenderMark",t.BEFORE_ADD_VRENDER_MARK="beforeAddVRenderMark",t.AFTER_ADD_VRENDER_MARK="afterAddVRenderMark",t.AFTER_VRENDER_NEXT_RENDER="afterVRenderNextRender",t.BEFORE_ELEMENT_UPDATE_DATA="beforeElementUpdateData",t.AFTER_ELEMENT_UPDATE_DATA="afterElementUpdateData",t.BEFORE_ELEMENT_STATE="beforeElementState",t.AFTER_ELEMENT_STATE="afterElementState",t.BEFORE_ELEMENT_ENCODE="beforeElementEncode",t.AFTER_ELEMENT_ENCODE="afterElementEncode",t.ANIMATION_START="animationStart",t.ANIMATION_END="animationEnd",t.ELEMENT_ANIMATION_START="elementAnimationStart",t.ELEMENT_ANIMATION_END="elementAnimationEnd",t.ALL_ANIMATION_START="allAnimationStart",t.ALL_ANIMATION_END="allAnimationEnd"}(lH||(lH={}));var fH,vH,gH,yH=["pointerdown","pointerup","pointerupoutside","pointertap","pointerover","pointermove","pointerenter","pointerleave","pointerout","mousedown","mouseup","mouseupoutside","rightdown","rightup","rightupoutside","click","dblclick","mousemove","mouseover","mouseout","mouseenter","mouseleave","wheel","touchstart","touchend","touchendoutside","touchmove","touchcancel","tap","dragstart","drag","dragenter","dragleave","dragover","dragend","drop","pan","panstart","panend","press","pressup","pressend","pinch","pinchstart","pinchend","swipe"];t.ChartEvent=void 0,(fH=t.ChartEvent||(t.ChartEvent={})).initialized="initialized",fH.rendered="rendered",fH.renderFinished="renderFinished",fH.animationFinished="animationFinished",fH.regionSeriesDataFilterOver="regionSeriesDataFilterOver",fH.afterInitData="afterInitData",fH.afterInitEvent="afterInitEvent",fH.afterInitMark="afterInitMark",fH.rawDataUpdate="rawDataUpdate",fH.viewDataFilterOver="viewDataFilterOver",fH.viewDataUpdate="viewDataUpdate",fH.viewDataStatisticsUpdate="viewDataStatisticsUpdate",fH.markDeltaYUpdate="markDeltaYUpdate",fH.viewDataLabelUpdate="viewDataLabelUpdate",fH.scaleDomainUpdate="scaleDomainUpdate",fH.scaleUpdate="scaleUpdate",fH.dataZoomChange="dataZoomChange",fH.drill="drill",fH.layoutStart="layoutStart",fH.layoutEnd="layoutEnd",fH.layoutRectUpdate="layoutRectUpdate",fH.playerPlay="playerPlay",fH.playerPause="playerPause",fH.playerEnd="playerEnd",fH.playerChange="playerChange",fH.playerForward="playerForward",fH.playerBackward="playerBackward",fH.scrollBarChange="scrollBarChange",fH.brushStart="brushStart",fH.brushChange="brushChange",fH.brushEnd="brushEnd",fH.brushClear="brushClear",fH.brushActive="brushActive",fH.legendSelectedDataChange="legendSelectedDataChange",fH.legendFilter="legendFilter",fH.legendItemClick="legendItemClick",fH.legendItemHover="legendItemHover",fH.legendItemUnHover="legendItemUnHover",fH.tooltipShow="tooltipShow",fH.tooltipHide="tooltipHide",fH.tooltipRelease="tooltipRelease",fH.afterResize="afterResize",fH.afterRender="afterRender",fH.afterLayout="afterLayout",fH.afterMarkLayoutEnd="afterMarkLayoutEnd",function(t){t.chart="chart",t.window="window",t.canvas="canvas"}(vH||(vH={})),function(t){t.vchart="vchart",t.chart="chart",t.model="model",t.mark="mark"}(gH||(gH={}));var mH=[gH.mark,gH.model,gH.chart,gH.vchart],_H=function(){function t(){this._map=new Map,this._levelNodes=new Map,this._levelNodes.set(gH.vchart,[]),this._levelNodes.set(gH.chart,[]),this._levelNodes.set(gH.model,[]),this._levelNodes.set(gH.mark,[])}return t.prototype.addHandler=function(t,e){var i,n={level:e,handler:t};return null===(i=this._levelNodes.get(e))||void 0===i||i.push(n),this._map.set(t.callback,n),this},t.prototype.removeHandler=function(t){var e=this._map.get(t.callback);if(!e)return this;this._map.delete(t.callback);var i=this._levelNodes.get(e.level),n=null==i?void 0:i.findIndex((function(e){return e.handler.callback===t.callback}));return void 0!==n&&n>=0&&(null==i||i.splice(n,1)),this},t.prototype.preventHandler=function(t){return t&&(t.prevented=!0),this},t.prototype.allowHandler=function(t){return t&&(t.prevented=!1),this},t.prototype.getHandlers=function(t){var e;return(null===(e=this._levelNodes.get(t))||void 0===e?void 0:e.map((function(t){return t.handler})))||[]},t.prototype.getAllHandlers=function(){return Array.from(this._map.values()).map((function(t){return t.handler}))||[]},t.prototype.getCount=function(){return this._map.size},t.prototype.release=function(){this._map.clear(),this._levelNodes.clear()},t}(),bH={cartesianAxis:"axis","cartesianAxis-band":"axis","cartesianAxis-linear":"axis","cartesianAxis-time":"axis",polarAxis:"axis","polarAxis-band":"axis","polarAxis-linear":"axis",discreteLegend:"legend",continuousLegend:"legend",colorLegend:"legend",sizeLegend:"legend"},xH=function(){function t(t,e){var i=this;this._viewBubbles=new Map,this._windowBubbles=new Map,this._canvasBubbles=new Map,this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this._onDelegate=function(t){var e,n=i.globalInstance.getChart(),r=U(t.modelId)&&(null==n?void 0:n.getModelById(t.modelId))||void 0,a=U(t.markId)&&(null==n?void 0:n.getMarkById(t.markId))||null,o=ut(t.event,"target"),s=t.datum;r&&"component"===r.modelType&&(s=null!==(e=r.getDatum(o))&&void 0!==e?e:s);var l={event:t.event,item:t.item,source:t.source,datum:s,chart:n,model:r,mark:null!=a?a:void 0,node:o};i.dispatch(t.type,l)},this._onDelegateInteractionEvent=function(t){var e=i.globalInstance.getChart(),n=t.event,r=null;n.graphics&&(r=n.graphics);var a={event:t.event,chart:e,graphics:r,datums:r&&r.map((function(t){return cH(t)}))};i.dispatch(t.type,a)},this.globalInstance=t,this._compiler=e}return t.prototype.register=function(t,e){var i,n,r,a,o;this._parseQuery(e);var s=this.getEventBubble((null===(i=e.filter)||void 0===i?void 0:i.source)||vH.chart),l=this.getEventListeners((null===(n=e.filter)||void 0===n?void 0:n.source)||vH.chart);if(s.get(t)||s.set(t,new _H),s.get(t).addHandler(e,null===(r=e.filter)||void 0===r?void 0:r.level),this._isValidEvent(t)&&!l.has(t)){var u=this._onDelegate.bind(this);this._compiler.addEventListener(null===(a=e.filter)||void 0===a?void 0:a.source,t,u),l.set(t,u)}else if(this._isInteractionEvent(t)&&!l.has(t)){u=this._onDelegateInteractionEvent.bind(this);this._compiler.addEventListener(null===(o=e.filter)||void 0===o?void 0:o.source,t,u),l.set(t,u)}return this},t.prototype.unregister=function(t,e){var i,n,r,a,o,s=!1,l=this.getEventBubble((null===(i=null==e?void 0:e.filter)||void 0===i?void 0:i.source)||vH.chart),u=this.getEventListeners((null===(n=null==e?void 0:e.filter)||void 0===n?void 0:n.source)||vH.chart);e?(null==(o=l.get(t))||o.removeHandler(e),0===(null==o?void 0:o.getCount())&&(null==o||o.release(),l.delete(t),s=!0),(null===(r=null==e?void 0:e.wrappedCallback)||void 0===r?void 0:r.cancel)&&e.wrappedCallback.cancel()):(null==(o=l.get(t))||o.release(),l.delete(t),s=!0);if(s&&this._isValidEvent(t)){var c=u.get(t);this._compiler.removeEventListener((null===(a=null==e?void 0:e.filter)||void 0===a?void 0:a.source)||vH.chart,t,c),u.delete(t)}return this},t.prototype.dispatch=function(t,e,i){var n=this.getEventBubble(e.source||vH.chart).get(t);if(!n)return this;var r=!1;if(i){var a=n.getHandlers(i);r=this._invoke(a,t,e)}else for(var o=0;!r&&o<mH.length;)r=this._invoke(n.getHandlers(mH[o]),t,e),o++;return this},t.prototype.prevent=function(t,e){var i=this;return["canvas","chart","window"].forEach((function(n){var r=i.getEventBubble(n).get(t);r&&r.getAllHandlers().forEach((function(t){e?mH.indexOf(t.filter.level)<mH.indexOf(e.level)&&t.callback!==e.handler&&r.preventHandler(t):r.preventHandler(t)}))})),this},t.prototype.allow=function(t){var e=this;return["canvas","chart","window"].forEach((function(i){var n=e.getEventBubble(i).get(t);n&&n.getAllHandlers().forEach((function(t){return n.allowHandler(t)}))})),this},t.prototype.clear=function(){var t=this;[vH.chart,vH.window,vH.canvas].forEach((function(e){var i,n,r=t.getEventListeners(e);try{for(var a=P(r.entries()),o=a.next();!o.done;o=a.next()){var s=o.value;t._compiler.removeEventListener(e,s[0],s[1])}}catch(t){i={error:t}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}r.clear()})),[this._viewBubbles,this._windowBubbles,this._canvasBubbles].forEach((function(t){var e,i;try{for(var n=P(t.values()),r=n.next();!r.done;r=n.next()){r.value.release()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}t.clear()}))},t.prototype.release=function(){this.clear(),this.globalInstance=null,this._compiler=null},t.prototype._filter=function(t,e,i){var n,r,a;if(V(t.filter)&&!t.filter(i))return!1;if(t.nodeName&&ut(i,"node.name")!==t.nodeName)return!1;if(t.markName&&(null===(n=null==i?void 0:i.mark)||void 0===n?void 0:n.name)!==t.markName)return!1;var o=null===(r=i.model)||void 0===r?void 0:r.type;return bH[o]&&(o=bH[o]),(!t.type||o===t.type)&&(!("mark"===t.level&&!t.type&&!(null==i?void 0:i.mark))&&(!("model"===t.level&&!t.type&&!(null==i?void 0:i.model))&&(!U(t.userId)||(null===(a=i.model)||void 0===a?void 0:a.userId)===t.userId)))},t.prototype._invoke=function(t,e,i){var n=this,r=t.map((function(t){var r,a,o,s=t.filter;if(!t.prevented&&(!t.query||n._filter(s,e,i))){var l=(t.wrappedCallback||t.callback).call(null,T({},i)),u=null!=l?l:null===(r=t.query)||void 0===r?void 0:r.consume;return u&&(null===(a=i.event)||void 0===a||a.stopPropagation(),null===(o=i.event)||void 0===o||o.preventDefault()),!!u}}));return r.some((function(t){return!0===t}))},t.prototype._getQueryLevel=function(t){return t?t.level?t.level:U(t.id)?gH.model:gH.vchart:gH.vchart},t.prototype._parseQuery=function(t){var e,i=t.query;(null==i?void 0:i.throttle)?t.wrappedCallback=Qt(t.callback,i.throttle):(null==i?void 0:i.debounce)&&(t.wrappedCallback=Jt(t.callback,i.debounce));var n=this._getQueryLevel(i),r=null,a=vH.chart,o=null,s=null,l=null;return(null==i?void 0:i.nodeName)&&(o=i.nodeName),(null==i?void 0:i.markName)&&(s=i.markName),!(null==i?void 0:i.type)||n!==gH.model&&n!==gH.mark||(r=i.type),(null==i?void 0:i.source)&&(a=i.source),U(null==i?void 0:i.id)&&(l=null==i?void 0:i.id,n=gH.model),t.filter={level:n,markName:s,type:r,source:a,nodeName:o,userId:l,filter:null!==(e=null==i?void 0:i.filter)&&void 0!==e?e:null},t},t.prototype.getEventBubble=function(t){switch(t){case vH.chart:return this._viewBubbles;case vH.window:return this._windowBubbles;case vH.canvas:return this._canvasBubbles;default:return this._viewBubbles}},t.prototype.getEventListeners=function(t){switch(t){case vH.chart:return this._viewListeners;case vH.window:return this._windowListeners;case vH.canvas:return this._canvasListeners;default:return this._viewListeners}},t.prototype._isValidEvent=function(t){return yH.includes(t)||Object.values(lH).includes(t)},t.prototype._isInteractionEvent=function(t){var e;return t&&(e=t.split(":")[0])&&KF.hasInteractionTrigger(e)},t}();function kH(t,e,i){t.getTransform(e)||t.registerTransform(e,i)}function SH(t,e,i){t.getParser(e)||t.registerParser(e,i)}var AH,MH=new Map;function TH(){AH||(SH(AH=new cs,"geojson",rs),SH(AH,"topojson",os),kH(AH,"simplify",Mo))}function wH(t,e,i){void 0===i&&(i={type:"geojson",centroid:!0}),MH.has(t)&&cx("map type of '".concat(t,"' already exists, will be overwritten.")),TH();var n=new hs(AH),r=gt({},{centroid:!0,simplify:!1},i);"topojson"===i.type?n.parse(e,{type:"topojson",options:r}):n.parse(e,{type:"geojson",options:r});var a=i.simplify;!0===a?n.transform({type:"simplify"}):W(a)&&n.transform({type:"simplify",options:a}),MH.set(t,n)}function CH(t){MH.has(t)?MH.delete(t):cx("map type of '".concat(t,"' does not exists."))}function EH(t,e){void 0===e&&(e=!1);var i=e;return t.latestData instanceof hs&&(i=!1),i?dt(t.latestData):t.latestData&&t.latestData.slice()}var PH,BH,RH,LH,IH=function(t,e){return 0===t.length?[]:1===t.length?EH(t[0],null==e?void 0:e.deep):t.map((function(t){return EH(t,null==e?void 0:e.deep)}))};function DH(e,i,n){kH(i=i instanceof cs?i:e.dataSet,"copyDataView",IH);var r=new hs(i,n);return r.parse([e],{type:"dataview"}),r.transform({type:"copyDataView",level:t.TransformLevel.copyDataView}),r}function OH(t,e,i){var n;if(void 0===i&&(i=[]),t instanceof hs)return t;var r,a=t.id,o=t.values,s=void 0===o?[]:o,l=t.fromDataIndex,u=t.fromDataId,c=t.transforms,h=void 0===c?[]:c,d=t.parser?dt(t.parser):{clone:!0},p=dt(t.fields);d.clone=!(!1===d.clone);var f=i.find((function(t){return t.name===a}));if(f)r=f;else{var v={name:a};if(p&&(v.fields=p),r=new hs(e,v),"string"==typeof u){if(!(g=i.find((function(t){return t.name===u}))))return cx("no data matches fromDataId ".concat(u)),null;r.parse([g],{type:"dataview"}),r.transform({type:"copyDataView"})}else if("number"==typeof l){var g;if(!(g=i[l]))return cx("no data matches fromDataIndex ".concat(l)),null;r.parse([g],{type:"dataview"}),r.transform({type:"copyDataView"})}else Array.isArray(s)?r.parse(s,d):!K(s)||d&&!["csv","dsv","tsv"].includes(d.type)?(r.parse([]),cx("values should be array")):r.parse(s,null!==(n=d)&&void 0!==n?n:{type:"csv"});h&&h.length&&h.forEach((function(t){e.getTransform(t.type)&&r.transform(t)}))}return r}function FH(t,e,i){t&&(e.fields&&t.setFields(e.fields,i),t.parseNewData(e.values,e.parser))}t.TransformLevel=void 0,(PH=t.TransformLevel||(t.TransformLevel={}))[PH.copyDataView=-10]="copyDataView",PH[PH.treemapFilter=-8]="treemapFilter",PH[PH.treemapFlatten=-7]="treemapFlatten",PH[PH.dotObjFlat=-7]="dotObjFlat",PH[PH.linkDotInfo=-7]="linkDotInfo",PH[PH.sankeyLayout=-7]="sankeyLayout",PH[PH.dataZoomFilter=-6]="dataZoomFilter",PH[PH.legendFilter=-5]="legendFilter",function(t){t.appear="appear",t.disappear="disappear",t.enter="enter",t.update="update",t.state="state",t.exit="exit",t.normal="normal",t.none="none"}(BH||(BH={})),function(t){t.data="data",t.mark="mark"}(RH||(RH={})),function(t){t.before="before",t.layouting="layouting",t.reevaluate="reevaluate",t.after="after"}(LH||(LH={}));var zH=["line","area","trail"];function HH(t,e,i){var n=new Map;if(!t||0===t.length)return{keys:[],data:n};if(!e)return n.set(Uz,i?t.slice().sort(i):t.slice()),{keys:[Uz],data:n};if(1===t.length){var r=e(t[0],0);return n.set(r,[t[0]]),{keys:[r],data:n}}var a=new Set;return t.forEach((function(t,i){var r,o=e(t,i),s=null!==(r=n.get(o))&&void 0!==r?r:[];s.push(t),n.set(o,s),a.add(o)})),i&&a.forEach((function(t){n.get(t).sort(i)})),{keys:Array.from(a),data:n}}var NH=function(t,e,i){return void 0===i&&(i={}),t&&Object.keys(t).forEach((function(n){i[n]=t[n](e)})),i};function VH(t,e,i,n,r){var a=function(t){if(!n&&t&&(!i||i(t))){var o=e.call(null,t);if(r&&o)return o}if("group"===t.type){var s=t.getMarks();if(s)for(var l=0;l<s.length;l++){if((o=a(s[l]))&&r)return o}}if(n&&(t&&(!i||i(t))&&(o=e.call(null,t))&&r))return o};return a(t)}function jH(t){var e=[];return t.forEach((function(t){VH(t,(function(t){"group"!==t.type&&"component"!==t.type&&e.push(t)}))})),e}function UH(t,e,i,n){var r=HH(t,(function(t){return i(t)})),a=HH(e,(function(t){return n(t)})),o=t,s=e,l=[];return a.keys.forEach((function(t){if(!j(t)){var e=r.data.get(t),i=a.data.get(t);e&&i&&(l.push({prev:e,next:i}),o=o.filter((function(t){return!e.includes(t)})),s=s.filter((function(t){return!i.includes(t)})))}})),{prev:o,next:s,update:l}}var WH=function(){function e(e,i){var n=this;this._count=0,this._rootMarks=[],this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this.isInited=!1,this._released=!1,this._compileChart=null,this.handleLayoutEnd=function(){var e,i;null===(i=null===(e=n._compileChart)||void 0===e?void 0:e.getEvent())||void 0===i||i.emit(t.ChartEvent.afterMarkLayoutEnd,{chart:n._compileChart})},this.handleStageRender=function(){var e,i;null===(i=null===(e=n._compileChart)||void 0===e?void 0:e.getEvent())||void 0===i||i.emit(t.ChartEvent.afterRender,{chart:n._compileChart})},this._handleAfterNextRender=function(){var e,i,r,a;n._stage&&!n._option.disableDirtyBounds&&n._stage.enableDirtyBounds(),n._compileChart&&(null===(e=n._compileChart.getEvent())||void 0===e||e.emit(t.ChartEvent.renderFinished,{chart:n._compileChart,vchart:null===(i=n._compileChart.getOption())||void 0===i?void 0:i.globalInstance})),null===(a=null===(r=n._option.performanceHook)||void 0===r?void 0:r.afterVRenderDraw)||void 0===a||a.call(r,n._compileChart.getOption().globalInstance)},this.handleProgressiveFrame=function(){n._progressiveMarks.length&&n._progressiveMarks.forEach((function(t){t.isDoingProgressive()&&t.renderProgressive()})),n.doPreProgressive()},this._container=e,this._option=i}return e.prototype.getRootGroup=function(){return this._rootGroup},e.prototype.getChart=function(){return this._compileChart},e.prototype.getCanvas=function(){var t;return null===(t=this._stage)||void 0===t?void 0:t.window.getNativeHandler().nativeCanvas},e.prototype.getStage=function(){return this._stage},e.prototype.initView=function(){var e,i,n,r,a=this;if(!this._released&&(this.isInited=!0,!this._stage)){var o=this._option,s=o.autoRefreshDpr,l=o.dpr,u=o.mode,c=o.modeParams,h=o.gestureConfig,d=o.interactive,p=o.clickInterval,f=o.autoPreventDefault,v=o.background;j_.setEnv(function(e){switch(e){case t.RenderModeEnum["desktop-browser"]:case t.RenderModeEnum["mobile-browser"]:return"browser";case t.RenderModeEnum.node:case t.RenderModeEnum.worker:return"node";case t.RenderModeEnum.miniApp:case t.RenderModeEnum["desktop-miniApp"]:return"feishu";case t.RenderModeEnum.lynx:return"lynx";case t.RenderModeEnum.wx:return"wx";case t.RenderModeEnum.tt:return"tt";case t.RenderModeEnum.harmony:return"harmony"}return"browser"}(u),null!=c?c:{}),this._stage=null!==(e=this._option.stage)&&void 0!==e?e:new nb(T({background:v,width:this._width,height:this._height,container:null!==(i=this._container.dom)&&void 0!==i?i:null,canvas:null!==(n=this._container.canvas)&&void 0!==n?n:null,dpr:l,viewBox:this._option.viewBox,canvasControled:this._option.canvasControled,beforeRender:function(t){var e,i,n;null===(e=a._compileChart)||void 0===e||e.onBeforeRender(),null===(n=(i=a._option).beforeRender)||void 0===n||n.call(i,t)},afterRender:this._option.afterRender,disableDirtyBounds:!0,autoRender:!0,ticker:this._option.ticker,pluginList:this._option.pluginList,enableHtmlAttribute:this._option.enableHtmlAttribute,optimize:this._option.optimize,supportsTouchEvents:this._option.supportsTouchEvents,supportsPointerEvents:this._option.supportsPointerEvents,event:{clickInterval:p,autoPreventDefault:f},ReactDOM:this._option.ReactDOM,autoRefresh:U(s)?s:!U(l)},null!==(r=this._option.renderHooks)&&void 0!==r?r:{})),this._stage.enableIncrementalAutoRender(),this._stage.setTheme({symbol:{shape:"circle",size:8},text:{fontSize:14,fill:"#000000"}});var g=Vf({x:0,y:0,width:this._width,height:this._height});g.name="root",this._stage.defaultLayer.appendChild(g),this._rootGroup=g;var y=(U(h)?h:gx(u))&&!1!==d&&KF.getStageEventPlugin("gesture");y&&(this._gestureController=new y(this._stage,W(h)?h:{})),this._setCanvasStyle(),this.getStage().hooks.afterRender.tap("chart-event",this.handleStageRender),!1!==d&&this._viewListeners.forEach((function(t){}))}},e.prototype.getLayoutState=function(){return this._layoutState},e.prototype.updateLayoutTag=function(){this._layoutState=LH.before},e.prototype._setCanvasStyle=function(){if(this._stage&&this._container.dom&&!K(this._container.dom)){this._container.dom.style.display="block",this._container.dom.style.position="relative";var t=this.getCanvas();t&&(t.style.display="block")}},e.prototype.compile=function(t,e){if(!this._released){var i=t.chart;this._compileChart=i,this.initView(),this._stage&&("render"!==(null==e?void 0:e.actionSource)&&this._cachedMarks&&(this.reuseOrMorphing(e.morphConfig),this._cachedMarks=null),i.compile(),i.afterCompile())}},e.prototype.clearNextRender=function(){return!!this._nextRafId&&(j_.getSpecifiedCancelAnimationFrame(10)(this._nextRafId),this._nextRafId=null,!0)},e.prototype.clear=function(t){var e=t.chart;this.clearNextRender(),e.clear()},e.prototype.renderNextTick=function(t){var e=this;this._released||(this._nextRafId&&this.clearNextRender(),this._nextRafId=j_.getSpecifiedRequestAnimationFrame(10)((function(){e._nextRafId=null,e.render(t)})))},e.prototype._commitedAll=function(){return this._rootMarks.some((function(t){return VH(t,(function(t){return t.commit()}))}))},e.prototype._hasCommitedMark=function(){return this._rootMarks.some((function(t){return VH(t,(function(t){return t.isCommited()}),null,null,!0)}))},e.prototype._doRender=function(t){var e,i,n,r,a=this;this._stage&&(this._rootMarks.forEach((function(t){VH(t,(function(t){t.needClear&&(a._progressiveMarks||t.runAnimation(),t.clearExitGraphics(),t.needClear=!1)}),null,!0)})),null===(i=null===(e=this._option.performanceHook)||void 0===e?void 0:e.beforeVRenderDraw)||void 0===i||i.call(e,this._compileChart.getOption().globalInstance),this._stage.disableDirtyBounds(),this._stage.afterNextRender(this._handleAfterNextRender),t&&(this._stage.render(),null===(r=null===(n=this._option.performanceHook)||void 0===n?void 0:n.afterVRenderDraw)||void 0===r||r.call(n,this._compileChart.getOption().globalInstance)))},e.prototype.renderMarks=function(){var t;this._hasCommitedMark()&&(ux("--- start of renderMarks(".concat(this._count,") ---")),this.clearProgressive(),this._rootMarks.forEach((function(t){t.render()})),this._layoutState===LH.before&&(this._layoutState=LH.layouting,null===(t=this._compileChart)||void 0===t||t.onLayout(),this._layoutState=LH.reevaluate,this._hasCommitedMark()&&this._rootMarks.forEach((function(t){t.render()})),this.handleLayoutEnd()),this.findProgressiveMarks(),this._doRender(!0),this.doPreProgressive(),ux("--- start of renderMarks(".concat(this._count,") ---")),this._count++)},e.prototype.reuseOrMorphing=function(t){void 0===t&&(t={});var e=t.reuse,i=void 0===e||e,n=t.morph,r=void 0===n||n,a=t.morphAll,o=void 0!==a&&a;t.animation,t.enableExitAnimation;var s=jH(this._rootMarks),l=function(t,e,i){var n={enter:[],exit:[],update:[]},r=[],a=[];t.forEach((function(t){i.morph&&t.getMarkConfig().morph||i.morphAll||i.reuse?r.push(t):n.exit.push({prev:[t]})})),e.forEach((function(t){i.morph&&t.getMarkConfig().morph||i.morphAll||i.reuse?a.push(t):n.enter.push({next:[t]})}));var o=UH(r,a,(function(t){return t.getMarkConfig().morphKey}),(function(t){return t.getMarkConfig().morphKey}));r=o.prev,a=o.next,n.update=n.update.concat(o.update);var s=UH(r,a,(function(t){return"".concat(t.getUserId())}),(function(t){return"".concat(t.getUserId())}));r=s.prev,a=s.next,n.update=n.update.concat(s.update);var l=HH(r,(function(t){var e,i;return null===(i=null===(e=t.group)||void 0===e?void 0:e.id)||void 0===i?void 0:i.call(e)})),u=HH(a,(function(t){var e,i;return null===(i=null===(e=t.group)||void 0===e?void 0:e.id)||void 0===i?void 0:i.call(e)}));return Object.keys(u).forEach((function(t){var e=l.data.get(t),i=u.data.get(t);if(e&&i){for(var o=0;o<Math.max(e.length,i.length);o+=1){var s=e[o],c=i[o];s&&c?n.update.push({prev:[s],next:[c]}):s?n.exit.push({prev:[s]}):c&&n.enter.push({next:[c]})}r=r.filter((function(t){return!e.includes(t)})),a=a.filter((function(t){return!i.includes(t)}))}})),r.forEach((function(t){return n.exit.push({prev:[t]})})),a.forEach((function(t){return n.enter.push({next:[t]})})),n}(this._cachedMarks,s,{morph:r,morphAll:o,reuse:i}),u=l.update,c=l.exit;u.forEach((function(t){var e=t.prev,n=t.next;if(i&&1===e.length&&1===n.length&&e[0].type===n[0].type)n[0].reuse(e[0]);else{var r=e.filter((function(t){return t.getMarkConfig().morph}))[0];r&&n.forEach((function(t){t.getMarkConfig().morph&&t.prepareMorph(r)}))}})),c.forEach((function(t){t.prev.forEach((function(t){t.removeProduct()}))}))},e.prototype.render=function(t){if(!this._released&&(this.clearNextRender(),this.initView(),this._stage)){var e=this._rootGroup.attribute,i=e.width,n=e.height;this._width===i&&this._height===n||this._rootGroup.setAttributes({width:this._width,height:this._height}),this.renderMarks(),this.clearNextRender()&&this.renderMarks()}},e.prototype.updateViewBox=function(t,e){if(void 0===e&&(e=!0),this._stage){var i=this._stage.viewBox;!t||i&&i.x1===t.x1&&i.y1===t.y1&&i.x2===t.x2&&i.y2===t.y2||this._stage.setViewBox(t,e)}},e.prototype.resize=function(t,e,i){if(void 0===i&&(i=!0),this._stage){var n=this._width!==t||this._height!==e;this._width=t,this._height=e,n&&(this._stage.resize(t,e),this._commitedAll(),i&&this.render({morph:!1}))}},e.prototype.setBackground=function(t){this._stage&&(this._stage.background=t)},e.prototype.setSize=function(t,e){this._width=t,this._height=e,this._stage},e.prototype.setViewBox=function(t,e){void 0===e&&(e=!0),this.updateViewBox(t,e)},e.prototype.addEventListener=function(t,e,i){var n,r;if(!1!==this._option.interactive)if(t===vH.chart){var a=this.getRootGroup(),o=function(n){var r,o=n.target,s=null;o&&(s=U(o.context)?o:hH(a,o));var l=null!==(r=null==s?void 0:s.context)&&void 0!==r?r:{},u=U(l.markId)?l.markId:null,c=U(l.modelId)?l.modelId:null,h=U(l.modelUserId)?l.modelUserId:null,d=U(l.markUserId)?l.markUserId:null,p={event:n,type:e,source:t,item:s,datum:cH(s),markId:u,modelId:c,markUserId:d,modelUserId:h};i.call(null,p)}.bind(this);this._viewListeners.set(i,{type:e,callback:o}),null===(n=this._stage)||void 0===n||n.addEventListener(e,o)}else if(t===vH.window){o=function(n){var r={event:n,type:e,source:t,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null};i.call(null,r)}.bind(this);this._windowListeners.set(i,{type:e,callback:o});var s=this._getGlobalThis();null==s||s.addEventListener(e,o)}else if(t===vH.canvas){o=function(n){var r={event:n,type:e,source:t,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null};i.call(null,r)}.bind(this);this._canvasListeners.set(i,{type:e,callback:o});var l=null===(r=this.getStage())||void 0===r?void 0:r.window;null==l||l.addEventListener(e,o)}},e.prototype.removeEventListener=function(t,e,i){var n,r,a,o,s;if(!1!==this._option.interactive)if(t===vH.chart)(c=null===(n=this._viewListeners.get(i))||void 0===n?void 0:n.callback)&&(null===(r=this._stage)||void 0===r||r.removeEventListener(e,c)),this._viewListeners.delete(i);else if(t===vH.window){var l=this._getGlobalThis();(c=null===(a=this._windowListeners.get(i))||void 0===a?void 0:a.callback)&&(null==l||l.removeEventListener(e,c)),this._windowListeners.delete(i)}else if(t===vH.canvas){var u=null===(o=this.getStage())||void 0===o?void 0:o.window,c=null===(s=this._canvasListeners.get(i))||void 0===s?void 0:s.callback;u&&c&&(null==u||u.removeEventListener(e,c)),this._canvasListeners.delete(i)}},e.prototype.releaseEvent=function(){var t=this.getStage();t&&t.hooks.afterRender.unTap("chart-event",this.handleStageRender),this._viewListeners.clear(),this._windowListeners.clear(),this._canvasListeners.clear()},e.prototype.release=function(){var t;this.clearNextRender(),this.releaseEvent(),this._option=this._container=null,this.releaseGrammar(!0),this._stage!==(null===(t=this._option)||void 0===t?void 0:t.stage)&&this._stage.release(),this._stage=null,this.isInited=!1,this._compileChart=null,this._released=!0},e.prototype.releaseGrammar=function(t){void 0===t&&(t=!1),t?this._rootMarks.forEach((function(t){VH(t,(function(t){t.removeProduct()}),null,!0)})):this._cachedMarks=jH(this._rootMarks),this._rootMarks=[]},e.prototype.addRootMark=function(t){this._rootMarks.includes(t)||this._rootMarks.push(t)},e.prototype.getRootMarks=function(){return this._rootMarks},e.prototype.removeRootMark=function(t){var e=this._rootMarks.findIndex((function(e){return e===t}));return e>=0&&(this._rootMarks.splice(e,1),!0)},e.prototype._getGlobalThis=function(){var t;return vx(this._option.mode)?globalThis:null===(t=this.getStage())||void 0===t?void 0:t.window},e.prototype._combineIncrementalLayers=function(){var t=this;this._stage&&function(t){return Tp(this,void 0,void 0,f().m((function e(){var i,n;return f().w((function(e){for(;;)switch(e.n){case 0:return i=[],n=t.getChildren(),e.n=1,new Promise((function(t){al.global.getRequestAnimationFrame()((function(){t(null)}))}));case 1:return n.forEach((function(t){t.subLayers.size&&t.subLayers.forEach((function(t){t.drawContribution&&t.drawContribution.hooks&&t.drawContribution.rendering&&i.push(new Promise((function(e){t.drawContribution.hooks.completeDraw.tap("outWait",(function(){t.drawContribution.hooks.completeDraw.taps=t.drawContribution.hooks.completeDraw.taps.filter((function(t){return"outWait"!==t.name})),e(null)}))})))}))})),e.n=2,Promise.all(i);case 2:return e.a(2)}}),e)})))}(this._stage).then((function(){t._stage&&t._stage.defaultLayer.combineSubLayer()}))},e.prototype.findProgressiveMarks=function(){var t=[];return this._rootMarks.forEach((function(e){VH(e,(function(e){e.isProgressive()&&t.push(e)}))})),t.length?(this._progressiveMarks=t,this._combineIncrementalLayers(),t):(this._progressiveMarks=null,null)},e.prototype.doPreProgressive=function(){if(this._progressiveMarks&&this._progressiveMarks.some((function(t){return t.isDoingProgressive()}))){var t=j_.getSpecifiedRequestAnimationFrame(10);this._progressiveRafId=t(this.handleProgressiveFrame)}else this._progressiveMarks&&this._progressiveMarks.every((function(t){return t.canAnimateAfterProgressive()}))?this._progressiveMarks.forEach((function(t){t.runAnimation()})):this._progressiveMarks&&(this._progressiveMarks=null)},e.prototype.clearProgressive=function(){this._progressiveRafId&&j_.getSpecifiedCancelAnimationFrame(10)(this._progressiveRafId);this._progressiveMarks&&this._progressiveMarks.length&&(this._progressiveMarks.forEach((function(t){t.clearProgressive()})),this._progressiveMarks=null)},e}();function GH(t){return new Promise((function(e){t.convertToBlob().then((function(t){var i=new FileReader;i.readAsDataURL(t),i.onload=function(){e(i.result)}}))}))}function YH(t,e){var i;return C(this,void 0,void 0,(function(){return E(this,(function(n){if(!t)return[2,""];try{if(void 0!==OffscreenCanvas&&t instanceof OffscreenCanvas)return[2,GH(t)]}catch(t){(null!==(i=null==e?void 0:e.onError)&&void 0!==i?i:hx)("getCanvasDataURL error : ".concat(t.toString()))}return[2,t.toDataURL()]}))}))}function XH(t){t.crosshair=St(t.crosshair||{}).map((function(e){var i;return XF(((i={})["horizontal"===t.direction?"yField":"xField"]={visible:!0,line:{visible:!0,type:"rect"}},i),e)}))}function KH(t,e,i){var n,r=t.width,a=t.height;if(U(r)&&U(a))return{width:r,height:a};var o=i.width,s=i.height,l=e.container,u=e.canvas;if(l){var c=Oi(l,i.width,i.height);o=c.width,s=c.height}else if(u&&vx(e.mode)){var h=Oi(K(u)?j_.getElementById(u):u,i.width,i.height);o=h.width,s=h.height}else if(yx(e.mode)&&(null===(n=e.modeParams)||void 0===n?void 0:n.domref)){var d=e.modeParams.domref;o=d.width,s=d.height}return{width:o=null!=r?r:o,height:s=null!=a?a:s}}function qH(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=function(i){return e.reduce((function(t,e){return t||(null==e?void 0:e[i])}),t[i])};return Object.assign(t,{change:n("change"),reCompile:n("reCompile"),reMake:n("reMake"),reRender:n("reRender"),reSize:n("reSize"),reTransformSpec:n("reTransformSpec"),changeTheme:n("changeTheme"),changeBackground:n("changeBackground")}),t}function ZH(t,e){return"line"===t||"area"===t||"common"===t&&e.series.every((function(t){return"area"===t.type||"line"===t.type}))?{paddingInner:1,paddingOuter:0}:{paddingOuter:0}}var JH,QH,$H;t.LayoutZIndex=void 0,(JH=t.LayoutZIndex||(t.LayoutZIndex={}))[JH.SeriesGroup=0]="SeriesGroup",JH[JH.Axis_Grid=50]="Axis_Grid",JH[JH.CrossHair_Grid=100]="CrossHair_Grid",JH[JH.Region=450]="Region",JH[JH.Mark=300]="Mark",JH[JH.Node=400]="Node",JH[JH.Axis=100]="Axis",JH[JH.MarkLine=500]="MarkLine",JH[JH.MarkArea=100]="MarkArea",JH[JH.MarkPoint=500]="MarkPoint",JH[JH.DataZoom=500]="DataZoom",JH[JH.ScrollBar=500]="ScrollBar",JH[JH.Player=500]="Player",JH[JH.Legend=500]="Legend",JH[JH.CrossHair=500]="CrossHair",JH[JH.Indicator=500]="Indicator",JH[JH.Title=500]="Title",JH[JH.Label=500]="Label",JH[JH.Brush=500]="Brush",JH[JH.CustomMark=500]="CustomMark",JH[JH.Interaction=700]="Interaction",t.LayoutLevel=void 0,(QH=t.LayoutLevel||(t.LayoutLevel={}))[QH.Indicator=10]="Indicator",QH[QH.Region=20]="Region",QH[QH.Axis=30]="Axis",QH[QH.DataZoom=40]="DataZoom",QH[QH.Player=40]="Player",QH[QH.ScrollBar=40]="ScrollBar",QH[QH.Legend=50]="Legend",QH[QH.Title=70]="Title",QH[QH.CustomMark=70]="CustomMark",t.AttributeLevel=void 0,($H=t.AttributeLevel||(t.AttributeLevel={}))[$H.Default=0]="Default",$H[$H.Theme=1]="Theme",$H[$H.Chart=2]="Chart",$H[$H.Base_Series=3]="Base_Series",$H[$H.Series=4]="Series",$H[$H.Mark=5]="Mark",$H[$H.User_Chart=6]="User_Chart",$H[$H.User_Series=7]="User_Series",$H[$H.User_Mark=8]="User_Mark",$H[$H.User_SeriesStyle=9]="User_SeriesStyle",$H[$H.Built_In=99]="Built_In";var tN=function(){function t(){this._children=[],this._markNameMap={},this._infoMap=new Map}return t.prototype.getMarkNameMap=function(){return this._markNameMap},t.prototype.addMark=function(e,i){j(e)||(this._children.push(e),this._markNameMap[e.name]=e,this._infoMap.set(e,gt({},t.defaultMarkInfo,i)))},t.prototype.removeMark=function(t){var e=this._children.findIndex((function(e){return e.name===t}));e>=0&&(this._infoMap.delete(this._children[e]),delete this._markNameMap[t],this._children.splice(e,1))},t.prototype.clear=function(){this._children=[],this._markNameMap={},this._infoMap.clear()},t.prototype.forEach=function(t){this._children.forEach(t)},t.prototype.includes=function(t,e){return this._children.includes(t,e)},t.prototype.get=function(t){return isNaN(Number(t))?this._markNameMap[t]:this._children[t]},t.prototype.getMarks=function(){return this._children.slice()},t.prototype.getMarksInType=function(t){var e=St(t);return this._children.filter((function(t){return e.includes(t.type)}))},t.prototype.getMarkInId=function(t){return this._children.find((function(e){return e.id===t}))},t.prototype.getMarkWithInfo=function(t){var e=this;return this._children.find((function(i){return Object.keys(t).every((function(n){return t[n]===e._infoMap.get(i)[n]}))}))},t.defaultMarkInfo={},t}(),eN=function(){function t(t){this._option=t,this.getCompiler=this._option.getCompiler}return t.prototype.getOption=function(){return this._option},t.prototype.getStage=function(){var t;return null===(t=this.getCompiler())||void 0===t?void 0:t.getStage()},t.prototype.release=function(){this._option=null,this.getCompiler=null},t}(),iN=function(){function t(t){this._option=t,this.type=t.type}return t.prototype._initTheme=function(t,e){return this._theme=this.getTheme(t,e),this._mergeThemeToSpec(t,e)},t.prototype.getTheme=function(t,e){},t.prototype.transformSpec=function(t,e,i){this._transformSpecBeforeMergingTheme(t,e,i);var n=this._initTheme(t,e);return this._transformSpecAfterMergingTheme(n.spec,e,i),n},t.prototype._transformSpecBeforeMergingTheme=function(t,e,i){},t.prototype._transformSpecAfterMergingTheme=function(t,e,i){},t.prototype._mergeThemeToSpec=function(t,e){var i=this._theme;if(this._shouldMergeThemeToSpec()){var n=this._getDefaultSpecFromChart(e),r=function(t){return XF({},i,n,t)};return q(t)?{spec:t.map((function(t){return r(t)})),theme:i}:{spec:r(t),theme:i}}return{spec:t,theme:i}},t.prototype._shouldMergeThemeToSpec=function(){return!0},t.prototype._getDefaultSpecFromChart=function(t){},t}(),nN=function(t){function e(e,i){var n,r=this;return(r=t.call(this,i)||this).transformerConstructor=iN,r.type="null",r.modelType="null",r.userId=void 0,r._data=null,r._layout=null,r.specKey="",r._marks=new tN,r._lastLayoutRect=null,r.id=_x(),r.userId=e.id,r._spec=e,r.effect={},r.event=new pH(i.eventDispatcher,i.mode),null===(n=i.map)||void 0===n||n.set(r.id,r),r}return M(e,t),e.prototype.getSpec=function(){return this._spec||{}},e.prototype.getSpecPath=function(){var t;return null===(t=this._option)||void 0===t?void 0:t.specPath},e.prototype.getSpecInfoPath=function(){var t,e,i;return null!==(e=null===(t=this._option)||void 0===t?void 0:t.specInfoPath)&&void 0!==e?e:null===(i=this._option)||void 0===i?void 0:i.specPath},e.prototype.getData=function(){return this._data},Object.defineProperty(e.prototype,"layout",{get:function(){return this._layout},enumerable:!1,configurable:!0}),e.prototype.getOption=function(){return this._option},e.prototype.getMarks=function(){var t,e;return null!==(e=null===(t=this._marks)||void 0===t?void 0:t.getMarks())&&void 0!==e?e:[]},e.prototype.getMarkNameMap=function(){var t;return null===(t=this._marks)||void 0===t?void 0:t.getMarkNameMap()},e.prototype.getMarkSet=function(){return this._marks},e.prototype.getChart=function(){return this._option.getChart()},Object.defineProperty(e.prototype,"_theme",{get:function(){var t;return null===(t=this.getSpecInfo())||void 0===t?void 0:t.theme},enumerable:!1,configurable:!0}),e.prototype._releaseEvent=function(){this.event.release()},e.prototype.created=function(){this.setAttrFromSpec()},e.prototype.init=function(t){},e.prototype.afterInit=function(){},e.prototype.getVisible=function(){var t;return!1!==(null===(t=this._spec)||void 0===t?void 0:t.visible)},e.prototype.onLayoutStart=function(t,e){var i;null===(i=this._layout)||void 0===i||i.onLayoutStart(t,e)},e.prototype.onLayoutEnd=function(){var t;null===(t=this._layout)||void 0===t||t.onLayoutEnd(),this.getMarks().forEach((function(t){return t.commit(!1,!0)}))},e.prototype.onEvaluateEnd=function(t){},e.prototype.onBeforeRender=function(){},e.prototype.onDataUpdate=function(){},e.prototype.beforeRelease=function(){},e.prototype.clear=function(){this.getMarks().forEach((function(t){var e;return null===(e=t.clear)||void 0===e?void 0:e.call(t)}))},e.prototype.release=function(){var e;this._releaseEvent(),this._spec=void 0,this.getMarks().forEach((function(t){return t.release()})),null===(e=this._data)||void 0===e||e.release(),this._data=null,this._marks.clear(),t.prototype.release.call(this)},e.prototype.updateSpec=function(t){var e,i=this._compareSpec(t,this._spec);return(i.reRender||i.reMake||i.reCompile)&&(null===(e=this._layout)||void 0===e||e.setWillLayoutTag()),this._spec=t,i},e.prototype._compareSpec=function(t,e){return{change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1}},e.prototype.reInit=function(t){t&&(this._spec=t),this.setAttrFromSpec()},e.prototype.updateLayoutAttribute=function(){},e.prototype.setAttrFromSpec=function(){var t;null===(t=this._layout)||void 0===t||t.setAttrFromSpec(this._spec,this._option.getChartViewRect())},e.prototype._convertMarkStyle=function(t){return T({},t)},e.prototype.setMarkStyle=function(t,e,i,n){U(t)&&U(e)&&t.setStyle(this._convertMarkStyle(e),i,n)},e.prototype.initMarkStyleWithSpec=function(t,e){var i=this;if(U(t)&&U(e)){var n=e.style,r=e.state,a=T({},e);n&&(a.style=this._convertMarkStyle(n)),r&&(a.state={},Object.keys(r).forEach((function(t){a.state[t]=i._convertMarkStyle(r[t])}))),t.initStyleWithSpec(a)}},e.prototype.stateKeyToSignalName=function(t,e){var i="".concat(mz,"_").concat(this.modelType,"_").concat(this.type,"_").concat(this.id,"_").concat(t);return e&&(i+="_".concat(e)),i},e.prototype.compileData=function(){var t;null===(t=this._data)||void 0===t||t.compile()},e.prototype.compileMarks=function(t){this.getMarks().forEach((function(e){e.compile({group:t})}))},e.prototype._createMark=function(t,e,i){void 0===e&&(e={});var n=t.type,r=t.name,a=e.parent,o=w(e,["parent"]),s=KF.createMark(n,r,T({model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._option.globalScale},o));return a?a.addMark(s):this.getCompiler().addRootMark(s),s&&(s.created(),i&&s.setMarkConfig(i)),s},e.prototype._getDataIdKey=function(){},e.prototype.getColorScheme=function(){var t,e;return null===(e=(t=this._option).getTheme)||void 0===e?void 0:e.call(t,"colorScheme")},e.prototype.getSpecInfo=function(){var t,e,i;return function(t,e,i){if(!j(e))return ut(t,e,i)}(null!==(i=null===(e=(t=this._option).getSpecInfo)||void 0===e?void 0:e.call(t))&&void 0!==i?i:{},this.getSpecInfoPath())},e.prototype.getSpecIndex=function(){var t=this.getSpecPath();if(!(null==t?void 0:t.length))return 0;var e=Number(t[t.length-1]);return isNaN(e)?0:e},e.prototype.updateAnimateStateCallback=function(t){this._aniamtionStateCallback=t},e.prototype.getAnimationStateCallback=function(){return this._aniamtionStateCallback},e}(eN),rN=function(){function e(e,i){var n,r=this;this.layoutClip=!1,this.autoIndent=!1,this._layoutStartPoint={x:0,y:0},this._layoutRect={width:0,height:0},this._layoutRectLevelMap={width:0,height:0},this._minWidth=null,this._maxWidth=null,this._minHeight=null,this._maxHeight=null,this._lastComputeRect=null,this._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0},this.getLayoutRect=function(){return r._layoutRect},this.layoutType="normal",this._layoutOrient="left",this.layoutPaddingLeft=0,this.layoutPaddingTop=0,this.layoutPaddingRight=0,this.layoutPaddingBottom=0,this.layoutOffsetX=0,this.layoutOffsetY=0,this.layoutLevel=t.LayoutLevel.Region,this._willLayoutTag=!0,this._model=e,this._option=i,this.layoutLevel=i.layoutLevel,this.layoutType=i.layoutType,i.layoutOrient&&(this.layoutOrient=i.layoutOrient),this._spec=null===(n=null==e?void 0:e.getSpec)||void 0===n?void 0:n.call(e)}return e.prototype.getSpec=function(){return this._spec||{}},e.prototype.getLayoutStartPoint=function(){return this._layoutStartPoint},Object.defineProperty(e.prototype,"layoutRectLevelMap",{get:function(){return this._layoutRectLevelMap},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minWidth",{get:function(){return this._minWidth},set:function(t){this._minWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minHeight",{get:function(){return this._minHeight},set:function(t){this._minHeight=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxHeight",{get:function(){return this._maxHeight},set:function(t){this._maxHeight=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastComputeRect",{get:function(){return this._lastComputeRect},enumerable:!1,configurable:!0}),e.prototype.getLastComputeOutBounds=function(){return this._lastComputeOutBounds},Object.defineProperty(e.prototype,"layoutOrient",{get:function(){return this._layoutOrient},set:function(t){this._layoutOrient=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"model",{get:function(){return this._model},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._model.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"willLayoutTag",{get:function(){return this._willLayoutTag},enumerable:!1,configurable:!0}),e.prototype._setLayoutAttributeFromSpec=function(t,e){var i,n,r,a;if(this._spec&&!1!==this._spec.visible){var o=RF(IF(t.padding),e,e);this._option.transformLayoutPadding&&(o=this._option.transformLayoutPadding(o)),this.layoutPaddingLeft=o.left,this.layoutPaddingRight=o.right,this.layoutPaddingTop=o.top,this.layoutPaddingBottom=o.bottom,this._minHeight=j(t.minHeight)?null!==(i=this._minHeight)&&void 0!==i?i:null:BF(t.minHeight,e.height,e),this._maxHeight=j(t.maxHeight)?null!==(n=this._maxHeight)&&void 0!==n?n:null:BF(t.maxHeight,e.height,e),this._minWidth=j(t.minWidth)?null!==(r=this._minWidth)&&void 0!==r?r:null:BF(t.minWidth,e.width,e),this._maxWidth=j(t.maxWidth)?null!==(a=this._maxWidth)&&void 0!==a?a:null:BF(t.maxWidth,e.width,e),t.width&&this.setLayoutRect({width:BF(t.width,e.width,e)},{width:9}),t.height&&this.setLayoutRect({height:BF(t.height,e.height,e)},{height:9}),j(t.offsetX)||(this.layoutOffsetX=BF(t.offsetX,e.width,e)),j(t.offsetY)||(this.layoutOffsetY=BF(t.offsetY,e.height,e)),t.alignSelf&&(this.alignSelf=t.alignSelf)}},e.prototype.setAttrFromSpec=function(t,e){var i,n,r,a;this._spec=t,this.layoutType=null!==(i=t.layoutType)&&void 0!==i?i:this.layoutType,this.layoutLevel=null!==(n=t.layoutLevel)&&void 0!==n?n:this.layoutLevel,this.layoutOrient=null!==(r=t.orient)&&void 0!==r?r:this.layoutOrient,this._setLayoutAttributeFromSpec(t,e),this.layoutClip=null!==(a=t.clip)&&void 0!==a?a:this.layoutClip},e.prototype.onLayoutStart=function(t,e){this._setLayoutAttributeFromSpec(this._spec,e)},e.prototype.onLayoutEnd=function(){},e.prototype._getAbsoluteSpecValue=function(t){var e=this,i={top:null,bottom:null,left:null,right:null};return["top","bottom","left","right"].forEach((function(n){j(e._spec[n])||(i[n]=BF(e._spec[n],"top"===n||"bottom"===n?t.height:t.width,t))})),i},e.prototype.absoluteLayoutInRect=function(t){var e=this._getAbsoluteSpecValue(t),i=e.top,n=e.bottom,r=e.left,a=e.right,o={width:t.width-this.layoutPaddingLeft-this.layoutPaddingRight,height:t.height-this.layoutPaddingTop-this.layoutPaddingBottom};j(r)||(o.width-=r),j(a)||(o.width-=a),j(i)||(o.height-=i),j(n)||(o.height-=n),this.setLayoutRect(o);var s=this.computeBoundsInRect(this.getLayoutRect()),l=s.width,u=s.height;this.setLayoutRect({width:l,height:u});var c={x:t.x,y:t.y};!0===this._spec.center?(c.x=t.x+.5*t.width-.5*l,c.y=t.y+.5*t.height-.5*u):(j(r)?j(a)||(c.x=t.x+t.width-this.layoutPaddingRight-a-l):c.x=t.x+r+this.layoutPaddingLeft,j(i)?j(n)||(c.y=t.y+t.height-this.layoutPaddingBottom-n-u):c.y=t.y+i+this.layoutPaddingTop),this.setLayoutStartPosition(c)},e.prototype.setLayoutStartPosition=function(t){var e,i;this._option.transformLayoutPosition&&(t=this._option.transformLayoutPosition(t)),et(t.x)&&(this._layoutStartPoint.x=t.x),et(t.y)&&(this._layoutStartPoint.y=t.y),null===(i=(e=this._model).afterSetLayoutStartPoint)||void 0===i||i.call(e,this._layoutStartPoint)},e.prototype.setLayoutRect=function(t,e){var i,n,r,a,o=t.width,s=t.height;et(o)&&(null!==(i=null==e?void 0:e.width)&&void 0!==i?i:0)>=this._layoutRectLevelMap.width&&(this._layoutRect.width=o,this._layoutRectLevelMap.width=null!==(n=null==e?void 0:e.width)&&void 0!==n?n:0),et(s)&&(null!==(r=null==e?void 0:e.height)&&void 0!==r?r:0)>=this._layoutRectLevelMap.height&&(this._layoutRect.height=s,this._layoutRectLevelMap.height=null!==(a=null==e?void 0:e.height)&&void 0!==a?a:0),this.setRectInSpec(this._layoutRect)},e.prototype.getLayout=function(){return{x:this._layoutStartPoint.x,y:this._layoutStartPoint.y,width:this._layoutRect.width,height:this._layoutRect.height}},e.prototype.mergeLayoutRect=function(t){var e={width:t.width,height:t.height};return this._layoutRectLevelMap.width>0&&(e.width=this._layoutRect.width),this._layoutRectLevelMap.height>0&&(e.height=this._layoutRect.height),e},e.prototype.getOrientPosAttribute=function(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"x":"y"},e.prototype.getOrientSizeAttribute=function(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"width":"height"},e.prototype.changeBoundsBySetting=function(t){return this._layoutRectLevelMap.width>0&&(t.x2=t.x1+this._layoutRect.width),this._layoutRectLevelMap.height>0&&(t.y2=t.y1+this._layoutRect.height),t.x1-=this._layoutStartPoint.x,t.x2-=this._layoutStartPoint.x,t.y1-=this._layoutStartPoint.y,t.y2-=this._layoutStartPoint.y,t},e.prototype.setRectInSpec=function(t){var e=T({},t);return this._layoutRectLevelMap.width<9?(j(this._minWidth)||(e.width=Math.max(e.width,this._minWidth)),j(this._maxWidth)||(e.width=Math.min(e.width,this._maxWidth))):e.width=this._layoutRect.width,this._layoutRectLevelMap.height<9?(j(this._minHeight)||(e.height=Math.max(e.height,this._minHeight)),j(this._maxHeight)||(e.height=Math.min(e.height,this._maxHeight))):e.height=this._layoutRect.height,e},e.prototype.computeBoundsInRect=function(t){if(this._lastComputeRect=t,!("region-relative"!==this.layoutType&&"region-relative-overlap"!==this.layoutType||(9!==this._layoutRectLevelMap.width||"left"!==this.layoutOrient&&"right"!==this.layoutOrient)&&(9!==this._layoutRectLevelMap.height||"bottom"!==this.layoutOrient&&"top"!==this.layoutOrient)))return this._layoutRect;var e=T({},this._model.getBoundsInRect(this.setRectInSpec(t),t));this.changeBoundsBySetting(e),this.autoIndent&&e.x2-e.x1>0&&e.y2-e.y1>0&&(this._lastComputeOutBounds.x1=Math.ceil(-e.x1),this._lastComputeOutBounds.x2=Math.ceil(e.x2-t.width),this._lastComputeOutBounds.y1=Math.ceil(-e.y1),this._lastComputeOutBounds.y2=Math.ceil(e.y2-t.height));var i=this.setRectInSpec(LF(e,t));return this._option.transformLayoutRect&&(i=this._option.transformLayoutRect(i)),i},e.prototype.getModelId=function(){return this._model.id},e.prototype.getModelVisible=function(){return this._model.getVisible()},e.prototype.setWillLayoutTag=function(){this._willLayoutTag=!0},e.prototype.clearWillLayoutTag=function(){this._willLayoutTag=!1},e}(),aN=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layoutType="normal",e.layoutLevel=0,e.layoutZIndex=0,e._forceLayoutTag=!1,e._layout=null,e._orient=null,e._layoutRect={width:0,height:0},e._layoutStartPos={x:0,y:0},e._isLayout=!0,e.getGraphicBounds=function(){return e._layout?{x1:e._layout.getLayoutStartPoint().x,y1:e._layout.getLayoutStartPoint().y,x2:e._layout.getLayoutStartPoint().x+e._layout.getLayoutRect().width,y2:e._layout.getLayoutStartPoint().y+e._layout.getLayoutRect().height}:{x1:0,x2:0,y1:0,y2:0}},e._transformLayoutRect=null,e._transformLayoutPosition=null,e._transformLayoutPadding=null,e}return M(e,t),Object.defineProperty(e.prototype,"layoutOrient",{get:function(){return this._orient},set:function(t){this._orient=t,this._layout&&(this._layout.layoutOrient=t)},enumerable:!1,configurable:!0}),e.prototype.initLayout=function(){"none"!==this.layoutType&&(this._layout=new rN(this,{layoutType:this.layoutType,layoutLevel:this.layoutLevel,layoutOrient:this._orient,transformLayoutRect:this._transformLayoutRect,transformLayoutPosition:this._transformLayoutPosition,transformLayoutPadding:this._transformLayoutPadding}),this._orient&&"radius"!==this._orient&&"angle"!==this._orient&&this._layout&&(this._layout.layoutOrient=this._orient))},e.prototype.onLayoutStart=function(e,i){this._isLayout=!0,t.prototype.onLayoutStart.call(this,e,i)},e.prototype.onLayoutEnd=function(){t.prototype.onLayoutEnd.call(this),this.updateLayoutAttribute();var e=this.getLayoutRect();!this._forceLayoutTag&&bt(this._lastLayoutRect,e)||(this._lastLayoutRect=T({},e)),this._forceLayoutTag=!1,this._isLayout=!1},e.prototype.afterSetLayoutStartPoint=function(t){},e.prototype._forceLayout=function(){var t,e;this._isLayout||(null===(t=this._layout)||void 0===t||t.setWillLayoutTag(),this._forceLayoutTag=!0,null===(e=this._option.globalInstance.getChart())||void 0===e||e.setLayoutTag(!0))},e.prototype.getLayoutStartPoint=function(){return this._layout?this._layout.getLayoutStartPoint():this._layoutStartPos},e.prototype.setLayoutStartPosition=function(t){return this._layout?this._layout.setLayoutStartPosition(t):this._layoutStartPos=gt(this._layoutStartPos,t)},e.prototype.getLayoutRect=function(){return this._layout?this._layout.getLayoutRect():this._layoutRect},e.prototype.setLayoutRect=function(t,e){return this._layout?this._layout.setLayoutRect(t):this._lastLayoutRect=gt(this._layoutRect,t)},e.prototype.getLastComputeOutBounds=function(){var t;return null===(t=this._layout)||void 0===t?void 0:t.getLastComputeOutBounds()},e.prototype.setAttrFromSpec=function(){var e,i,n,r,a;t.prototype.setAttrFromSpec.call(this),this.layoutClip=null!==(e=this._spec.clip)&&void 0!==e?e:this.layoutClip,this.layoutZIndex=null!==(i=this._spec.zIndex)&&void 0!==i?i:this.layoutZIndex,this.layoutType=null!==(n=this._spec.layoutType)&&void 0!==n?n:this.layoutType,this._orient=null!==(r=this._spec.orient)&&void 0!==r?r:this._orient,this.layoutLevel=null!==(a=this._spec.layoutLevel)&&void 0!==a?a:this.layoutLevel},e}(nN),oN=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._initTheme=function(t,e){return{spec:t,theme:this._theme}},e}(iN),sN=function(e){function i(n,r){var a,o=this;return(o=e.call(this,n,r)||this).transformerConstructor=oN,o.modelType="region",o.specKey="region",o.type=i.type,o._series=[],o.layoutType="region",o.layoutZIndex=t.LayoutZIndex.Region,o.seriesDataFilterOver=function(){o.event.emit(t.ChartEvent.regionSeriesDataFilterOver,{model:o,chart:o.getChart()}),o._series.forEach((function(t){t.getViewDataFilter()&&t.reTransformViewData()}))},o.getBoundsInRect=function(){return{x1:o._layout.getLayoutStartPoint().x,y1:o._layout.getLayoutStartPoint().y,x2:o._layout.getLayoutStartPoint().x+o._layout.getLayoutRect().width,y2:o._layout.getLayoutStartPoint().y+o._layout.getLayoutRect().height}},o.userId=n.id,o.coordinate=null!==(a=n.coordinate)&&void 0!==a?a:"cartesian",o}return M(i,e),i.prototype.getMaxWidth=function(){return this._layout.maxWidth},i.prototype.setMaxWidth=function(t){this._layout.maxWidth=t},i.prototype.getMaxHeight=function(){return this._layout.maxHeight},i.prototype.setMaxHeight=function(t){this._layout.maxHeight=t},i.prototype.getGroupMark=function(){return this._groupMark},i.prototype.getInteractionMark=function(){return this._interactionMark},i.prototype.getStackInverse=function(){return!0===this._spec.stackInverse},i.prototype.getStackSort=function(){return!0===this._spec.stackSort},i.prototype._getClipDefaultValue=function(){var t,e,i,n,r=this._option.getChart().getSpec(),a=null===(e=null===(t=r.dataZoom)||void 0===t?void 0:t.some)||void 0===e?void 0:e.call(t,(function(t){var e;return"axis"===(null!==(e=t.filterMode)&&void 0!==e?e:"filter")})),o=null===(n=null===(i=r.scrollBar)||void 0===i?void 0:i.some)||void 0===n?void 0:n.call(i,(function(t){var e;return"axis"===(null!==(e=t.filterMode)&&void 0!==e?e:"axis")}));return!(!a&&!o)||this._layout.layoutClip},i.prototype.created=function(){var i,n,r=this;this.initLayout(),e.prototype.created.call(this);var a=null!==(i=this._spec.clip)&&void 0!==i?i:this._getClipDefaultValue();this._groupMark=this._createGroupMark("regionGroup",this.userId,this.layoutZIndex),this._spec.roam&&this._groupMark.setMarkConfig({interactive:!0}),this._interactionMark=this._createGroupMark("regionInteractionGroup",(null!==(n=this.userId)&&void 0!==n?n:this.type)+"_interaction",t.LayoutZIndex.Interaction),lt(this._spec.style)||(this._backgroundMark=this._createMark({type:"rect",name:"regionBackground"},{parent:this._groupMark}),a&&(this._foregroundMark=this._createMark({type:"rect",name:"regionForeground"},{parent:this._groupMark})),[this._backgroundMark,this._foregroundMark].forEach((function(e){e&&(e.created(),r.setMarkStyle(e,{width:function(){return r.getLayoutRect().width},height:function(){return r.getLayoutRect().height}},"normal",t.AttributeLevel.Built_In),r._groupMark.addMark(e))})),this._backgroundMark&&this._backgroundMark.setMarkConfig({zIndex:t.LayoutZIndex.SeriesGroup-1}),this._foregroundMark&&this._foregroundMark.setMarkConfig({zIndex:t.LayoutZIndex.Mark+1}))},i.prototype._createGroupMark=function(e,i,n){var r,a,o=this,s=this._createMark({type:"group",name:e});s.setUserId(i),s.setMarkConfig({zIndex:n});var l=null!==(r=this._spec.clip)&&void 0!==r?r:this._getClipDefaultValue();return this.setMarkStyle(s,{x:function(){return o.getLayoutStartPoint().x},y:function(){return o.getLayoutStartPoint().y},width:function(){return o.getLayoutRect().width},height:function(){return o.getLayoutRect().height},clip:l},"normal",t.AttributeLevel.Built_In),this.setMarkStyle(s,{cornerRadius:null===(a=this._spec.style)||void 0===a?void 0:a.cornerRadius},"normal",t.AttributeLevel.User_Mark),this._marks.addMark(s),s},i.prototype.init=function(t){e.prototype.init.call(this,t),this.initMark(),this.initSeriesDataflow()},i.prototype.initMark=function(){this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()},i.prototype._initBackgroundMarkStyle=function(){var e,i;this._backgroundMark&&(this.setMarkStyle(this._backgroundMark,T({fillOpacity:(null===(e=this._spec.style)||void 0===e?void 0:e.fill)?1:0},this._spec.style),"normal",t.AttributeLevel.User_Mark),(null!==(i=this._spec.clip)&&void 0!==i?i:this._getClipDefaultValue())&&this.setMarkStyle(this._backgroundMark,{strokeOpacity:0},"normal",t.AttributeLevel.Built_In))},i.prototype._initForegroundMarkStyle=function(){this._foregroundMark&&this.setMarkStyle(this._foregroundMark,T(T({},this._spec.style),{fillOpacity:0,pickable:!1}),"normal",t.AttributeLevel.User_Mark)},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return bt(null==i?void 0:i.style,null==t?void 0:t.style)||(n.reMake=!0),n},i.prototype.reInit=function(t){e.prototype.reInit.call(this,t),this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()},i.prototype.addSeries=function(t){t&&(this._series.includes(t)||this._series.push(t))},i.prototype.removeSeries=function(t){if(t){var e=this._series.findIndex((function(e){return e===t}));e>=0&&this._series.splice(e,1)}},i.prototype.getSeries=function(t){return void 0===t&&(t={}),this._series.filter((function(e){var i,n;return(!t.name||(null==e?void 0:e.name)===t.name)&&(!t.userId||St(t.userId).includes(e.userId))&&(!U(t.specIndex)||St(t.specIndex).includes(e.getSpecIndex()))&&(!t.id||e.id===t.id)&&(!t.type||e.type===t.type)&&(!t.coordinateType||e.coordinate===t.coordinateType)&&(!t.dataName||(null===(n=null===(i=e.getRawData)||void 0===i?void 0:i.call(e))||void 0===n?void 0:n.name)===t.dataName)}))},i.prototype.getSeriesInName=function(t){return this.getSeries({name:t})[0]},i.prototype.getSeriesInUserId=function(t){return this.getSeries({userId:t})[0]},i.prototype.getSeriesInId=function(t){return this.getSeries({id:t})[0]},i.prototype.getSeriesInType=function(t){return this.getSeries({type:t})},i.prototype.getSeriesInCoordinateType=function(t){return this.getSeries({coordinateType:t})},i.prototype.getSeriesInDataName=function(t){return this.getSeries({dataName:t})},i.prototype.initSeriesDataflow=function(){var t=this._series.map((function(t){var e;return null!==(e=t.getViewDataFilter())&&void 0!==e?e:t.getViewData()})).filter((function(t){return!!t}));this._option.dataSet.multipleDataViewAddListener(t,"change",this.seriesDataFilterOver)},i.prototype.release=function(){e.prototype.release.call(this),this._series=[]},i.prototype.compileMarks=function(t){var e=this;this.getMarks().forEach((function(i){i.compile({group:t,context:{model:e}})}))},i.prototype.compile=function(){this.compileMarks()},i.prototype.onLayoutEnd=function(){this._series.forEach((function(t){return t.onLayoutEnd()})),e.prototype.onLayoutEnd.call(this)},i.type="region",i.transformerConstructor=oN,i.specKey="region",i}(aN);function lN(t){var e=[],i=[],n=[];return t.forEach((function(t){j(t.getSpec().position)||"start"===t.getSpec().position?e.push(t):"middle"===t.getSpec().position?i.push(t):"end"===t.getSpec().position&&n.push(t)})),{startItems:e,endItems:n,middleItems:i}}function uN(t,e,i){e?t.forEach((function(t){var e=At(t),n=e.getLayoutStartPoint().y+e.getLayoutRect().height-t[0].getLayoutStartPoint().y,r=(i-n)/2;t.forEach((function(t){t.setLayoutStartPosition({x:t.getLayoutStartPoint().x,y:t.getLayoutStartPoint().y+r})}))})):t.forEach((function(t){var e=At(t),n=e.getLayoutStartPoint().x+e.getLayoutRect().width-t[0].getLayoutStartPoint().x,r=(i-n)/2;t.forEach((function(t){t.setLayoutStartPosition({x:t.getLayoutStartPoint().x+r,y:t.getLayoutStartPoint().y})}))}))}function cN(t,e,i,n){var r;t.forEach((function(t,a){t.length>1&&(r=i[a],t.forEach((function(t){if(t.alignSelf&&"start"!==t.alignSelf){var i=t.getLayoutStartPoint(),a="middle"===t.alignSelf?.5:1,o=e?r-(t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight):r-(t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom);e?t.setLayoutStartPosition({x:i.x+n*o*a,y:i.y}):t.setLayoutStartPosition({x:i.x,y:i.y+n*o*a})}})))}))}function hN(t,e,i,n,r,a){if(t.length){var o=0,s="right"===r,l=s?-1:1,u=s?e.rightCurrent:e.leftCurrent,c=e.topCurrent,h=[],d=[],p=[];t.forEach((function(t){var n=vN(t,e,a).rect,r=n.height+t.layoutPaddingTop+t.layoutPaddingBottom,f=n.width+t.layoutPaddingLeft+t.layoutPaddingRight,v=s?-n.width-t.layoutPaddingRight:t.layoutPaddingLeft;t.setLayoutStartPosition({x:u+t.layoutOffsetX+v,y:c+t.layoutOffsetY+t.layoutPaddingTop}),(c+=r)>i&&d.length?(p.push(o),u+=l*o,o=f,c=e.topCurrent+r,t.setLayoutStartPosition({x:u+t.layoutOffsetX+v,y:e.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),h.push(d),d=[t]):(o=Math.max(o,f),d.push(t))})),p.push(o),h.push(d),cN(h,!0,p,l),n&&uN(h,!0,i),s?e.rightCurrent=u+l*o:e.leftCurrent=u+l*o}}function dN(t,e,i,n,r){if(t.length){var a=0,o="right"===n,s=o?-1:1,l=o?e.rightCurrent:e.leftCurrent,u=e.bottomCurrent,c=[],h=[],d=[];t.forEach((function(t){var i=vN(t,e,r).rect,n=i.height+t.layoutPaddingTop+t.layoutPaddingBottom,p=i.width+t.layoutPaddingLeft+t.layoutPaddingRight,f=o?-i.width-t.layoutPaddingRight:t.layoutPaddingLeft;u<n&&h.length?(d.push(a),l+=s*a,a=p,u=e.bottomCurrent,t.setLayoutStartPosition({x:l+t.layoutOffsetX+f,y:u+t.layoutOffsetY-i.height-t.layoutPaddingBottom}),c.push(h),h=[t]):(t.setLayoutStartPosition({x:l+t.layoutOffsetX+f,y:u+t.layoutOffsetY-i.height-t.layoutPaddingBottom}),a=Math.max(a,p),u-=n,h.push(t))})),d.push(a),c.push(h),cN(c,!0,d,s),o?e.rightCurrent=l+s*a:e.leftCurrent=l+s*a}}function pN(t,e,i,n,r,a){if(t.length){var o="top"===r,s=o?1:-1,l=0,u=e.leftCurrent,c=o?e.topCurrent:e.bottomCurrent,h=[],d=[],p=[];t.forEach((function(t){var n=vN(t,e,a).rect,r=n.height+t.layoutPaddingTop+t.layoutPaddingBottom,f=n.width+t.layoutPaddingLeft+t.layoutPaddingRight,v=o?t.layoutPaddingTop:-n.height-t.layoutPaddingBottom;t.setLayoutStartPosition({x:u+t.layoutOffsetX+t.layoutPaddingLeft,y:c+t.layoutOffsetY+v}),(u+=f)>i&&d.length?(p.push(l),u=e.leftCurrent+f,c+=s*l,l=r,t.setLayoutStartPosition({x:e.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:c+t.layoutOffsetY+v}),h.push(d),d=[t]):(l=Math.max(l,r),d.push(t))})),p.push(l),h.push(d),cN(h,!1,p,s),n&&uN(h,!1,i),o?e.topCurrent=c+s*l:e.bottomCurrent=c+s*l}}function fN(t,e,i,n,r){if(t.length){var a="top"===n,o=a?1:-1,s=0,l=e.rightCurrent,u=a?e.topCurrent:e.bottomCurrent,c=[],h=[],d=[];t.forEach((function(t){var i=vN(t,e,r).rect,n=i.height+t.layoutPaddingTop+t.layoutPaddingBottom,d=i.width+t.layoutPaddingLeft+t.layoutPaddingRight,p=a?t.layoutPaddingTop:-i.height-t.layoutPaddingBottom;l<d&&h.length?(l=e.rightCurrent,u+=o*s,s=n,t.setLayoutStartPosition({x:e.rightCurrent+t.layoutOffsetX-i.width-t.layoutPaddingRight,y:u+t.layoutOffsetY+p}),c.push(h),h=[t]):(h.push(t),t.setLayoutStartPosition({x:l+t.layoutOffsetX-i.width-t.layoutPaddingRight,y:u+t.layoutOffsetY+p}),s=Math.max(s,n),l-=d)})),d.push(s),c.push(h),cN(c,!1,d,o),a?e.topCurrent=u+o*s:e.bottomCurrent=u+o*s}}function vN(t,e,i,n){var r,a;void 0===n&&(n=!0);var o="recomputeHeight",s="recomputeWidth",l="width";"top"!==t.layoutOrient&&"bottom"!==t.layoutOrient||(o="recomputeWidth",s="recomputeHeight",l="height");var u=!(!t.willLayoutTag&&!1===i[o]);if(u){var c=T({},t.getLayoutRect()),h=t.lastComputeRect;r=e.getItemComputeLayoutRect(t),!t.willLayoutTag&&bt(r,h)?(u=!1,a=t.getLayoutRect()):(a=t.computeBoundsInRect(r),bt(c[l],a[l])?u=!1:(n&&t.setLayoutRect(a),i[s]=!0))}else r=t.getLastComputeOutBounds(),a=t.getLayoutRect();return{layoutRect:r,rect:a,layoutTag:u}}var gN,yN,mN,_N=function(){function t(t,e){this.leftCurrent=0,this.topCurrent=0,this.rightCurrent=0,this.bottomCurrent=0,this.recomputeWidth=!1,this.recomputeHeight=!1,this._onError=null==e?void 0:e.onError}return t.prototype._layoutInit=function(t,e,i,n){this._chartLayoutRect=i,this._chartViewBox=n,this.leftCurrent=i.x,this.topCurrent=i.y,this.rightCurrent=i.x+i.width,this.bottomCurrent=i.height+i.y,this.recomputeWidth=!1,this.recomputeHeight=!1,e.sort((function(t,e){return e.layoutLevel-t.layoutLevel}))},t.prototype._layoutNormalItems=function(t,e){this.layoutNormalInlineItems(t.filter((function(t){return"normal-inline"===t.layoutType})),e),this.layoutNormalItems(t.filter((function(t){return"normal"===t.layoutType})),e)},t.prototype._groupItems=function(t){var e=t.filter((function(t){return"region"===t.layoutType})),i=t.filter((function(t){return"region-relative"===t.layoutType})),n=t.filter((function(t){return"region-relative-overlap"===t.layoutType})),r=i.concat(n),a={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}};return n.forEach((function(t){a[t.layoutOrient].items.push(t)})),{regionItems:e,relativeItems:i,relativeOverlapItems:n,allRelatives:r,overlapItems:a}},t.prototype.layoutItems=function(t,e,i,n){this._layoutInit(t,e,i,n);var r={recomputeWidth:this.recomputeWidth,recomputeHeight:this.recomputeHeight};this._layoutNormalItems(e,r);var a={left:this.leftCurrent,top:this.topCurrent,right:this.rightCurrent,bottom:this.bottomCurrent},o=this._groupItems(e),s=o.regionItems,l=o.relativeItems,u=o.relativeOverlapItems,c=o.allRelatives,h=o.overlapItems;this.layoutRegionItems(s,l,u,h,r),this._processAutoIndent(s,l,u,h,c,a,r),this.layoutAbsoluteItems(e.filter((function(t){return"absolute"===t.layoutType}))),e.forEach((function(t){t.clearWillLayoutTag()}))},t.prototype._processAutoIndent=function(t,e,i,n,r,a,o){if(void 0===n&&(n={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}}),r.some((function(t){return t.autoIndent}))){var s=this._checkAutoIndent(r,a),l=s.top,u=s.bottom,c=s.left,h=s.right;(l||u||c||h)&&(this.topCurrent=a.top+l,this.bottomCurrent=a.bottom-u,this.leftCurrent=a.left+c,this.rightCurrent=a.right-h,this.layoutRegionItems(t,e,i,n,o))}},t.prototype.layoutNormalItems=function(t,e){var i=this;t.forEach((function(t){var n=vN(t,i,e).rect;"left"===t.layoutOrient?(t.setLayoutStartPosition({x:i.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:i.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),i.leftCurrent+=n.width+t.layoutPaddingLeft+t.layoutPaddingRight):"top"===t.layoutOrient?(t.setLayoutStartPosition({x:i.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:i.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),i.topCurrent+=n.height+t.layoutPaddingTop+t.layoutPaddingBottom):"right"===t.layoutOrient?(t.setLayoutStartPosition({x:i.rightCurrent+t.layoutOffsetX-n.width-t.layoutPaddingRight,y:i.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),i.rightCurrent-=n.width+t.layoutPaddingLeft+t.layoutPaddingRight):"bottom"===t.layoutOrient&&(t.setLayoutStartPosition({x:i.leftCurrent+t.layoutOffsetX+t.layoutPaddingRight,y:i.bottomCurrent+t.layoutOffsetY-n.height-t.layoutPaddingBottom}),i.bottomCurrent-=n.height+t.layoutPaddingTop+t.layoutPaddingBottom)}))},t.prototype.layoutNormalInlineItems=function(t,e){var i=t.filter((function(t){return"left"===t.layoutOrient})),n=t.filter((function(t){return"right"===t.layoutOrient})),r=t.filter((function(t){return"top"===t.layoutOrient})),a=t.filter((function(t){return"bottom"===t.layoutOrient})),o=this._chartLayoutRect.width+this._chartLayoutRect.x,s=this._chartLayoutRect.height+this._chartLayoutRect.y;return i.length&&function(t,e,i,n){var r=lN(t),a=r.startItems,o=r.middleItems,s=r.endItems;a.length&&hN(a,e,i,!1,"left",n),o.length&&hN(o,e,i,!0,"left",n),s.length&&dN(s,e,0,"left",n)}(i,this,s,e),r.length&&function(t,e,i,n){var r=lN(t),a=r.startItems,o=r.middleItems,s=r.endItems;a.length&&pN(a,e,i,!1,"top",n),o.length&&pN(o,e,i,!0,"top",n),s.length&&fN(s,e,0,"top",n)}(r,this,o,e),n.length&&function(t,e,i,n){var r=lN(t),a=r.startItems,o=r.middleItems,s=r.endItems;a.length&&hN(a,e,i,!1,"right",n),o.length&&hN(o,e,i,!0,"right",n),s.length&&dN(s,e,0,"right",n)}(n,this,s,e),a.length&&function(t,e,i,n){var r=lN(t),a=r.startItems,o=r.middleItems,s=r.endItems;a.length&&pN(a,e,i,!1,"bottom",n),o.length&&pN(o,e,i,!0,"bottom",n),s.length&&fN(s,e,0,"bottom",n)}(a,this,o,e),!0},t.prototype._layoutRelativeOverlap=function(t,e,i){var n=this;e.items.forEach((function(t){var r=vN(t,n,i).rect;e.rect.width=Math.max(r.width+t.layoutPaddingLeft+t.layoutPaddingRight,e.rect.width),e.rect.height=Math.max(r.height+t.layoutPaddingTop+t.layoutPaddingBottom,e.rect.height)})),e.items.forEach((function(i){bt(i.getLayoutRect(),e.rect)||i.setLayoutRect(e.rect),"left"===t?i.setLayoutStartPosition({x:n.leftCurrent+i.layoutOffsetX}):"right"===t?i.setLayoutStartPosition({x:n.rightCurrent-e.rect.width+i.layoutOffsetX}):"top"===t?i.setLayoutStartPosition({x:n.topCurrent+i.layoutOffsetY}):i.setLayoutStartPosition({x:n.bottomCurrent-e.rect.height+i.layoutOffsetY})})),"left"===t?this.leftCurrent+=e.rect.width:"right"===t?this.rightCurrent-=e.rect.width:"top"===t?this.topCurrent+=e.rect.height:this.bottomCurrent-=e.rect.height},t.prototype._layoutRelativeItem=function(t,e){var i=vN(t,this,e,!1).rect;"left"===t.layoutOrient||"right"===t.layoutOrient?t.setLayoutRect({width:i.width}):t.setLayoutRect({height:i.height}),"left"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft}),this.leftCurrent+=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"right"===t.layoutOrient?(this.rightCurrent-=i.width+t.layoutPaddingLeft+t.layoutPaddingRight,t.setLayoutStartPosition({x:this.rightCurrent+t.layoutOffsetX+t.layoutPaddingLeft})):"top"===t.layoutOrient?(t.setLayoutStartPosition({y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.topCurrent+=i.height+t.layoutPaddingTop+t.layoutPaddingBottom):"bottom"===t.layoutOrient&&(this.bottomCurrent-=i.height+t.layoutPaddingTop+t.layoutPaddingBottom,t.setLayoutStartPosition({y:this.bottomCurrent+t.layoutOffsetY+t.layoutPaddingTop}))},t.prototype._layoutRegionItem=function(t,e,i){var n=this,r=Math.max(Math.min.apply(Math,R([e],B(t.map((function(t){var e;return null!==(e=t.maxWidth)&&void 0!==e?e:Number.MAX_VALUE}))),!1)),0),a=Math.max(Math.min.apply(Math,R([i],B(t.map((function(t){var e;return null!==(e=t.maxHeight)&&void 0!==e?e:Number.MAX_VALUE}))),!1)),0);return t.forEach((function(t){var e=r-t.layoutPaddingLeft-t.layoutPaddingRight,i=a-t.layoutPaddingTop-t.layoutPaddingBottom;t.setLayoutRect({width:e,height:i}),t.setLayoutStartPosition({x:n.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:n.topCurrent+t.layoutOffsetY+t.layoutPaddingTop})})),{regionHeight:a,regionWidth:r}},t.prototype.layoutRegionItems=function(t,e,i,n,r){var a=this;void 0===n&&(n={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}});var o=(this.rightCurrent,this.leftCurrent),s=(this.bottomCurrent,this.topCurrent);e.filter((function(t){return"left"===t.layoutOrient||"right"===t.layoutOrient})).forEach((function(t){a._layoutRelativeItem(t,r)})),this._layoutRelativeOverlap("left",n.left,r),this._layoutRelativeOverlap("right",n.right,r),o=this.rightCurrent-this.leftCurrent,e.filter((function(t){return"top"===t.layoutOrient||"bottom"===t.layoutOrient})).forEach((function(t){a._layoutRelativeItem(t,r)})),this._layoutRelativeOverlap("top",n.top,r),this._layoutRelativeOverlap("bottom",n.bottom,r),s=this.bottomCurrent-this.topCurrent;var l=this._layoutRegionItem(t,o,s),u=l.regionWidth,c=l.regionHeight;e.concat(i).forEach((function(e){if(["left","right"].includes(e.layoutOrient)){var i=a.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({height:i.getLayoutRect().height}),e.setLayoutStartPosition({y:i.getLayoutStartPoint().y+e.layoutOffsetY+e.layoutPaddingTop}),"right"===e.layoutOrient&&e.setLayoutStartPosition({x:e.getLayoutStartPoint().x+u-o})}else if(["top","bottom"].includes(e.layoutOrient)){i=a.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({width:i.getLayoutRect().width}),e.setLayoutStartPosition({x:i.getLayoutStartPoint().x+e.layoutOffsetX+e.layoutPaddingLeft}),"bottom"===e.layoutOrient&&e.setLayoutStartPosition({y:e.getLayoutStartPoint().y+c-s})}}))},t.prototype.layoutAbsoluteItems=function(t){var e=this;t.forEach((function(t){t.willLayoutTag&&t.absoluteLayoutInRect(e._chartLayoutRect)}))},t.prototype.filterRegionsWithID=function(t,e){var i,n=t.find((function(t){return t.getModelId()===e}));return n||(null!==(i=this._onError)&&void 0!==i?i:hx)("can not find target region item, invalid id"),n},t.prototype.getItemComputeLayoutRect=function(t){return{width:this.rightCurrent-this.leftCurrent-t.layoutPaddingLeft-t.layoutPaddingRight,height:this.bottomCurrent-this.topCurrent-t.layoutPaddingTop-t.layoutPaddingBottom}},t.prototype._checkAutoIndent=function(t,e){var i=this,n={top:0,left:0,bottom:0,right:0};return t.forEach((function(t){if(t.getModelVisible()&&t.autoIndent){var r="left"===t.layoutOrient||"right"===t.layoutOrient,a=t.getLastComputeOutBounds(),o=i._getOutInLayout(a,t,e);r?(n.top=Math.max(n.top,o.top),n.bottom=Math.max(n.bottom,o.bottom)):(n.left=Math.max(n.left,o.left),n.right=Math.max(n.right,o.right))}})),n},t.prototype._getOutInLayout=function(t,e,i){var n=e.getLayoutStartPoint(),r=n.x,a=n.y,o=e.getLayoutRect(),s=o.width,l=o.height;return{left:i.left-(r-t.x1),right:r+s+t.x2-i.right,top:i.top-(a-t.y1),bottom:a+l+t.y2-i.bottom}},t.type="base",t}();!function(t){t.enter="enter",t.update="update",t.exit="exit",t.unChange="unChange"}(gN||(gN={})),t.STATE_VALUE_ENUM=void 0,(yN=t.STATE_VALUE_ENUM||(t.STATE_VALUE_ENUM={})).STATE_NORMAL="normal",yN.STATE_HOVER="hover",yN.STATE_HOVER_REVERSE="hover_reverse",yN.STATE_DIMENSION_HOVER="dimension_hover",yN.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",yN.STATE_SELECTED="selected",yN.STATE_SELECTED_REVERSE="selected_reverse",yN.STATE_SANKEY_EMPHASIS="selected",yN.STATE_SANKEY_EMPHASIS_REVERSE="blur",yN.STATE_HIGHLIGHT="highlight",yN.STATE_BLUR="blur",yN.STATE_ACTIVE="active",function(t){t.STATE_HOVER_REVERSE="hover_reverse",t.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",t.STATE_SELECTED_REVERSE="selected_reverse"}(mN||(mN={}));var bN,xN=["linear","radial","conical"],kN={linear:{x0:0,y0:0,x1:1,y1:1},radial:{x0:0,y0:0,x1:1,y1:1,r0:0,r1:1},conical:{x:.5,y:.5,startAngle:0,endAngle:2*Math.PI}};var SN={};Object.values(t.STATE_VALUE_ENUM).forEach((function(t){SN[t]=!0})),(bN={})[t.STATE_VALUE_ENUM.STATE_HOVER]=t.STATE_VALUE_ENUM.STATE_HOVER_REVERSE,bN[t.STATE_VALUE_ENUM.STATE_SELECTED]=t.STATE_VALUE_ENUM.STATE_SELECTED_REVERSE,bN[t.STATE_VALUE_ENUM.STATE_DIMENSION_HOVER]=t.STATE_VALUE_ENUM.STATE_DIMENSION_HOVER_REVERSE;var AN,MN=function(t){function e(e,i){var n=t.call(this,e)||this;return n._stateInfoList=[],n._mark=i,n}return M(e,t),e.prototype.getStateInfoList=function(){return this._stateInfoList},e.prototype._getDefaultStateMap=function(){return{markUpdateRank:1}},e.prototype.getStateInfo=function(t){return this._stateInfoList.find((function(e){return e.stateValue===t}))},e.prototype.addStateInfo=function(t){if(!this.getStateInfo(t.stateValue)){t.level=t.level||0;for(var e=!0,i=0;i<this._stateInfoList.length;i++){var n=this._stateInfoList[i].level;if(n&&n>t.level){this._stateInfoList.splice(i,0,t),e=!1;break}}e&&this._stateInfoList.push(t)}},e.prototype._clearStateBeforeSet=function(t){t.datums=null,t.items=null,t.fields=null,t.filter=null},e.prototype.changeStateInfo=function(t){var e=this.getStateInfo(t.stateValue);if(e){if(void 0!==t.datums&&(this._clearStateBeforeSet(e),e.datums=t.datums,e.datumKeys=t.datumKeys),void 0!==t.items&&(this._clearStateBeforeSet(e),e.items=t.items),void 0!==t.fields)if(this._clearStateBeforeSet(e),null===t.fields)e.fields=t.fields;else for(var i in e.fields=e.fields||{},t.fields){var n=t.fields[i];e.fields[i]=e.fields[i]||{};var r=e.fields[i];U(n.domain)&&(r.domain=n.domain),U(n.type)&&(r.type=n.type)}t.filter&&(this._clearStateBeforeSet(e),e.filter=t.filter)}else this.addStateInfo(t)},e.prototype.clearStateInfo=function(t){var e=this;t.forEach((function(t){e.getStateInfo(t)&&e.changeStateInfo({stateValue:t,datumKeys:null,datums:null,fields:null,items:null,filter:null,cache:{}})}))},e.prototype._isMultiMark=function(){return!this._mark||function(t){return zH.includes(t)}(this._mark.type)},e.prototype.checkOneState=function(t,e,i){var n,r=!1,a=!1;if(U(i.datums)&&i.datums.length>0)r=this.checkDatumState(i,e),a=!0;else if(i.items)r=null!==(n=this.checkItemsState(i,t))&&void 0!==n&&n,a=!0;else if(i.fields)r=this.checkFieldsState(i,e,t),a=!0;else if(!r&&i.filter){var o={mark:this._mark,renderNode:t,type:this._mark.type};r=i.filter(null==e?void 0:e[0],o),a=!0}return a?r?"in":"out":"skip"},e.prototype.checkState=function(t,e){for(var i,n=(null!==(i=t.context.states)&&void 0!==i?i:[]).filter((function(t){return function(t){return!!SN[t]}(t)})).map((function(t){return[t,10]})),r=0;r<this._stateInfoList.length;r++){var a=this._stateInfoList[r],o=this.checkOneState(t,e,a);"skip"!==o&&("in"===o&&n.push([a.stateValue,a.level]))}return n.map((function(t){return t[0]}))},e.prototype.checkDatumState=function(t,e){var i=!1,n=e[0];if(q(t.datums)){var r=this._isMultiMark(),a=t.datumKeys||Object.keys(t.datums[0]).filter((function(t){return!t.startsWith(mz)}));i=t.datums.some((function(t){return r&&q(null==t?void 0:t.items)?a.every((function(e){var i,r;return(null===(r=null===(i=null==t?void 0:t.items)||void 0===i?void 0:i[0])||void 0===r?void 0:r[e])===(null==n?void 0:n[e])})):a.every((function(e){return(null==t?void 0:t[e])===(null==n?void 0:n[e])}))}))}else if(W(t.datums)){var o=t.datumKeys||Object.keys(t.datums).filter((function(t){return!t.startsWith(mz)})),s=this._isMultiMark();i=o.every((function(e){var i,r;return s?(null===(i=t.datums.items)||void 0===i?void 0:i[0][e])===n[e]:(null===(r=t.datums)||void 0===r?void 0:r[e])===n[e]}))}else i=e===t.datums;return i},e.prototype.checkItemsState=function(t,e){var i;return null===(i=t.items)||void 0===i?void 0:i.includes(e)},e.prototype.checkFieldsState=function(t,e,i){var n,r=!0,a=function(a){var s=t.fields[a],l=s.type,u=s.domain,c=null===(n=e[0])||void 0===n?void 0:n[a];if(JR(l)&&u.length>1){if(o.checkLinearFieldState(u,a,e,i))return r=!1,"break";r=!0}else{if(!u.some((function(t){return t===c})))return r=!1,"break";r=!0}},o=this;for(var s in t.fields){if("break"===a(s))break}return r},e.prototype.checkLinearFieldState=function(t,e,i,n){var r,a=this._isMultiMark()?null===(r=i[0])||void 0===r?void 0:r[e]:i[e];return a<t[0]||a>t[t.length-1]},e.prototype.release=function(){},e}(function(t){function e(e){var i=t.call(this,e)||this;return i.initStateMap(),i}return M(e,t),e.prototype.compile=function(){},e.prototype.getStateMap=function(){return this._stateMap},e.prototype._getDefaultStateMap=function(){return{}},e.prototype.initStateMap=function(t){this._stateMap=null!=t?t:this._getDefaultStateMap()},e.prototype.updateState=function(t,e){if(t&&(gt(this._stateMap,t),!e))return this.getCompiler().renderNextTick()},e}(eN)),TN=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=_x(),e._compiledProductId=null,e}return M(e,t),e.prototype.getProductId=function(){var t;return null!==(t=this._compiledProductId)&&void 0!==t?t:this.generateProductId()},e.prototype.compile=function(t){this._compileProduct(t)},e.prototype.setTransform=function(t){this._transform=t},e.prototype.runTransforms=function(t,e){if(!t||!t.length)return e;var i=e;return t.forEach((function(t){var e;i=null===(e=KF.getGrammarTransform(t.type))||void 0===e?void 0:e.transform(t,i)})),i},e}(eN),wN=function(t){function e(e,i){var n=t.call(this,e)||this;return n._data=null,n._data=i,n}return M(e,t),e.prototype.getProduct=function(){return this._product||(this._product=this.runTransforms(this._transform,this.getLatestData())),this._product},e.prototype.getDataView=function(){return this._data},e.prototype.setDataView=function(t){this._data=t},e.prototype.getLatestData=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.latestData},e.prototype.removeProduct=function(){this._product=null,this._prevProduct=null,this._compiledProductId=null},e.prototype.release=function(){this.removeProduct(),t.prototype.release.call(this),this._data=null},e.prototype.addRelatedMark=function(t){this._relatedMarks||(this._relatedMarks={}),this._relatedMarks[t.id]=t},e.prototype.updateData=function(t){var e=this;if(this._compileProduct(),this._relatedMarks){var i=!1;if(Object.keys(this._relatedMarks).forEach((function(t){e._relatedMarks[t]&&(i=!0,e._relatedMarks[t].commit())})),!t&&i)return this.getCompiler().renderNextTick()}},e.prototype._compileProduct=function(){this._prevProduct=this._product,this._product=null},e.prototype.generateProductId=function(){var t;return"".concat(null===(t=this.getDataView())||void 0===t?void 0:t.name)},e}(TN),CN=function(t,e,i,n){return"function"==typeof t?t(e,i,n):t},EN=function(t,e,i,n,r){var a,o={prev:t.map((function(t){var e,i;return null===(i=null===(e=t.context)||void 0===e?void 0:e.data)||void 0===i?void 0:i[0]})),next:e.map((function(t){var e,i;return null===(i=null===(e=t.context)||void 0===e?void 0:e.data)||void 0===i?void 0:i[0]}))},s={prev:t.slice(),next:e.slice()},l=null!==(a=i.animation)&&void 0!==a?a:{},u=l.easing,c=CN(l.delay,r,o,s),h=CN(l.duration,r,o,s),d=CN(l.oneByOne,r,o,s),p=CN(l.splitPath,r,o,s),f=et(d)&&d>0?function(t){return Q(d)?t*d:!0===d?t*h:0}:void 0;1!==t.length&&0!==t.length||1!==e.length?1===t.length&&e.length>1?function(t,e,i){var n,r=e.filter((function(t){return t&&t.toCustomPath&&t.valid}));r.length||__DEV__&&console.error(r," is not validate"),t.valid&&t.toCustomPath||__DEV__&&console.error(t," is not validate");var a=("clone"===(null==i?void 0:i.splitPath)?nB:null!==(n=null==i?void 0:i.splitPath)&&void 0!==n?n:rB)(t,r.length,!1),o=null==i?void 0:i.onEnd,s=r.length,l=function(){0==--s&&o&&o()};r.forEach((function(e,n){var o,s=a[n],u=(null!==(o=null==i?void 0:i.delay)&&void 0!==o?o:0)+((null==i?void 0:i.individualDelay)?i.individualDelay(n,r.length,s,e):0);$P(s,e,Object.assign({},i,{onEnd:l,delay:u}),t.globalTransMatrix)}))}(t[0],e,{delay:c,duration:h,easing:u,onEnd:n,individualDelay:f,splitPath:p}):t.length>1&&1===e.length&&function(t,e,i){var n,r,a,o=t.filter((function(t){return t.toCustomPath&&t.valid}));o.length||__DEV__&&console.error(t," is not validate"),e.valid&&e.toCustomPath||__DEV__&&console.error(e," is not validate");var s=("clone"===(null==i?void 0:i.splitPath)?nB:null!==(n=null==i?void 0:i.splitPath)&&void 0!==n?n:rB)(e,o.length,!0),l=e.attribute;e.setAttribute("visible",!1);var u=o.map((function(t,e){return qP(t.toCustomPath(),s[e].toCustomPath(),{fromTransform:t.globalTransMatrix,toTransfrom:s[e].globalTransMatrix})})),c=o.map((function(t,e){return JP(t.attribute,l)}));if(null==i?void 0:i.individualDelay){var h=i.onEnd,d=o.length,p=function(){0==--d&&(e.setAttributes({visible:!0,ratio:null},!1,{type:kl.ANIMATE_END}),e.detachShadow(),h&&h())};s.forEach((function(e,n){var r,a,s,l=(null!==(r=i.delay)&&void 0!==r?r:0)+i.individualDelay(n,o.length,t[n],e),h=e.animate(Object.assign({},i,{onEnd:p}));h.wait(l),h.play(new QP({morphingData:u[n],saveOnEnd:!0,otherAttrs:c[n]},null!==(a=i.duration)&&void 0!==a?a:WP,null!==(s=i.easing)&&void 0!==s?s:GP))}))}else{var f=null==i?void 0:i.onEnd,v=i?Object.assign({},i):{};v.onEnd=function(){e.setAttribute("visible",!0,!1,{type:kl.ANIMATE_END}),e.detachShadow(),f&&f()};var g=e.animate(v);(null==i?void 0:i.delay)&&g.wait(i.delay),g.play(new tB({morphingData:u,otherAttrs:c},null!==(r=null==i?void 0:i.duration)&&void 0!==r?r:WP,null!==(a=null==i?void 0:i.easing)&&void 0!==a?a:GP))}}(t,e[0],{delay:c,duration:h,easing:u,onEnd:n,individualDelay:f,splitPath:p}):$P(t[0],e[0],{delay:c,duration:h,easing:u,onEnd:n})},PN=function(t,e){var i=Math.floor(t.length/e);return new Array(e).fill(0).map((function(n,r){return t.slice(i*r,r===e-1?t.length:i*(r+1))}))},BN=function(t){var e=t.getMarkConfig();U(e.morphElementKey)&&t.getGraphics().forEach((function(t){var i,n,r=null===(n=null===(i=t.context)||void 0===i?void 0:i.data)||void 0===n?void 0:n[0];r&&(t.context.morphKey=r[e.morphElementKey])}))},RN=function(e){function i(i,n){var r,a=this;return(a=e.call(this,n)||this).type=void 0,a.name="mark",a._markConfig={zIndex:t.LayoutZIndex.Mark,morph:!1},a._visible=!0,a.stateStyle={},a._unCompileChannel={},a._disabledAnimationStates=[],a._skipBeforeLayouted=!1,a._extensionChannel={},a._computeExChannel={},a._graphicMap=new Map,a._graphics=[],a._getEncoderOfStyle=function(t,e){if(e&&t){var i={};return Object.keys(e).forEach((function(e){a._unCompileChannel[e]||(i[e]=a._computeAttribute(e,t))})),i}return null},a._setGraphicFromMarkConfig=function(t){var e=a._markConfig,i=e.setCustomizedShape,n=e.graphicName;i&&(t.pathProxy=function(e){return i(t.context.data,e,new Mu)}),n&&(V(n)?t.name=n(t):t.name=n)},a._setStateOfGraphic=function(t){t.clearStates(),t.stateProxy=null,t.context.diffState!==gN.enter&&t.context.diffState!==gN.update||(t.stateProxy=function(e,i){var n;return a._runEncoderOfGraphic(null===(n=a._encoderOfState)||void 0===n?void 0:n[e],t)},t.context.states&&t.useStates(t.context.states))},a.name=i,a.model=n.model,a.key=n.key,a.state=new MN(n,a),a._attributeContext=n.attributeContext,null===(r=n.map)||void 0===r||r.set(a.id,a),a}return M(i,e),i.prototype.commit=function(t,e){e&&this.getMarks().length>0&&this.getMarks().forEach((function(t){return t.commit(!1,e)})),this._isCommited=!0,t&&this.getCompiler().renderNextTick()},i.prototype.uncommit=function(){this._isCommited=!1},i.prototype.isCommited=function(){return this._isCommited},i.prototype.getMarkConfig=function(){return this._markConfig},i.prototype.setMarkConfig=function(t){var e=this;Object.keys(t).forEach((function(i){e._markConfig[i]=t[i]}))},i.prototype.getVisible=function(){return this._visible},i.prototype.setVisible=function(t){this._visible=t},i.prototype.getUserId=function(){return this._userId},i.prototype.setUserId=function(t){U(t)&&(this._userId=t)},i.prototype.getDataView=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.getDataView()},i.prototype.setDataView=function(t){j(this._data)&&this.initMarkData(this._option),this._data.setDataView(t)},i.prototype.getData=function(){return this._data},i.prototype.setData=function(t){this._data=t,t&&t.addRelatedMark(this)},i.prototype.hasState=function(t){return t in this.state.getStateMap()},i.prototype.getState=function(t){return this.state.getStateMap()[t]},i.prototype.getAnimationConfig=function(){return this._animationConfig},i.prototype.setAnimationConfig=function(t){var e="group"===this.type?{selfOnly:!0}:{},i=function(t){var i,n=null!==(i=t.options)&&void 0!==i?i:{};return T(T(T({},e),t),{options:function(t,e,i){var r,a,o="function"==typeof n?n(t,e,i):n;if(e&&e.context&&e.context.compiler&&U(e.context.modelId)){var s=null===(r=e.context.compiler.getChart())||void 0===r?void 0:r.getModelById(e.context.modelId);return T(T({},o),{layoutRect:null===(a=null==s?void 0:s.getLayoutRect)||void 0===a?void 0:a.call(s)})}return T({},o)}})},n={};Object.keys(t).forEach((function(e){var r=t[e];q(r)?n[e]=r.map(i):U(r)&&(n[e]=i(r))})),this._animationConfig=n},i.prototype.disableAnimationByState=function(t){var e=St(t);this._disabledAnimationStates=R([],B(new Set(R(R([],B(this._disabledAnimationStates),!1),B(e),!1))),!1)},i.prototype.enableAnimationByState=function(t){var e=St(t);this._disabledAnimationStates=this._disabledAnimationStates.filter((function(t){return!e.includes(t)}))},i.prototype.setSkipBeforeLayouted=function(t){this._skipBeforeLayouted=t},i.prototype.setGroupKey=function(t){this._groupKey=t},i.prototype.getProduct=function(){return this._product},i.prototype.initMarkData=function(t){this._data=new wN(t),this._data.addRelatedMark(this)},i.prototype._compileProduct=function(t){this.commit(),this._context=null==t?void 0:t.context;var e=this.getProduct();if(this._visible){if(U(e))t.group&&e.parent!==t.group&&t.group.appendChild(e);else{if(!this.getCompiler().isInited)return;this._initProduct(null==t?void 0:t.group)}j(this._product)||(this.compileData(),this.compileState(),this.compileEncode())}else U(e)&&this.removeProduct()},i.prototype._initProduct=function(t){var e;if(this.getStage()){var i=this.getProductId();this._product=Vf("group"!==this.type?{pickable:!1,zIndex:this._markConfig.zIndex,overflow:this._markConfig.overflow}:{}),this._product.name=i,this._product.mark=this,(null!=t?t:null===(e=this.getCompiler())||void 0===e?void 0:e.getRootGroup()).appendChild(this._product),this._compiledProductId=i}},i.prototype.generateProductId=function(){return this._userId?"".concat(this._userId):"".concat(this.name,"_").concat(this.id)},i.prototype.layout=function(t){},i.prototype.compileData=function(){j(this._data)||this._data.compile()},i.prototype.compileEncode=function(){},i.prototype.compileState=function(){},i.prototype.compileAnimation=function(){},i.prototype.compileContext=function(t){this._context=T({markId:this.id,modelId:this.model.id,markUserId:this._userId,modelUserId:this.model.userId},t)},i.prototype.getContext=function(){return this._context},i.prototype.compileTransform=function(){},i.prototype.updateState=function(t,e){return this.commit(),this.state.updateState(t,e)},i.prototype.getMarks=function(){return[]},i.prototype.runAnimationByState=function(t){},i.prototype.stopAnimationByState=function(t){},i.prototype.pauseAnimationByState=function(t){},i.prototype.resumeAnimationByState=function(t){},i.prototype.removeProduct=function(){this._product&&this._product.parent&&this._product.parent.removeChild(this._product),this._product=null,this._compiledProductId=null},i.prototype.release=function(){this.state.release(),e.prototype.release.call(this),this._lastMark=null},i.prototype.setSimpleStyle=function(t){this._simpleStyle=t},i.prototype.getSimpleStyle=function(){return this._simpleStyle},i.prototype.created=function(){this._initStyle()},i.prototype.initStyleWithSpec=function(t){t&&(U(t.id)&&(this._userId=t.id),N(t.interactive)&&(this._markConfig.interactive=t.interactive),U(t.zIndex)&&(this._markConfig.zIndex=t.zIndex),N(t.visible)&&this.setVisible(t.visible),this._markConfig.setCustomizedShape=t.customShape,this._stateSort=t.stateSort,this._initSpecStyle(t))},i.prototype._transformStyleValue=function(t,e){if(t.scale){var i=t.scale,n=i.range();return i.range(n.map(e)),t}return"function"==typeof t?function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return e(t.apply(void 0,R([],B(i),!1)))}:e(t)},i.prototype.convertAngleToRadian=function(t){return this._transformStyleValue(t,Fe)},i.prototype.isUserLevel=function(e){return[t.AttributeLevel.User_Mark,t.AttributeLevel.User_Series,t.AttributeLevel.User_Chart,t.AttributeLevel.User_SeriesStyle].includes(e)},i.prototype.setStyle=function(t,e,i){var n=this;if(void 0===e&&(e="normal"),void 0===i&&(i=0),!j(t)){void 0===this.stateStyle[e]&&(this.stateStyle[e]={});var r=this.isUserLevel(i);Object.keys(t).forEach((function(a){var o=t[a];j(o)||(o=n._filterAttribute(a,o,e,i,r),n.setAttribute(a,o,e,i))}))}},i.prototype.getStyle=function(t,e){var i;return void 0===e&&(e="normal"),null===(i=this.stateStyle[e][t])||void 0===i?void 0:i.style},i.prototype._filterAttribute=function(t,e,i,n,r){var a=this,o=this._styleConvert(e);if(r)switch(t){case"angle":o=this.convertAngleToRadian(o);break;case"innerPadding":case"outerPadding":o=this._transformStyleValue(o,(function(t){return-t}));break;case"curveType":o=this._transformStyleValue(o,(function(t){return function(t,e){return"monotone"===t?"horizontal"===e?"monotoneY":"monotoneX":t}(t,a._option.model.direction)}))}return o},i.prototype.setReferer=function(t,e,i){var n,r,a=this;if(t)if(e&&i){var o=null!==(r=this.stateStyle[i])&&void 0!==r?r:((n={})[e]={},n);this.stateStyle[i][e]=T(T({},o[e]),{referer:t})}else Object.entries(this.stateStyle).forEach((function(e){var i=B(e,2),n=i[0],r=i[1];Object.entries(r).forEach((function(e){var i=B(e,2),r=i[0];i[1],a.stateStyle[n][r].referer=t}))}))},i.prototype.setPostProcess=function(t,e,i){var n;void 0===i&&(i="normal"),(null===(n=this.stateStyle[i])||void 0===n?void 0:n[t])&&(this.stateStyle[i][t].postProcess=e)},i.prototype.getAttribute=function(t,e,i){return void 0===i&&(i="normal"),this._computeAttribute(t,i)(e)},i.prototype.getAttributesOfState=function(t,e){var i=this;void 0===e&&(e="normal");var n=this.stateStyle[e];if(n){var r={};return Object.keys(n).forEach((function(n){i._unCompileChannel[n]||(r[n]=i._computeAttribute(n,e)(t))})),r}},i.prototype.setAttribute=function(t,e,i,n){var r,a=this;void 0===i&&(i="normal"),void 0===n&&(n=0),void 0===this.stateStyle[i]&&(this.stateStyle[i]={}),void 0===this.stateStyle[i][t]&&(this.stateStyle[i][t]={level:n,style:e,referer:void 0});var o=null===(r=this.stateStyle[i][t])||void 0===r?void 0:r.level;U(o)&&o<=n&&XF(this.stateStyle[i][t],{style:e,level:n}),"normal"!==i&&t in this._extensionChannel&&this._extensionChannel[t].forEach((function(t){void 0===a.stateStyle[i][t]&&(a.stateStyle[i][t]=a.stateStyle.normal[t])}))},i.prototype._getDefaultStyle=function(){return{visible:!0,x:0,y:0}},i.prototype._styleConvert=function(t){if(!t)return t;if(QR(t.type)||t.scale){var e=AF(t,{globalScale:this._option.globalScale,seriesId:this._option.seriesId});if(e)return{scale:e,field:t.field,changeDomain:t.changeDomain}}return t},i.prototype._computeAttribute=function(t,e){var i,n=this,r=null===(i=this.stateStyle[e])||void 0===i?void 0:i[t];r||(r=this.stateStyle.normal[t]);var a=this._computeStateAttribute(r,t,e),o=V(null==r?void 0:r.postProcess),s=t in this._computeExChannel;if(o&&s){var l=this._computeExChannel[t];return function(i){var o=a(i);return o=r.postProcess(o,i,n._attributeContext,n.getDataView()),l(t,i,e,o)}}if(o)return function(t){return r.postProcess(a(t),t,n._attributeContext,n.getDataView())};if(s){var u=this._computeExChannel[t];return function(i){return u(t,i,e,a(i))}}return a},i.prototype._computeStateAttribute=function(t,e,i){var n,r=this;return t?t.referer?t.referer._computeAttribute(e,i):t.style?"function"==typeof t.style?function(e){return t.style(e,r._attributeContext,{mark:r},r.getDataView())}:xN.includes(t.style.gradient)?this._computeGradientAttr(t.style):["outerBorder","innerBorder"].includes(e)?this._computeBorderAttr(t.style):QR(null===(n=t.style.scale)||void 0===n?void 0:n.type)?function(e){var i=e;return"series"===r.model.modelType&&r.model.getMarkData&&(i=r.model.getMarkData(e)),t.style.scale.scale(i[t.style.field])}:function(e){return t.style}:function(e){return t.style}:function(t){}},i.prototype._initStyle=function(){var t=this._getDefaultStyle();this.setStyle(t,"normal",0)},i.prototype._initSpecStyle=function(e){var i=this;e.style&&this.setStyle(e.style,"normal",t.AttributeLevel.User_Mark);var n=e.state;n&&Object.keys(n).forEach((function(e){var r=n[e];if("style"in r){var a=r.style,o={stateValue:e};"level"in r&&(o.level=r.level),"filter"in r&&(o=V(r.filter)?T({filter:r.filter},o):T(T({},r.filter),o)),i.state.addStateInfo(o),i.setStyle(a,e,t.AttributeLevel.User_Mark)}else i.setStyle(r,e,t.AttributeLevel.User_Mark)}))},i.prototype._computeGradientAttr=function(t){var e,i,n=this,r=t.gradient,a=t.scale,o=t.field,s=w(t,["gradient","scale","field"]),l=a,u=o;if(!(a&&o||"series"!==this.model.modelType)){var c=this.model.getColorAttribute(),h=c.scale,d=c.field;a||(l=h),u||(u=d)}var p=fF(pF(this.model.getColorScheme(),"series"===this.model.modelType?null===(i=(e=this.model).getSpec)||void 0===i?void 0:i.call(e):void 0),this.model.getDefaultColorDomain()),f=T(T({},kN[r]),s);return function(t){var e={},i=n.getDataView();return Object.keys(f).forEach((function(r){var a=f[r];"stops"===r?e.stops=a.map((function(e){var r=e.opacity,a=e.color,o=e.offset,s=null!=a?a:null==l?void 0:l.scale(t[u]);return V(a)&&(s=a(t,n._attributeContext,i)),U(r)&&(s=Li.SetOpacity(s,r)),{offset:V(o)?o(t,n._attributeContext,i):o,color:s||p[0]}})):V(a)?e[r]=a(t,n._attributeContext,i):e[r]=a})),e.gradient=r,e}},i.prototype._computeBorderAttr=function(t){var e=this,i=t.scale,n=t.field,r=w(t,["scale","field"]);return function(t){var a,o,s,l={};if(Object.keys(r).forEach((function(i){var n=r[i];V(n)?l[i]=n(t,e._attributeContext,e.getDataView()):l[i]=n})),"stroke"in l)xN.includes(null===(s=r.stroke)||void 0===s?void 0:s.gradient)&&(l.stroke=e._computeGradientAttr(r.stroke)(t));else{var u=fF(pF(e.model.getColorScheme(),"series"===e.model.modelType?null===(o=(a=e.model).getSpec)||void 0===o?void 0:o.call(a):void 0),e.model.getDefaultColorDomain()),c=i,h=n;if(!(i&&n||"series"!==e.model.modelType)){var d=e.model.getColorAttribute(),p=d.scale,f=d.field;i||(c=p),h||(h=f),l.stroke=(null==c?void 0:c.scale(t[h]))||u[0]}}return l}},i.prototype._getDataByKey=function(t){var e=this;return HH(t,(function(t,i){var n;return"".concat(e._groupKeyGetter(t),"_").concat(null!==(n=e._keyGetter(t))&&void 0!==n?n:i)}))},i.prototype._getCommonContext=function(){return{compiler:this.getCompiler(),markType:this.type,markId:this.id,modelId:this.model.id,markUserId:this._userId,modelUserId:this.model.userId}},i.prototype.prepareMorph=function(t){this._lastMark=t},i.prototype.reuse=function(t){var e=this;this.type===t.type&&(this._product=t.getProduct(),this._graphics=t.getGraphics(),this._graphicMap=t._graphicMap,this._graphicMap.forEach((function(t){t.context=T(T({},t.context),e._getCommonContext())})),this._dataByKey=t._dataByKey,this._prevDataByKey=t._prevDataByKey,this.needClear=t.needClear)},i.prototype._parseProgressiveContext=function(t){var e=this,i=this._markConfig.progressiveStep>0&&this._markConfig.progressiveThreshold>0&&this._markConfig.progressiveStep<this._markConfig.progressiveThreshold,n=this._markConfig.large&&this._markConfig.largeThreshold>0&&t.length>=this._markConfig.largeThreshold;if(i){var r=this._dataByGroup;return r&&r.keys&&r.keys.some((function(t){return r.data.get(t).length>e._markConfig.progressiveThreshold}))?{large:n,progressive:{data:t,step:this._markConfig.progressiveStep,currentIndex:0,totalStep:r.keys.reduce((function(t,i){return Math.max(Math.ceil(r.data.get(i).length/e._markConfig.progressiveStep),t)}),1),groupedData:r.data}}:{large:n}}return{large:n}},i.prototype.getGraphics=function(){return this._graphics},i.prototype._createGraphic=function(t){return void 0===t&&(t={}),KF.createGraphicComponent(this.type,t)},i.prototype._runGroupData=function(t){var e=this;this._keyGetter=V(this.key)?this.key:U(this.key)?function(t){return null==t?void 0:t[e.key]}:function(t){return null==t?void 0:t[Sz]},this._groupKeyGetter=U(this._groupKey)?function(t){return"".concat(null==t?void 0:t[e._groupKey])}:function(){return"key"},this._dataByGroup=HH(t,this._groupKeyGetter)},i.prototype.createAnimationStateList=function(t,e){var i,n=e[t];return n&&Array.isArray(n)&&(n=1===n.length?n[0]:n),Array.isArray(n)?n.map((function(t,e){var i;return T(T({},t),{priority:null!==(i=t.priority)&&void 0!==i?i:1/0})})):n?T(T({},n),{priority:"normal"===t?null!==(i=n.priority)&&void 0!==i?i:1/0:n.priority}):n},i.prototype.tryRunMorphing=function(t){if(this._lastMark){t.forEach((function(t){"appear"!==t.context.animationState&&"enter"!==t.context.animationState||t.setAttributes(t.getAttributes(!0))}));var e=function(t,e,i){void 0===i&&(i={});var n=[],r=[];t.forEach((function(t){BN(t),n.push.apply(n,R([],B(t.getGraphics()),!1))})),e.forEach((function(t){BN(t),r.push.apply(r,R([],B(t.getGraphics()),!1))}));var a=function(t){var e,i,n;return null!==(i=null===(e=t.context)||void 0===e?void 0:e.morphKey)&&void 0!==i?i:null===(n=t.context)||void 0===n?void 0:n.key},o=new Map,s=new Map;if(n.forEach((function(t){var e=a(t);e&&(o.has(e)||o.set(e,[]),o.get(e).push(t))})),r.forEach((function(t){var e=a(t);e&&(s.has(e)||s.set(e,[]),s.get(e).push(t))})),o.size!==s.size||!Array.from(o.keys()).every((function(t){return s.has(t)})))return!1;var l=R([],B(new Set(R([],B(o.keys()),!1).filter((function(t){return s.has(t)})))),!1),u=R([],B(s.keys()),!1).filter((function(t){return!o.has(t)})),c=0,h=function(){0==(c-=1)&&e.forEach((function(t){}))};return u.forEach((function(t){var e=s.get(t);EN([],e,i,h,{}),c+=1})),l.forEach((function(t){var e=o.get(t),n=s.get(t),r=Math.min(e.length,n.length);if(r>0)for(var a=PN(e,r),l=PN(n,r),u=0;u<r;u++)EN(a[u],l[u],i,h,{}),c+=1})),0===c&&h(),!0}([this._lastMark],[this],{});return this._lastMark=null,e}return!1},i.prototype._runStateAnimation=function(t){var e,i;if(this._animationConfig&&0!==t.length&&!this.tryRunMorphing(t)){var n=this.getAnimationConfig();if(null!==(e=this._markConfig.useSequentialAnimation)&&void 0!==e&&e&&this._runSequentialAnimations)this._runSequentialAnimations(t);else{var r=t.every((function(t){return"appear"===t.context.animationState})),a=this.createAnimationStateList("appear",n);if(r&&this._product){var o=a?["appear"]:[],s=a?[{name:"appear",animation:a}]:[];if(n.normal){o.push("normal");var l={name:"normal",animation:this.createAnimationStateList("normal",n)};s.push(l)}this._product.applyAnimationState(o,s)}var u=!1;if(t.forEach((function(t){var e=t.context.animationState;if("appear"!==e){var i=n[e];if(i&&i.length>0){var r=i.map((function(t,i){return{name:"".concat(e,"_").concat(i),animation:t}}));r.forEach((function(e){e.animation.customParameters=t.context}));var a=[e];t.applyAnimationState(a,[1===r.length?r[0]:r])}"enter"===e&&n.normal&&(u=!0)}})),u&&this._product&&(null===(i=n.normal)||void 0===i?void 0:i.length)){this._product.stopAnimationState("normal","start");l={name:"normal",animation:this.createAnimationStateList("normal",n)};this._product.applyAnimationState(["normal"],[l])}}}},i.prototype._setAnimationState=function(t){var e,i,n,r=("component"===this.type?this.model.getAnimationStateCallback():null===(n=null===(i=(e=this.model).getRegion)||void 0===i?void 0:i.call(e))||void 0===n?void 0:n.getAnimationStateCallback())||function(t){var e,i=null===(e=t.context)||void 0===e?void 0:e.diffState;return i===BH.exit?BH.exit:i===BH.update?BH.update:BH.appear},a=r(t);t.context.animationState=null!=a?a:t.context.diffState,t.context.animationState===gN.exit&&(t.context.reusing=!0,t.animates&&t.animates.forEach((function(t){return t.stop()})))},i.prototype._runJoin=function(t){var e=this,i=this._getDataByKey(t),n=this._prevDataByKey,r=[],a=new Set(this._graphics.filter((function(t){return t.context.diffState===gN.enter}))),o=function(t,i,n){var o,s,l,u,c,h,d,p,f,v,g;return j(i)?(v=e._graphicMap.get(t))&&(g=gN.exit):j(n)?(v=e._graphicMap.has(t)?e._graphicMap.get(t):{},g=gN.enter,v.isExiting=!1,e._graphicMap.set(t,v),r.push(v)):(v=e._graphicMap.get(t))&&(g=gN.update,r.push(v)),v&&(a.delete(v),v.context=T(T({},e._getCommonContext()),{diffState:g,reusing:null===(o=v.context)||void 0===o?void 0:o.reusing,originalFieldX:null===(s=v.context)||void 0===s?void 0:s.originalFieldX,originalFieldY:null===(l=v.context)||void 0===l?void 0:l.originalFieldY,fieldX:null===(u=v.context)||void 0===u?void 0:u.fieldX,fieldY:null===(c=v.context)||void 0===c?void 0:c.fieldY,data:null!=i?i:null===(h=v.context)||void 0===h?void 0:h.data,uniqueKey:t,key:i?e._keyGetter(i[0]):null===(d=v.context)||void 0===d?void 0:d.key,groupKey:i?e._groupKeyGetter(i[0]):null===(p=v.context)||void 0===p?void 0:p.groupKey,indexKey:"__VCHART_DEFAULT_DATA_INDEX",stateAnimateConfig:null===(f=e.getAnimationConfig())||void 0===f?void 0:f.state}),e._setAnimationState(v)),v};if(n&&i){var s=new Map(n.data);i.keys.forEach((function(t){o(t,i.data.get(t),s.get(t)),s.delete(t)})),n.keys.forEach((function(t){s.has(t)&&o(t,null,s.get(t))}))}else i?i.keys.forEach((function(t){var e=o(t,i.data.get(t),null);e&&(e.context.animationState=BH.appear)})):n&&n.keys.forEach((function(t){o(t,null,n.data.get(t)).context.animationState=BH.disappear}));a.forEach((function(t){e._graphicMap.delete(t.context.uniqueKey),t.parent&&t.parent.removeChild(t),t.release()}));var l=r.length;r.forEach((function(t,e){t.context.graphicCount=l,t.context.graphicIndex=e})),this._dataByKey=i,this._graphics=r,this.needClear=!0},i.prototype._runEncoderOfGraphic=function(t,e,i){return void 0===i&&(i={}),NH(t,e.context.data[0],i)},i.prototype._runGroupEncoder=function(t){var e=this;if(!this._dataByGroup)return null;var i={};return this._dataByGroup.keys.forEach((function(n){i[n]=NH(t,e._dataByGroup.data.get(n)[0])})),this._attrsByGroup=i,i},i.prototype._transformGraphicAttributes=function(t,e,i){return T(T({},i),e)},i.prototype._separateNormalStyle=function(t){var e=this,i={},n={};return Object.keys(t).forEach((function(r){e._unCompileChannel[r]||(e._option.noSeparateStyle||function(t,e,i){var n,r=null===(n=e[t])||void 0===n?void 0:n.style,a=function(t,e){return("fill"===t||"stroke"===t)&&(null==e?void 0:e.gradient)&&(null==e?void 0:e.stops)}(t,r);return!!a||!!V(r)||!(!(null==r?void 0:r.scale)||r.field===i)}(r,t,e._groupKey)?i[r]=t[r]:n[r]=t[r])})),{updateStyles:i,groupStyles:n}},i.prototype._addProgressiveGraphic=function(t,e){t.incrementalAppendChild(e)},i.prototype._runEncoder=function(t,e){var i,n=this,r=e?null:this._runGroupEncoder(null===(i=this._encoderOfState)||void 0===i?void 0:i.group);t.forEach((function(t,e){var i,a=n._runEncoderOfGraphic(null===(i=n._encoderOfState)||void 0===i?void 0:i.update,t);j(n._markConfig.interactive)||(a.pickable=n._markConfig.interactive);var o=n._transformGraphicAttributes(t,a,null==r?void 0:r[t.context.groupKey]);t.context.finalAttrs=o}))},i.prototype._runApplyGraphic=function(t){var e=this,i=this.hasAnimation();t.forEach((function(n,r){var a,o=n.context.finalAttrs,s=e.hasAnimationByState(n.context.animationState);if(n.setAttributes){var l=dH(n,o);n.context.diffAttrs=l,n.context.reusing?(n.context.lastAttrs=n.attribute,n.initAttributes({}),n.context.reusing=!1):s||(i?n.setAttributesAndPreventAnimate(l):n.setAttributes(l)),i&&n.setFinalAttributes(o)}else{var u=n;n=e._createGraphic(o),i&&n.setFinalAttributes(o),n.context=u.context,n.context.diffAttrs=o;var c=e._graphics===t?r:r+e._graphics.length-t.length;if(c>=0&&(e._graphics[c]=n),null===(a=e.renderContext)||void 0===a?void 0:a.progressive){var h=e._dataByGroup?e._dataByGroup.keys.indexOf(n.context.groupKey):0,d=h>=0?e._product.getChildAt(h):null;d&&e._addProgressiveGraphic(d,n)}else e._product.appendChild(n),e._graphicMap.set(n.context.uniqueKey,n)}e._setStateOfGraphic(n),e._setGraphicFromMarkConfig(n)}))},i.prototype._updateEncoderByState=function(){var e=this,i={};Object.keys(this.stateStyle).forEach((function(n){if(n===t.STATE_VALUE_ENUM.STATE_NORMAL){var r=e._separateNormalStyle(e.stateStyle[n]),a=r.groupStyles,o=r.updateStyles;i.group=e._getEncoderOfStyle(n,a),i.update=e._getEncoderOfStyle(n,o)}else i[n]=e._getEncoderOfStyle(n,e.stateStyle[n])})),this._encoderOfState=i},i.prototype._runState=function(t){var e=this;t.forEach((function(t){var i,n=R(R([],B((null!==(i=t.currentStates)&&void 0!==i?i:[]).filter((function(t){return!e.state.getStateInfo(t)}))),!1),B(e.state.checkState(t,t.context.data)),!1);e._stateSort&&n.length&&n.sort(e._stateSort),t.context.states=n}))},i.prototype._getAttrsFromConfig=function(t){void 0===t&&(t={});var e=this._markConfig,i=e.zIndex,n=e.clip,r=e.clipPath,a=e.overflow;if(j(i)||(t.zIndex=i),j(n)||(t.clip=n),!j(r)){var o=q(r)?r:r(this._graphics);o&&o.length||(t.clip=!1),t.path=o}return j(a)||(t.overflow=a),t},i.prototype._updateAttrsOfGroup=function(){var t,e=this._getAttrsFromConfig();null===(t=this._product)||void 0===t||t.setAttributes(e),this._markConfig.support3d&&this._product&&this._product.setMode("3d")},i.prototype._runBeforeTransform=function(t){var e,i=null===(e=this._transform)||void 0===e?void 0:e.filter((function(t){if(t.type){var e=KF.getGrammarTransform(t.type);return e&&(!e.runType||"beforeJoin"===e.runType)}return!1}));return this.runTransforms(i,t)},i.prototype._runEncoderTransform=function(t,e){var i,n=null===(i=this._transform)||void 0===i?void 0:i.filter((function(t){if(t.type){var i=KF.getGrammarTransform(t.type);return i&&"afterEncode"===i.runType&&!!i.canProgressive===e}return!1}));return this.runTransforms(n,t)},i.prototype.renderInner=function(){var t,e,i;this._updateEncoderByState();var n,r=null!==(e=null===(t=this._data)||void 0===t?void 0:t.getProduct())&&void 0!==e?e:[{}],a=this._runBeforeTransform(r);if(null==a?void 0:a.progressive){this.renderContext={beforeTransformProgressive:a.progressive};var o=a.progressive;if(o.canAnimate&&o.canAnimate()&&o.unfinished())return void this._updateAttrsOfGroup();n=o.output()}else n=St(a),this._runGroupData(n),this.renderContext=this._parseProgressiveContext(n);(null===(i=this.renderContext)||void 0===i?void 0:i.progressive)?(this._graphicMap.clear(),this._runProgressiveStep()):(this._runJoin(n),this._runState(this._graphics),this._runEncoder(this._graphics),this._runEncoderTransform(this._graphics,!1),this._runApplyGraphic(this._graphics)),this._updateAttrsOfGroup()},i.prototype.render=function(){this.isCommited()&&(!this.getVisible()||this._skipBeforeLayouted&&this.getCompiler().getLayoutState()===LH.before||(ux("render mark: ".concat(this.getProductId(),", type is ").concat(this.type)),this.renderInner()),this.uncommit())},i.prototype.updateMarkState=function(t){var e=this;if(this._product){var i=this.state.getStateInfo(t);this._graphics.forEach((function(n){"in"===e.state.checkOneState(n,n.context.data,i)?n.addState(t,!0,e.hasAnimationByState("state")):n.removeState(t,e.hasAnimationByState("state"))}))}},i.prototype.clearExitGraphics=function(){var t=this;this._prevDataByKey=this._dataByKey;var e=function(e,i){t._graphicMap.delete(i),e.parent&&e.parent.removeChild(e),e.release&&e.release()};this._graphicMap.forEach((function(i,n){if(i.context.diffState===gN.exit&&!i.isExiting)if(i.context.animationState===gN.exit&&t.hasAnimationByState("exit")){i.isExiting=!0;var r=t.getAnimationConfig();if(r.exit&&r.exit.length){var a=r.exit.map((function(t,e){return{name:"exit_".concat(e),animation:T(T({},t),{customParameters:i.context})}}));i.applyAnimationState(["exit"],[1===a.length?a[0]:a],(function(){e(i,n)}))}}else e(i,n)}))},i.prototype.isProgressive=function(){return this.renderContext&&(!!this.renderContext.progressive||!!this.renderContext.beforeTransformProgressive)},i.prototype.canAnimateAfterProgressive=function(){var t,e;return this.renderContext&&this.renderContext.beforeTransformProgressive&&(null===(e=(t=this.renderContext.beforeTransformProgressive).canAnimate)||void 0===e?void 0:e.call(t))},i.prototype.isDoingProgressive=function(){return this.renderContext&&(this.renderContext.progressive&&this.renderContext.progressive.currentIndex<this.renderContext.progressive.totalStep||this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.unfinished())},i.prototype.clearProgressive=function(){this.renderContext&&this.renderContext.progressive&&(this._graphics=[],this._product.children.forEach((function(t){t.incrementalClearChild()})),this._product.removeAllChild()),this.renderContext&&this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.release(),this.renderContext=null},i.prototype.restartProgressive=function(){this.renderContext&&this.renderContext.progressive&&(this.renderContext.progressive.currentIndex=0)},i.prototype._runBeforeProgressive=function(){var t,e=this.renderContext.beforeTransformProgressive;e.progressiveRun();var i=e.output();if(null===(t=e.canAnimate)||void 0===t?void 0:t.call(e)){if(e.unfinished())return;this._runGroupData(i),this._runJoin(i),this._runState(this._graphics),this._runEncoder(this._graphics),this._runApplyGraphic(this._graphics)}},i.prototype._runProgressiveJoin=function(){var t=this,e=this.renderContext.progressive.currentIndex,i=[],n={};return this._dataByGroup.keys.forEach((function(r){var a=t.renderContext.progressive.groupedData.get(r),o=t.renderContext.progressive.step,s=a.slice(e*o,(e+1)*o),l=[];s.forEach((function(n,a){var s=t._keyGetter(n),u={context:T(T({},t._getCommonContext()),{diffState:gN.enter,data:[n],uniqueKey:"".concat(r,"_").concat(null!=s?s:e*o+a),key:s,groupKey:r})};l.push(u),i.push(u)})),n[r]=l})),{graphicsByGroup:n,graphics:i,needUpdate:!0}},i.prototype._createIncrementalGraphics=function(){var t=this;this._product.removeAllChild(),this._dataByGroup.keys.forEach((function(e){var i=Vf({pickable:!1,zIndex:t._markConfig.zIndex});i.incremental=t.renderContext.progressive.step,t._product.appendChild(i)}))},i.prototype._setCommonAttributesToTheme=function(t){var e,i,n;if(this._attrsByGroup&&t){var r=t.parent;r&&(null===(e=this._attrsByGroup)||void 0===e?void 0:e[null===(i=t.context)||void 0===i?void 0:i.groupKey])&&r.setTheme({common:this._attrsByGroup[null===(n=t.context)||void 0===n?void 0:n.groupKey]})}},i.prototype._runProgressiveEncoder=function(t){0===this.renderContext.progressive.currentIndex?this._runEncoder(t):this._runEncoder(t,!0)},i.prototype._runProgressiveApplyGraphic=function(t){0===this.renderContext.progressive.currentIndex?(this._runApplyGraphic(t),this._setCommonAttributesToTheme(t[0])):this._runApplyGraphic(t)},i.prototype._runProgressiveStep=function(){var t=this,e=this._runProgressiveJoin(),i=e.graphics,n=e.graphicsByGroup,r=e.needUpdate;0===this.renderContext.progressive.currentIndex?(this._createIncrementalGraphics(),this._graphics=i):r&&i.forEach((function(e){t._graphics.push(e)})),this._runState(i),Object.keys(n).forEach((function(e){t._runProgressiveEncoder(n[e])})),this._runEncoderTransform(this._graphics,!0),Object.keys(n).forEach((function(e){t._runProgressiveApplyGraphic(n[e])})),this.renderContext.progressive.currentIndex+=1},i.prototype.renderProgressive=function(){var t;(null===(t=this.renderContext)||void 0===t?void 0:t.beforeTransformProgressive)?this._runBeforeProgressive():this.renderContext.progressive&&this._runProgressiveStep()},i.prototype.hasAnimationByState=function(t){if(!t||!this._animationConfig||!this._animationConfig[t]||this._disabledAnimationStates.includes(t))return!1;var e=this._animationConfig[t];return e.length>0||W(e)},i.prototype.hasAnimation=function(){return!!this._animationConfig&&Object.keys(this._animationConfig).length>0},i.prototype.runAnimation=function(){this._runStateAnimation(this.getGraphics())},i}(TN);t.MarkTypeEnum=void 0,(AN=t.MarkTypeEnum||(t.MarkTypeEnum={})).group="group",AN.symbol="symbol",AN.rule="rule",AN.line="line",AN.text="text",AN.rect="rect",AN.image="image",AN.path="path",AN.area="area",AN.arc="arc",AN.polygon="polygon",AN.boxPlot="boxPlot",AN.linkPath="linkPath",AN.cell="cell",AN.ripple="ripple",AN.liquid="liquid",AN.component="component",AN.dataLabel="dataLabel",AN.label="label",AN.pictogram="pictogram";var LN=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._marks=[],i._diffState=gN.enter,i}return M(e,t),e.prototype.getMarks=function(){return this._marks},e.prototype.isMarkExist=function(t){return void 0!==this._marks.find((function(e){return e.id===t.id}))},e.prototype.addMark=function(t){return this.isMarkExist(t)?(cx("Mark already exists, add mark failed."),!1):(this._marks.push(t),!0)},e.prototype.removeMark=function(t){var e=this._marks.findIndex((function(e){return e.id===t.id||e.name===t.name}));return-1===e?(cx("Mark does not exists, removeMark failed."),!1):(this._marks.splice(e,1),!0)},e.prototype.getMarkInType=function(t){return this._marks.filter((function(e){return e.type===t}))},e.prototype.getMarkInId=function(t){return this._marks.find((function(e){return e.id===t}))},e.prototype.getMarkInUserId=function(t){var e;return VH(this,(function(t){e=t}),(function(e){return e.getUserId()===t}),null,!0),e},e.prototype.getMarkInName=function(t){return this._marks.filter((function(e){return e.name===t}))},e.prototype._compileProduct=function(e){var i=this;t.prototype._compileProduct.call(this,e),this.getMarks().forEach((function(t){t.compile({group:i._product})}))},e.prototype._getAttrsFromConfig=function(e){void 0===e&&(e={});var i=t.prototype._getAttrsFromConfig.call(this,e);return j(this._markConfig.interactive)||(i.pickable=this._markConfig.interactive),e},e.prototype.getGraphics=function(){return[this._product]},e.prototype.renderInner=function(){var t;if(this._product){var e=null!==(t=this._simpleStyle)&&void 0!==t?t:this.getAttributesOfState({});this._product.context=T(T(T({},this._product.context),this._getCommonContext()),{diffState:this._diffState}),this._setAnimationState(this._product);var i=this._getAttrsFromConfig(e);if(this._product.context.diffState===gN.update){var n=this.hasAnimation(),r=dH(this._product,i);this._product.context.diffAttrs=r,this.hasAnimationByState(this._product.context.animationState)||(n?this._product.setAttributesAndPreventAnimate(r):this._product.setAttributes(r)),n&&this._product.setFinalAttributes(i)}else this._product.setAttributes(i);this.needClear=!0}},e.prototype.clearExitGraphics=function(){this._diffState=gN.update},e.prototype.render=function(){this._isCommited&&(ux("render mark: ".concat(this.getProductId(),", type is ").concat(this.type)),this.renderInner(),this.uncommit()),this.getMarks().forEach((function(t){t.render()}))},e.prototype.release=function(){t.prototype.release.call(this),this.removeProduct()},e.type="group",e}(RN),IN=function(){lC(),Kw(),KF.registerMark(LN.type,LN)},DN={measureText:yz},ON=function(){function t(){this.functions={}}return t.instance=function(){return t.instance_||(t.instance_=new t),t.instance_},t.prototype.registerFunction=function(t,e){t&&e&&(this.functions[t]=e)},t.prototype.unregisterFunction=function(t){t&&delete this.functions[t]},t.prototype.getFunction=function(t){return this.functions[t]||null},t.prototype.getFunctionNameList=function(){return Object.keys(this.functions)},t}(),FN=function(){Rk(yc)},zN=function(){$A(yc)},HN=function(){function t(){this.id=_x(),this._plugins=[]}return t.prototype.add=function(t){var e=this;if(!t||0===t.length)return null;var i=[];return t.forEach((function(t){e._plugins.find((function(e){return e.id===t.id}))?cx("不要重复添加相同的plugin"):(e._plugins.push(t),i.push(t),t.onAdd&&t.onAdd(e))})),i},t.prototype.load=function(t){var e=this.add(t);e&&e.length&&this.activate(t)},t.prototype.activate=function(t){t.length&&t.forEach((function(t){t.init&&t.init()}))},t.prototype.get=function(t){return this._plugins.find((function(e){return e.id===t}))},t.prototype.getAll=function(){return this._plugins.slice()},t.prototype.release=function(t){var e=this.get(t);e&&(e.release(this),this._plugins=this._plugins.filter((function(t){return t!==e})))},t.prototype.releaseAll=function(){var t=this;this._plugins.forEach((function(e){e.release(t)})),this._plugins=[]},t.prototype.clear=function(t){var e=this.get(t);e&&e.clear(this)},t.prototype.clearAll=function(){var t=this;this._plugins.forEach((function(e){var i;null===(i=e.clear)||void 0===i||i.call(e,t)}))},t}(),NN=function(t){function e(e){var i=t.call(this)||this;return i.globalInstance=e,i}return M(e,t),e.prototype.onInit=function(t){var e=this;this._plugins.forEach((function(i){i.onInit&&i.onInit(e,t)}))},e.prototype.onBeforeResize=function(t,e){var i=this;this._plugins.forEach((function(n){n.onBeforeResize&&n.onBeforeResize(i,t,e)}))},e.prototype.onAfterChartSpecTransform=function(t,e){var i=this;this._plugins.forEach((function(n){n.onAfterChartSpecTransform&&n.onAfterChartSpecTransform(i,t,e)}))},e.prototype.onAfterModelSpecTransform=function(t,e,i){var n=this;this._plugins.forEach((function(r){r.onAfterModelSpecTransform&&r.onAfterModelSpecTransform(n,t,e,i)}))},e.prototype.onBeforeInitChart=function(t,e){var i=this;this._plugins.forEach((function(n){n.onBeforeInitChart&&n.onBeforeInitChart(i,t,e)}))},e.prototype.releaseAll=function(){t.prototype.releaseAll.call(this),this.globalInstance=null},e}(HN),VN={type:"fadeIn"};function jN(t,e){switch(e){case"grow":return function(t){return{type:"horizontal"===t.direction?"growPointsXIn":"growPointsYIn",options:{orient:"horizontal"===t.direction?"positive":"negative"}}}(t);case"fadeIn":return VN;default:return function(t){return{type:"clipIn",options:{clipDimension:"horizontal"===t.direction?"y":"x"}}}(t)}}var UN={appear:{duration:1e3,easing:"cubicOut"},update:{type:"update",duration:300,easing:"linear"},enter:{duration:300,easing:"linear"},exit:{duration:300,easing:"linear"},disappear:{duration:500,easing:"cubicIn"},state:{duration:300,easing:"linear"}},WN={appear:{type:"scaleIn"},enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:{type:"scaleOut"}},GN={appear:{type:"fadeIn"},enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}},YN=function(){KF.registerAnimation("scaleInOut",(function(){return WN}))},XN=function(){KF.registerAnimation("fadeInOut",(function(){return GN}))},KN=function(t,e){return{appear:jN(t,e),enter:{type:"fadeIn"},exit:{type:"fadeOut"},update:[{type:"update",options:{excludeChannels:["points","defined","segments"]}},{channel:["points","segments"],custom:uB,duration:UN.update.duration,easing:UN.update.easing,customParameters:{clipRangeByDimension:"horizontal"===t.direction?"y":"x"}}],disappear:{type:"clipOut"}}},qN=function(){KF.registerAnimation("line",KN)},ZN=function(){wP.registerBuiltInAnimate("growHeightIn",SB),wP.registerBuiltInAnimate("growHeightOut",AB),wP.registerBuiltInAnimate("growWidthIn",NB),wP.registerBuiltInAnimate("growWidthOut",VB),wP.registerBuiltInAnimate("growCenterIn",bB),wP.registerBuiltInAnimate("growCenterOut",xB)},JN=function(){wP.registerBuiltInAnimate("growRadiusIn",FB),wP.registerBuiltInAnimate("growRadiusOut",zB),wP.registerBuiltInAnimate("growAngleIn",mB),wP.registerBuiltInAnimate("growAngleOut",_B)},QN=function(){wP.registerBuiltInAnimate("growPointsIn",wB),wP.registerBuiltInAnimate("growPointsOut",CB),wP.registerBuiltInAnimate("growPointsXIn",PB),wP.registerBuiltInAnimate("growPointsXOut",BB),wP.registerBuiltInAnimate("growPointsYIn",LB),wP.registerBuiltInAnimate("growPointsYOut",IB),wP.registerBuiltInAnimate("clipIn",dB),wP.registerBuiltInAnimate("clipOut",pB)},$N=function(){wP.registerBuiltInAnimate("growPointsOut",CB)},tV=function(){FP(),wP.registerBuiltInAnimate("scaleIn",ZB),wP.registerBuiltInAnimate("scaleOut",JB),wP.registerBuiltInAnimate("fadeIn",fB),wP.registerBuiltInAnimate("fadeOut",vB),wP.registerBuiltInAnimate("moveIn",fR),wP.registerBuiltInAnimate("moveOut",vR),wP.registerBuiltInAnimate("rotateIn",yR),wP.registerBuiltInAnimate("rotateOut",mR),wP.registerBuiltInAnimate("update",dR),wP.registerBuiltInAnimate("state",QB),wP.registerBuiltInAnimate("fromTo",bR)},eV=function(){KF.registerStageEventPlugin("gesture",tk)},iV=function(t,e){if(!e||!e.length)return[];var i=[];return t.markIds?e.filter((function(e){t.markIds.includes(e.getProductId())&&i.push(e)})):t.markNames?e.forEach((function(e){t.markNames.includes(e.name)&&i.push(e)})):e.forEach((function(t){i.push(t)})),i},nV=function(t){return t.filterField?function(e){var i;return null===(i=cH(e))||void 0===i?void 0:i[t.filterField]}:function(e){return e.context[t.filterType]}},rV={highlightState:t.STATE_VALUE_ENUM.STATE_HIGHLIGHT,blurState:t.STATE_VALUE_ENUM.STATE_BLUR,trigger:"pointerover",triggerOff:"pointerout"},aV=function(){function t(t){var e=this;this._markSet=new tN,this.options=t,t.marks&&t.marks.length&&t.marks.forEach((function(t){e.registerMark(t)}))}return t.prototype.getMarks=function(){return this._markSet.getMarks()},t.prototype.getMarksByState=function(t){if(this._markIdByState&&this._markSet){var e=this._markIdByState[t];return e?this.getMarks().filter((function(t){return t&&e.includes(t.id)})):[]}return[]},t.prototype.registerMark=function(t){var e=this;q(t)?t.forEach((function(t){e._markSet.addMark(t)})):this._markSet.addMark(t)},t.prototype.updateMarkIdByState=function(t){this._markIdByState=function(t,e){if(!e||!t)return null;var i={};return t.forEach((function(t){var n=t.stateStyle;n&&e.forEach((function(e){e&&n[e]&&(i[e]||(i[e]=[]),i[e].push(t.id))}))})),i}(this.getMarks(),t)},t.prototype.getMarkIdByState=function(){var t;return null!==(t=this._markIdByState)&&void 0!==t?t:{}},t.prototype.isGraphicInStateMark=function(t,e){var i,n=this.getMarkIdByState();return n&&n[e]&&n[e].includes(null===(i=t.context)||void 0===i?void 0:i.markId)},t.prototype.isGraphicInMark=function(t){var e;return!!this._markSet.getMarkInId(null===(e=t.context)||void 0===e?void 0:e.markId)},t.prototype.getStartState=function(){return null},t.prototype.getResetState=function(){return null},t.prototype.init=function(){var t=this,e=this.getEvents();e&&this.options.event&&e.forEach((function(e){e.type&&e.handler&&(q(e.type)?e.type.forEach((function(i){i&&"none"!==i&&t.options.event.on(i,e.handler)})):"none"!==e.type&&t.options.event.on(e.type,e.handler))}))},t.prototype.release=function(){var t=this,e=this.getEvents();e&&this.options.event&&(null!=e?e:[]).forEach((function(e){e.type&&e.handler&&(q(e.type)?e.type.forEach((function(i){i&&"none"!==i&&t.options.event.on(i,e.handler)})):"none"!==e.type&&t.options.event.off(e.type,e.handler))}))},t.prototype.start=function(t){},t.prototype.reset=function(t){},t.prototype.dispatchEvent=function(t,e){this.options.event&&(this.options.event.emit("".concat(this.type,":").concat(t),e),"start"===t&&this.options.onStart?this.options.onStart(e):"reset"===t&&this.options.onReset?this.options.onReset(e):"update"===t&&this.options.onUpdate?this.options.onUpdate(e):"end"===t&&this.options.onEnd&&this.options.onEnd(e))},t}(),oV={highlightState:t.STATE_VALUE_ENUM.STATE_HIGHLIGHT,blurState:t.STATE_VALUE_ENUM.STATE_BLUR,trigger:"pointerover",triggerOff:"pointerout"},sV=function(t){function e(e){var i=t.call(this,e)||this;return i.type="element-highlight",i.resetAll=function(){var t=i.options,e=t.highlightState,n=t.blurState,r=t.interaction;i._lastGraphic&&(r.clearAllStatesOfTrigger(i,e,n),i.dispatchEvent("reset",{graphics:[i._lastGraphic],options:i.options}),i._lastGraphic=null,r.setStatedGraphics(i,[]))},i.handleStart=function(t){i.start(t.item)},i.handleReset=function(t){var e=i.options.interaction.getStatedGraphics(i);if(e&&e.length){var n=t.item,r=n&&i._markSet.getMarkInId(n.context.markId);(i._resetType.includes("view")&&!r||i._resetType.includes("self")&&r)&&i.resetAll()}},i.options=Object.assign({},oV,e),i.updateMarkIdByState([i.options.highlightState,i.options.blurState]),i}return M(e,t),e.prototype.getStartState=function(){return this.options.highlightState},e.prototype.getResetState=function(){return this.options.blurState},e.prototype.getEvents=function(){var t=this.options.triggerOff,e=[{type:this.options.trigger,handler:this.handleStart}],i=t;return K(t)&&t.includes("view:")?(i=t.replace("view:",""),this._resetType="view"):this._resetType="self",e.push({type:i,handler:this.handleReset}),e},e.prototype.start=function(t){if(t&&this._markSet.getMarkInId(t.context.markId)){var e=this.options,i=e.highlightState,n=e.blurState,r=e.interaction;if(this._lastGraphic===t)return;var a=r.updateStates(this,[t],r.getStatedGraphics(this),i,n);r.setStatedGraphics(this,a),this._lastGraphic=t,this.dispatchEvent("start",{graphics:a,options:this.options})}else this._lastGraphic&&"view"===this._resetType&&this.resetAll()},e.prototype.reset=function(t){t?this._markSet.getMarkInId(t.context.markId)&&t.removeState([this.options.highlightState,this.options.blurState]):this.resetAll()},e.type="element-highlight",e.defaultOptions=oV,e}(aV),lV=function(){KF.registerInteractionTrigger(sV.type,sV)},uV={state:t.STATE_VALUE_ENUM.STATE_SELECTED,trigger:"click"},cV=function(t){function e(e){var i=t.call(this,e)||this;return i.type="element-select",i._resetType=[],i.resetAll=function(){var t=i.options,e=t.state,n=t.reverseState,r=t.interaction,a=r.getStatedGraphics(i);a&&a.length&&(r.clearAllStatesOfTrigger(i,e,n),i.dispatchEvent("reset",{graphics:a,options:i.options}),r.setStatedGraphics(i,[]))},i.handleStart=function(t){i.start(t.item)},i.handleReset=function(t){var e=i.options.interaction.getStatedGraphics(i);if(e&&e.length){var n=t.item,r=n&&i._markSet.getMarkInId(n.context.markId);(i._resetType.includes("view")&&!r||i._resetType.includes("self")&&r)&&i.resetAll()}},i.options=Object.assign({},uV,e),i.updateMarkIdByState([i.options.state,i.options.reverseState]),i}return M(e,t),e.prototype.getStartState=function(){return this.options.state},e.prototype.getResetState=function(){return this.options.reverseState},e.prototype.getEvents=function(){var t=this,e=this.options.triggerOff,i=this.options.trigger,n=[{type:i,handler:this.handleStart}],r=function(t){var e=St(t),i=[],n=[];return e.forEach((function(t){"empty"===t?i.push("view"):K(t)&&"none"!==t?t.includes("view:")?(n.push(t.replace("view:","")),i.push("view")):(n.push(t),i.push("self")):Q(t)&&i.push("timeout")})),{eventNames:n,resetType:i}}(e),a=r.eventNames,o=r.resetType;return a.forEach((function(e){e&&(q(i)?!i.includes(e):e!==i)&&n.push({type:e,handler:t.handleReset})})),this._resetType=o,n},e.prototype.start=function(t){var e=this,i=this.options,n=i.state,r=i.reverseState,a=i.isMultiple,o=i.interaction,s=o.getStatedGraphics(this);if(t&&this._markSet.getMarkInId(t.context.markId))if(t.hasState(n)){if(this._resetType.includes("self"))(l=s&&s.filter((function(e){return e!==t})))&&l.length?o.setStatedGraphics(this,o.updateStates(this,l,s,n,r)):this.resetAll()}else{this._timer&&clearTimeout(this._timer),t.addState(n,!0);var l=this.options.interaction.updateStates(this,a&&s?R(R([],B(s),!1),[t],!1):[t],s,n,r);o.setStatedGraphics(this,l),this.dispatchEvent("start",{graphics:l,options:this.options}),this._resetType.includes("timeout")&&(this._timer=setTimeout((function(){e.resetAll()}),this.options.triggerOff))}else this._resetType.includes("view")&&s&&s.length&&this.resetAll()},e.prototype.reset=function(t){t?this._markSet.getMarkInId(t.context.markId)&&t.removeState([this.options.state,this.options.reverseState]):this.resetAll()},e.type="element-select",e.defaultOptions=uV,e}(aV),hV=function(){KF.registerInteractionTrigger(cV.type,cV)},dV=function(t){function e(e){var i=t.call(this)||this;return i.globalInstance=e,i}return M(e,t),e.prototype.onInit=function(){var t=this;this._plugins.forEach((function(e){e.onInit&&e.onInit(t)}))},e.prototype.releaseAll=function(){t.prototype.releaseAll.call(this),this.globalInstance=null},e}(HN),pV=function(){function e(e,i){var n,r,a,o,s,l,u,c,h,d=this;this.id=_x(),this._userEvents=[],this._autoSize=!0,this._option={mode:t.RenderModeEnum["desktop-browser"],onError:function(t){throw new Error(t)},optimize:{disableCheckGraphicWidthOutRange:!0}},this._observer=null,this._context={},this._doResize=function(){var t=d.getCurrentSize(),e=t.width,i=t.height;d._currentSize.width===e&&d._currentSize.height===i||(d._currentSize={width:e,height:i},d.resizeSync(e,i))},this._renderSync=function(t){var e;void 0===t&&(t={});var i=d;return d._beforeRender(t)?(null===(e=d._compiler)||void 0===e||e.render(t.morphConfig),d._updateAnimateState(!1),d._afterRender(),i):i},this._updateSpec=function(t,e,i){var n;void 0===e&&(e=!1);var r=d._spec,a={changeBackground:!1,reTransformSpec:!1,change:!1,reMake:!1,reCompile:!1,reSize:!1,changeTheme:!1};if(d._setNewSpec(t,e)){bt(r.theme,d._spec.theme)?bt(d._spec.background,r.background)||(a.reMake=!0,a.changeBackground=!0):a.changeTheme=!0;var o=d._shouldChartResize(r);if(a.reSize=o,d._spec.type!==r.type)return null===(n=d._compiler)||void 0===n||n.updateLayoutTag(),a.reMake=!0,a.reTransformSpec=!0,a.change=!0,a.changeTheme=!0,a;d._initChartSpec(d._spec,"updateSpec");var s=qH(d._chart.updateSpec(d._spec),a);return i?T(T({},s),i):s}},this.getTheme=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(d._currentTheme&&t&&t.length){d._cachedProcessedTheme||(d._cachedProcessedTheme={});var i=t.join(".");if(d._cachedProcessedTheme[i])return d._cachedProcessedTheme[i];var n=d._currentTheme;return t.forEach((function(e,i){var r;if(1!==i||"series"!==t[0]&&"component"!==t[0])n=null==n?void 0:n[e];else{var a="series"===t[0]?KF.getSeriesBuiltInTheme(e):KF.getComponentBuiltInTheme(e);n=n?XF({},a,n[e]):a}i===t.length-1&&U(n)&&(n=fz((r={},r[e]=n,r),d._currentTheme.colorScheme,d._currentTheme.token)[e])})),d._cachedProcessedTheme[i]=n,n}},uF(i),this._option=T(T({},this._option),i),(null==i?void 0:i.optimize)&&(this._option.optimize=T(T({},this._option.optimize),i.optimize)),this._onError=null===(n=this._option)||void 0===n?void 0:n.onError;var p=this._option,f=p.dom,v=p.renderCanvas,g=p.mode,y=p.stage,m=p.poptip,_=w(p,["dom","renderCanvas","mode","stage","poptip"]),b=vx(g);if(b?FN():"node"===g&&zN(),b&&f&&(this._container=K(f)?j_.getElementById(f):f),v&&(this._canvas=v),y&&(this._stage=y),"node"===g||this._container||this._canvas||this._stage){this._viewBox=this._option.viewBox,this._currentThemeName=hz.getCurrentThemeName(),this._setNewSpec(e),this._updateCurrentTheme(),this._currentSize=this.getCurrentSize();var x=[];!1!==m&&x.push("poptipForText"),"sankey"===e.type&&x.push("scrollbar");var k=new Ot(null!==(a=this._option.logLevel)&&void 0!==a?a:Lt.Error);Ot.setInstance(k),(null===(o=this._option)||void 0===o?void 0:o.onError)&&k.addErrorHandler((function(){for(var t,e,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];null===(e=null===(t=d._option)||void 0===t?void 0:t.onError)||void 0===e||e.call.apply(e,R([t],B(i),!1))})),this._compiler=new WH({dom:null!==(s=this._container)&&void 0!==s?s:"none",canvas:v},T(T({mode:this._option.mode,stage:y,pluginList:x},_),{background:this._getBackground(),onError:this._onError})),this._compiler.setSize(this._currentSize.width,this._currentSize.height),this._eventDispatcher=new xH(this,this._compiler),this._event=new pH(this._eventDispatcher,g),this._compiler.initView(),this._compiler.updateLayoutTag(),this._setFontFamilyTheme(this.getTheme("fontFamily")),this._initDataSet(this._option.dataSet),this._autoSize=!!b&&(null===(u=null!==(l=e.autoFit)&&void 0!==l?l:this._option.autoFit)||void 0===u||u),this._bindResizeEvent(),this._bindViewEvent(),this._initChartPlugin(),cz.registerInstance(this),null===(h=null===(c=this._option.performanceHook)||void 0===c?void 0:c.afterCreateVChart)||void 0===h||h.call(c,this)}else null===(r=this._option)||void 0===r||r.onError("please specify container or renderCanvas!")}return e.useRegisters=function(t){t.forEach((function(t){"function"==typeof t?t():console.error("Invalid function:",t)}))},e.useChart=function(t){t.forEach((function(t){return KF.registerChart(t.type,t)}))},e.useSeries=function(t){t.forEach((function(t){return KF.registerSeries(t.type,t)}))},e.useComponent=function(t){t.forEach((function(t){return KF.registerComponent(t.type,t)}))},e.useMark=function(t){t.forEach((function(t){var e;return KF.registerMark(null!==(e=t.constructorType)&&void 0!==e?e:t.type,t)}))},e.useLayout=function(t){t.forEach((function(t){return KF.registerLayout(t.type,t)}))},e.registerDataSetTransform=function(t,e){KF.registerTransform(t,e)},e.registerFunction=function(t,e){t&&e&&ON.instance().registerFunction(t,e)},e.unregisterFunction=function(t){t&&ON.instance().unregisterFunction(t)},e.getFunction=function(t){return t?ON.instance().getFunction(t):null},e.getFunctionList=function(){return ON.instance().getFunctionNameList()},e.registerMap=function(t,e,i){var n=KF.getImplementInKey("registerMap");n&&n(t,e,i)},e.unregisterMap=function(t){var e=KF.getImplementInKey("unregisterMap");e&&e(t)},e.getMap=function(t){return function(t){return MH.get(t)}(t)},e.registerSVG=function(t,e,i){var n=KF.getImplementInKey("registerSVG");n&&n(t,e,i)},e.unregisterSVG=function(t){var e=KF.getImplementInKey("unregisterSVG");e&&e(t)},e.hideTooltip=function(t){void 0===t&&(t=[]),cz.forEach((function(t){var e;return null===(e=null==t?void 0:t.hideTooltip)||void 0===e?void 0:e.call(t)}),t)},e.getLogger=function(){return Ot.getInstance()},e.prototype.getSpec=function(){return this._spec},e.prototype.getSpecInfo=function(){return this._specInfo},e.prototype.getDataSet=function(){return this._dataSet},e.prototype._setNewSpec=function(t,e){return!!t&&(K(t)&&(t=JSON.parse(t)),e&&this._originalSpec&&(t=XF({},this._originalSpec,t)),this._originalSpec=t,this._spec=this._getSpecFromOriginalSpec(),!0)},e.prototype._getSpecFromOriginalSpec=function(){var t,e=vz(this._originalSpec);return e.data=null!==(t=e.data)&&void 0!==t?t:[],e},e.prototype._initChartSpec=function(t,i){var n,r;e.getFunctionList()&&e.getFunctionList().length&&(t=gz(t,e)),this._spec=t,this._chartSpecTransformer||(this._chartSpecTransformer=KF.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),null===(n=this._chartSpecTransformer)||void 0===n||n.transformSpec(this._spec),this._chartPluginApply("onAfterChartSpecTransform",this._spec,i),this._specInfo=null===(r=this._chartSpecTransformer)||void 0===r?void 0:r.transformModelSpec(this._spec),this._chartPluginApply("onAfterModelSpecTransform",this._spec,this._specInfo,i)},e.prototype._updateSpecInfo=function(){var t;this._chartSpecTransformer||(this._chartSpecTransformer=KF.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),this._specInfo=null===(t=this._chartSpecTransformer)||void 0===t?void 0:t.createSpecInfo(this._spec)},e.prototype._initChart=function(e){var i,n,r;if(this._compiler)if(this._chart)null===(n=this._option)||void 0===n||n.onError("chart is already initialized");else{var a=KF.createChart(e.type,e,this._getChartOption(e.type));a?(this._chart=a,this._chart.setCanvasRect(this._currentSize.width,this._currentSize.height),this._chart.created(this._chartSpecTransformer),this._chart.init(),this._event.emit(t.ChartEvent.initialized,{chart:a,vchart:this})):null===(r=this._option)||void 0===r||r.onError("init chart fail")}else null===(i=this._option)||void 0===i||i.onError("compiler is not initialized")},e.prototype._releaseData=function(){this._dataSet&&(this._dataSet.dataViewMap={},this._dataSet=null)},e.prototype._bindViewEvent=function(){var e,i,n=this;this._compiler&&(null===(i=null===(e=this._compiler.getStage())||void 0===e?void 0:e.getTimeline())||void 0===i||i.on("animationEnd",(function(){n._event.emit(t.ChartEvent.animationFinished,{chart:n._chart,vchart:n})})))},e.prototype._bindResizeEvent=function(){var t,e;if(this._autoSize){if(this._onResize=Qt(this._doResize,null!==(t=this._option.resizeDelay)&&void 0!==t?t:100),this._container){var i=window.ResizeObserver;i&&(this._observer=new i(this._onResize),null===(e=this._observer)||void 0===e||e.observe(this._container))}window.addEventListener("resize",this._onResize)}},e.prototype._unBindResizeEvent=function(){this._autoSize&&(window.removeEventListener("resize",this._onResize),this._observer&&(this._observer.disconnect(),this._observer=null))},e.prototype.getCurrentSize=function(){var t,e,i,n;return KH(this._spec,{container:this._container,canvas:this._canvas,mode:this._getMode(),modeParams:this._option.modeParams},{width:null!==(e=null===(t=this._currentSize)||void 0===t?void 0:t.width)&&void 0!==e?e:_z,height:null!==(n=null===(i=this._currentSize)||void 0===i?void 0:i.height)&&void 0!==n?n:bz})},e.prototype._initDataSet=function(t){for(var e in this._dataSet=t instanceof cs?t:new cs,SH(this._dataSet,"dataview",ss),SH(this._dataSet,"array",D),kH(this._dataSet,"copyDataView",IH),KF.transforms)kH(this._dataSet,e,KF.transforms[e]);for(var e in KF.dataParser)SH(this._dataSet,e,KF.dataParser[e])},e.prototype.updateCustomConfigAndRerender=function(t,e,i){if(void 0===i&&(i={}),!this._isReleased&&t)return V(t)&&(t=t()),t.reAnimate&&(this.stopAnimation(),this._updateAnimateState(!0)),this._reCompile(t),e?this._renderSync(i):this._renderAsync(i)},e.prototype._updateCustomConfigAndRecompile=function(t,e){return void 0===e&&(e={}),!!t&&(this._reCompile(t),this._beforeRender(e))},e.prototype._reCompile=function(t,e){var i,n,r,a,o,s,l,u=this;if(t.reMake&&(this._releaseData(),this._initDataSet(),null===(i=this._chart)||void 0===i||i.release(),this._chart=null),t.reTransformSpec&&(this._chartSpecTransformer=null),t.changeTheme?(this._setCurrentTheme(),this._setFontFamilyTheme(this.getTheme("fontFamily"))):t.changeBackground&&(null===(n=this._compiler)||void 0===n||n.setBackground(this._getBackground())),t.reMake?(null===(r=this._compiler)||void 0===r||r.releaseGrammar(),this._userEvents.forEach((function(t){var e;return null===(e=u._event)||void 0===e?void 0:e.on(t.eType,t.query,t.handler)}))):t.reCompile&&(null===(a=this._compiler)||void 0===a||a.clear({chart:this._chart,vChart:this}),null===(o=this._compiler)||void 0===o||o.compile({chart:this._chart,vChart:this})),t.reSize){var c=this.getCurrentSize(),h=c.width,d=c.height;this._currentSize={width:h,height:d},null===(s=this._chart)||void 0===s||s.onResize(h,d,!1),null===(l=this._compiler)||void 0===l||l.resize(h,d,!1)}},e.prototype._beforeRender=function(t){var e,i,n,r,a,o,s,l;if(void 0===t&&(t={}),this._isReleased)return!1;if(this._chart)return!0;var u=t.transformSpec,c=t.actionSource;return u&&this._initChartSpec(this._spec,"render"),this._chartPluginApply("onBeforeInitChart",this._spec,c),null===(i=null===(e=this._option.performanceHook)||void 0===e?void 0:e.beforeInitializeChart)||void 0===i||i.call(e,this),this._initChart(this._spec),null===(r=null===(n=this._option.performanceHook)||void 0===n?void 0:n.afterInitializeChart)||void 0===r||r.call(n,this),!(!this._chart||!this._compiler)&&(null===(o=null===(a=this._option.performanceHook)||void 0===a?void 0:a.beforeCompileToVGrammar)||void 0===o||o.call(a,this),this._compiler.compile({chart:this._chart,vChart:this},t),null===(l=null===(s=this._option.performanceHook)||void 0===s?void 0:s.afterCompileToVGrammar)||void 0===l||l.call(s,this),!0)},e.prototype._afterRender=function(){return!this._isReleased&&(this._event.emit(t.ChartEvent.rendered,{chart:this._chart,vchart:this}),!0)},e.prototype.renderSync=function(t){return this._renderSync({morphConfig:t,transformSpec:!0,actionSource:"render"})},e.prototype.renderAsync=function(t){return C(this,void 0,void 0,(function(){return E(this,(function(e){return[2,this._renderAsync({morphConfig:t,transformSpec:!0,actionSource:"render"})]}))}))},e.prototype._renderAsync=function(t){return void 0===t&&(t={}),C(this,void 0,void 0,(function(){return E(this,(function(e){return[2,this._renderSync(t)]}))}))},e.prototype._updateAnimateState=function(t){var e,i;if(this.isAnimationEnable()){var n=function(e){var i,n=null===(i=e.context)||void 0===i?void 0:i.diffState;return t?"exit"===n?BH.none:BH.appear:n};null===(e=this._chart)||void 0===e||e.getAllRegions().forEach((function(t){t.updateAnimateStateCallback(n)})),null===(i=this._chart)||void 0===i||i.getAllComponents().forEach((function(t){t.updateAnimateStateCallback(n)}))}},e.prototype.release=function(){var t,e,i,n;(null===(t=this._onResize)||void 0===t?void 0:t.cancel)&&this._onResize.cancel(),this._chartPluginApply("releaseAll"),this._chartPlugin=null,this._chartSpecTransformer=null,null===(e=this._chart)||void 0===e||e.release(),null===(i=this._eventDispatcher)||void 0===i||i.release(),null===(n=this._compiler)||void 0===n||n.release(),this._unBindResizeEvent(),this._releaseData(),this._onError=null,this._onResize=null,this._container=null,this._currentTheme=null,this._cachedProcessedTheme=null,this._option=null,this._chart=null,this._compiler=null,this._spec=null,this._specInfo=null,this._originalSpec=null,this._userEvents=null,this._event=null,this._eventDispatcher=null,this._isReleased=!0,cz.unregisterInstance(this)},e.prototype.updateData=function(t,e,i,n){return C(this,void 0,void 0,(function(){return E(this,(function(r){return[2,this.updateDataSync(t,e,i,n)]}))}))},e.prototype._updateDataById=function(t,e,i){var n=this._spec.data.find((function(e){return e.name===t||e.id===t}));n?n.id===t?n.values=e:n.name===t&&n.parse(e,i):q(e)?this._spec.data.push({id:t,values:e}):this._spec.data.push(e)},e.prototype.updateDataInBatches=function(t){return C(this,void 0,void 0,(function(){var e=this;return E(this,(function(i){return this._chart?(this._chart.updateFullData(t.map((function(t){return{id:t.id,values:t.data,parser:t.options}}))),this._chart.updateGlobalScaleDomain(),this._compiler.render(),[2,this]):(this._spec.data=St(this._spec.data),t.forEach((function(t){var i=t.id,n=t.data,r=t.options;e._updateDataById(i,n,r)})),[2,this])}))}))},e.prototype.updateDataSync=function(t,e,i,n){return j(this._dataSet)?this:this._chart?(this._chart.updateData(t,e,!0,i),(null==n?void 0:n.reAnimate)&&(this.stopAnimation(),this._updateAnimateState(!0)),this._compiler.render(),this):(this._spec.data=St(this._spec.data),this._updateDataById(t,e,i),this)},e.prototype.updateFullDataSync=function(t,e,i){var n=this;if(void 0===e&&(e=!0),this._chart)return this._chart.updateFullData(t),e&&((null==i?void 0:i.reAnimate)&&(this.stopAnimation(),this._updateAnimateState(!0)),this._compiler.render()),this;var r=St(this._spec.data);return St(t).forEach((function(t){var e=t.id,i=t.values,a=t.parser,o=t.fields,s=r.find((function(t){return t.name===e}));if(s)s instanceof hs?(s.setFields(dt(o)),s.parse(i,dt(a))):(s.values=i,U(a)&&(s.parser=a),U(o)&&(s.fields=o));else{var l=OH(t,n._dataSet,r);q(n._spec.data)&&n._spec.data.push(l)}})),this},e.prototype.updateFullData=function(t,e){return void 0===e&&(e=!0),C(this,void 0,void 0,(function(){return E(this,(function(i){return[2,this.updateFullDataSync(t,e)]}))}))},e.prototype.updateSpec=function(t,e,i,n){return void 0===e&&(e=!1),C(this,void 0,void 0,(function(){var r;return E(this,(function(a){switch(a.label){case 0:return(r=this._updateSpec(t,e,n))?[4,this.updateCustomConfigAndRerender(r,!1,{morphConfig:i,transformSpec:r.reTransformSpec,actionSource:"updateSpec"})]:[2,this];case 1:return a.sent(),[2,this]}}))}))},e.prototype.updateSpecSync=function(t,e,i,n){void 0===e&&(e=!1);var r=this._updateSpec(t,e,n);return r?(this.updateCustomConfigAndRerender(r,!0,{morphConfig:i,transformSpec:r.reTransformSpec,actionSource:"updateSpec"}),this):this},e.prototype.updateSpecAndRecompile=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i={});var n=this._updateSpec(t,e);return this._updateCustomConfigAndRecompile(n,T({actionSource:"updateSpecAndRecompile"},i))},e.prototype.updateModelSpec=function(t,e,i,n){return void 0===i&&(i=!1),C(this,void 0,void 0,(function(){return E(this,(function(r){return[2,this.updateModelSpecSync(t,e,i,n)]}))}))},e.prototype.updateModelSpecSync=function(t,e,i,n){if(void 0===i&&(i=!1),!e||!this._spec)return this;if(K(e)&&(e=JSON.parse(e)),V(t)||function(t,e,i,n){Object.keys(t).forEach((function(r){if(W(e))e.type===r&&(q(t[r])?t[r].length>=e.index&&(t[r][e.index]=n?XF({},t[r][e.index],i):i):t[r]=n?XF({},t[r],i):i);else if(q(t[r])){var a=t[r].findIndex((function(t){return t.id===e}));a>=0&&(t[r][a]=n?XF({},t[r][a],i):i)}else t.id===e&&(t[r]=n?XF({},t[r],i):i)}))}(this._spec,t,e,i),this._chart){var r=this._chart.getModelInFilter(t);if(r)return this._updateModelSpec(r,e,!0,i,n)}return this},e.prototype._updateModelSpec=function(t,e,i,n,r){void 0===i&&(i=!1),void 0===n&&(n=!1),n&&(e=XF({},t.getSpec(),e));var a=t.updateSpec(e);return t.reInit(e),(a.change||a.reCompile||a.reMake||a.reSize||a.reRender)&&this._chart.reDataFlow(),this.updateCustomConfigAndRerender(a,i,{morphConfig:r,transformSpec:!1,actionSource:"updateModelSpec"})},e.prototype.resize=function(t,e){return C(this,void 0,void 0,(function(){return E(this,(function(i){return[2,this.resizeSync(t,e)]}))}))},e.prototype.resizeSync=function(t,e){var i,n;return this._beforeResize(t,e)?(null===(n=(i=this._compiler).resize)||void 0===n||n.call(i,t,e),this._afterResize()):this},e.prototype._beforeResize=function(t,e){var i,n,r,a;if(!this._chart||!this._compiler)return!1;var o=this._chart.getCanvasRect();return(!o||o.width!==t||o.height!==e)&&(this._chartPluginApply("onBeforeResize",t,e),null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.beforeResizeWithUpdate)||void 0===n||n.call(i,this),this._chart.onResize(t,e,!1),null===(a=null===(r=this._option.performanceHook)||void 0===r?void 0:r.afterResizeWithUpdate)||void 0===a||a.call(r,this),!0)},e.prototype._afterResize=function(){return this._isReleased||this._event.emit(t.ChartEvent.afterResize,{chart:this._chart}),this},e.prototype.updateViewBox=function(t,e,i){return void 0===e&&(e=!0),void 0===i&&(i=!0),this._chart&&this._compiler?(this._viewBox=t,this._chart.updateViewBox(t,i),i&&(this._compiler.render(),this._chart.onEvaluateEnd()),this._compiler.updateViewBox(t,e),this):this},e.prototype.on=function(t,e,i){var n;this._userEvents&&(this._userEvents.push({eType:t,query:"function"==typeof e?null:e,handler:"function"==typeof e?e:i}),null===(n=this._event)||void 0===n||n.on(t,e,i))},e.prototype.off=function(t,e){var i,n=this;if(this._userEvents&&0!==this._userEvents.length)if(e){var r=this._userEvents.findIndex((function(i){return i.eType===t&&i.handler===e}));r>=0&&(this._userEvents.splice(r,1),null===(i=this._event)||void 0===i||i.off(t,e))}else this._userEvents.forEach((function(e){var i;e.eType===t&&(null===(i=n._event)||void 0===i||i.off(t,e.handler))})),this._userEvents=this._userEvents.filter((function(e){return e.eType!==t}))},e.prototype.updateState=function(t,e){this._chart&&this._chart.updateState(t,e)},e.prototype.setSelected=function(t,e,i){this._chart&&this._chart.setSelected(t,e,i)},e.prototype.setHovered=function(t,e,i){this._chart&&this._chart.setHovered(t,e,i)},e.prototype.clearState=function(t){this._chart&&this._chart.clearState(t)},e.prototype.clearAllStates=function(){this._chart&&this._chart.clearAllStates()},e.prototype.clearSelected=function(){this._chart&&this._chart.clearSelected()},e.prototype.clearHovered=function(){this._chart&&this._chart.clearHovered()},e.prototype._updateCurrentTheme=function(t){var e,i,n,r=this._option.theme,a=null===(e=this._spec)||void 0===e?void 0:e.theme,o=null===(i=this._spec)||void 0===i?void 0:i.type;t&&(this._currentThemeName=t);var s,l,u=function(t,e){var i;return(null===(i=e.chart)||void 0===i?void 0:i[t])&&(e=qF({},e,e.chart[t])),e};if(lt(r)&&lt(a))s=dz(this._currentThemeName),this._currentTheme=u(o,s);else if(K(r)&&(!a||K(a))||K(a)&&(!r||K(r))){var c=qF({},dz(this._currentThemeName),dz(r),dz(a));this._currentTheme=u(o,c)}else{c=qF({},dz(this._currentThemeName),dz(r),dz(a));this._currentTheme=u(o,c)}this._cachedProcessedTheme=null,l=this.getTheme("component","poptip"),gt(iE.poptip,eE,l),null===(n=this._compiler)||void 0===n||n.setBackground(this._getBackground())},e.prototype._shouldChartResize=function(t){var e,i,n=!1;j(this._spec.width)?!j(t.width)&&(this._spec.width=t.width):this._spec.width!==t.width&&(n=!0),j(this._spec.height)?!j(t.height)&&(this._spec.height=t.height):this._spec.height!==t.height&&(n=!0);var r=this._autoSize;return this._autoSize=!!vx(this._option.mode)&&(null===(i=null!==(e=this._spec.autoFit)&&void 0!==e?e:this._option.autoFit)||void 0===i||i),this._autoSize!==r&&(n=!0),n},e.prototype._getBackground=function(){return("string"==typeof this._spec.background||W(this._spec.background)&&this._spec.background.gradient?this._spec.background:null)||this.getTheme("background")||this._option.background},e.prototype.getCurrentTheme=function(){return dz(this._currentThemeName)},e.prototype.getCurrentThemeName=function(){return this._currentThemeName},e.prototype.setCurrentTheme=function(t){return C(this,void 0,void 0,(function(){return E(this,(function(e){return[2,this.setCurrentThemeSync(t)]}))}))},e.prototype.setCurrentThemeSync=function(t){if(!hz.themeExist(t))return this;var e=this._setCurrentTheme(t);return this._setFontFamilyTheme(this.getTheme("fontFamily")),this.updateCustomConfigAndRerender(e,!0,{transformSpec:!1,actionSource:"setCurrentTheme"}),this},e.prototype._setCurrentTheme=function(t){var e;return this._updateCurrentTheme(t),this._initChartSpec(this._getSpecFromOriginalSpec(),"setCurrentTheme"),null===(e=this._chart)||void 0===e||e.setCurrentTheme(),{change:!0,reMake:!1}},e.prototype._setFontFamilyTheme=function(t){var e;t&&(null===(e=this.getStage())||void 0===e||e.setTheme({text:{fontFamily:t},richtext:{fontFamily:t}}))},e.prototype._getTooltipComponent=function(){var t;return null===(t=this._chart)||void 0===t?void 0:t.getComponentsByType(I.tooltip)[0]},e.prototype.setTooltipHandler=function(t){var e,i;this._context.tooltipHandler=t;var n=this._getTooltipComponent();n&&(null===(i=null===(e=n.tooltipHandler)||void 0===e?void 0:e.release)||void 0===i||i.call(e),n.tooltipHandler=t)},e.prototype.getTooltipHandlerByUser=function(){var t;return null===(t=this._context)||void 0===t?void 0:t.tooltipHandler},e.prototype.getTooltipHandler=function(){var t=this._getTooltipComponent();return t?t.tooltipHandler:this._context.tooltipHandler},e.prototype.showTooltip=function(t,e){var i,n=this._getTooltipComponent();return null!==(i=U(t)&&"none"!==(null==n?void 0:n.showTooltip(t,e)))&&void 0!==i&&i},e.prototype.hideTooltip=function(){var t,e=this._getTooltipComponent();return null!==(t=null==e?void 0:e.hideTooltip())&&void 0!==t&&t},e.prototype.getLegendDataById=function(t){var e,i=null===(e=this._chart)||void 0===e?void 0:e.getComponentByUserId(t);return i?i.getLegendData():[]},e.prototype.getLegendDataByIndex=function(t){var e;void 0===t&&(t=0);var i=null===(e=this._chart)||void 0===e?void 0:e.getComponentsByType(I.discreteLegend);return i&&i[t]?i[t].getLegendData():[]},e.prototype.getLegendSelectedDataById=function(t){var e,i=null===(e=this._chart)||void 0===e?void 0:e.getComponentByUserId(t);return i?i.getSelectedData():[]},e.prototype.getLegendSelectedDataByIndex=function(t){var e;void 0===t&&(t=0);var i=null===(e=this._chart)||void 0===e?void 0:e.getComponentsByType(I.discreteLegend);return i&&i[t]?i[t].getSelectedData():[]},e.prototype.setLegendSelectedDataById=function(t,e){var i,n=null===(i=this._chart)||void 0===i?void 0:i.getComponentByUserId(t);n&&n.setSelectedData(e)},e.prototype.setLegendSelectedDataByIndex=function(t,e){var i;void 0===t&&(t=0);var n=null===(i=this._chart)||void 0===i?void 0:i.getComponentsByType(I.discreteLegend);n&&n[t]&&n[t].setSelectedData(e)},e.prototype.getDataURL=function(){var t;return C(this,void 0,void 0,(function(){var e;return E(this,(function(i){switch(i.label){case 0:return e=this.getStage(),this._chart&&e?(e.render(),[4,YH(this._chart.getCanvas(),{onError:this._onError})]):[3,2];case 1:return[2,i.sent()];case 2:return null===(t=this._option)||void 0===t||t.onError(new ReferenceError("render is not defined")),[2,null]}}))}))},e.prototype.exportImg=function(t){var e,i;return C(this,void 0,void 0,(function(){var n;return E(this,(function(r){switch(r.label){case 0:return vx(this._option.mode)?[4,this.getDataURL()]:(null===(e=this._option)||void 0===e||e.onError(new TypeError("non-browser environment can not export img")),[2]);case 1:return(n=r.sent())?function(t,e){void 0===t&&(t="vchart");var i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("target","_blank"),i.setAttribute("download","".concat(t,".png")),i.dispatchEvent(new MouseEvent("click"))}(t,n):null===(i=this._option)||void 0===i||i.onError(new ReferenceError("render is not defined")),[2]}}))}))},e.prototype.exportCanvas=function(){var t,e=this.getStage();if(this._chart&&e)return e.toCanvas();null===(t=this._option)||void 0===t||t.onError(new ReferenceError("render is not defined"))},e.prototype.getImageBuffer=function(){var t,e;if("node"===this._option.mode){var i=this.getStage();return i?(i.render(),i.window.getImageBuffer()):(null===(e=this._option)||void 0===e||e.onError(new ReferenceError("render is not defined")),null)}null===(t=this._option)||void 0===t||t.onError(new TypeError("getImageBuffer() now only support node environment."))},e.prototype.setLayout=function(t){var e;this._option.layout=t,null===(e=this._chart)||void 0===e||e.setLayout(t)},e.prototype.reLayout=function(){var t;this._chart.resetLayoutItemTag(),null===(t=this._chart)||void 0===t||t.setLayoutTag(!0)},e.prototype.getCompiler=function(){return this._compiler},e.prototype.getChart=function(){return this._chart},e.prototype.getStage=function(){return this._compiler.getStage()},e.prototype.getCanvas=function(){var t;return null===(t=this._compiler)||void 0===t?void 0:t.getCanvas()},e.prototype.getContainer=function(){var t,e;return U(this._container)?this._container:(e=K(this._canvas)?j_.getElementById(this._canvas):this._canvas,U(e)?e.parentElement:null===(t=this.getCanvas())||void 0===t?void 0:t.parentElement)},e.prototype.getComponents=function(){return this._chart.getAllComponents()},e.prototype.getScale=function(t){var e,i=null===(e=this._chart)||void 0===e?void 0:e.getGlobalScale();return null==i?void 0:i.getScale(t)},e.prototype.setDimensionIndex=function(t,e){var i;return void 0===e&&(e={}),null===(i=this._chart)||void 0===i?void 0:i.setDimensionIndex(t,e)},e.prototype.stopAnimation=function(){var t;null===(t=this.getStage())||void 0===t||t.stopAnimation(!0)},e.prototype.reRunNormalAnimation=function(){var t;null===(t=this.getStage())||void 0===t||t.reApplyAnimationState("normal",!0)},e.prototype.pauseAnimation=function(){var t;null===(t=this.getStage())||void 0===t||t.pauseAnimation(!0)},e.prototype.resumeAnimation=function(){var t;null===(t=this.getStage())||void 0===t||t.resumeAnimation(!0)},e.prototype.convertDatumToPosition=function(t,e,i,n){var r;if(void 0===e&&(e={}),void 0===i&&(i=!1),!this._chart)return null;if(lt(t))return null;var a,o=e.seriesId,s=e.seriesIndex,l=void 0===s?0:s;if(U(o)?a=this._chart.getSeriesInUserId(o):U(l)&&(a=null===(r=this._chart.getSeriesInIndex([l]))||void 0===r?void 0:r[0]),a){var u=Object.keys(t),c=a.getViewData().latestData.find((function(e){return u.every((function(i){return e[i]==t[i]}))})),h=a.getRegion().getLayoutStartPoint(),d=void 0;return(d=c?a.dataToPosition(c,n):a.dataToPosition(t,n))?DF(d,h,i):null}return null},e.prototype.convertValueToPosition=function(t,e,i){var n,r;if(void 0===i&&(i=!1),!this._chart||j(t)||lt(e))return null;if(!q(t)){var a=e,o=a.axisId,s=a.axisIndex,l=void 0;if(U(o)?l=this._chart.getComponentsByKey("axes").find((function(t){return t.userId===o})):U(s)&&(l=null===(n=this._chart.getComponentsByKey("axes"))||void 0===n?void 0:n[s]),!l)return cx("Please check whether the `axisId` or `axisIndex` is set!"),null;var u=null==l?void 0:l.valueToPosition(t);if(i){var c=l.getLayoutStartPoint(),h=l.getOrient();return u+("bottom"===h||"top"===h?c.x:c.y)}return u}var d,p=e,f=p.seriesId,v=p.seriesIndex;return U(f)?d=this._chart.getSeriesInUserId(f):U(v)&&(d=null===(r=this._chart.getSeriesInIndex([v]))||void 0===r?void 0:r[0]),d?DF(d.valueToPosition(t[0],t[1]),d.getRegion().getLayoutStartPoint(),i):(cx("Please check whether the `seriesId` or `seriesIndex` is set!"),null)},e.prototype.getFunction=function(t){return ON.instance().getFunction(t)},e.prototype.registerFunction=function(t,e){t&&e&&ON.instance().registerFunction(t,e)},e.prototype.unregisterFunction=function(t){t&&ON.instance().unregisterFunction(t)},e.prototype.getFunctionList=function(){return ON.instance().getFunctionNameList()},e.prototype.setRuntimeSpec=function(t){this._spec=t,this._updateSpecInfo()},e.prototype.updateIndicatorDataById=function(t,e){var i,n=null===(i=this._chart)||void 0===i?void 0:i.getComponentByUserId(t);n&&n.updateDatum(e)},e.prototype.updateIndicatorDataByIndex=function(t,e){var i;void 0===t&&(t=0);var n=null===(i=this._chart)||void 0===i?void 0:i.getComponentsByType(I.indicator);n&&n[t]&&n[t].updateDatum(e)},e.prototype.geoZoomByIndex=function(t,e,i){void 0===t&&(t=0),this._geoZoomByQuery({regionIndex:t},e,i)},e.prototype.geoZoomById=function(t,e,i){this._geoZoomByQuery({regionId:t},e,i)},e.prototype._geoZoomByQuery=function(t,e,i){var n,r,a=null===(n=this._chart)||void 0===n?void 0:n.getRegionsInQuerier(t)[0],o=null===(r=this._chart)||void 0===r?void 0:r.getComponentsByType(I.geoCoordinate),s=null==o?void 0:o.find((function(t){var e;return null===(e=t.getRegions())||void 0===e?void 0:e.includes(a)}));s&&s.dispatchZoom(e,i)},e.prototype._initChartPlugin=function(){var t=KF.getChartPlugins();t.length>0&&(this._chartPlugin=new NN(this),this._chartPlugin.load(t.map((function(t){return new t}))),this._chartPluginApply("onInit",this._spec));var e=KF.getVChartPlugins();e.length>0&&(this._vChartPlugin=new dV(this),this._vChartPlugin.load(e.map((function(t){return new t}))),this._vChartPlugin.onInit())},e.prototype._chartPluginApply=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this._chartPlugin&&this._chartPlugin[t]&&this._chartPlugin[t].apply(this._chartPlugin,e)},e.prototype._getMode=function(){return this._option.mode||t.RenderModeEnum["desktop-browser"]},e.prototype.isAnimationEnable=function(){return"animation"in this._option?!!this._option.animation:!1!==this._spec.animation},e.prototype._getChartOption=function(t){var e=this;return{type:t,globalInstance:this,eventDispatcher:this._eventDispatcher,dataSet:this._dataSet,container:this._container,canvas:this._canvas,map:new Map,mode:this._getMode(),modeParams:this._option.modeParams,getCompiler:function(){return e._compiler},viewBox:this._viewBox,getTheme:this.getTheme,getSpecInfo:function(){var t;return null!==(t=e._specInfo)&&void 0!==t?t:{}},layout:this._option.layout,onError:this._onError,disableTriggerEvent:!0===this._option.disableTriggerEvent}},e.InstanceManager=cz,e.ThemeManager=hz,e.globalConfig={uniqueTooltip:!0},e.Utils=DN,e.vglobal=j_,e}();KF.registerRegion("region",sN),KF.registerLayout("base",_N),IN(),eV(),lV(),hV(),az(jF.name,jF);var fV="monotone",vV="linear",gV="bevel";function yV(t,e){return e("component",t)}function mV(t,e,i,n){if(t)return{formatFunc:t,args:[i,n]};var r=KF.getFormatter();return e&&r?{formatFunc:r,args:[i,n,e]}:{}}t.Direction=void 0,function(t){t.vertical="vertical",t.horizontal="horizontal"}(t.Direction||(t.Direction={}));var _V=function(t,e,i,n){if(!j(t[e])){var r=q(t[e]),a=r?t[e]:[t[e]],o=[];return a.forEach((function(t,a){!t||n&&!n(t)||o.push({spec:t,specPath:r?[e,a]:[e],specInfoPath:["component",e,a],type:i})})),o}},bV=function(t,e){if(!e.from||!e.from())return t;var i,n=e.fields,r=e.key,a=e.values,o=e.default,s=e.as||[n],l=e.from().reduce((function(t,e){return e[n]&&t.set(e[n],e),t}),new Map);if(V(e.set))i=function(t){var i=l.get(t[r]);e.set(t,i)};else if(a){var u=a.length;i=function(t){var e=l.get(t[r]);if(j(e))for(var i=0;i<u;++i)t[s[i]]=o;else for(i=0;i<u;++i)t[s[i]]=e[a[i]]}}else i=function(t){var e=l.get(t[r]);t[s[0]]=U(e)?e:o};return 0===t.length?[]:t.map((function(t){return i(t),t}))},xV=function(t,e){var i=e.beforeCall();return t&&t.forEach((function(t,n){return e.call(t,n,i)})),i.keyMap&&(i.keyMap.clear(),i.keyMap=null),t},kV=function(t,e,i,n){var r;if(r=V(t)?t(e,i):Y(t)&&U(t.field)?ut(e,t.field):t,n){var a=mV(void 0,n,t,e),o=a.formatFunc,s=a.args;o&&s&&(r=o.apply(void 0,R([],B(s),!1)))}return r},SV=function(t,e,i){return j(t)?t:V(t)?t(e,i):t};var AV=function(t,e){return!e||!1!==e.visible&&((!e[t]||!1!==e[t].visible)&&!(e.activeType&&!(q(e.activeType)?e.activeType.includes(t):e.activeType===t)))};function MV(t,e,i,n,r,a){var o=function(e){if(e){var o={datum:r},s=j(e.key)&&j(e.value)&&!lt(e)?T(T(T({},n),i),e):T(T({},n),e),l=s.key,u=s.keyFormatter,c=s.keyTimeFormat,h=s.keyTimeFormatMode,d=s.value,p=s.valueFormatter,f=s.valueTimeFormat,v=s.valueTimeFormatMode,g=w(s,["key","keyFormatter","keyTimeFormat","keyTimeFormatMode","value","valueFormatter","valueTimeFormat","valueTimeFormatMode"]);o.key=CV(kV(l,r,a,u),c,h),o.value=CV(kV(d,r,a,p),f,v),Object.keys(g).forEach((function(t){o[t]=kV(s[t],r,a)})),!1!==o.visible&&(U(o.key)||U(o.value))&&t.push(o)}};q(e)?e.forEach((function(t){o(t)})):o(e)}function TV(t,e,i,n,r,a,o){V(e)?MV(t,e(r,o),i,n,a,o):e&&MV(t,e,i,n,a,o)}var wV,CV=function(t,e,i){if(!e&&!i)return"object"!=typeof t?null==t?void 0:t.toString():t;var n=Xi.getInstance();return e=e||"%Y%m%d",("local"===(i=i||"local")?n.timeFormat:n.timeUTCFormat)(e,t)},EV=function(){function t(t){var e=this;this.activeTriggerSet={mark:new Set,group:new Set},this.ignoreTriggerSet={mark:new Set},this._getSeriesCacheInfo=function(){var t,i,n,r=e.series,a=r.getSeriesField();return{seriesFields:U(a)?St(a):null!==(t=r.getSeriesKeys())&&void 0!==t?t:[],dimensionFields:null!==(i=r.getDimensionField())&&void 0!==i?i:[],measureFields:null!==(n=r.getMeasureField())&&void 0!==n?n:[],type:r.type}},this._getDimensionData=function(t){var i=e._seriesCacheInfo.dimensionFields;return i[0]&&(null==t?void 0:t[i[0]])},this._getMeasureData=function(t){var i=e._seriesCacheInfo.measureFields;return i[0]&&(null==t?void 0:t[i[0]])},this._getSeriesFieldData=function(t){var i=e._seriesCacheInfo,n=i.dimensionFields,r=i.seriesFields;if(U(r[0])&&(null==t?void 0:t[r[0]]))return null==t?void 0:t[r[0]];var a=n[n.length-1];return n.length>1&&(0===r.length||e.series.getSeriesKeys().length),null==t?void 0:t[a]},this._getSeriesStyle=function(t,i,n){var r,a,o;try{for(var s=P(St(i)),l=s.next();!l.done;l=s.next()){var u=l.value,c=null===(o=e.series.getSeriesStyle(t))||void 0===o?void 0:o(u);if(U(c))return c}}catch(t){r={error:t}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(r)throw r.error}}return n},this.markTooltipKeyCallback=function(t,i){return e._getSeriesFieldData(t)},this.markTooltipValueCallback=function(t,i){return e._getMeasureData(t)},this.shapeTypeCallback=function(t,i){var n;return null!==(n=e._getSeriesStyle(t,"shape",null))&&void 0!==n?n:e._getSeriesStyle(t,"symbolType",e.series.getDefaultShapeType())},this.shapeColorCallback=function(t,i){return e._getSeriesStyle(t,["fill","stroke"])},this.shapeStrokeCallback=function(t,i){return e._getSeriesStyle(t,["stroke","fill"])},this.dimensionTooltipTitleCallback=function(t,i){return e._getDimensionData(t)},this.groupTooltipTitleCallback=function(t,i){return e._getSeriesFieldData(t)},this.groupTooltipKeyCallback=function(t,i){var n=e._seriesCacheInfo.seriesFields,r=e._seriesCacheInfo.dimensionFields;return n[0]&&(r=r.filter((function(t){return t!==n[0]}))),r.map((function(e){return null==t?void 0:t[e]})).join("-")},this.getHasShape=function(t){return!!t},this.series=t,this.updateTooltipSpec()}return t.prototype.updateTooltipSpec=function(){var t,e=null===(t=this.series.getSpec())||void 0===t?void 0:t.tooltip;this.spec=e,this._seriesCacheInfo=this._getSeriesCacheInfo()},t.prototype.getShapeAttrs=function(t,e,i){var n,r,a,o,s,l,u,c,h,d,p,f,v=e?"content":"title",g=T(T(T(T(T({},null===(n=null==i?void 0:i.style)||void 0===n?void 0:n.shape),null==i?void 0:i[t]),null===(r=null==i?void 0:i[t])||void 0===r?void 0:r[v]),null===(a=this.spec)||void 0===a?void 0:a[t]),null===(s=null===(o=this.spec)||void 0===o?void 0:o[t])||void 0===s?void 0:s[v]);return{shapeType:null!==(l=g.shapeType)&&void 0!==l?l:this.shapeTypeCallback,shapeFill:null!==(c=null!==(u=g.shapeFill)&&void 0!==u?u:g.shapeColor)&&void 0!==c?c:this.shapeColorCallback,shapeStroke:null!==(h=g.shapeStroke)&&void 0!==h?h:this.shapeStrokeCallback,shapeHollow:null!==(d=g.shapeHollow)&&void 0!==d&&d,shapeLineWidth:g.shapeLineWidth,shapeSize:null!==(p=g.shapeSize)&&void 0!==p?p:g.size,hasShape:null!==(f=g.hasShape)&&void 0!==f?f:this.getHasShape(e)}},t.prototype.enableByType=function(t){return!0},t.prototype.getDefaultContentList=function(t){return[this.getDefaultContentPattern(t)]},t.prototype.getContentList=function(t,e,i,n,r,a){var o;return function(t,e,i,n,r,a){if(r&&r.length){var o=[];return r.forEach((function(r){q(t)?t.forEach((function(t){TV(o,t,e,i,n,r,a)})):V(t)?TV(o,t,e,i,n,r,a):t&&MV(o,t,e,i,r,a)})),o}return null}(null!==(o=null==e?void 0:e.content)&&void 0!==o?o:this.getDefaultContentList(t),this.getDefaultContentPattern(t),i,n,r,a)},t.prototype.getTitleResult=function(t,e,i,n,r){var a=V(e)?e(n,r):e;if(a?j(a.value)&&(a=T(T({},this.getDefaultTitlePattern(t)),a)):a=this.getDefaultTitlePattern(t),a&&!1!==a.visible){var o=function(t){var e,i,n,r,a,o,s,l=(null===(s=t[0])||void 0===s?void 0:s.series)?[{data:t,value:""}]:t;try{for(var u=P(l),c=u.next();!c.done;c=u.next()){var h=c.value.data;try{for(var d=(n=void 0,P(h)),p=d.next();!p.done;p=d.next()){var f=p.value.datum;try{for(var v=(a=void 0,P(null!=f?f:[])),g=v.next();!g.done;g=v.next()){var y=g.value;if(y)return y}}catch(t){a={error:t}}finally{try{g&&!g.done&&(o=v.return)&&o.call(v)}finally{if(a)throw a.error}}}}catch(t){n={error:t}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(e)throw e.error}}}(n),s={visible:kV(a.visible,o,r),value:CV(kV(a.value,o,r,a.valueFormatter),a.valueTimeFormat,a.valueTimeFormatMode),valueStyle:kV(a.valueStyle,o,r),hasShape:a.hasShape};return Object.keys(i).forEach((function(t){s[t]=kV(i[t],o,r)})),s}return{hasShape:!1,visible:!1}},t.prototype.getTooltipData=function(t,e,i,n,r){var a,o;if(!(this.enableByType(t)&&AV(t,this.spec)&&("dimension"!==t||n&&n.length)))return null;var s,l=null!==(o=null===(a=this.spec)||void 0===a?void 0:a[t])&&void 0!==o?o:null==e?void 0:e[t],u=this.getShapeAttrs(t,!0,e),c=this.getShapeAttrs(t,!1,e);"dimension"===t?(s=[],this.getContentList(t,l,u,i,n,r).forEach((function(t){s.push(t)}))):s=this.getContentList(t,l,u,i,n,r);return{visible:!0,activeType:t,data:i,title:this.getTitleResult(t,null==l?void 0:l.title,c,i,r),content:s}},t.prototype.getDefaultTitlePattern=function(t){return{key:void 0,value:"group"===t?this.groupTooltipTitleCallback:this.dimensionTooltipTitleCallback}},t.prototype.getDefaultContentPattern=function(t){return{seriesId:this.series.id,key:"group"===t?this.groupTooltipKeyCallback:this.markTooltipKeyCallback,value:this.markTooltipValueCallback}},t}(),PV={min:function(t){return t.length?Tt(t.map((function(t){return 1*t}))):0},max:function(t){return t.length?Mt(t.map((function(t){return 1*t}))):0},"array-min":function(t){return t.length?Tt(t.map((function(t){return 1*t}))):0},"array-max":function(t){return t.length?Mt(t.map((function(t){return 1*t}))):0},values:function(t){var e,i,n={},r=[];try{for(var a=P(t),o=a.next();!o.done;o=a.next()){var s=o.value;n[s]||(r.push(s),n[s]=1)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}return r}},BV=function(t,e){var i,n,r=e.fields;if(V(r)&&(r=r()),!(null==r?void 0:r.length)||!(null==t?void 0:t.length))return{};r=Wz([],r);var a="parser"===e.target?"parserData":"latestData",o=t[0][a]?t[0][a]:t||[],s=null===(n=(i=t[0]).getFields)||void 0===n?void 0:n.call(i);return RV(o,r,s)},RV=function(t,e,i){var n={},r=[],a=[];return e.forEach((function(e){var o=e.key;n[o]={};var s=null==i?void 0:i[o],l=e.operations,u=l.some((function(t){return"min"===t||"max"===t||"allValid"===t})),c=!0;r.length=0,t&&t.forEach((function(t){t&&r.push(t[o])}));var h=r.length;if(u){a.length=0,r.forEach((function(t,e){bx(t)&&a.push(t)}));var d=r;r=a,a=d,c=r.length===h}else r=l.some((function(t){return"array-min"===t||"array-max"===t}))?r.reduce((function(t,e){return e&&e.forEach((function(e){bx(e)&&t.push(e)})),t}),[]):r.filter((function(t){return void 0!==t}));e.filter&&(r=r.filter(e.filter)),l.forEach((function(t){if(e.customize)n[o][t]=e.customize;else{if(s&&!0===s.lockStatisticsByDomain&&!j(s.domain)){if("values"===t)return void(n[o][t]=s.domain.slice())}else if("allValid"===t)return;n[o][t]=PV[t](r),"array-max"===t&&(n[o].max=n[o][t]),"array-min"===t&&(n[o].min=n[o][t])}})),u&&(n[o].allValid=c)})),n},LV=function(t,e){var i=e.config;if(!i)return t;var n=i(),r=n.invalidType,a=n.checkField;return"zero"!==r||a&&a.length&&t.forEach((function(t){a.forEach((function(e){bx(t[e])||(t[e]=0)}))})),t},IV="".concat(mz,"_HIERARCHY_DEPTH"),DV="".concat(mz,"_HIERARCHY_ROOT"),OV="".concat(mz,"_HIERARCHY_ROOT_INDEX");function FV(){return{keyMap:new Map,needDefaultSeriesField:!this._seriesField,defaultSeriesField:this._seriesField?null:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey)}}function zV(t,e,i){t&&(i.needDefaultSeriesField&&(t[Az]=i.defaultSeriesField),t[kz]=e,t[Sz]=i.getKey(t,e,i))}function HV(){return{keyMap:new Map,needDefaultSeriesField:!0,defaultSeriesField:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey),categoryField:this.getCategoryField()}}function NV(t,e,i,n,r,a){void 0===n&&(n=0),void 0===a&&(a=e),zV(t,e,i),t[IV]=n,t[DV]=r||t[i.categoryField],t[OV]=a,t.children&&t.children.length&&t.children.forEach((function(e,n){return NV(e,n,i,t[IV]+1,t[DV],a)}))}var VV=((wV={}).label={name:"label",type:"text"},wV),jV="".concat(mz,"_rect_x"),UV="".concat(mz,"_rect_x1"),WV="".concat(mz,"_rect_y"),GV="".concat(mz,"_rect_y1"),YV={data:!0},XV={invalidType:!0,animation:!0,animationAppear:!0,animationEnter:!0,animationUpdate:!0,animationExit:!0,animationNormal:!0},KV=R(R([],B(Object.keys(UN)),!1),["normal"],!1);function qV(t,e,i){void 0===t&&(t={});for(var n={},r=function(r){var a,o=KV[r],s=e?e[o]:void 0;if(!1===s)return"continue";if("normal"===o)return s&&(n.normal=s),"continue";if("state"===o)return!1!==s&&(n.state=null!=s?s:UN.state),"continue";if("update"!==o&&!s&&!t[o])return"continue";if(a=q(t[o])?t[o]:[T(T({},UN[o]),t[o])],"exit"===o&&a.forEach((function(t){t.controlOptions={stopWhenStateChange:!0}})),!s)return n[o]=a,"continue";var l=void 0;l=q(s)?s.map((function(t,e){var n,r=t;return tj(r)&&delete r.type,r.oneByOne&&(r=JV(r,null!==(n=null==i?void 0:i.dataIndex)&&void 0!==n?n:QV,null==i?void 0:i.dataCount)),r})):a.map((function(t,e){var n,r=XF({},a[e],s);return tj(r)&&delete r.type,r.oneByOne&&(r=JV(r,null!==(n=null==i?void 0:i.dataIndex)&&void 0!==n?n:QV,null==i?void 0:i.dataCount)),r})),n[o]=l},a=0;a<KV.length;a++)r(a);return n}function ZV(t,e,i){var n,r,a,o,s,l,u={};return U(e.animationAppear)&&(u.appear=null!==(n=e.animationAppear[t])&&void 0!==n?n:e.animationAppear),U(e.animationDisappear)&&(u.disappear=null!==(r=e.animationDisappear[t])&&void 0!==r?r:e.animationDisappear),U(e.animationEnter)&&(u.enter=null!==(a=e.animationEnter[t])&&void 0!==a?a:e.animationEnter),U(e.animationExit)&&(u.exit=null!==(o=e.animationExit[t])&&void 0!==o?o:e.animationExit),U(e.animationUpdate)&&(u.update=null!==(s=e.animationUpdate[t])&&void 0!==s?s:e.animationUpdate),U(e.animationState)&&(u.state=null!==(l=e.animationState[t])&&void 0!==l?l:e.animationState),e.animationNormal&&e.animationNormal[t]&&(u.normal=e.animationNormal[t]),function(t,e){if(!t)return t;var i=["custom","customParameters"];return t=dt(t,null,i),ej(t,(function(t){var i;if(V(t)&&(null===(i=t.prototype)||void 0===i?void 0:i.constructor)!==t){var n=function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return t.apply(void 0,R(R([],B(i),!1),[e],!1))};return n}return t}),i),t}(u,i)}function JV(t,e,i){var n=t.oneByOne,r=t.duration,a=t.delay,o=t.delayAfter;return t.delay=function(t,i,o){var s=e(t,o),l=V(r)?r(t,i,o):et(r)?r:0,u=V(a)?a(t,i,o):et(a)?a:0,c=V(n)?n(t,i,o):n;return!1===c?u:u+s*(l+(c=!0===c?0:c))},t.delayAfter=function(t,a,s){var l=e(t,s),u=V(r)?r(t,a,s):et(r)?r:0,c=V(o)?o(t,a,s):et(o)?o:0,h=V(n)?n(t,a,s):n;return!1===h?c:c+((i?i():a.parent.count-1)-l)*(u+(h=!0===h?0:h))},delete t.oneByOne,t}function QV(t,e){var i;return null!==(i=null==t?void 0:t[kz])&&void 0!==i?i:e.context.graphicIndex}function $V(t,e){var i,n,r,a,o;if(!1===t.animation)return!1;if(!1===(null===(i=t.morph)||void 0===i?void 0:i.enable))return!1;var s=!1!==(null!==(r=null===(n=t.animationAppear)||void 0===n?void 0:n[e])&&void 0!==r?r:t.animationAppear),l=!1!==(null!==(o=null===(a=t.animationUpdate)||void 0===a?void 0:a[e])&&void 0!==o?o:t.animationUpdate);return!(!s||!l)}function tj(t){return!function(t){return U(t.timeSlices)}(t)&&U(t.channel)}function ej(t,e,i){if(void 0===i&&(i=[]),q(t))t.forEach((function(n,r){t[r]=e(t[r],r),ej(t[r],e,i)}));else if(W(t))for(var n in t)i.includes(n)||(t[n]=e(t[n],n),ej(t[n],e,i))}function ij(t){var e,i,n,r,a,o,s=t.getSpec();if(!1===s.animation)return!1;if(!1===(null===(i=null===(e=t.getOption())||void 0===e?void 0:e.globalInstance)||void 0===i?void 0:i.isAnimationEnable()))return!1;var l=null!==(n=s.animationThreshold)&&void 0!==n?n:Number.MAX_SAFE_INTEGER;return null===(r=t.getMarks())||void 0===r||r.forEach((function(t){var e=t.getMarkConfig();e&&(e.large&&e.largeThreshold&&(l=Math.min(l,e.largeThreshold)),e.progressiveThreshold&&(l=Math.min(l,e.progressiveThreshold)))})),!((null===(o=null===(a=t.getRawData())||void 0===a?void 0:a.latestData)||void 0===o?void 0:o.length)>=l)}var nj=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markLabelSpec={},e}return M(e,t),e.prototype.getLabelSpec=function(t){return this.markLabelSpec[t]},e.prototype.setLabelSpec=function(t,e){this.markLabelSpec[t]=St(e)},e.prototype.addLabelSpec=function(t,e,i){void 0===i&&(i=!1),this.markLabelSpec[t]||(this.markLabelSpec[t]=[]),i?this.markLabelSpec[t].unshift(e):this.markLabelSpec[t].push(e)},e.prototype.getTheme=function(t,e){var i,n,r,a=cF(t),o=null===(i=this._option)||void 0===i?void 0:i.getTheme,s=this._option.type,l=KF.getSeriesMarkMap(s)?function(t,e,i){var n=KF.getSeriesMarkMap(e);if(!n)return t;var r={};return Object.values(n).forEach((function(e){var n=e.type,a=e.name;r[a]=XF({},i("mark",St(n)[0]),i("markByName",a),null==t?void 0:t[a])})),T(T({},t),r)}(o("series",s),s,o):{},u=o("series","".concat(s,"_").concat(a));return XF({},l,u,(null!==(r=null!==(n=this.stack)&&void 0!==n?n:null==u?void 0:u.stack)&&void 0!==r?r:null==l?void 0:l.stack)?o("series","".concat(s,"_stack")):void 0)},e.prototype.transformSpec=function(e,i,n){this._transformStack(e);var r=t.prototype.transformSpec.call(this,e,i,n);return this._transformLabelSpec(r.spec),T(T({},r),{markLabelSpec:this.markLabelSpec,stack:this.stack})},e.prototype._transformLabelSpec=function(t){},e.prototype._transformStack=function(t){N(t.stack)&&(this.stack=t.stack),N(t.percent)&&(this.stack=t.percent||this.stack),j(this.stack)&&this._supportStack&&t.seriesField&&(this.stack=!0)},e.prototype._addMarkLabelSpec=function(t,e,i,n,r,a){var o=this;(void 0===i&&(i="label"),void 0===n&&(n="initLabelMarkStyle"),void 0===r&&(r=!0),t)&&St(t[i]).forEach((function(i){var s,l,u;if(i&&i.visible){var c=i.animation,h=void 0===c||c,d=i.animationUpdate,p=void 0===d||d,f=i.animationEnter,v=void 0===f||f,g=i.animationExit,y=void 0===g||g,m=t,_=m.animationUpdate,b=void 0===_||_,x=m.animationEnter,k=void 0===x||x,S=m.animationExit,A=void 0===S||S,M=!!(null!==(u=null!==(l=null===(s=o._option.globalInstance)||void 0===s?void 0:s.isAnimationEnable())&&void 0!==l?l:t.animation)&&void 0!==u?u:i.animation)&&!!r;o.addLabelSpec(V(e)?e(i):e,T(T({},i),{animation:!!M&&h,animationUpdate:!!(M&&b&&p)&&b,animationEnter:!!(M&&k&&v)&&k,animationExit:!!(M&&k&&y)&&A,getStyleHandler:function(t){var e;return null===(e=t[n])||void 0===e?void 0:e.bind(t)}}),a)}}))},e.prototype._getDefaultSpecFromChart=function(e){var i,n=null!==(i=t.prototype._getDefaultSpecFromChart.call(this,e))&&void 0!==i?i:{},r=e.outerRadius,a=e.innerRadius,o=e.direction;return U(r)&&(n.outerRadius=r),U(a)&&(n.innerRadius=a),U(o)&&(n.direction=o),Object.keys(n).length>0?n:void 0},e.prototype._mergeThemeToSpec=function(t,e){var i=this._theme;if(this._shouldMergeThemeToSpec()){var n=this._getDefaultSpecFromChart(e),r=function(t){var e=XF({},i,n,t),r=i.label;return r&&W(r)&&q(e.label)&&(e.label=e.label.map((function(t){return XF({},r,t)}))),e};return q(t)?{spec:t.map((function(t){return r(t)})),theme:i}:{spec:r(t),theme:i}}return{spec:t,theme:i}},e}(iN);var rj=function(e){function i(i,n){var r,a=this;return(a=e.call(this,i,n)||this).specKey="series",a.type="series",a.layoutType="absolute",a.modelType="series",a.name=void 0,a.transformerConstructor=nj,a.coordinate="none",a._region=null,a._layoutStartPoint={x:0,y:0},a._layoutRect={width:null,height:null},a.getLayoutRect=function(){var t,e;return{width:null!==(t=a._layoutRect.width)&&void 0!==t?t:a._region.getLayoutRect().width,height:null!==(e=a._layoutRect.height)&&void 0!==e?e:a._region.getLayoutRect().height}},a._rootMark=null,a._seriesMark=null,a._viewDataMap=new Map,a._viewDataFilter=null,a._data=null,a.layoutZIndex=t.LayoutZIndex.SeriesGroup,a._invalidType="break",a._region=n.region,a._dataSet=n.dataSet,(null===(r=a._spec)||void 0===r?void 0:r.name)&&(a.name=a._spec.name),a}return M(i,e),i.prototype.getRegion=function(){return this._region},i.prototype.getLayoutStartPoint=function(){return this._region.getLayoutStartPoint()},i.prototype.getRootMark=function(){return this._rootMark},i.prototype.getSeriesMark=function(){return this._seriesMark},i.prototype.getRawData=function(){return this._rawData},i.prototype.getViewDataFilter=function(){return this._viewDataFilter},i.prototype.getViewData=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.getDataView()},i.prototype.getViewDataProductId=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.getProductId()},i.prototype.getViewDataStatistics=function(){return this._viewDataStatistics},i.prototype.getViewStackData=function(){return this._viewStackData},i.prototype.getSeriesField=function(){return this._seriesField},i.prototype.setSeriesField=function(t){U(t)&&(this._seriesField=t)},i.prototype.getGroups=function(){return this._groups},i.prototype.getStack=function(){var t;return null===(t=this.getSpecInfo())||void 0===t?void 0:t.stack},i.prototype.getStackValue=function(){var t;return null!==(t=this._spec.stackValue)&&void 0!==t?t:"".concat(mz,"_series_").concat(this.type)},i.prototype.getPercent=function(){return this._spec.percent},i.prototype.getStackOffsetSilhouette=function(){return this._spec.stackOffsetSilhouette},Object.defineProperty(i.prototype,"tooltipHelper",{get:function(){return this._tooltipHelper||this.initTooltip(),this._tooltipHelper},enumerable:!1,configurable:!0}),i.prototype.getInvalidType=function(){return this._invalidType},i.prototype.setInvalidType=function(t){var e;this._invalidType=t,null===(e=this.getViewData())||void 0===e||e.reRunAllTransform()},i.prototype.getMarkAttributeContext=function(){return this._markAttributeContext},i.prototype.created=function(){e.prototype.created.call(this),this._buildMarkAttributeContext(),this.initData(),this.initGroups(),this.initStatisticalData(),this.event.emit(t.ChartEvent.afterInitData,{model:this}),this.initRootMark(),this.initMark();var i=ij(this);this._initExtensionMark({hasAnimation:i}),this.initMarkStyle(),this.initMarkState(),i&&this.initAnimation(),this.afterInitMark(),this.initEvent(),this.event.emit(t.ChartEvent.afterInitEvent,{model:this})},i.prototype._buildMarkAttributeContext=function(){var t=this;this._markAttributeContext={vchart:this._option.globalInstance,globalScale:function(e,i){var n;return null===(n=t._option.globalScale.getScale(e))||void 0===n?void 0:n.scale(i)},seriesColor:function(e){var i;return j(e)&&(e=t.getSeriesKeys()[0]),null===(i=t._option.globalScale.getScale("color"))||void 0===i?void 0:i.scale(e)},getRegion:function(){return t._region}}},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setSeriesField(this._spec.seriesField),U(this._spec.invalidType)&&(this._invalidType=this._spec.invalidType)},i.prototype.getInvalidCheckFields=function(){return[this.getStackValueField()]},i.prototype.initInvalidDataTransform=function(){var t,e,i=this;"zero"===this._invalidType&&(null===(t=this._rawData)||void 0===t?void 0:t.dataSet)&&(kH(this._rawData.dataSet,"invalidTravel",LV),null===(e=this._rawData)||void 0===e||e.transform({type:"invalidTravel",options:{config:function(){return{invalidType:i._invalidType,checkField:i.getInvalidCheckFields()}}}},!1))},i.prototype.initData=function(){var t,e,i,n=null!==(t=this._spec.data)&&void 0!==t?t:this._option.getSeriesData(this._spec.dataId,this._spec.dataIndex);if(n&&(this._rawData=OH(n,this._dataSet,this._option.sourceDataList)),null===(i=null===(e=this._rawData)||void 0===e?void 0:e.target)||void 0===i||i.addListener("change",this.rawDataUpdate.bind(this)),this._addDataIndexAndKey(),this._rawData){this.getStack()&&(this._viewDataFilter=DH(this._rawData,this._dataSet,{name:"".concat(this.type,"_").concat(this.id,"_viewDataFilter")}));var r=DH(this.getStack()?this._viewDataFilter:this._rawData,this._dataSet,{name:"".concat(this.type,"_").concat(this.id,"_viewData")});this._data=new wN(this._option,r),this.getStack()&&this._viewDataFilter.target.removeListener("change",r.reRunAllTransform)}this.initInvalidDataTransform()},i.prototype.initGroups=function(){var t=this.getGroupFields();t&&t.length&&(this._groups={fields:t})},i.prototype.initStatisticalData=function(){this._data&&this._statisticViewData()},i.prototype.getRawDataStatisticsByField=function(t,e){var i,n,r;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]||e&&(j(this._rawStatisticsCache[t].min)||j(this._rawStatisticsCache[t].max))||!e&&j(this._rawStatisticsCache[t].values))if(this._viewDataStatistics&&(!this._viewDataFilter||this._viewDataFilter.transformsArr.length<=1)&&this.getViewData().transformsArr.length<=1&&(null===(i=this._viewDataStatistics.latestData)||void 0===i?void 0:i[t]))this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t];else if(this._rawData){var a=null===(n=this._rawData.getFields())||void 0===n?void 0:n[t];if(a&&a.lockStatisticsByDomain&&a.domain)this._rawStatisticsCache[t]={},e?(this._rawStatisticsCache[t].min=Tt(a.domain),this._rawStatisticsCache[t].max=Mt(a.domain)):this._rawStatisticsCache[t].values=a.domain;else{var o=RV(this._rawData.latestData,[{key:t,operations:e?["min","max"]:["values"]}])[t];this._rawStatisticsCache[t]=gt(null!==(r=this._rawStatisticsCache[t])&&void 0!==r?r:{},o)}}return this._rawStatisticsCache[t]},i.prototype._statisticViewData=function(){var t=this;kH(this._dataSet,"dimensionStatistics",BV);var e="".concat(this.type,"_").concat(this.id,"_viewDataStatic");this._viewDataStatistics=new hs(this._dataSet,{name:e}),this._viewDataStatistics.parse([this._data.getDataView()],{type:"dataview"}),this._viewDataStatistics.transform({type:"dimensionStatistics",options:{fields:function(){var e=t.getStatisticFields();return t._seriesField&&Wz(e,[{key:t._seriesField,operations:["values"]}]),e},target:"latest"}},!1),this._data.getDataView().target.removeListener("change",this._viewDataStatistics.reRunAllTransform),this.getStack()&&this.createdStackData()},i.prototype.createStatisticalData=function(t,e,i){var n=this;kH(this._dataSet,"dimensionStatistics",BV);var r=new hs(this._dataSet,{name:t});return r.parse([e],{type:"dataview"}),r.transform({type:"dimensionStatistics",options:{operations:["max","min","values"],fields:function(){var t,r=Wz(n.getStatisticFields(),null!==(t=null==i?void 0:i(e.name))&&void 0!==t?t:[]);return n._seriesField&&Wz(r,[{key:n._seriesField,operations:["values"]}]),r},target:"latest"}},!1),r},i.prototype.createdStackData=function(){var t="".concat(this.type,"_").concat(this.id,"_viewStackData");this._viewStackData=new hs(this._dataSet,{name:t}),this._viewStackData.parse([this._viewDataFilter],{type:"dataview"}),this._viewStackData.transform({type:"stackSplit",options:{fields:this.getStackGroupFields()}},!1)},i.prototype._noAnimationDataKey=function(t,e){return e},i.prototype.generateDefaultDataKey=function(t){var e,i=this;return j(t)?function(t,e,n){if(!1===i._spec.animation){var r=i._noAnimationDataKey(t,e);if(void 0!==r)return r}var a=n.keyMap,o=i._getSeriesDataKey(t);return void 0===a.get(o)?(a.set(o,0),o):(a.set(o,a.get(o)+1),"".concat(o,"_").concat(a.get(o)))}:K(t)?function(e){return e[t]}:q(t)&&t.every((function(t){return K(t)}))?function(e){return t.map((function(t){return e[t]})).join("-")}:V(t)?function(e,i){return t(e,i)}:(null===(e=this._option)||void 0===e||e.onError("invalid dataKey: ".concat(t)),function(t,e){})},i.prototype._addDataIndexAndKey=function(){var t;(null===(t=this._rawData)||void 0===t?void 0:t.dataSet)&&(kH(this._rawData.dataSet,"addVChartProperty",xV),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:FV.bind(this),call:zV}},!1))},i.prototype.updateRawData=function(t){this._rawData&&this._rawData.updateRawData(t)},i.prototype.rawDataUpdate=function(e){var i;null===(i=this._rawDataStatistics)||void 0===i||i.reRunAllTransform(),this._rawStatisticsCache=null,this.event.emit(t.ChartEvent.rawDataUpdate,{model:this})},i.prototype.viewDataFilterOver=function(e){this.event.emit(t.ChartEvent.viewDataFilterOver,{model:this})},i.prototype.viewDataUpdate=function(e){var i;this.event.emit(t.ChartEvent.viewDataUpdate,{model:this}),null===(i=this._data)||void 0===i||i.updateData(),this._viewDataStatistics&&this._viewDataStatistics.reRunAllTransform()},i.prototype.viewDataStatisticsUpdate=function(e){this.event.emit(t.ChartEvent.viewDataStatisticsUpdate,{model:this})},i.prototype.getDatumPositionValue=function(t,e){return!t||j(e)?null:t[e]},i.prototype.getDatumPositionValues=function(t,e){return!t||j(e)?[]:K(e)?[t[e]]:e.map((function(e){return t[e]}))},i.prototype.setValueFieldToStack=function(){},i.prototype.setValueFieldToPercent=function(){},i.prototype.setValueFieldToStackOffsetSilhouette=function(){},i.prototype.initRootMark=function(){var t,e,i;this._rootMark=this._createMark({type:"group",name:"seriesGroup_".concat(this.type,"_").concat(this.id)},{parent:null===(e=(t=this._region).getGroupMark)||void 0===e?void 0:e.call(t),dataView:!1}),this._rootMark.setMarkConfig({zIndex:null!==(i=this._spec.zIndex)&&void 0!==i?i:this.layoutZIndex})},i.prototype._getExtensionMarkNamePrefix=function(){return"".concat(this.type,"_").concat(this.id,"_extensionMark")},i.prototype._initExtensionMark=function(t){var e,i=this;this._spec.extensionMark&&(null===(e=this._spec.extensionMark)||void 0===e||e.forEach((function(e,n){i._createExtensionMark(e,null,i._getExtensionMarkNamePrefix(),n,t)})))},i.prototype._createExtensionMark=function(t,e,i,n,r){var a,o=this,s=this._createMark({type:t.type,name:U(t.name)?"".concat(t.name):"".concat(i,"_").concat(n)},{skipBeforeLayouted:!0,markSpec:t,parent:e,dataView:!1,componentType:t.componentType,key:t.dataKey});if(s){if(U(t.id)&&s.setUserId(t.id),r.hasAnimation){var l=qV({},ZV(t.type,t,this._markAttributeContext));s.setAnimationConfig(l)}if("group"===t.type)i="".concat(i,"_").concat(n),null===(a=t.children)||void 0===a||a.forEach((function(t,e){o._createExtensionMark(t,s,i,e,r)}));else if(!(e||j(t.dataId)&&j(t.dataIndex))){var u=this._option.getSeriesData(t.dataId,t.dataIndex);u===this._rawData?s.setData(this._data):(s.setDataView(u),u.target.addListener("change",(function(){s.getData().updateData()})))}}},i.prototype._updateExtensionMarkSpec=function(){var t,e=this;null===(t=this._spec.extensionMark)||void 0===t||t.forEach((function(t,i){var n=e._marks.getMarkWithInfo({name:U(t.name)?"".concat(t.name):"".concat(e._getExtensionMarkNamePrefix(),"_").concat(i)});n&&(e.initMarkStyleWithSpec(n,t),n.commit(!1,!0))}))},i.prototype.getStackData=function(){var t;return null===(t=this._viewStackData)||void 0===t?void 0:t.latestData},i.prototype._parseDefaultInteractionConfig=function(e){if(!(null==e?void 0:e.length))return[];var i,n=(i=this._option.mode)===t.RenderModeEnum["desktop-browser"]||i===t.RenderModeEnum["desktop-miniApp"]?{hover:{enable:!0,trigger:"pointermove",triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"pointertap"}}:gx(i)||yx(i)?{hover:{enable:!0,trigger:["pointerdown","pointermove"],triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"tap"}}:null,r=T({},null==n?void 0:n.hover),a=T({},null==n?void 0:n.select),o=this._spec.hover;N(o)?r.enable=o:W(o)&&(r.enable=!0,r=XF(r,o));var s=this._spec.select;N(s)?a.enable=s:W(s)&&(a.enable=!0,a=XF(a,s));var l,u=[{trigger:{type:"dimension-hover"},marks:e}];r.enable&&((l=iV(r,e)).length&&u.push({trigger:this._defaultHoverConfig(r),marks:l}));a.enable&&((l=iV(a,e)).length&&u.push({trigger:this._defaultSelectConfig(a),marks:l}));return u},i.prototype._defaultHoverConfig=function(e){return{type:"element-highlight",trigger:e.trigger,triggerOff:e.triggerOff,blurState:t.STATE_VALUE_ENUM.STATE_HOVER_REVERSE,highlightState:t.STATE_VALUE_ENUM.STATE_HOVER}},i.prototype._defaultSelectConfig=function(e){var i="multiple"===e.mode,n=U(e.triggerOff)?e.triggerOff:i?["empty"]:["empty",e.trigger];return{type:"element-select",trigger:e.trigger,triggerOff:n,reverseState:t.STATE_VALUE_ENUM.STATE_SELECTED_REVERSE,state:t.STATE_VALUE_ENUM.STATE_SELECTED,isMultiple:i}},i.prototype._parseInteractionConfig=function(t){var e=this,i=this._spec.interactions,n=this._parseDefaultInteractionConfig(t);return i&&i.length&&i.forEach((function(t){var i=iV(t,e.getMarks());i.length&&n.push({trigger:t,marks:i})})),n},i.prototype.getInteractionTriggers=function(){if(!0!==this._option.disableTriggerEvent){var t=this.getMarksWithoutRoot();return this._parseInteractionConfig(t)}return[]},i.prototype.initAnimation=function(){},i.prototype.initMarkState=function(){this.initSeriesStyleState()},i.prototype.initSeriesStyleState=function(){var e,i=this,n=this._spec.seriesStyle;if(n&&n.length){var r=null!==(e=this._seriesField)&&void 0!==e?e:Az;this.getMarksWithoutRoot().forEach((function(e){var a={},o={},s={};n.forEach((function(t){var i,n=null===(i=t[e.name])||void 0===i?void 0:i.style;n&&(a[t.name]=!0,s[t.name]=s[t.name]||{},Object.keys(n).forEach((function(e){o[e]=!0,s[t.name][e]=n[e]})))})),e.state.addStateInfo({stateValue:Mz,level:-1,filter:function(t){return Array.isArray(t)?0!==t.length&&!0===a[t[0][r]]:!0===a[t[r]]}});var l={};Object.keys(o).forEach((function(t){l[t]=function(i){var n,a,o;if(Array.isArray(i)){if(0===i.length)return;o=null===(n=s[i[0][r]])||void 0===n?void 0:n[t]}return o=null===(a=s[i[r]])||void 0===a?void 0:a[t],U(o)?o:e.getAttribute(t,i)}})),i.setMarkStyle(e,l,Mz,t.AttributeLevel.User_SeriesStyle)}))}},i.prototype.afterInitMark=function(){var e=this;this.event.emit(t.ChartEvent.afterInitMark,{model:this}),this.setSeriesField(this._spec.seriesField),this.getMarks().forEach((function(i){var n,r;(null===(r=null===(n=i.stateStyle)||void 0===n?void 0:n.normal)||void 0===r?void 0:r.lineWidth)&&i.setAttribute("stroke",e.getColorAttribute(),"normal",t.AttributeLevel.Base_Series)}))},i.prototype.getMarksWithoutRoot=function(){return this.getMarks().filter((function(t){var e;return!(null===(e=t.name)||void 0===e?void 0:e.includes("seriesGroup"))}))},i.prototype.getMarksInType=function(t){return this._marks.getMarksInType(t)},i.prototype.getMarkInName=function(t){return this._marks.get(t)},i.prototype.getMarkInId=function(t){return this.getMarks().find((function(e){return e.id===t}))},i.prototype.initEvent=function(){var t,e,i;null===(e=null===(t=this._data)||void 0===t?void 0:t.getDataView())||void 0===e||e.target.addListener("change",this.viewDataUpdate.bind(this)),null===(i=this._viewDataStatistics)||void 0===i||i.target.addListener("change",this.viewDataStatisticsUpdate.bind(this))},i.prototype._releaseEvent=function(){e.prototype._releaseEvent.call(this)},i.prototype.initTooltip=function(){this._tooltipHelper=new EV(this)},i.prototype._compareExtensionMarksSpec=function(t,e,i){t.length!==e.length||e.some((function(e,i){return e.type!==t[i].type||e.id!==t[i].id||e.name!==t[i].name}))?i.reMake=!0:e.some((function(e,i){return e.visible!==t[i].visible}))&&(i.reCompile=!0)},i.prototype._compareLabelSpec=function(t,e,i){t.length!==e.length||e.some((function(e,i){return e.labelLayout!==t[i].labelLayout||e.visible!==t[i].visible}))?i.reMake=!0:!i.reCompile&&e.some((function(e,i){return!bt(e,t[i])}))&&(i.reCompile=!0)},i.prototype._compareSpec=function(t,i,n){var r=e.prototype._compareSpec.call(this,t,i),a=Object.keys(i||{}).sort();if(!bt(a,Object.keys(t||{}).sort()))return r.reMake=!0,r;var o=T(T(T(T({},YV),XV),n),{extensionMark:!0,label:!0,totalLabel:!0});return this._compareExtensionMarksSpec(St(t.extensionMark),St(i.extensionMark),r),!r.reMake&&this._compareLabelSpec(St(t.label),St(i.label),r),!r.reMake&&this._compareLabelSpec(St(t.totalLabel),St(i.totalLabel),r),r.reMake?r:(!r.reCompile&&this._marks.getMarks().some((function(e){var n,r;return o[e.name]=!0,(null===(n=i[e.name])||void 0===n?void 0:n.visible)!==(null===(r=t[e.name])||void 0===r?void 0:r.visible)}))&&(r.reCompile=!0),!r.reCompile&&a.some((function(e){return XV[e]&&!bt(t[e],i[e])}))&&(r.reCompile=!0),a.some((function(e){return!o[e]&&!bt(t[e],i[e])}))?(r.reMake=!0,r):r)},i.prototype._updateSpecData=function(){!this._rawData||!this._spec.data||this._spec.data instanceof hs||FH(this._rawData,this._spec.data,!0)},i.prototype.reInit=function(t){var i=this;e.prototype.reInit.call(this,t);var n=this.getMarksWithoutRoot();n.forEach((function(t){i._spec[t.name]&&i.initMarkStyleWithSpec(t,i._spec[t.name])})),this.initMarkStyle(),n.forEach((function(t){t.commit(!1)})),this._updateExtensionMarkSpec(),this._updateSpecData(),this._tooltipHelper&&this._tooltipHelper.updateTooltipSpec(),ij(this)&&this.initAnimation()},i.prototype.onEvaluateEnd=function(t){this._data.updateData()},i.prototype.release=function(){var t,i;e.prototype.release.call(this),this._viewDataMap.clear();var n=null===(i=null===(t=this._rawData)||void 0===t?void 0:t.transformsArr)||void 0===i?void 0:i.findIndex((function(t){return"addVChartProperty"===t.type}));n>=0&&this._rawData.transformsArr.splice(n,1),this._dataSet=this._data=this._rawData=this._rawDataStatistics=this._spec=this._region=this._viewDataStatistics=this._viewStackData=null},i.prototype.setLayoutStartPosition=function(t){et(t.x)&&(this._layoutStartPoint.x=t.x),et(t.y)&&(this._layoutStartPoint.y=t.y)},i.prototype.setLayoutRect=function(t,e){var i=t.width,n=t.height;et(i)&&(this._layoutRect.width=i),et(n)&&(this._layoutRect.height=n)},i.prototype.getSeriesKeys=function(){var t,e;return this._seriesField?null!==(e=null===(t=this.getRawDataStatisticsByField(this._seriesField))||void 0===t?void 0:t.values)&&void 0!==e?e:[]:this.name?[this.name]:this.userId?["".concat(this.userId)]:["".concat(this.type,"_").concat(this.id)]},i.prototype.getSeriesStyle=function(t){var e=this;return function(i){var n,r;return null!==(r=null===(n=e._seriesMark)||void 0===n?void 0:n.getAttribute(i,t))&&void 0!==r?r:void 0}},i.prototype._getSeriesInfo=function(t,e){var i=this,n=this.getDefaultShapeType();return e.map((function(e){var r;return{key:e,originalKey:e,style:i.getSeriesStyle((r={},r[t]=e,r)),shapeType:n}}))},i.prototype.getSeriesInfoInField=function(t){var e,i;return this._getSeriesInfo(t,null!==(i=null===(e=this.getRawDataStatisticsByField(t))||void 0===e?void 0:e.values)&&void 0!==i?i:[])},i.prototype.getSeriesInfoList=function(){var t;return this._getSeriesInfo(null!==(t=this._seriesField)&&void 0!==t?t:Az,this.getSeriesKeys())},i.prototype._getDefaultColorScale=function(){var t,e,i=this.getDefaultColorDomain(),n=this._getDataScheme();return null===(e=(t=(new xF).domain(i)).range)||void 0===e?void 0:e.call(t,n)},i.prototype._getDataScheme=function(){return pF(this.getColorScheme(),this.type)},i.prototype.getDefaultColorDomain=function(){var t,e;return this._seriesField?null===(e=null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._seriesField])||void 0===e?void 0:e.values:[]},i.prototype.getColorAttribute=function(){var t,e;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:null!==(e=this._seriesField)&&void 0!==e?e:Az}},i.prototype.getDimensionField=function(){return[]},i.prototype.getMeasureField=function(){return[]},i.prototype.onMarkPositionUpdate=function(){this.onMarkTreePositionUpdate(this.getMarksWithoutRoot())},i.prototype.onMarkTreePositionUpdate=function(t){},i.prototype._createMark=function(t,i,n){var r,a,o,s,l;void 0===i&&(i={}),void 0===n&&(n={});var u=i.key,c=i.groupKey,h=i.skipBeforeLayouted,d=i.themeSpec,p=void 0===d?{}:d,f=i.markSpec,v=i.dataView,g=i.parent,y=i.isSeriesMark,m=i.noSeparateStyle,_=void 0!==m&&m,b=e.prototype._createMark.call(this,t,{key:null!=u?u:this._getDataIdKey(),seriesId:this.id,attributeContext:this._markAttributeContext,componentType:i.componentType,noSeparateStyle:_,parent:!1!==g?null!=g?g:this._rootMark:null});if(U(b)){var x=this.getSpec()||{};this._marks.addMark(b,{name:t.name}),y&&(this._seriesMark=b),j(v)?b.setData(this._data):!1!==v&&b.setDataView(v),b.setSkipBeforeLayouted(!1!==h),j(c)||b.setGroupKey(c);var k=T(T({},n),{progressiveStep:x.progressiveStep,progressiveThreshold:x.progressiveThreshold,large:x.large,largeThreshold:x.largeThreshold,morph:null!==(r=n.morph)&&void 0!==r&&r,useSequentialAnimation:x.useSequentialAnimation,support3d:null!==(a=n.support3d)&&void 0!==a?a:x.support3d||!!x.zField,morphKey:(null===(o=x.morph)||void 0===o?void 0:o.morphKey)||"".concat(this.getSpecIndex(),"_").concat(this.getMarks().length),morphElementKey:null!==(l=null===(s=x.morph)||void 0===s?void 0:s.morphElementKey)&&void 0!==l?l:n.morphElementKey});b.setMarkConfig(k),this.initMarkStyleWithSpec(b,XF({},p,f||x[b.name]))}return b},i.prototype._getDataIdKey=function(){var t;return null!==(t=e.prototype._getDataIdKey.call(this))&&void 0!==t?t:Sz},i.prototype._getSeriesDataKey=function(t){var e="";if(!t)return e;var i=this.getDimensionField();e=i.map((function(e){return t[e]})).join("_");var n=this.getSeriesField();return n&&!i.includes(n)&&(e+="_".concat(t[n])),e},i.prototype.addViewDataFilter=function(t){var e,i;null===(i=null!==(e=this._viewDataFilter)&&void 0!==e?e:this.getViewData())||void 0===i||i.transform(t,!1)},i.prototype.reFilterViewData=function(){var t,e;null===(e=null!==(t=this._viewDataFilter)&&void 0!==t?t:this.getViewData())||void 0===e||e.reRunAllTransform()},i.prototype.reTransformViewData=function(){var t,e;null===(e=null===(t=this._data)||void 0===t?void 0:t.getDataView())||void 0===e||e.reRunAllTransform()},i.prototype.fillData=function(){var t;null===(t=this.getRawData())||void 0===t||t.reRunAllTransform()},i.prototype.compile=function(){this.compileData()},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getFieldAlias=function(t){var e;return t!==Cz&&t!==Pz&&t!==wz&&t!==Ez||(t=this.getStackValueField()),null!==(e=Yz(this.getRawData(),t))&&void 0!==e?e:t},i.prototype._getInvalidConnectType=function(){return"zero"===this._invalidType?"zero":"link"===this._invalidType?"connect":"none"},i.prototype._getInvalidDefined=function(t){var e=this.getInvalidCheckFields();return!e.length||e.every((function(e){return bx(t[e])}))},i.prototype._getRelatedComponentSpecInfo=function(t){var e,i=this.getSpecIndex(),n=null===(e=this._option.getSpecInfo().component[t])||void 0===e?void 0:e.filter((function(t){return t.seriesIndexes.includes(i)}));return null!=n?n:[]},i.prototype._forEachStackGroup=function(t,e){var i,n,r=this;(e=null!=e?e:null===(i=this._viewStackData)||void 0===i?void 0:i.latestData)&&((null===(n=e.values)||void 0===n?void 0:n.length)?t(e):e.nodes&&Object.values(e.nodes).forEach((function(e){r._forEachStackGroup(t,e)})))},i.prototype.isDatumInViewData=function(t){if(!t)return!1;var e=this.getViewData().latestData;return!!e&&(!!e.includes(t)||e.some((function(e){return Object.keys(t).every((function(i){return t[i]===e[i]}))})))},i.prototype.getSeriesFieldValue=function(t,e){var i;return t[null!==(i=null!=e?e:this.getSeriesField())&&void 0!==i?i:Az]},i.mark=VV,i.transformerConstructor=nj,i}(nN);function aj(e){return[t.SeriesTypeEnum.rose,t.SeriesTypeEnum.radar,t.SeriesTypeEnum.circularProgress].includes(e)}function oj(t,e,i){var n=t.getScale(0),r="isInverse"in t&&t.isInverse();JR(n.type)?i.sort((function(t,i){return(t[e]-i[e])*(r?-1:1)})):i.sort((function(t,i){return(n.index(t[e])-n.index(i[e]))*(r?-1:1)}))}function sj(t){return{dataIndex:function(e){var i,n,r="horizontal"===t.direction?t.fieldY[0]:t.fieldX[0],a=null==e?void 0:e[r],o="horizontal"===t.direction?t.scaleY:t.scaleX;return(null!==(n=null===(i=null==o?void 0:o.domain)||void 0===i?void 0:i.call(o))&&void 0!==n?n:[]).indexOf(a)||0},dataCount:function(){var e,i,n,r="horizontal"===t.direction?t.scaleY:t.scaleX;return null!==(n=(null!==(i=null===(e=null==r?void 0:r.domain)||void 0===e?void 0:e.call(r))&&void 0!==i?i:[]).length)&&void 0!==n?n:0}}}var lj=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.coordinate="cartesian",t._bandPosition=.5,t._scaleConfig={bandPosition:t._bandPosition},t._direction="vertical",t._sortDataByAxis=!1,t._getPositionXEncoder=function(){var e;return null===(e=t._positionXEncoder)||void 0===e?void 0:e.bind(t)},t._setPositionXEncoder=function(e){t._positionXEncoder=e.bind(t)},t._getPositionYEncoder=function(){var e;return null===(e=t._positionYEncoder)||void 0===e?void 0:e.bind(t)},t._setPositionYEncoder=function(e){t._positionYEncoder=e.bind(t)},t}return M(i,e),i.prototype._buildScaleConfig=function(){this._scaleConfig={bandPosition:this._bandPosition}},Object.defineProperty(i.prototype,"fieldX",{get:function(){return this._fieldX},enumerable:!1,configurable:!0}),i.prototype.setFieldX=function(t){this._fieldX=St(t)},Object.defineProperty(i.prototype,"fieldY",{get:function(){return this._fieldY},enumerable:!1,configurable:!0}),i.prototype.setFieldY=function(t){this._fieldY=St(t)},Object.defineProperty(i.prototype,"fieldZ",{get:function(){return this._fieldZ},enumerable:!1,configurable:!0}),i.prototype.setFieldZ=function(t){this._fieldZ=t&&St(t)},Object.defineProperty(i.prototype,"fieldX2",{get:function(){return this._fieldX2},enumerable:!1,configurable:!0}),i.prototype.setFieldX2=function(t){this._fieldX2=t},Object.defineProperty(i.prototype,"fieldY2",{get:function(){return this._fieldY2},enumerable:!1,configurable:!0}),i.prototype.setFieldY2=function(t){this._fieldY2=t},Object.defineProperty(i.prototype,"direction",{get:function(){return this._direction},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"scaleX",{get:function(){return this._scaleX},enumerable:!1,configurable:!0}),i.prototype.setScaleX=function(t){this._scaleX=t},Object.defineProperty(i.prototype,"scaleY",{get:function(){return this._scaleY},enumerable:!1,configurable:!0}),i.prototype.setScaleY=function(t){this._scaleY=t},Object.defineProperty(i.prototype,"scaleZ",{get:function(){return this._scaleZ},enumerable:!1,configurable:!0}),i.prototype.setScaleZ=function(t){this._scaleZ=t},i.prototype.getXAxisHelper=function(){return this._xAxisHelper},i.prototype.setXAxisHelper=function(t){this._xAxisHelper=t,this.onXAxisHelperUpdate()},i.prototype.getYAxisHelper=function(){return this._yAxisHelper},i.prototype.setYAxisHelper=function(t){this._yAxisHelper=t,this.onYAxisHelperUpdate()},i.prototype.getZAxisHelper=function(){return this._zAxisHelper},i.prototype.setZAxisHelper=function(t){this._zAxisHelper=t,this.onYAxisHelperUpdate()},Object.defineProperty(i.prototype,"sortDataByAxis",{get:function(){return this._sortDataByAxis},enumerable:!1,configurable:!0}),i.prototype.getStatisticFields=function(){var t=[];return[{axisHelper:this.getXAxisHelper(),fields:this._fieldX2?R(R([],B(this._fieldX),!1),[this._fieldX2],!1):this._fieldX},{axisHelper:this.getYAxisHelper(),fields:this._fieldY2?R(R([],B(this._fieldY),!1),[this._fieldY2],!1):this._fieldY},{axisHelper:this.getZAxisHelper(),fields:this._fieldZ}].forEach((function(e){e.axisHelper&&e.axisHelper.getScale&&e.fields&&e.fields.forEach((function(i){var n={key:i,operations:[]},r=e.axisHelper.getScale(0);JR(r.type)?(n.operations=["max","min"],"log"===r.type&&(n.filter=function(t){return t>0})):n.operations=["values"],t.push(n)}))})),this.getStack()&&t.push({key:this.getStackValueField(),operations:["allValid"]}),t},i.prototype.getGroupFields=function(){return"vertical"===this.direction?this._fieldX:this._fieldY},i.prototype.getStackGroupFields=function(){return this.getGroupFields()},i.prototype.getStackValue=function(){var t,e,i=null===(t="horizontal"===this.direction?this.getXAxisHelper():this.getYAxisHelper())||void 0===t?void 0:t.getAxisId();return null!==(e=this._spec.stackValue)&&void 0!==e?e:"".concat(mz,"_series_").concat(this.type,"_").concat(i)},i.prototype.getStackValueField=function(){return"horizontal"===this.direction?St(this._spec.xField)[0]:St(this._spec.yField)[0]},i.prototype.setValueFieldToStack=function(){"horizontal"===this.direction?(this.setFieldX(Cz),this.setFieldX2(wz)):(this.setFieldY(Cz),this.setFieldY2(wz))},i.prototype.setValueFieldToPercent=function(){"horizontal"===this.direction?(this.setFieldX(Pz),this.setFieldX2(Ez)):(this.setFieldY(Pz),this.setFieldY2(Ez))},i.prototype.setValueFieldToStackOffsetSilhouette=function(){"horizontal"===this.direction?(this.setFieldX(Rz),this.setFieldX2(Bz)):(this.setFieldY(Rz),this.setFieldY2(Bz))},i.prototype.onXAxisHelperUpdate=function(){this.onMarkPositionUpdate()},i.prototype.onYAxisHelperUpdate=function(){this.onMarkPositionUpdate()},i.prototype.onZAxisHelperUpdate=function(){this.onMarkPositionUpdate()},i.prototype.setAttrFromSpec=function(){var t,i;e.prototype.setAttrFromSpec.call(this),this.setFieldX(this._spec.xField),this.setFieldY(this._spec.yField),this.setFieldZ(this._spec.zField),this._specXField=St(this._spec.xField),this._specYField=St(this._spec.yField),U(this._spec.direction)&&(this._direction=this._spec.direction),this.setFieldX2(null===(t=this._spec)||void 0===t?void 0:t.x2Field),this.setFieldY2(null===(i=this._spec)||void 0===i?void 0:i.y2Field),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent(),this.getStackOffsetSilhouette()&&this.setValueFieldToStackOffsetSilhouette(),U(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)},i.prototype.dataToPosition=function(t,e){return t?e&&!this.isDatumInViewData(t)?null:{x:this.dataToPositionX(t),y:this.dataToPositionY(t)}:null},i.prototype._buildMarkAttributeContext=function(){var t=this;e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.valueToX=this.valueToPositionX.bind(this),this._markAttributeContext.valueToY=this.valueToPositionY.bind(this),this._markAttributeContext.xBandwidth=function(e){var i,n,r;return void 0===e&&(e=0),null!==(r=null===(n=(i=t.getXAxisHelper()).getBandwidth)||void 0===n?void 0:n.call(i,e))&&void 0!==r?r:0},this._markAttributeContext.yBandwidth=function(e){var i,n,r;return void 0===e&&(e=0),null!==(r=null===(n=(i=t.getYAxisHelper()).getBandwidth)||void 0===n?void 0:n.call(i,e))&&void 0!==r?r:0},this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this)},i.prototype.valueToPosition=function(t,e){return{x:this.valueToPositionX(t),y:this.valueToPositionY(e)}},i.prototype._axisPosition=function(t,e,i){return this._scaleConfig.datum=i,t.isContinuous?t.valueToPosition(e,this._scaleConfig):t.dataToPosition(St(e),this._scaleConfig)},i.prototype.valueToPositionX=function(t,e){return this._axisPosition(this._xAxisHelper,t,e)},i.prototype.valueToPositionY=function(t,e){return this._axisPosition(this._yAxisHelper,t,e)},i.prototype._dataToPosition=function(t,e,i,n,r,a){var o=this,s=r();if(s)return s(t);if(!e)return a((function(t){return Number.NaN})),Number.NaN;var l=(e.getFields?e.getFields():i).slice(0,n);return l&&0!==l.length?(e.isContinuous?a((function(t){return o._scaleConfig.datum=t,e.valueToPosition(o.getDatumPositionValue(t,l[0]),o._scaleConfig)})):a((function(t){return o._scaleConfig.datum=t,e.dataToPosition(St(o.getDatumPositionValues(t,l)),o._scaleConfig)})),r()(t)):(a((function(t){return null})),null)},i.prototype.dataToPositionX=function(t){return this._dataToPosition(t,this._xAxisHelper,this.fieldX,void 0,this._getPositionXEncoder,this._setPositionXEncoder)},i.prototype.dataToPositionY=function(t){return this._dataToPosition(t,this._yAxisHelper,this.fieldY,void 0,this._getPositionYEncoder,this._setPositionYEncoder)},i.prototype.dataToPositionZ=function(t){return this._zAxisHelper?(0,this._zAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._fieldZ),{bandPosition:this._bandPosition}):Number.NaN},i.prototype.dataToPositionX1=function(t){return this._xAxisHelper?this._fieldX2&&this._fieldX2 in t?this.valueToPositionX(this.getDatumPositionValues(t,this._fieldX2)):this.valueToPositionX(0):Number.NaN},i.prototype.dataToPositionY1=function(t){return this._yAxisHelper?this._fieldY2&&this._fieldY2 in t?this.valueToPositionY(this.getDatumPositionValues(t,this._fieldY2)):this.valueToPositionY(0):Number.NaN},i.prototype.positionToData=function(t){return t?{x:this.positionToDataX(t.x),y:this.positionToDataY(t.y)}:null},i.prototype.positionToDataX=function(t){return this._scaleX?this._scaleX.invert(t):null},i.prototype.positionToDataY=function(t){return this._scaleY?this._scaleY.invert(t):null},i.prototype.getRegionRectLeft=function(){return this._xAxisHelper?(0,this._xAxisHelper.getScale)(0).range()[0]:Number.NaN},i.prototype.getRegionRectRight=function(){return this._xAxisHelper?(0,this._xAxisHelper.getScale)(0).range()[1]:Number.NaN},i.prototype.afterInitMark=function(){e.prototype.afterInitMark.call(this),this.setFieldX(this._fieldX),this.setFieldY(this._fieldY),this._buildScaleConfig()},i.prototype.getDimensionField=function(){return"horizontal"===this._direction?this._specYField:this._specXField},i.prototype.getDimensionContinuousField=function(){return"horizontal"===this._direction?[this.fieldY[0],this.fieldY2]:[this.fieldX[0],this.fieldX2]},i.prototype.getMeasureField=function(){return"horizontal"===this._direction?this._specXField:this._specYField},i.prototype.initEvent=function(){var i=this;e.prototype.initEvent.call(this),this.sortDataByAxis&&this.event.on(t.ChartEvent.scaleDomainUpdate,{filter:function(t){var e;return t.model.id===(null===(e="horizontal"===i._direction?i._yAxisHelper:i._xAxisHelper)||void 0===e?void 0:e.getAxisId())}},(function(){i._sortDataInAxisDomain()}))},i.prototype._sortDataInAxisDomain=function(){var t,e,i;(null===(e=null===(t=this.getViewData())||void 0===t?void 0:t.latestData)||void 0===e?void 0:e.length)&&(oj("horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper,"horizontal"===this._direction?this._fieldY[0]:this._fieldX[0],this.getViewData().latestData),null===(i=this._data)||void 0===i||i.updateData(!0))},i.prototype.getInvalidCheckFields=function(){var t=[];this._xAxisHelper&&this._xAxisHelper.isContinuous&&this._xAxisHelper.getAxisType()!==I.geoCoordinate&&(this._xAxisHelper.getFields?this._xAxisHelper.getFields():this._specXField).forEach((function(e){t.push(e)}));this._yAxisHelper&&this._yAxisHelper.isContinuous&&this._yAxisHelper.getAxisType()!==I.geoCoordinate&&(this._yAxisHelper.getFields?this._yAxisHelper.getFields():this._specYField).forEach((function(e){t.push(e)}));return t},i.prototype.reInit=function(t){this._positionXEncoder&&(this._positionXEncoder=null),this._positionYEncoder&&(this._positionYEncoder=null),e.prototype.reInit.call(this,t)},i}(rj);function uj(t){return"bottom"===t||"top"===t}function cj(t){return"left"===t||"right"===t}function hj(t){return"z"===t}function dj(t,e){return CF(t.orient)||e&&e.includes(t.orient)?t.orient:"left"}function pj(t){return"top"===t||"bottom"===t?"horizontal":"vertical"}function fj(t,e){var i,n=null!==(i=t.type)&&void 0!==i?i:function(t,e){return e?uj(t)?"linear":"band":uj(t)?"band":"linear"}(t.orient,e);return{axisType:n,componentName:"".concat(I.cartesianAxis,"-").concat(n)}}var vj,gj,yj=function(t,e,i){var n,r=null!==(n="band"===e?yV("axisBand",i):["linear","log","symlog"].includes(e)?yV("axisLinear",i):{})&&void 0!==n?n:{},a=uj(t)?yV("axisX",i):cj(t)?yV("axisY",i):yV("axisZ",i);return XF({},yV("axis",i),r,a)},mj=function(){function t(t,e){this._eventDispatcher=t,this._mode=e}return Object.defineProperty(t.prototype,"chart",{get:function(){var t,e;return this._chart||(this._chart=null===(e=(t=this._eventDispatcher.globalInstance).getChart)||void 0===e?void 0:e.call(t)),this._chart},enumerable:!1,configurable:!0}),t.prototype.register=function(t,e){var i,n;(null!==(n=null===(i=this.chart)||void 0===i?void 0:i.getOption().onError)&&void 0!==n?n:hx)("Method not implemented.")},t.prototype.unregister=function(){var t,e;(null!==(e=null===(t=this.chart)||void 0===t?void 0:t.getOption().onError)&&void 0!==e?e:hx)("Method not implemented.")},t.prototype.getTargetDimensionInfo=function(t,e){var i,n,r,a=null!==(r=null===(n=(i=this.chart.getModelOption()).getDimensionInfo)||void 0===n?void 0:n.call(i,this.chart,{x:t,y:e}))&&void 0!==r?r:[];return 0===a.length?null:a},t.prototype.dispatch=function(t,e){var i,n,r=null===(i=this.chart)||void 0===i?void 0:i.getAllComponents().filter((function(t){return"axes"===t.specKey&&(!(null==e?void 0:e.filter)||e.filter(t))})),a=r.filter((function(t){return $R(t.getScale().type)})),o=a.length?a:r.filter((function(t){var e=t.getOrient();return uj(e)||"angle"===e})),s=[],l=null===(n=this.chart)||void 0===n?void 0:n.getModelOption().getDimensionInfoByValue;return l&&o.forEach((function(e){var i=l(e,t);i&&s.push(i)})),this._callback.call(null,{action:"enter",dimensionInfo:s}),s},t}(),_j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(t){if(t){var i=t.event.viewX,n=t.event.viewY,r=e.getTargetDimensionInfo(i,n);r&&e._callback.call(null,T(T({},t),{action:"click",dimensionInfo:r.slice()}))}},e}return M(e,t),e.prototype.register=function(t,e){this._callback=e.callback,this._eventDispatcher.register("pointertap",{query:T(T({},e.query),{source:vH.chart}),callback:this.onClick})},e.prototype.unregister=function(){this._eventDispatcher.unregister("pointertap",{query:null,callback:this.onClick})},e}(mj),bj=function(t,e){var i,n;return t===e||!j(t)&&!j(e)&&(t.value===e.value&&(null===(i=t.axis)||void 0===i?void 0:i.id)===(null===(n=e.axis)||void 0===n?void 0:n.id))},xj=function(t,e,i,n){var r,a,o,s=e.getScale(),l=$R(s.type),u=[],c=e.getOption().getChart().getSeriesInIndex(e.getSpecInfo().seriesIndexes),h=function(r){if(r.coordinate===i){var a=St(n(r)),c=null===(o=r.getViewData())||void 0===o?void 0:o.latestData;if(a&&c)if(l){var h=[],d=[];c.forEach((function(e,i){var n;(null===(n=e[a[0]])||void 0===n?void 0:n.toString())===(null==t?void 0:t.toString())&&(h.push(e),d.push(i))})),u.push({series:r,datum:h,key:kj(r,d)})}else if(U(a[1])){var p=[],f=[];c.forEach((function(e,i){var n;((null===(n=e[a[0]])||void 0===n?void 0:n.toString())===(null==t?void 0:t.toString())||U(e[a[0]])&&U(e[a[1]])&&t>=e[a[0]]&&t<e[a[1]])&&(p.push(e),f.push(i))})),u.push({series:r,datum:p,key:kj(r,f)})}else{var v=function(t,e){var i=t.tooltipFilterRange,n="function"==typeof i?i({scale:e}):i;return et(n)?[-n,n]:n}(e.getSpec(),s),g=[],y=[];if(v)c.forEach((function(e,i){if(U(e[a[0]])){var n=e[a[0]]-t;n>=v[0]&&n<=v[1]&&(g.push(e),y.push(i))}}));else{var m=1/0,_=0;c.forEach((function(e,i){if(U(e[a[0]])){var n=Math.abs(e[a[0]]-t),r=Math.sign(e[a[0]]-t);n<m?(m=n,g=[e],y=[i],_=r):n===m&&r===_&&(g.push(e),y.push(i))}}))}u.push({series:r,datum:g,key:kj(r,y)})}}};try{for(var d=P(c),p=d.next();!p.done;p=d.next()){h(p.value)}}catch(t){r={error:t}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(r)throw r.error}}return u},kj=function(t,e){return"".concat(t.id,"_").concat(e.join("_"))},Sj=function(t,e,i){var n=t.getAllComponents().filter((function(n){return"axes"===n.specKey&&e(n)&&function(t,e,i){var n=t.getRegionsInIds(St(e.layout.layoutBindRegionID));return null==n?void 0:n.some((function(t){var e=t.getLayoutRect(),n=t.getLayoutStartPoint();return function(t,e,i){return t.x>=e.x&&t.x<=i.x&&t.y>=e.y&&t.y<=i.y}(i,{x:n.x,y:n.y},{x:e.width+n.x,y:e.height+n.y})}))}(t,n,i)}));return n.length?n:null},Aj=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._cacheDimensionInfo=null,e.onMouseMove=function(t){if(t){var i=t.event.viewX,n=t.event.viewY,r=e.getTargetDimensionInfo(i,n);null===r&&null!==e._cacheDimensionInfo?(e._callback.call(null,T(T({},t),{action:"leave",dimensionInfo:e._cacheDimensionInfo.slice()})),e._cacheDimensionInfo=r):null===r||null!==e._cacheDimensionInfo&&r.length===e._cacheDimensionInfo.length&&!r.some((function(t,i){return!bj(t,e._cacheDimensionInfo[i])}))?null!==r&&e._callback.call(null,T(T({},t),{action:"move",dimensionInfo:r.slice()})):(e._callback.call(null,T(T({},t),{action:"enter",dimensionInfo:r.slice()})),e._cacheDimensionInfo=r)}},e.onMouseOut=function(t){t&&(e._callback.call(null,T(T({},t),{action:"leave",dimensionInfo:e._cacheDimensionInfo?e._cacheDimensionInfo.slice():[]})),e._cacheDimensionInfo=null)},e}return M(e,t),e.prototype.register=function(t,e){this._callback=e.callback,this._eventDispatcher.register("pointermove",{query:T(T({},e.query),{source:vH.chart}),callback:this.onMouseMove}),this._eventDispatcher.register("pointerout",{query:T(T({},e.query),{source:vH.canvas}),callback:this.onMouseOut}),gx(this._mode)&&this._eventDispatcher.register("pointerdown",{query:T(T({},e.query),{source:vH.chart}),callback:this.onMouseMove})},e.prototype.unregister=function(){this._eventDispatcher.unregister("pointermove",{query:null,callback:this.onMouseMove}),gx(this._mode)&&this._eventDispatcher.unregister("pointerdown",{query:null,callback:this.onMouseMove})},e}(mj);t.DimensionEventEnum=void 0,(vj=t.DimensionEventEnum||(t.DimensionEventEnum={})).dimensionHover="dimensionHover",vj.dimensionClick="dimensionClick";var Mj=((gj={}).point={name:"point",type:"symbol"},gj.line={name:"line",type:"line"},gj),Tj=function(){function e(){}return e.prototype.addSamplingCompile=function(){if(this._spec.sampling){var t=this._region.getLayoutRect(),e=t.width,i=t.height,n=this._fieldY,r=this._fieldX;this._data&&this._data.setTransform([{type:"dataSampling",size:"horizontal"===this._direction?i:e,factor:this._spec.samplingFactor,yfield:"horizontal"===this._direction?r[0]:n[0],groupBy:this._seriesField,mode:this._spec.sampling}])}},e.prototype.addOverlapCompile=function(){var t;if(this._spec.markOverlap){var e=[];e.push({type:"symbolOverlap",direction:"horizontal"===this._direction&&"cartesian"===this.coordinate?2:1,delta:this._spec.pointDis,deltaMul:this._spec.pointDisMul,groupBy:this._seriesField}),null===(t=this._symbolMark)||void 0===t||t.setTransform(e)}},e.prototype.reCompileSampling=function(){this._spec.sampling&&this.compile()},e.prototype.initLineMark=function(t){return this._lineMark=this._createMark(Mj.line,{groupKey:this._seriesField,isSeriesMark:null==t||t},{morphElementKey:this.getDimensionField()[0]}),this._lineMark},e.prototype.initLineMarkStyle=function(e,i){var n,r,a=this,o=this._lineMark;if(o){if(this.setMarkStyle(o,{stroke:this.getColorAttribute()},"normal",t.AttributeLevel.Series),"zero"!==this._invalidType&&this.setMarkStyle(o,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",t.AttributeLevel.Series),this.event.on(t.ChartEvent.viewDataStatisticsUpdate,{filter:function(t){return t.model===a}},(function(){a.encodeDefined(o,"defined")})),"polar"===this.coordinate)this.setMarkStyle(o,{lineJoin:gV,curveType:vV,closePath:!0},"normal",t.AttributeLevel.Series);else{var s=null!=i?i:null===(r=null===(n=this.getSpec().line)||void 0===n?void 0:n.style)||void 0===r?void 0:r.curveType,l=s===fV?"horizontal"===e?"monotoneY":"monotoneX":s;this.setMarkStyle(o,{curveType:l},"normal",t.AttributeLevel.Built_In)}this.setMarkStyle(o,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",t.AttributeLevel.Series)}return o},e.prototype._getEventElement=function(t,e){var i=this,n=[];return t.dimensionInfo.some((function(t){return t.data.some((function(t){return t.series===i&&(n=t.datum,!0)})),!n.length})),n},e.prototype._dimensionTrigger=function(t){var e=this._getEventElement(t);switch(t.action){case"enter":this._symbolActiveMark.getDataView().parse(e),this._symbolActiveMark.getData().updateData(!1);break;case"leave":this._symbolActiveMark.getDataView().parse([]),this._symbolActiveMark.getData().updateData(!1)}},e.prototype.initSymbolMark=function(t){if(!1!==(this._spec.point||{}).visible&&(this._symbolMark=this._createMark(Mj.point,{groupKey:this._seriesField,isSeriesMark:!!t},{morph:$V(this._spec,Mj.point.name),morphElementKey:this.getDimensionField()[0]})),!0===this._spec.activePoint){var e=new hs(this._option.dataSet,{name:"".concat(mz,"_series_").concat(this.id,"_active_point")});e.parse([]),this._symbolActiveMark=this._createMark({name:"active_point_".concat(this.id),type:"symbol"},{groupKey:this._seriesField,isSeriesMark:!1,dataView:e,parent:this._region.getInteractionMark()},{morph:!1}),this._symbolActiveMark.setVisible(!1)}return this._symbolMark},e.prototype.initSymbolMarkStyle=function(){var e=this._symbolMark;if(!e)return this._initSymbolActiveMarkAlone(),e;if(this._initSymbolMark(e),this._symbolActiveMark&&this._symbolMark.stateStyle.dimension_hover){for(var i in this._symbolActiveMark.setVisible(!0),this.event.on(t.DimensionEventEnum.dimensionHover,this._dimensionTrigger.bind(this)),this._symbolMark.stateStyle)for(var n in this._symbolActiveMark.stateStyle[i]={},this._symbolMark.stateStyle[i])"visible"!==n&&(this._symbolActiveMark.stateStyle[i][n]={style:null,level:t.AttributeLevel.Series,referer:e});this._symbolActiveMark.state.changeStateInfo({stateValue:t.STATE_VALUE_ENUM.STATE_DIMENSION_HOVER,filter:function(){return!0}})}return e},e.prototype._initSymbolMark=function(e){var i=this;e&&(this.setMarkStyle(e,{fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series),this.setMarkStyle(e,{x:function(t){return"zero"===i._invalidType||i._getInvalidDefined(t)?i.dataToPositionX(t):Number.NaN},y:function(t){return"zero"===i._invalidType||i._getInvalidDefined(t)?i.dataToPositionY(t):Number.NaN},z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",t.AttributeLevel.Series))},e.prototype._initSymbolActiveMarkAlone=function(){var e,i,n=this._symbolActiveMark;n&&(this._initSymbolMark(n),n&&(null===(i=null===(e=this._spec[Mj.point.name])||void 0===e?void 0:e.state)||void 0===i?void 0:i.dimension_hover)&&(n.setVisible(!0),this.event.on(t.DimensionEventEnum.dimensionHover,this._dimensionTrigger.bind(this)),this.initMarkStyleWithSpec(n,XF({},this._spec[Mj.point.name],{visible:!0})),this._symbolActiveMark.state.changeStateInfo({stateValue:t.STATE_VALUE_ENUM.STATE_DIMENSION_HOVER,filter:function(){return!0}})))},e.prototype.initLabelMarkStyle=function(e){var i,n=this;e&&("symbol"!==(null===(i=e.getTarget())||void 0===i?void 0:i.type)&&e.setRule("line-data"),this.setMarkStyle(e,{fill:this.getColorAttribute(),text:function(t){return t[n.getStackValueField()]},z:this._fieldZ?this.dataToPositionZ.bind(this):null}),"zero"!==this._invalidType&&this.setMarkStyle(e,{visible:this._getInvalidDefined.bind(this)},"normal",t.AttributeLevel.Series),this.event.on(t.ChartEvent.viewDataStatisticsUpdate,{filter:function(t){return t.model===n}},(function(){n.encodeDefined(e,"visible")})))},e.prototype.initLineLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:function(t){var i;return null!==(i=t[e.getSeriesField()])&&void 0!==i?i:e.getSeriesKeys()[0]},z:this._fieldZ?this.dataToPositionZ.bind(this):null})},e.prototype.encodeDefined=function(e,i){var n,r,a,o,s,l;if(e){var u=this._isFieldAllValid();if("zero"===this._invalidType||u){if(!0===(null===(o=null===(a=e.stateStyle.normal)||void 0===a?void 0:a[i])||void 0===o?void 0:o.style))return;this.setMarkStyle(e,((n={})[i]=!0,n),"normal",t.AttributeLevel.Series)}else{if(!0!==(null===(l=null===(s=e.stateStyle.normal)||void 0===s?void 0:s[i])||void 0===l?void 0:l.style))return;this.setMarkStyle(e,((r={})[i]=this._getInvalidDefined.bind(this),r),"normal",t.AttributeLevel.Series)}e.compileEncode()}},e.prototype._isFieldAllValid=function(){var t=this.getViewDataStatistics(),e=this.getStackValueField();return!!(t&&t.latestData&&e)&&(t.latestData[e]&&t.latestData[e].allValid)},e}(),wj=T(T({},VV),Mj),Cj=function(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(K(t))return!1;if(q(t))return t.length===e.length&&t.every((function(t,i){return Cj(t,e[i])}));if(t.gradient!==e.gradient)return!1;var i=Object.keys(t),n=Object.keys(e);return i.length===n.length&&i.every((function(i){return"stops"===i?function(t,e){var i,n;if(t===e)return!0;var r=null!==(i=t&&t.length)&&void 0!==i?i:0;return r===(null!==(n=e&&e.length)&&void 0!==n?n:0)&&0!==r&&t.every((function(t,i){return!t&&!e[i]||t&&e[i]&&t.color===e[i].color&&t.offset===e[i].offset}))}(t[i],e[i]):t[i]===e[i]}))},Ej=["stroke","strokeOpacity","lineDash","lineDashOffset","lineCap","lineJoin","lineWidth","miterLimit"],Pj=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._segmentStyleKeys=[],e._isValidPointChannel=function(t){return["x","y","defined"].includes(t)},e}return M(e,t),e.prototype._getSegmentAttributes=function(){return Ej},e.prototype.initStyleWithSpec=function(e){this._segmentStyleKeys=[],t.prototype.initStyleWithSpec.call(this,e)},e.prototype.setStyle=function(t,e,i){var n=this;if(void 0===e&&(e="normal"),void 0===i&&(i=0),!j(t)){void 0===this.stateStyle[e]&&(this.stateStyle[e]={});var r=this._getIgnoreAttributes(),a=this._getSegmentAttributes(),o=this.isUserLevel(i);Object.keys(t).forEach((function(s){var l=t[s];if(!j(l)&&!r.includes(s)){o&&a.includes(s)&&(QR(null==l?void 0:l.type)||(null==l?void 0:l.scale)||V(l))&&(n._segmentStyleKeys.includes(s)||n._segmentStyleKeys.push(s));var u=n._filterAttribute(s,l,e,i,o);n.setAttribute(s,u,e,i)}}))}},e.prototype._getLineSegments=function(t,e){var i=this;if(!this._segmentStyleKeys||!this._segmentStyleKeys.length)return null;var n=[],r=null;return t.forEach((function(t,e){r&&i._segmentStyleKeys.every((function(e){return function(t,e,i){return!(!j(t)||!j(e))||!j(t)&&!j(e)&&("lineDash"===i?function(t,e){return t.length===e.length&&t.join("-")===e.join("-")}(t,e):"stroke"===i||"fill"===i?Cj(t,e):t===e)}(r[e],t[e],e)}))||(n.length&&(n[n.length-1].endIndex=e),r=t,n.push({attrs:r,startIndex:e}))})),n.length>=2?n.map((function(t){return T(T({},t.attrs),{points:e.slice(t.startIndex,j(t.endIndex)?e.length:t.endIndex)})})):null},e.prototype._getPrevPoints=function(t){var e=t.attribute,i=e.points,n=e.segments;return null!=i?i:n?n.reduce((function(t,e){return e.points&&e.points.forEach((function(e){t.push(e)})),t}),[]):null},e.prototype._runPointsEncoder=function(t,e,i){var n,r,a,o,s=this,l=e.context.data,u=[],c=[],h={},d=null===(n=this.renderContext)||void 0===n?void 0:n.progressive,p=d&&0===d.currentIndex;return l.forEach((function(e,i){var n;c[i]={},u[i]={},Object.keys(t).forEach((function(n){s._isValidPointChannel(n)?c[i][n]=t[n](e):s._segmentStyleKeys.includes(n)&&!d?u[i][n]=t[n](e):0!==i||d&&!p||(h[n]=t[n](e))})),c[i].context=null!==(n=s._keyGetter(e))&&void 0!==n?n:i})),d?((o=null!==(a=null===(r=e.attribute)||void 0===r?void 0:r.segments)&&void 0!==a?a:[]).push({points:c}),p?T(T({},h),{segments:o}):{segments:o}):this._segmentStyleKeys&&this._segmentStyleKeys.length&&(o=this._getLineSegments(u,c))?T(T(T({},h),u[0]),{segments:o,points:null}):T(T(T({},h),u[0]),{points:c,segments:null})},e.prototype._runEncoderOfGraphic=function(e,i,n){void 0===n&&(n={});var r=i.context.data;return e&&Object.keys(e).some(this._isValidPointChannel)&&r&&r.length?this._runPointsEncoder(e,i,n):t.prototype._runEncoderOfGraphic.call(this,e,i,n)},e.prototype._getDataByKey=function(t){return this._dataByGroup},e.prototype._runProgressiveJoin=function(){var t,e=this,i=this.renderContext.progressive.currentIndex,n=[];this._dataByGroup.keys.forEach((function(t,r){var a=e.renderContext.progressive.groupedData.get(t),o=e.renderContext.progressive.step,s=a.slice(i*o,(i+1)*o);if(0===i){var l={context:T(T({},e._getCommonContext()),{diffState:gN.enter,data:s,uniqueKey:t,key:t,groupKey:t})};n.push(l)}else{(l=e._graphics[r]).context.data=s}}));var r=0===i?n:this._graphics;return{graphicsByGroup:(t={},t[Sz]=r,t),graphics:r,needUpdate:!1}},e.prototype._setCommonAttributesToTheme=function(t){},e.prototype._addProgressiveGraphic=function(t,e){e.incremental=1,t.appendChild(e)},e}(RN),Bj=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=i.type,t}return M(i,e),i.prototype._getDefaultStyle=function(){return T(T({},e.prototype._getDefaultStyle.call(this)),{lineWidth:1})},i.prototype._getIgnoreAttributes=function(){var e,i;return(null===(e=this.model)||void 0===e?void 0:e.type)===t.SeriesTypeEnum.radar&&"polar"===(null===(i=this.model)||void 0===i?void 0:i.coordinate)?[]:["fill","fillOpacity"]},i.type="line",i}(Pj),Rj=function(){KF.registerMark(Bj.type,Bj),lC(),Qw(),WI(),HI(),QN(),KF.registerGraphicComponent("line",Nv)},Lj=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return M(e,t),e.prototype._getDefaultStyle=function(){return T(T({},t.prototype._getDefaultStyle.call(this)),{size:1,symbolType:"circle",fill:void 0,lineWidth:0})},e.prototype._transformGraphicAttributes=function(e,i,n){var r,a,o,s=t.prototype._transformGraphicAttributes.call(this,e,i,n),l=null!==(a=null!==(r=s.shape)&&void 0!==r?r:s.symbolType)&&void 0!==a?a:null===(o=e.attribute)||void 0===o?void 0:o.symbolType;return j(l)?s.symbolType="circle":s.symbolType=l,s},e.type="symbol",e}(RN),Ij=function(){KF.registerMark(Lj.type,Lj),lC(),cC(),HI(),KF.registerGraphicComponent("symbol",Fv)},Dj=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._transformLabelSpec=function(t){var e,i,n;!1!==(null===(e=t.point)||void 0===e?void 0:e.visible)&&!1!==(null===(n=null===(i=t.point)||void 0===i?void 0:i.style)||void 0===n?void 0:n.visible)?this._addMarkLabelSpec(t,"point"):this._addMarkLabelSpec(t,"line"),this._addMarkLabelSpec(t,"line","lineLabel","initLineLabelMarkStyle",void 0,!0)},e}(nj);function Oj(t){return t.length>=2&&et(t[0])&&et(At(t))&&At(t)>=t[0]}function Fj(t,e){var i,n=At(e)-e[0],r=At(e)*e[0]<0,a=e[0]<=0?0-e[0]:0,o=At(e)>0?At(e)-0:0;0===n?e[0]<0?(a=1,o=0):e[0]>0&&(a=0,o=1):(a/=n,o/=n);var s=t.getDomainSpec(),l={total:n,negative:a,positive:o,includeZero:r,domain:e,extendable_min:!et(s.min),extendable_max:!et(s.max)};if(null===(i=t._break)||void 0===i?void 0:i.scope){var u=e.findIndex((function(t){return t>=0})),c=void 0,h=void 0;0===u?(c=t._break.scope[u],h=[e[0],e[1]],l.positive=1,l.negative=0):At(e)<=0?(l.positive=0,l.negative=1,h=[e[e.length-2],e[e.length-1]]):(c=t._break.scope[u-1],h=[e[u-1],e[u]],l.negative=c[0]+(0-h[0])/(h[1]-h[0])*(c[1]-c[0]),l.positive=1-l.negative),l.break=!0,l.extendable_max=!1,l.extendable_min=!1,l.domain=h}return l}function zj(t,e){var i=t.positive,n=t.negative,r=t.extendable_min,a=t.extendable_max,o=t.domain,s=e.positive,l=e.negative,u=e.extendable_min,c=e.extendable_max,h=e.domain;if(s>0){if(!u)return!1;var d=n/i;a&&(d=n/Math.max(i,s),o[1]=-o[0]/d),h[0]=-h[1]*d}else if(l>0){if(!c)return!1;d=i/n;r&&(d=i/Math.max(n,n),o[0]=-o[1]/d),h[1]=-h[0]*d}return!0}function Hj(t,e){var i=t.extendable_min,n=t.extendable_max,r=t.domain,a=e.positive,o=e.negative,s=e.domain;return(0!==a||0!==o)&&(!(a>0&&!n)&&(!(o>0&&!i)&&(r[0]=s[0],r[1]=s[1],!0)))}function Nj(t,e){var i=t.positive,n=t.negative,r=t.extendable_max,a=t.domain,o=e.positive,s=e.negative,l=e.extendable_min,u=e.domain;if(r&&l){var c=Math.max(n,s)/Math.max(i,o);a[1]=-a[0]/c,u[0]=-u[1]*c}else if(l){c=n/i;u[0]=-u[1]*c}else{if(!r)return!1;c=s/o;a[1]=-a[0]/c}return!0}function Vj(t,e){var i=t.extendable_min,n=t.domain,r=e.extendable_max,a=e.domain;return!(!i||!r)&&(n[0]=-n[1],a[1]=-a[0],!0)}var jj=function(t,e){var i,n,r,a,o;if(!t)return t;var s=null===(i=null==e?void 0:e.targetAxis)||void 0===i?void 0:i.call(e);if(!s)return t;var l=null===(n=null==e?void 0:e.currentAxis)||void 0===n?void 0:n.call(e);if(!l)return t;var u=null===(r=l.getTickData())||void 0===r?void 0:r.getDataView();if(!u)return t;if(!u.transformsArr.find((function(t){return t.type.includes("ticks")})))return t;var c=l.getScale();if(!c)return t;var h=null===(o=null===(a=s.getTickData())||void 0===a?void 0:a.getDataView())||void 0===o?void 0:o.latestData;if(!(null==h?void 0:h.length))return t;var d=s.getScale();if(!d)return t;var p=d.domain(),f=At(p)-p[0];if(0===f)return t;var v=c.domain(),g=At(v)-v[0];if(0===f)return t;var y=h.map((function(t){return function(t,e,i,n,r){var a=Ie(t,e),o=Math.max(Re(i),Re(a));return r*(Math.round(a*Math.pow(10,o))/Math.round(i*Math.pow(10,o)))+n}(t.value,p[0],f,v[0],g)}));return YR(y)},Uj=function(){function t(t){this.id=_x(),this.name="".concat(t,"_").concat(this.id)}return t.prototype.onAdd=function(t){this.service=t},t.prototype.release=function(){this.service=null},t}(),Wj=function(e){function i(){var t=e.call(this,i.type)||this;return t.type="AxisSyncPlugin",t}return M(i,e),i.prototype._checkEnableSync=function(t){if(!JR(t.getScale().type))return!1;var e=t.getSpec().sync;return!!(null==e?void 0:e.axisId)&&e},i.prototype._getTargetAxis=function(t,e){var i=t.getOption().getChart().getComponentByUserId(e.axisId);return(null==i?void 0:i.type.startsWith("cartesianAxis"))?i:null},i.prototype.onInit=function(e,i){var n=this._checkEnableSync(i);if(n&&n.zeroAlign){var r=this._getTargetAxis(i,n);r&&i.event.on(t.ChartEvent.scaleDomainUpdate,{filter:function(t){var e=t.model;return e.id===i.id||e.id===r.id}},(function(){!function(t,e){var i,n,r,a,o,s,l=t.getScale(),u=e.getScale();if(l&&u){var c=null!==(r=null===(n=(i=t).getDomainAfterSpec)||void 0===n?void 0:n.call(i))&&void 0!==r?r:[0,1],h=null!==(s=null===(o=(a=e).getDomainAfterSpec)||void 0===o?void 0:o.call(a))&&void 0!==s?s:[0,1];if(c&&h&&Oj(c)&&Oj(h)){var d=Fj(t,c),p=Fj(e,h);if(!0!==d.break||!0!==p.break){var f=d.positive,v=d.negative,g=d.extendable_min,y=d.extendable_max,m=d.includeZero,_=p.positive,b=p.negative,x=p.extendable_min,k=p.extendable_max,S=p.includeZero;if(0===f&&0===v){if(!Hj(d,p))return}else if(0===_&&0===b){if(!Hj(p,d))return}else if(m||S)if(m&&!S){if(!zj(d,p))return}else if(S&&!m){if(!zj(p,d))return}else{if(v===b)return;if(v>b){if(!Nj(d,p))return}else if(!Nj(p,d))return}else{if(0===v&&0===_){if(!Vj(d,p))return}else if(0===b&&0===f&&!Vj(p,d))return;if(0===v&&0===b)if(0===c[0]&&h[0]>0){if(!x)return;h[0]=0}else{if(!(0===h[0]&&c[0]>0))return;if(!g)return;c[0]=0}if(0===f&&0===_)if(0===c[1]&&h[1]>0){if(!k)return;h[1]=0}else{if(!(0===h[1]&&c[1]>0))return;if(!y)return;c[1]=0}}l.domain(c),u.domain(h)}}}}(r,i)}))}},i.prototype.onDidCompile=function(t,e){var i,n=this._checkEnableSync(e);if(n){var r=this._getTargetAxis(e,n);if(r&&n.tickAlign){kH(e.getOption().dataSet,"tickAlign",jj);var a={targetAxis:function(){return r},currentAxis:function(){return e}},o=null===(i=r.getTickData())||void 0===i?void 0:i.getDataView();o&&o.target.addListener("change",(function(){var t,i;null===(i=null===(t=e.getTickData())||void 0===t?void 0:t.getDataView())||void 0===i||i.reRunAllTransform({skipEqual:!0})})),e.addTransformToTickData({type:"tickAlign",options:a,level:Number.MAX_SAFE_INTEGER},!1)}}},i.pluginType="component",i.type="AxisSyncPlugin",i}(Uj),Gj={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}};function Yj(t){var e=0;return ut(t,"tick.visible")&&(e+=ut(t,"tick.tickSize")),ut(t,"label.visible")&&(e+=ut(t,"label.space")),e}function Xj(t,e){var i,n,r,a,o,s;return{min:null!==(r=null!==(i=t.min)&&void 0!==i?i:null===(n=t.range)||void 0===n?void 0:n.min)&&void 0!==r?r:null==e?void 0:e.min,max:null!==(s=null!==(a=t.max)&&void 0!==a?a:null===(o=t.range)||void 0===o?void 0:o.max)&&void 0!==s?s:null==e?void 0:e.max}}function Kj(t){var e=null==t?void 0:t.orient;return"top"===e||"bottom"===e||"left"===e||"right"===e||"z"===e}var qj=function(t){return"band"===t||"ordinal"===t||"point"===t};function Zj(t,e){return{id:t,label:t,value:e,rawValue:t}}function Jj(t,e,i){return i||!t||t.getAxisId()===e.getAxisId()}var Qj=function(t){function e(e){var i=t.call(this)||this;return i.component=e,i}return M(e,t),e.prototype.releaseAll=function(){t.prototype.releaseAll.call(this),this.component=null},e}(HN),$j="".concat(mz,"_ARC_TRANSFORM_VALUE"),tU="".concat(mz,"_ARC_RATIO"),eU="".concat(mz,"_ARC_START_ANGLE"),iU="".concat(mz,"_ARC_END_ANGLE"),nU="".concat(mz,"_ARC_K"),rU="".concat(mz,"_ARC_MIDDLE_ANGLE"),aU="".concat(mz,"_ARC_QUADRANT"),oU="".concat(mz,"_ARC_RADIAN"),sU=-Math.PI/2,lU=3*Math.PI/2,uU=.6,cU=function(t,e,i,n){var r=t();if(Q(r))return r;if(V(r))return r(e(),i());var a=e();if("auto"===r&&a.width>0&&a.height>0){var o=n(),s=o.startAngle,l=void 0===s?0:s,u=o.endAngle,c=void 0===u?2*Math.PI:u;return Ge(a,i(),l,c)}return Math.min(a.width/2,a.height/2)},hU=function(t,e,i){var n,r=null!==(n="band"===e?yV("axisBand",i):"linear"===e?yV("axisLinear",i):{})&&void 0!==n?n:{},a=yV("angle"===t?"axisAngle":"axisRadius",i);return XF({},yV("axis",i),r,a)};function dU(t,e,i,n){switch(t){case I.cartesianBandAxis:return yj(dj(i,["z"]),"band",e);case I.cartesianLinearAxis:return yj(dj(i,["z"]),"linear",e);case I.cartesianLogAxis:return yj(dj(i,["z"]),"log",e);case I.cartesianSymlogAxis:return yj(dj(i,["z"]),"symlog",e);case I.cartesianAxis:case I.cartesianTimeAxis:return yj(dj(i),void 0,e);case I.polarBandAxis:return hU(i.orient,"band",e);case I.polarLinearAxis:return hU(i.orient,"linear",e);case I.polarAxis:return hU(i.orient,void 0,e);case I.cartesianCrosshair:return function(t,e){var i,n,r,a=St(null!==(i=e.axes)&&void 0!==i?i:[]),o=null!==(n=yV(I.crosshair,t))&&void 0!==n?n:{},s=o.bandField,l=o.linearField,u=o.xField,c=o.yField,h=o.trigger,d=o.triggerOff,p=a.find((function(t){return uj(t.orient)}));r=U(p)?XF({},qj(p.type)?s:l,u):u;var f=a.find((function(t){return cj(t.orient)}));return{xField:r,yField:U(f)?XF({},$R(f.type)?s:l,c):c,trigger:h,triggerOff:d}}(e,n);case I.polarCrosshair:return function(t,e){var i,n,r,a=St(null!==(i=e.axes)&&void 0!==i?i:[]),o=null!==(n=yV(I.crosshair,t))&&void 0!==n?n:{},s=o.bandField,l=o.linearField,u=o.categoryField,c=o.valueField,h=o.trigger,d=o.triggerOff,p=a.find((function(t){return"angle"===t.orient}));r=U(p)?XF({},qj(p.type)?s:l,u):u;var f=a.find((function(t){return"radius"===t.orient}));return{categoryField:r,valueField:U(f)?XF({},$R(f.type)?s:l,c):c,trigger:h,triggerOff:d}}(e,n);case I.colorLegend:case I.sizeLegend:case I.discreteLegend:case I.dataZoom:case I.scrollBar:return vU(i,yV(t,e));default:return yV(t,e)}}var pU,fU,vU=function(t,e){var i,n=XF({},e,e[pj(null!==(i=t.orient)&&void 0!==i?i:e.orient)]);return delete n.horizontal,delete n.vertical,n},gU=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.getTheme=function(t,e){return dU(this.type,this._option.getTheme,t,e)},e.prototype._mergeThemeToSpec=function(e,i){var n=t.prototype._mergeThemeToSpec.call(this,e,i),r=n.spec,a=n.theme;return this._adjustPadding(r),{spec:r,theme:a}},e.prototype._adjustPadding=function(t){var e,i=t.padding,n=t.noOuterPadding,r=void 0===n||n,a=t.orient;r&&i&&a&&(t.padding=T(T({},IF(i)),((e={})[a]=0,e)))},e}(iN),yU=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="component",e.modelType="component",e.transformerConstructor=gU,e._delegateEvent=function(t,i,n,r,a){var o,s;void 0===r&&(r=null),void 0===a&&(a=null),i instanceof xh||e.event.emit(n,{model:e,node:t,event:i,item:r,datum:a,source:vH.chart,chart:null===(s=null===(o=e._option)||void 0===o?void 0:o.globalInstance)||void 0===s?void 0:s.getChart()},"model")},e}return M(e,t),e.createComponent=function(t,e){var i=t.spec,n=w(t,["spec"]);return new this(i,T(T({},e),n))},e.prototype.getRegions=function(){return this._regions},e.prototype.created=function(){t.prototype.created.call(this),this.initLayout(),this.pluginService=new Qj(this)},e.prototype.initLayout=function(){var e;t.prototype.initLayout.call(this),this._regions=null!==(e=this._regions)&&void 0!==e?e:this._option.getRegionsInIndex(),this._layout&&(this._layout.layoutBindRegionID=this._regions.map((function(t){return null==t?void 0:t.id})))},e.prototype._getNeedClearVRenderComponents=function(){return[]},e.prototype.getVRenderComponents=function(){return this._getNeedClearVRenderComponents()},e.prototype.callPlugin=function(t){this.pluginService&&this.pluginService.getAll().forEach((function(e){return t(e)}))},e.prototype.getContainer=function(){var t;return this._container||(this._container=null===(t=this._option)||void 0===t?void 0:t.globalInstance.getStage().find((function(t){return"root"===t.name}),!0)),this._container},e.prototype._compareSpec=function(e,i){var n=t.prototype._compareSpec.call(this,e,i);return n.reMake||(n.reMake=["seriesId","seriesIndex","regionId","regionIndex"].some((function(t){return!bt(null==i?void 0:i[t],e[t])}))),(null==i?void 0:i.visible)!==e.visible&&(n.reCompile=!0),n},e.prototype.release=function(){var e;t.prototype.release.call(this),this.clear(),null===(e=this.pluginService)||void 0===e||e.releaseAll(),this.pluginService=null},e.prototype.clear=function(){var t,e=this,i=this._getNeedClearVRenderComponents();i&&i.length&&i.forEach((function(t){var i;t&&(null===(i=e.getContainer())||void 0===i||i.removeChild(t),t=null)})),this._container=null,null===(t=this.pluginService)||void 0===t||t.clearAll()},e.prototype.compile=function(){this.compileMarks(),this.reAppendComponents()},e.prototype.compileMarks=function(t){var e=this;this.getMarks().forEach((function(i){i.compile({group:t,context:{model:e}})}))},e.prototype.reAppendComponents=function(){var t=this,e=this._getNeedClearVRenderComponents();e&&e.length&&e.forEach((function(e){var i;e&&!e.stage&&(null===(i=t.getContainer())||void 0===i||i.appendChild(e))}))},e.prototype.getBoundsInRect=function(t,e){return{x1:0,x2:0,y1:0,y2:0}},e.prototype.getDatum=function(t){},e.transformerConstructor=gU,e}(aN);!function(t){t.lineAxis="lineAxis",t.circleAxis="circleAxis"}(pU||(pU={})),function(t){t.lineAxisGrid="lineAxisGrid",t.circleAxisGrid="circleAxisGrid"}(fU||(fU={}));var mU=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type="component",n._componentType=i.componentType,n._mode=i.mode,n}return M(e,t),e.prototype._getDefaultStyle=function(){return{}},e.prototype.getComponent=function(){return this._component},e.prototype.clearComponent=function(){this._component&&(this._component.parent&&this._component.parent.removeChild(this._component),this._component=null)},e.prototype._getAttrsFromConfig=function(e){void 0===e&&(e={});var i=t.prototype._getAttrsFromConfig.call(this,e);return j(this._markConfig.interactive)||(i.pickable=this._markConfig.interactive),e},e.prototype.setAttributeTransform=function(t){this._attributesTransform=t},e.prototype.renderInner=function(){var t,e=null!==(t=this._simpleStyle)&&void 0!==t?t:this.getAttributesOfState({}),i=this._getAttrsFromConfig(e);this._attributesTransform&&(i=this._attributesTransform(i)),this._animationConfig&&(i=T(T({},i),{animation:!0,animationAppear:this._animationConfig.appear?Array.isArray(this._animationConfig.appear)?this._animationConfig.appear[0]:this._animationConfig.appear:void 0,animationEnter:this._animationConfig.enter?Array.isArray(this._animationConfig.enter)?this._animationConfig.enter[0]:this._animationConfig.enter:void 0,animationUpdate:this._animationConfig.update?Array.isArray(this._animationConfig.update)?this._animationConfig.update[0]:this._animationConfig.update:void 0,animationExit:this._animationConfig.exit?Array.isArray(this._animationConfig.exit)?this._animationConfig.exit[0]:this._animationConfig.exit:void 0})),this._component?this._component.setAttributes(i):(this._component=KF.createGraphicComponent(this._componentType,i,{mode:this._mode,skipDefault:this._markConfig.skipTheme}),this._component&&this._product.appendChild(this._component)),this._component&&(this._component.context=this._getCommonContext()),this._markConfig.support3d&&this._product&&this._product.setMode("3d"),this.model.event.emit(lH.AFTER_ELEMENT_ENCODE,{mark:this,model:this.model}),this.needClear=!0},e.prototype.release=function(){t.prototype.release.call(this),this.removeProduct()},e.type="component",e}(RN),_U=function(){KF.registerMark(mU.type,mU)},bU=function(t){return t},xU=function(e){function i(t,i){var n,r=this;return(r=e.call(this,t,i)||this).specKey="axes",r._scales=[],r._tickData=[],r._visible=!0,r._tick=void 0,r._onTickDataChange=function(t){r._forceLayout(),null==t||t.updateData()},r._visible=null===(n=t.visible)||void 0===n||n,r._coordinateType="none",r}return M(i,e),i.prototype.getOrient=function(){return this._orient},i.prototype.getScale=function(){return this._scale},i.prototype.getScales=function(){return this._scales},i.prototype.getTickData=function(t){return void 0===t&&(t=0),this._tickData[t]},Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),i.prototype.getInverse=function(){return this._inverse},i.prototype.getCoordinateType=function(){return this._coordinateType},i.prototype.getVRenderComponents=function(){var t,e;return[null===(t=this._axisMark)||void 0===t?void 0:t.getProduct(),null===(e=this._gridMark)||void 0===e?void 0:e.getProduct()].filter(U)},i.prototype.created=function(){var i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b;if(e.prototype.created.call(this),this.setSeriesAndRegionsFromSpec(),this.initEvent(),this.initScales(),this.updateSeriesScale(),this._shouldComputeTickData()&&this._initData(),this._visible){var x=this._createMark({type:"component",name:"axis-".concat(this.getOrient())},{componentType:"angle"===this.getOrient()?pU.circleAxis:pU.lineAxis,mode:this._spec.mode},{skipTheme:!0});if(this._updateTickDataMarks(x),this._axisMark=x,x.setMarkConfig({zIndex:this.layoutZIndex}),U(this._spec.id)&&x.setUserId(this._spec.id),x.setMarkConfig({interactive:null!==(i=this._spec.interactive)&&void 0!==i?i:this.getDefaultInteractive()}),this._marks.addMark(x),null===(n=this._spec.grid)||void 0===n?void 0:n.visible){var k=this._createMark({type:"component",name:"axis-".concat(this.getOrient(),"-grid")},{componentType:"angle"===this.getOrient()?fU.circleAxisGrid:fU.lineAxisGrid,mode:this._spec.mode},{skipTheme:!0});this._updateTickDataMarks(k),k.setMarkConfig({zIndex:null!==(l=null!==(o=null===(a=null===(r=this._spec.grid)||void 0===r?void 0:r.style)||void 0===a?void 0:a.zIndex)&&void 0!==o?o:null===(s=this._spec.grid)||void 0===s?void 0:s.zIndex)&&void 0!==l?l:t.LayoutZIndex.Axis_Grid,interactive:!1}),this._marks.addMark(k),this._gridMark=k}if((null===(u=this._option.globalInstance)||void 0===u?void 0:u.isAnimationEnable())&&!1!==ut(this._option.getChart().getSpec(),"animation")&&!0===this._spec.animation){var S=qV(null===(c=KF.getAnimationInKey("axis"))||void 0===c?void 0:c(),{appear:null!==(d=null!==(h=this._spec.animationAppear)&&void 0!==h?h:ut(this._option.getChart().getSpec(),"animationAppear.axis"))&&void 0!==d?d:ut(this._option.getChart().getSpec(),"animationAppear"),disappear:null!==(f=null!==(p=this._spec.animationDisappear)&&void 0!==p?p:ut(this._option.getChart().getSpec(),"animationDisappear.axis"))&&void 0!==f?f:ut(this._option.getChart().getSpec(),"animationDisappear"),enter:null!==(g=null!==(v=this._spec.animationEnter)&&void 0!==v?v:ut(this._option.getChart().getSpec(),"animationEnter.axis"))&&void 0!==g?g:ut(this._option.getChart().getSpec(),"animationEnter"),exit:null!==(m=null!==(y=this._spec.animationExit)&&void 0!==y?y:ut(this._option.getChart().getSpec(),"animationExit.axis"))&&void 0!==m?m:ut(this._option.getChart().getSpec(),"animationExit"),update:null!==(b=null!==(_=this._spec.animationUpdate)&&void 0!==_?_:ut(this._option.getChart().getSpec(),"animationUpdate.axis"))&&void 0!==b?b:ut(this._option.getChart().getSpec(),"animationUpdate")});S.enter&&(S.update[0].customParameters={enter:S.enter[0]}),this._marks.forEach((function(t){return t.setAnimationConfig(S)}))}}},i.prototype._shouldComputeTickData=function(){return this.getVisible()||this._spec.forceInitTick},i.prototype._initData=function(){var t=this,e=this._initTickDataSet(this._tickTransformOption()),i=new wN(this._option,e);this._tickData=[i],e.target.addListener("change",(function(){t._onTickDataChange(i)}))},i.prototype.collectData=function(t,e){var i=this,n=[];return iF(this._regions,(function(r){var a,o=i.collectSeriesField(t,r);if(o=q(o)?JR(i._scale.type)?o:[o[0]]:[o],t||(i._dataFieldText=r.getFieldAlias(o[0])),o){var s=r.getViewData();if(e)o.forEach((function(t){n.push(r.getRawDataStatisticsByField(t,!1))}));else if(s&&s.latestData&&s.latestData.length){var l=null===(a=r.getViewDataStatistics)||void 0===a?void 0:a.call(r),u=i.type===I.cartesianLinearAxis&&i._spec.breaks&&i._spec.breaks.length;o.forEach((function(t){var e;(null===(e=null==l?void 0:l.latestData)||void 0===e?void 0:e[t])&&(u?n.push(T(T({},l.latestData[t]),{values:s.latestData.map((function(e){return e[t]}))})):n.push(l.latestData[t]))}))}}}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),n},i.prototype.isSeriesDataEnable=function(){var t=!0;return iF(this._regions,(function(e){var i;q(null===(i=e.getViewDataStatistics())||void 0===i?void 0:i.latestData)&&(t=!1)}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),t},i.prototype.setSeriesAndRegionsFromSpec=function(){var t=this._spec,e=t.seriesId,i=t.seriesIndex,n=t.regionId,r=t.regionIndex;U(e)&&(this._seriesUserId=St(e)),U(n)&&(this._regionUserId=St(n)),U(i)&&(this._seriesIndex=St(i)),U(r)&&(this._regionIndex=St(r)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionIndex),this.layout.layoutBindRegionID=this._regions.map((function(t){return t.id}))},i.prototype.getBindSeriesFilter=function(){return{userId:this._seriesUserId,specIndex:this._seriesIndex}},i.prototype.initEvent=function(){var e=this;this.event.on(t.ChartEvent.scaleUpdate,{filter:function(t){var i=t.model;return(null==i?void 0:i.id)===e.id}},this.effect.scaleUpdate.bind(this));var i=nF(this._regions,{userId:this._seriesUserId,specIndex:this._seriesIndex}).map((function(t){return t.getViewDataStatistics()})).filter((function(t){return!!t}));i.length>1?this._option.dataSet.multipleDataViewAddListener(i,"change",(function(){e.updateScaleDomain()})):1===i.length&&i[0].target.addListener("change",(function(){e.updateScaleDomain()})),iF(this._regions,(function(i){i.event.on(t.ChartEvent.rawDataUpdate,{filter:function(t){var e=t.model;return(null==e?void 0:e.id)===i.id}},(function(){e._clearRawDomain()}))}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype.updateScaleDomain=function(){},i.prototype._clearRawDomain=function(){},i.prototype.onLayoutEnd=function(){this.updateScaleRange(),this.event.emit(t.ChartEvent.scaleUpdate,{model:this,value:"range"}),e.prototype.onLayoutEnd.call(this)},i.prototype.computeData=function(t){"force"!==t||this._tickData&&this._tickData.length?!this._tickData||!this._tickData.length||"force"!==t&&bt(this._scale.range(),[0,1])||this._tickData.forEach((function(t){t.getDataView().reRunAllTransform({skipEqual:!0})})):iF(this._regions,(function(t){var e;null===(e=t.getViewData())||void 0===e||e.reRunAllTransform()}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype._updateTickDataMarks=function(t){this._tickData&&this._tickData.forEach((function(e){e.addRelatedMark(t)}))},i.prototype.initScales=function(){this._scales=[this._scale];var t=[];if(iF(this._regions,(function(e){var i=e.getGroups();i&&t.push(i)}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),0!==t.length)for(var e=Mt(t.map((function(t){return t.fields.length}))),i=1;i<e;i++){var n=this._scale.clone();this._scales.push(n)}},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reMake?n:(n.reRender=!0,(null==i?void 0:i.type)!==(null==t?void 0:t.type)||(null==i?void 0:i.visible)!==(null==t?void 0:t.visible)?(n.reMake=!0,n):(n.reMake=["grid","subGrid","tick","subTick","label","domainLine","title"].some((function(e){var n,r;return(null===(n=null==i?void 0:i[e])||void 0===n?void 0:n.visible)!==(null===(r=null==t?void 0:t[e])||void 0===r?void 0:r.visible)})),n))},i.prototype._getAxisAttributes=function(){var t,e=this,i=this._spec,n={orient:this.getOrient(),select:!0!==this._option.disableTriggerEvent&&i.select,hover:!0!==this._option.disableTriggerEvent&&i.hover};if(i.domainLine&&i.domainLine.visible?n.line=((t=rH(t=i.domainLine)).startSymbol=rH(t.startSymbol),t.endSymbol=rH(t.endSymbol),t):n.line={visible:!1},i.label&&i.label.visible){var r=yt(i.label,["style","formatMethod","state"]);n.label=r,i.label.style&&(n.label.style=V(i.label.style)?function(t,n,r,a){var o,s=i.label.style(t.rawValue,n,t,r,a);return sH(XF({},null===(o=e._theme.label)||void 0===o?void 0:o.style,s))}:sH(i.label.style)),(i.label.formatMethod||i.label.formatter)&&(n.label.formatMethod=this._getLabelFormatMethod()),i.label.state&&(n.label.state=function(t){if(lt(t))return null;var e={};return Object.keys(t).forEach((function(i){V(t[i])?e[i]=function(e,n,r,a){return sH(t[i](e.rawValue,n,e,r,a))}:lt(t[i])||(e[i]=sH(t[i]))})),e}(i.label.state)),V(i.label.dataFilter)&&(n.label.dataFilter=function(t,n){return i.label.dataFilter(t,n,{vchart:e._option.globalInstance})})}else n.label={visible:!1};if(i.tick&&i.tick.visible?(n.tick={visible:i.tick.visible,length:i.tick.tickSize,inside:i.tick.inside,alignWithLabel:i.tick.alignWithLabel,dataFilter:V(i.tick.dataFilter)?function(t){return i.tick.dataFilter(t,{vchart:e._option.globalInstance})}:void 0},i.tick.style&&(n.tick.style=V(i.tick.style)?function(t,n,r,a){var o,s=i.tick.style(t,n,r,a);return sH(XF({},null===(o=e._theme.tick)||void 0===o?void 0:o.style,s))}:sH(i.tick.style)),i.tick.state&&(n.tick.state=aH(i.tick.state))):n.tick={visible:!1},i.subTick&&i.subTick.visible?(n.subTick={visible:i.subTick.visible,length:i.subTick.tickSize,inside:i.subTick.inside,count:i.subTick.tickCount},i.subTick.style&&(n.subTick.style=V(i.subTick.style)?function(t,n,r,a){var o,s=i.subTick.style(t,n,r,a);return sH(XF({},null===(o=e._theme.subTick)||void 0===o?void 0:o.style,s))}:sH(i.subTick.style)),i.subTick.state&&(n.subTick.state=aH(i.subTick.state))):n.subTick={visible:!1},i.title&&i.title.visible){var a=i.title,o=a.autoRotate,s=a.angle,l=a.style,u=void 0===l?{}:l,c=a.background,h=a.state,d=a.shape,p=w(a,["autoRotate","angle","style","background","state","shape"]),f=s,v=void 0;"left"!==i.orient&&"right"!==i.orient||o&&j(f)&&(f="left"===i.orient?-90:90,v=Gj[i.orient]),n.title=T(T({},p),{autoRotate:!1,angle:f?Fe(f):null,textStyle:XF({},v,sH(u)),pickable:!1!==u.pickable,childrenPickable:!1!==u.pickable,state:{}}),d&&d.visible?(n.title.shape=T(T({},d),{style:sH(d.style)}),d.state&&(n.title.state.shape=aH(d.state))):n.title.shape={visible:!1},c&&c.visible?(n.title.background=T(T({},c),{style:sH(c.style)}),c.state&&(n.title.state.background=aH(c.state))):n.title.background={visible:!1},h&&(n.title.state.text=aH(h))}else n.title={visible:!1};return i.background&&i.background.visible?(n.panel={visible:!0},i.background.style&&(n.panel.style=sH(i.background.style)),i.background.state&&(n.panel.state=aH(i.background.state))):n.panel={visible:!1},n},i.prototype._getGridAttributes=function(){var t=this,e=this._spec;return{alternateColor:e.grid.alternateColor,alignWithLabel:e.grid.alignWithLabel,style:V(e.grid.style)?function(i,n){var r,a,o=e.grid.style(null===(r=i.datum)||void 0===r?void 0:r.rawValue,n,i.datum);return sH(XF({},null===(a=t._theme.grid)||void 0===a?void 0:a.style,o))}:sH(e.grid.style),subGrid:!1===e.subGrid.visible?{visible:!1}:{type:"line",visible:e.subGrid.visible,alternateColor:e.subGrid.alternateColor,style:sH(e.subGrid.style)}}},i.prototype._getLabelFormatMethod=function(){var t=this._spec.label,e=t.formatMethod,i=t.formatter,n=mV(e,i).formatFunc;return n?function(t,e,r){return n(e.rawValue,e,i)}:null},i.prototype._initTickDataSet=function(t,e){void 0===e&&(e=0),SH(this._option.dataSet,"scale",bU);var i=this.registerTicksTransform();return new hs(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_ticks_").concat(e)}).parse(this._scales[e],{type:"scale"}).transform({type:i,options:t},!1)},i.prototype._tickTransformOption=function(){var t=this._tick||{},e=this._spec.label||{},i=t.tickCount,n=t.forceTickCount,r=t.tickStep,a=t.tickMode,o=e.style,s=e.formatMethod,l=e.minGap;return{sampling:!1!==this._spec.sampling,tickCount:i,forceTickCount:n,tickStep:r,tickMode:a,axisOrientType:this._orient,coordinateType:this._coordinateType,labelStyle:o,labelFormatter:s,labelGap:l}},i.prototype.addTransformToTickData=function(t,e){this._tickData.forEach((function(i){var n;null===(n=null==i?void 0:i.getDataView())||void 0===n||n.transform(t,e)}))},i.prototype.dataToPosition=function(t){return this._scale.scale(t)},i.prototype.getDatum=function(t){var e;return t&&t.name===wE.label?t.data:this._axisMark?null===(e=this._axisMark.getComponent())||void 0===e?void 0:e.attribute.items:void 0},i.prototype.scaleRangeFactor=function(t,e,i){return this._onTickDataChange(this.getTickData()),this.getScale().rangeFactor(t,e,i)},i.prototype.scaleRangeFactorEnd=function(t,e,i){return this._onTickDataChange(this.getTickData()),this.getScale().rangeFactorEnd(t,e)},i.prototype.scaleRangeFactorStart=function(t,e,i){return this._onTickDataChange(this.getTickData()),this.getScale().rangeFactorStart(t,e)},i.specKey="axes",i}(yU),kU=function(){_U(),KF.registerAnimation("axis",(function(){return{appear:{type:"fadeIn"},enter:{type:"fadeIn"},update:{type:"update"},exit:{type:"fadeOut"}}}))},SU=function(t){for(var e=t[0].getLayoutStartPoint(),i=e.x,n=e.y,r=i+t[0].getLayoutRect().width,a=n+t[0].getLayoutRect().height,o=1;o<t.length;o++){var s=t[o],l=s.getLayoutStartPoint(),u=l.x,c=l.y,h=s.getLayoutRect(),d=h.width,p=h.height;i=Math.min(i,u),r=Math.max(r,d+u),n=Math.min(n,c),a=Math.max(a,p+c)}var f=Math.abs(a-n);return{width:Math.abs(r-i),height:f}},AU=[Wj],MU=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.type=I.cartesianAxis,r.name=I.cartesianAxis,r._defaultBandPosition=.5,r._defaultBandInnerPadding=.1,r._defaultBandOuterPadding=.3,r.layoutType="region-relative",r.layoutZIndex=t.LayoutZIndex.Axis,r.layoutLevel=t.LayoutLevel.Axis,r._orient="left",r._autoIndentOnce=!1,r._hasAutoIndent=!1,r._scales=[],r._tick=void 0,r._layoutCache={width:0,height:0,_lastComputeOutBounds:{x1:0,x2:0,y1:0,y2:0}},r._innerOffset={top:0,bottom:0,left:0,right:0},r.effect={scaleUpdate:function(t){r.computeData(null==t?void 0:t.value),iF(r._regions,(function(t){var e=r.getOrient();uj(e)?Jj(t.getXAxisHelper(),r.axisHelper(),U(r._seriesUserId)||U(r._seriesIndex))&&t.setXAxisHelper(r.axisHelper()):cj(e)?Jj(t.getYAxisHelper(),r.axisHelper(),U(r._seriesUserId)||U(r._seriesIndex))&&t.setYAxisHelper(r.axisHelper()):hj(e)&&Jj(t.getZAxisHelper(),r.axisHelper(),U(r._seriesUserId)||U(r._seriesIndex))&&t.setZAxisHelper(r.axisHelper())}),{userId:r._seriesUserId,specIndex:r._seriesIndex})}},r._transformLayoutPosition=function(t){var e=t.x,i=t.y;return et(e)&&(e+=Number("left"===r._orient)*r.getLayoutRect().width),et(i)&&(i+=Number("top"===r._orient)*r.getLayoutRect().height),{x:e,y:i}},r._transformLayoutRect=function(t){if(!r._visible)return t;var e=r._latestBounds.clone().translate(-r.getLayoutStartPoint().x,-r.getLayoutStartPoint().y);switch(r._layout.layoutOrient){case"left":0===r._layout.layoutRectLevelMap.width&&(t.width=e.x1<0?-e.x1:0);break;case"right":0===r._layout.layoutRectLevelMap.width&&(t.width=e.x2>0?e.x2:0);break;case"top":0===r._layout.layoutRectLevelMap.height&&(t.height=e.y1<0?-e.y1:0);break;case"bottom":0===r._layout.layoutRectLevelMap.height&&(t.height=e.y2>0?e.y2:0)}return t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),r._layout.setRectInSpec(r._layoutCacheProcessing(t))},r._transformLayoutPadding=function(t){return"left"===r.layoutOrient||"right"===r.layoutOrient?(t.top=0,t.bottom=0):"top"!==r.layoutOrient&&"bottom"!==r.layoutOrient||(t.left=0,t.right=0),t},r._updateAxisLayout=function(){var t=r.getLayoutStartPoint(),e=r._getUpdateAttribute(!1),i=e.grid,n=w(e,["grid"]),a=XF({x:t.x,y:t.y},r._axisStyle,n);r._axisMark.setSimpleStyle(a),r._gridMark&&r._gridMark.setSimpleStyle(XF({x:t.x,y:t.y},r._getGridAttributes(),i))},r._fixAxisOnZero=function(){var t=r._spec.domainLine,e=t.onZero,i=t.visible;if(r.visible&&e&&!1!==i){var n=r._spec.domainLine,a=n.onZeroAxisId,o=n.onZeroAxisIndex,s=r._option.getComponentsByKey("axes"),l=uj(r.getOrient()),u=function(t){var e;return(l?!uj(t.getOrient()):uj(t.getOrient()))&&JR(t.getScale().type)&&(t.getTickData()?null===(e=t.getTickData().getLatestData())||void 0===e?void 0:e.find((function(t){return 0===t.value})):t.getScale().domain()[0]<=0&&At(t.getScale().domain())>=0)},c=s.filter((function(t){return u(t)}));if(c.length){var h=void 0;if(U(a))h=c.find((function(t){return t.id===a}));else if(U(o)){var d=s[o];u(d)&&(h=d)}else h=c[0];if(h){var p=r._axisMark,f=h.valueToPosition(0);l?p.setSimpleStyle(T(T({},p.getSimpleStyle()),{line:T(T({},r._axisStyle.line),{dy:"bottom"===r._orient?-((h.getInverse()?h.getScale().range()[1]:h.getScale().range()[0])-f):f})})):p.setSimpleStyle(T(T({},p.getSimpleStyle()),{line:T(T({},r._axisStyle.line),{dx:"left"===r._orient?f:-((h.getInverse()?h.getScale().range()[0]:h.getScale().range()[1])-f)})}))}}}},r._orient=dj(i,["z"]),hj(r._orient)&&(r.layoutType="absolute"),r._dataSet=n.dataSet,r._coordinateType="cartesian",r}return M(i,e),i.prototype.getOrient=function(){return this._orient},i.prototype.getDefaultInteractive=function(){return!0},Object.defineProperty(i.prototype,"autoIndentOnce",{set:function(t){this._autoIndentOnce=t},enumerable:!1,configurable:!0}),i.prototype.getScales=function(){return this._scales},i.getSpecInfo=function(t){var e=this,i=t[this.specKey];if(!i)return null;var n="horizontal"===t.direction;if(!q(i)){if(!Kj(i))return null;var r=fj(i,n),a=r.axisType,o=r.componentName;return i.type=a,[{spec:i,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:o}]}var s=i.filter((function(t){return"z"===t.orient}))[0],l=!0;if(s){var u=i.filter((function(t){return"bottom"===t.orient}))[0],c=i.filter((function(t){return cj(t.orient)}))[0];l=3===i.length&&u&&c}var h=i.map((function(t,e){return{spec:t,index:e}}));l||(h=h.filter((function(t){return"z"!==t.spec.orient})));var d=[];return h.forEach((function(t){var i=t.spec,r=t.index;if(Kj(i)){var a=fj(i,n),o=a.axisType,s=a.componentName;i.type=o,d.push({spec:i,specPath:[e.specKey,r],specInfoPath:["component",e.specKey,r],type:s})}})),d},i.createComponent=function(t,e){var i=t.spec,n=w(t,["spec"]),r=KF.getComponentInKey(n.type);return r?new r(i,T(T({},e),n)):(e.onError("Component ".concat(n.type," not found")),null)},i.prototype.initLayout=function(){e.prototype.initLayout.call(this),this._layout.autoIndent=!1!==this._spec.autoIndent,this._layout.layoutOrient=this._orient},i.prototype.getNewScaleRange=function(){var t=this.getLayoutRect(),e=t.width,i=t.height,n=this._innerOffset,r=n.left,a=n.right,o=n.top,s=n.bottom,l=[];return uj(this.getOrient())?et(e)&&(l=this._inverse?[e-a,r]:[r,e-a]):hj(this.getOrient())?et(e)&&(l=this._inverse?[e-a,r]:[r,e-a],this._scale.range(l)):et(i)&&(l=this._inverse?[o,i-s]:[i-s,o]),l},i.prototype.updateScaleRange=function(){var t=!1,e=this.getNewScaleRange(),i=this._scale.range();return e.length===i.length&&e.every((function(t,e){return t===i[e]}))?t=!1:(t=!0,this._scale.range(e)),t},i.prototype.init=function(t){var i,n=this;e.prototype.init.call(this,t),null===(i=this.pluginService)||void 0===i||i.load(AU.map((function(t){return new t}))),this.callPlugin((function(t){n.pluginService&&t.onInit&&t.onInit(n.pluginService,n)}))},i.prototype.setAttrFromSpec=function(){var t;if(e.prototype.setAttrFromSpec.call(this),this.visible){uj(this.getOrient())?X(this._spec.maxHeight)&&(this._spec.maxHeight="30%"):X(this._spec.maxWidth)&&(this._spec.maxWidth="30%");var i=this._getAxisAttributes();i.label.formatMethod=this._getLabelFormatMethod(),i.verticalFactor="top"===this.getOrient()||"right"===this.getOrient()?-1:1,this._axisStyle=i}this._tick=this._spec.tick;var n=null===(t=this._option.getChart())||void 0===t?void 0:t.getSpec();this._inverse=function(t,e){var i=t.inverse;return e&&!uj(t.orient)&&(i=!U(t.inverse)||!t.inverse),i}(this._spec,"horizontal"===(null==n?void 0:n.direction))},i.prototype.onLayoutStart=function(t,i){var n=this;if(e.prototype.onLayoutStart.call(this,t,i),!hj(this.getOrient())&&this._spec.innerOffset){var r=this._spec;cj(this.getOrient())?["top","bottom"].forEach((function(t){n._innerOffset[t]=BF(r.innerOffset[t],i.height,i)})):["left","right"].forEach((function(t){n._innerOffset[t]=BF(r.innerOffset[t],i.width,i)}))}},i.prototype.getSeriesStatisticsField=function(t){var e;return e=uj(this.getOrient())?t.fieldX:hj(this.getOrient())?t.fieldZ:t.fieldY,JR(this._scale.type)?e:[e[0]]},i.prototype._tickTransformOption=function(){var t,i,n,r;return T(T({},e.prototype._tickTransformOption.call(this)),{noDecimals:null===(t=this._tick)||void 0===t?void 0:t.noDecimals,labelLastVisible:null===(i=this._spec.label)||void 0===i?void 0:i.lastVisible,labelFirstVisible:null===(n=this._spec.label)||void 0===n?void 0:n.firstVisible,labelFlush:null===(r=this._spec.label)||void 0===r?void 0:r.flush})},i.prototype.axisHelper=function(){var t=this;return{isContinuous:JR(this._scale.type),dataToPosition:this.dataToPosition.bind(this),getScale:function(e){return void 0===e&&(e=0),t._scales[e]},getAxisType:function(){return t.type},getAxisId:function(){return t.id},isInverse:function(){return!0===t._inverse},getSpec:function(){return t._spec}}},i.prototype.afterCompile=function(){var t,e=this;(null===(t=this._axisMark)||void 0===t?void 0:t.getProduct())&&this.event.on(lH.AFTER_ELEMENT_ENCODE,(function(t){if(t.mark===e._axisMark&&!1===e._isLayout&&(uj(e.getOrient())?e.callPlugin((function(t){e.pluginService&&t.onDidLayoutHorizontal&&t.onDidLayoutHorizontal(e.pluginService,e)})):e.callPlugin((function(t){e.pluginService&&t.onDidLayoutVertical&&t.onDidLayoutVertical(e.pluginService,e)})),e._unitText)){var i=e.getLayoutStartPoint(),n=i.x,r=i.y,a=uj(e._orient)?{x:Mt(e._scale.range())+n,y:r}:{x:n,y:Tt(e._scale.range())+r};e._unitText.setAttributes(a)}})),this.callPlugin((function(t){e.pluginService&&t.onDidCompile&&t.onDidCompile(e.pluginService,e)}))},i.prototype.collectScale=function(){var t=this,e=[];return iF(this._regions,(function(i){e.push("left"===t.getOrient()||"right"===t.getOrient()?i.scaleY:i.scaleX)}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),e},i.prototype.collectSeriesField=function(t,e){var i,n;return t>0?null===(n=null===(i=e.getGroups())||void 0===i?void 0:i.fields)||void 0===n?void 0:n[t]:uj(this.getOrient())?e.getSpec().x2Field?R(R([],B(e.fieldX),!1),[e.fieldX2],!1):e.fieldX:hj(this.getOrient())?e.fieldZ:e.getSpec().y2Field?R(R([],B(e.fieldY),!1),[e.fieldY2],!1):e.fieldY},i.prototype.updateSeriesScale=function(){var t=this,e=this.getOrient();iF(this._regions,(function(i){uj(e)?Jj(i.getXAxisHelper(),t.axisHelper(),U(t._seriesUserId)||U(t._seriesIndex))&&(i.setScaleX(t._scale),i.setXAxisHelper(t.axisHelper())):cj(e)?Jj(i.getYAxisHelper(),t.axisHelper(),U(t._seriesUserId)||U(t._seriesIndex))&&(i.setScaleY(t._scale),i.setYAxisHelper(t.axisHelper())):hj(e)&&Jj(i.getZAxisHelper(),t.axisHelper(),U(t._seriesUserId)||U(t._seriesIndex))&&(i.setScaleZ(t._scale),i.setZAxisHelper(t.axisHelper()))}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype.getBoundsInRect=function(t){var e,i=this,n={x1:0,y1:0,x2:0,y2:0};if(!this._visible)return n;this._verticalLimitSize=uj(this.getOrient())?t.height:t.width,this.setLayoutRect(t),!this.updateScaleRange()&&q(null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData())||this.computeData("range");var r={skipLayout:!1},a=uj(this.getOrient());this.pluginService&&(a?this.callPlugin((function(t){t.onWillLayoutHorizontal&&t.onWillLayoutHorizontal(i.pluginService,r,i)})):this.callPlugin((function(t){t.onWillLayoutVertical&&t.onWillLayoutVertical(i.pluginService,r,i)})));this._axisMark.getProduct();var o=this._getUpdateAttribute(!0),s=this._axisMark.getComponent(),l=XF(T({},this.getLayoutStartPoint()),this._axisStyle,o,{line:{visible:!1}}),u=null==s?void 0:s.getBoundsWithoutRender(l);return u&&!u.empty()||(u=(new mi).set(l.x,l.y,l.x,l.y)),!0,this._latestBounds=u,n=this._appendAxisUnit(u,a)},i.prototype.positionToData=function(t,e){var i=uj(this.getOrient());e&&(t-=i?this.getLayoutStartPoint().x:this.getLayoutStartPoint().y),this._innerOffset&&(t=i?Xt(t,this._innerOffset.left,this.getLayoutRect().width-this._innerOffset.right):Xt(t,this._innerOffset.top,this.getLayoutRect().height-this._innerOffset.bottom));var n=this._scale.range();return(t-n[0])*(t-At(n))>0?null:this._scale.invert(t)},i.prototype._getTitleLimit=function(t){var e,i,n,r,a,o=this._spec.title;if(o.visible&&j(null===(e=o.style)||void 0===e?void 0:e.maxLineWidth)){var s=null!==(a=null!==(n=null===(i=this._axisStyle.title)||void 0===i?void 0:i.angle)&&void 0!==n?n:null===(r=o.style)||void 0===r?void 0:r.angle)&&void 0!==a?a:0;if(t){var l=this.getLayoutRect().width,u=Math.abs(Math.cos(s));return u<1e-6?1/0:l/u}var c=this.getLayoutRect().height,h=Math.abs(Math.sin(s));return h<1e-6?1/0:c/h}return null},i.prototype._getUpdateAttribute=function(t){var e=0,i=0;if(!t){var n=SU(this.getRegions());i=n.width,e=n.height}var r=this.getLayoutRect(),a=r.width,o=r.height,s=uj(this._orient),l=cj(this._orient),u={x:0,y:0},c=e,h=a;s?u={x:a,y:0}:l&&(u={x:0,y:o},c=i,h=o);var d=this.getLabelItems(h),p={start:{x:0,y:0},end:u,title:{text:this._spec.title.text||this._dataFieldText,maxWidth:this._getTitleLimit(s)},items:d,scale:this._scale.clone()};t||(p.grid={type:"line",start:{x:0,y:0},end:u,items:d[0],verticalFactor:this._axisStyle.verticalFactor,length:c});var f=s?this.layout.minHeight:this.layout.minWidth;return(s&&9===this._layout.layoutRectLevelMap.height||l&&9===this._layout.layoutRectLevelMap.width)&&(f=this._verticalLimitSize),p.verticalLimitSize=this._verticalLimitSize,p.verticalMinSize=f,p.label={overflowLimitLength:this._getLabelOverflowLimit(s)},this._afterUpdateAttribute?this._afterUpdateAttribute(p,t):p},i.prototype.getLabelItems=function(t){var e,i=this,n=null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData();return n&&n.length?[n.map((function(e){var n=i._getNormalizedValue([e.value],t);return Zj(e.value,n)})).filter((function(t){var e=t.value,n=t.rawValue,r=i._scale.domain();return"log"===i.getSpec().type?e>=0&&e<=1:JR(i._scale.type)?n>=r[0]&&n<=At(r):r.includes(n)}))]:[]},i.prototype.initEvent=function(){var i=this;e.prototype.initEvent.call(this),this.visible&&(this.event.on(t.ChartEvent.layoutEnd,this._updateAxisLayout),this.event.on(t.ChartEvent.layoutEnd,this._fixAxisOnZero),this.event.on(t.ChartEvent.layoutRectUpdate,(function(){i._clearLayoutCache()})))},i.prototype._getNormalizedValue=function(t,e){return 0===e?0:this.dataToPosition(t)/e},i.prototype._layoutCacheProcessing=function(t){var e=this;return["width","height"].forEach((function(i){t[i]<e._layoutCache[i]?t[i]=e._layoutCache[i]:e._layoutCache[i]=t[i]})),this._autoIndentOnce&&this._hasAutoIndent?["x1","x2","y1","y2"].forEach((function(t){e.layout.getLastComputeOutBounds()[t]=e._layoutCache._lastComputeOutBounds[t]})):(this._hasAutoIndent=!0,["x1","x2","y1","y2"].forEach((function(t){e.layout.getLastComputeOutBounds()[t]<e._layoutCache._lastComputeOutBounds[t]?e.layout.getLastComputeOutBounds()[t]=e._layoutCache._lastComputeOutBounds[t]:e._layoutCache._lastComputeOutBounds[t]=e.layout.getLastComputeOutBounds()[t]}))),t},i.prototype.reInit=function(t){e.prototype.reInit.call(this,t),this._clearLayoutCache()},i.prototype._clearLayoutCache=function(){this._hasAutoIndent=!1,this._layoutCache.width=0,this._layoutCache.height=0,this._layoutCache._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0}},i.prototype.onDataUpdate=function(){this._clearLayoutCache()},i.prototype._appendAxisUnit=function(t,e){var i;if(this._spec.unit&&this._spec.unit.visible){var n=this._spec.unit,r=n.text,a=n.style,o=void 0,s=void 0,l=this.getLayoutStartPoint(),u=l.x,c=l.y;e?(o={x:Mt(this._scale.range())+u,y:c},s={textAlign:"left",textBaseline:"middle"}):(o={x:u,y:Tt(this._scale.range())+c},s={textAlign:"left"===this._orient?"left":"right",textBaseline:"bottom"}),s=T(T(T({},s),a),{x:o.x,y:o.y,text:r}),this._unitText?this._unitText.setAttributes(s):(this._unitText=Iv(s),this._unitText.name="axis-unit",null===(i=this.getContainer())||void 0===i||i.add(this._unitText));var h=this._unitText.AABBBounds;e?(t.x2+=h.x2>t.x2?h.x2-t.x2:0,t.y2+=h.y2>t.y2?h.y2-t.y2:0):(t.x1+=h.x1<t.x1?h.x1-t.x1:0,t.y1+=h.y1<t.y1?h.y1-t.y1:0)}return t},i.prototype._getNeedClearVRenderComponents=function(){return this._unitText?[this._unitText]:[]},i.prototype._getLabelOverflowLimit=function(t){var e,i;if(t&&!1!==(null===(e=this._spec.label)||void 0===e?void 0:e.visible)&&!0===(null===(i=this._spec.label)||void 0===i?void 0:i.autoLimit)){var n=this._option.getComponentsByKey("axes"),r=this.getRegions(),a=n.filter((function(t){var e=t.getOrient();return("left"===e||"right"===e)&&t.getRegions().some((function(t){return r.includes(t)}))})),o=0,s=0,l=this.getLayoutStartPoint().x,u=l+this.getLayoutRect().width;return a.forEach((function(t){var e=t.getLayoutStartPoint().x;if("left"===t.getOrient()&&e===l){var i=t.getLayoutRect().width;o=Math.max(o,i)}else if(e===u){var n=t.getLayoutRect().width;s=Math.max(s,n)}})),{left:o,right:s}}},i.type=I.cartesianAxis,i.specKey="axes",i}(xU),TU=function(t,e,i){return i.reduce((function(t,n,r){return t.push([n,i.length===r+1?e:i[r+1]]),t}),[[t,i[0]]])};function wU(t,e){var i=t[0],n=t[t.length-1],r=e.filter((function(t){return t>i&&t<n}));return 0===r.length?[[i,n]]:TU(i,n,r)}var CU=function(t,e){return t-e},EU=function(t,e){for(var i=[{count:0,sub:[],max:e[0],min:e[0]}],n=0,r=0;n<e.length;)t[r]<=e[n]?(i[n].count+=1,i[n].sub.push(t[r]),r+=1):i[n+=1]={count:0,sub:[],max:e[n],min:e[n]};i.forEach((function(t){t.count&&(t.min=Math.min.apply(null,t.sub))}));var a=t.slice(r);return i[n]={count:a.length,sub:a,min:e[e.length-1],max:Math.max.apply(null,a)},i};function PU(t,e,i){void 0===i&&(i="count");var n=EU(t,e),r="count"===i?t.length:n.reduce((function(t,e,i){return e.count>0?t+e.max-e.min:t}),0),a=[],o=0,s=0;return n.forEach((function(t,e){if(0===r)a.push([0,e/n.length-1]);else{var l="count"===i?t.count:t.max-t.min,u=a[s-1]?a[s-1][1]:0,c=e===n.length-1?1:Math.min((o+l)/r,1);(u!==c||0!==u&&1!==u)&&(s+=1,a.push([u,c]),o+=l)}})),a}var BU=Math.sqrt(50),RU=Math.sqrt(10),LU=Math.sqrt(2),IU=function(){function e(){this._extend={},this.niceLabelFormatter=null}return e.prototype.setExtraAttrFromSpec=function(){U(this._spec.nice)&&(this._nice=this._spec.nice),U(this._spec.zero)&&(this._zero=this._spec.zero),this._expand=this._spec.expand,this._domain=Xj(this._spec)},e.prototype.transformScaleDomain=function(){this.setScaleNice()},e.prototype.setLinearScaleNice=function(){var t;if(!this._nice)return!1;var e=5,i=this._spec.tick||{};if(et(i.forceTickCount))e=i.forceTickCount;else if(V(i.tickCount)){var n=this._scale.range(),r=Math.abs(At(n)-n[0]);if(1===r&&this._option)r=uj(this._orient)?this._option.getChartViewRect().width:this._option.getChartViewRect().height;e=i.tickCount({axisLength:r,labelStyle:this._spec.label&&this._spec.label.style})}else e=et(i.tickCount)?i.tickCount:5;"accurateFirst"===this._spec.niceType&&(e=Math.max(5,e));var a=null!==(t=this._domain)&&void 0!==t?t:{},o=a.min,s=a.max;return j(o)&&j(s)&&j(this._softMaxValue)&&j(this._softMinValue)?this._scale.nice(e):(U(o)||U(this._softMinValue))&&j(s)&&j(this._softMaxValue)?this._scale.niceMax(e):!(!j(o)||!j(this._softMinValue)||!U(s)&&!U(this._softMaxValue))&&this._scale.niceMin(e)},e.prototype.setLogScaleNice=function(){var t;if(!this._nice)return!1;var e=null!==(t=this._domain)&&void 0!==t?t:{},i=e.min,n=e.max;return j(i)&&j(n)&&j(this._softMaxValue)&&j(this._softMinValue)?this._scale.nice():(U(i)||U(this._softMinValue))&&j(n)&&j(this._softMaxValue)?this._scale.niceMax():!(!j(i)||!j(this._softMinValue)||!U(n)&&!U(this._softMaxValue))&&this._scale.niceMin()},e.prototype.setScaleNice=function(){return"log"===this._spec.type?this.setLogScaleNice():this.setLinearScaleNice()},e.prototype.dataToPosition=function(t,e){return this.valueToPosition(t[0])},e.prototype.valueToPosition=function(t){return this._scale.scale(t)},e.prototype.computeLinearDomain=function(t){var e=[];if(t.length){var i,n,r=this._spec.breaks&&this._spec.breaks.length,a=[];if(t.forEach((function(t){var e=t.min,o=t.max;i=void 0===i?e:Math.min(i,e),n=void 0===n?o:Math.max(n,o),r&&(a=a.concat(t.values))})),r){for(var o=[],s=[],l=j(this._domain.max)?n:this._domain.max,u=0;u<this._spec.breaks.length;u++){var c=this._spec.breaks[u].range;c[0]<=c[1]&&c[1]<=l&&(o.push(c),s.push(this._spec.breaks[u]))}if(o.sort((function(t,e){return t[0]-e[0]})),o.length){var h=function(t,e,i){return t.sort(CU),e.sort(CU),{domain:wU(t,e),scope:PU(t,e,i)}}(a,sx(o),this._spec.breaks[0].scopeType),d=h.domain,p=h.scope;e=sx(d),this._break={domain:d,scope:p,breakDomains:o,breaks:s}}else e=[i,n]}else e=[i,n]}else e[0]=0,e[1]=0;return this.setSoftDomainMinMax(e),this.expandDomain(e),this.includeZero(e),this.setDomainMinMax(e),e},e.prototype.expandDomain=function(t){if(this._expand){var e=t[0],i=At(t);e===i&&(0===i?i=1:i>0?e=0:i<0&&(i=0)),U(this._expand.min)&&(t[0]=e-(i-e)*this._expand.min),U(this._expand.max)&&(t[t.length-1]=i+(i-e)*this._expand.max)}},e.prototype.niceDomain=function(t){var e=Xj(this._spec),i=e.min,n=e.max;if(U(i)||U(n)||"linear"!==this._spec.type)return t;if(Math.abs(Tt(t)-Mt(t))<=1e-12){var r=t[0],a=r>=0?1:-1;if((r=Math.abs(r))<1)t[0]=0,t[t.length-1]=1;else{var o=r/5,s=Math.floor(Math.log(o)/Math.LN10),l=o/Math.pow(10,s);o=(l>=BU?10:l>=RU?5:l>=LU?2:1)*Math.pow(10,s),t[0]=0,t[t.length-1]=10*o}a<0&&(t.reverse(),t[0]*=-1,t[t.length-1]*=-1)}return t},e.prototype.includeZero=function(t){this._zero&&(t[0]=Math.min(t[0],0),t[t.length-1]=Math.max(At(t),0))},e.prototype.setExtendDomain=function(e,i){if(void 0!==i){this._extend[e]=i;var n=this._scale.domain();if(this.extendDomain(n),this.includeZero(n),this.setDomainMinMax(n),this.niceDomain(n),this._scale.domain(n,this._nice),this._nice)!this.setScaleNice()&&this._scale.rescale();this.event.emit(t.ChartEvent.scaleUpdate,{model:this,value:"domain"})}else delete this._extend[e]},e.prototype.extendDomain=function(t){var e,i=t.length-1,n=t[0]-t[i]>0,r=n?i:0,a=n?0:i;for(var o in this._extend)(e=this._extend[o])>t[a]&&(t[a]=e),e<t[r]&&(t[r]=e)},e.prototype.getDomainSpec=function(){return this._domain},e.prototype.setDomainMinMax=function(t){if(this._domain){var e=this._domain,i=e.min,n=e.max;U(i)&&(t[0]=i),U(n)&&(t[t.length-1]=n)}},e.prototype.setSoftDomainMinMax=function(t){var e=this._spec,i=e.softMin,n=e.softMax;if(U(i)){var r=V(i)?i(t):i;j(r)&&(r=t[0]),r<=t[0]&&(t[0]=r,this._softMinValue=r)}if(U(n)){var a=V(n)?n(t):n;j(a)&&(a=At(t)),a>=At(t)&&(t[t.length-1]=a),this._softMaxValue=a}},e.prototype.setZero=function(t){this._zero!==t&&(this._zero=t,this.updateScaleDomain())},e.prototype.updateScaleDomain=function(){if(this.isSeriesDataEnable()){var t=this.collectData(),e=this.computeLinearDomain(t);this.updateScaleDomainByModel(e)}},e.prototype.updateScaleDomainByModel=function(e){(e=null!=e?e:this._scale.domain(),this.extendDomain(e),this.includeZero(e),this.setDomainMinMax(e),this.niceDomain(e),this._scale.domain(e,this._nice),this._nice)&&(!this.setScaleNice()&&this._scale.rescale());this._updateNiceLabelFormatter(e),this._domainAfterSpec=this._scale.domain(),this.event.emit(t.ChartEvent.scaleDomainUpdate,{model:this}),this.event.emit(t.ChartEvent.scaleUpdate,{model:this,value:"domain"})},e.prototype.getDomainAfterSpec=function(){return this._domainAfterSpec},e.prototype._updateNiceLabelFormatter=function(t){var e=Math.abs(At(t)-t[0]),i=Math.max(-Math.floor(Math.log10(e)),0)+2,n=Math.pow(10,i);this.niceLabelFormatter=function(t){return et(+t)?Math.round(+t*n)/n:t}},e}(),DU={domainLine:{visible:!1},grid:{visible:!0},subGrid:{visible:!1},tick:{visible:!1},subTick:{visible:!1}},OU={label:{space:8},title:{space:8},maxHeight:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}},FU={label:{space:12,autoLimit:!0},title:{space:12,autoRotate:!0},maxWidth:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}},zU={domainLine:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,inside:!1,tickSize:4,alignWithLabel:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},subTick:{visible:!1,tickSize:2,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},label:{visible:!0,inside:!1,space:10,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}},title:{space:10,padding:0,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor"},fontWeight:"normal",fillOpacity:1}}},HU=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=I.cartesianLinearAxis,e._zero=!0,e._nice=!0,e._extend={},e._scale=new UL,e}return M(e,t),e.prototype.setAttrFromSpec=function(){var e,i,n=this;t.prototype.setAttrFromSpec.call(this),this.setExtraAttrFromSpec();var r=null===(i=null===(e=this._tickData)||void 0===e?void 0:e[0])||void 0===i?void 0:i.getDataView().transformsArr.find((function(t){return t.type===n.registerTicksTransform()}));r&&(r.options=this._tickTransformOption())},e.prototype.initScales=function(){var e,i;t.prototype.initScales.call(this);var n=[0,1];U(null===(e=this._domain)||void 0===e?void 0:e.min)&&(n[0]=this._domain.min),U(null===(i=this._domain)||void 0===i?void 0:i.max)&&(n[1]=this._domain.max),this._scale.domain(n)},e.prototype._tickTransformOption=function(){var e,i=this;return T(T({},t.prototype._tickTransformOption.call(this)),{breakData:(null===(e=this._spec.breaks)||void 0===e?void 0:e.length)?function(){return i._break}:null})},e.prototype._getUpdateAttribute=function(e){var i,n,r=this,a=t.prototype._getUpdateAttribute.call(this,e);if(!hj(this._orient)&&(null===(n=null===(i=this._break)||void 0===i?void 0:i.breaks)||void 0===n?void 0:n.length)){var o=this.getLayoutRect(),s=o.width,l=o.height,u=uj(this._orient),c=u?s:l;a.breaks=this._break.breaks.map((function(t){var e,i=t.range,n=t.breakSymbol,a=t.gap,o=void 0===a?6:a,s=r.valueToPosition((i[0]+i[1])/2)/c;e=EF(o)?Number(o.substring(0,o.length-1))/100:o/c;var l=et(null==n?void 0:n.angle)?n.angle:u?60:15;return{range:[s-e/2,s+e/2],breakSymbol:T(T({visible:!0},n),{angle:l*Math.PI/180}),rawRange:i}}))}return a},e.prototype.getNewScaleRange=function(){var e,i,n=t.prototype.getNewScaleRange.call(this);return(null===(e=this._spec.breaks)||void 0===e?void 0:e.length)&&(null===(i=this._break)||void 0===i?void 0:i.scope)&&(n=sx(this._break.scope).map((function(t){return n[0]+(At(n)-n[0])*t}))),n},e.prototype.computeDomain=function(t){return this.computeLinearDomain(t)},e.prototype.axisHelper=function(){var e=t.prototype.axisHelper.call(this);return e.setExtendDomain=this.setExtendDomain.bind(this),e.valueToPosition=this.valueToPosition.bind(this),e},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return kH(this._option.dataSet,t,tI),t},e.type=I.cartesianLinearAxis,e.specKey="axes",e.builtInTheme={axis:zU,axisLinear:DU,axisX:OU,axisY:FU},e}(MU);kt(HU,IU);var NU=function(){KF.registerGraphicComponent(pU.lineAxis,(function(t,e){return new zR(t,e)})),KF.registerGraphicComponent(fU.lineAxisGrid,(function(t,e){return new $I(t,e)})),kU(),KF.registerComponent(HU.type,HU)},VU=function(){function e(){this._rawDomainIndex=[]}return e.prototype._initData=function(){var t,e=this;if(this._spec.showAllGroupLayers&&this._scales.length>1)for(var i=function(i){var r=(null!==(t=n._spec.layers)&&void 0!==t?t:[])[n._scales.length-1-i]||{};if(!1!==r.visible&&0!==r.tickCount&&0!==r.forceTickCount){var a=n._initTickDataSet(T(T({},n._tickTransformOption()),r),i),o=new wN(n._option,a);n._tickData.push(o),a.target.addListener("change",(function(){e._onTickDataChange(o)})),n._tickDataMap||(n._tickDataMap={}),n._tickDataMap[i]=o}},n=this,r=0;r<this._scales.length;r++)i(r);else{var a=this._initTickDataSet(this._tickTransformOption()),o=new wN(this._option,a);a.target.addListener("change",(function(){e._onTickDataChange(o)})),this._tickData=[o],this._tickDataMap={0:o}}},e.prototype._updateData=function(){var t,e,i,n=this,r=this.registerTicksTransform();if(this._spec.showAllGroupLayers&&this._scales.length>1){var a=null!==(t=this._spec.layers)&&void 0!==t?t:[];Object.keys(this._tickDataMap).forEach((function(t){var e=a[n._scales.length-1-+t]||{},i=n._tickDataMap[t],o=null==i?void 0:i.getDataView().transformsArr.find((function(t){return t.type===r}));o&&(o.options=T(T({},n._tickTransformOption()),e))}))}else{var o=null===(i=null===(e=this._tickData)||void 0===e?void 0:e[0])||void 0===i?void 0:i.getDataView().transformsArr.find((function(t){return t.type===r}));o&&(o.options=this._tickTransformOption())}},e.prototype.dataToPosition=function(t,e){var i,n;if(void 0===e&&(e={}),0===t.length||0===this._scales.length)return 0;var r=this.getPosition(t);return r.position+r.bandScale.bandwidth()*(null!==(n=null!==(i=e.bandPosition)&&void 0!==i?i:this._spec.bandPosition)&&void 0!==n?n:this._defaultBandPosition)},e.prototype.valueToPosition=function(t){return this._scale.scale(t)},e.prototype.updateGroupScaleRange=function(){var t=this._scale;this._scales.forEach((function(e,i){i>0&&(e.range([0,t.bandwidth()]),t=e)}))},e.prototype.getPosition=function(t){var e=0,i=this._scale;if(1===this._scales.length||1===t.length)e=this.valueToPosition(t[0]);else{for(var n=Math.min(t.length,this._scales.length),r=0;r<n;r++)e+=this._scales[r].scale(t[r]);i=this._scales[n-1]}return{position:e,bandScale:i}},e.prototype.calcScales=function(t,e){for(var i,n,r=this._spec,a=r.bandPadding,o=r.paddingInner,s=r.paddingOuter,l=q(a),u=q(o),c=q(s),h=0;h<this._scales.length;h++){var d=l?a[h]:a,p=u?o[h]:o,f=c?s[h]:s;this._scales[h].paddingInner(null!==(i=null!=p?p:d)&&void 0!==i?i:t,!0).paddingOuter(null!==(n=null!=f?f:d)&&void 0!==n?n:e,!0)}},e.prototype.computeBandDomain=function(t){if(!t.length)return[];if(1===t.length)return t[0].values;for(var e=new Set,i=0;i<t.length;i++)for(var n=0;n<t[i].values.length;n++)e.add(t[i].values[n]);return Array.from(e)},e.prototype.updateScaleDomain=function(){var e,i=this;if(this.isSeriesDataEnable()){!(null===(e=this._rawDomainIndex)||void 0===e?void 0:e.length)&&this._scales.length&&this._updateRawDomain();for(var n=this._spec.domain,r=function(t){if(n&&n.length&&0===t)a._scales[t].domain(n);else{var e=a.collectData(t),r=a.computeBandDomain(e);a._scales[t].domain(r.sort((function(e,n){return i._rawDomainIndex[t][e]-i._rawDomainIndex[t][n]})))}},a=this,o=0;o<this._scales.length;o++)r(o);this.transformScaleDomain(),this.event.emit(t.ChartEvent.scaleDomainUpdate,{model:this}),this.event.emit(t.ChartEvent.scaleUpdate,{model:this,value:"domain"})}},e.prototype.getLabelItems=function(t){var e=this,i=[],n=[];return(this._spec.showAllGroupLayers?this._scales:[this._scales[0]]).forEach((function(r,a){var o,s=e._tickDataMap[a],l=null===(o=null==s?void 0:s.getLatestData())||void 0===o?void 0:o.length,u=l?s.getLatestData().map((function(t){return t.value})):r.domain();if(u&&u.length)if(n&&n.length){var c=[],h=[];n.forEach((function(i){u.forEach((function(n){var r=St(i).concat(n);if(h.push(r),l){var a=Zj(n,e._getNormalizedValue(r,t));c.push(a)}}))})),l&&i.push(c.filter((function(t){return t.value>=0&&t.value<=1}))),n=h}else u.forEach((function(t){n.push(t)})),l&&i.push(s.getLatestData().map((function(i){return Zj(i.value,e._getNormalizedValue([i.value],t))})).filter((function(t){return t.value>=0&&t.value<=1})))})),i.reverse()},e.prototype._updateRawDomain=function(){var t=this;this._rawDomainIndex=[];for(var e=this._spec.domain,i=function(i){if(e&&e.length&&0===i)n._scales[i].domain(e);else{var r=n.collectData(i,!0),a=n.computeBandDomain(r);n._rawDomainIndex[i]={},a.forEach((function(e,n){return t._rawDomainIndex[i][e]=n}))}},n=this,r=0;r<this._scales.length;r++)i(r)},e.prototype._clearRawDomain=function(){this._rawDomainIndex=[]},e}(),jU={domainLine:{visible:!0},grid:{visible:!1},subGrid:{visible:!1},tick:{visible:!0},subTick:{visible:!1}},UU=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=I.cartesianBandAxis,e._scale=new kL,e}return M(e,t),e.prototype.computeDomain=function(t){return this.computeBandDomain(t)},e.prototype.updateScaleRange=function(){var e=t.prototype.updateScaleRange.call(this);return this.updateGroupScaleRange(),e},e.prototype.initScales=function(){t.prototype.initScales.call(this),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)},e.prototype.axisHelper=function(){var t=this,e=function(e){return void 0===e&&(e=0),t._scales[e]};return{isContinuous:!1,dataToPosition:this.dataToPosition.bind(this),getScale:e,getBandwidth:function(t){return void 0===t&&(t=0),e(t).bandwidth()},getAxisType:function(){return t.type},getAxisId:function(){return t.id},isInverse:function(){return t._inverse},getSpec:function(){return t._spec}}},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return kH(this._option.dataSet,t,aI),t},e.prototype.transformScaleDomain=function(){this.updateFixedWholeLength()},e.prototype.updateFixedWholeLength=function(){if(this._scale){var t=this._getOuterBandSizeFromSpec(),e=t.bandSize,i=t.maxBandSize,n=t.minBandSize;if(e&&this._scale.bandwidth(e),i&&this._scale.maxBandwidth(i),n&&this._scale.minBandwidth(n),this._scale.isBandwidthFixed()&&this._spec.autoRegionSize&&(e||i)){var r=pL(this._scale.domain().length,null!=e?e:i,this._scale.paddingInner(),this._scale.paddingOuter());["bottom","top"].includes(this._orient)?this._regions.forEach((function(t){return t.setMaxWidth(r)})):["left","right"].includes(this._orient)&&this._regions.forEach((function(t){return t.setMaxHeight(r)}))}}},e.prototype._getOuterBandSizeFromSpec=function(){var t,e=this,i=this._spec,n=i.bandSize,r=i.maxBandSize,a=i.minBandSize,o=i.bandSizeLevel,s=void 0===o?0:o,l=null!==(t=this._spec.bandSizeExtend)&&void 0!==t?t:{},u=l.gap,c=l.extend,h=void 0===c?0:c;s=Math.min(s,this._scales.length-1);for(var d=function(t){var i=p._scales[t],o=i.domain(),l=i.paddingInner(),c=i.paddingOuter(),d=function(i){var n=t===s?h:0;return j(u)||t<s?pL(o.length,i,l,c)+n:(i+(K(u)?i*(Number(u.substring(0,u.length-1))/100):u))*o.length/(e._scales[t-1].paddingInner()+1)+n};U(n)&&(n=d(n)),U(r)&&(r=d(r)),U(a)&&(a=d(a))},p=this,f=s;f>0;f--)d(f);return{bandSize:n,maxBandSize:r,minBandSize:a}},e.prototype._compareSpec=function(e,i){var n=t.prototype._compareSpec.call(this,e,i);return n.reMake||(null==i?void 0:i.showAllGroupLayers)===(null==e?void 0:e.showAllGroupLayers)&&bt(null==i?void 0:i.layers,null==e?void 0:e.layers)||(n.reMake=!0),n},e.prototype.reInit=function(e){t.prototype.reInit.call(this),null==this||this._updateData()},e.type=I.cartesianBandAxis,e.specKey="axes",e.builtInTheme={axis:zU,axisBand:jU,axisX:OU,axisY:FU},e}(MU);kt(UU,VU);var WU=function(){KF.registerGraphicComponent(pU.lineAxis,(function(t,e){return new zR(t,e)})),KF.registerGraphicComponent(fU.lineAxisGrid,(function(t,e){return new $I(t,e)})),kU(),KF.registerComponent(UU.type,UU,!1)},GU=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=I.cartesianTimeAxis,e._zero=!1,e.effect={scaleUpdate:function(t){e.computeData(null==t?void 0:t.value),iF(e._regions,(function(t){uj(e.getOrient())?Jj(t.getXAxisHelper(),e.axisHelper(),U(e._seriesUserId)||U(e._seriesIndex))&&t.setXAxisHelper(e.axisHelper()):Jj(t.getYAxisHelper(),e.axisHelper(),U(e._seriesUserId)||U(e._seriesIndex))&&t.setYAxisHelper(e.axisHelper())}),{userId:e._seriesUserId,specIndex:e._seriesIndex})}},e}return M(e,t),e.prototype.setAttrFromSpec=function(){var e;t.prototype.setAttrFromSpec.call(this),this._tick=XF({},this._spec.tick,null===(e=this._spec.layers)||void 0===e?void 0:e[0])},e.prototype._initData=function(){var e;if(t.prototype._initData.call(this),null===(e=this._spec.layers)||void 0===e?void 0:e[1]){var i=new hs(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_layer_1_ticks")}).parse(this._scale,{type:"scale"}).transform({type:"".concat(this.type,"-ticks"),options:T(T({},this._tickTransformOption()),{tickCount:this._spec.layers[1].tickCount,forceTickCount:this._spec.layers[1].forceTickCount,tickStep:this._spec.layers[1].tickStep})},!1);this._layerTickData=new wN(this._option,i)}},e.prototype.computeData=function(e){t.prototype.computeData.call(this,e),this._layerTickData&&(this._layerTickData.getDataView().reRunAllTransform(),this._layerTickData.updateData())},e.prototype.created=function(){t.prototype.created.call(this),this._layerTickData&&(this._axisMark&&this._layerTickData.addRelatedMark(this._axisMark),this._gridMark&&this._layerTickData.addRelatedMark(this._gridMark))},e.prototype._getLabelFormatMethod=function(){var t,e,i,n,r,a,o,s,l=this,u=Xi.getInstance(),c=(null===(e=null===(t=this._spec.layers)||void 0===t?void 0:t[1])||void 0===e?void 0:e.timeFormat)||"%Y%m%d",h="local"===((null===(n=null===(i=this._spec.layers)||void 0===i?void 0:i[1])||void 0===n?void 0:n.timeFormatMode)||"local")?u.timeFormat:u.timeUTCFormat,d=(null===(a=null===(r=this._spec.layers)||void 0===r?void 0:r[0])||void 0===a?void 0:a.timeFormat)||"%Y%m%d",p="local"===((null===(s=null===(o=this._spec.layers)||void 0===o?void 0:o[0])||void 0===s?void 0:s.timeFormatMode)||"local")?u.timeFormat:u.timeUTCFormat;return function(t,e,i,n,r){var a,o;return o=0===r?p(d,t):h(c,t),(null===(a=l._spec.label)||void 0===a?void 0:a.formatMethod)?l._spec.label.formatMethod(o,e):o}},e.prototype.getLabelItems=function(t){var e,i,n=this,r=[],a=null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData();a&&a.length&&r.push(a.map((function(e){return Zj(e.value,n._getNormalizedValue([e.value],t))})));var o=null===(i=this._layerTickData)||void 0===i?void 0:i.getLatestData();return o&&o.length&&r.push(o.map((function(e){return Zj(e.value,n._getNormalizedValue([e.value],t))}))),r},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return kH(this._option.dataSet,t,tI),t},e.prototype.transformScaleDomain=function(){},e.type=I.cartesianTimeAxis,e.specKey="axes",e.builtInTheme={axis:zU,axisX:OU,axisY:FU},e}(HU),YU=function(){KF.registerGraphicComponent(pU.lineAxis,(function(t,e){return new zR(t,e)})),KF.registerGraphicComponent(fU.lineAxisGrid,(function(t,e){return new $I(t,e)})),kU(),KF.registerComponent(GU.type,GU)},XU=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=I.cartesianLogAxis,e._zero=!1,e._scale=new XL,e}return M(e,t),e.prototype.initScales=function(){var e;t.prototype.initScales.call(this),this._scale.base(null!==(e=this._spec.base)&&void 0!==e?e:10),this._scale.clamp(!0,null,!1)},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return kH(this._option.dataSet,t,tI),t},e.prototype.transformScaleDomain=function(){},e.type=I.cartesianLogAxis,e.specKey="axes",e.builtInTheme={axis:zU,axisLinear:DU,axisX:OU,axisY:FU},e}(HU);kt(XU,IU);var KU=function(){KF.registerGraphicComponent(pU.lineAxis,(function(t,e){return new zR(t,e)})),KF.registerGraphicComponent(fU.lineAxisGrid,(function(t,e){return new $I(t,e)})),kU(),KF.registerComponent(XU.type,XU)},qU=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=I.cartesianSymlogAxis,e._zero=!1,e._scale=new ZL,e}return M(e,t),e.prototype.initScales=function(){var e;t.prototype.initScales.call(this),this._scale.constant(null!==(e=this._spec.constant)&&void 0!==e?e:10)},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return kH(this._option.dataSet,t,tI),t},e.prototype.transformScaleDomain=function(){},e.type=I.cartesianSymlogAxis,e.specKey="axes",e.builtInTheme={axis:zU,axisLinear:DU,axisX:OU,axisY:FU},e}(HU);kt(qU,IU);var ZU=function(){KF.registerGraphicComponent(pU.lineAxis,(function(t,e){return new zR(t,e)})),KF.registerGraphicComponent(fU.lineAxisGrid,(function(t,e){return new $I(t,e)})),kU(),KF.registerComponent(qU.type,qU)},JU="".concat(mz,"_hide_");function QU(t,e){t.context.finalAttrs&&(t.context.finalAttrs.visible=e)}var $U=function(t,e){if(!e||0===e.length)return e;var i=t.direction,n=t.delta,r=t.deltaMul,a=void 0===r?1:r,o=t.groupBy,s=function(e){!function(t){t.forEach((function(t){t[JU]&&(QU(t,!0),t[JU]=!1)}))}(e);var r=t.sort?e.slice().sort((function(t,e){return t.context.finalAttrs.x-e.context.finalAttrs.x})):e;0===i?function(t,e,i){var n=-1/0,r=0,a=j(e),o=e;t.forEach((function(t){if(!1!==t.context.finalAttrs.visible){var e=t.context.finalAttrs.size/2,s=t.context.finalAttrs,l=s.x,u=s.y;a&&(o=(e+r)*i),Math.pow(-1/0-l,2)+Math.pow(n-u,2)<Math.pow(o+r+e,2)?t.context.finalAttrs.forceShow||(t[JU]=!0,QU(t,!1)):n=u,r=e}}))}(r,n,a):1===i?function(t,e,i){var n=-1/0,r=0,a=j(e),o=e;t.forEach((function(t){if(!1!==t.context.finalAttrs.visible){var e=t.context.finalAttrs.size/2,s=t.context.finalAttrs.x;a&&(o=(e+r)*i),Math.abs(s-n)<o+r+e?t.context.finalAttrs.forceShow||(t[JU]=!0,QU(t,!1)):n=s,r=e}}))}(r,n,a):function(t,e,i){var n=-1/0,r=0,a=j(e),o=e;t.forEach((function(t){if(!1!==t.context.finalAttrs.visible){var e=t.context.finalAttrs.size/2,s=t.context.finalAttrs.y;a&&(o=(e+r)*i),Math.abs(s-n)<o+r+e?t.context.finalAttrs.forceShow||(t[JU]=!0,QU(t,!1)):n=s,r=e}}))}(r,n,a)};if(o){var l=e.reduce((function(t,e){var i,n,r=null===(n=null===(i=e.context.data)||void 0===i?void 0:i[0])||void 0===n?void 0:n[o];return t[r]?t[r].push(e):t[r]=[e],t}),{});Object.keys(l).forEach((function(t){s(l[t])}))}else s(e);return e},tW=function(){KF.registerGrammarTransform("symbolOverlap",{transform:$U,runType:"afterEncode"})},eW={min:Tt,max:Mt,average:JO,sum:ZO};function iW(t,e,i,n){var r,a,o,s=Math.floor(e.length/t),l=[],u=e.length,c=0,h=0;l[h++]=c;for(var d=1;d<u-1;d+=s){for(var p=Math.min(d+s,u-1),f=Math.min(d+2*s,u),v=(f+p)/2,g=0,y=p;y<f;y++){var m=e[y][n];Number.isNaN(m)||(g+=m)}g/=f-p;var _=d,b=Math.min(d+s,u),x=d-1,k=e[c][n];r=-1,o=_;for(y=_;y<b;y++){m=e[y][n];Number.isNaN(n)||(a=Math.abs((x-v)*(m-k)-(x-y)*(g-k)))>r&&(r=a,o=y)}l[h++]=o,c=o}l[h-1]!==u-1&&(l[h++]=u-1);var S=l.map((function(t){return i?e[t].i:t}));return S}function nW(t,e,i,n,r){var a=Math.floor(e.length/t),o=[],s=e.length,l=0,u=[];o.push(l),e[l][r]=e[l][r];for(var c=1;c<s-1;c+=a){a>s-c&&(a=s-c,u.length=a),u=[];for(var h=0;h<a;h++)u.push(e[c+h][r]);var d=eW[n](u);l=Math.min(Math.round(c+u.length/2)||0,s-1),e[l][r]=d,o.push(l)}var p=o.map((function(t){return i?e[t].i:t}));return p}function rW(t,e,i,n){return nW(t,e,i,"min",n)}function aW(t,e,i,n){return nW(t,e,i,"max",n)}function oW(t,e,i,n){return nW(t,e,i,"average",n)}function sW(t,e,i,n){return nW(t,e,i,"sum",n)}var lW=function(t,e){var i,n,r=V(t.size)?t.size():t.size,a=t.factor||1;if(Array.isArray(r)&&(r=Math.floor(r[1]-r[0])),(r*=a)<=0)return[];if(e.length<=r)return e;if(t.skipfirst)return e.slice(0,1);var o=t.mode,s=t.yfield,l=t.groupBy,u=null!=s?s:"y",c=iW;if("min"===o?c=rW:"max"===o?c=aW:"average"===o?c=oW:"sum"===o&&(c=sW),e.length){var h={};if(l){for(var d=0,p=e.length;d<p;d++){var f=e[d],v=f[l];h[v]?h[v].push(((i={})[u]=f[u],i.i=d,i)):(h[v]=[],h[v].push(((n={})[u]=f[u],n.i=d,n)))}var g=[];return Object.keys(h).forEach((function(t){var i=h[t];if(i.length<=r){var n=i.map((function(t){return t.i}));g=g.concat(n)}else{n=c(r,i,!0,u);g=g.concat(n),i.forEach((function(t){return e[t.i][u]=t[u]}))}})),g.sort((function(t,e){return t-e})),g.map((function(t){return e[t]}))}return c(r,e,!1,u).map((function(t){return e[t]}))}return[]},uW=function(){KF.registerGrammarTransform("dataSampling",{transform:lW})},cW={label:{visible:!1,position:"top",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}},hW=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.line,i.transformerConstructor=Dj,i._sortDataByAxis=!1,i}return M(i,e),i.prototype.compile=function(){e.prototype.compile.call(this),this.addSamplingCompile(),this.addOverlapCompile()},i.prototype.initMark=function(){var t,e=null!==(t=this._spec.seriesMark)&&void 0!==t?t:"line";this.initLineMark("line"===e),this.initSymbolMark("point"===e)},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this);var t=this._tooltipHelper.activeTriggerSet,i=t.group,n=t.mark;this._lineMark&&i.add(this._lineMark),this._symbolMark&&(n.add(this._symbolMark),i.add(this._symbolMark))},i.prototype.initMarkStyle=function(){this.initLineMarkStyle(this._direction),this.initSymbolMarkStyle()},i.prototype.initAnimation=function(){var t,e,i,n,r={direction:this.direction},a=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;if(this._lineMark.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("line"))||void 0===i?void 0:i(r,a),ZV("line",this._spec,this._markAttributeContext))),this._symbolMark){var o=sj(this);this._symbolMark.setAnimationConfig(qV(null===(n=KF.getAnimationInKey("scaleInOut"))||void 0===n?void 0:n(),ZV("point",this._spec,this._markAttributeContext),o))}},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this.reCompileSampling()},i.prototype.getSeriesStyle=function(t){var e,i=this,n="point"!==(null===(e=this._spec)||void 0===e?void 0:e.seriesMark);return function(e){var r,a;return n&&"fill"===e&&(e="stroke"),null!==(a=null===(r=i._seriesMark)||void 0===r?void 0:r.getAttribute(e,t))&&void 0!==a?a:void 0}},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[this._lineMark,this._symbolMark]},i.type=t.SeriesTypeEnum.line,i.mark=wj,i.builtInTheme={line:cW},i.transformerConstructor=Dj,i}(lj);kt(hW,Tj);var dW,pW=function(){uW(),tW(),Rj(),Ij(),qN(),YN(),WU(),NU(),KF.registerSeries(hW.type,hW)},fW=function(){function t(t){this._dataArr=[],this._dataSet=t}return Object.defineProperty(t.prototype,"dataList",{get:function(){return this._dataArr},enumerable:!1,configurable:!0}),t.prototype.parseData=function(t){this._dataArr=[];for(var e=St(t),i=0;i<e.length;i++)this._dataArr.push(OH(e[i],this._dataSet,this._dataArr))},t.prototype.updateData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!0);var n=St(t);return(!e||n.length===this._dataArr.length)&&(this._dataValueForEach(n,(function(t,e){e.markRunning()})),this._dataValueForEach(n,(function(t,e){FH(e,t,i)})),!0)},t.prototype._dataValueForEach=function(t,e){var i=this;t.forEach((function(t,n){if(!(t instanceof hs)){var r=i.getSeriesData(t.id,n);r&&e(t,r,n)}}))},t.prototype.getSeriesData=function(t,e){if(!this._dataArr.length)return null;if("string"==typeof t){var i=this._dataArr.filter((function(e){return e.name===t}));if(i[0])return i[0];cx("no data matches dataId ".concat(t,"!"))}if("number"==typeof e){if(this._dataArr[e])return this._dataArr[e];cx("no data matches dataIndex ".concat(e,"!"))}return this._dataArr[0]},t}(),vW=function(){function t(t,e){var i=this;this._scaleSpecMap=new Map,this._scaleMap=new Map,this._modelScaleSpecMap=new Map,this._markAttributeScaleMap=new Map,this._spec=null,this._chart=null,this.getStatisticalFields=function(t){var e=[];return i._scaleSpecMap.forEach((function(i,n){xx(i.domain)&&i.domain.forEach((function(n){n.dataId===t&&n.fields.forEach((function(t){Wz(e,[{key:t,operations:JR(i.type)?["max","min"]:["values"]}])}))}))})),i._markAttributeScaleMap.forEach((function(n,r){var a=i.getScale(r);n.forEach((function(n){i._getSeriesBySeriesId(n.seriesId).getRawData().name===t&&n.field&&Wz(e,[{key:n.field,operations:JR(a.type)?["max","min"]:["values"]}])}))})),e},this._spec=t,this._chart=e,this._setAttrFromSpec()}return t.prototype._createFromSpec=function(t){if(!t.id)return null;var e=this._scaleMap.get(t.id);return e||(e="ordinal"===t.type&&"color"===t.id?SF("colorOrdinal"):SF(t.type)),e?(q(t.range)&&e.range(t.range),q(t.domain)&&(xx(t.domain)||e.domain(t.domain)),t.specified&&e.specified&&e.specified(t.specified),t.clamp&&e.clamp&&e.clamp(t.clamp),e):null},t.prototype._setAttrFromSpec=function(){var t,e=this;if(null===(t=this._spec)||void 0===t?void 0:t.length){var i=new Map,n=new Map;this._spec.forEach((function(t){var r=e._createFromSpec(t);r&&(i.set(t.id,r),n.set(t.id,t))})),this._modelScaleSpecMap.forEach((function(t){var r=e._createFromSpec(t);r&&(i.set(t.id,r),n.set(t.id,t))})),this._scaleSpecMap=n,this._scaleMap=i}},t.prototype.updateSpec=function(t){var e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(bt(t,this._spec))return e;e.change=!0;for(var i=function(i){var r=t[i],a=n._scaleMap.get(r.id);if(!a)return e.reMake=!0,{value:e};var o=n._spec.find((function(t){return t.id===r.id}));return o.id?o.type!==r.type?(e.reMake=!0,{value:e}):bt(o.specified,r.specified)?(r.range&&!bt(r.range,a.range())&&(a.range(r.range),e.reRender=!0),xx(r.domain)?e.reRender=!0:bt(r.domain,a.domain())||(a.domain(r.domain),e.reRender=!0),void n._scaleSpecMap.set(r.id,r)):(e.reMake=!0,{value:e}):(e.reMake=!0,{value:e})},n=this,r=0;r<t.length;r++){var a=i(r);if("object"==typeof a)return a.value}return this._spec=t,e},t.prototype.registerModelScale=function(t){var e=this._createFromSpec(t);e&&(this._modelScaleSpecMap.set(t.id,t),this._scaleSpecMap.set(t.id,t),this._scaleMap.set(t.id,e))},t.prototype.removeModelScale=function(t){var e=this;this._modelScaleSpecMap.forEach((function(i){t(i)&&(e._modelScaleSpecMap.delete(i.id),e._scaleSpecMap.delete(i.id),e._scaleMap.delete(i.id))}))},t.prototype.getScale=function(t){return this._scaleMap.get(t)},t.prototype.getScaleSpec=function(t){return this._scaleSpecMap.get(t)},t.prototype._getSeriesByRawDataId=function(t){for(var e=this._chart.getAllSeries(),i=0;i<e.length;i++){var n=e[i];if(n.getRawData().name===t)return n}return null},t.prototype._getSeriesBySeriesId=function(t){for(var e=this._chart.getAllSeries(),i=0;i<e.length;i++){var n=e[i];if(n.id===t)return n}return null},t.prototype.updateScaleDomain=function(t){var e=this;this._scaleSpecMap.forEach((function(i,n){var r=e._scaleMap.get(n);if(r){if(!xx(i.domain))return i.domain&&0!==i.domain.length||r.domain(t),void e._updateMarkScale(n,r,r.domain().slice());var a;a=JR(i.type)?[null,null]:new Set,i.domain.forEach((function(t){var n=e._getSeriesByRawDataId(t.dataId);if(n){var r=JR(i.type);t.fields.forEach((function(t){var e=n.getRawDataStatisticsByField(t,r);e&&(r?(j(a[0])?a[0]=e.min:a[0]=Math.min(e.min,a[0]),j(a[1])?a[1]=e.max:a[1]=Math.max(e.max,a[1])):e.values.forEach((function(t){a.add(t)})))}))}}));var o=a;JR(i.type)||(a=Array.from(a)),r.domain(a),e._updateMarkScale(n,r,o)}}))},t.prototype._updateMarkScale=function(t,e,i){var n=this,r=this._markAttributeScaleMap.get(t);r&&0!==r.length&&r.forEach((function(t){if(t.field&&t.markScale&&t.markScale!==e)if(j(t.changeDomain)||"none"===t.changeDomain||j(t.seriesId))JR(e.type)?t.markScale.domain(i):e.domain(Array.from(i));else{var r=n._getSeriesBySeriesId(t.seriesId),a=JR(e.type),o=r.getRawDataStatisticsByField(t.field,a);if(!lt(o))return"expand"===t.changeDomain?(a?(i[0]=Math.min(i[0],o.min),i[1]=Math.max(i[1],o.max)):(o.values.forEach((function(t){i.add(t)})),i=Array.from(i)),void t.markScale.domain(i)):void("replace"!==t.changeDomain||(a?t.markScale.domain([o.min,o.max]):t.markScale.domain(o.values)));JR(e.type)?t.markScale.domain(i):e.domain(Array.from(i))}}))},t.prototype.registerMarkAttributeScale=function(t,e){var i=this._scaleMap.get(t.scale),n=this._markAttributeScaleMap.get(t.scale);n||(n=[],this._markAttributeScaleMap.set(t.scale,n));var r=i;return(j(t.field)||!j(t.changeDomain)&&"none"!==t.changeDomain&&!j(e))&&(r=i.clone()),n.push(T(T({},t),{seriesId:e,markScale:r})),r},t}(),gW=function(){function t(){this._stateGraphicsByTrigger=new Map,this._disableTriggerEvent=!1,this._triggerMapByState=new Map}return t.prototype.setDisableActiveEffect=function(t){this._disableTriggerEvent=t},t.prototype.addTrigger=function(t){var e=this;t&&[t.getStartState(),t.getResetState()].forEach((function(i){if(i){var n=e._triggerMapByState.get(i);n?!n.includes(t)&&n.push(t):e._triggerMapByState.set(i,[t])}}))},t.prototype.setStatedGraphics=function(t,e){this._stateGraphicsByTrigger.set(t,e)},t.prototype.getStatedGraphics=function(t){return this._stateGraphicsByTrigger.get(t)},t.prototype.updateStates=function(t,e,i,n,r){return this._disableTriggerEvent?[]:e&&e.length?(n&&r?i&&i.length?(this.toggleReverseStateOfGraphics(t,e,i,r),this.toggleStateOfGraphics(t,e,i,n)):this.addBothStateOfGraphics(t,e,n,r):n&&(i&&i.length?this.toggleStateOfGraphics(t,e,i,n):this.addStateOfGraphics(t,e,n)),e):[]},t.prototype.toggleReverseStateOfGraphics=function(t,e,i,n){var r=t.getMarkIdByState();i.forEach((function(t){var e;if(n&&r[n]&&r[n].includes(t.context.markId)){var i=null===(e=t.parent)||void 0===e?void 0:e.mark,a=i.hasAnimationByState&&i.hasAnimationByState("state");t.addState(n,!0,a)}})),e.forEach((function(t){var e;if(n&&r[n]&&r[n].includes(t.context.markId)){var i=null===(e=t.parent)||void 0===e?void 0:e.mark,a=i.hasAnimationByState&&i.hasAnimationByState("state");t.removeState(n,a)}}))},t.prototype.toggleStateOfGraphics=function(t,e,i,n){var r=t.getMarkIdByState();i.forEach((function(t){var e;if(n&&r[n]&&r[n].includes(t.context.markId)){var i=null===(e=t.parent)||void 0===e?void 0:e.mark,a=i.hasAnimationByState&&i.hasAnimationByState("state");t.removeState(n,a)}})),e.forEach((function(t){var e;if(n&&r[n]&&r[n].includes(t.context.markId)){var i=null===(e=t.parent)||void 0===e?void 0:e.mark,a=i.hasAnimationByState&&i.hasAnimationByState("state");t.addState(n,!0,a)}}))},t.prototype.addBothStateOfGraphics=function(t,e,i,n){var r=t.getMarks(),a=t.getMarkIdByState();r.forEach((function(t){var r,o=n&&a[n]&&a[n].includes(t.id),s=i&&a[i]&&a[i].includes(t.id);if(o||s){var l=t.hasAnimationByState&&t.hasAnimationByState("state");null===(r=t.getGraphics())||void 0===r||r.forEach((function(t){e&&e.includes(t)?s&&t.addState(i,!0,l):o&&t.addState(n,!0,l)}))}}))},t.prototype.addStateOfGraphics=function(t,e,i){var n=t.getMarks(),r=t.getMarkIdByState();n.forEach((function(t){var n,a=i&&r[i]&&r[i].includes(t.id);if(a){var o=t.hasAnimationByState&&t.hasAnimationByState("state");null===(n=t.getGraphics())||void 0===n||n.forEach((function(t){e&&e.includes(t)&&a&&t.addState(i,!0,o)}))}}))},t.prototype.clearAllStatesOfTrigger=function(t,e,i){if(!this._disableTriggerEvent){var n=this.getStatedGraphics(t);if(n&&n.length){var r=t.getMarks(),a=t.getMarkIdByState();r.forEach((function(t){if(t){var r=t.getGraphics(),o=t.hasAnimationByState&&t.hasAnimationByState("state");r&&r.length&&(i&&a[i]&&a[i].includes(t.id)&&r.forEach((function(t){t.removeState(i,o)})),e&&a[e]&&a[e].includes(t.id)&&r.forEach((function(t){n.includes(t)&&t.removeState(e,o)})))}}))}}},t.prototype.clearAllStates=function(){var t=this;this._disableTriggerEvent||this._triggerMapByState.forEach((function(e,i){e.forEach((function(e){t.clearAllStatesOfTrigger(e,i,e.getResetState())}))}))},t.prototype.clearByState=function(t){var e=this;if(!this._disableTriggerEvent){var i=this._triggerMapByState.get(t);i&&i.length&&i.forEach((function(i){e.clearAllStatesOfTrigger(i,t,i.getResetState()),e.setStatedGraphics(i,[])}))}},t.prototype.updateStateOfGraphics=function(t,e){var i=this;if(!this._disableTriggerEvent){var n=this._triggerMapByState.get(t);n&&n.length&&n.forEach((function(t){var n=e.filter((function(e){return t.getMarks().some((function(t){var i=t&&t.getGraphics();return i&&i.includes(e)}))}));i.updateStates(t,n,i.getStatedGraphics(t),t.getStartState(),t.getResetState()),i.setStatedGraphics(t,n)}))}},t}(),yW=function(e){function i(t,i){var n,r,a,o=this;return(o=e.call(this,i)||this).type="chart",o.id=_x(),o._regions=[],o._series=[],o._components=[],o._layoutRect={x:0,y:0,width:_z,height:bz},o._viewRect={width:_z,height:bz},o._viewBox={x1:0,y1:0,x2:_z,y2:bz},o._layoutTag=!0,o._idMap=new Map,o.state={layoutUpdateRank:1},o.padding={top:0,left:0,right:0,bottom:0},o.getAllSeries=function(){var t;return null!==(t=o._series)&&void 0!==t?t:[]},o.getRegionsInIndex=function(t){return t&&0!==t.length?o._regions.filter((function(e,i){return t.includes(i)})):[o._regions[0]]},o.getAllRegions=function(){return o._regions},o.getRegionsInIds=function(t){return t?o._regions.filter((function(e){return t.includes(e.id)})):[]},o.getRegionsInQuerier=function(t){return t?o._regions.filter((function(e,i){return St(t).some((function(t){return U(t.regionId)&&t.regionId===e.userId||t.regionIndex===i}))})):o._regions},o.getRegionsInUserId=function(t){if(t)return o._regions.find((function(e){return e.userId===t}))},o.getRegionsInUserIdOrIndex=function(t,e){return o.getAllRegions().filter((function(i){return(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())}))},o.getComponents=function(){return o._components},o.getSeriesInIndex=function(t){return t&&0!==t.length?o._series.filter((function(e,i){return t.includes(i)})):[o._series[0]]},o.getSeriesInIds=function(t){return t?o._series.filter((function(e){return t.includes(e.id)})):[]},o.getSeriesInUserId=function(t){if(t)return o._series.find((function(e){return e.userId===t}))},o.getSeriesInUserIdOrIndex=function(t,e){return o.getAllSeries().filter((function(i){return(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())}))},o.getComponentByIndex=function(t,e){var i=o._components.filter((function(e){return(e.specKey||e.type)===t}));if(i&&0!==i.length)return i[e]},o.getComponentsByKey=function(t){return o._components.filter((function(e){return(e.specKey||e.type)===t}))},o.getComponentByUserId=function(t){var e=o._components.find((function(e){return e.userId===t}));if(e)return e},o.getComponentsByType=function(t){return o._components.filter((function(e){return e.type===t}))},o._paddingSpec=IF(null!==(n=t.padding)&&void 0!==n?n:i.getTheme("padding")),o._event=new pH(i.eventDispatcher,i.mode),o._dataSet=i.dataSet,o._chartData=new fW(o._dataSet),o._modelOption=T(T({},i),{mode:o._option.mode,map:o._idMap,getChartLayoutRect:function(){return o._layoutRect},getChartViewRect:function(){return o._viewRect},getChart:function(){return o},globalScale:o._globalScale,onError:null===(r=o._option)||void 0===r?void 0:r.onError,disableTriggerEvent:!0===(null===(a=o._option)||void 0===a?void 0:a.disableTriggerEvent),getSeriesData:o._chartData.getSeriesData.bind(o._chartData)}),o._setModelOption&&o._setModelOption(),o._spec=t,o}return M(i,e),i.prototype.getSpec=function(){return this._spec},i.prototype.setSpec=function(t){this._spec=t},i.prototype.getOption=function(){return this._option},i.prototype.getLayoutRect=function(){return this._layoutRect},i.prototype.getViewRect=function(){return this._viewRect},i.prototype.getLayoutTag=function(){return this._layoutTag},i.prototype.setLayoutTag=function(t,e,i){void 0===i&&(i=!0),this._layoutTag=t;var n=this.getCompiler();return n&&(n.updateLayoutTag(),t&&i&&n.renderNextTick(e)),this._layoutTag},i.prototype.resetLayoutItemTag=function(){this.getLayoutElements().forEach((function(t){return t.setWillLayoutTag()}))},i.prototype.getModelOption=function(){return this._modelOption},i.prototype.getGlobalScale=function(){return this._globalScale},i.prototype.getEvent=function(){return this._event},Object.defineProperty(i.prototype,"chartData",{get:function(){return this._chartData},enumerable:!1,configurable:!0}),i.prototype._setModelOption=function(){},i.prototype.created=function(t){this._chartData.parseData(this._spec.data),this._createGlobalScale(),this._createBackground(),this._createLayout(),t.forEachRegionInSpec(this._spec,this._createRegion.bind(this)),t.forEachSeriesInSpec(this._spec,this._createSeries.bind(this)),t.forEachComponentInSpec(this._spec,this._createComponent.bind(this),this._option.getSpecInfo())},i.prototype._initInteractions=function(){var t=this;if(!this._option.disableTriggerEvent){this._interaction=new gW;var e=this.getAllSeries(),i=[],n={};e.forEach((function(t){var e=t.getInteractionTriggers();if(e&&e.length){var r=t.getRegion().id;e.forEach((function(t){var e=t.trigger,a=t.marks,o="".concat(r,"-").concat(e.type);n[o]?a.forEach((function(t){n[o].marks.push(t)})):(n[o]=T(T({},e),{marks:a}),i.push(n[o]))}))}})),i.forEach((function(e){var i=KF.createInteractionTrigger(e.type,T(T({},e),{event:t._event,interaction:t._interaction}));i&&(i.init(),t._interaction.addTrigger(i))}))}},i.prototype.init=function(){var t,e,i=this;null===(t=this._beforeInit)||void 0===t||t.call(this),this._regions.forEach((function(t){return t.init({})})),this._series.forEach((function(t){return t.init({})})),this._components.forEach((function(t){return t.init({dataSet:i._dataSet})})),this._initEvent(),null===(e=this._initStack)||void 0===e||e.call(this),this.reDataFlow(),this._initInteractions()},i.prototype.reDataFlow=function(){this._series.forEach((function(t){var e;return null===(e=t.getRawData())||void 0===e?void 0:e.markRunning()})),this._series.forEach((function(t){return t.fillData()})),this.updateGlobalScaleDomain()},i.prototype.onResize=function(t,e,i){void 0===i&&(i=!0);var n={width:t,height:e};this._canvasRect=n,this._updateLayoutRect(this._option.viewBox),this.resetLayoutItemTag(),this.setLayoutTag(!0,null,i)},i.prototype.updateViewBox=function(t,e){this._option.viewBox=t,this._updateLayoutRect(t),this.resetLayoutItemTag(),this.setLayoutTag(!0,null,e)},i.prototype._createBackground=function(){var e=this,i=this._spec.background;if(i&&"object"==typeof i&&!U(i.gradient)){var n=yt(i,["x","y","width","height","x1","y1","image"]);n.background=i.image,this._backgroundMark=KF.createMark("group","chart-background",{model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._globalScale}),this._backgroundMark.created(),this._backgroundMark.setStyle(T(T({},n),{x:function(){return e._viewBox.x1},y:function(){return e._viewBox.y1},width:function(){return e._viewBox.x2-e._viewBox.x1},height:function(){return e._viewBox.y2-e._viewBox.y1}})),this._backgroundMark.setMarkConfig({zIndex:t.LayoutZIndex.SeriesGroup-2}),this.getCompiler().addRootMark(this._backgroundMark)}},i.prototype._createRegion=function(t,e){if(t){var i=e.spec,n=w(e,["spec"]),r=new t(i,T(T({},this._modelOption),n));r&&(r.created(),this._regions.push(r))}},i.prototype._createSeries=function(t,e){if(t){var i,n=e.spec,r=w(e,["spec"]);if(U(n.regionId)?i=this.getRegionsInUserId(n.regionId):U(n.regionIndex)&&(i=this.getRegionsInIndex([n.regionIndex])[0]),i||(i=this._regions[0])){var a=new t(n,T(T(T({},this._modelOption),r),{type:n.type,region:i,globalScale:this._globalScale,sourceDataList:this._chartData.dataList}));a&&(a.created(),this._series.push(a),i.addSeries(a))}}},i.prototype.getSeriesById=function(t){return this._series.find((function(e){return e.id===t}))},i.prototype._createComponent=function(t,e){var i=t.createComponent(e,T(T({},this._modelOption),{type:t.type,getAllRegions:this.getAllRegions,getRegionsInIndex:this.getRegionsInIndex,getRegionsInIds:this.getRegionsInIds,getRegionsInUserIdOrIndex:this.getRegionsInUserIdOrIndex,getAllSeries:this.getAllSeries,getSeriesInIndex:this.getSeriesInIndex,getSeriesInIds:this.getSeriesInIds,getSeriesInUserIdOrIndex:this.getSeriesInUserIdOrIndex,getAllComponents:this.getComponents,getComponentByIndex:this.getComponentByIndex,getComponentByUserId:this.getComponentByUserId,getComponentsByKey:this.getComponentsByKey,getComponentsByType:this.getComponentsByType}));i&&(i.created(),this._components.push(i))},i.prototype.getAllComponents=function(){return this._components},i.prototype.getAllModels=function(){return[].concat(this.getAllSeries(),this.getAllComponents(),this.getAllRegions())},i.prototype.getModelInFilter=function(t){if(K(t))return this.getAllModels().find((function(e){return e.userId===t}));if(V(t))return this.getAllModels().find((function(e){return t(e)}));var e=0;return this.getAllModels().find((function(i){var n;if((null!==(n=i.specKey)&&void 0!==n?n:i.type)===t.type){if(e===t.index)return!0;e++}return!1}))},i.prototype._createLayout=function(){this._updateLayoutRect(this._option.viewBox),this._initLayoutFunc()},i.prototype.setLayout=function(t){this._option.layout=t,this._initLayoutFunc()},i.prototype._initLayoutFunc=function(){var t,e,i;if(this._layoutFunc=this._option.layout,!this._layoutFunc){var n=KF.getLayoutInKey(null!==(e=null===(t=this._spec.layout)||void 0===t?void 0:t.type)&&void 0!==e?e:"base");if(n){var r=new n(this._spec.layout,{onError:null===(i=this._option)||void 0===i?void 0:i.onError});this._layoutFunc=r.layoutItems.bind(r)}}},i.prototype.layout=function(){var e,i,n,r;if(null===(i=null===(e=this._option.performanceHook)||void 0===e?void 0:e.beforeLayoutWithSceneGraph)||void 0===i||i.call(e,this._option.globalInstance),this.getLayoutTag()){this._event.emit(t.ChartEvent.layoutStart,{chart:this,vchart:this._option.globalInstance}),this.onLayoutStart();var a=this.getLayoutElements();this._layoutFunc(this,a,this._layoutRect,this._viewBox),this._event.emit(t.ChartEvent.afterLayout,{elements:a,chart:this}),this.setLayoutTag(!1),this.onLayoutEnd(),this._event.emit(t.ChartEvent.layoutEnd,{chart:this,vchart:this._option.globalInstance})}null===(r=null===(n=this._option.performanceHook)||void 0===n?void 0:n.afterLayoutWithSceneGraph)||void 0===r||r.call(n,this._option.globalInstance)},i.prototype.onLayoutStart=function(){var t=this;this.getAllModels().forEach((function(e){return e.onLayoutStart(t._layoutRect,t._viewRect)}))},i.prototype.onLayoutEnd=function(){this.getAllModels().forEach((function(t){"series"!==t.modelType&&t.onLayoutEnd()}))},i.prototype.onEvaluateEnd=function(t){R(R(R([],B(this._components),!1),B(this._regions),!1),B(this._series),!1).forEach((function(e){return e.onEvaluateEnd(t)}))},i.prototype.onBeforeRender=function(){R(R(R([],B(this._components),!1),B(this._regions),!1),B(this._series),!1).forEach((function(t){return t.onBeforeRender()}))},i.prototype.getLayoutElements=function(){return this.getAllModels().map((function(t){return t.layout})).filter((function(t){return!!t}))},i.prototype.getModelById=function(t){var e=this._idMap.get(t);if(e&&e instanceof nN)return e},i.prototype.getModelByUserId=function(t){var e=this.getSeriesInUserId(t);if(e)return e;var i=this.getRegionsInUserId(t);if(i)return i;var n=this.getComponentByUserId(t);return n||void 0},i.prototype.getAllMarks=function(){return Array.from(this._idMap.values()).filter((function(t){return t&&t instanceof RN}))},i.prototype.getMarkById=function(t){var e=this._idMap.get(t);if(e&&e instanceof RN)return e},i.prototype.getMarkByUserName=function(t){return this.getAllMarks().filter((function(e){return e.name&&e.name===t}))},i.prototype.updateData=function(t,e,i,n){void 0===i&&(i=!0);var r=this._dataSet.getDataView(t);r&&(r.markRunning(),r.parseNewData(e,n)),i&&this.updateGlobalScaleDomain(),this.getAllModels().forEach((function(t){return t.onDataUpdate()}))},i.prototype.updateFullData=function(t,e){var i=this;void 0===e&&(e=!0),St(t).forEach((function(t){var e=i._dataSet.getDataView(t.id);e&&e.markRunning()})),St(t).forEach((function(t){var e=i._dataSet.getDataView(t.id);e&&FH(e,t,!0)})),e&&this.updateGlobalScaleDomain(),this.getAllModels().forEach((function(t){return t.onDataUpdate()}))},i.prototype.setCanvasRect=function(t,e){this._canvasRect={width:t,height:e}},i.prototype.getCanvasRect=function(){return this._canvasRect||(this._canvasRect=KH(this._spec,this._option,{width:_z,height:bz})),this._canvasRect},i.prototype.getSeriesData=function(t,e){return this._chartData.getSeriesData(t,e)},i.prototype._transformSpecScale=function(){var t,e=this._spec.scales?R([],B(this._spec.scales),!1):[],i=e.find((function(t){return"color"===t.id})),n=this.getColorScheme();if(!i&&(i={type:"ordinal",id:"color",domain:null,range:null},e.push(i),this._spec.color)){var r=this._spec.color;if(q(r))i.range=r;else{var a=r;Object.prototype.hasOwnProperty.call(a,"type")&&(i.type=a.type),Object.prototype.hasOwnProperty.call(a,"domain")&&(i.domain=a.domain),Object.prototype.hasOwnProperty.call(a,"range")&&(i.range=a.range),Object.prototype.hasOwnProperty.call(a,"specified")&&(i.specified=a.specified),Object.prototype.hasOwnProperty.call(a,"clamp")&&(i.clamp=a.clamp)}}return(null===(t=i.range)||void 0===t?void 0:t.length)||(i.range=pF(n),i.rangeTheme=!0),e},i.prototype._createGlobalScale=function(){this._globalScale=new vW(this._transformSpecScale(),this),this._modelOption.globalScale=this._globalScale},i.prototype.updateGlobalScaleDomain=function(){var t=new Set;this._series.forEach((function(e){var i=e.getSeriesKeys();i&&i.forEach((function(e){return t.add(e)}))}));var e=Array.from(t);this._globalScale.updateScaleDomain(e)},i.prototype.updateGlobalScale=function(t){qH(t,this._globalScale.updateSpec(this._transformSpecScale()))},i.prototype.updateGlobalScaleTheme=function(){var t=this._globalScale.getScaleSpec("color"),e=this.getColorScheme();t.rangeTheme&&(t.range=pF(e),this._globalScale.getScale("color").range(t.range))},i.prototype._getSpecKeys=function(t){var e={width:!0,height:!0};return Object.keys(t).filter((function(t){return!e[t]})).sort()},i.prototype.updateSpec=function(t){var e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(this.setLayoutTag(!0,null,!1),t.type!==this.type)return e.reMake=!0,e;var i=this._getSpecKeys(this._spec);if(!bt(i,this._getSpecKeys(t)))return e.reMake=!0,e;for(var n=0;n<i.length;n++){var r=i[n];if(q(this._spec[r])&&this._spec[r].length!==St(t[r]).length)return e.reMake=!0,e}var a=this._spec;return this._spec=t,this.updateChartConfig(e,a),e.reMake?e:(this.updateGlobalScale(e),e.reMake?e:(this.updateRegionSpec(e),e.reMake?e:(this.updateComponentSpec(e),e.reMake?e:(this.updateSeriesSpec(e),e.reMake||(this.reInit(),this.updateDataSpec(),this.updateGlobalScaleDomain()),e))))},i.prototype.updateChartConfig=function(t,e){var i,n;this._paddingSpec=IF(null!==(i=this._spec.padding)&&void 0!==i?i:null===(n=this._option)||void 0===n?void 0:n.getTheme("padding")),this._updateLayoutRect(this._viewBox)},i.prototype.updateDataSpec=function(){this._spec.data&&this._chartData.updateData(this._spec.data,!1,!0)},i.prototype.updateRegionSpec=function(t){var e,i=this;(null===(e=this._spec)||void 0===e?void 0:e.region)&&(this._spec.region.length===this._regions.length?this._regions.forEach((function(e){qH(t,e.updateSpec(i._spec.region[e.getSpecIndex()]))})):t.reMake=!0)},i.prototype.updateComponentSpec=function(t){var e,i=this,n={},r=((e={})[I.title]=!0,e[I.brush]=!0,e[I.indicator]=!0,e);for(var a in this._components.forEach((function(e){var a,o;if(e.type!==I.label&&e.type!==I.totalLabel){r[e.type]&&(r[e.type]=!1);var s=e.specKey||e.type,l=null!==(a=i._spec[s])&&void 0!==a?a:{};q(l)?(n[s]=n[s]||{specCount:l.length,componentCount:0},n[s].componentCount++,qH(t,e.updateSpec(null!==(o=l[e.getSpecIndex()])&&void 0!==o?o:{},l))):qH(t,e.updateSpec(l))}})),n)if(Object.prototype.hasOwnProperty.call(n,a)){var o=n[a];o.componentCount!==o.specCount&&(t.reMake=!0)}var s=function(t){return t&&!1!==t.visible};Object.keys(r).forEach((function(e){if(r[e]){var n=i._spec[e];(q(n)?n.some(s):s(n))&&(t.reMake=!0)}}))},i.prototype.updateSeriesSpec=function(t){var e=this;this._spec.series.length===this._series.length?this._series.forEach((function(i){var n=e._spec.series[i.getSpecIndex()];qH(t,i.updateSpec(n))})):t.reMake=!0},i.prototype.getCanvas=function(){var t,e;return null!==(e=null===(t=this.getCompiler())||void 0===t?void 0:t.getCanvas())&&void 0!==e?e:null},i.prototype._updateLayoutRect=function(e){var i=this.getCanvasRect();if(e){this._viewBox=e;var n=e.x1,r=void 0===n?0:n,a=e.y1,o=void 0===a?0:a;i={width:e.x2-r,height:e.y2-o}}else this._viewBox={x1:0,y1:0,x2:i.width,y2:i.height};this._viewRect=i,this.padding=RF(this._paddingSpec,i,i),this._layoutRect.width=i.width-this.padding.left-this.padding.right,this._layoutRect.height=i.height-this.padding.top-this.padding.bottom,this._layoutRect.x=this.padding.left,this._layoutRect.y=this.padding.top,this._event.emit(t.ChartEvent.layoutRectUpdate,{chart:this})},i.prototype.setCurrentTheme=function(){this.updateChartConfig({change:!0,reMake:!1},this._spec),this.resetLayoutItemTag(),this.setLayoutTag(!0,null,!1),this.updateGlobalScaleTheme(),this.reInit()},i.prototype.reInit=function(){R(R(R([],B(this._regions),!1),B(this._series),!1),B(this._components),!1).forEach((function(t){var e=t.getSpecInfo();e&&e.spec&&t.reInit(e.spec)}))},i.prototype.clear=function(){this.getAllModels().forEach((function(t){var e;return null===(e=t.clear)||void 0===e?void 0:e.call(t)}))},i.prototype.compile=function(){this.compileBackground(),this.compileLayout(),this.compileRegions(),this.compileSeries(),this.compileComponents()},i.prototype.afterCompile=function(){this.getAllRegions().forEach((function(t){var e;null===(e=t.afterCompile)||void 0===e||e.call(t)})),this.getAllSeries().forEach((function(t){var e;null===(e=t.afterCompile)||void 0===e||e.call(t)})),this.getAllComponents().forEach((function(t){var e;null===(e=t.afterCompile)||void 0===e||e.call(t)}))},i.prototype.compileLayout=function(){var t=this.getCanvasRect(),e=t.width,i=t.height;this.getCompiler().setSize(e,i)},i.prototype.compileBackground=function(){this._backgroundMark&&this._backgroundMark.compile()},i.prototype.compileRegions=function(){var t,e,i,n;null===(e=null===(t=this._option.performanceHook)||void 0===t?void 0:t.beforeRegionCompile)||void 0===e||e.call(t,this._option.globalInstance),this.getAllRegions().forEach((function(t){t.compile()})),null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.afterRegionCompile)||void 0===n||n.call(i,this._option.globalInstance)},i.prototype.compileSeries=function(){var t,e,i,n;null===(e=null===(t=this._option.performanceHook)||void 0===t?void 0:t.beforeSeriesCompile)||void 0===e||e.call(t,this._option.globalInstance),this.getAllSeries().forEach((function(t){t.compile()})),null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.afterSeriesCompile)||void 0===n||n.call(i,this._option.globalInstance)},i.prototype.compileComponents=function(){var t,e,i,n;null===(e=null===(t=this._option.performanceHook)||void 0===t?void 0:t.beforeComponentCompile)||void 0===e||e.call(t,this._option.globalInstance),this.getAllComponents().forEach((function(t){t.compile()})),null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.afterComponentCompile)||void 0===n||n.call(i,this._option.globalInstance)},i.prototype.release=function(){R(R(R([],B(this._components),!1),B(this._regions),!1),B(this._series),!1).forEach((function(t){t.beforeRelease()})),e.prototype.release.call(this),this.clear(),R(R(R([],B(this._components),!1),B(this._regions),!1),B(this._series),!1).forEach((function(t){t.release()})),this._components=this._regions=this._series=[],this._spec={},this._dataSet=this._globalScale=this._layoutFunc=null,this._layoutTag=!1,this._idMap.clear()},i.prototype.onLayout=function(){this.layout()},i.prototype.updateState=function(t,e){var i=this.getAllSeries(),n=function(n){if(lt(t[n]))return"continue";var r=t[n],a={stateValue:n};a=V(r.filter)?T({filter:r.filter},a):T(T({},r.filter),a),r.level&&(a.level=r.level),i.forEach((function(t){t.getMarks().forEach((function(i){i.stateStyle[n]&&(e&&!e(t,i,n)||(i.state.changeStateInfo(a),i.updateMarkState(n)))}))}))};for(var r in t)n(r)},i.prototype.setSelected=function(e,i,n){this._setStateInDatum(t.STATE_VALUE_ENUM.STATE_SELECTED,e,i,n)},i.prototype.setHovered=function(e,i,n){this._setStateInDatum(t.STATE_VALUE_ENUM.STATE_HOVER,e,i,n)},i.prototype.clearState=function(t){this._interaction.clearByState(t)},i.prototype.clearAllStates=function(){this._interaction.clearAllStates()},i.prototype.clearSelected=function(){this.clearState(t.STATE_VALUE_ENUM.STATE_SELECTED)},i.prototype.clearHovered=function(){this.clearState(t.STATE_VALUE_ENUM.STATE_HOVER)},i.prototype._initEvent=function(){var e=this;[t.ChartEvent.dataZoomChange,t.ChartEvent.scrollBarChange].forEach((function(t){e._event.on(t,(function(t){t.value,e._disableMarkAnimation(["exit","update"]);var i=function(){e._enableMarkAnimation(["exit","update"]),e._event.off(lH.AFTER_MARK_RENDER_END,i)};e._event.on(lH.AFTER_MARK_RENDER_END,i)}))}))},i.prototype._enableMarkAnimation=function(t){this.getAllMarks().forEach((function(e){return e.enableAnimationByState(t)}))},i.prototype._disableMarkAnimation=function(t){this.getAllMarks().forEach((function(e){return e.disableAnimationByState(t)}))},i.prototype.filterGraphicsByDatum=function(t,e){var i;void 0===e&&(e={});var n=(t=t?St(t):null)?Object.keys(t[0]):null,r=[],a=null!==(i=e.getDatum)&&void 0!==i?i:cH;return this.getRegionsInQuerier(e.region).forEach((function(i){var o=[];t&&i.getSeries().forEach((function(s){s.getMarks().forEach((function(l){var u=l.getGraphics();if(u&&u.length&&(!e.filter||V(e.filter)&&e.filter(s,l)))if(uH(l.type))u.filter((function(u){var c=a(u,l,s,i),h=c&&t.every((function(t,e){return n.every((function(i){return t[i]==c[e][i]}))}));h&&(o.push(u),r.push(u),e.callback&&e.callback(u,l,s,i))}));else if(t.length>1){var c=t.slice();u.forEach((function(t){var u=a(t,l,s,i),h=u&&c.findIndex((function(t){return n.every((function(e){return t[e]==u[e]}))}));h>=0&&(c.splice(h,1),o.push(t),r.push(t),e.callback&&e.callback(t,l,s,i))}))}else{var h=u.find((function(e){var r=a(e,l,s,i);return r&&n.every((function(e){return t[0][e]==r[e]}))}));h&&(o.push(h),r.push(h),e.callback&&e.callback(h,l,s,i))}}))})),e.regionCallback&&e.regionCallback(o,i)})),r},i.prototype._setStateInDatum=function(t,e,i,n){if(e){var r=this.filterGraphicsByDatum(e,{filter:i,region:n});this._interaction.updateStateOfGraphics(t,r)}else this._interaction.clearByState(t)},i.prototype.setDimensionIndex=function(e,i){var n,r,a=null;Array.from(this._event.getComposedEventMap().values()).forEach((function(n){var r=n.eventType,o=n.event;if(r===t.DimensionEventEnum.dimensionHover||r===t.DimensionEventEnum.dimensionClick){var s=o.dispatch(e,i);(null==s?void 0:s.length)&&(a=s)}}));var o=j(e)||!a||a.every((function(t){return $R(t.axis.getScale().type)&&j(t.index)}));if(!1!==i.tooltip){var s=this.getComponentsByType(I.tooltip)[0];if(null==s?void 0:s.getVisible())if(o)null===(r=(n=s).hideTooltip)||void 0===r||r.call(n);else{var l={};a.forEach((function(t){var e=t.axis,i=t.value,n=t.data,r="left"===e.getOrient()||"right"===e.getOrient();n.forEach((function(t){var e,n,a,o=r?t.series.fieldY[0]:t.series.fieldX[0];l[o]=null!==(a=null===(n=null===(e=t.datum)||void 0===e?void 0:e[0])||void 0===n?void 0:n[o])&&void 0!==a?a:i}))})),s.showTooltip(l,i.showTooltipOption)}}if(!1!==i.crosshair){var u=this.getComponentsByType(I.cartesianCrosshair)[0];u&&u.clearAxisValue&&u.setAxisValue&&(o?u.hideCrosshair():u.showCrosshair(a))}},i.prototype.getColorScheme=function(){var t,e;return null===(e=(t=this._option).getTheme)||void 0===e?void 0:e.call(t,"colorScheme")},i}(eN),mW=function(t,e){var i,n=t.spec,r=n.regionId,a=n.regionIndex;if(U(r)){var o=St(r);return null===(i=e.region)||void 0===i?void 0:i.filter((function(t){var e=t.spec;return o.includes(e.id)}))}if(U(a))return St(a).map((function(t){var i;return null===(i=e.region)||void 0===i?void 0:i[t]})).filter(U)},_W=function(){function t(t){this._option=t,this.type=t.type,this.seriesType=t.seriesType}return t.prototype.initChartSpec=function(t){return this.transformSpec(t),this.transformModelSpec(t)},t.prototype.transformSpec=function(t){t.region&&0!==t.region.length||(t.region=[{}]),void 0===t.tooltip&&(t.tooltip={}),U(t.stackInverse)&&t.region.forEach((function(e){!U(e.stackInverse)&&(e.stackInverse=t.stackInverse)})),U(t.stackSort)&&t.region.forEach((function(e){!U(e.stackSort)&&(e.stackSort=t.stackSort)}))},t.prototype.generateTransform=function(t,e){var i=this;return function(n,r,a){var o=r.spec,s=r.specPath,l=r.specInfoPath,u=r.type,c=new n.transformerConstructor(T(T({},i._option),{type:u})),h=c.transformSpec(o,t,a),d=T(T({},r),h);e?d.theme=c.getTheme(o,t):WF(t,s,h.spec),WF(a,null!=l?l:s,d)}},t.prototype.transformModelSpec=function(t){return this.createSpecInfo(t,this.generateTransform(t,!1))},t.prototype.createSpecInfo=function(t,e){var i,n;e||(e=this.generateTransform(t,!0));var r={};return this.forEachRegionInSpec(t,e,r),this.forEachSeriesInSpec(t,e,r),null===(i=r.series)||void 0===i||i.forEach((function(t,e){var i,n,a=(null!==(n=null!==(i=mW(t,r))&&void 0!==i?i:r.region)&&void 0!==n?n:[])[0];a&&(a.seriesIndexes||(a.seriesIndexes=[]),a.seriesIndexes.push(e),t.regionIndexes=a.regionIndexes.slice())})),this.forEachComponentInSpec(t,e,r),Object.values(null!==(n=r.component)&&void 0!==n?n:{}).forEach((function(t){return t.forEach((function(t,e){var i,n,a;if(t){if(!t.regionIndexes){var o=null!==(n=null!==(i=mW(t,r))&&void 0!==i?i:r.region)&&void 0!==n?n:[];t.regionIndexes=o.map((function(t){return t.regionIndexes[0]}))}if(!t.seriesIndexes){var s=function(t,e){var i,n=t.spec,r=n.seriesId,a=n.seriesIndex;if(U(r)){var o=St(r);return null===(i=e.series)||void 0===i?void 0:i.filter((function(t){var e=t.spec;return o.includes(e.id)}))}if(U(a))return St(a).map((function(t){var i;return null===(i=e.series)||void 0===i?void 0:i[t]})).filter(U)}(t,r);if(s)t.seriesIndexes=s.map((function(t){return t.seriesIndexes[0]}));else{var l=new Set;(null!==(a=t.regionIndexes)&&void 0!==a?a:[]).forEach((function(t){var e,i,n=null===(e=r.region)||void 0===e?void 0:e[t];null===(i=null==n?void 0:n.seriesIndexes)||void 0===i||i.forEach((function(t){return l.add(t)}))})),t.seriesIndexes=Array.from(l)}}}}))})),r},t.prototype._isValidSeries=function(t){return!0},t.prototype._getDefaultSeriesSpec=function(t,e,i){var n,r,a,o,s,l={dataKey:t.dataKey,hover:t.hover,select:t.select,label:t.label,seriesStyle:t.seriesStyle,animation:null!==(n=t.animation)&&void 0!==n?n:null===(r=this._option.globalInstance)||void 0===r?void 0:r.isAnimationEnable(),animationThreshold:null!==(a=t.animationThreshold)&&void 0!==a?a:null===(s=(o=this._option).getTheme)||void 0===s?void 0:s.call(o,"animationThreshold"),animationAppear:t.animationAppear,animationDisappear:t.animationDisappear,animationEnter:t.animationEnter,animationUpdate:t.animationUpdate,animationExit:t.animationExit,animationNormal:t.animationNormal,animationState:t.animationState,extensionMark:t.extensionMark,large:t.large,largeThreshold:t.largeThreshold,progressiveStep:t.progressiveStep,progressiveThreshold:t.progressiveThreshold,background:t.seriesBackground,invalidType:t.invalidType,seriesField:t.seriesField,morph:t.morph,interactions:t.interactions},u=this.seriesType;return u&&(l.type=u,l[u]=t[u]),e&&e.length&&e.forEach((function(e){l[e]=t[e]})),i&&i.length&&i.forEach((function(e){l[e]=t[e]})),l},t.prototype.forEachRegionInSpec=function(t,e,i){var n;return(null!==(n=t.region)&&void 0!==n?n:[]).map((function(t,n){return e(KF.getRegionInType("region"),{spec:t,specPath:["region",n],type:"region",regionIndexes:[n]},i)}))},t.prototype.forEachSeriesInSpec=function(t,e,i){var n;return(null!==(n=t.series)&&void 0!==n?n:[]).map((function(t,n){return e(KF.getSeriesInType(t.type),{spec:t,specPath:["series",n],type:t.type,seriesIndexes:[n]},i)}))},t.prototype.forEachComponentInSpec=function(t,e,i){for(var n,r,a,o,s,l,u,c=[],h=KF.getComponents(),d=[],p=0;p<h.length;p++){var f=h[p],v=f.cmp,g=f.alwaysCheck;v.type.startsWith(I.cartesianAxis)?o=v:v.type.startsWith(I.polarAxis)?s=v:v.type===I.geoCoordinate?l=v:(g||t[null!==(n=v.specKey)&&void 0!==n?n:v.type])&&(v.type===I.tooltip?u=v:d.push(h[p]))}var y,m=!1;o&&((null==(y=o.getSpecInfo(t,i))?void 0:y.length)>0&&(m=!0,y.forEach((function(t){var n=KF.getComponentInKey(t.type);c.push(e(n,t,i))}))));s&&!m&&((null==(y=s.getSpecInfo(t,i))?void 0:y.length)>0&&(m=!0,y.forEach((function(t){var n=KF.getComponentInKey(t.type);c.push(e(n,t,i))}))));return l&&!m&&(null===(r=l.getSpecInfo(t,i))||void 0===r||r.forEach((function(t){c.push(e(l,t,i))}))),d.sort((function(t,e){return t.createOrder-e.createOrder})),d.forEach((function(n){var r,a=n.cmp;null===(r=a.getSpecInfo?a.getSpecInfo(t,i):_V(t,a.specKey,a.type))||void 0===r||r.forEach((function(t){c.push(e(a,t,i))}))})),u&&(null===(a=_V(t,u.specKey,u.type))||void 0===a||a.forEach((function(t){c.push(e(u,t,i))}))),c},t.prototype.transformSeriesSpec=function(t){var e=this,i=this._getDefaultSeriesSpec(t);t.series&&0!==t.series.length?t.series.forEach((function(t){e._isValidSeries(t.type)&&Object.keys(i).forEach((function(e){e in t||(t[e]=i[e])}))})):t.series=[i]},t.prototype._findBandAxisBySeries=function(t,e,i){var n="horizontal"===(null==t?void 0:t.direction)?["left","right"]:["top","bottom"];return i.find((function(i){if(!n.includes(i.orient))return!1;if(U(i.seriesId)){if(St(i.seriesId).includes(null==t?void 0:t.id))return!0}else if(U(i.seriesIndex)){if(St(i.seriesIndex).includes(e))return!0}else if("band"===i.type)return!0;return!0}))},t.prototype._applyAxisBandSize=function(t,e,i){var n=i.barMaxWidth,r=i.barMinWidth,a=i.barWidth,o=i.barGapInGroup,s=!1;Q(r)?(t.minBandSize=r,s=!0):Q(a)?(t.minBandSize=a,s=!0):Q(n)&&(t.minBandSize=n,s=!0),s&&(t.bandSizeLevel=Number.MAX_VALUE,t.bandSizeExtend={extend:e,gap:q(o)?o[o.length-1]:o})},t}(),bW=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.needAxes=function(){return!0},e.prototype._isValidSeries=function(t){return!this.seriesType||t===this.seriesType},e.prototype._getDefaultSeriesSpec=function(e,i){return t.prototype._getDefaultSeriesSpec.call(this,e,["xField","yField","zField","direction","stack","percent","stackOffsetSilhouette","totalLabel","sortDataByAxis"],i)},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),t.prototype.transformSeriesSpec.call(this,e),this._transformAxisSpec(e)},e.prototype._setDefaultXAxisSpec=function(t){return{orient:"bottom"}},e.prototype._setDefaultYAxisSpec=function(t){return{orient:"left"}},e.prototype._setDefaultZAxisSpec=function(t){return{orient:"z"}},e.prototype._transformAxisSpec=function(t){var e=this;if(this.needAxes()){t.axes||(t.axes=[]);var i={x:!1,y:!1,z:!1};t.axes.forEach((function(n){var r=n.orient,a=null;"top"!==r&&"bottom"!==r||(i.x=!0,a=e._setDefaultXAxisSpec(t)),"left"!==r&&"right"!==r||(i.y=!0,a=e._setDefaultYAxisSpec(t)),"z"===r&&(i.z=!0,a=e._setDefaultZAxisSpec(t)),a&&Object.keys(a).forEach((function(t){j(n[t])&&(n[t]=a[t])})),ut(n,"trimPadding")&&XF(n,ZH(e.type,t))})),i.x||t.axes.push(this._setDefaultXAxisSpec(t)),i.y||t.axes.push(this._setDefaultYAxisSpec(t)),t.zField&&!i.z&&t.axes.push(this._setDefaultZAxisSpec(t))}},e}(_W),xW=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n=t.prototype._getDefaultSeriesSpec.call(this,e,["point","line","activePoint","sampling","samplingFactor","pointDis","pointDisMul","markOverlap","lineLabel"]);return n.seriesMark=null!==(i=e.seriesMark)&&void 0!==i?i:"line",n},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),XH(e)},e}(bW),kW=function(t,e){var i={nodes:{}},n=e.fields;if(!(null==n?void 0:n.length))return i;var r,a=n.length-1,o=i;return t.forEach((function(t){t.latestData&&t.latestData.forEach((function(t){o=i;for(var e=0;e<n.length;e++){var s=n[e],l=t[s];if(j(l))break;o.groupField=s,o.nodes[l]||(e===a?o.nodes[l]={values:[]}:(r={nodes:{}},o.nodes[l]=r)),e===a?o.nodes[l].values.push(t):o=o.nodes[l]}}))})),i},SW=function(){function e(t,e){var i=this;this.stackRegion=function(t){var e,n=t.model,r=n.getSeries(),a=r.some((function(t){return t.getStack()}));if(a){var o=r.some((function(t){var e,i,n,r;return!!(null===(i=null===(e=t.getSpec())||void 0===e?void 0:e.totalLabel)||void 0===i?void 0:i.alwayCalculateTotal)||(null===(r=null===(n=t.getSpec())||void 0===n?void 0:n.totalLabel)||void 0===r?void 0:r.visible)})),s=o||r.some((function(t){return t.getPercent()})),l=r.some((function(t){return t.getStackOffsetSilhouette()})),u=Xz(n,!0);for(var c in u)for(var h in u[c].nodes)$z(u[c].nodes[h],n.getStackInverse(),s,o);if(l)for(var c in u)for(var h in u[c].nodes)Qz(u[c].nodes[h]);o&&n.getSeries().forEach((function(t){var e=t.getStackData(),i=t.getStackValue(),n=t.getStackValueField();e&&n&&qz(u[i],n)})),(null===(e=i._options)||void 0===e?void 0:e.afterStackRegion)&&i._options.afterStackRegion(n,u)}},this._chart=t,this._options=e}return e.prototype.init=function(){var e=this;this._chart.getAllRegions().forEach((function(i){i.event.on(t.ChartEvent.regionSeriesDataFilterOver,{filter:function(t){var e=t.model;return(null==e?void 0:e.id)===i.id}},e.stackRegion)}))},e.prototype.stackAll=function(){var t=this;this._chart.getAllRegions().forEach((function(e){t.stackRegion({model:e})}))},e}(),AW=function(){function t(){}return t.prototype._beforeInit=function(){this._dataSet&&kH(this._dataSet,"stackSplit",kW)},t.prototype._initStack=function(){this._stack=new SW(this),this._stack.init()},t}(),MW={state:t.STATE_VALUE_ENUM.STATE_DIMENSION_HOVER,reverseState:t.STATE_VALUE_ENUM.STATE_DIMENSION_HOVER_REVERSE,trigger:t.DimensionEventEnum.dimensionHover},TW=function(t){function e(e){var i=t.call(this,e)||this;return i.type="dimension-hover",i._resetType=[],i.resetAll=function(){var t=i.options,e=t.state,n=t.reverseState,r=t.interaction,a=r.getStatedGraphics(i);a&&a.length&&(r.clearAllStatesOfTrigger(i,e,n),i.dispatchEvent("reset",{graphics:a,options:i.options}),r.setStatedGraphics(i,[]))},i.handleStart=function(t){var e=i.options.interaction;switch(t.action){case"enter":var n=i.getStatedGraphics(t);e.updateStates(i,i.getStatedGraphics(t),e.getStatedGraphics(i),i.options.state,i.options.reverseState),e.setStatedGraphics(i,n);break;case"leave":e.clearAllStatesOfTrigger(i,i.options.state,i.options.reverseState),e.setStatedGraphics(i,[])}},i.options=Object.assign({},MW,e),i.updateMarkIdByState([i.options.state,i.options.reverseState]),i}return M(e,t),e.prototype.getStartState=function(){return this.options.state},e.prototype.getResetState=function(){return this.options.reverseState},e.prototype.getEvents=function(){return[{type:this.options.trigger,handler:this.handleStart}]},e.prototype.getStatedGraphics=function(t,e){void 0===e&&(e=!1);var i=this.getMarksByState(e?this.options.reverseState:this.options.state),n=[];return t.dimensionInfo.forEach((function(t){t.data.forEach((function(t){var r=i.filter((function(e){return e.model===t.series&&e.getVisible()}));r.forEach((function(i){var r=i.getGraphics();if(r&&r.length){var a=r.filter((function(i){var n,r=cH(i);return n=q(r)?r.every((function(e,i){return e===t.datum[i]})):t.datum.some((function(t){return t===r})),e?!n:n}));n.push.apply(n,R([],B(a),!1))}}))}))})),n},e.type="dimension-hover",e.defaultOptions=MW,e}(aV),wW=function(){KF.registerInteractionTrigger(TW.type,TW)},CW=function(){KF.registerComposedEvent(t.DimensionEventEnum.dimensionHover,Aj),KF.registerComposedEvent(t.DimensionEventEnum.dimensionClick,_j)},EW=function(t){return t.fieldX[0]},PW=function(t){return t.fieldY[0]},BW=function(t){var e;return[t.fieldX[0],null!==(e=t.fieldX2)&&void 0!==e?e:t.fieldX[1]]},RW=function(t){var e;return[t.fieldY[0],null!==(e=t.fieldY2)&&void 0!==e?e:t.fieldY[1]]},LW=function(t,e){return t?e?EW:BW:e?PW:RW},IW=function(t,e,i){var n,r;if(!t)return null;var a=e.x,o=e.y,s=null!==(n=Sj(t,(function(t){return uj(t.getOrient())}),e))&&void 0!==n?n:[],l=null!==(r=Sj(t,(function(t){return cj(t.getOrient())}),e))&&void 0!==r?r:[];if(!s.length&&!l.length)return null;var u=new Set,c=new Set,h=new Set;[s,l].forEach((function(t){return t.forEach((function(t){$R(t.getScale().type)?u.add(t):c.add(t),i&&t.getSpec().hasDimensionTooltip&&h.add(t)}))}));var d=[],p=function(t){var e="x"===t,i=e?a:o;(e?s:l).forEach((function(t){if(h.size>0){if(h.has(t))(n=DW(t,i,LW(e,$R(t.getScale().type))))&&d.push(n)}else{var n,r=u.size>0;if((r?u:c).has(t))(n=DW(t,i,LW(e,r)))&&d.push(n)}}))};return"horizontal"===t.getSpec().direction?(p("y"),0===d.length&&p("x")):(p("x"),0===d.length&&p("y")),d.length?d:null},DW=function(t,e,i){var n=t.positionToData(e,!0);return j(n)?null:OW(t,n,i)},OW=function(t,e,i){var n=t.getScale();if(j(e))return null;var r=n.domain().findIndex((function(t){return(null==t?void 0:t.toString())===e.toString()}));r<0&&(r=void 0);var a=xj(e,t,"cartesian",null!=i?i:uj(t.getOrient())?EW:PW);return{index:r,value:e,position:n.scale(e),axis:t,data:a}},FW=function(t,e,i,n){return void 0===n&&(n=!1),i||(i={x:0,y:0}),Object.keys(t).forEach((function(r){var a,o,s,l,u,c,h=t[r],d=h.currentValue,p=h.cacheInfo,f=h.labelsComp,v=h.attributes,g=h.coordKey,y=null,m=0,_=null;if(d.size){var b=Array.from(d.values())[0];m=b.axis.getScale().scale(b.datum)+b.axis.getLayoutStartPoint()[g]-i[g],y=b.axis,_=null===(c=null===(u=null===(l=null===(s=null===(o=null===(a=y.getVRenderComponents()[0])||void 0===a?void 0:a.children[0])||void 0===o?void 0:o.children[0])||void 0===s?void 0:s.children[0])||void 0===l?void 0:l.getChildByName("axis-label-container"))||void 0===u?void 0:u.getChildByName("axis-label-container-layer-0"))||void 0===c?void 0:c.children[0]}var x,k=!!d.size&&Number.isFinite(m)&&!Number.isNaN(m),S=n&&!k&&U(p),A=S?p:{coordRange:[0,0],sizeRange:[0,0],coord:m,labelsTextStyle:{},labels:f?Object.keys(f).reduce((function(t,e){return t[e]={visible:!1,text:"",dx:0,dy:0},t}),{}):null,visible:k,axis:y,axisLabel:_};A&&(A._isCache=S);var M=0;if(v&&d.forEach((function(t){var i,n,a,o,s,l,u,c,h,d,p=t.axis,f=t.datum,g=void 0===f?"":f,y=null,b=p.getScale();if($R(b.type))0===(x=b.bandwidth())&&b.step&&(M=b.step());else if(JR(b.type)){var k="xField"===r?e.fieldX[0]:e.fieldY[0],T="xField"===r?e.fieldX2:e.fieldY2,w=function(t,e,i,n){for(var r=0,a=t.length;r<a;r++){var o=t[r];if(o){var s=o[i],l=o[n||i];if(s<=e&&l>=e)return o}}return null}(e.getViewData().latestData,+g,k,T);if(w){var C="xField"===r?e.dataToPositionX(w):e.dataToPositionY(w);T?(x=Math.abs(C-("xField"===r?e.dataToPositionX1(w):e.dataToPositionY1(w))),g="".concat(w[k]," ~ ").concat(w[T])):x=1,m=C}y=p.niceLabelFormatter}if(A&&(null===(i=v.label)||void 0===i?void 0:i.visible)&&!S){var E=Yj(p.getSpec()),P=p.getOrient(),B=null===(n=v.label)||void 0===n?void 0:n.syncAxisLabelAngle;A.labels[P]&&(A.labels[P].visible=!0,A.labels[P].text=g,"left"===P?(A.labels[P].dx=-E,A.labelsTextStyle[P]={textAlign:B&&_&&null!==(a=_.attribute.textAlign)&&void 0!==a?a:"right",textBaseline:B&&_&&null!==(o=_.attribute.textBaseline)&&void 0!==o?o:"middle"}):"right"===P?(A.labels[P].dx=E,A.labelsTextStyle[P]={textAlign:B&&_&&null!==(s=_.attribute.textAlign)&&void 0!==s?s:"left",textBaseline:B&&_&&null!==(l=_.attribute.textBaseline)&&void 0!==l?l:"middle"}):"top"===P?(A.labels[P].y=0,A.labels[P].dy=-E,A.labelsTextStyle[P]={textAlign:B&&_&&null!==(u=_.attribute.textAlign)&&void 0!==u?u:"center",textBaseline:B&&_&&null!==(c=_.attribute.textBaseline)&&void 0!==c?c:"bottom"}):"bottom"===P&&(A.labels[P].dy=E,A.labelsTextStyle[P]={textAlign:B&&_&&null!==(h=_.attribute.textAlign)&&void 0!==h?h:"center",textBaseline:B&&_&&null!==(d=_.attribute.textBaseline)&&void 0!==d?d:"top"}),A.labels[P].defaultFormatter=y)}})),A&&!S){var T={x1:1/0,y1:1/0,x2:-1/0,y2:-1/0};HW(T,d),"xField"===r?(A.coordRange=[T.x1,T.x2],A.sizeRange=[T.y1,T.y2],A.coord=m+i.x,A.labels&&(A.labels.top.y=T.y1,A.labels.bottom.y=T.y2)):(A.coordRange=[T.y1,T.y2],A.sizeRange=[T.x1,T.x2],A.coord=m+i.y,A.labels&&(A.labels.left.x=T.x1,A.labels.right.x=T.x2)),(A.coord<A.coordRange[0]||A.coord>A.coordRange[1])&&(A.visible=!1),v&&v.label&&Object.keys(A.labels).forEach((function(t){A.labels[t].visible&&zW(A.labels[t],t,v.label)}))}t[r].bandSize=null!=x?x:0,t[r].offsetSize=M,t[r].cacheInfo=A})),t},zW=function(t,e,i){var n=mV(i.formatMethod,i.formatter,t.text,{label:t.text,position:e}),r=n.formatFunc,a=n.args;r?t.text=r.apply(void 0,R([],B(a),!1)):t.defaultFormatter&&(t.text=t.defaultFormatter(t.text))},HW=function(t,e){e.forEach((function(e){e.axis.getRegions().forEach((function(e){var i=e.getLayoutStartPoint(),n=i.x,r=i.y,a=e.getLayoutRect(),o=a.width,s=a.height;t.x1=Math.min(t.x1,n),t.y1=Math.min(t.y1,r),t.x2=Math.max(t.x2,n+o),t.y2=Math.max(t.y2,r+s)}))}))},NW=function(t){var e,i,n,r,a,o=t.cacheInfo,s=t.attributes,l=t.bandSize,u=t.offsetSize,c=t.coordKey,h=t.anotherAxisKey,d=o.coord,p=o.sizeRange,f=s.type;if("line"===f){var v=d+l/2;a={visible:!0,start:(e={},e[c]=v,e[h]=p[0],e),end:(i={},i[c]=v,i[h]=p[1],i)}}else if("rect"===f){var g=B(VW(s,l,u,o.axis),2),y=g[0],m=g[1],_=o.coordRange;a={visible:!0,start:(n={},n[c]=Math.max(d+y,_[0]),n[h]=p[0],n),end:(r={},r[c]=Math.min(d+m,_[1]),r[h]=p[1],r)}}return a},VW=function(t,e,i,n){var r,a,o,s=0===e?i:e,l=s;if(null===(r=t.style)||void 0===r?void 0:r.sizePercent)l=s*t.style.sizePercent;else if("number"==typeof(null===(a=t.style)||void 0===a?void 0:a.size))l=t.style.size;else if("function"==typeof(null===(o=t.style)||void 0===o?void 0:o.size)){var u=n.getLayoutRect();l=t.style.size(u,n)}return 0===e?[-l/2,l/2]:[e/2-l/2,l/2+e/2]},jW=function(t,e){var i,n=new Map,r=new Map,a=t.series,o=t.datum,s="horizontal"===a.direction,l=(s?a.getYAxisHelper():a.getXAxisHelper()).getAxisId(),u=a.getChart().getComponentsByKey("axes").find((function(t){return t.id===l}));if(u){(s?r:n).set(u.getSpecIndex(),{datum:null===(i=a.getDatumPositionValues(o[0],a.getDimensionField()))||void 0===i?void 0:i[0],axis:u});var c={xField:{coordKey:"x",anotherAxisKey:"y",currentValue:n,attributes:{visible:!!n.size,type:"rect"}},yField:{coordKey:"y",anotherAxisKey:"x",currentValue:r,attributes:{visible:!!r.size,type:"rect"}}};return FW(c,a,e),c.xField.cacheInfo?NW(c.xField):c.yField.cacheInfo?NW(c.yField):void 0}},UW=["updateTitle","updateContent","updatePosition","maxLineCount","othersLine"],WW=function(t,e,i,n,r){var a,o,s,l={activeType:t};switch(t){case"mark":case"group":if(i){var u=null===(a=i.getSpec())||void 0===a?void 0:a.tooltip;return l.visible=!0,(null==u?void 0:u.handler)&&(l.handler=u.handler),(null===(o=l.handler)||void 0===o?void 0:o.showTooltip)?l:((null==u?void 0:u[t])&&UW.forEach((function(e){U(u[t][e])&&(l[e]=u[t][e])})),T(T({},l),i.tooltipHelper.getTooltipData(t,e,n,n[0].datum,r)))}break;case"dimension":if(null==n?void 0:n.length){if(GW(n).every((function(t){var e;return!AV("dimension",null===(e=t.tooltipHelper)||void 0===e?void 0:e.spec)}))?l.visible=!1:l.visible=!0,l.handler=e.handler,null===(s=l.handler)||void 0===s?void 0:s.showTooltip)return l;var c=[];return n.forEach((function(i){return i.data.forEach((function(i){var a=i.series.tooltipHelper.getTooltipData(t,e,n,i.datum,r);a&&c.push(a)}))})),function(t){if(!t||!t.length)return null;var e=[];return t.forEach((function(t){var i=t.content;i&&i.forEach((function(t){e.push(t)}))})),e.length?T(T({},t[0]),{content:e}):t[0]}(c)}}return null},GW=function(t){var e=[];return t.forEach((function(t){t.data.forEach((function(t){U(t.series)&&e.push(t.series)}))})),e},YW={dom:"".concat(mz,"_TOOLTIP_HANDLER_DOM"),canvas:"".concat(mz,"_TOOLTIP_HANDLER_CANVAS")},XW={key:"其他",value:"..."};!function(t){t.group="group",t.mark="mark",t.dimension="dimension"}(dW||(dW={}));var KW=function(){function e(e){var i=this;this._showTooltipByHandler=function(e,n){var r,a,o;if(j(e))return 1;n.changePositionOnly||i.clearCache(),i._updateViewSpec(e,n);var s=i._cacheActiveSpec;if(j(s)||!1===s.visible)return 1;n.tooltipSpec=i.component.getSpec(),n.activeTooltipSpec=s;var l,u=s.title,c=s.content,h=j(null==u?void 0:u.key)&&j(null==u?void 0:u.value)&&!(null==c?void 0:c.length);return i.component.event.emit(t.ChartEvent.tooltipShow,T(T({},n),{isEmptyTooltip:h,tooltipData:e,activeType:i.activeType,tooltip:i.component})),h?1:((null===(r=s.handler)||void 0===r?void 0:r.showTooltip)?l=s.handler.showTooltip.bind(s.handler):(null===(a=i.component.tooltipHandler)||void 0===a?void 0:a.showTooltip)&&(l=i.component.tooltipHandler.showTooltip.bind(i.component.tooltipHandler)),l?null!==(o=l(i.activeType,e,n))&&void 0!==o?o:0:1)},this.component=e}return e.prototype._preprocessDimensionInfo=function(t){var e=[];if(null==t||t.forEach((function(t){var i=T(T({},t),{data:t.data.filter((function(t){var e,i;return!1!==(null===(i=null===(e=t.series.getSpec())||void 0===e?void 0:e.tooltip)||void 0===i?void 0:i.visible)}))});i.data.length>0&&e.push(i)})),e.length>0)return e},e.prototype._updateViewSpec=function(t,e){var i,n,r,a,o,s,l,u,c,h=e.changePositionOnly,d=e.model;if(!h||!this._cacheActiveSpec){var p=this.component.getSpec();if(this._cacheActiveSpec=WW(this.activeType,this.component.getSpec(),d,t,e),this._cacheActiveSpec){j(this._cacheActiveSpec.handler)&&U(p.handler)&&(this._cacheActiveSpec.handler=p.handler);var f=null!==(i=p[this.activeType])&&void 0!==i?i:{},v=null!==(n=this._cacheActiveSpec.updateTitle)&&void 0!==n?n:f.updateTitle,g=null!==(r=this._cacheActiveSpec.updateContent)&&void 0!==r?r:f.updateContent,y=null!==(o=null!==(a=this._cacheActiveSpec.maxLineCount)&&void 0!==a?a:f.maxLineCount)&&void 0!==o?o:20;if(v&&(this._cacheActiveSpec.title=null!==(s=v(this._cacheActiveSpec.title,t,e))&&void 0!==s?s:this._cacheActiveSpec.title),g)this._cacheActiveSpec.content=null!==(l=g(this._cacheActiveSpec.content,t,e))&&void 0!==l?l:this._cacheActiveSpec.content;else if(y>=1&&(null===(u=this._cacheActiveSpec.content)||void 0===u?void 0:u.length)>y){var m=null!==(c=this._cacheActiveSpec.othersLine)&&void 0!==c?c:f.othersLine,_=m?T(T({},XW),m):XW;this._cacheActiveSpec.content=R(R([],B(this._cacheActiveSpec.content.slice(0,y-1)),!1),[T(T({},this._cacheActiveSpec.content[y-1]),_)],!1)}}}},e.prototype.shouldHandleTooltip=function(t,e){var i,n;return!j(e)&&AV(this.activeType,null===(n=null===(i=t.model)||void 0===i?void 0:i.tooltipHelper)||void 0===n?void 0:n.spec)},e.prototype.clearCache=function(){this._cacheActiveSpec=void 0},e}(),qW=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeType="dimension",e}return M(e,t),e.prototype.showTooltip=function(t,e,i){var n=T(T({},e),{dimensionInfo:this._preprocessDimensionInfo(t),changePositionOnly:i,tooltip:this.component});return this._showTooltipByHandler(t,n)},e.prototype._getDimensionInfo=function(t){var e,i,n,r,a=this.component.getChart(),o=a.getCompiler().getStage().getLayer(void 0),s={x:t.event.viewX,y:t.event.viewY};if(o.globalTransMatrix.transformPoint({x:t.event.viewX,y:t.event.viewY},s),0===(r=null!==(n=null===(i=(e=this.component.getOption()).getDimensionInfo)||void 0===i?void 0:i.call(e,a,s,!0))&&void 0!==n?n:[]).length)r=void 0;else if(r.length>1){var l=r.filter((function(t){var e,i,n,r,a,o,s=t.axis;if(s.getSpec().hasDimensionTooltip)return!0;if(!$R(s.getScale().type))return!1;try{for(var l=P(null!==(a=null==s?void 0:s.getRegions())&&void 0!==a?a:[]),u=l.next();!u.done;u=l.next()){var c=u.value;try{for(var h=(n=void 0,P(c.getSeries())),d=h.next();!d.done;d=h.next()){var p=d.value;if("cartesian"===p.coordinate){o=p;break}}}catch(t){n={error:t}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}if(U(o))break}}catch(t){e={error:t}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(e)throw e.error}}return U(o)&&o.getDimensionField()[0]===o.fieldY[0]?"left"===s.getOrient()||"right"===s.getOrient():"bottom"===s.getOrient()||"top"===s.getOrient()}));if((r=l.length?l:r.slice(0,1)).length>1){var u=new Set;r.forEach((function(t){t.data=t.data.filter((function(t){var e=t.key;return!u.has(e)&&(u.add(e),!0)}))}))}}return r},e.prototype.getMouseEventData=function(t){return{tooltipInfo:this._getDimensionInfo(t),ignore:!1}},e}(KW),ZW=function(){KF.registerTooltipProcessor("dimension",qW)},JW=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeType="mark",e}return M(e,t),e.prototype.showTooltip=function(t,e,i){var n,r,a,o=t.datum,s=t.series,l=this.component.getSpec(),u=[{datum:[o],series:s}],c=s.tooltipHelper,h=null===(n=s.getSpec())||void 0===n?void 0:n.tooltip,d=null===(r=null==h?void 0:h.mark)||void 0===r?void 0:r.checkOverlap,p=!1;if(!0===d||!0===(null===(a=l.mark)||void 0===a?void 0:a.checkOverlap)&&!1!==d){var f=null==c?void 0:c.activeTriggerSet.mark;if(f){p=!0;var v=this.component.getChart().getCompiler().getStage().getLayer(void 0),g={x:e.event.viewX,y:e.event.viewY};v.globalTransMatrix.transformPoint({x:e.event.viewX,y:e.event.viewY},g),f.forEach((function(t){t.getGraphics().forEach((function(t){t!==e.node&&t&&t.containsPoint(g.x,g.y,xl.GLOBAL,t.stage.getPickerService())&&u[0].datum.push(cH(t))}))}))}}var y=T(T({},e),{model:s,changePositionOnly:i,tooltip:this.component});if(i&&p){var m=this._cacheActiveSpec&&this._cacheActiveSpec.data;m&&m[0].series===u[0].series&&m[0].datum.length===u[0].datum.length&&!m[0].datum.some((function(t,e){return t!==u[0].datum[e]}))||(y.changePositionOnly=!1)}return this._showTooltipByHandler(u,y)},e.prototype.getMouseEventData=function(t){var e,i,n,r=null===(e=t.model)||void 0===e?void 0:e.modelType;if("series"===r){var a=null==(u=(p=t.model).tooltipHelper)?void 0:u.activeTriggerSet.mark,o=null==u?void 0:u.ignoreTriggerSet.mark;(null==a?void 0:a.has(t.mark))?i={mark:t.mark,datum:t.datum,series:p}:(null==o?void 0:o.has(t.mark))&&(n=!0)}else if("component"===r){var s=t.model,l=t.node;if("label"===s.name&&l){var u,c=s.getLabelInfoByTextGraphic(l),h=null!=c?c:{},d=h.baseMark,p=h.series,f=h.labelMark;a=null==(u=p.tooltipHelper)?void 0:u.activeTriggerSet.mark,o=null==u?void 0:u.ignoreTriggerSet.mark;(null==a?void 0:a.has(f))?i={mark:d,datum:l.attribute.data,series:p}:(null==o?void 0:o.has(f))&&(n=!0)}}return{tooltipInfo:i,ignore:n}},e}(KW),QW=function(){KF.registerTooltipProcessor("mark",JW)},$W=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeType="group",e}return M(e,t),e.prototype.showTooltip=function(t,e,i){var n=t.datum,r=t.series,a=[{datum:St(n),series:r}],o=T(T({},e),{groupDatum:this._getGroupDatum(e),changePositionOnly:i,tooltip:this.component});return this._showTooltipByHandler(a,o)},e.prototype.getMouseEventData=function(t){var e,i,n;if("series"===(null===(e=t.model)||void 0===e?void 0:e.modelType)){var r=t.model,a=r.tooltipHelper,o=null==a?void 0:a.activeTriggerSet.group;if(null==o?void 0:o.has(t.mark)){var s=this.component.getSpec()[this.activeType];((null==s?void 0:s.triggerMark)?St(s.triggerMark):[]).includes(null===(i=t.mark)||void 0===i?void 0:i.name)&&(n={mark:t.mark,datum:t.datum,series:r})}}return{tooltipInfo:n,ignore:!1}},e.prototype._getGroupDatum=function(t){var e=t.model,i=t.mark,n=t.datum,r=e;if(["line","area"].includes(i.type))return St(n);var a=r.getViewData().latestData,o=r.getSeriesField();if(!o)return a;var s=St(n)[0][o];return a.filter((function(t){return t[o]===s}))},e}(KW),tG=function(){KF.registerTooltipProcessor("group",$W)},eG=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=xW,i.type="line",i.seriesType=t.SeriesTypeEnum.line,i}return M(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=IW,this._modelOption.getDimensionInfoByValue=OW,this._modelOption.getRectByDimensionData=jW},i.type="line",i.seriesType=t.SeriesTypeEnum.line,i.transformerConstructor=xW,i}(yW);kt(eG,AW);var iG,nG=function(){ZW(),QW(),tG(),CW(),wW(),pW(),KF.registerChart(eG.type,eG)},rG=R(R([],B(Ej),!1),["fill","fillOpacity","background","texture","texturePadding","textureSize","textureColor"],!1),aG=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._isValidPointChannel=function(t){return["x","y","x1","y1","defined"].includes(t)},i}return M(e,t),e.prototype._getDefaultStyle=function(){return T(T({},t.prototype._getDefaultStyle.call(this)),{lineWidth:0})},e.prototype._getSegmentAttributes=function(){return rG},e.prototype._getIgnoreAttributes=function(){return[]},e.type="area",e}(Pj),oG=function(){KF.registerMark(aG.type,aG),lC(),jw(),WI(),HI(),QN(),KF.registerGraphicComponent("area",hg)},sG=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._getSeriesStyle=function(t,i,n){var r,a,o,s,l,u;try{for(var c=P(St(i)),h=c.next();!h.done;h=c.next()){var d=h.value,p=null===(o=e.series.getSeriesStyle(t))||void 0===o?void 0:o(d);if(!1!==p||"fill"!==d&&"stroke"!==d||(p="fill"===d?null===(l=null===(s=e.series.getSeriesStyle(t))||void 0===s?void 0:s("stroke"))||void 0===l?void 0:l[0]:null===(u=e.series.getSeriesStyle(t))||void 0===u?void 0:u("fill")),U(p))return p}}catch(t){r={error:t}}finally{try{h&&!h.done&&(a=c.return)&&a.call(c)}finally{if(r)throw r.error}}return n},e}return M(e,t),e}(EV),lG=T(T(T({},VV),Mj),((iG={}).area={name:"area",type:"area"},iG)),uG=function(){KF.registerAnimation("area",KN),qN(),YN()},cG=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!0,e}return M(e,t),e.prototype._transformLabelSpec=function(t){var e,i,n,r=!1!==(null===(e=t.point)||void 0===e?void 0:e.visible)&&!1!==(null===(n=null===(i=t.point)||void 0===i?void 0:i.style)||void 0===n?void 0:n.visible);this._addMarkLabelSpec(t,(function(t){var e="inside-middle"===t.position;return!r||e?"area":"point"})),this._addMarkLabelSpec(t,"area","areaLabel","initLineLabelMarkStyle",void 0,!0)},e.prototype._transformSpecAfterMergingTheme=function(e,i,n){var r,a,o,s,l;t.prototype._transformSpecAfterMergingTheme.call(this,e,i,n);var u=e.area,c=void 0===u?{}:u,h=e.line,d=void 0===h?{}:h,p=e.seriesMark,f=!1!==c.visible&&!1!==(null===(r=c.style)||void 0===r?void 0:r.visible),v=!1!==d.visible&&!1!==(null===(a=d.style)||void 0===a?void 0:a.visible);c.support3d=!(!c.support3d&&!d.support3d),c.zIndex=U(c.zIndex)||U(d.zIndex)?Math.max(null!==(o=c.zIndex)&&void 0!==o?o:0,null!==(s=d.zIndex)&&void 0!==s?s:0):void 0,c.style&&delete c.style.stroke,c.state&&Object.keys(c.state).forEach((function(t){"style"in c.state[t]?delete c.state[t].style.stroke:delete c.state[t].stroke}));var g=c,y=d;("line"===p||v&&!f)&&(g=d,y=c),c.style=XF({},y.style,g.style),c.state=XF({},y.state,g.state),!1===c.interactive&&(c.style.fillPickable=!1),!1===d.interactive&&(d.style.strokePickable=!1),c.interactive=!(!c.interactive&&null!==(l=d.interactive)&&void 0!==l&&!l),e.area=c,e.line=d},e}(Dj),hG={label:{visible:!1,offset:5,position:"top",style:{stroke:{type:"palette",key:"backgroundColor"},lineWidth:2}},point:{style:{symbolType:"circle"}},seriesMark:"area"},dG=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.area,i.transformerConstructor=cG,i._sortDataByAxis=!1,i}return M(i,e),i.prototype.initMark=function(){var t,e=null!==(t=this._spec.seriesMark)&&void 0!==t?t:"area",n=this._isAreaVisible()||this._isLineVisible();this._areaMark=this._createMark(i.mark.area,{groupKey:this._seriesField,isSeriesMark:n&&"point"!==e},{morphElementKey:this.getDimensionField()[0]}),this.initSymbolMark("point"===e)},i.prototype.initMarkStyle=function(){this.initAreaMarkStyle(),this.initSymbolMarkStyle()},i.prototype.initAreaMarkStyle=function(){var e,i,n,r,a,o=this,s=null!==(n=null===(i=null===(e=this.getSpec().area)||void 0===e?void 0:e.style)||void 0===i?void 0:i.curveType)&&void 0!==n?n:null===(a=null===(r=this.getSpec().line)||void 0===r?void 0:r.style)||void 0===a?void 0:a.curveType,l=s===fV?"horizontal"===this._direction?"monotoneY":"monotoneX":s,u=this._areaMark;if(u){var c=this._isAreaVisible(),h=this._isLineVisible();c||h?u.setVisible(!0):u.setVisible(!1),"horizontal"===this._direction?this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:function(t){var e,i;return MF(o.dataToPositionX1(t),null===(i=null===(e=o._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),y1:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,orient:this._direction},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:this.dataToPositionX.bind(this),y1:function(t){var e,i;return MF(o.dataToPositionY1(t),null===(i=null===(e=o._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",t.AttributeLevel.Series),this.setMarkStyle(u,{fill:!!c&&this.getColorAttribute(),stroke:!!h&&this.getColorAttribute()},"normal",t.AttributeLevel.Series),"zero"!==this._invalidType&&this.setMarkStyle(u,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",t.AttributeLevel.Series),this.getStack()&&this.setMarkStyle(u,{zIndex:function(t){return-t[Cz]}},"normal",t.AttributeLevel.Series),this.setMarkStyle(u,{curveType:l},"normal",t.AttributeLevel.Built_In),Object.keys(u.stateStyle).forEach((function(t){u.stateStyle[t].stroke&&u.setPostProcess("stroke",(function(t){return[t,!1,!1,!1]}),t)}))}},i.prototype.initAnimation=function(){var t,e,i,n,r={direction:this.direction},a=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;if(this._lineMark&&this._lineMark.setAnimationConfig(qV(null===(e=KF.getAnimationInKey("line"))||void 0===e?void 0:e(r,a),ZV("line",this._spec,this._markAttributeContext))),this._areaMark&&this._areaMark.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("area"))||void 0===i?void 0:i(r,a),ZV("area",this._spec,this._markAttributeContext))),this._symbolMark){var o=sj(this);this._symbolMark.setAnimationConfig(qV(null===(n=KF.getAnimationInKey("scaleInOut"))||void 0===n?void 0:n(),ZV("point",this._spec,this._markAttributeContext),o))}},i.prototype._isAreaVisible=function(){var t,e=this._spec.area||{};return!1!==e.visible&&!1!==(null===(t=e.style)||void 0===t?void 0:t.visible)},i.prototype._isLineVisible=function(){var t,e=this._spec.line||{};return!1!==e.visible&&!1!==(null===(t=e.style)||void 0===t?void 0:t.visible)},i.prototype.initTooltip=function(){this._tooltipHelper=new sG(this);var t=this._tooltipHelper.activeTriggerSet,e=t.group,i=t.mark;this._areaMark&&e.add(this._areaMark),this._lineMark&&e.add(this._lineMark),this._symbolMark&&(i.add(this._symbolMark),e.add(this._symbolMark))},i.prototype.viewDataStatisticsUpdate=function(t){e.prototype.viewDataStatisticsUpdate.call(this,t),this.encodeDefined(this._areaMark,"defined")},i.prototype.compile=function(){e.prototype.compile.call(this),this.addSamplingCompile(),this.addOverlapCompile()},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._areaMark,this._symbolMark,this._lineMark]},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this.reCompileSampling()},i.prototype.getSeriesStyle=function(t){var e=this;return function(i){var n,r,a,o,s,l=null!==(n=e._spec.seriesMark)&&void 0!==n?n:"area",u=null!==(a=null===(r=e._seriesMark)||void 0===r?void 0:r.getAttribute(i,t))&&void 0!==a?a:void 0;return"fill"!==i||u&&"line"!==l||(i="stroke",u=null!==(s=null===(o=e._seriesMark)||void 0===o?void 0:o.getAttribute(i,t))&&void 0!==s?s:void 0),"stroke"===i&&q(u)?u[0]:u}},i.type=t.SeriesTypeEnum.area,i.builtInTheme={area:hG},i.mark=lG,i.transformerConstructor=cG,i}(lj);kt(dG,Tj);var pG=function(){uW(),tW(),Rj(),oG(),Ij(),uG(),WU(),NU(),KF.registerSeries(dG.type,dG)},fG=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["point","line","area","seriesMark","activePoint","sampling","samplingFactor","pointDis","pointDisMul","markOverlap","areaLabel","useSequentialAnimation"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),XH(e)},e}(bW),vG=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=fG,i.type="area",i.seriesType=t.SeriesTypeEnum.area,i}return M(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=IW,this._modelOption.getDimensionInfoByValue=OW,this._modelOption.getRectByDimensionData=jW},i.type="area",i.seriesType=t.SeriesTypeEnum.area,i.transformerConstructor=fG,i}(yW);kt(vG,AW);var gG=function(){ZW(),QW(),tG(),wW(),pG(),CW(),KF.registerChart(vG.type,vG)};function yG(t,e){return void 0===e&&(e=!0),function(i,n,r){var a="vertical"===t.direction?t.yField:t.xField,o=null==i?void 0:i[a];return"vertical"===t.direction?{overall:e?t.growFrom():e,orient:o>0?"negative":"positive"}:{overall:!!e&&t.growFrom(),orient:o>0?"positive":"negative"}}}var mG=function(t,e){return void 0===e&&(e=!0),{type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:yG(t,e)}},_G=function(t,e){return void 0===e&&(e=!0),{type:"horizontal"===t.direction?"growWidthOut":"growHeightOut",options:yG(t,e)}},bG={type:"fadeIn"},xG={type:"growCenterIn"};function kG(t,e){if(!1===e)return{};switch(e){case"fadeIn":return bG;case"scaleIn":return xG;default:return mG(t)}}var SG,AG=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return M(e,t),e.prototype._getDefaultStyle=function(){return T(T({},t.prototype._getDefaultStyle.call(this)),{width:void 0,height:void 0,lineWidth:0})},e.type="rect",e}(RN),MG=function(){lC(),rC(),DI("rect",VI),KF.registerMark(AG.type,AG),ZN(),KF.registerGraphicComponent("rect",Wv)},TG=T(T({},VV),((SG={}).bar={name:"bar",type:"rect"},SG.barBackground={name:"barBackground",type:"rect"},SG));function wG(t,e,i){var n,r,a;if(t.values.length>0)if(t.sortDatums.length){var o=t.sortDatums;e&&(o=t.sortDatums.slice().reverse());for(var s=0;s<o.length;s++)a=CG(o[s].datum,a,o[s].series,i,null===(r=(n=o[s].series[i.axisHelper]).getScale)||void 0===r?void 0:r.call(n,0),0===s)}else{var l=t.series;e&&(l=l.slice().reverse()),l.forEach((function(t,n){for(var r,o,s=t.s,l=t.values,u=null===(o=(r=s[i.axisHelper]).getScale)||void 0===o?void 0:o.call(r,0),c=0;c<l.length;c++){var h=l[e?l.length-1-c:c];a=CG(h,a,s,i,u,0===c&&0===n)}}))}for(var u in t.nodes)wG(t.nodes[u],e,i)}function CG(t,e,i,n,r,a){var o=i.getSpec().barMinHeight,s=i[n.axisHelper].isInverse(),l=MF(i[n.startMethod](t),r),u=MF(i[n.endMethod](t),r);a&&(e=l);var c=Math.abs(l-u);c<o&&(c=o);var h=1;return u<l?h=-1:u===l&&(h=n.isVertical?s?1:-1:s?-1:1),u=e+h*c,t[n.start]=e,t[n.end]=u,u}var EG=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!0,e}return M(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"bar")},e}(nj),PG={label:{visible:!1,position:"outside",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}},BG=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.bar,i._barMarkName="bar",i._barMarkType="rect",i.transformerConstructor=EG,i._bandPosition=0,i._getLinearBarRange=function(t,e){var n=B([t,e].sort((function(t,e){return t-e})),2),r=n[0],a=n[1],o=a-r;if(i._spec.barGap){var s=.5*i._spec.barGap;r=r+s,a=a-s}var l=a-r,u=OF(i._spec.barMinWidth||2,o);if(l<u){var c=(u-l)/2;r-=c,a+=c}return[r,a]},i._getBarXStart=function(t,e,n){return i._shouldDoPreCalculate()?(i._calculateStackRectPosition(!1),t[jV]):i._spec.barMinHeight?i._calculateRectPosition(t,!1,n):MF(i._dataToPosX(t),e,n)},i._getBarXEnd=function(t,e,n){return i._shouldDoPreCalculate()?(i._calculateStackRectPosition(!1),t[UV]):MF(i._dataToPosX1(t),e,n)},i._getLinearBarXRange=function(t,e,n){var r=MF(i._dataToPosX(t),e,n),a=MF(i._dataToPosX1(t),e,n);return i._getLinearBarRange(r,a)},i._getBarYStart=function(t,e){return i._shouldDoPreCalculate()?(i._calculateStackRectPosition(!0),t[WV]):i._spec.barMinHeight?i._calculateRectPosition(t,!0):MF(i._dataToPosY(t),e)},i._getBarYEnd=function(t,e){return i._shouldDoPreCalculate()?(i._calculateStackRectPosition(!0),t[GV]):MF(i._dataToPosY1(t),e)},i._getLinearBarYRange=function(t,e,n){var r=MF(i._dataToPosY(t),e,n),a=MF(i._dataToPosY1(t),e,n);return i._getLinearBarRange(r,a)},i._getBarBackgroundXStart=function(t){var e=t.range();return Math.min(e[0],e[e.length-1])},i._getBarBackgroundXEnd=function(t){var e=t.range();return Math.max(e[0],e[e.length-1])},i._getBarBackgroundYStart=function(t){var e=t.range();return Math.min(e[0],e[e.length-1])},i._getBarBackgroundYEnd=function(t){var e=t.range();return Math.max(e[0],e[e.length-1])},i._getBarBackgroundPositionXEncoder=function(){var t;return null===(t=i._barBackgroundPositionXEncoder)||void 0===t?void 0:t.bind(i)},i._setBarBackgroundPositionXEncoder=function(t){i._barBackgroundPositionXEncoder=t.bind(i)},i._getBarBackgroundPositionYEncoder=function(){var t;return null===(t=i._barBackgroundPositionYEncoder)||void 0===t?void 0:t.bind(i)},i._setBarBackgroundPositionYEncoder=function(t){i._barBackgroundPositionYEncoder=t.bind(i)},i}return M(i,e),i.prototype.initMark=function(){this._initBarBackgroundMark(),this._barMark=this._createMark(T(T({},i.mark.bar),{name:this._barMarkName,type:this._barMarkType}),{groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this.getDimensionField()[0],morph:$V(this._spec,this._barMarkName)})},i.prototype._initBarBackgroundMark=function(){this._spec.barBackground&&this._spec.barBackground.visible&&(this._barBackgroundMark=this._createMark(i.mark.barBackground,{dataView:this._barBackgroundViewData.getDataView(),dataProductId:this._barBackgroundViewData.getProductId()}))},i.prototype.initMarkStyle=function(){this._barMark&&this.setMarkStyle(this._barMark,{fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series)},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:function(t){return t[e.getStackValueField()]},z:this._fieldZ?this.dataToPositionZ.bind(this):null})},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this);var t=this._tooltipHelper.activeTriggerSet,i=t.mark,n=t.group;this._barMark&&(i.add(this._barMark),n.add(this._barMark))},i.prototype._statisticViewData=function(){var t,i,n=this;e.prototype._statisticViewData.call(this);var r=null!==(t=this._spec.barBackground)&&void 0!==t?t:{};if(r.visible){var a,o=this._getRelatedComponentSpecInfo("axes").some((function(t){return t.type===I.cartesianBandAxis}));if(kH(this._option.dataSet,"addVChartProperty",xV),o){var s=function(t,e){for(var i,r,a,o=B(t,1)[0],s=e.scaleDepth,l=[{}],u=n.getDimensionField(),c=j(s)?u.length:Math.min(u.length,s),h=0;h<c;h++){var d=u[h],p=null===(r=o.latestData[d])||void 0===r?void 0:r.values;if(null==p?void 0:p.length){for(var f=[],v=null!==(a=n._spec.dataKey)&&void 0!==a?a:Sz,g=0;g<p.length;g++)for(var y=0;y<l.length;y++)f.push(T(T({},l[y]),((i={})[d]=p[g],i[v]=p[g],i)));l=f}}return l};kH(this._option.dataSet,"dimensionItems",s),a=new hs(this._option.dataSet).parse([this._viewDataStatistics],{type:"dataview"}).transform({type:"dimensionItems",options:{scaleDepth:j(r.fieldLevel)?void 0:r.fieldLevel+1}},!1).transform({type:"addVChartProperty",options:{beforeCall:FV.bind(this),call:zV}},!1),null===(i=this._viewDataStatistics)||void 0===i||i.target.addListener("change",a.reRunAllTransform)}else{s=function(t){B(t,1)[0];var e=[],i=B(n.getDimensionContinuousField(),2),r=i[0],a=i[1],o={};return l.latestData.forEach((function(t){var i,n="".concat(t[r],"-").concat(t[a]);o[n]||(o[n]=((i={})[r]=t[r],i[a]=t[a],i),e.push(o[n]))})),e};kH(this._option.dataSet,"dimensionItems",s);var l=this.getViewData();a=new hs(this._option.dataSet).parse([l],{type:"dataview"}).transform({type:"dimensionItems"},!1).transform({type:"addVChartProperty",options:{beforeCall:FV.bind(this),call:zV}},!1),null==l||l.target.addListener("change",a.reRunAllTransform)}this._barBackgroundViewData=new wN(this._option,a)}},i.prototype.init=function(t){var i,n;e.prototype.init.call(this,t),"vertical"===this.direction?"band"===(null===(i=this._xAxisHelper)||void 0===i?void 0:i.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle():"band"===(null===(n=this._yAxisHelper)||void 0===n?void 0:n.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle()},i.prototype._shouldDoPreCalculate=function(){var t=this,e=this.getRegion();return this.getStack()&&e.getSeries().filter((function(e){return e.type===t.type&&e.getSpec().barMinHeight})).length},i.prototype._calculateStackRectPosition=function(t){var e=this,i=this.getRegion();if(!i._bar_series_position_calculated){var n,r,a,o,s;i._bar_series_position_calculated=!0,t?(n=GV,r=WV,a="_dataToPosY1",o="_dataToPosY",s="_yAxisHelper"):(n=UV,r=jV,a="_dataToPosX1",o="_dataToPosX",s="_xAxisHelper");var l=Xz(i,!1,(function(t){return t.type===e.type}));for(var u in l)for(var c in l[u].nodes)wG(l[u].nodes[c],i.getStackInverse(),{isVertical:t,start:n,end:r,startMethod:a,endMethod:o,axisHelper:s})}},i.prototype._calculateRectPosition=function(t,e,i){var n,r,a,o,s;e?(a="_dataToPosY1",o="_dataToPosY",s="_yAxisHelper"):(a="_dataToPosX1",o="_dataToPosX",s="_xAxisHelper");var l=null===(r=(n=this[s]).getScale)||void 0===r?void 0:r.call(n,0),u=this[s].isInverse(),c=this._spec.barMinHeight,h=MF(this[a](t),l,i),d=MF(this[o](t),l,i),p=Math.abs(h-d);p<c&&(p=c);var f=1;return d<h?f=-1:d===h&&(f=e?u?1:-1:u?-1:1),h+f*p},i.prototype._dataToPosX=function(t){return this.dataToPositionX(t)},i.prototype._dataToPosX1=function(t){return this.dataToPositionX1(t)},i.prototype._dataToPosY=function(t){return this.dataToPositionY(t)},i.prototype._dataToPosY1=function(t){return this.dataToPositionY1(t)},i.prototype.initBandRectMarkStyle=function(){var e,i,n,r,a=this,o=null===(i=null===(e=this._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0),s=null===(r=null===(n=this._yAxisHelper)||void 0===n?void 0:n.getScale)||void 0===r?void 0:r.call(n,0);"horizontal"===this.direction?this.setMarkStyle(this._barMark,{x:function(t){return a._getBarXStart(t,o)},x1:function(t){return a._getBarXEnd(t,o)},y:function(t){return a._getPosition(a.direction,t)},height:function(){return a._getBarWidth(a._yAxisHelper)},width:function(){},y1:function(){}},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._barMark,{y:function(t){return a._getBarYStart(t,s)},y1:function(t){return a._getBarYEnd(t,s)},x:function(t){return a._getPosition(a.direction,t)},width:function(){return a._getBarWidth(a._xAxisHelper)},x1:function(){},height:function(){}},"normal",t.AttributeLevel.Series),this._initStackBarMarkStyle(),this._initBandBarBackgroundMarkStyle()},i.prototype._initStackBarMarkStyle=function(){var t,e,i,n,r=this;if(this._spec.stackCornerRadius){var a=null===(e=null===(t=this._xAxisHelper)||void 0===t?void 0:t.getScale)||void 0===e?void 0:e.call(t,0),o=null===(n=null===(i=this._yAxisHelper)||void 0===i?void 0:i.getScale)||void 0===n?void 0:n.call(i,0);this._barMark.setMarkConfig({clip:!0,clipPath:function(){var t=[];return r._forEachStackGroup((function(e){var i,n,s=1/0,l=-1/0,u=!1,c=1/0,h=-1/0;e.values.forEach((function(t){var e=t[wz],i=t[Cz],n=t[Ez],r=t[Pz];s=Math.min(s,e,i),l=Math.max(l,e,i),U(n)&&U(r)&&(u=!0,c=Math.min(c,n,r),h=Math.max(h,n,r))}));var d=T(T(T({},e.values[0]),((i={})[wz]=s,i[Cz]=l,i)),u?((n={})[Ez]=c,n[Pz]=h,n):void 0),p="horizontal"===r.direction?{x:r._getBarXStart(d,a),x1:r._getBarXEnd(d,a),y:r._getPosition(r.direction,d),height:r._getBarWidth(r._yAxisHelper)}:{y:r._getBarYStart(d,o),y1:r._getBarYEnd(d,o),x:r._getPosition(r.direction,d),width:r._getBarWidth(r._xAxisHelper)};t.push(Wv(T(T({},p),{cornerRadius:V(r._spec.stackCornerRadius)?r._spec.stackCornerRadius(p,d,r._markAttributeContext):r._spec.stackCornerRadius,fill:!0})))})),t}})}},i.prototype.initLinearRectMarkStyle=function(){var e,i,n,r,a=this,o=null===(i=null===(e=this._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0),s=null===(r=null===(n=this._yAxisHelper)||void 0===n?void 0:n.getScale)||void 0===r?void 0:r.call(n,0);if("horizontal"===this.direction){var l=U(this._fieldY2)?{y:function(t){return a._getLinearBarYRange(t,s,!0)[0]},y1:function(t){return a._getLinearBarYRange(t,s,!0)[1]}}:{y:function(t){return MF(a._dataToPosY(t)-a._getBarWidth(a._yAxisHelper)/2,s,!0)},height:function(t){return a._getBarWidth(a._yAxisHelper)}};this.setMarkStyle(this._barMark,T({x:function(t){return a._getBarXStart(t,o,!0)},x1:function(t){return a._getBarXEnd(t,o,!0)}},l),"normal",t.AttributeLevel.Series),this.setMarkStyle(this._barBackgroundMark,T({x:function(){return a._getBarBackgroundXStart(o)},x1:function(){return a._getBarBackgroundXEnd(o)}},l),"normal",t.AttributeLevel.Series)}else{var u=U(this._fieldX2)?{x:function(t){return a._getLinearBarXRange(t,o,!0)[0]},x1:function(t){return a._getLinearBarXRange(t,o,!0)[1]}}:{x:function(t){return MF(a._dataToPosX(t)-a._getBarWidth(a._xAxisHelper)/2,o,!0)},width:function(t){return a._getBarWidth(a._xAxisHelper)}};this.setMarkStyle(this._barMark,T(T({},u),{y:function(t){return a._getBarYStart(t,s)},y1:function(t){return a._getBarYEnd(t,s)}}),"normal",t.AttributeLevel.Series),this.setMarkStyle(this._barBackgroundMark,T(T({},u),{y:function(){return a._getBarBackgroundYStart(s)},y1:function(){return a._getBarBackgroundYEnd(s)}}),"normal",t.AttributeLevel.Series)}},i.prototype._initBandBarBackgroundMarkStyle=function(){var e,i,n,r,a,o=this;if(this._barBackgroundMark){var s=null===(i=null===(e=this._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0),l=null===(r=null===(n=this._yAxisHelper)||void 0===n?void 0:n.getScale)||void 0===r?void 0:r.call(n,0),u=null!==(a=this._spec.barBackground)&&void 0!==a?a:{},c=j(u.fieldLevel)?void 0:u.fieldLevel+1;"horizontal"===this.direction?this.setMarkStyle(this._barBackgroundMark,{x:function(){return o._getBarBackgroundXStart(s)},x1:function(){return o._getBarBackgroundXEnd(s)},y:function(t){return o._getPosition(o.direction,t,c,"barBackground")},height:function(){return o._getBarWidth(o._yAxisHelper,c)},width:function(){},y1:function(){}},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._barBackgroundMark,{x:function(t){return o._getPosition(o.direction,t,c,"barBackground")},y:function(){return o._getBarBackgroundYStart(l)},y1:function(){return o._getBarBackgroundYEnd(l)},width:function(){return o._getBarWidth(o._xAxisHelper,c)},x1:function(){},height:function(){}},"normal",t.AttributeLevel.Series)}},i.prototype.initAnimation=function(){var t,e,i=this,n={yField:this._fieldY[0],xField:this._fieldX[0],direction:this.direction,growFrom:function(){var t,e="horizontal"===i.direction?null===(t=i._xAxisHelper)||void 0===t?void 0:t.getScale(0):i._yAxisHelper.getScale(0);if(e){var n=e.domain(),r=Tt(n),a=Mt(n);return a<0?e.scale(a):r>0?e.scale(r):e.scale(0)}}},r=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset,a=sj(this);this._barMark.setAnimationConfig(qV(null===(e=KF.getAnimationInKey("bar"))||void 0===e?void 0:e(n,r),ZV(this._barMarkName,this._spec,this._markAttributeContext),a))},i.prototype._getBarWidth=function(t,e){var i,n,r=this._groups?this._groups.fields.length:1,a=j(e)?r:Math.min(r,e),o=null!==(n=null===(i=t.getBandwidth)||void 0===i?void 0:i.call(t,a-1))&&void 0!==n?n:6,s=U(this._spec.barWidth)&&a===r,l=U(this._spec.barMinWidth),u=U(this._spec.barMaxWidth),c=o;return s&&(c=OF(this._spec.barWidth,o)),l&&(c=Math.max(c,OF(this._spec.barMinWidth,o))),u&&(c=Math.min(c,OF(this._spec.barMaxWidth,o))),c},i.prototype._getPosition=function(t,e,i,n){var r,a,o,s,l,u,c,h;"horizontal"===t?(u=this.getYAxisHelper(),c="height",h="barBackground"===n?this.dataToBarBackgroundPositionY.bind(this):this.dataToPositionY.bind(this)):(u=this.getXAxisHelper(),c="width",h="barBackground"===n?this.dataToBarBackgroundPositionX.bind(this):this.dataToPositionX.bind(this));var d=u.getScale(0),p=this._groups?this._groups.fields.length:1,f=j(i)?p:Math.min(p,i),v=null!==(a=null===(r=u.getBandwidth)||void 0===r?void 0:r.call(u,f-1))&&void 0!==a?a:6,g=f===p?this._barMark.getAttribute(c,e):v;if(f>1&&U(this._spec.barGapInGroup)){for(var y=this._groups.fields,m=St(this._spec.barGapInGroup),_=0,b=0,x=y.length-1;x>=1;x--){var k=y[x],S=null!==(s=null===(o=u.getScale(x))||void 0===o?void 0:o.domain())&&void 0!==s?s:[],A=S.length,M=OF(null!==(l=m[x-1])&&void 0!==l?l:At(m),v),T=S.indexOf(e[k]);x===y.length-1?(_+=A*g+(A-1)*M,b+=T*(g+M)):(b+=T*(_+M),_+=_+(A-1)*M)}return d.scale(e[y[0]])+u.getBandwidth(0)/2-_/2+b}var w=JR(d.type||"band");return h(e,f)+.5*(v-g)+(w?-v/2:0)},i.prototype.dataToBarBackgroundPositionX=function(t,e){return this._dataToPosition(t,this._xAxisHelper,this.fieldX,e,this._getBarBackgroundPositionXEncoder,this._setBarBackgroundPositionXEncoder)},i.prototype.dataToBarBackgroundPositionY=function(t,e){return this._dataToPosition(t,this._yAxisHelper,this.fieldY,e,this._getBarBackgroundPositionYEncoder,this._setBarBackgroundPositionYEncoder)},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this.getRegion()._bar_series_position_calculated=!1,this._spec.sampling&&this.compile()},i.prototype.onDataUpdate=function(){e.prototype.onDataUpdate.call(this),this.getRegion()._bar_series_position_calculated=!1},i.prototype.compile=function(){if(e.prototype.compile.call(this),this._spec.sampling){var t=this._region.getLayoutRect(),i=t.width,n=t.height,r=this._fieldY,a=this._fieldX;this._data.setTransform([{type:"sampling",size:"horizontal"===this._direction?n:i,factor:this._spec.samplingFactor,yfield:"horizontal"===this._direction?a[0]:r[0],groupBy:this._seriesField,mode:this._spec.sampling}])}},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._barMark]},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._barBackgroundViewData)||void 0===t||t.compile()},i.prototype.fillData=function(){var t,i;e.prototype.fillData.call(this),null===(i=null===(t=this._barBackgroundViewData)||void 0===t?void 0:t.getDataView())||void 0===i||i.reRunAllTransform()},i.prototype.viewDataUpdate=function(t){var i,n,r;e.prototype.viewDataUpdate.call(this,t),null===(n=null===(i=this._barBackgroundViewData)||void 0===i?void 0:i.getDataView())||void 0===n||n.reRunAllTransform(),null===(r=this._barBackgroundViewData)||void 0===r||r.updateData()},i.prototype.release=function(){var t;e.prototype.release.call(this),null===(t=this._barBackgroundViewData)||void 0===t||t.release(),this._barBackgroundViewData=null},i.type=t.SeriesTypeEnum.bar,i.builtInTheme={bar:PG},i.mark=TG,i.transformerConstructor=EG,i}(lj),RG=function(){uW(),MG(),KF.registerAnimation("bar",(function(t,e){return{appear:kG(t,e),enter:mG(t,!1),exit:_G(t,!1),disappear:_G(t)}})),WU(),NU(),KF.registerSeries(BG.type,BG)},LG=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barMinHeight","sampling","samplingFactor","barBackground","stackCornerRadius","useSequentialAnimation"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),XH(e)},e.prototype._transformAxisSpec=function(e){var i,n;if(t.prototype._transformAxisSpec.call(this,e),e.axes){var r=e.series.some((function(t){return"horizontal"===t.direction})),a=null!==(i=e.axes.find((function(t){return"band"===t.type})))&&void 0!==i?i:e.axes.find((function(t){return(r?["left","right"]:["top","bottom"]).includes(t.orient)}));if(a&&!a.bandSize&&!a.maxBandSize&&!a.minBandSize&&e.autoBandSize){var o=W(e.autoBandSize)&&null!==(n=e.autoBandSize.extend)&&void 0!==n?n:0,s=e.series.find((function(t){return"bar"===t.type})),l=s.barMaxWidth,u=s.barMinWidth,c=s.barWidth,h=s.barGapInGroup;this._applyAxisBandSize(a,o,{barMaxWidth:l,barMinWidth:u,barWidth:c,barGapInGroup:h})}}},e}(bW),IG=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=LG,i.type="bar",i.seriesType=t.SeriesTypeEnum.bar,i}return M(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=IW,this._modelOption.getDimensionInfoByValue=OW,this._modelOption.getRectByDimensionData=jW},i.type="bar",i.seriesType=t.SeriesTypeEnum.bar,i.transformerConstructor=LG,i}(yW);kt(IG,AW);var DG,OG=function(){ZW(),QW(),tG(),wW(),RG(),CW(),KF.registerChart(IG.type,IG)},FG=[10,20],zG=GR.Linear,HG="circle",NG=GR.Ordinal,VG=["circle","square","triangle","diamond","star"],jG=function(t,e){return"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"}},UG=T(T({},VV),((DG={}).point={name:"point",type:"symbol"},DG)),WG=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"point")},e}(nj),GG={point:{style:{size:8,symbolType:"circle",lineWidth:0,fillOpacity:.8}},label:{visible:!1,offset:5,position:"top",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}},YG=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.scatter,i.transformerConstructor=WG,i._invalidType="zero",i}return M(i,e),i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this._size=this._spec.size,this._sizeField=this._spec.sizeField,this._shape=this._spec.shape,this._shapeField=this._spec.shapeField},i.prototype._getSeriesAttribute=function(t,e,i,n){var r,a,o,s,l=i.defaultScaleType,u=i.defaultRange;if(V(e))return e;if(q(e)){if(j(t))return null===(r=this._option)||void 0===r||r.onError("".concat(n,"Field is required.")),e;if("ordinal"!==l&&e.length>2)return null===(a=this._option)||void 0===a||a.onError("".concat(n," length is invalid, specify up to 2 ").concat(n,"s.")),e;var c="".concat(mz,"_series_scatter_").concat(this.id,"_scale_").concat(n);return this._option.globalScale.registerModelScale({id:c,type:l,domain:[{dataId:this._rawData.name,fields:[t]}],range:e}),{scale:c,field:t}}if(W(e)){if(j(t))return null===(o=this._option)||void 0===o||o.onError("".concat(n,"Field is required.")),e;c="".concat(mz,"_series_scatter_").concat(this.id,"_scale_").concat(n);var h=T({id:c,type:l,domain:[{dataId:this._rawData.name,fields:[t]}],range:u},e);return this._option.globalScale.registerModelScale(h),{scale:h.id,field:t}}return null===(s=this._option)||void 0===s||s.onError("".concat(n," attribute is invalid.")),e},i.prototype.getSizeAttribute=function(t,e){return j(e)?10:Q(e)?e:K(e)&&$(e)?parseFloat(e):this._getSeriesAttribute(t,e,{defaultScaleType:zG,defaultRange:FG},"size")},i.prototype.getShapeAttribute=function(t,e){return j(e)?HG:K(e)?e:this._getSeriesAttribute(t,e,{defaultScaleType:NG,defaultRange:VG},"shape")},i.prototype.initMark=function(){this._symbolMark=this._createMark(i.mark.point,{groupKey:this._seriesField,isSeriesMark:!0},{morph:$V(this._spec,i.mark.point.name),morphElementKey:this.getDimensionField()[0]})},i.prototype.initMarkStyle=function(){this.initSymbolMarkStyle()},i.prototype.initAnimation=function(){var t,e,i,n=sj(this),r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._symbolMark.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("scatter"))||void 0===i?void 0:i({},r),ZV("point",this._spec,this._markAttributeContext),n))},i.prototype.initSymbolMarkStyle=function(){var e=this._symbolMark;e&&("zero"!==this._invalidType&&this.setMarkStyle(e,{visible:this._getInvalidDefined.bind(this)}),this.setMarkStyle(e,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,fill:this.getColorAttribute(),size:Q(this._size)||V(this._size)?this._size:10,symbolType:K(this._shape)||V(this._shape)?this._shape:HG},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series),(U(this._sizeField)||U(this._size))&&this.setMarkStyle(e,{size:this.getSizeAttribute(this._sizeField,this._size)},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.User_Mark),(U(this._shapeField)||U(this._shape))&&this.setMarkStyle(e,{symbolType:this.getShapeAttribute(this._shapeField,this._shape)},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.User_Mark))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._symbolMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._symbolMark)},i.prototype.viewDataStatisticsUpdate=function(i){var n=this;e.prototype.viewDataStatisticsUpdate.call(this,i);var r=[this.getDimensionField()[0],this.getStackValueField()].every((function(t){var e,i,r;return t&&(null===(r=null===(i=null===(e=n.getViewDataStatistics())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i[t])||void 0===r?void 0:r.allValid)}));"zero"===this._invalidType||r?this.setMarkStyle(this._symbolMark,{visible:!0},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._symbolMark,{visible:this._getInvalidDefined.bind(this)},"normal",t.AttributeLevel.Series),this._symbolMark.getProduct()&&this._symbolMark.compileEncode()},i.prototype.initLabelMarkStyle=function(e){var i=this;e&&(this._labelMark=e,this.setMarkStyle(e,{fill:this.getColorAttribute(),text:function(t){return t[i.getStackValueField()]},z:this._fieldZ?this.dataToPositionZ.bind(this):null},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series),"zero"!==this._invalidType&&this.setMarkStyle(e,{visible:this._getInvalidDefined.bind(this)},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series))},i.prototype.handleZoom=function(t){var e,i,n=this;this.getMarksWithoutRoot().forEach((function(t){if(t){var e=t.getGraphics();e&&e.length&&e.forEach((function(t,e){var i,r,a=null===(r=null===(i=null==t?void 0:t.context)||void 0===i?void 0:i.data)||void 0===r?void 0:r[0],o=n.dataToPosition(a);o&&t&&t.translateTo(o.x,o.y)}))}}));var r=null===(i=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent())||void 0===i?void 0:i.getProduct();r&&r.evaluate(null,null)},i.prototype.handlePan=function(t){this.handleZoom(t)},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[this._symbolMark]},i.type=t.SeriesTypeEnum.scatter,i.mark=UG,i.builtInTheme={scatter:GG},i.transformerConstructor=WG,i}(lj),XG=function(){Ij(),KF.registerAnimation("scatter",(function(t,e){return T({appear:jG(0,e)},WN)})),WU(),NU(),KF.registerSeries(YG.type,YG)},KG=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["point","size","shape","shapeField","sizeField"])},e}(bW),qG=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=KG,i.type="scatter",i.seriesType=t.SeriesTypeEnum.scatter,i}return M(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=IW,this._modelOption.getDimensionInfoByValue=OW,this._modelOption.getRectByDimensionData=jW},i.type="scatter",i.seriesType=t.SeriesTypeEnum.scatter,i.transformerConstructor=KG,i}(yW);kt(qG,AW);var ZG,JG=function(){ZW(),QW(),CW(),wW(),XG(),KF.registerChart(qG.type,qG)},QG=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.geo,i.coordinate="geo",i._nameProperty="name",i}return M(i,e),i.prototype.getMapViewData=function(){var t;return null===(t=this._mapViewData)||void 0===t?void 0:t.getDataView()},Object.defineProperty(i.prototype,"nameField",{get:function(){return this._nameField},set:function(t){this._nameField=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"valueField",{get:function(){return this._valueField},set:function(t){this._valueField=t},enumerable:!1,configurable:!0}),i.prototype.getNameProperty=function(){return this._nameProperty},i.prototype.getCentroidProperty=function(){return this._centroidProperty},i.prototype.getCoordinateHelper=function(){return this._coordinateHelper},i.prototype.setCoordinateHelper=function(t){this._coordinateHelper=t},i.prototype.getStatisticFields=function(){var t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t},i.prototype.getGroupFields=function(){return null},i.prototype.dataToPosition=function(t,e){var i,n=null;if(!t)return n;if(e&&!this.isDatumInViewData(t))return n;var r=this._coordinateHelper,a=r.dataToPosition,o=r.latitudeField,s=r.longitudeField;if(null===(n=this.nameToPosition(t))){var l=s?null==t?void 0:t[s]:Number.NaN,u=o?null==t?void 0:t[o]:Number.NaN;n=null!==(i=null==a?void 0:a([l,u]))&&void 0!==i?i:null}return n},i.prototype.nameToPosition=function(t){var e=this.getDatumName(t);return j(e)?null:this.nameValueToPosition(e)},i.prototype.nameValueToPosition=function(t){var e,i,n=this,r=null===(i=null===(e=this.getMapViewData())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i.filter((function(e){return n.getDatumName(e)===t}))[0];if(j(r))return null;var a=this._coordinateHelper.dataToPosition,o=this.getDatumCenter(r),s=null==a?void 0:a(o);return j(s)||isNaN(s.x)||isNaN(s.y)?null:s},i.prototype.dataToLatitude=function(t){return this._coordinateHelper?(0,this._coordinateHelper.dataToLatitude)(t):Number.NaN},i.prototype.dataToLongitude=function(t){return this._coordinateHelper?(0,this._coordinateHelper.dataToLatitude)(t):Number.NaN},i.prototype.valueToPosition=function(t,e){return{x:this.dataToLongitude(t),y:this.dataToLatitude(e)}},i.prototype.positionToData=function(t){},i.prototype.latitudeToData=function(t){},i.prototype.longitudeToData=function(t){},i.prototype.dataToPositionX=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.dataToPositionY=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.dataToPositionZ=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.release=function(){e.prototype.release.call(this),this._mapViewData.release(),this._mapViewData=this._mapViewDataStatistics=null},i.prototype.getStackGroupFields=function(){return[this._nameField]},i.prototype.getStackValueField=function(){return this._spec.valueField},i.prototype.compileData=function(){var t;null===(t=this._mapViewData)||void 0===t||t.compile()},i.prototype.initStatisticalData=function(){if(e.prototype.initStatisticalData.call(this),this._mapViewData){var t="".concat(mz,"_series_").concat(this.id,"_mapViewDataStatic");this._mapViewDataStatistics=this.createStatisticalData(t,this._mapViewData.getDataView()),this._mapViewData.getDataView().target.removeListener("change",this._mapViewDataStatistics.reRunAllTransform)}},i.prototype.getSeriesKeys=function(){var t,e,i,n,r;return this._seriesField?null!==(r=null!==(e=null===(t=this.getRawDataStatisticsByField(this._seriesField))||void 0===t?void 0:t.values)&&void 0!==e?e:null===(n=null===(i=this._mapViewDataStatistics)||void 0===i?void 0:i.latestData[this._seriesField])||void 0===n?void 0:n.values)&&void 0!==r?r:[]:this.name?[this.name]:this.userId?["".concat(this.userId)]:["".concat(this.type,"_").concat(this.id)]},i.prototype.fillData=function(){var t,i;e.prototype.fillData.call(this),null===(t=this._mapViewData.getDataView())||void 0===t||t.reRunAllTransform(),null===(i=this._mapViewDataStatistics)||void 0===i||i.reRunAllTransform()},i.prototype.getActiveMarks=function(){return[]},i}(rj),$G="".concat(mz,"_MAP_LOOK_UP_KEY"),tY=function(t,e){return t.features&&t.features.forEach((function(t,i){var n;t[kz]=i;var r=null===(n=t.properties)||void 0===n?void 0:n[e.nameProperty];e.nameMap&&e.nameMap[r]?t[$G]=e.nameMap[r]:t[$G]=r})),t.features},eY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dimensionTooltipTitleCallback=function(t){var i,n=e.series;return null!==(i=e._getDimensionData(t))&&void 0!==i?i:n.getDatumName(t)},e}return M(e,t),e}(EV),iY=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return M(e,t),e.prototype._getDefaultStyle=function(){return T(T({},t.prototype._getDefaultStyle.call(this)),{lineWidth:0,path:""})},e.type="path",e}(RN),nY=function(){KF.registerMark(iY.type,iY),lC(),tC(),KF.registerGraphicComponent("path",lg)},rY=T(T({},VV),((ZG={}).area={name:"area",type:"path"},ZG)),aY=function(){function t(t){this.projection=function(t,e){var i=t.toLowerCase();return arguments.length>1?vs(i,e):ps[i]?(ds[i]||(ds[i]=vs(i,ps[i])),ds[i]):null}(t.type)()}return t.prototype.fit=function(t,e,i){var n={type:"FeatureCollection",features:i};this.projection.fitExtent([t,e],n)},t.prototype.center=function(t){var e,i;null===(i=null===(e=this.projection)||void 0===e?void 0:e.center)||void 0===i||i.call(e,t)},t.prototype.project=function(t){var e;return null===(e=this.projection)||void 0===e?void 0:e.call(this,t)},t.prototype.shape=function(t){var e,i;return null===(i=null===(e=this.projection)||void 0===e?void 0:e.path)||void 0===i?void 0:i.call(e,t)},t.prototype.invert=function(t){var e,i;return null===(i=null===(e=this.projection)||void 0===e?void 0:e.invert)||void 0===i?void 0:i.call(e,t)},t.prototype.scale=function(t){var e;if(null===(e=this.projection)||void 0===e?void 0:e.scale){if(void 0===t)return this.projection.scale();this.projection.scale(t)}},t.prototype.translate=function(t){var e;if(null===(e=this.projection)||void 0===e?void 0:e.scale){if(void 0===t)return this.projection.translate();this.projection.translate(t)}},t.prototype.evaluate=function(t,e,i){var n=this.projection.copy();return null==n?void 0:n.fitExtent([t,e],{type:"FeatureCollection",features:i})},t}(),oY=function(){function t(){}return t.prototype.parserScrollEvent=function(t){return t?!(t.ctrlKey||0===t.deltaY&&0===t.deltaX)&&(t.scrollX=t.deltaX,t.scrollY=t.deltaY,t):t},t.prototype.parserZoomEvent=function(t){if(!t)return t;var e=Math.pow(1.0005,-t.deltaY*Math.pow(16,t.deltaMode));return t.zoomDelta=e,t.zoomX=t.canvasX,t.zoomY=t.canvasY,t},t.prototype.clearZoom=function(){},t.prototype.clearScroll=function(){},t.prototype.clearDrag=function(){},t}(),sY=function(){function t(){this._lastScale=0}return t.prototype.clearZoom=function(){this._lastScale=0},t.prototype.parserZoomEvent=function(t){var e=t.scale;if(0===this._lastScale)return this._lastScale=e,t;t.zoomDelta=e/this._lastScale;var i=t.center;return t.zoomX=i.x,t.zoomY=i.y,this._lastScale=e,t},t.prototype.parserScrollEvent=function(t){return t},t.prototype.clearScroll=function(){},t.prototype.clearDrag=function(){},t}();function lY(e){return e===t.RenderModeEnum["desktop-browser"]||e===t.RenderModeEnum["desktop-miniApp"]?{start:"pointerdown",move:"pointermove",end:["pointerup","pointerupoutside"],zoom:"wheel",zoomEnd:"pointerup",scroll:"wheel",trigger:oY}:gx(e)||yx(e)?{start:"pointerdown",move:"pointermove",end:["pointerup","pointerupoutside","pointerleave"],zoom:"pinch",zoomEnd:"pinchend",scroll:"pan",scrollEnd:"panend",trigger:sY}:null}var uY={debounce:Jt,throttle:Qt},cY=function(){function e(){this._isGestureListener=!1}return e.prototype.initZoomable=function(e,i){void 0===i&&(i=t.RenderModeEnum["desktop-browser"]),this._eventObj=e,this._renderMode=i,this._gestureController=this._option.getCompiler()._gestureController,this._isGestureListener=gx(this._renderMode)||yx(this._renderMode),lY(this._renderMode)&&(this._clickEnable=!0,this._zoomableTrigger=new(this._getZoomTriggerEvent("trigger")))},e.prototype._getZoomTriggerEvent=function(t){return lY(this._renderMode)[t]},e.prototype._zoomEventDispatch=function(t,e,i,n){if(this._isGestureListener||t.event){var r=this._isGestureListener?t:t.event.clone();this._zoomableTrigger.parserZoomEvent(r);var a=r,o=a.zoomDelta,s=a.zoomX,l=a.zoomY,u=a.path;if((n||u.some((function(t){return t.name&&t.name.includes("region")})))&&!j(o)&&ti({x:s,y:l},this._getRegionOrSeriesLayout(e),!1)){this._clearDragEvent(),this._zoomableTrigger.clearScroll();var c={};i&&(c=i({zoomDelta:o,zoomX:s,zoomY:l},r)),this._eventObj.emit("zoom",T(T({scale:r.zoomDelta,scaleCenter:{x:r.zoomX,y:r.zoomY}},c),{model:this}))}}},e.prototype._getRegionOrSeriesLayout=function(t){"region"!==t.type&&(t=t.getRegion());var e=t.layout.getLayout(),i=e.x,n=e.y;return{x1:i,y1:n,x2:i+e.width,y2:n+e.height}},e.prototype._bindZoomEventAsRegion=function(t,e,i,n){var r,a,o,s,l=this,u=null!==(o=null==n?void 0:n.delayType)&&void 0!==o?o:"throttle",c=null!==(s=null==n?void 0:n.delayTime)&&void 0!==s?s:0,h=this._isGestureListener?this._gestureController:t,d=this._isGestureListener?[this._getZoomTriggerEvent("zoom")]:[this._getZoomTriggerEvent("zoom"),{level:gH.chart,consume:!0}],p=this._isGestureListener?[this._getZoomTriggerEvent("zoomEnd")]:[this._getZoomTriggerEvent("zoomEnd"),{level:gH.chart,consume:!1}];(r=h).on.apply(r,R(R([],B(p),!1),[uY[u]((function(t){l._zoomableTrigger.clearZoom()}),c)],!1)),(a=h).on.apply(a,R(R([],B(d),!1),[uY[u]((function(t){var r;l._zoomEventDispatch(t,e,i,null!==(r=null==n?void 0:n.allowComponentZoom)&&void 0!==r&&r)}),c)],!1))},e.prototype.initZoomEventOfSeries=function(t,e,i){this._option.disableTriggerEvent||lY(this._renderMode)&&this._bindZoomEventAsRegion(t.event,t,e,i)},e.prototype.initZoomEventOfRegions=function(t,e,i,n){var r=this;this._option.disableTriggerEvent||lY(this._renderMode)&&t.forEach((function(t){e?t.getSeries().forEach((function(t){e(t)&&r._bindZoomEventAsRegion(t.event,t,i,n)})):r._bindZoomEventAsRegion(r._eventObj,t,i,n)}))},e.prototype._scrollEventDispatch=function(t,e,i){var n=!1;if(!this._isGestureListener&&(!t.event||this._option.disableTriggerEvent))return n;var r=this._isGestureListener?t:t.event;this._zoomableTrigger.parserScrollEvent(r);var a=r,o=a.scrollX,s=a.scrollY,l=a.canvasX,u=a.canvasY;return j(o)&&j(s)?n:ti({x:l,y:u},this._getRegionOrSeriesLayout(e),!1)?(this._clearDragEvent(),this._zoomableTrigger.clearZoom(),i&&(n=i({scrollX:o,scrollY:s},r)),this._eventObj.emit("scroll",{scrollX:o,scrollY:s,model:this}),n):n},e.prototype._bindScrollEventAsRegion=function(t,e,i,n){var r,a,o,s,l=this,u=null!==(o=null==n?void 0:n.delayType)&&void 0!==o?o:"throttle",c=null!==(s=null==n?void 0:n.delayTime)&&void 0!==s?s:0,h=this._isGestureListener?this._gestureController:t,d=this._isGestureListener?[this._getZoomTriggerEvent("scroll")]:[this._getZoomTriggerEvent("scroll"),{level:gH.chart,consume:!0}],p=this._isGestureListener?[this._getZoomTriggerEvent("scrollEnd")]:[this._getZoomTriggerEvent("scrollEnd"),{level:gH.chart,consume:!1}];(r=h).on.apply(r,R(R([],B(p),!1),[uY[u]((function(t){l._zoomableTrigger.clearScroll()}),c)],!1)),(a=h).on.apply(a,R(R([],B(d),!1),[uY[u]((function(t){return l._scrollEventDispatch(t,e,i)}),c)],!1))},e.prototype.initScrollEventOfSeries=function(t,e,i){lY(this._renderMode)&&this._bindScrollEventAsRegion(t.event,t,e,i)},e.prototype.initScrollEventOfRegions=function(t,e,i,n){var r=this;this._option.disableTriggerEvent||lY(this._renderMode)&&t.forEach((function(t){e?t.getSeries().forEach((function(t){e(t)&&r._bindScrollEventAsRegion(t.event,t,i,n)})):r._bindScrollEventAsRegion(r._eventObj,t,i,n)}))},e.prototype._bindDragEventAsRegion=function(t,e,i,n){var r=this;t.on(this._getZoomTriggerEvent("start"),{level:gH.chart},(function(t){if(t.event){var a=t.event;ti({x:a.canvasX,y:a.canvasY},r._getRegionOrSeriesLayout(e),!1)&&r._handleDrag(t,i,n)}})),t.on("click",{level:gH.chart},(function(){return!r._clickEnable}))},e.prototype.initDragEventOfSeries=function(t,e,i){var n=this;this._option.disableTriggerEvent||lY(this._renderMode)&&t.event.on(this._getZoomTriggerEvent("start"),{level:gH.model,filter:function(e){var i=e.model;return(null==i?void 0:i.id)===t.id}},(function(t){n._handleDrag(t,e,i)}))},e.prototype.initDragEventOfRegions=function(t,e,i,n){var r=this;this._option.disableTriggerEvent||lY(this._renderMode)&&t.forEach((function(t){e?t.getSeries().forEach((function(t){e(t)&&(t.event.on(r._getZoomTriggerEvent("start"),{level:gH.model,filter:function(e){var i=e.model;return(null==i?void 0:i.id)===t.id}},(function(t){r._handleDrag(t,i)})),t.event.on("click",{level:gH.model,filter:function(e){var i=e.model;return(null==i?void 0:i.id)===t.id}},(function(){return!r._clickEnable})))})):r._bindDragEventAsRegion(r._eventObj,t,i,n)}))},e.prototype._clearDragEvent=function(){var t=this,e=this._getZoomTriggerEvent("move"),i=this._getZoomTriggerEvent("end");this._handleDragMouseMove&&(this._eventObj.off(e,{level:gH.chart,source:vH.chart},this._handleDragMouseMove),this._handleDragMouseMove=void 0),this._handleDragMouseUp&&(i.forEach((function(e){t._eventObj.off(e,{level:gH.chart,source:vH.chart},t._handleDragMouseUp),t._eventObj.allow(e)})),this._handleDragMouseUp=void 0)},e.prototype.isDragEnable=function(t){if(this._isGestureListener&&this._gestureController){var e=this._gestureController.cachedEvents;return!e||e.length<2}return!0},e.prototype._handleDrag=function(t,e,i){var n,r,a,o=this;if(this._clearDragEvent(),!this._option.disableTriggerEvent&&(this._clickEnable=!1,this.isDragEnable(t.event))){this._zoomableTrigger.clearZoom(),this._zoomableTrigger.clearScroll();var s=null!==(n=null==i?void 0:i.delayType)&&void 0!==n?n:"throttle",l=null!==(r=null==i?void 0:i.delayTime)&&void 0!==r?r:0,u=null===(a=null==i?void 0:i.realTime)||void 0===a||a,c=this._getZoomTriggerEvent("move"),h=this._getZoomTriggerEvent("end"),d=t.event,p=d.canvasX,f=d.canvasY,v=d.canvasX,g=d.canvasY;this._handleDragMouseUp=uY[s]((function(t){o._clickEnable=!0;var i=t.event,n=[i.canvasX-v,i.canvasY-g];v=i.canvasX,g=i.canvasY,!u&&e&&e(n,t.event),o._eventObj.emit("panend",{delta:n,model:o}),o._clearDragEvent()}),l),this._handleDragMouseMove=uY[s]((function(t){if(o.isDragEnable(t.event)){o._clickEnable=!1,h.forEach((function(t){o._eventObj.prevent(t,{handler:o._handleDragMouseUp,level:gH.chart})}));var i=t.event,n=[i.canvasX-p,i.canvasY-f];p=i.canvasX,f=i.canvasY,u&&e&&e(n,t.event),o._eventObj.emit("panmove",{delta:n,model:o})}}),l),this._eventObj.on(c,{level:gH.chart,source:vH.chart},this._handleDragMouseMove),h.forEach((function(t){o._eventObj.on(t,{level:gH.chart,source:vH.chart},o._handleDragMouseUp)}))}},e}();function hY(t,e){return"".concat(mz,"_").concat(e,"_").concat(t)}var dY=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=I.geoCoordinate,i.name=I.geoCoordinate,i.layoutType="none",i.layoutZIndex=t.LayoutZIndex.Mark,i._projectionSpec={name:hY(i.type,i.id),type:"mercator"},i._actualScale=1,i._initialScale=1,i.effect={scaleUpdate:function(){i.coordinateHelper()}},i._handleChartZoom=function(t,e){var n,r,a,o,s,l,u=t.zoomDelta,c=i._actualScale;return i._actualScale*=u,i._actualScale<(null===(n=i._spec.zoomLimit)||void 0===n?void 0:n.min)?(i._actualScale=null===(r=i._spec.zoomLimit)||void 0===r?void 0:r.min,u=(null===(a=i._spec.zoomLimit)||void 0===a?void 0:a.min)/c):i._actualScale>(null===(o=i._spec.zoomLimit)||void 0===o?void 0:o.max)&&(i._actualScale=null===(s=i._spec.zoomLimit)||void 0===s?void 0:s.max,u=(null===(l=i._spec.zoomLimit)||void 0===l?void 0:l.max)/c),i.zoom(u,[t.zoomX,t.zoomY]),{scale:u,totalScale:i._actualScale}},i.pan=function(t){var e,n,r;void 0===t&&(t=[0,0]);var a=null!==(n=null===(e=i._projection)||void 0===e?void 0:e.translate())&&void 0!==n?n:[0,0],o=a[0],s=a[1];o+=t[0],s+=t[1],null===(r=i._projection)||void 0===r||r.translate([o,s])},i}return M(i,e),Object.defineProperty(i.prototype,"longitudeField",{get:function(){return this._longitudeField},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"latitudeField",{get:function(){return this._latitudeField},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"projectionSpec",{get:function(){return this._projectionSpec},enumerable:!1,configurable:!0}),i.prototype.setProjection=function(t){this._projectionSpec=T(T({},t),{name:this._projectionSpec.name})},i.prototype.getZoom=function(){return this._actualScale},i.getSpecInfo=function(t){if(j(t))return null;var e=[];return t.region.forEach((function(t,i){if("geo"===t.coordinate){var n=T(T({},t),{padding:0});e.push({spec:n,regionIndex:i,type:I.geoCoordinate,specInfoPath:["component","geoCoordinate",i]})}})),e},i.prototype.setAttrFromSpec=function(){var t,i,n;e.prototype.setAttrFromSpec.call(this),this._spec.roam&&this.initZoomable(this.event,this._option.mode),this._projectionSpec=XF(this._projectionSpec,this._spec.projection),this._projectionSpec.zoom>(null===(t=this._spec.zoomLimit)||void 0===t?void 0:t.max)&&(this._projectionSpec.zoom=this._spec.zoomLimit.max),this._projectionSpec.zoom<(null===(i=this._spec.zoomLimit)||void 0===i?void 0:i.min)&&(this._projectionSpec.zoom=this._spec.zoomLimit.min),this._actualScale=null!==(n=this._projectionSpec.zoom)&&void 0!==n?n:1,this._initialScale=this._actualScale,this._longitudeField=this._spec.longitudeField,this._latitudeField=this._spec.latitudeField},i.prototype.created=function(){e.prototype.created.call(this),this._regions=this._option.getRegionsInIndex([this._option.regionIndex]),this.initProjection(),this.coordinateHelper(),this.initEvent(),this._initCenterCache()},i.prototype.dispatchZoom=function(t,e){var i=e||{x:this.getLayoutStartPoint().x+this.getLayoutRect().width/2,y:this.getLayoutStartPoint().y+this.getLayoutRect().height/2},n=this._handleChartZoom({zoomDelta:t,zoomX:i.x,zoomY:i.y}),r=n.scale,a=n.totalScale;1!==r&&this.event.emit("zoom",{scale:r,scaleCenter:i,totalScale:a,model:this})},i.prototype.initEvent=function(){var e=this;this.event.on(t.ChartEvent.scaleUpdate,{filter:function(t){var i=t.model;return(null==i?void 0:i.id)===e.id}},this.effect.scaleUpdate.bind(this));var i=this._spec.roam;i&&(this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom),this.initDragEventOfRegions(this._regions,i.blank?null:function(){return!0},this.pan),this._regions.forEach((function(t){t.getSeries().forEach((function(t){t.event.on("zoom",(function(e){return t.handleZoom(e),!0})),t.event.on("panmove",(function(e){return t.handlePan(e),!0}))}))})))},i.prototype.initProjection=function(){var t;this._projection=new aY(this._projectionSpec),null!==this._projection.projection||null===(t=this._option)||void 0===t||t.onError("unsupported projection type!")},i.prototype.coordinateHelper=function(){var e=this,i={longitudeField:this._longitudeField,latitudeField:this._latitudeField,dataToPosition:this.dataToPosition.bind(this),dataToLongitude:this.dataToLongitude.bind(this),dataToLatitude:this.dataToLatitude.bind(this),shape:this.shape.bind(this),getCoordinateId:function(){return e.id}};this._regions.forEach((function(n){n.getSeries().forEach((function(n){n.type===t.SeriesTypeEnum.map||n.type===t.SeriesTypeEnum.pictogram?n.setCoordinateHelper(i):(n.setXAxisHelper(T(T({},i),{isContinuous:!0,dataToPosition:function(t,i){var r,a=t[0];if(j(a)&&(null==i?void 0:i.datum)){var o=i.datum[n.getDimensionField()[0]];a=null===(r=e._centerCache.get(o))||void 0===r?void 0:r.x}return e.dataToLongitude(a)},valueToPosition:function(t,i){var r;if(j(t)&&(null==i?void 0:i.datum)){var a=i.datum[n.getDimensionField()[0]];t=null===(r=e._centerCache.get(a))||void 0===r?void 0:r.x}return e.dataToLongitude(t)},getFields:function(){return[e._longitudeField]},getAxisType:function(){return e.type},getAxisId:function(){return e.id},isInverse:function(){return!1}})),n.setYAxisHelper(T(T({},i),{isContinuous:!0,dataToPosition:function(t,i){var r,a=t[0];if(j(a)&&(null==i?void 0:i.datum)){var o=i.datum[n.getDimensionField()[0]];a=null===(r=e._centerCache.get(o))||void 0===r?void 0:r.y}return e.dataToLatitude(a)},valueToPosition:function(t,i){var r;if(j(t)&&(null==i?void 0:i.datum)){var a=i.datum[n.getDimensionField()[0]];t=null===(r=e._centerCache.get(a))||void 0===r?void 0:r.y}return e.dataToLatitude(t)},getFields:function(){return[e._latitudeField]},getAxisType:function(){return e.type},getAxisId:function(){return e.id},isInverse:function(){return!1}})))}))}))},i.prototype.onLayoutEnd=function(){this.setLayoutRect(this._regions[0].getLayoutRect()),this.setLayoutStartPosition(this._regions[0].getLayoutStartPoint());var i=this.getLayoutRect(),n=i.width,r=i.height,a=this.evaluateProjection([0,0],[n,r]),o=a.translate,s=a.scale,l=a.center;o&&this._projection.translate(o),s&&this._projection.scale(s),l&&this._projection.center(l),iF(this._regions,(function(e){var i;if(e.type===t.SeriesTypeEnum.map||e.type===t.SeriesTypeEnum.pictogram){null===(i=e.areaPath)||void 0===i||i.clear();var n=e.getRootMark().getProduct();n&&n.attribute.postMatrix&&n.setAttributes({postMatrix:new xi})}})),this._actualScale=this._initialScale,e.prototype.onLayoutEnd.call(this)},i.prototype.collectFeatures=function(){var e=[];return this._regions.forEach((function(i){i.getSeries().forEach((function(i){var n,r;i.type!==t.SeriesTypeEnum.map&&i.type!==t.SeriesTypeEnum.pictogram||e.push.apply(e,R([],B(null!==(r=null===(n=i.getMapViewData())||void 0===n?void 0:n.latestData)&&void 0!==r?r:[]),!1))}))})),e},i.prototype.dataToPosition=function(t){var e;void 0===t&&(t=[]);var i=null===(e=this._projection)||void 0===e?void 0:e.project([t[0],t[1]]);return{x:null==i?void 0:i[0],y:null==i?void 0:i[1]}},i.prototype.dataToLatitude=function(t){var e,i=null===(e=this._projection)||void 0===e?void 0:e.project([0,t]);return null==i?void 0:i[1]},i.prototype.dataToLongitude=function(t){var e,i=null===(e=this._projection)||void 0===e?void 0:e.project([t,0]);return null==i?void 0:i[0]},i.prototype.zoom=function(t,e){var i,n,r,a,o,s;void 0===e&&(e=[0,0]);var l=null!==(n=null===(i=this._projection)||void 0===i?void 0:i.scale())&&void 0!==n?n:0,u=null!==(a=null===(r=this._projection)||void 0===r?void 0:r.translate())&&void 0!==a?a:[0,0],c=u[0],h=u[1];l*=t,c-=(e[0]-c)*(t-1),h-=(e[1]-h)*(t-1),null===(o=this._projection)||void 0===o||o.scale(l),null===(s=this._projection)||void 0===s||s.translate([c,h])},i.prototype.shape=function(t){return this._projection.shape(t)},i.prototype.invert=function(t){return this._projection.invert(t)},i.prototype.evaluateProjection=function(t,e){var i,n=this._projection.evaluate(t,e,this.collectFeatures()),r=n.translate(),a=n.scale()*this._initialScale,o=null!==(i=this._projectionSpec.center)&&void 0!==i?i:n.invert([e[0]/2,e[1]/2]);return o&&(r=[e[0]/2,e[1]/2]),{translate:r,scale:a,center:o}},i.prototype._initCenterCache=function(){var t=this;this._centerCache||(this._centerCache=new Map),this._regions.forEach((function(e){e.getSeries().forEach((function(e){var i,n;"map"===e.type&&(null!==(n=null===(i=e.getMapViewData())||void 0===i?void 0:i.latestData)&&void 0!==n?n:[]).forEach((function(i){void 0===i&&(i={});var n=i[e.getDimensionField()[0]]||i[$G],r=e.getDatumCenter(i);n&&U(r)&&t._centerCache.set(n,{x:r[0],y:r[1]})}))}))}))},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reMake||(n.reMake=["roam","longitudeField","latitudeField","projection","zoomLimit"].some((function(e){return!bt(null==i?void 0:i[e],t[e])}))),n},i.prototype.release=function(){e.prototype.release.call(this),this._centerCache&&this._centerCache.clear(),this._centerCache=null},i.type=I.geoCoordinate,i}(yU);kt(dY,cY);var pY=function(){KF.registerComponent(dY.type,dY)},fY=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"area",void 0,void 0,!1)},e}(nj),vY={defaultFillColor:"#f3f3f3",area:{style:{lineWidth:.5,strokeOpacity:1,stroke:"black",fillOpacity:1}},label:{interactive:!1,style:{fontSize:{type:"token",key:"l6FontSize"},lineHeight:{type:"token",key:"l6LineHeight"},textBaseline:"middle",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},stroke:{type:"palette",key:"backgroundColor"}}}},gY=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.map,i.transformerConstructor=fY,i._areaCache=new Map,i}return M(i,e),i.prototype.getNameMap=function(){return this._nameMap},Object.defineProperty(i.prototype,"areaPath",{get:function(){return this._areaCache},enumerable:!1,configurable:!0}),i.prototype.setAttrFromSpec=function(){var t,i;e.prototype.setAttrFromSpec.call(this),this.map=this._spec.map,this._nameMap=this._spec.nameMap,this._nameField=this._spec.nameField,this._valueField=this._spec.valueField,this._spec.nameProperty&&(this._nameProperty=this._spec.nameProperty),this._spec.centroidProperty&&(this._centroidProperty=this._spec.centroidProperty),this.map||null===(t=this._option)||void 0===t||t.onError("map type '".concat(this.map,"' is not specified !")),MH.get(this.map)||null===(i=this._option)||void 0===i||i.onError("'".concat(this.map,"' data is not registered !"))},i.prototype.initData=function(){var i,n,r=this;e.prototype.initData.call(this),kH(this._dataSet,"copyDataView",IH),kH(this._dataSet,"map",tY),kH(this._dataSet,"lookup",bV);var a=MH.get(this.map);a||null===(i=this._option)||void 0===i||i.onError("no valid map data found!");var o=new hs(this._dataSet,{name:"map_".concat(this.id,"_data")});o.parse([a],{type:"dataview"}).transform({type:"copyDataView",options:{deep:!0},level:t.TransformLevel.copyDataView}).transform({type:"map",options:{nameMap:this._nameMap,nameProperty:this._nameProperty}}).transform({type:"lookup",options:{from:function(){var t;return null===(t=r._data)||void 0===t?void 0:t.getLatestData()},key:$G,fields:this._nameField,set:function(t,e){e&&Object.keys(e).forEach((function(i){i in t||(t[i]=e[i])}))}}}),null===(n=this._data)||void 0===n||n.getDataView().target.addListener("change",o.reRunAllTransform),this._mapViewData=new wN(this._option,o)},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._mapViewData)||void 0===t||t.compile()},i.prototype.initMark=function(){this._pathMark=this._createMark(i.mark.area,{groupKey:this.getDimensionField()[0],isSeriesMark:!0},{morph:$V(this._spec,i.mark.area.name),morphElementKey:this.getDimensionField()[0]}),this._pathMark.setData(this._mapViewData)},i.prototype.initMarkStyle=function(){var e=this,i=this._pathMark;i&&(this.setMarkStyle(i,{fill:function(t){var i,n,r,a;return U(t[null!==(i=e._seriesField)&&void 0!==i?i:Az])?(null!==(n=e._option.globalScale.getScale("color"))&&void 0!==n?n:e._getDefaultColorScale()).scale(t[null!==(r=e._seriesField)&&void 0!==r?r:Az]):null===(a=e._spec)||void 0===a?void 0:a.defaultFillColor},path:this.getPath.bind(this)},"normal",t.AttributeLevel.Series),i.setPostProcess("fill",(function(t){return U(t)?t:e._spec.defaultFillColor})),this.setMarkStyle(i,{smoothScale:!0},"normal",t.AttributeLevel.Built_In))},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&(this._labelMark=t,this.setMarkStyle(t,{text:function(t){return e.getDatumName(t)},x:function(t){var i;return null===(i=e.dataToPosition(t))||void 0===i?void 0:i.x},y:function(t){var i;return null===(i=e.dataToPosition(t))||void 0===i?void 0:i.y}}))},i.prototype.initAnimation=function(){var t;this._pathMark.setAnimationConfig(qV(null===(t=KF.getAnimationInKey("fadeInOut"))||void 0===t?void 0:t(),ZV("area",this._spec,this._markAttributeContext)))},i.prototype.initTooltip=function(){this._tooltipHelper=new eY(this),this._pathMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pathMark)},i.prototype.getPath=function(t){var e,i=this._areaCache.get(t[kz]);if(i)return i.shape;var n=null===(e=this._coordinateHelper)||void 0===e?void 0:e.shape(t);return this._areaCache.set(t[kz],{shape:n}),n},i.prototype.onEvaluateEnd=function(){this._mapViewData.updateData()},i.prototype.getDimensionField=function(){return[this.nameField]},i.prototype.getMeasureField=function(){return[this.valueField]},i.prototype.release=function(){e.prototype.release.call(this),this._areaCache.clear(),this._nameMap={},this._mapViewData=null},i.prototype.handleZoom=function(t){var e,i=t.scale,n=t.scaleCenter;if(1!==i){var r=this.getRootMark().getProduct();r&&(r.attribute.postMatrix||r.setAttributes({postMatrix:new xi}),r.scale(i,i,n));var a=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent();a&&a.renderInner()}},i.prototype.handlePan=function(t){var e,i=t.delta;if(0!==i[0]||0!==i[1]){var n=this.getRootMark().getProduct();n&&(n.attribute.postMatrix||n.setAttributes({postMatrix:new xi}),n.translate(i[0],i[1]));var r=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent();r&&r.renderInner()}},i.prototype.getDatumCenter=function(t){var e,i,n,r;return this._centroidProperty&&(null===(e=t.properties)||void 0===e?void 0:e[this._centroidProperty])?null===(i=t.properties)||void 0===i?void 0:i[this._centroidProperty]:et(t.centroidX*t.centroidY)?[t.centroidX,t.centroidY]:(null===(n=t.properties)||void 0===n?void 0:n.center)?t.properties.center:(null===(r=t.properties)||void 0===r?void 0:r.centroid)?t.properties.centroid:[Number.NaN,Number.NaN]},i.prototype.getDatumName=function(t){var e;if(t[this.nameField])return t[this.nameField];var i=null===(e=t.properties)||void 0===e?void 0:e[this._nameProperty];if(i){if(this._spec.nameMap&&this._spec.nameMap[i])return this._spec.nameMap[i];if(this._spec.showDefaultName||!this._spec.nameMap)return i}return""},i.prototype.dataToPositionX=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.dataToPositionY=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.viewDataUpdate=function(t){var i,n,r;e.prototype.viewDataUpdate.call(this,t),null===(n=null===(i=this._mapViewData)||void 0===i?void 0:i.getDataView())||void 0===n||n.reRunAllTransform(),null===(r=this._mapViewData)||void 0===r||r.updateData()},i.prototype._getDataIdKey=function(){return kz},i.prototype.getActiveMarks=function(){return[this._pathMark]},i.type=t.SeriesTypeEnum.map,i.mark=rY,i.builtInTheme={map:vY},i.transformerConstructor=fY,i}(QG),yY=function(){pY(),nY(),KF.registerSeries(gY.type,gY),KF.registerImplement("registerMap",wH),KF.registerImplement("unregisterMap",CH),XN()},mY="".concat(mz,"_waterfall_default_seriesField"),_Y=function(t,e){if(!t||0===t.length)return t;var i=e.indexField,n=e.total,r=e.groupData,a=[],o=r().latestData,s=o.dimensionValues,l=o.dimensionData,u=Array.from(s[i]),c={start:0,end:0,positive:0,negative:0,lastIndex:null};return u.forEach((function(t,i){var r={start:c.end,end:c.end,lastIndex:c.lastIndex,lastEnd:c.end,index:t,isTotal:!1,positive:c.end,negative:c.end},o=!0===e.stackInverse?l[t].reverse():l[t];if(null==o||o.forEach((function(t,e){e===o.length-1?t[Dz]=!0:delete t[Dz]})),o.length>1){var s=function(t){if(n&&"end"!==n.type){if("field"===n.type||"custom"===n.type){return!!t[n.tagField]}}else if(i===u.length-1)return!0;return!1};if(o.some((function(t){return s(t)})))return c=function(t,e,i,n,r,a,o,s,l){i.isTotal=!0;var u=s.valueField,c=s.startAs,h=s.endAs,d=s.total,p=[],f=[];if(t.forEach((function(t){l(t)?f.push(t):p.push(t)})),f.length===t.length){var v=bY([t[0]],e,i,n,r,a,o,s);return f.forEach((function(e){e[c]=t[0][c],e[h]=t[0][h],e[u]=t[0][u]})),v}var g=xY(f[0],i,n,r,d),y=g.start,m=g.end;i.start=y,i.end=m;var _=y,b=y,x=m-y;return p.forEach((function(t){var e=+t[u];e>=0?(t[c]=+_,_=Le(_,e)):(t[c]=+b,b=Le(b,e)),t[h]=Le(t[c],e),y=Le(y,e),x=Ie(x,e)})),f.forEach((function(t){t[c]=+y,t[h]=Le(t[c],x),t[u]=x})),T(T({},i),{lastIndex:e})}(o,t,r,a,c,u,i,e,s),void a.push(r)}c=bY(o,t,r,a,c,u,i,e),a.push(r)})),a};function bY(t,e,i,n,r,a,o,s){var l=s.valueField,u=s.startAs,c=s.endAs,h=s.total,d=s.seriesField,p=s.seriesFieldName;return t.forEach((function(t){var e=!1;if(h&&"end"!==h.type){if("field"===h.type||"custom"===h.type){if(t[h.tagField]){e=!0;var s=xY(t,i,n,r,h),f=s.start,v=s.end;t[u]=f,t[c]=v,t[l]=v-f,i.start=f,i.end=v}}}else o===a.length-1&&(i.start=0,t[u]=i.start,t[c]=i.end,e=!0);if(!e){var g=+t[l];g>=0?(t[u]=+i.positive,i.positive=Le(i.positive,g)):(t[u]=+i.negative,i.negative=Le(i.negative,g)),t[c]=Le(t[u],g),i.end=Le(i.end,g)}i.isTotal=e,(j(d)||d===mY)&&(t[mY]=e?p.total:+t[l]>=0?p.increase:p.decrease)})),T(T({},i),{lastIndex:e})}function xY(t,e,i,n,r){return r&&"end"!==r.type?"field"===r.type||"custom"===r.type?"custom"===r.type?function(t,e,i){return i.product(t,e)}(t,n,r):r.collectCountField&&!j(t[r.collectCountField])?function(t,e,i,n){var r=0,a=i.end,o=e.length-+t[n.collectCountField],s=e.length-1;o<0?cx("total.collectCountField error"):r=e[o].start;s<0?cx("total.collectCountField error"):a=e[s].end;return{start:r,end:a}}(t,i,e,r):function(t,e,i){var n=0,r=e.end;i.startField&&!j(t[i.startField])&&(n=+t[i.startField]);i.valueField&&!j(t[i.valueField])&&(r=Le(n,+t[i.valueField]));return{start:n,end:r}}(t,e,r):{start:0,end:0}:function(t){return{start:0,end:t.end}}(e)}var kY=function(t,e){var i;if(!t)return t;var n=e.indexField,r=e.valueField,a=e.total,o=e.seriesField,s=((i={})[n]=(null==a?void 0:a.text)||"total",i[r]=t.reduce((function(t,e){return Le(t,+e[r])}),0),i);return o&&(s[o]="total"),t.push(s),t},SY={type:"fadeIn"},AY={type:"growCenterIn"};function MY(t,e){switch(e){case"fadeIn":return SY;case"scaleIn":return AY;default:return mG(t,!1)}}var TY,wY=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return M(e,t),e.prototype._getDefaultStyle=function(){return T(T({},t.prototype._getDefaultStyle.call(this)),{x1:0,y1:0})},e.prototype._transformGraphicAttributes=function(e,i,n){var r=t.prototype._transformGraphicAttributes.call(this,e,i,n),a=r.x,o=r.x1,s=r.y,l=r.y1,u=w(r,["x","x1","y","y1"]);return T(T({},u),{points:[{x:a,y:s},{x:o,y:l}]})},e.prototype._createGraphic=function(t){return void 0===t&&(t={}),Nv(t)},e.type="rule",e}(RN),CY=function(){KF.registerMark(wY.type,wY),lC(),Qw(),KF.registerGraphicComponent("line",Nv)},EY=T(T({},TG),((TY={}).leaderLine={name:"leaderLine",type:"rule"},TY.stackLabel={name:"stackLabel",type:"text"},TY)),PY=function(t,e){if(!e.fields)return t;var i={};return{dimensionValues:i,dimensionData:BY(t.map((function(t){return t.latestData})).flat(),e.fields,i)}};function BY(t,e,i){if(0===e.length)return t;var n=e[0],r=e.slice(1);i[n]=new Set;var a,o,s=function(t,e,i){var n={};return t.forEach((function(t){var r=t[e];n[r]||(n[r]=[],i.add(r)),n[r].push(t)})),n}(t,n,i[n]);return r.length?(a=s,o=function(t,e){return BY(t,r,i)},Object.keys(a).reduce((function(t,e){return t[e]=o(a[e],e),t}),{})):s}var RY=function(){function t(t){this._fields=[],this._fields=t}return Object.defineProperty(t.prototype,"fields",{get:function(){return this._fields},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"groupData",{get:function(){return this._groupData},enumerable:!1,configurable:!0}),t.prototype.initData=function(t,e){var i=t.name,n=new hs(e instanceof cs?e:t.dataSet);n.name=i,n.parse([t],{type:"dataview"}),kH(e,"dimensionTree",PY),n.transform({type:"dimensionTree",options:{fields:this._fields}},!1),n.target.addListener("change",this.groupDataUpdate.bind(this)),this._groupData=n},t.prototype.groupDataUpdate=function(){},t.prototype.getGroupValueInField=function(t){var e,i,n,r=null===(n=null===(i=null===(e=this.groupData)||void 0===e?void 0:e.latestData)||void 0===i?void 0:i.dimensionValues)||void 0===n?void 0:n[t];return r?Array.from(r):[]},t}(),LY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!1,e}return M(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"bar"),this._addMarkLabelSpec(t,"bar","stackLabel","initStackLabelMarkStyle")},e}(EG),IY={rect:HY,symbol:zY,arc:VY,point:function(t){var e;e=!1!==t.labelSpec.overlap&&{clampForce:!1,avoidBaseMark:!1};return{position:"center",overlap:e}},"line-data":function(t){var e=zY(t);N(e.overlap)||(e.overlap.avoidBaseMark=!1,e.overlap.clampForce=!1);return e},stackLabel:jY,line:UY,area:UY,rect3d:HY,arc3d:VY,treemap:function(t){return{customLayoutFunc:function(t,e){return e},overlap:!1}},venn:function(t){return{customLayoutFunc:function(t,e){return e},smartInvert:!0}}};function DY(e,i){var n,r=i.labelSpec;r.overlap&&!W(r.overlap)&&(r.overlap={});var a=null!==(n=IY[e])&&void 0!==n?n:IY.point;return i.series.type===t.SeriesTypeEnum.sankey?function(t){var e,i,n,r,a=t.series,o=t.labelSpec,s=void 0===o?{}:o,l=null!==(e=FY(s.position))&&void 0!==e?e:"outside",u=a.direction,c=l;K(l)&&("vertical"===u?c="inside-start"===l?function(t){return"inside-left"}:"inside-middle"===l?function(t){return"center"}:"inside-end"===l?function(t){return"inside-right"}:function(t){return"bottom"}:"inside-start"===l?c=function(t){return"inside-left"}:"inside-middle"===l?c=function(t){return"center"}:"inside-end"===l?c=function(t){return"inside-right"}:"outside"===l&&(c=function(t){return"right"}));r=!1!==s.overlap&&((!K(l)||!l.includes("inside"))&&{strategy:null!==(n=null===(i=s.overlap)||void 0===i?void 0:i.strategy)&&void 0!==n?n:WY(a)});return{position:c,overlap:r,smartInvert:!1,offset:0,syncState:!0}}(i):a(i)}function OY(e,i,n,r){var a,o,s=e.labelMark,l=e.series,u=l.getMeasureField()[0],c=s.getAttributesOfState(i);if("text"in c||(c.text=null!==(a=c.text)&&void 0!==a?a:i[u]),"textType"in c||(c.textType=null!==(o=e.labelSpec.textType)&&void 0!==o?o:"text"),c.data=i,l.type!==t.SeriesTypeEnum.sankey){var h=mV(n,r,c.text,i),d=h.formatFunc,p=h.args;d&&(c._originText=c.text,c.text=d.apply(void 0,R(R([],B(p),!1),[{series:l}],!1)))}return c}function FY(t){return V(t)?function(e){return t(e.data)}:t}function zY(t){var e,i,n,r=t.series,a=t.labelSpec,o="horizontal"===r.direction?"right":"top",s=null!==(e=FY(a.position))&&void 0!==e?e:o;return{position:s,overlap:!1!==a.overlap&&{strategy:null!==(n=null===(i=a.overlap)||void 0===i?void 0:i.strategy)&&void 0!==n?n:([{type:"position",position:["top","bottom","right","left","top-right","top-left","bottom-left","bottom-right"]}],[{type:"position",position:["top","bottom","right","left","top-right","top-left","bottom-left","bottom-right"]}]),avoidBaseMark:"center"!==s}}}function HY(t){var e,i,n,r,a,o,s,l,u=t.series,c=t.labelSpec,h=void 0===c?{}:c,d=null!==(e=FY(h.position))&&void 0!==e?e:"outside",p=null!==(i=u.direction)&&void 0!==i?i:"vertical",f="horizontal"===u.direction?null===(n=u.getXAxisHelper())||void 0===n?void 0:n.isInverse():null===(r=u.getYAxisHelper())||void 0===r?void 0:r.isInverse();s=function(t){var e,i=t.data,n=null!==(e="function"==typeof h.position?h.position(i):h.position)&&void 0!==e?e:"outside";if("outside"===n){var r=u.getMeasureField()[0],a=(null==i?void 0:i[r])>=0&&f||(null==i?void 0:i[r])<0&&!f?1:0;return{vertical:["top","bottom"],horizontal:["right","left"]}[p][a]}return n},l=!1!==h.overlap&&{strategy:null!==(o=null===(a=h.overlap)||void 0===a?void 0:a.strategy)&&void 0!==o?o:NY(u)};var v=!1;return K(d)&&d.includes("inside")&&(v=!0),{position:s,overlap:l,smartInvert:v}}function NY(t){var e=[{type:"position",position:function(e){var i,n,r=e.data,a=t.getMeasureField()[0];return("horizontal"===t.direction?null===(i=t.getXAxisHelper())||void 0===i?void 0:i.isInverse():null===(n=t.getYAxisHelper())||void 0===n?void 0:n.isInverse())?(null==r?void 0:r[a])>=0?"horizontal"===t.direction?["left","inside-left"]:["bottom","inside-bottom"]:"horizontal"===t.direction?["right","inside-right"]:["top","inside-top"]:(null==r?void 0:r[a])>=0?"horizontal"===t.direction?["right","inside-right"]:["top","inside-top"]:"horizontal"===t.direction?["left","inside-left"]:["bottom","inside-bottom"]}}];return e}function VY(t){var e,i=t.labelSpec,n=null!==(e=FY(i.position))&&void 0!==e?e:"outside";return{position:n,smartInvert:i.smartInvert?i.smartInvert:K(n)&&n.includes("inside")}}function jY(t,e,i){var n=t.series,r=t.labelSpec||{},a=n.getTotalData();return{customLayoutFunc:function(a){return a.map((function(a){var o=r.position||"withChange",s=r.offset||0,l=e?e(a.data):a.data,u=OY(t,l,r.formatMethod);return u.x=function(t,e,i,n){return"horizontal"===e.direction?"middle"===i?.5*(e.totalPositionX(t,"end")+e.totalPositionY(t,"start")):"max"===i?e.totalPositionX(t,t.end>=t.start?"end":"start")+n:"min"===i?e.totalPositionX(t,t.end>=t.start?"start":"end")-n:e.totalPositionX(t,"end")+(t.end>=t.start?n:-n):e.totalPositionX(t,"index",.5)}(l,n,o,s),u.y=function(t,e,i,n){return"horizontal"===e.direction?e.totalPositionY(t,"index",.5):"middle"===i?.5*(e.totalPositionY(t,"end")+e.totalPositionY(t,"start")):"max"===i?e.totalPositionY(t,t.end>=t.start?"end":"start")-n:"min"===i?e.totalPositionY(t,t.end>=t.start?"start":"end")+n:e.totalPositionY(t,"end")+(t.end>=t.start?-n:n)}(l,n,o,s),"horizontal"===n.direction?u.textAlign="middle"===o?"center":"withChange"===o&&l.end-l.start>=0||"max"===o?"left":"right":u.textBaseline="middle"===o?o:"withChange"===o&&l.end-l.start>=0||"max"===o?"bottom":"top",null==i||i(a,l,u),Iv(T(T({},u),{id:a.id}))}))},dataFilter:function(t){var e=[];return a.forEach((function(i){var r=t.find((function(t){var e;return i.index===(null===(e=t.data)||void 0===e?void 0:e[n.getDimensionField()[0]])}));r&&(r.data=i,e.push(r))})),e},overlap:{strategy:[]}}}function UY(t){var e,i,n,r,a,o=t.labelSpec,s=t.series,l=null===(r=null===(n=null===(i=s.getViewDataStatistics)||void 0===i?void 0:i.call(s).latestData)||void 0===n?void 0:n[s.getSeriesField()])||void 0===r?void 0:r.values,u=l?l.map((function(t,e){var i;return(i={})[s.getSeriesField()]=t,i.index=e,i})):[(e={index:0},e[Az]=s.getSeriesKeys()[0],e)];return{position:null!==(a=o.position)&&void 0!==a?a:"end",data:u,overlap:{avoidBaseMark:!1,clampForce:!1}}}function WY(t){return[{type:"position",position:function(e){return"horizontal"===t.direction?["right","left"]:["bottom","top"]}}]}var GY,YY={seriesFieldName:{total:"total",increase:"increase",decrease:"decrease"},leaderLine:{style:{stroke:"black",lineWidth:1,lineDash:[4,4]}},stackLabel:{visible:!0,offset:12,position:"withChange",style:{fill:"black",fontSize:{type:"token",key:"l4FontSize"}}},label:{visible:!1,offset:12,position:"inside",style:{lineWidth:2}}},XY=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.waterfall,i.transformerConstructor=LY,i._leaderLineMark=null,i._stackLabelMark=null,i._labelMark=null,i}return M(i,e),i.prototype.getTotalData=function(){var t;return null===(t=this._totalData)||void 0===t?void 0:t.getLatestData()},i.prototype.initGroups=function(){var t=this.getGroupFields();t&&t.length&&(this._groups=new RY(t),this._data&&this._groups.initData(this._data.getDataView(),this._dataSet))},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setValueFieldToStack(),this._fieldX=[this._fieldX[0]],this._fieldY=[this._fieldY[0]],j(this._seriesField)&&(this._seriesField=mY)},i.prototype.getSeriesKeys=function(){return this._seriesField===mY?[this._theme.seriesFieldName.increase,this._theme.seriesFieldName.decrease,this._theme.seriesFieldName.total]:e.prototype.getSeriesKeys.call(this)},i.prototype.initData=function(){var t,i=this;e.prototype.initData.call(this),kH(this._dataSet,"waterfallFillTotal",kY),kH(this._dataSet,"waterfall",_Y),(j(this._spec.total)||"end"===this._spec.total.type)&&(null===(t=this._rawData)||void 0===t||t.transform({type:"waterfallFillTotal",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,total:this._spec.total,stackInverse:this.getRegion().getStackInverse()}},!1));var n=DH(this.getViewData(),this._dataSet,{name:"".concat(mz,"_series_").concat(this.id,"_totalData")});this.getViewData().target.removeListener("change",n.reRunAllTransform),this._totalData=new wN(this._option,n),n.transform({type:"waterfall",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,startAs:wz,endAs:Cz,total:this._spec.total,groupData:function(){return i.getGroups().groupData},stackInverse:this.getRegion().getStackInverse()}},!1)},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._totalData)||void 0===t||t.compile()},i.prototype.initAnimation=function(){var t,e,i,n,r=this,a={yField:"horizontal"===this.direction?this._fieldY[0]:this.getStackValueField(),xField:"horizontal"===this.direction?this.getStackValueField():this._fieldX[0],direction:this.direction,growFrom:function(){var t,e;return"horizontal"===r.direction?null===(t=r._xAxisHelper)||void 0===t?void 0:t.getScale(0).scale(0):null===(e=r._yAxisHelper)||void 0===e?void 0:e.getScale(0).scale(0)}},o=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset,s=sj(this);this._barMark.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("waterfall"))||void 0===i?void 0:i(a,o),ZV("bar",this._spec,this._markAttributeContext),s)),this._leaderLineMark&&this._leaderLineMark.setAnimationConfig(qV(null===(n=KF.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),ZV("leaderLine",this._spec,this._markAttributeContext)))},i.prototype.viewDataUpdate=function(t){this._totalData.getDataView().reRunAllTransform(),this._totalData.updateData(),e.prototype.viewDataUpdate.call(this,t)},i.prototype.addViewDataFilter=function(t){},i.prototype.reFilterViewData=function(){},i.prototype.onEvaluateEnd=function(t){e.prototype.onEvaluateEnd.call(this,t),this._totalData.updateData()},i.prototype.initMark=function(){e.prototype.initMark.call(this);var t=this._createMark(i.mark.leaderLine,{key:"index"});t&&(this._leaderLineMark=t,t.setData(this._totalData))},i.prototype.initLabelMarkStyle=function(t){var i;if(t)return!this._labelMark&&(null===(i=this._spec.label)||void 0===i?void 0:i.visible)?(e.prototype.initLabelMarkStyle.call(this,t),void(this._labelMark=t)):void 0},i.prototype.initStackLabelMarkStyle=function(t){var e=this;t&&(this._stackLabelMark=t,t.skipEncode=!0,t.setRule("stackLabel"),t.setData(this._totalData),this.setMarkStyle(t,{text:function(t){var i;return"absolute"===(null===(i=e._spec.stackLabel)||void 0===i?void 0:i.valueType)?t.end:Ie(t.end,t.start)}}))},i.prototype.initTotalLabelMarkStyle=function(t){var e=this;this.setMarkStyle(t,{text:function(t){var i;return"end"in t?"absolute"===(null===(i=e._spec.totalLabel)||void 0===i?void 0:i.valueType)?t.end:Ie(t.end,t.start):"horizontal"===e.direction?t[e._fieldX[0]]:t[e._fieldY[0]]}})},i.prototype.getTotalLabelComponentStyle=function(t){var e=this;return jY(T(T({},t),{series:this,labelSpec:this._spec.totalLabel}),(function(t){var i="vertical"===e.direction?t[e._fieldX[0]]:t[e._fieldY[0]];return e._totalData.getLatestData().find((function(t){return t.index===i}))}))},i.prototype.totalPositionX=function(t,e,i){void 0===i&&(i=.5);var n=this._xAxisHelper,r=n.dataToPosition,a=n.getBandwidth;return"horizontal"===this._direction?MF(r([t[e]],{bandPosition:this._bandPosition})):r([t[e]],{bandPosition:this._bandPosition})+.5*a(0)-this._barMark.getAttribute("width",t)*(.5-i)},i.prototype.totalPositionY=function(t,e,i){void 0===i&&(i=.5);var n=this._yAxisHelper,r=n.dataToPosition,a=n.getBandwidth;return"horizontal"===this._direction?r([t[e]],{bandPosition:this._bandPosition})+.5*a(0)-this._barMark.getAttribute("height",t)*(.5-i):MF(r([t[e]],{bandPosition:this._bandPosition}))},i.prototype.initMarkStyle=function(){var i=this;e.prototype.initMarkStyle.call(this),this._leaderLineMark&&("horizontal"===this._direction?this.setMarkStyle(this._leaderLineMark,{visible:function(t){return i.isVisibleLeaderLine(t)},x:function(t){return i.totalPositionX(t,"lastEnd",0)},x1:function(t){return i.totalPositionX(t,t.isTotal?"end":"start",0)},y:function(t){return t.lastIndex?i.totalPositionY(t,"lastIndex",1):0},y1:function(t){return i.totalPositionY(t,"index",0)}},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._leaderLineMark,{visible:function(t){return i.isVisibleLeaderLine(t)},x:function(t){return t.lastIndex?i.totalPositionX(t,"lastIndex",1):0},x1:function(t){return i.totalPositionX(t,"index",0)},y:function(t){return i.totalPositionY(t,"lastEnd",0)},y1:function(t){return i.totalPositionY(t,t.isTotal?"end":"start",0)}},"normal",t.AttributeLevel.Series))},i.prototype.isVisibleLeaderLine=function(t){return!j(t.lastIndex)&&TF([t.lastEnd,t[t.isTotal?"end":"start"]],"horizontal"===this.direction?this._xAxisHelper.getScale(0):this._yAxisHelper.getScale(0))},i.type=t.SeriesTypeEnum.waterfall,i.mark=EY,i.builtInTheme={waterfall:YY},i.transformerConstructor=LY,i}(BG),KY=function(){CY(),MG(),KF.registerAnimation("waterfall",(function(t,e){return{appear:MY(t,e),enter:mG(t,!1),exit:_G(t,!1),disappear:_G(t,!1)}})),XN(),WU(),NU(),KF.registerSeries(XY.type,XY)},qY="".concat(mz,"_BOX_PLOT_OUTLIER_VALUE");!function(t){t.OUTLIER="outlier",t.MAX="max",t.MIN="min",t.MEDIAN="median",t.Q1="q1",t.Q3="q3",t.SERIES_FIELD="seriesField"}(GY||(GY={}));var ZY,JY=function(t,e){var i=[],n=e.outliersField,r=e.dimensionField;return(t[0].latestData||[]).forEach((function(t){var e=t[n];q(e)||(e=[e]),i.push.apply(i,R([],B(e.map((function(e){var i,n=((i={})[qY]=e,i);return r.forEach((function(e){n[e]=t[e]})),n}))),!1))})),i},QY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getContentKey=function(t){return function(i){if(e.isOutlierMark(i))return t===GY.OUTLIER?e.series.getOutliersField():t===GY.SERIES_FIELD?e.series.getSeriesField():null;switch(t){case GY.MIN:return e.series.getMinField();case GY.MAX:return e.series.getMaxField();case GY.MEDIAN:return e.series.getMedianField();case GY.Q1:return e.series.getQ1Field();case GY.Q3:return e.series.getQ3Field();case GY.SERIES_FIELD:return e.series.getSeriesField()}return null}},e.getContentValue=function(t){return function(i){if(e.isOutlierMark(i))return t===GY.OUTLIER?i[qY]:t===GY.SERIES_FIELD?i[e.series.getSeriesField()]:null;switch(t){case GY.MIN:return i[e.series.getMinField()];case GY.MAX:return i[e.series.getMaxField()];case GY.MEDIAN:return i[e.series.getMedianField()];case GY.Q1:return i[e.series.getQ1Field()];case GY.Q3:return i[e.series.getQ3Field()];case GY.SERIES_FIELD:return i[e.series.getSeriesField()]}return null}},e.shapeColorCallback=function(t){return"line"===e.series.getShaftShape()?e.series.getMarkInName("boxPlot").getAttribute("stroke",t):e.series.getMarkInName("boxPlot").getAttribute("fill",t)},e.getOutlierFillColor=function(t){var i,n,r=e.series.getOutliersStyle();return null!==(i=null==r?void 0:r.fill)&&void 0!==i?i:null===(n=e.series.getMarkInName("outlier"))||void 0===n?void 0:n.getAttribute("fill",t)},e.isOutlierMark=function(t){return U(t[qY])},e}return M(e,t),e.prototype.getDefaultContentList=function(t){return[{key:this.getContentKey(GY.OUTLIER),value:this.getContentValue(GY.OUTLIER),shapeType:this.shapeTypeCallback,shapeColor:this.getOutlierFillColor,shapeStroke:this.getOutlierFillColor},{key:this.getContentKey(GY.MAX),value:this.getContentValue(GY.MAX)},{key:this.getContentKey(GY.Q3),value:this.getContentValue(GY.Q3)},{key:this.getContentKey(GY.MEDIAN),value:this.getContentValue(GY.MEDIAN)},{key:this.getContentKey(GY.Q1),value:this.getContentValue(GY.Q1)},{key:this.getContentKey(GY.MIN),value:this.getContentValue(GY.MIN)},{key:this.getContentKey(GY.SERIES_FIELD),value:this.getContentValue(GY.SERIES_FIELD)}]},e}(EV),$Y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._setStateOfGraphic=function(t){t.clearStates(),t.stateProxy=null,t.context.diffState!==gN.enter&&t.context.diffState!==gN.update||(t.glyphStateProxy=function(i,n){var r,a,o={attributes:T(T({},e._runEncoderOfGraphic(null===(a=e._encoderOfState)||void 0===a?void 0:a[i],t)),t.runtimeStateCache?t.runtimeStateCache[i]:null)};return t.glyphStates?t.glyphStates[i]||(t.glyphStates[i]=o):t.glyphStates=((r={})[i]=o,r),o},t.useStates(t.context.states))},e}return M(e,t),e.prototype.getSubMarks=function(){return this._subMarks},e.prototype.setGlyphConfig=function(t){this._glyphConfig=t},e.prototype.getGlyphConfig=function(){return this._glyphConfig},e.prototype.getPositionChannels=function(){return this._positionChannels},e.prototype._onGlyphAttributeUpdate=function(t){var e=this;return function(i){var n,r,a=e.getPositionChannels(),o=a&&e._positionEncoder&&Object.keys(i).some((function(t){return a.includes(t)}))?e._positionEncoder(i,null===(r=null===(n=null==t?void 0:t.context)||void 0===n?void 0:n.data)||void 0===r?void 0:r[0],t):null;return e._channelEncoder&&Object.keys(e._channelEncoder).forEach((function(t){if(t in i){var n=e._channelEncoder[t](i[t]);o=o?gt(o,n):n}})),o&&t.getSubGraphic().forEach((function(t){t&&o[t.name]&&t.setAttributes(o[t.name])})),i}},e.prototype._createGraphic=function(t){void 0===t&&(t={});var e=Yv(t);e.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(e);var i=this._subMarks;if(i){var n=[];Object.keys(i).forEach((function(t){var e=KF.createGraphicComponent(i[t].type,T({},i[t].defaultAttributes));e&&(n.push(e),e.name=t,e.onBeforeAttributeUpdate=function(t){return t})})),e.setSubGraphic(n)}return e.onBeforeAttributeUpdate(t),e},e.prototype._runProgressiveEncoder=function(t){this._runEncoder(t)},e}(RN),tX=function(){KF.registerGraphicComponent("glyph",Yv),lC(),Yw()},eX=["x","y","minMaxWidth","minMaxHeight","q1q3Width","q1q3Height","q1","q3","min","max","median","angle"],iX=["x","y","boxWidth","boxHeight","ruleWidth","ruleHeight","q1","q3","min","max","median","angle"],nX=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return M(e,t),e.prototype._isHorizontal=function(){return this._glyphConfig&&"horizontal"===this._glyphConfig.direction},e.prototype.setGlyphConfig=function(e){var i=this;t.prototype.setGlyphConfig.call(this,e),"bar"===e.shaftShape?(this._subMarks={minMaxBox:{type:"rect",defaultAttributes:{lineWidth:0}},q1q3Box:{type:"rect",defaultAttributes:{lineWidth:0}},median:{type:"line",defaultAttributes:{x:0,y:0}}},this._positionChannels=eX,this._channelEncoder={minMaxFillOpacity:function(t){return{minMaxBox:{fillOpacity:t}}},lineWidth:function(t){return{minMaxBox:{lineWidth:0},q1q3Box:{lineWidth:0}}},stroke:function(t){return{minMaxBox:{stroke:!1},q1q3Box:{stroke:!1}}}},this._positionEncoder=function(t,e,n){var r,a=t.x,o=void 0===a?n.attribute.x:a,s=t.y,l=void 0===s?n.attribute.y:s,u=t.minMaxWidth,c=void 0===u?n.attribute.minMaxWidth:u,h=t.minMaxHeight,d=void 0===h?n.attribute.minMaxHeight:h,p=t.q1q3Width,f=void 0===p?n.attribute.q1q3Width:p,v=t.q1q3Height,g=void 0===v?n.attribute.q1q3Height:v,y=t.q1,m=void 0===y?n.attribute.q1:y,_=t.q3,b=void 0===_?n.attribute.q3:_,x=t.min,k=void 0===x?n.attribute.min:x,S=t.max,A=void 0===S?n.attribute.max:S,M=t.median,T=void 0===M?n.attribute.median:M,w=t.angle,C=i._isHorizontal(),E={};if(C?(E.minMaxBox={x:k,x1:A,y:l-d/2,y1:l+d/2},E.q1q3Box={x:m,x1:b,y:l-g/2,y1:l+g/2},E.median={points:[{x:T,y:l-g/2},{x:T,y:l+g/2}]}):(E.minMaxBox={y:k,y1:A,x:o-c/2,x1:o+c/2},E.q1q3Box={y:m,y1:b,x:o-f/2,x1:o+f/2},E.median={points:[{y:T,x:o-f/2},{y:T,x:o+f/2}]}),et(w)){var P=null!==(r=t.anchor)&&void 0!==r?r:C?[(k+A)/2,l]:[o,(k+A)/2];Object.keys(E).forEach((function(t){E[t].angle=w,E[t].anchor=P}))}return E}):(this._subMarks={shaft:{type:"line",defaultAttributes:{x:0,y:0}},box:{type:"rect"},max:{type:"line",defaultAttributes:{x:0,y:0}},min:{type:"line",defaultAttributes:{x:0,y:0}},median:{type:"line",defaultAttributes:{x:0,y:0}}},this._positionChannels=iX,this._channelEncoder=null,this._positionEncoder=function(t,e,n){var r,a=t.x,o=void 0===a?n.attribute.x:a,s=t.y,l=void 0===s?n.attribute.y:s,u=t.boxWidth,c=void 0===u?n.attribute.boxWidth:u,h=t.boxHeight,d=void 0===h?n.attribute.boxHeight:h,p=t.ruleWidth,f=void 0===p?n.attribute.ruleWidth:p,v=t.ruleHeight,g=void 0===v?n.attribute.ruleHeight:v,y=t.q1,m=void 0===y?n.attribute.q1:y,_=t.q3,b=void 0===_?n.attribute.q3:_,x=t.min,k=void 0===x?n.attribute.min:x,S=t.max,A=void 0===S?n.attribute.max:S,M=t.median,T=void 0===M?n.attribute.median:M,w=t.angle,C=i._isHorizontal(),E={};if(C?(E.box={x:m,x1:b,y:l-d/2,y1:l+d/2},E.median={points:[{x:T,y:l-d/2},{x:T,y:l+d/2}]},E.shaft={points:[{x:k,y:l},{x:A,y:l}]},E.max={points:[{x:A,y:l-g/2},{x:A,y:l+g/2}]},E.min={points:[{x:k,y:l-g/2},{x:k,y:l+g/2}]}):(E.box={x:o-c/2,x1:o+c/2,y:m,y1:b},E.median={points:[{x:o-c/2,y:T},{x:o+c/2,y:T}]},E.max={points:[{x:o-f/2,y:A},{x:o+f/2,y:A}]},E.min={points:[{x:o-f/2,y:k},{x:o+f/2,y:k}]},E.shaft={points:[{x:o,y:k},{x:o,y:A}]}),et(w)){var P=null!==(r=t.anchor)&&void 0!==r?r:C?[(k+A)/2,l]:[o,(k+A)/2];Object.keys(E).forEach((function(t){E[t].angle=w,E[t].anchor=P}))}return E})},e.prototype._getDefaultStyle=function(){return T(T({},t.prototype._getDefaultStyle.call(this)),{lineWidth:2,boxWidth:30,shaftWidth:20,shaftShape:"line"})},e.type="boxPlot",e}($Y),rX=T(T({},VV),((ZY={}).boxPlot={name:"boxPlot",type:"boxPlot"},ZY.outlier={name:"outlier",type:"symbol"},ZY)),aX=function(t){return function(e,i,n){var r,a=e.getFinalAttribute(),o=null!==(r=a.direction)&&void 0!==r?r:"vertical",s=t(e,o,i);if(!et(s))return{};var l=a.x,u=a.y,c=a.min,h=a.max,d=a.q1,p=a.q3,f=a.median,v={from:{x:l,y:u},to:{x:l,y:u}};return et(c)&&(v.from.min=s,v.to.min=c),et(h)&&(v.from.max=s,v.to.max=h),et(d)&&(v.from.q1=s,v.to.q1=d),et(p)&&(v.from.q3=s,v.to.q3=p),et(f)&&(v.from.median=s,v.to.median=f),v}},oX=function(t){return function(e,i,n){var r,a=e.getFinalAttribute(),o=null!==(r=a.direction)&&void 0!==r?r:"vertical",s=t(e,o,i);if(!et(s))return{};var l=a.x,u=a.y,c=a.min,h=a.max,d=a.q1,p=a.q3,f=a.median,v={from:{x:l,y:u},to:{x:l,y:u}};return et(c)&&(v.to.min=s,v.from.min=c),et(h)&&(v.to.max=s,v.from.max=h),et(d)&&(v.to.q1=s,v.from.q1=d),et(p)&&(v.to.q3=s,v.from.q3=p),et(f)&&(v.to.median=s,v.from.median=f),v}},sX=function(t,e){return t.getSubGraphic().find((function(t){return t.name===e}))},lX=function(t,e,i){var n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b,x,k,S,A,M,T,w,C,E;if(i&&et(i.center))return i.center;if("horizontal"===e){M=null===(a=null===(r=(null===(n=sX(t,"median"))||void 0===n?void 0:n.attribute).points)||void 0===r?void 0:r[0])||void 0===a?void 0:a.x,T=null===(u=null===(l=null===(s=null===(o=sX(t,"max"))||void 0===o?void 0:o.attribute)||void 0===s?void 0:s.points)||void 0===l?void 0:l[0])||void 0===u?void 0:u.x,w=null===(p=null===(d=null===(h=null===(c=sX(t,"min"))||void 0===c?void 0:c.attribute)||void 0===h?void 0:h.points)||void 0===d?void 0:d[0])||void 0===p?void 0:p.x;var P=sX(t,"box").attribute.width,B=sX(t,"box").attribute.x;C=B,E=B+P}else{M=null===(g=null===(v=(null===(f=sX(t,"median"))||void 0===f?void 0:f.attribute).points)||void 0===v?void 0:v[0])||void 0===g?void 0:g.y,T=null===(b=null===(_=null===(m=null===(y=sX(t,"max"))||void 0===y?void 0:y.attribute)||void 0===m?void 0:m.points)||void 0===_?void 0:_[0])||void 0===b?void 0:b.y,w=null===(A=null===(S=null===(k=null===(x=sX(t,"min"))||void 0===x?void 0:x.attribute)||void 0===k?void 0:k.points)||void 0===S?void 0:S[0])||void 0===A?void 0:A.y;var R=sX(t,"box").attribute.height,L=sX(t,"box").attribute.y;C=L,E=L+R}return et(M)?M:et(C)&&et(E)?(C+E)/2:et(T)&&et(w)?(T+w)/2:et(w)?w:et(T)?T:NaN},uX=function(t,e,i){var n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b,x;if(et(null==i?void 0:i.center))return i.center;if("horizontal"===e){y=null===(a=null===(r=(null===(n=sX(t,"median"))||void 0===n?void 0:n.attribute).points)||void 0===r?void 0:r[0])||void 0===a?void 0:a.x;var k=(null===(o=sX(t,"minMaxBox"))||void 0===o?void 0:o.attribute).width,S=null===(s=sX(t,"minMaxBox"))||void 0===s?void 0:s.attribute.x;_=S,m=S+k;var A=(null===(l=sX(t,"q1q3Box"))||void 0===l?void 0:l.attribute).width,M=null===(u=sX(t,"q1q3Box"))||void 0===u?void 0:u.attribute.x;b=M,x=M+A}else{y=null===(d=null===(h=(null===(c=sX(t,"median"))||void 0===c?void 0:c.attribute).points)||void 0===h?void 0:h[0])||void 0===d?void 0:d.y;var T=(null===(p=sX(t,"minMaxBox"))||void 0===p?void 0:p.attribute).height,w=null===(f=sX(t,"minMaxBox"))||void 0===f?void 0:f.attribute.y;_=w,m=w+T;var C=(null===(v=sX(t,"q1q3Box"))||void 0===v?void 0:v.attribute).height,E=null===(g=sX(t,"q1q3Box"))||void 0===g?void 0:g.attribute.y;b=E,x=E+C}return et(y)?y:et(b)&&et(x)?(b+x)/2:et(m)&&et(_)?(m+_)/2:et(_)?_:et(m)?m:NaN},cX=function(t){function e(e,i,n,r,a){return t.call(this,e,i,n,r,a)||this}return M(e,t),e.prototype.onBind=function(){t.prototype.onBind.call(this);var e=this.target.getFinalAttribute();e&&this.target.setAttributes(e);var i=this.computeAttribute(),n=i.from,r=i.to;this.propKeys=Object.keys(r).filter((function(t){return null!=r[t]})),this.animate.reSyncProps(),this.from=n,this.to=r,this.target.setAttributes(this.from)},e.prototype.computeAttribute=function(){return aX(lX)(this.target,this.params,this.params.options)},e.prototype.onUpdate=function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.setAttributes(r)},e}(zP),hX=function(t){function e(e,i,n,r,a){return t.call(this,e,i,n,r,a)||this}return M(e,t),e.prototype.onBind=function(){var t;(null===(t=this.params)||void 0===t?void 0:t.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);var e=this.computeAttribute(),i=e.from,n=e.to;this.propKeys=Object.keys(n).filter((function(t){return null!=n[t]})),this.animate.reSyncProps(),this.from=i,this.to=n,this.target.setAttributes(this.from)},e.prototype.computeAttribute=function(){return oX(lX)(this.target,this.params,this.params.options)},e.prototype.onUpdate=function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.setAttributes(r)},e}(zP),dX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.computeAttribute=function(){return aX(uX)(this.target,this.params,this.params.options)},e}(cX),pX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.computeAttribute=function(){return oX(uX)(this.target,this.params,this.params.options)},e}(hX),fX={boxPlot:{style:{lineWidth:1}},label:{style:{lineWidth:2}}},vX=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.boxPlot,i}return M(i,e),i.prototype.getMinField=function(){return this._minField},i.prototype.getMaxField=function(){return this._maxField},i.prototype.getQ1Field=function(){return this._q1Field},i.prototype.getMedianField=function(){return this._medianField},i.prototype.getQ3Field=function(){return this._q3Field},i.prototype.getOutliersField=function(){return this._outliersField},i.prototype.getShaftShape=function(){return this._shaftShape},i.prototype.getBoxFillColor=function(){return this._boxFillColor},i.prototype.getStrokeColor=function(){return this._strokeColor},i.prototype.getOutliersStyle=function(){return this._outliersStyle},i.prototype.setAttrFromSpec=function(){var t,i,n,r,a;e.prototype.setAttrFromSpec.call(this);var o=null!==(i=null===(t=this._spec.boxPlot)||void 0===t?void 0:t.style)&&void 0!==i?i:{};this._minField=this._spec.minField,this._maxField=this._spec.maxField,this._q1Field=this._spec.q1Field,this._medianField=this._spec.medianField,this._q3Field=this._spec.q3Field,this._outliersField=this._spec.outliersField,this._lineWidth=null!==(n=o.lineWidth)&&void 0!==n?n:2,this._boxWidth=o.boxWidth,this._shaftShape=null!==(r=o.shaftShape)&&void 0!==r?r:"line",this._shaftWidth=o.shaftWidth,this._boxFillColor=o.boxFill,this._strokeColor=o.stroke,this._shaftFillOpacity="bar"===this._shaftShape?null!==(a=o.shaftFillOpacity)&&void 0!==a?a:.5:void 0,this._outliersStyle=this._spec.outliersStyle},i.prototype.initMark=function(){this._boxPlotMark=this._createMark(i.mark.boxPlot,{groupKey:this._seriesField,isSeriesMark:!0}),this._outliersField&&(this._outlierMark=this._createMark(i.mark.outlier,{key:kz,groupKey:this._seriesField,dataView:this._outlierDataView.getDataView(),dataProductId:this._outlierDataView.getProductId()}))},i.prototype.initMarkStyle=function(){var e,i,n,r,a,o=this,s=this._boxPlotMark;if(s){var l={lineWidth:this._lineWidth,fill:null!==(e=this._boxFillColor)&&void 0!==e?e:"line"===this._shaftShape?"#FFF":this.getColorAttribute(),minMaxFillOpacity:this._shaftFillOpacity,stroke:null!==(i=this._strokeColor)&&void 0!==i?i:"line"===this._shaftShape?this.getColorAttribute():"#000"};s.setGlyphConfig({direction:this._direction,shaftShape:this._shaftShape});var u="horizontal"===this._direction?T(T({y:this.dataToPositionY.bind(this)},l),{boxHeight:function(){var t;return null!==(t=o._boxWidth)&&void 0!==t?t:o._getMarkWidth()},ruleHeight:function(){var t;return null!==(t=o._shaftWidth)&&void 0!==t?t:o._getMarkWidth()},q1q3Height:function(){var t;return null!==(t=o._boxWidth)&&void 0!==t?t:o._getMarkWidth()},minMaxHeight:function(){var t;return null!==(t=o._shaftWidth)&&void 0!==t?t:o._getMarkWidth()}}):T(T({x:this.dataToPositionX.bind(this)},l),{boxWidth:function(){var t;return null!==(t=o._boxWidth)&&void 0!==t?t:o._getMarkWidth()},ruleWidth:function(){var t;return null!==(t=o._shaftWidth)&&void 0!==t?t:o._getMarkWidth()},q1q3Width:function(){var t;return null!==(t=o._boxWidth)&&void 0!==t?t:o._getMarkWidth()},minMaxWidth:function(){var t;return null!==(t=o._shaftWidth)&&void 0!==t?t:o._getMarkWidth()}});this.setMarkStyle(s,u,t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)}var c=this._outlierMark;c&&this.setMarkStyle(c,{fill:null!==(r=null===(n=this._outliersStyle)||void 0===n?void 0:n.fill)&&void 0!==r?r:this.getColorAttribute(),size:Q(null===(a=this._outliersStyle)||void 0===a?void 0:a.size)?this._outliersStyle.size:10,symbolType:"circle"},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.initBoxPlotMarkStyle=function(){var e,i,n=this,r=this._boxPlotMark,a="horizontal"===this._direction?this._xAxisHelper:this._yAxisHelper;if(r&&a){var o=a.dataToPosition,s=null===(e=null==a?void 0:a.getScale)||void 0===e?void 0:e.call(a,0);this.setMarkStyle(r,{min:function(t){return MF(o(n.getDatumPositionValues(t,n._minField),{bandPosition:n._bandPosition}),s)},q1:function(t){return MF(o(n.getDatumPositionValues(t,n._q1Field),{bandPosition:n._bandPosition}),s)},median:function(t){return MF(o(n.getDatumPositionValues(t,n._medianField),{bandPosition:n._bandPosition}),s)},q3:function(t){return MF(o(n.getDatumPositionValues(t,n._q3Field),{bandPosition:n._bandPosition}),s)},max:function(t){return MF(o(n.getDatumPositionValues(t,n._maxField),{bandPosition:n._bandPosition}),s)}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)}var l=this._outlierMark;if(l&&a){var u=a.dataToPosition,c=null===(i=null==a?void 0:a.getScale)||void 0===i?void 0:i.call(a,0),h="horizontal"===this._direction?{y:this.dataToPositionY.bind(this),x:function(t){return MF(u(n.getDatumPositionValues(t,qY),{bandPosition:n._bandPosition}),c)}}:{x:this.dataToPositionX.bind(this),y:function(t){return MF(u(n.getDatumPositionValues(t,qY),{bandPosition:n._bandPosition}),c)}};this.setMarkStyle(l,h,t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)}},i.prototype.initData=function(){if(e.prototype.initData.call(this),this._data){kH(this._dataSet,"foldOutlierData",JY),kH(this._dataSet,"addVChartProperty",xV);var t=new hs(this._dataSet,{name:"".concat(this.type,"_outlier_").concat(this.id,"_data")});t.parse([this.getViewData()],{type:"dataview"}),t.name="".concat(mz,"_series_").concat(this.id,"_outlierData"),t.transform({type:"foldOutlierData",options:{dimensionField:"horizontal"===this._direction?this._fieldY:this._fieldX,outliersField:this._outliersField}}),t.transform({type:"addVChartProperty",options:{beforeCall:FV.bind(this),call:zV}},!1),this._outlierDataView=new wN(this._option,t)}},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._outlierDataView)||void 0===t||t.compile()},i.prototype.init=function(t){e.prototype.init.call(this,t),this.initBoxPlotMarkStyle()},i.prototype._getMarkWidth=function(){if(this._autoBoxWidth)return this._autoBoxWidth;var t="horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper,e="horizontal"===this._direction?this._fieldY:this._fieldX,i=t.getBandwidth(e.length-1)/e.length;return this._autoBoxWidth=i,this._autoBoxWidth},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this._autoBoxWidth=null},i.prototype._initAnimationSpec=function(t){var e=this;void 0===t&&(t={});var i=gt({},t);return["appear","enter","update","exit","disappear"].forEach((function(t){i[t]&&"scaleIn"===i[t].type?i[t].type="line"===e._shaftShape?"boxplotScaleIn":"barBoxplotScaleIn":i[t]&&"scaleOut"===i[t].type&&(i[t].type="line"===e._shaftShape?"boxplotScaleOut":"barBoxplotScaleOut")})),i},i.prototype.initAnimation=function(){var t,e,i,n,r,a,o,s=sj(this);if(this._boxPlotMark){var l=this._initAnimationSpec(null===(t=KF.getAnimationInKey("scaleInOut"))||void 0===t?void 0:t()),u=this._initAnimationSpec(ZV("boxPlot",this._spec,this._markAttributeContext));this._boxPlotMark.setAnimationConfig(qV(l,u,s))}if(this._outlierMark){var c={appear:null===(e=this._spec.animationAppear)||void 0===e?void 0:e.symbol,disappear:null===(i=this._spec.animationDisappear)||void 0===i?void 0:i.symbol,enter:null===(n=this._spec.animationEnter)||void 0===n?void 0:n.symbol,exit:null===(r=this._spec.animationExit)||void 0===r?void 0:r.symbol,update:null===(a=this._spec.animationUpdate)||void 0===a?void 0:a.symbol};this._outlierMark.setAnimationConfig(qV(null===(o=KF.getAnimationInKey("scaleInOut"))||void 0===o?void 0:o(),c,s))}},i.prototype.initTooltip=function(){this._tooltipHelper=new QY(this),this._boxPlotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._boxPlotMark),this._outlierMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._outlierMark)},i.prototype.getStatisticFields=function(){var t=this,i=e.prototype.getStatisticFields.call(this),n=i.find((function(e){return e.key===t._outliersField}));return n&&(n.operations=["array-min","array-max"]),i},i.prototype.onEvaluateEnd=function(t){e.prototype.onEvaluateEnd.call(this,t),this._outlierDataView.updateData()},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._boxPlotMark]},i.type=t.SeriesTypeEnum.boxPlot,i.builtInTheme={boxPlot:fX},i.mark=rX,i}(lj),gX=function(){tX(),Qw(),rC(),KF.registerGraphicComponent("line",(function(t){return Nv(t)})),KF.registerGraphicComponent("rect",(function(t){return Wv(t)})),KF.registerMark(nX.type,nX),Ij(),YN(),WU(),NU(),wP.registerBuiltInAnimate("boxplotScaleIn",cX),wP.registerBuiltInAnimate("boxplotScaleOut",hX),wP.registerBuiltInAnimate("barBoxplotScaleIn",dX),wP.registerBuiltInAnimate("barBoxplotScaleOut",pX),KF.registerSeries(vX.type,vX)},yX=function(t){function e(i,n){var r=t.call(this,i,n)||this;return r.type=e.type,r._textType="text",r}return M(e,t),e.prototype.getTextType=function(){return this._textType},e.prototype._getDefaultStyle=function(){return T(T({},t.prototype._getDefaultStyle.call(this)),{angle:0,textAlign:"center",lineWidth:0,textConfig:[]})},e.prototype.initStyleWithSpec=function(e){t.prototype.initStyleWithSpec.call(this,e),e.textType&&(this._textType=e.textType)},e.prototype._transformGraphicAttributes=function(e,i,n){var r=t.prototype._transformGraphicAttributes.call(this,e,i,n),a=r.text;return W(a)&&U(a.text)&&("rich"===this._textType||"rich"===a.type)&&(r.textConfig=a.text),r},e.prototype._createGraphic=function(t){void 0===t&&(t={});var e=t.text;return"rich"===this._textType||"rich"===(null==e?void 0:e.type)?ag(t):Iv(t)},e.type="text",e}(RN),mX=function(){KF.registerMark(yX.type,yX),lC(),dC(),oC(),KF.registerGraphicComponent("text",Iv),KF.registerGraphicComponent("richtext",ag)};var _X=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._getMeasureData=function(t){return"horizontal"===e.series.getSpec().direction?t[e.series.getSpec().xField[0]]+"-"+t[e.series.getSpec().xField[1]]:t[e.series.getSpec().yField[0]]+"-"+t[e.series.getSpec().yField[1]]},e}return M(e,t),e}(EV),bX=function(t){return{type:"growCenterIn",options:{direction:"horizontal"===t.direction?"x":"y"}}},xX={type:"fadeIn"},kX=function(t){return{type:"growCenterOut",options:{direction:"horizontal"===t.direction?"x":"y"}}};function SX(t,e){return"fadeIn"===e?xX:bX(t)}var AX,MX,TX,wX=T(T({},TG),((AX={}).minLabel={name:"minLabel",type:"text"},AX.maxLabel={name:"maxLabel",type:"text"},AX)),CX=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!1,e}return M(e,t),e.prototype._transformLabelSpec=function(t){var e;"bothEnd"!==(null===(e=t.label)||void 0===e?void 0:e.position)&&this._addMarkLabelSpec(t,"bar")},e}(EG),EX={label:{visible:!1,offset:5,position:"inside",style:{lineWidth:2,fill:{type:"palette",key:"axisMarkerFontColor"}},minLabel:{position:"end"},maxLabel:{position:"start"}}},PX=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.rangeColumn,i._barMarkType="rect",i._barName=t.SeriesTypeEnum.bar,i.transformerConstructor=CX,i}return M(i,e),i.prototype.initMark=function(){var t,e,n,r,a,o,s,l;this._initBarBackgroundMark();var u=null===(t=this._spec.label)||void 0===t?void 0:t.position;this._barMark=this._createMark(i.mark.bar,{groupKey:this._seriesField,isSeriesMark:!0},{morph:$V(this._spec,i.mark.bar.name),morphElementKey:this.getDimensionField()[0]}),!1!==(null===(e=this._spec.label)||void 0===e?void 0:e.visible)&&"bothEnd"===u&&(!1!==(null===(r=null===(n=this._spec.label)||void 0===n?void 0:n.minLabel)||void 0===r?void 0:r.visible)&&(this._minLabelMark=this._createMark(i.mark.minLabel,{markSpec:null===(a=this._spec.label)||void 0===a?void 0:a.minLabel})),!1!==(null===(s=null===(o=this._spec.label)||void 0===o?void 0:o.maxLabel)||void 0===s?void 0:s.visible)&&(this._maxLabelMark=this._createMark(i.mark.maxLabel,{markSpec:null===(l=this._spec.label)||void 0===l?void 0:l.maxLabel})))},i.prototype.initMarkStyle=function(){var t,i;e.prototype.initMarkStyle.call(this),this._initLabelMarkPos(this._minLabelMark,null===(t=this._spec.label)||void 0===t?void 0:t.minLabel,0,"end"),this._initLabelMarkPos(this._maxLabelMark,null===(i=this._spec.label)||void 0===i?void 0:i.maxLabel,1,"start")},i.prototype._initLabelMarkPos=function(e,i,n,r){var a,o,s,l,u=this;e&&(this.setMarkStyle(e,{fill:null!==(o=null===(a=null==i?void 0:i.style)||void 0===a?void 0:a.fill)&&void 0!==o?o:this.getColorAttribute(),text:function(t){var e="horizontal"===u._spec.direction?t[u._spec.xField[n]]:t[u._spec.yField[n]];return(null==i?void 0:i.formatMethod)?i.formatMethod(e,t):e}}),function(e,i,n,r,a,o,s,l,u){e.setMarkStyle(i,{textAlign:function(t){if("vertical"===u())return"center";var e=a(t),i=o(t);if("middle"===n)return"center";if(e>=i){if("start"===n)return"left";if("end"===n)return"right";if("outside"===n)return"left"}else{if("start"===n)return"right";if("end"===n)return"left";if("outside"===n)return"right"}return"center"},textBaseline:function(t){if("horizontal"===u())return"middle";var e=s(t),i=l(t);if("middle"===n)return"middle";if(i>=e){if("start"===n)return"bottom";if("end"===n)return"top";if("outside"===n)return"bottom"}else{if("start"===n)return"top";if("end"===n)return"bottom";if("outside"===n)return"top"}return"middle"}}),e.setMarkStyle(i,{x:function(t){var e=u(),i=a(t),s=o(t);if("vertical"===e)return(i+s)/2;if("middle"===n)return(i+s)/2;if(i>=s){if("start"===n)return s+r;if("end"===n)return i-r;if("outside"===n)return i+r}else{if("start"===n)return s-r;if("end"===n)return i+r;if("outside"===n)return i-r}return(i+s)/2},y:function(t){var e=u(),i=s(t),a=l(t);if("horizontal"===e)return(i+a)/2;if("middle"===n)return(i+a)/2;if(i>=a){if("start"===n)return a+r;if("end"===n)return i-r;if("outside"===n)return i+r}else{if("start"===n)return a-r;if("end"===n)return i+r;if("outside"===n)return i-r}return(i+a)/2}},"normal",t.AttributeLevel.Series)}(this,e,null!==(s=null==i?void 0:i.position)&&void 0!==s?s:r,null!==(l=null==i?void 0:i.offset)&&void 0!==l?l:"vertical"===this._direction?-20:-25,(function(t){return u._barMark.getAttribute("x",t)}),(function(t){return"vertical"===u._direction?u._barMark.getAttribute("x",t)+u._barMark.getAttribute("width",t):u._barMark.getAttribute("x1",t)}),(function(t){return u._barMark.getAttribute("y",t)}),(function(t){return"vertical"===u._direction?u._barMark.getAttribute("y1",t):u._barMark.getAttribute("y",t)+u._barMark.getAttribute("height",t)}),(function(){return u._direction})))},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&(this.setMarkStyle(t,{text:function(t){var i,n;return"horizontal"===e._spec.direction?(i=t[e._spec.xField[0]],n=t[e._spec.xField[1]]):(i=t[e._spec.yField[0]],n=t[e._spec.yField[1]]),i+"-"+n},z:this._fieldZ?this.dataToPositionZ.bind(this):null}),this._labelMark=t)},i.prototype._dataToPosX=function(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[0]),{bandPosition:this._bandPosition})},i.prototype._dataToPosX1=function(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[1]),{bandPosition:this._bandPosition})},i.prototype._dataToPosY=function(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[0]),{bandPosition:this._bandPosition})},i.prototype._dataToPosY1=function(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[1]),{bandPosition:this._bandPosition})},i.prototype.initAnimation=function(){var t,e,i,n,r,a=sj(this),o=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._barMark.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("rangeColumn"))||void 0===i?void 0:i({direction:this.direction},o),ZV("bar",this._spec,this._markAttributeContext),a)),this._minLabelMark&&this._minLabelMark.setAnimationConfig(qV(null===(n=KF.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),ZV("label",this._spec,this._markAttributeContext),a)),this._maxLabelMark&&this._maxLabelMark.setAnimationConfig(qV(null===(r=KF.getAnimationInKey("fadeInOut"))||void 0===r?void 0:r(),ZV("label",this._spec,this._markAttributeContext),a))},i.prototype.initTooltip=function(){this._tooltipHelper=new _X(this),this._barMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._barMark),this._minLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._minLabelMark),this._maxLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._maxLabelMark),this._labelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._labelMark)},i.type=t.SeriesTypeEnum.rangeColumn,i.mark=wX,i.builtInTheme={rangeColumn:EX},i.transformerConstructor=CX,i}(BG),BX=function(){MG(),mX(),KF.registerAnimation("rangeColumn",(function(t,e){return{appear:SX(t,e),enter:bX(t),exit:kX(t),disappear:kX(t)}})),XN(),WU(),NU(),KF.registerSeries(PX.type,PX)};t.PositionEnum=void 0,(MX=t.PositionEnum||(t.PositionEnum={})).middle="middle",MX.start="start",MX.end="end",MX.bothEnd="bothEnd",function(t){t.middle="middle",t.start="start",t.end="end"}(TX||(TX={}));var RX=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._getMeasureData=function(t){return"horizontal"===e.series.getSpec().direction?t[e.series.getSpec().xField[0]]+"-"+t[e.series.getSpec().xField[1]]:t[e.series.getSpec().yField[0]]+"-"+t[e.series.getSpec().yField[1]]},e}return M(e,t),e}(EV),LX=T({},lG),IX=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.rangeArea,i}return M(i,e),i.prototype.initMark=function(){this._areaMark=this._createMark(i.mark.area,{groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this.getDimensionField()[0]})},i.prototype.initMarkStyle=function(){this.initAreaMarkStyle()},i.prototype.initAreaMarkStyle=function(){var i=this,n=this._areaMark;n&&(e.prototype.initAreaMarkStyle.call(this),"horizontal"===this._direction?this.setMarkStyle(this._areaMark,{x1:function(t){return i._xAxisHelper?(0,i._xAxisHelper.dataToPosition)(i.getDatumPositionValues(t,i._spec.xField[1]),{bandPosition:i._bandPosition}):Number.NaN}},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._areaMark,{y1:function(t){return i._yAxisHelper?(0,i._yAxisHelper.dataToPosition)(i.getDatumPositionValues(t,i._spec.yField[1]),{bandPosition:i._bandPosition}):Number.NaN}},"normal",t.AttributeLevel.Series),this.setMarkStyle(n,{stroke:!1},"normal",t.AttributeLevel.Series))},i.prototype.initTooltip=function(){this._tooltipHelper=new RX(this)},i.prototype._isFieldAllValid=function(){var t=this.getViewDataStatistics(),e=this.fieldY;return!!(t&&t.latestData&&e.length)&&e.every((function(e){return t.latestData[e]&&t.latestData[e].allValid}))},i.type=t.SeriesTypeEnum.rangeArea,i.mark=LX,i}(dG),DX=function(){oG(),WU(),NU(),KF.registerSeries(IX.type,IX)},OX=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.coordinate="polar",t._outerRadius=uU,t._innerRadius=0,t._angleField=[],t._radiusField=[],t._sortDataByAxis=!1,t}return M(i,e),Object.defineProperty(i.prototype,"outerRadius",{get:function(){return this._outerRadius},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"innerRadius",{get:function(){return this._innerRadius},enumerable:!1,configurable:!0}),i.prototype.getAngleField=function(){return this._angleField},i.prototype.setAngleField=function(t){return this._angleField=U(t)?St(t):[],this._angleField},i.prototype.getRadiusField=function(){return this._radiusField},i.prototype.setRadiusField=function(t){return this._radiusField=U(t)?St(t):[],this._radiusField},Object.defineProperty(i.prototype,"innerRadiusField",{get:function(){return this._innerRadiusField},enumerable:!1,configurable:!0}),i.prototype.setInnerRadiusField=function(t){return this._innerRadiusField=St(t),this._innerRadiusField},Object.defineProperty(i.prototype,"radiusScale",{get:function(){return this._radiusScale},enumerable:!1,configurable:!0}),i.prototype.setRadiusScale=function(t){return this._radiusScale=t,t},Object.defineProperty(i.prototype,"angleScale",{get:function(){return this._angleScale},enumerable:!1,configurable:!0}),i.prototype.setAngleScale=function(t){return this._angleScale=t,t},Object.defineProperty(i.prototype,"angleAxisHelper",{get:function(){return this._angleAxisHelper},set:function(t){this._angleAxisHelper=t,this.onAngleAxisHelperUpdate()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"radiusAxisHelper",{get:function(){return this._radiusAxisHelper},set:function(t){this._radiusAxisHelper=t,this.onRadiusAxisHelperUpdate()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"sortDataByAxis",{get:function(){return this._sortDataByAxis},enumerable:!1,configurable:!0}),i.prototype._buildMarkAttributeContext=function(){var t=this;e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getCenter=function(){return t.angleAxisHelper.center()},this._markAttributeContext.getLayoutRadius=function(){return t._computeLayoutRadius()}},i.prototype.valueToPosition=function(t,e){if(j(t)||j(e)||!this.angleAxisHelper||!this.radiusAxisHelper)return{x:Number.NaN,y:Number.NaN};var i=this.radiusAxisHelper.dataToPosition(St(e));if(i<0){if("break"===this._invalidType||"link"===this._invalidType)return{x:Number.NaN,y:Number.NaN};if("zero"===this._invalidType)return this.angleAxisHelper.center()}var n=this.angleAxisHelper.dataToPosition(St(t));return this.angleAxisHelper.coordToPoint({angle:n,radius:i})},i.prototype.dataToPosition=function(t,e){return t&&this.angleAxisHelper&&this.radiusAxisHelper?e&&!this.isDatumInViewData(t)?null:this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getDatumPositionValues(t,this._radiusField)):null},i.prototype.dataToPositionX=function(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.x},i.prototype.dataToPositionY=function(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.y},i.prototype.dataToPositionZ=function(t){return 0},i.prototype.positionToData=function(t){},i.prototype.radiusToData=function(t){},i.prototype.angleToData=function(t){},i.prototype.getStatisticFields=function(){var t,e,i=this,n=[];return(null===(t=this.radiusAxisHelper)||void 0===t?void 0:t.getScale)&&this._radiusField.forEach((function(t){var e={key:t,operations:[]};JR(i.radiusAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],n.push(e)})),(null===(e=this.angleAxisHelper)||void 0===e?void 0:e.getScale)&&this._angleField.forEach((function(t){var e={key:t,operations:[]};JR(i.angleAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],n.push(e)})),n},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),U(this._spec.outerRadius)&&(this._outerRadius=this._spec.outerRadius),U(this._spec.radius)&&(this._outerRadius=this._spec.radius),U(this._spec.innerRadius)&&(this._innerRadius=this._spec.innerRadius),U(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)},i.prototype.onRadiusAxisHelperUpdate=function(){this.onMarkPositionUpdate()},i.prototype.onAngleAxisHelperUpdate=function(){this.onMarkPositionUpdate()},i.prototype.afterInitMark=function(){e.prototype.afterInitMark.call(this)},i.prototype._computeLayoutRadius=function(){var t=this._angleAxisHelper||this._radiusAxisHelper;if(t)return t.layoutRadius();var e=this._region.getLayoutRect(),i=e.width,n=e.height;return Math.min(i/2,n/2)},i.prototype.initEvent=function(){var i=this;e.prototype.initEvent.call(this),this.sortDataByAxis&&this.event.on(t.ChartEvent.scaleDomainUpdate,{filter:function(t){var e;return t.model.id===(null===(e=i._angleAxisHelper)||void 0===e?void 0:e.getAxisId())}},(function(){i._sortDataInAxisDomain()}))},i.prototype._sortDataInAxisDomain=function(){var t,e;(null===(e=null===(t=this.getViewData())||void 0===t?void 0:t.latestData)||void 0===e?void 0:e.length)&&oj(this.angleAxisHelper,this._angleField[0],this.getViewData().latestData)},i.prototype.getInvalidCheckFields=function(){var t=[];return this.angleAxisHelper.isContinuous&&this._angleField.forEach((function(e){t.push(e)})),this.radiusAxisHelper.isContinuous&&this._radiusField.forEach((function(e){t.push(e)})),t},i}(rj);function FX(t){return bx(t)?Number.parseFloat(t):0}var zX=function(t,e){var i=e.asStartAngle,n=e.asEndAngle,r=e.asMiddleAngle,a=e.asRadian,o=e.asRatio,s=e.asQuadrant,l=e.asK,u=e.showAllZero,c=e.supportNegative,h=e.showEmptyCircle,d=e.angleField(),p=e.startAngle(),f=e.endAngle(),v=e.minAngle(),g=t.map((function(t){return T({},t)}));if(!g||0===g.length)return g;if(!u&&h&&HX(g,d,c))return[];for(var y=function(t,e,o){t[i]=e,t[n]=e+o,t[r]=e+o/2,t[a]=o,t[s]=Ye(e+o/2)},m=0,_=-1/0,b=!0,x=0;x<g.length;x++){var k=c?Math.abs(FX(g[x][d])):FX(g[x][d]);m+=k,_=Math.max(k,_),b&&0!==k&&(b=!1),g[x][$j]=k}var S=g.map((function(t){return Number(t[d])})),A=f-p,M=p,w=A,C=0,E=function(t,e){void 0===e&&(e=2);var i=t.reduce((function(t,e){return t+(isNaN(e)?0:e)}),0);if(0===i)return 0;for(var n=Math.pow(10,e),r=t.map((function(t){return(isNaN(t)?0:t)/i*n*100})),a=100*n,o=r.map((function(t){return Math.floor(t)})),s=o.reduce((function(t,e){return t+e}),0),l=r.map((function(t,e){return t-o[e]}));s<a;){for(var u=Number.NEGATIVE_INFINITY,c=null,h=0;h<l.length;h++)l[h]>u&&(u=l[h],c=h);++o[c],l[c]=0,++s}return o.map((function(t){return t/n}))}(S);if(g.forEach((function(t,e){var i=t[$j],n=m?i/m:0,r=n*A;r<v?(r=v,w-=v):C+=i;var a=M,s=M+r;t[o]=n,t[l]=_?i/_:0,t._percent_=E[e],y(t,a,r),M=s})),w<A)if(w<=.001){var P=A/g.length;g.forEach((function(t,e){y(t,p+e*P,P)}))}else{var B=w/C;M=p,g.forEach((function(t){var e=t[a]===v?v:t[$j]*B;y(t,M,e),M+=e}))}if(0!==m&&(g[g.length-1][n]=f),b&&u){var R=A/g.length;g.forEach((function(t,e){y(t,p+e*R,R)}))}return g},HX=function(t,e,i){return!!j(t)||(0===t.length||(!!t.every((function(t){return 0===FX(t[e])}))||!i&&0===t.reduce((function(t,i){return t+FX(i[e])}),0)))};function NX(t,e,i){return function(n,r,a){return e?"radius"===t.growField?{overall:0}:{overall:t.growFrom(n,r,i)}:{overall:!1}}}var VX=function(t){return{type:"radius"===t.growField?"growRadiusIn":"growAngleIn",options:NX(t,!0,BH.appear)}},jX={type:"fadeIn"},UX=function(t){return{type:"radius"===t.growField?"growRadiusIn":"growAngleIn",easing:"linear",options:NX(t,!0,BH.enter)}},WX=function(t){return{type:"radius"===t.growField?"growRadiusOut":"growAngleOut",easing:"linear",options:NX(t,!0,BH.exit)}},GX=function(t){return{type:"radius"===t.growField?"growRadiusOut":"growAngleOut",options:NX(t,!0,BH.exit)}};function YX(t,e){if(!1===e)return{};switch(e){case"fadeIn":return jX;case"growRadius":return VX(T(T({},t),{growField:"radius"}));default:return VX(T(T({},t),{growField:"angle"}))}}var XX,KX=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=qX.type,n._unCompileChannel={centerOffset:!0,radiusOffset:!0},n.computeOuterRadius=function(t,e,i,r){var a;return void 0===i&&(i="normal"),r+(null!==(a=n.getAttribute("radiusOffset",e,i))&&void 0!==a?a:0)},n.computeCenter=function(t,e,i,r){return void 0===i&&(i="normal"),Ve({x:0,y:0},n.getAttribute("centerOffset",e,i),e[rU])[t]+r},n._computeExChannel.x=n.computeCenter,n._computeExChannel.y=n.computeCenter,n._computeExChannel.outerRadius=n.computeOuterRadius,n._extensionChannel.centerOffset=["x","y"],n._extensionChannel.radiusOffset=["outerRadius"],n}return M(e,t),e.prototype._getDefaultStyle=function(){return T(T({},t.prototype._getDefaultStyle.call(this)),{startAngle:0,endAngle:0,outerRadius:0,innerRadius:0,cornerRadius:0,lineWidth:0,innerPadding:0,outerPadding:0})},e}(RN),qX=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return M(e,t),e.type="arc",e}(KX),ZX=function(){lC(),Nw(),DI("arc",XI),JN(),KF.registerGraphicComponent("arc",fg),KF.registerMark(qX.type,qX)},JX=T(T({},VV),((XX={}).pie={name:"pie",type:"arc"},XX.labelLine={name:"labelLine",type:"path"},XX)),QX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"pie")},e.prototype._mergeThemeToSpec=function(t,e){var i=this,n=this._theme,r=t;if(this._shouldMergeThemeToSpec()){var a=this._getDefaultSpecFromChart(e);r=XF({},this._theme,a,t);var o=function(t,e){return XF({},"inside"===t||"inside-center"===t?i._theme.innerLabel:i._theme.outerLabel,e)};q(r.label)?r.label=r.label.map((function(t){return o(t.position,t)})):r.label=o(r.label.position,r.label)}return{spec:r,theme:n}},e.prototype._getDefaultSpecFromChart=function(e){var i,n=null!==(i=t.prototype._getDefaultSpecFromChart.call(this,e))&&void 0!==i?i:{},r=e.centerX,a=e.centerY;return U(r)&&(n.centerX=r),U(a)&&(n.centerY=a),Object.keys(n).length>0?n:void 0},e}(nj),$X="".concat(mz,"_LABEL_VISIBLE"),tK={outerRadius:.6,pie:{style:{fillOpacity:1}},label:{visible:!1,interactive:!0,position:"outside",style:{fontWeight:"normal",stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1}},innerLabel:{style:{lineWidth:2}},emptyCircle:{style:{fill:{type:"palette",key:"emptyCircleColor"},fillOpacity:1}}},eK=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.transformerConstructor=QX,t._pieMarkName="pie",t._pieMarkType="arc",t.getCenter=function(){var e,i,n=t._region.getLayoutRect();return{x:BF(null===(e=t._spec)||void 0===e?void 0:e.centerX,n.width,n,n.width/2),y:BF(null===(i=t._spec)||void 0===i?void 0:i.centerY,n.height,n,n.height/2)}},t._startAngle=sU,t._endAngle=lU,t._pieMark=null,t._labelMark=null,t._labelLineMark=null,t._emptyArcMark=null,t.dataToCentralPosition=function(e){var i=e[rU];if(j(i))return null;var n=t.computeDatumRadius(e),r=t.computeDatumInnerRadius(e);return Ve(t.computeCenter(e),(n+r)/2,i)},t}return M(i,e),i.prototype._buildMarkAttributeContext=function(){var t=this;e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.getCenter=function(){return{x:function(){return t.getCenter().x},y:function(){return t.getCenter().y}}},this._markAttributeContext.startAngleScale=function(e){return t.startAngleScale(e)},this._markAttributeContext.endAngleScale=function(e){return t.endAngleScale(e)}},i.prototype.setAttrFromSpec=function(){var t,i,n,r,a,o;e.prototype.setAttrFromSpec.call(this),this._centerOffset=null!==(t=this._spec.centerOffset)&&void 0!==t?t:0,this._cornerRadius=null!==(i=this._spec.cornerRadius)&&void 0!==i?i:0;var s=function(t,e){var i=0,n=2*Math.PI,r=U(t),a=U(e);for(r||a?a?r?(i=t,n=e):(i=e-2*Math.PI,n=e):(i=t,n=t+2*Math.PI):(i=0,n=2*Math.PI);n<=i;)n+=2*Math.PI;for(;i>2*Math.PI;)i-=2*Math.PI,n-=2*Math.PI;for(;n<0;)i+=2*Math.PI,n+=2*Math.PI;return{startAngle:i,endAngle:n}}(U(this._spec.startAngle)?Fe(this._spec.startAngle):this._startAngle,U(this._spec.endAngle)?Fe(this._spec.endAngle):this._endAngle);this._startAngle=s.startAngle,this._endAngle=s.endAngle,this._padAngle=U(this._spec.padAngle)?Fe(this._spec.padAngle):0,this.setAngleField(this._spec.valueField||this._spec.angleField),this._spec.categoryField&&this.setSeriesField(this._spec.categoryField),this._radiusField=[],this._specAngleField=this._angleField.slice(),this._specRadiusField=[],this._showEmptyCircle=null!==(r=null===(n=this._spec.emptyPlaceholder)||void 0===n?void 0:n.showEmptyCircle)&&void 0!==r&&r,this._showAllZero=null!==(a=this._spec.showAllZero)&&void 0!==a&&a,this._supportNegative=null!==(o=this._spec.supportNegative)&&void 0!==o&&o},i.prototype.initData=function(){var t=this;e.prototype.initData.call(this);var i=this.getViewData();if(i){kH(this._dataSet,"pie",zX),i.transform({type:"pie",options:{angleField:function(){return t._angleField[0]},startAngle:function(){return t._startAngle},endAngle:function(){return t._endAngle},minAngle:function(){return U(t._spec.minAngle)?Fe(t._spec.minAngle):0},asStartAngle:eU,asEndAngle:iU,asRatio:tU,asMiddleAngle:rU,asRadian:oU,asQuadrant:aU,asK:nU,showAllZero:this._showAllZero,supportNegative:this._supportNegative,showEmptyCircle:this._showEmptyCircle}},!1);var n=new hs(this._dataSet,{name:"".concat(mz,"_series_").concat(this.id,"_viewDataLabel")});n.parse([this.getViewData()],{type:"dataview"}),this._viewDataLabel=new wN(this._option,n)}},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._viewDataLabel)||void 0===t||t.compile()},i.prototype.initMark=function(){this._pieMark=this._createMark(T(T({},i.mark.pie),{name:this._pieMarkName,type:this._pieMarkType}),{key:Sz,groupKey:this._seriesField,isSeriesMark:!0},{morph:$V(this._spec,this._pieMarkName),morphElementKey:this._seriesField}),this._showEmptyCircle&&(this._emptyArcMark=this._createMark({name:"emptyCircle",type:"arc"},{dataView:!1}),this._data.addRelatedMark(this._emptyArcMark))},i.prototype.startAngleScale=function(t){return lF(eU)(t)},i.prototype.endAngleScale=function(t){return lF(iU)(t)},i.prototype._computeLayoutRadius=function(){var t=this;return cU((function(){return t._spec.layoutRadius}),this.getLayoutRect,this.getCenter,(function(){return{startAngle:t._startAngle,endAngle:t._endAngle}}))},i.prototype.initMarkStyle=function(){var e=this,i={x:function(){return e.getCenter().x},y:function(){return e.getCenter().y},fill:this.getColorAttribute(),outerRadius:wF(this._outerRadius)?this._outerRadius:function(){return e._computeLayoutRadius()*e._outerRadius},innerRadius:wF(this._innerRadius)?this._innerRadius:function(){return e._computeLayoutRadius()*e._innerRadius},cornerRadius:function(){return e._computeLayoutRadius()*e._cornerRadius},startAngle:function(t){return e.startAngleScale(t)},endAngle:function(t){return e.endAngleScale(t)},padAngle:this._padAngle,centerOffset:this._centerOffset},n=this._pieMark;n&&this.setMarkStyle(n,i,"normal",t.AttributeLevel.Series);var r=this._emptyArcMark;r&&this.setMarkStyle(r,T(T({},i),{visible:function(){var t=e.getViewData().latestData;return!t||!t.length}}),"normal",t.AttributeLevel.Series)},i.prototype.getInteractionTriggers=function(){return this._parseInteractionConfig(this._pieMark?[this._pieMark]:[])},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._pieMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pieMark)},i.prototype.initMarkStyleWithSpec=function(i,n){if(e.prototype.initMarkStyleWithSpec.call(this,i,n),i.name===this._pieMarkName){var r=this.getSpec()[i.name];if(r)for(var a in r.state||{})this.setMarkStyle(i,this.generateRadiusStyle(r.state[a]),a,t.AttributeLevel.User_Mark)}"emptyCircle"===i.name&&this.setMarkStyle(i,this.generateRadiusStyle(n.style),"normal",t.AttributeLevel.User_Mark)},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{visible:lF($X).bind(this),text:function(t){return t[e.getDimensionField()[0]]},fill:this.getColorAttribute(),z:this.dataToPositionZ.bind(this)})},i.prototype.afterInitMark=function(){e.prototype.afterInitMark.call(this)},i.prototype.initEvent=function(){var t;e.prototype.initEvent.call(this),null===(t=this._viewDataLabel.getDataView())||void 0===t||t.target.addListener("change",this.viewDataLabelUpdate.bind(this))},i.prototype.initGroups=function(){},i.prototype.onLayoutEnd=function(){this._viewDataLabel.getDataView().reRunAllTransform(),this.onMarkPositionUpdate(),e.prototype.onLayoutEnd.call(this)},i.prototype.getDimensionField=function(){return this._seriesField?[this._seriesField]:[]},i.prototype.getMeasureField=function(){return this._specAngleField},i.prototype.viewDataLabelUpdate=function(){this.event.emit(t.ChartEvent.viewDataLabelUpdate,{model:this}),this._viewDataLabel.updateData()},i.prototype.generateRadiusStyle=function(t){var e=this;if(t){var i={};return t.outerRadius&&(i.outerRadius=function(){return e._computeLayoutRadius()*t.outerRadius}),t.innerRadius&&(i.innerRadius=function(){return e._computeLayoutRadius()*t.innerRadius}),t.cornerRadius&&(i.cornerRadius=function(){return e._computeLayoutRadius()*t.cornerRadius}),i}},i.prototype.computeCenter=function(t){return{x:this._pieMark.getAttribute("x",t,"normal"),y:this._pieMark.getAttribute("y",t,"normal")}},i.prototype.getRadius=function(t){var e,i,n,r,a,o,s;void 0===t&&(t="normal");var l="normal"===t?null===(n=null===(i=this.getSpec()[(null===(e=this._pieMark)||void 0===e?void 0:e.name)||"pie"])||void 0===i?void 0:i.style)||void 0===n?void 0:n.outerRadius:null===(s=null===(o=null===(a=this.getSpec()[(null===(r=this._pieMark)||void 0===r?void 0:r.name)||"pie"])||void 0===a?void 0:a.state)||void 0===o?void 0:o[t])||void 0===s?void 0:s.outerRadius;return null!=l?l:this._outerRadius},i.prototype.getInnerRadius=function(t){var e,i,n,r,a,o,s;void 0===t&&(t="normal");var l="normal"===t?null===(n=null===(i=this.getSpec()[(null===(e=this._pieMark)||void 0===e?void 0:e.name)||"pie"])||void 0===i?void 0:i.style)||void 0===n?void 0:n.innerRadius:null===(s=null===(o=null===(a=this.getSpec()[(null===(r=this._pieMark)||void 0===r?void 0:r.name)||"pie"])||void 0===a?void 0:a.state)||void 0===o?void 0:o[t])||void 0===s?void 0:s.innerRadius;return null!=l?l:this._innerRadius},i.prototype.computeRadius=function(t,e){return this._computeLayoutRadius()*t*(j(e)?1:e)+this._centerOffset},i.prototype.computeDatumRadius=function(t,e){return this._computeLayoutRadius()*this.getRadius(e)+this._centerOffset},i.prototype._compareSpec=function(t,i,n){n=null!=n?n:{data:!0};var r=["centerX","centerY","centerOffset","radius","innerRadius","cornerRadius","startAngle","endAngle","padAngle"];r.forEach((function(t){n[t]=!0}));var a=e.prototype._compareSpec.call(this,t,i,n);return t=null!=t?t:{},r.some((function(e){return t[e]!==i[e]}))&&(a.reRender=!0,a.change=!0),a},i.prototype.computeDatumInnerRadius=function(t,e){return this._computeLayoutRadius()*this.getInnerRadius(e)+this._centerOffset},i.prototype.dataToPosition=function(t,e){var i=t[rU];if(j(i))return null;if(e&&!this.isDatumInViewData(t))return null;var n=this.computeDatumRadius(t);return Ve(this.computeCenter(t),n,i)},i.prototype.initAnimation=function(){var t,e,i,n=this,r={growFrom:function(t,e,i){var r,a;if(i===BH.appear)return n._startAngle;if(i===BH.disappear)return n._endAngle;var o=[BH.disappear,BH.exit],s=n._pieMark.getGraphics(),l=t,u=null==l?void 0:l[kz];if(void 0===s.find((function(t){var e;return(null===(e=t.context.data[0])||void 0===e?void 0:e[kz])<u})))return n._startAngle;if(void 0===s.find((function(t){var e;return(null===(e=t.context.data[0])||void 0===e?void 0:e[kz])>u})))return n._endAngle;var c=R([],B(s),!1).reverse().find((function(t){var e;return(null===(e=t.context.data[0])||void 0===e?void 0:e[kz])<u}));return o.includes(i)?null===(r=null==c?void 0:c.getFinalAttribute())||void 0===r?void 0:r.endAngle:null===(a=null==c?void 0:c.attribute)||void 0===a?void 0:a.endAngle}},a=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;this._pieMark&&((o=qV(null===(e=KF.getAnimationInKey("pie"))||void 0===e?void 0:e(r,a),ZV("pie",this._spec,this._markAttributeContext))).normal&&o.normal.type&&(o.normal=function(t,e){var i,n,r,a,o=null!==(n=null===(i=e.options)||void 0===i?void 0:i.distance)&&void 0!==n?n:10,s=et(e.duration)?e.duration/2:1e3,l=null!==(r=e.options.easing)&&void 0!==r?r:"cubicOut";return{oneByOne:e.oneByOne,loop:null!==(a=e.loop)&&void 0!==a&&a,timeSlices:[{duration:s,effects:{easing:l,channel:{x:{from:function(e){return t.getAttribute("x",e)},to:function(e){return t.getAttribute("x",e)+Ve({x:0,y:0},o,e[rU]).x}},y:{from:function(e){return t.getAttribute("y",e)},to:function(e){return t.getAttribute("y",e)+Ve({x:0,y:0},o,e[rU]).y}}}}},{duration:s,effects:{easing:l,channel:{x:{to:function(e){return t.getAttribute("x",e)},from:function(e){return t.getAttribute("x",e)+Ve({x:0,y:0},o,e[rU]).x}},y:{to:function(e){return t.getAttribute("y",e)},from:function(e){return t.getAttribute("y",e)+Ve({x:0,y:0},o,e[rU]).y}}}}}]}}(this._pieMark,o.normal)),this._pieMark.setAnimationConfig(o));if(this._emptyArcMark){var o=qV(null===(i=KF.getAnimationInKey("emptyCircle"))||void 0===i?void 0:i(r,null!=a?a:"fadeIn"));this._emptyArcMark.setAnimationConfig(o)}},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype._noAnimationDataKey=function(t,e){return e},i.prototype.getActiveMarks=function(){return[this._pieMark]},i.transformerConstructor=QX,i.mark=JX,i.builtInTheme={pie:tK},i}(OX),iK=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.pie,i}return M(i,e),i.type=t.SeriesTypeEnum.pie,i}(eK),nK=function(){ZX(),KF.registerAnimation("pie",(function(t,e){return{appear:YX(t,e),enter:UX(t),exit:WX(t),disappear:GX(t)}})),KF.registerAnimation("emptyCircle",(function(t,e){return{appear:YX(t,e)}})),KF.registerSeries(iK.type,iK)};function rK(t){return"angle"===t?"growAngleIn":"growRadiusIn"}var aK=function(t){return{type:rK(t.growField),options:{overall:!0}}},oK={type:"fadeIn"},sK=function(t){return{type:rK(t.growField)}},lK=function(t){return{type:(e=t.growField,"angle"===e?"growAngleOut":"growRadiusOut")};var e},uK=lK;function cK(t,e){if(!1===e)return{};switch(e){case"fadeIn":return oK;case"growAngle":return aK(T(T({},t),{growField:"angle"}));default:return aK(T(T({},t),{growField:"radius"}))}}var hK,dK=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.getStackGroupFields=function(){return this._angleField},e.prototype.getStackValueField=function(){return St(this._spec.valueField)[0]||St(this._spec.radiusField)[0]},e.prototype.getGroupFields=function(){return this._angleField},e.prototype.setAttrFromSpec=function(){t.prototype.setAttrFromSpec.call(this),this.setAngleField(this._spec.categoryField||this._spec.angleField),this.setRadiusField(this._spec.valueField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice(),this.setInnerRadiusField(this._spec.valueField||this._spec.radiusField),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent()},e.prototype.setValueFieldToStack=function(){this.setRadiusField(Cz),this.setInnerRadiusField(wz)},e.prototype.setValueFieldToPercent=function(){this.setRadiusField(Pz),this.setInnerRadiusField(Ez)},e.prototype.getDimensionField=function(){return this._specAngleField},e.prototype.getMeasureField=function(){return this._specRadiusField},e.prototype.getDefaultShapeType=function(){return"square"},e}(OX),pK=T(T({},VV),((hK={}).rose={name:"rose",type:"arc"},hK)),fK=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!0,e}return M(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"rose")},e}(nj),vK=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.type=I.polarAxis,r.name=I.polarAxis,r._defaultBandPosition=0,r._defaultBandInnerPadding=0,r._defaultBandOuterPadding=0,r.layoutType="absolute",r.layoutZIndex=t.LayoutZIndex.Axis,r._tick=void 0,r._center=null,r._startAngle=sU,r._endAngle=lU,r._orient="radius",r._groupScales=[],r.effect={scaleUpdate:function(t){r.computeData(null==t?void 0:t.value),iF(r._regions,(function(t){"radius"===r.getOrient()?Jj(t.radiusAxisHelper,r.axisHelper(),U(r._seriesUserId)||U(r._seriesIndex))&&(t.radiusAxisHelper=r.axisHelper()):Jj(t.angleAxisHelper,r.axisHelper(),U(r._seriesUserId)||U(r._seriesIndex))&&(t.angleAxisHelper=r.axisHelper())}),{userId:r._seriesUserId,specIndex:r._seriesIndex})}},r._transformLayoutPosition=function(t){var e,i=null===(e=r.getRegions())||void 0===e?void 0:e[0];return i?i.getLayoutStartPoint():t},r.getCenter=function(){var t,e,i=r.getRefLayoutRect(),n=i.width,a=i.height;return{x:BF(null===(t=r._center)||void 0===t?void 0:t.x,n,i,n/2),y:BF(null===(e=r._center)||void 0===e?void 0:e.y,a,i,a/2)}},r.getRefLayoutRect=function(){return r.getRegions()[0].getLayoutRect()},r._coordinateType="polar",r}return M(i,e),Object.defineProperty(i.prototype,"center",{get:function(){return this._center},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"startAngle",{get:function(){return this._startAngle},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"endAngle",{get:function(){return this._endAngle},enumerable:!1,configurable:!0}),i.prototype.getOrient=function(){return this._orient},i.prototype.getDefaultInteractive=function(){return"angle"!==this._orient},i.prototype.getGroupScales=function(){return this._groupScales},i.getSpecInfo=function(t){var e=this;if(!t[this.specKey])return null;var i,n,r=q(t[this.specKey]),a=r?t[this.specKey]:[t[this.specKey]],o=[],s=[],l=[];return a.forEach((function(a,u){if("angle"===(h=null==(c=a)?void 0:c.orient)||"radius"===h){var c,h,d=function(t,e){var i,n,r,a,o,s,l=null!==(i=t.type)&&void 0!==i?i:"angle"===t.orient?"band":"linear",u="".concat(I.polarAxis,"-").concat(l),c=null!==(n=t.startAngle)&&void 0!==n?n:e.startAngle,h=null!==(r=t.endAngle)&&void 0!==r?r:e.endAngle;return{axisType:l,componentName:u,startAngle:null!=c?c:-90,endAngle:null!=h?h:U(c)?c+360:270,center:U(e.center)?e.center:U(null==e?void 0:e.centerX)||U(null==e?void 0:e.centerY)?{x:null==e?void 0:e.centerX,y:null==e?void 0:e.centerY}:void 0,outerRadius:null!==(s=null!==(o=null!==(a=t.outerRadius)&&void 0!==a?a:t.radius)&&void 0!==o?o:e.outerRadius)&&void 0!==s?s:e.radius,layoutRadius:e.layoutRadius}}(a,t),p=d.axisType,f=d.componentName,v=d.startAngle,g=d.endAngle,y=d.center,m=d.outerRadius,_=d.layoutRadius;a.center=y,a.startAngle=v,a.endAngle=g,a.outerRadius=m,a.type=p,a.layoutRadius=_;var b={spec:a,specPath:r?[e.specKey,u]:[e.specKey],specInfoPath:["component",e.specKey,u],type:f};o.push(b),"radius"===a.orient?(s.push(b),n=u):(l.push(b),i=u)}})),s.forEach((function(t){t.angleAxisIndex=i})),l.forEach((function(t){t.radiusAxisIndex=n})),o},i.createComponent=function(t,e){var i=t.spec,n=w(t,["spec"]),r=KF.getComponentInKey(n.type);return r?new r(i,T(T({},e),n)):(e.onError("Component ".concat(n.type," not found")),null)},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.visible&&(this._axisStyle=this._getAxisAttributes(),this._gridStyle=this._getGridAttributes()),this._tick=this._spec.tick,this._orient="angle"===this._spec.orient?"angle":"radius",this._center=this._spec.center,this._startAngle=Fe(this._spec.startAngle),this._endAngle=Fe(this._spec.endAngle),this._inverse=this._spec.inverse},i.prototype._tickTransformOption=function(){var t,i=this;return T(T({},e.prototype._tickTransformOption.call(this)),{noDecimal:null===(t=this._tick)||void 0===t?void 0:t.noDecimals,startAngle:this.startAngle,labelOffset:Yj(this._spec),getRadius:function(){return i.getOuterRadius()},inside:this._spec.inside})},i.prototype.updateScaleRange=function(){var t,e=this._scale.range();return t="radius"===this.getOrient()?this._inverse?[this.computeLayoutOuterRadius(),this.computeLayoutInnerRadius()]:[this.computeLayoutInnerRadius(),this.computeLayoutOuterRadius()]:this._inverse?[this._endAngle,this._startAngle]:[this._startAngle,this._endAngle],(!e||!t||e[0]!==t[0]||e[1]!==t[1])&&(this._scale.range(t),!0)},i.prototype.collectSeriesField=function(t,e){var i,n;return t>0?null===(n=null===(i=e.getGroups())||void 0===i?void 0:i.fields)||void 0===n?void 0:n[t]:"radius"===this.getOrient()?e.getRadiusField():e.getAngleField()},i.prototype.updateSeriesScale=function(){var t=this;iF(this._regions,(function(e){"radius"===t.getOrient()?Jj(e.radiusAxisHelper,t.axisHelper(),U(t._seriesUserId)||U(t._seriesIndex))&&(e.setRadiusScale(t._scale),e.radiusAxisHelper=t.axisHelper()):Jj(e.angleAxisHelper,t.axisHelper(),U(t._seriesUserId)||U(t._seriesIndex))&&(e.setAngleScale(t._scale),e.angleAxisHelper=t.axisHelper())}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype.getSeriesStatisticsField=function(t){var e="radius"===this.getOrient()?t.getRadiusField():t.getAngleField();return JR(this._scale.type)?e:[e[0]]},i.prototype.initGroupScales=function(){},i.prototype.axisHelper=function(){var t=this;return{isContinuous:JR(this._scale.type),dataToPosition:this.dataToPosition.bind(this),coordToPoint:this.coordToPoint.bind(this),pointToCoord:this.pointToCoord.bind(this),center:this.getCenter.bind(this),layoutRadius:this._computeLayoutRadius.bind(this),getScale:function(e){return void 0===e&&(e=0),t._scales[e]},getAxisId:function(){return t.id},getSpec:function(){return t._spec}}},i.prototype.positionToData=function(t){var e=this.pointToCoord(t);return"radius"===this.getOrient()?this.invert(e.radius):this.invert(e.angle)},i.prototype.coordToPoint=function(t){return Ve(this.getCenter(),t.radius,t.angle)},i.prototype.pointToCoord=function(t){return je(t,this.getCenter(),this._startAngle,this._endAngle)},i.prototype.getOuterRadius=function(){return this.computeLayoutOuterRadius()},i.prototype.getInnerRadius=function(){return this.computeLayoutInnerRadius()},i.prototype.updateLayoutAttribute=function(){this._visible&&("radius"===this.getOrient()?this._layoutRadiusAxis():this._layoutAngleAxis()),e.prototype.updateLayoutAttribute.call(this)},i.prototype._getNormalizedValue=function(t,e){return 0===e?0:(this.dataToPosition(t)-this._getStartValue())/e},i.prototype.getLabelItems=function(t){var e,i=this,n=null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData();return n&&n.length?[n.map((function(e){return Zj(e.value,i._getNormalizedValue([e.value],t))}))]:[]},i.prototype._getStartValue=function(){return"radius"===this.getOrient()?this.computeLayoutInnerRadius():this._startAngle},i.prototype._layoutAngleAxis=function(){var t,e,i,n=this.getCenter(),r=this.computeLayoutOuterRadius(),a=this.computeLayoutInnerRadius(),o=this._endAngle-this._startAngle,s=this.getLabelItems(o),l=T(T({},this.getLayoutStartPoint()),{inside:this._spec.inside,center:n,radius:r,innerRadius:a,startAngle:this._startAngle,endAngle:this._endAngle,sides:(null===(i=null===(e=null===(t=this._getRelatedAxis(this._option.radiusAxisIndex))||void 0===t?void 0:t.getSpec())||void 0===e?void 0:e.grid)||void 0===i?void 0:i.smooth)?void 0:this.getScale().domain().length}),u=T(T({},l),{size:this.getRefLayoutRect(),title:{text:this._spec.title.text||this._dataFieldText},items:s,orient:"angle",scale:this._scale});this._spec.grid.visible&&(u.grid=T({type:"line",smoothLink:!0,items:s[0]},l)),this._update(u)},i.prototype._layoutRadiusAxis=function(){var t,e,i,n=this.getCenter(),r=this.computeLayoutOuterRadius(),a=this.computeLayoutInnerRadius(),o=this.coordToPoint({angle:this._startAngle,radius:r}),s=this.coordToPoint({angle:this._startAngle,radius:a}),l=Oe.distancePP(s,o),u=this.getLabelItems(l),c=T(T({},this.getLayoutStartPoint()),{start:s,end:o,verticalFactor:-1}),h=T(T({},c),{title:{text:this._spec.title.text||this._dataFieldText},items:u,orient:"radius",scale:this._scale.clone()});(null===(t=this._spec.grid)||void 0===t?void 0:t.visible)&&(h.grid=T({items:u[0],type:(null===(e=this._spec.grid)||void 0===e?void 0:e.smooth)?"circle":"polygon",center:n,closed:!0,sides:null===(i=this._getRelatedAxis(this._option.angleAxisIndex))||void 0===i?void 0:i.getScale().domain().length,startAngle:this._startAngle,endAngle:this._endAngle},c)),this._update(h)},i.prototype._getRelatedAxis=function(t){if(U(t))return this._option.getComponentByIndex(this.specKey,t)},i.prototype._computeLayoutRadius=function(){var t=this;return cU((function(){return t._spec.layoutRadius}),this.getRefLayoutRect,this.getCenter,(function(){return{startAngle:t._startAngle,endAngle:t._endAngle}}))},i.prototype.computeLayoutOuterRadius=function(){var t,e=null!==(t=this._spec.outerRadius)&&void 0!==t?t:this._spec.radius,i=null!=e?e:this.getRefSeriesRadius().outerRadius;return this._computeLayoutRadius()*i},i.prototype.computeLayoutInnerRadius=function(){var t,e=null!==(t=this._spec.innerRadius)&&void 0!==t?t:this.getRefSeriesRadius().innerRadius;return this._computeLayoutRadius()*e},i.prototype.getRefSeriesRadius=function(){var t=uU,e=0,i=this.getChart().getSpec();return iF(this.getRegions(),(function(n){var r=n;if(aj(r.type)){var a=r.outerRadius,o=void 0===a?i.outerRadius:a,s=r.innerRadius,l=void 0===s?i.innerRadius:s;et(o)&&(t=o),et(l)&&(e=l)}}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),{outerRadius:t,innerRadius:e}},i.prototype._update=function(t){var e=t.grid,i=w(t,["grid"]);(this._axisMark.getComponent().setAttributes(XF({},this._axisStyle,i)),this._gridMark)&&this._gridMark.getComponent().setAttributes(XF({},this._gridStyle,e))},i.prototype.invert=function(t){var e;if("angle"===this.getOrient()&&"band"===this._scale.type){var i=this._scale.range(),n=i[i.length-1]-i[0],r=.5===(null!==(e=this.getSpec().bandPosition)&&void 0!==e?e:this._defaultBandPosition)?0:this._scale.bandwidth()/2;if(i[0]<0){var a=(t+r+Math.abs(i[0]))%n-Math.abs(i[0]);return this._scale.invert(a)}return this._scale.invert((t+r)%n)}return this._scale.invert(t)},i.type=I.polarAxis,i.specKey="axes",i}(xU),gK={grid:{smooth:!0,visible:!0},subGrid:{smooth:!0,visible:!1}},yK={grid:{visible:!0,style:{lineDash:[6,6]}},label:{space:5}},mK=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=I.polarLinearAxis,e._zero=!0,e._nice=!0,e._extend={},e._scale=new UL,e}return M(e,t),e.prototype.setAttrFromSpec=function(){t.prototype.setAttrFromSpec.call(this),this.setExtraAttrFromSpec()},e.prototype.initScales=function(){t.prototype.initScales.call(this),this.setScaleNice()},e.prototype.computeDomain=function(t){return this.computeLinearDomain(t)},e.prototype.axisHelper=function(){var e=t.prototype.axisHelper.call(this);return e.setExtendDomain=this.setExtendDomain.bind(this),e},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return kH(this._option.dataSet,t,tI),t},e.type=I.polarLinearAxis,e.specKey="axes",e.builtInTheme={axis:zU,axisLinear:DU,axisAngle:yK,axisRadius:gK},e}(vK);kt(mK,IU);var _K=function(){KF.registerGraphicComponent(pU.lineAxis,(function(t,e){return new zR(t,e)})),KF.registerGraphicComponent(fU.lineAxisGrid,(function(t,e){return new $I(t,e)})),KF.registerGraphicComponent(pU.circleAxis,(function(t,e){return new WR(t,e)})),KF.registerGraphicComponent(fU.circleAxisGrid,(function(t,e){return new eD(t,e)})),kU(),KF.registerComponent(mK.type,mK)},bK=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=I.polarBandAxis,e._scale=new kL,e}return M(e,t),e.prototype.computeDomain=function(t){return this.computeBandDomain(t)},e.prototype.updateScaleRange=function(){var e=t.prototype.updateScaleRange.call(this);return this.updateGroupScaleRange(),e},e.prototype.axisHelper=function(){var e=t.prototype.axisHelper.call(this);return T(T({},e),{getBandwidth:function(t){return e.getScale(t).bandwidth()}})},e.prototype.initScales=function(){t.prototype.initScales.call(this),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return kH(this._option.dataSet,t,lI),t},e.prototype.transformScaleDomain=function(){},e.type=I.polarBandAxis,e.specKey="axes",e.builtInTheme={axis:zU,axisBand:jU,axisAngle:yK,axisRadius:gK},e}(vK);kt(bK,VU);var xK=function(){KF.registerGraphicComponent(pU.lineAxis,(function(t,e){return new zR(t,e)})),KF.registerGraphicComponent(fU.lineAxisGrid,(function(t,e){return new $I(t,e)})),KF.registerGraphicComponent(pU.circleAxis,(function(t,e){return new WR(t,e)})),KF.registerGraphicComponent(fU.circleAxisGrid,(function(t,e){return new eD(t,e)})),kU(),KF.registerComponent(bK.type,bK)},kK={rose:{style:{fillOpacity:1}},label:{style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"},textAlign:"center",textBaseline:"middle"}}},SK=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.rose,i.transformerConstructor=fK,i._roseMark=null,i._labelMark=null,i}return M(i,e),i.prototype.initMark=function(){this.initRoseMark()},i.prototype.initMarkStyle=function(){this.initRoseMarkStyle()},i.prototype._buildMarkAttributeContext=function(){var t=this;e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.getCenter=function(){return{x:function(){return t.angleAxisHelper.center().x},y:function(){return t.angleAxisHelper.center().y}}},this._markAttributeContext.startAngleScale=function(e){return t.startAngleScale(e)},this._markAttributeContext.endAngleScale=function(e){return t.endAngleScale(e)}},i.prototype.initRoseMark=function(){this._roseMark=this._createMark(i.mark.rose,{groupKey:this._seriesField,isSeriesMark:!0},{morph:$V(this._spec,i.mark.rose.name),morphElementKey:this.getDimensionField()[0]})},i.prototype.getRoseAngle=function(){var t,e,i;return null!==(i=null===(e=(t=this.angleAxisHelper).getBandwidth)||void 0===e?void 0:e.call(t,this._groups?this._groups.fields.length-1:0))&&void 0!==i?i:.5},i.prototype.startAngleScale=function(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)},i.prototype.endAngleScale=function(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))+this.getRoseAngle()-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)},i.prototype.initRoseMarkStyle=function(){var t=this,e=this._roseMark;e&&this.setMarkStyle(e,{x:function(){return t.angleAxisHelper.center().x},y:function(){return t.angleAxisHelper.center().y},startAngle:function(e){return t.startAngleScale(e)},endAngle:function(e){return t.endAngleScale(e)},fill:this.getColorAttribute(),outerRadius:function(e){return MF(t.radiusAxisHelper.dataToPosition([e[t._radiusField[0]]]),t.radiusAxisHelper.getScale(0))},innerRadius:function(e){var i;if(!t.getStack())return 0;var n=MF(t.radiusAxisHelper.dataToPosition([e[t._innerRadiusField[0]]]),t.radiusAxisHelper.getScale(0));return n<=Number.MIN_VALUE?t._computeLayoutRadius()*(null!==(i=t._spec.innerRadius)&&void 0!==i?i:0):n}})},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._roseMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._roseMark)},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{text:function(t){return t[e.getDimensionField()[0]]},fill:this.getColorAttribute(),z:0})},i.prototype.initAnimation=function(){var t,e,i,n=this,r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;if(this._roseMark){var a={innerRadius:function(){var t;return n._computeLayoutRadius()*(null!==(t=n._spec.innerRadius)&&void 0!==t?t:0)}};this._roseMark.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("rose"))||void 0===i?void 0:i(a,r),ZV("rose",this._spec,this._markAttributeContext)))}},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[this._roseMark]},i.type=t.SeriesTypeEnum.rose,i.mark=pK,i.builtInTheme={rose:kK},i.transformerConstructor=fK,i}(dK),AK=function(){KF.registerSeries(SK.type,SK),ZX(),KF.registerAnimation("rose",(function(t,e){return{appear:cK(t,e),enter:sK(t),exit:lK(t),disappear:uK(t)}})),xK(),_K()},MK=function(t){function e(e,i,n,r,a){var o=t.call(this,e,i,n,r,a)||this;return o._center=i.center,o}return M(e,t),e.prototype.getEndProps=function(){return!1===this.valid?{}:Ve(this._center,this._toRadius,this._toAngle)},e.prototype.onBind=function(){this.from=this.target.attribute,this.to=this.target.getFinalAttribute(),this._prevCenter=this.target.attribute.center,this._center&&this._prevCenter||(this.valid=!1);var t=je(this.from,this._prevCenter),e=t.angle,i=t.radius,n=je(this.to,this._center),r=n.angle,a=n.radius;et(r*a)||(this.valid=!1),this._fromAngle=et(e)?e:r,this._fromRadius=et(i)?i:a,this._toAngle=r,this._toRadius=a,XO(this._fromAngle,this._toAngle)&&XO(this._fromRadius,this._toRadius)&&(this.valid=!1),this.props=this.getEndProps()},e.prototype.onUpdate=function(t,e,i){if(!1===this.valid)return i.x=this.to.x,void(i.y=this.to.y);var n=Ve({x:this._prevCenter.x+(this._center.x-this._prevCenter.x)*e,y:this._prevCenter.y+(this._center.y-this._prevCenter.y)*e},this._fromRadius+(this._toRadius-this._fromRadius)*e,this._fromAngle+(this._toAngle-this._fromAngle)*e),r=n.x,a=n.y;this.target.setAttributes({x:r,y:a}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()},e}(zP),TK=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.onBind=function(){t.prototype.onBind.call(this);var e=this.target.attribute.center,i=this.target.getFinalAttribute().center;this._center=i,this._prevCenter=e},e.prototype.onUpdate=function(t,e,i){var n=this;this.points=this.points.map((function(r,a){var o=n.polarPointInterpolation(n.interpolatePoints[a][0],n.interpolatePoints[a][1],e);return t&&(i.center=n._center),o.context=r.context,o})),this.target.attribute.points=this.points,this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()},e.prototype._interpolationSinglePoint=function(t,e,i){if(!eF(t)&&!eF(e))return e;var n=je(t,this._prevCenter),r=je(e,this._center),a=We(n.angle),o=We(r.angle);!et(a)&&et(o)&&(a=o),et(a)&&!et(o)&&(o=a);var s=a+(o-a)*i,l=n.radius+(r.radius-n.radius)*i;return Ve({x:this._prevCenter.x+(this._center.x-this._prevCenter.x)*i,y:this._prevCenter.y+(this._center.y-this._prevCenter.y)*i},l,s)},e.prototype.polarPointInterpolation=function(t,e,i){var n=this._interpolationSinglePoint(t,e,i),r=n.x,a=n.y,o=this._interpolationSinglePoint({x:t.x1,y:t.y1},{x:e.x1,y:e.y1},i),s=o.x,l=o.y,u=new De(r,a,s,l);return u.defined=e.defined,u},e}(uB),wK=function(t){return{type:"in"===t?"fadeIn":"fadeOut"}};function CK(t,e,i){return"fadeIn"===e?wK(i):function(t,e){return{type:"in"===e?"growPointsIn":"growPointsOut",options:function(){return{center:t.center()}}}}(t,i)}function EK(t,e,i){return"fadeIn"===e?wK(i):function(t,e){var i=function(){var e;return null===(e=t.center())||void 0===e?void 0:e.x},n=function(t,e){return e.getGraphicAttribute("x")},r=function(){var e;return null===(e=t.center())||void 0===e?void 0:e.y},a=function(t,e){return e.getGraphicAttribute("y")};return"in"===e?{channel:{x:{from:i,to:n},y:{from:r,to:a}}}:{channel:{x:{from:n,to:i},y:{from:a,to:r}}}}(t,i)}var PK,BK=function(t,e){return{custom:sB,customParameters:function(i,n){var r;return{group:n,startAngle:null!==(r=t.startAngle)&&void 0!==r?r:Math.PI/2,orient:"clockwise",center:t.center(),radius:t.radius(),animationType:e}}}},RK=T(T(T({},VV),Mj),((PK={}).area={name:"area",type:"area"},PK)),LK={label:{visible:!1,offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}},IK=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.radar,i.transformerConstructor=Dj,i._sortDataByAxis=!1,i}return M(i,e),i.prototype.initGroups=function(){},i.prototype.compile=function(){e.prototype.compile.call(this),this.addOverlapCompile()},i.prototype.initMark=function(){var t,e,i,n,r=!1!==(null===(t=this._spec.area)||void 0===t?void 0:t.visible)&&!1!==(null===(i=null===(e=this._spec.area)||void 0===e?void 0:e.style)||void 0===i?void 0:i.visible),a=null!==(n=this._spec.seriesMark)&&void 0!==n?n:"area";this.initAreaMark(r&&"area"===a),this.initLineMark("line"===a||"area"===a&&!r),this.initSymbolMark("point"===a)},i.prototype.initMarkStyle=function(){var t=this;this.initAreaMarkStyle(),this.initLineMarkStyle(),this.initSymbolMarkStyle(),[this._lineMark,this._symbolMark,this._areaMark].forEach((function(e){e&&t.setMarkStyle(e,{center:function(){var e;return null===(e=t.angleAxisHelper)||void 0===e?void 0:e.center()}})}))},i.prototype.initAreaMark=function(t){this._areaMark=this._createMark(i.mark.area,{groupKey:this._seriesField,isSeriesMark:t})},i.prototype.initAreaMarkStyle=function(){var e=this,i=this._areaMark;i&&(this.setMarkStyle(i,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),x1:function(t){return t&&e.angleAxisHelper&&e.radiusAxisHelper?e.valueToPosition(e.getDatumPositionValues(t,e._angleField),e.getStack()?e.getDatumPositionValues(t,e._innerRadiusField):e.radiusScale.domain()[0]).x:Number.NaN},y1:function(t){return t&&e.angleAxisHelper&&e.radiusAxisHelper?e.valueToPosition(e.getDatumPositionValues(t,e._angleField),e.getStack()?e.getDatumPositionValues(t,e._innerRadiusField):e.radiusScale.domain()[0]).y:Number.NaN},fill:this.getColorAttribute(),curveType:vV,closePath:!0},"normal",t.AttributeLevel.Series),"zero"!==this._invalidType&&this.setMarkStyle(i,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",t.AttributeLevel.Series),this.event.on(t.ChartEvent.viewDataStatisticsUpdate,{filter:function(t){return t.model===e}},(function(){e.encodeDefined(i,"defined")})))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this);var t=this._tooltipHelper.activeTriggerSet,i=t.group,n=t.mark;this._lineMark&&i.add(this._lineMark),this._areaMark&&i.add(this._areaMark),this._symbolMark&&(n.add(this._symbolMark),i.add(this._symbolMark))},i.prototype.initAnimation=function(){var t,e,i,n,r=this,a={center:function(){var t;return null===(t=r.angleAxisHelper)||void 0===t?void 0:t.center()},radius:function(){var t=r.getLayoutRect();return Math.min(t.width,t.height)},startAngle:U(this._spec.startAngle)?Fe(this._spec.startAngle):sU},o=null!==(i=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset)&&void 0!==i?i:"clipIn";"clipIn"===o&&this._rootMark&&this._rootMark.setAnimationConfig(qV(null===(n=KF.getAnimationInKey("radarGroup"))||void 0===n?void 0:n(a,o),ZV("group",this._spec,this._markAttributeContext))),[[this._areaMark,"radar"],[this._lineMark,"radar"],[this._symbolMark,"radarSymbol"]].forEach((function(t){var e=B(t,2),i=e[0],n=e[1];if(U(i)){var s=KF.getAnimationInKey(n);i.setAnimationConfig(qV(null==s?void 0:s(a,o),ZV(i.name,r._spec,r._markAttributeContext)))}}))},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._areaMark,this._symbolMark,this._lineMark]},i.prototype.getSeriesStyle=function(t){var e=this;return function(i){var n,r,a,o,s=null!==(r=null===(n=e._seriesMark)||void 0===n?void 0:n.getAttribute(i,t))&&void 0!==r?r:void 0;return"fill"!==i||s||(i="stroke",s=null!==(o=null===(a=e._seriesMark)||void 0===a?void 0:a.getAttribute(i,t))&&void 0!==o?o:void 0),"stroke"===i&&q(s)?s[0]:s}},i.type=t.SeriesTypeEnum.radar,i.mark=RK,i.builtInTheme={radar:LK},i.transformerConstructor=Dj,i}(dK);kt(IK,Tj);var DK,OK,FK,zK,HK=function(){KF.registerSeries(IK.type,IK),oG(),Rj(),Ij(),KF.registerAnimation("radar",(function(t,e){return{appear:"clipIn"===e?void 0:CK(t,e,"in"),enter:CK(t,e,"in"),exit:CK(t,e,"out"),disappear:"clipIn"===e?void 0:CK(t,e,"out"),update:[{channel:["points","center"],custom:TK,customParameters:t,duration:UN.update.duration,easing:UN.update.easing},{type:"update",options:{excludeChannels:["points","defined","center"]}}]}})),KF.registerAnimation("radarSymbol",(function(t,e){return{appear:"clipIn"===e?void 0:EK(t,e,"in"),enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:"clipIn"===e?void 0:EK(t,e,"out"),update:[{options:{excludeChannels:["x","y","center"]}},{channel:["x","y","center"],custom:MK,customParameters:t,duration:UN.update.duration,easing:UN.update.easing}]}})),KF.registerAnimation("radarGroup",(function(t,e){return{appear:BK(t,"in"),disappear:BK(t,"out")}})),Nw(),xK(),_K()},NK=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shapeTypeCallback=function(){return"square"},e}return M(e,t),e.prototype.enableByType=function(t){return"mark"===t},e.prototype.getDefaultTitlePattern=function(t){return{key:"event info",value:"event info"}},e.prototype.getDefaultContentList=function(){return[{key:function(t){return t.type},value:function(t){return t.id}},{key:"event_time",value:function(t){return Xi.getInstance().timeFormat("%Y%m%d",t.event_time)}},{key:"action_type",value:function(t){return t.action_type}},{key:"children",value:function(t){return t.children}}]},e.prototype.getTooltipData=function(e,i,n,r,a){var o,s,l,u,c=t.prototype.getTooltipData.call(this,e,i,n,r,a),h=null!==(l=null===(s=null===(o=this.spec)||void 0===o?void 0:o[e])||void 0===s?void 0:s.updateContent)&&void 0!==l?l:null===(u=null==i?void 0:i[e])||void 0===u?void 0:u.updateContent;return c&&!h&&(c.updateContent=function(t,e,i){var n=[],r=t.filter((function(t){return"children"===t.key}));return r.length>0&&r[0].value.forEach((function(t){var e=!0;for(var i in t)n.push(T(T({},r[0]),{shapeType:"circle",hasShape:e,key:i,value:t[i]+""})),e=!1})),t.concat(n)}),c},e}(EV),VK=function(t,e){var i,n=(null===(i=t[0])||void 0===i?void 0:i.latestData)?t[0].latestData:t||[],r=[],a=0;return n.forEach((function(t){var i,n={};for(var o in t)o===e||o.startsWith(mz)||(n[o]=t[o],i=U(i)?"".concat(i,"_").concat(t[o]):"".concat(t[o]));var s=t[e];null==s||s.forEach((function(t,e){var o;r.push(Object.assign({},n,t,((o={})[kz]=a,o[Sz]="".concat(i,"_").concat(e),o))),a++}))})),r},jK={fill:"#bbb",fillOpacity:.2},UK=T(T({},VV),((DK={}).group={name:"group",type:"group"},DK.grid={name:"grid",type:"rule"},DK.gridBackground={name:"gridBackground",type:"rect"},DK.dot={name:"dot",type:"symbol"},DK.title={name:"title",type:"text"},DK.subTitle={name:"subTitle",type:"text"},DK.symbol={name:"symbol",type:"symbol"},DK)),WK={dot:{style:{size:10,fillOpacity:1}},symbol:{style:{size:10}},title:{style:{textAlign:"left",textBaseline:"middle",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},subTitle:{style:{textAlign:"left",textBaseline:"top",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},GK=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.dot,i}return M(i,e),i.prototype.getSeriesGroupField=function(){return this._seriesField},i.prototype.setSeriesGroupField=function(t){U(t)&&(this._seriesGroupField=t)},i.prototype.getTitleField=function(){return this._titleField},i.prototype.setTitleField=function(t){U(t)&&(this._titleField=t)},i.prototype.getSubTitleField=function(){return this._subTitleField},i.prototype.setSubTitleField=function(t){U(t)&&(this._subTitleField=t)},i.prototype.getDotTypeField=function(){return this._dotTypeField},i.prototype.setDotTypeField=function(t){U(t)&&(this._dotTypeField=t)},i.prototype.getHighLightSeriesGroup=function(){return this._highLightSeriesGroup},i.prototype.setHighLightSeriesGroup=function(t){U(t)&&(this._highLightSeriesGroup=t)},i.prototype.setGridBackground=function(t){U(t)&&(this._gridBackground=t)},i.prototype.initData=function(){var i,n=this;e.prototype.initData.call(this),this._xDimensionStatisticsDomain=this.getRawData().latestData.map((function(t){return t[n._fieldY[0]]})),kH(this._option.dataSet,"objFlat",VK),kH(this._option.dataSet,"copyDataView",IH),SH(this._option.dataSet,"dataview",ss),null===(i=this.getViewData())||void 0===i||i.transform({type:"objFlat",options:"dots",level:t.TransformLevel.dotObjFlat},!1)},i.prototype.getStatisticFields=function(){return[{key:this._fieldY[0],operations:["values"],customize:this._xDimensionStatisticsDomain}]},i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this.setSeriesGroupField(this._spec.seriesGroupField),this.setTitleField(this._spec.titleField),this.setSubTitleField(this._spec.subTitleField),this.setDotTypeField(this._spec.dotTypeField),this.setHighLightSeriesGroup(this._spec.highLightSeriesGroup),this.setGridBackground(XF(jK,(null===(t=this._spec.grid)||void 0===t?void 0:t.background)||{}))},i.prototype.initMark=function(){this._clipMark=this._createMark(i.mark.group),this._containerMark=this._createMark(i.mark.group,{parent:this._clipMark,dataView:this.getRawData()}),this._gridBackgroundMark=this._createMark(i.mark.gridBackground,{parent:this._containerMark,dataView:this.getRawData()}),this._gridMark=this._createMark(i.mark.grid,{parent:this._containerMark,dataView:this.getRawData()}),this._dotMark=this._createMark(i.mark.dot,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark}),this._titleMark=this._createMark(i.mark.title,{parent:this._containerMark,dataView:this.getRawData()}),this._subTitleMark=this._createMark(i.mark.subTitle,{parent:this._containerMark,dataView:this.getRawData()}),this._symbolMark=this._createMark(i.mark.symbol,{parent:this._containerMark,dataView:this.getRawData()})},i.prototype.initMarkStyle=function(){var e=this,i=this._clipMark;i&&(this.setMarkStyle(i,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight},"normal",t.AttributeLevel.Series),i.setMarkConfig({interactive:!1,clip:!0}));var n=this._containerMark;n&&(this.setMarkStyle(n,{x:this._spec.leftAppendPadding},"normal",t.AttributeLevel.Series),n.setMarkConfig({interactive:!1}));var r=this._gridBackgroundMark;r&&this.setMarkStyle(r,{x:this.getRegionRectLeft.bind(this),x1:this.getRegionRectRight.bind(this),y:this.dataToGridBackgroundPositionY.bind(this),y1:this.dataToGridBackgroundPositionY1.bind(this),fill:this._gridBackground.fill,fillOpacity:this.dataToGridBackgroundOpacity.bind(this)},"normal",t.AttributeLevel.Series);var a=this._gridMark;a&&this.setMarkStyle(a,{stroke:this.getColorAttribute(),x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),x1:this.getRegionRectRight.bind(this),y1:this.dataToPositionY.bind(this)},"normal",t.AttributeLevel.Series);var o=this._dotMark;o&&this.setMarkStyle(o,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),fill:this.getDotColorAttribute(),stroke:this.getDotColorAttribute(),fillOpacity:this.dataToOpacity.bind(this)},"normal",t.AttributeLevel.Series);var s=this._titleMark;s&&this.setMarkStyle(s,{fill:this.getColorAttribute(),text:function(t){return t[e.getTitleField()]},x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",t.AttributeLevel.Series);var l=this._subTitleMark;l&&this.setMarkStyle(l,{fill:this.getColorAttribute(),text:function(t){return t[e.getSubTitleField()]},x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",t.AttributeLevel.Series);var u=this._symbolMark;u&&this.setMarkStyle(u,{x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series)},i.prototype.dataToGridBackgroundPositionY=function(t){if(!this._yAxisHelper)return Number.NaN;var e=this._yAxisHelper,i=e.dataToPosition,n=e.getBandwidth;return i(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})-n(0)/2},i.prototype.dataToGridBackgroundPositionY1=function(t){if(!this._yAxisHelper)return Number.NaN;var e=this._yAxisHelper,i=e.dataToPosition,n=e.getBandwidth;return i(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})+n(0)/2},i.prototype.dataToOpacity=function(t){var e,i,n,r;if(!this._xAxisHelper)return Number.NaN;var a=this._xAxisHelper,o=a.dataToPosition,s=a.getScale;return o(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})<s(0).range()[0]||o(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})>s(0).range()[1]?0:null!==(r=null===(n=null===(i=null===(e=this._theme)||void 0===e?void 0:e.dot)||void 0===i?void 0:i.style)||void 0===n?void 0:n.fillOpacity)&&void 0!==r?r:1},i.prototype.dataToGridBackgroundOpacity=function(t){return t[this._seriesGroupField]===this._highLightSeriesGroup?this._gridBackground.fillOpacity:0},i.prototype.onLayoutEnd=function(){var i,n;e.prototype.onLayoutEnd.call(this);var r=null!==(n=null===(i=this._spec)||void 0===i?void 0:i.leftAppendPadding)&&void 0!==n?n:0;this.setMarkStyle(this._clipMark,{width:this.getLayoutRect().width+r},"normal",t.AttributeLevel.Series)},i.prototype.getDefaultColorDomain=function(){var t,e;return this._seriesGroupField?null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._seriesGroupField].values:this._seriesField?null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData[this._seriesField].values:[]},i.prototype.getColorAttribute=function(){var t,e,i;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:null!==(i=null!==(e=this._seriesGroupField)&&void 0!==e?e:this._seriesField)&&void 0!==i?i:Az}},i.prototype.getDotColorScale=function(){var t,e,i,n=this._dotTypeField?null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._dotTypeField].values:this._seriesGroupField?null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData[this._seriesGroupField].values:this._seriesField?null===(i=this.getViewDataStatistics())||void 0===i?void 0:i.latestData[this._seriesField].values:[],r=this._getDataScheme();return(new xF).domain(n).range(r)},i.prototype.getDotColorAttribute=function(){var t,e,i,n;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this.getDotColorScale(),field:null!==(n=null!==(i=null!==(e=this._dotTypeField)&&void 0!==e?e:this._seriesGroupField)&&void 0!==i?i:this._seriesField)&&void 0!==n?n:Az}},i.prototype.initTooltip=function(){this._tooltipHelper=new NK(this),this._dotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._dotMark)},i.prototype.onEvaluateEnd=function(t){e.prototype.onEvaluateEnd.call(this,t)},i.prototype.onMarkTreePositionUpdate=function(t){t.forEach((function(t){t.commit(!1,!0)}))},i.prototype.getDotData=function(){var t;return null===(t=this._dotMark)||void 0===t?void 0:t.getData()},i.prototype._getDataIdKey=function(){},i.prototype.getStackValueField=function(){return null},i.prototype.getActiveMarks=function(){return[this._dotMark]},i.type=t.SeriesTypeEnum.dot,i.mark=UK,i.builtInTheme={dot:WK},i}(lj),YK=function(){Ij(),CY(),MG(),mX(),KF.registerSeries(GK.type,GK)},XK=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shapeTypeCallback=function(){return"square"},e}return M(e,t),e.prototype.enableByType=function(t){return"mark"===t},e.prototype.getDefaultTitlePattern=function(t){return{key:"link info",value:"link info"}},e.prototype.getDefaultContentList=function(){return[{key:"time",value:function(t){return Xi.getInstance().timeFormat("%Y%m%d %H:%M",t.from.split("_")[1])}},{key:"type",value:function(t){return t.action_type}},{key:"from",value:function(t){return t.from}},{key:"to",value:function(t){return t.to}}]},e}(EV),KK=T(T({},VV),((OK={}).group={name:"group",type:"group"},OK.link={name:"link",type:"rule"},OK.arrow={name:"arrow",type:"symbol"},OK)),qK=function(t,e){var i=e.infoKey,n=e.fields,r=e.linkData,a=e.dotData,o=n(),s=o.fromField,l=o.toField,u=o.xField,c=o.yField,h=r(),d=a(),p={};return d.forEach((function(t){var e={};for(var n in t)n!==i&&(e[n]=t[n]);var r=t[i];null==r||r.forEach((function(t){p[t.node_name]=Object.assign({},e,t)}))})),h.forEach((function(t){var e,i,n,r;t[s+"_xField"]=null===(e=null==p?void 0:p[t[s]])||void 0===e?void 0:e[u],t[s+"_yField"]=null===(i=null==p?void 0:p[t[s]])||void 0===i?void 0:i[c],t[l+"_xField"]=null===(n=null==p?void 0:p[t[l]])||void 0===n?void 0:n[u],t[l+"_yField"]=null===(r=null==p?void 0:p[t[l]])||void 0===r?void 0:r[c]})),h},ZK={arrow:{style:{size:10}}},JK=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.link,i}return M(i,e),i.prototype.getFromField=function(){return this._fromField},i.prototype.setFromField=function(t){U(t)&&(this._fromField=t)},i.prototype.getToField=function(){return this._toField},i.prototype.setToField=function(t){U(t)&&(this._toField=t)},i.prototype.getDotTypeField=function(){return this._dotTypeField},i.prototype.setDotTypeField=function(t){U(t)&&(this._dotTypeField=t)},i.prototype.getDotSeriesSpec=function(){return this._dotSeriesSpec},i.prototype.setDotSeriesSpec=function(t){U(t)&&(this._dotSeriesSpec=t)},i.prototype._getDotData=function(){var t=this._option.getChart().getSeriesInIndex([this._spec.dotSeriesIndex])[0];return t?t.getRawData().latestData:[]},i.prototype.initData=function(){var i,n=this;e.prototype.initData.call(this),kH(this._option.dataSet,"linkDotInfo",qK),null===(i=this.getViewData())||void 0===i||i.transform({type:"linkDotInfo",options:{infoKey:"dots",fields:function(){return{fromField:n._fromField,toField:n._toField,xField:n._dotSeriesSpec.xField,yField:n._dotSeriesSpec.yField}},linkData:function(){return n._rawData.latestData},dotData:function(){return n._getDotData()}},level:t.TransformLevel.linkDotInfo},!1)},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setFromField(this._spec.fromField),this.setToField(this._spec.toField),this.setDotTypeField(this._spec.dotTypeField),this.setDotSeriesSpec(this._spec.dotSeriesSpec)},i.prototype.initMark=function(){this._clipMark=this._createMark(i.mark.group),this._containerMark=this._createMark(i.mark.group,{parent:this._clipMark}),this._linkMark=this._createMark(i.mark.link,{skipBeforeLayouted:!1,parent:this._containerMark}),this._arrowMark=this._createMark(i.mark.arrow,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark})},i.prototype.initMarkStyle=function(){var e,i,n,r,a=this,o=this._clipMark;o&&(this.setMarkStyle(o,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight},"normal",t.AttributeLevel.Series),o.setMarkConfig({interactive:!1,clip:!0}));var s=this._containerMark;s&&(this.setMarkStyle(s,{x:this._spec.leftAppendPadding,width:this.getLayoutRect().width},"normal",t.AttributeLevel.Series),s.setMarkConfig({interactive:!1}));var l=this._linkMark;l&&this.setMarkStyle(l,{stroke:this.getColorAttribute(),strokeOpacity:this.dataToOpacity.bind(this),x:this.dataToPositionXFrom.bind(this),y:this.dataToPositionYFrom.bind(this),x1:this.dataToPositionXTo.bind(this),y1:this.dataToPositionYTo.bind(this)},"normal",t.AttributeLevel.Series);var u=this._arrowMark;if(u){var c=null!==(r=null===(n=null===(i=null===(e=this._theme)||void 0===e?void 0:e.arrow)||void 0===i?void 0:i.style)||void 0===n?void 0:n.size)&&void 0!==r?r:10;this.setMarkStyle(u,{x:this.dataToPositionXTo.bind(this),y:function(t){return a.dataToPositionArrowYTo(t,c)},fill:this.getColorAttribute(),fillOpacity:this.dataToOpacity.bind(this),size:c,symbolType:function(t){return a.isPositionYFromHigher(t)?"triangleDown":"triangleUp"}},"normal",t.AttributeLevel.Series)}},i.prototype.afterInitMark=function(){e.prototype.afterInitMark.call(this)},i.prototype.dataToPositionXFrom=function(t){return this._xAxisHelper?(0,this._xAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._fromField+"_xField"),{bandPosition:this._bandPosition}):Number.NaN},i.prototype.dataToPositionYFrom=function(t){return this._yAxisHelper?(0,this._yAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._fromField+"_yField")):Number.NaN},i.prototype.dataToPositionXTo=function(t){return this._xAxisHelper?(0,this._xAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._toField+"_xField"),{bandPosition:this._bandPosition}):Number.NaN},i.prototype.dataToPositionYTo=function(t){return this._yAxisHelper?(0,this._yAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition}):Number.NaN},i.prototype.dataToPositionArrowYTo=function(t,e){if(!this._yAxisHelper)return Number.NaN;var i=this._yAxisHelper.dataToPosition,n=this.isPositionYFromHigher(t)?-e/2:e/2;return i(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition})+n},i.prototype.dataToOpacity=function(t){return this.isPositionXOuterRange(t,this._fromField+"_xField")||this.isPositionXOuterRange(t,this._toField+"_xField")||t[this._fromField]===t[this._toField]?0:1},i.prototype.isPositionYFromHigher=function(t){return this.dataToPositionYFrom(t)<this.dataToPositionYTo(t)},i.prototype.isPositionXOuterRange=function(t,e){if(!this._xAxisHelper)return!1;var i=this._xAxisHelper,n=i.dataToPosition,r=i.getScale;return n(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})<r(0).range()[0]||n(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})>r(0).range()[1]},i.prototype.getDefaultColorDomain=function(){var t,e;return this._dotTypeField?null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._dotTypeField].values:this._seriesField?null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData[this._seriesField].values:[]},i.prototype.getColorAttribute=function(){var t,e,i;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:null!==(i=null!==(e=this._dotTypeField)&&void 0!==e?e:this._seriesField)&&void 0!==i?i:Az}},i.prototype.getInteractionTriggers=function(){var t=[];return this._linkMark&&t.push(this._linkMark),this._arrowMark&&t.push(this._arrowMark),this._parseInteractionConfig(t)},i.prototype.initTooltip=function(){this._tooltipHelper=new XK(this),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark),this._arrowMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._arrowMark)},i.prototype.onMarkTreePositionUpdate=function(t){t.forEach((function(t){t.commit(!1,!0)}))},i.prototype.getDotInfoData=function(){var t,e;return null===(e=null!==(t=this._linkMark)&&void 0!==t?t:this._arrowMark)||void 0===e?void 0:e.getData()},i.prototype.getActiveMarks=function(){return[this._linkMark,this._arrowMark]},i.type=t.SeriesTypeEnum.link,i.mark=KK,i.builtInTheme={link:ZK},i}(lj),QK=function(){CY(),Ij(),WU(),NU(),KF.registerSeries(JK.type,JK)},$K=T(T({},VV),((FK={}).group={name:"group",type:"group"},FK)),tq=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._arcGroupMark=null,t._getAngleValueStart=function(e){var i=t._getAngleAxis(),n=t._spec.tickMask;if((null==n?void 0:n.forceAlign)&&t._isTickMaskVisible(i)){var r=e[t.getStack()?wz:Vz],a=t._getAngleAxisSubTickData(i),o=a[1].value-a[0].value,s=Fe(n.offsetAngle),l=void 0;if(U(r)){var u=zt(a,(function(t){return t.value-r})),c=u>=a.length||r>a[u].value-o/2?Math.min(u,a.length-1):u>0?u-1:void 0;void 0!==c&&(l=t.angleAxisHelper.dataToPosition([a[c].value-o/2]))}return j(l)&&(l=t.angleAxisHelper.dataToPosition([a[0].value-o/2])),l+s}return t._getAngleValueStartWithoutMask(e)},t._getAngleValueEnd=function(e){var i=t._getAngleAxis(),n=t._spec.tickMask;if((null==n?void 0:n.forceAlign)&&t._isTickMaskVisible(i)){var r=e[t.getStack()?Cz:t._angleField[0]],a=t._getAngleAxisSubTickData(i),o=a[1].value-a[0].value,s=Fe(n.offsetAngle),l=zt(a,(function(t){return t.value-r})),u=l>=a.length||r>a[l].value-o/2?Math.min(l,a.length-1):l>0?l-1:void 0;return(void 0!==u?t.angleAxisHelper.dataToPosition([a[u].value+o/2]):t.angleAxisHelper.dataToPosition([a[0].value-o/2]))+s}return t._getAngleValueEndWithoutMask(e)},t}return M(i,e),i.prototype.setAttrFromSpec=function(){var t,i,n;e.prototype.setAttrFromSpec.call(this);var r=null===(t=this._option.globalInstance.getChart())||void 0===t?void 0:t.getSpec(),a=null!==(i=this._spec.startAngle)&&void 0!==i?i:null==r?void 0:r.startAngle;this._startAngle=U(a)?Fe(a):sU;var o=null!==(n=this._spec.endAngle)&&void 0!==n?n:null==r?void 0:r.endAngle;this._endAngle=U(o)?Fe(o):lU,this.setAngleField(this._spec.valueField||this._spec.angleField),this.setRadiusField(this._spec.categoryField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice()},i.prototype.getStackGroupFields=function(){return this._radiusField},i.prototype.getStackValueField=function(){var t;return null===(t=this._angleField)||void 0===t?void 0:t[0]},i.prototype.getGroupFields=function(){return this._angleField},i.prototype._convertMarkStyle=function(t){var i=e.prototype._convertMarkStyle.call(this,t),n="fill";if(i[n]){var r=t[n];"conical"!==(null==r?void 0:r.gradient)||U(null==r?void 0:r.startAngle)||U(null==r?void 0:r.endAngle)||(i[n]=T(T({},r),{startAngle:this._startAngle,endAngle:this._endAngle}))}return i},i.prototype._getAngleValueStartWithoutMask=function(t){if(this.getStack()){var e=MF(this.angleAxisHelper.dataToPosition([t[wz]]),this.angleAxisHelper.getScale(0));if(et(e))return e}return this._startAngle},i.prototype._getAngleValueEndWithoutMask=function(t){if(this.getStack()){var e=MF(this.angleAxisHelper.dataToPosition([t[Cz]]),this.angleAxisHelper.getScale(0));if(et(e))return e}var i=this.angleAxisHelper.dataToPosition([t[this._angleField[0]]]);return this._spec.clamp?MF(i,this.angleAxisHelper.getScale(0)):i},i.prototype.getDimensionField=function(){return this._specRadiusField},i.prototype.getMeasureField=function(){return this._specAngleField},i.prototype.initMark=function(){this._initArcGroupMark()},i.prototype.initMarkStyle=function(){this._initArcGroupMarkStyle()},i.prototype._initArcGroupMark=function(){return this._arcGroupMark=this._createMark(i.mark.group,{skipBeforeLayouted:!1}),this._arcGroupMark},i.prototype._initArcGroupMarkStyle=function(){var e=this,i=this._arcGroupMark;i.created(),this.setMarkStyle(i,{x:0,y:0},"normal",t.AttributeLevel.Series),this._arcGroupMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex,clip:!0,clipPath:function(){var t=e._getAngleAxis(),i=e.angleAxisHelper.center(),n=i.x,r=i.y,a=e._computeLayoutRadius();if(e._isTickMaskVisible(t)){var o=e._spec.tickMask,s=o.angle,l=o.offsetAngle,u=o.style,c=void 0===u?{}:u,h=e._getAngleAxisSubTickData(t),d=c;return h.map((function(t){var i=t.value,o=e.angleAxisHelper.dataToPosition([i])+Fe(l),u=Fe(s)/2;return fg(T(T({},d),{x:n,y:r,startAngle:o-u,endAngle:o+u,innerRadius:a*e._innerRadius,outerRadius:a*e._outerRadius,fill:!0}))}))}var p=e.getLayoutRect();return[Wv({width:p.width,height:p.height,fill:!0})]}})},i.prototype._getAngleAxis=function(){if(this.angleAxisHelper){var t=this.angleAxisHelper.getAxisId();return this._option.getChart().getAllComponents().find((function(e){return e.id===t}))}},i.prototype._getAngleAxisTickData=function(t){var e;return null===(e=null==t?void 0:t.getTickData())||void 0===e?void 0:e.getLatestData()},i.prototype._isTickMaskVisible=function(t){var e=this._getAngleAxisTickData(t),i=this._spec.tickMask;return i&&!1!==i.visible&&(null==e?void 0:e.length)>1},i.prototype._getAngleAxisSubTickData=function(t){var e,i=this._getAngleAxisTickData(t),n=[],r=null!==(e=null==t?void 0:t.getSpec())&&void 0!==e?e:{},a=r.subTick,o=void 0===a?{}:a,s=r.tick,l=void 0===s?{}:s,u=o.tickCount,c=void 0===u?4:u,h=l.alignWithLabel;if((null==i?void 0:i.length)>=2){for(var d=i[1].value-i[0].value,p=0;p<i.length-1;p++){var f=i[p],v=i[p+1];n.push(f);for(var g=0;g<c;g++){var y=(g+1)/(c+1),m=(1-y)*f.value+y*(v?v.value:h?1:f.value+d);n.push({value:m})}}return n.push(i[i.length-1]),n}return i},i.mark=$K,i}(OX),eq=T(T({},$K),((zK={}).track={name:"track",type:"arc"},zK.progress={name:"progress",type:"arc"},zK)),iq={type:"fadeIn"};function nq(t,e){return"fadeIn"===e?iq:function(t){return{type:"growAngleIn",options:{overall:t.startAngle}}}(t)}var rq=function(){KF.registerAnimation("circularProgress",(function(t,e){return{appear:nq(t,e),enter:{type:"growAngleIn"},disappear:{type:"growAngleOut"}}}))},aq=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!0,e}return M(e,t),e}(nj),oq={outerRadius:.8,innerRadius:.6,progress:{style:{fillOpacity:1}},track:{style:{fillOpacity:.2}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}},sq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.circularProgress,i.transformerConstructor=aq,i._progressMark=null,i._trackMark=null,i._getRadiusValueStart=function(t){if(i.getGroupFields().length>1){var e=i.radiusAxisHelper.dataToPosition(i.getDatumPositionValues(t,i.getGroupFields()));if(et(e))return e}return i.radiusAxisHelper.dataToPosition([t[i._radiusField[0]]])},i._getRadiusValueEnd=function(t){var e,n;if(i.getGroupFields().length>1){var r=i.radiusAxisHelper.dataToPosition(i.getDatumPositionValues(t,i.getGroupFields()))+(null===(n=(e=i.radiusAxisHelper).getBandwidth)||void 0===n?void 0:n.call(e,i._groups?i._groups.fields.length-1:0));if(et(r))return r}return i.radiusAxisHelper.dataToPosition([t[i._radiusField[0]]])+i.radiusAxisHelper.getScale(0).step()},i}return M(i,e),i.prototype.getStackGroupFields=function(){return this.getGroupFields()},i.prototype.getGroupFields=function(){return this._radiusField},i.prototype.initMark=function(){e.prototype.initMark.call(this),this._initTrackMark(),this._initProgressMark()},i.prototype.initMarkStyle=function(){e.prototype.initMarkStyle.call(this),this._initTrackMarkStyle(),this._initProgressMarkStyle()},i.prototype._initProgressMark=function(){return this._progressMark=this._createMark(i.mark.progress,{parent:this._arcGroupMark,isSeriesMark:!0},{morph:$V(this._spec,"progress")}),this._progressMark},i.prototype._initProgressMarkStyle=function(){var e,i=this,n=this._progressMark;n&&this.setMarkStyle(n,{x:function(){return i.angleAxisHelper.center().x},y:function(){return i.angleAxisHelper.center().y},startAngle:this._getAngleValueStart,endAngle:this._getAngleValueEnd,innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cap:null!==(e=this._spec.roundCap)&&void 0!==e&&e,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0},"normal",t.AttributeLevel.Series)},i.prototype.getInteractionTriggers=function(){var t=[];return this._trackMark&&t.push(this._trackMark),this._progressMark&&t.push(this._progressMark),this._parseInteractionConfig(t)},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark)},i.prototype._initTrackMark=function(){return this._trackMark=this._createMark(i.mark.track,{parent:this._arcGroupMark}),this._trackMark.setMarkConfig({morph:!1,morphKey:null,morphElementKey:null}),this._trackMark},i.prototype._initTrackMarkStyle=function(){var e=this,i=this._trackMark;i&&this.setMarkStyle(i,{visible:function(t){var i=e.angleAxisHelper.getScale(0).range(),n=Math.min(i[0],i[i.length-1]),r=e._getAngleValueStartWithoutMask(t);return Math.abs(r-n)<=1e-14},x:function(){return e.angleAxisHelper.center().x},y:function(){return e.angleAxisHelper.center().y},startAngle:function(){var t,i=e.getStack()?wz:e._angleField[0],n=e.angleAxisHelper.getScale(0).domain();return e._getAngleValueStart(((t={})[i]=n[0],t))},endAngle:function(){var t,i=e.getStack()?Cz:e._angleField[0],n=e.angleAxisHelper.getScale(0).domain();return e._getAngleValueEnd(((t={})[i]=n[n.length-1],t))},innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:100},"normal",t.AttributeLevel.Series)},i.prototype.initAnimation=function(){var t,e,i,n,r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._progressMark.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("circularProgress"))||void 0===i?void 0:i({startAngle:this._startAngle},r),ZV("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(qV(null===(n=KF.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),ZV("track",this._spec,this._markAttributeContext)))},i.prototype.getActiveMarks=function(){return[this._progressMark]},i.type=t.SeriesTypeEnum.circularProgress,i.mark=eq,i.builtInTheme={circularProgress:oq},i.transformerConstructor=aq,i}(tq),lq=function(){KF.registerSeries(sq.type,sq),ZX(),rq(),XN(),xK(),_K()};function uq(t){return function(){return"vertical"===t.direction?{orient:"negative"}:{orient:"positive"}}}var cq=function(t){return{type:"horizontal"===t.direction?"growWidthOut":"growHeightOut",options:uq(t)}},hq={type:"fadeIn"};function dq(t,e){return void 0===e&&(e="grow"),!1===e?{}:"fadeIn"===e?hq:function(t){return{type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:uq(t)}}(t)}var pq,fq,vq=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.enableByType=function(t){return"dimension"!==t},e}(EV),gq=T(T({},VV),((pq={}).track={name:"track",type:"rect"},pq.progress={name:"progress",type:"rect"},pq.group={name:"group",type:"group"},pq)),yq={bandWidth:30,progress:{style:{fillOpacity:1}},track:{style:{fill:{type:"palette",key:"linearProgressTrackColor"},fillOpacity:1}}},mq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.linearProgress,i._progressMark=null,i._trackMark=null,i._defaultProgressCustomShape=function(t,e,n){var r,a,o=null===(r=i._spec)||void 0===r?void 0:r.cornerRadius,s=U(e.width)?e.width:e.x1-e.x,l=U(e.height)?e.height:e.y1-e.y,u=Math.min(0,s),c=Math.max(0,s),h=Math.min(0,l),d=Math.max(0,l);if(o>0){var p=o;if("vertical"===(null===(a=i._spec)||void 0===a?void 0:a.direction)){if(2*(p=Math.min(Math.abs(s/2),o))>Math.abs(l)){var f=Math.acos((p-Math.abs(l)/2)/p);return n.moveTo(u+p,h),n.arc(u+p,h+p,p,1.5*Math.PI,1.5*Math.PI-f,!0),n.arc(u+p,d-p,p,f+Math.PI/2,Math.PI/2,!0),n.lineTo(c-o,d),n.arc(c-p,d-p,p,Math.PI/2,Math.PI/2-f,!0),n.arc(c-p,h+p,p,-Math.PI/2+f,-Math.PI/2,!0),n.lineTo(u+p,h),n.closePath(),n}}else if(2*(p=Math.min(Math.abs(l/2),o))>Math.abs(s)){f=Math.acos((p-Math.abs(s)/2)/p);return n.moveTo(u,h+p),n.arc(u+p,h+p,p,Math.PI,Math.PI+f),n.arc(c-p,h+p,p,-f,0),n.lineTo(c,d-p),n.arc(c-p,d-p,p,0,f),n.arc(u+p,d-p,p,Math.PI-f,Math.PI),n.closePath(),n}n.moveTo(u,h+p),n.arc(u+p,h+p,p,Math.PI,1.5*Math.PI),n.lineTo(c-p,h),n.arc(c-p,h+p,p,-Math.PI/2,0),n.lineTo(c,d-p),n.arc(c-p,d-p,p,0,Math.PI/2),n.lineTo(u+p,d),n.arc(u+p,d-p,p,Math.PI/2,Math.PI),n.closePath()}else n.moveTo(u,h),n.lineTo(c,h),n.lineTo(c,d),n.lineTo(u,d),n.closePath();return n},i}return M(i,e),i.prototype.initMark=function(){this._initTrackMark(),this._initProgressMark()},i.prototype.initMarkStyle=function(){this._initTrackMarkStyle(),this._initProgressMarkStyle()},i.prototype._initProgressMark=function(){var t;return this._progressMark=this._createMark(i.mark.progress,{isSeriesMark:!0}),j(null===(t=this._spec.progress)||void 0===t?void 0:t.customShape)&&this._progressMark.setMarkConfig({setCustomizedShape:this._defaultProgressCustomShape}),this._progressMark},i.prototype._initProgressMarkStyle=function(){var e,i,n,r,a=this,o=this._progressMark;if(o)if("vertical"===this._spec.direction){var s=null!==(e=(u=this._spec.progress||{}).leftPadding)&&void 0!==e?e:0,l=null!==(i=u.rightPadding)&&void 0!==i?i:0;this.setMarkStyle(o,{x:function(t){var e,i;return MF(a.dataToPositionX(t),null===(i=null===(e=a._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0),!0)-a._spec.bandWidth/2+s},y1:function(t){var e,i;return MF(a.dataToPositionY(t),null===(i=null===(e=a._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:function(){var t,e,i,n=null===(t=a._yAxisHelper)||void 0===t?void 0:t.dataToPosition([0],{bandPosition:a._bandPosition});return a._spec.clamp?MF(n,null===(i=null===(e=a._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0)):n},width:this._spec.bandWidth-s-l,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series)}else{var u,c=null!==(n=(u=this._spec.progress||{}).topPadding)&&void 0!==n?n:0,h=null!==(r=u.bottomPadding)&&void 0!==r?r:0;this.setMarkStyle(o,{x1:function(t){var e,i;return MF(a.dataToPositionX(t),null===(i=null===(e=a._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:function(t){var e,i;return MF(a.dataToPositionY(t),null===(i=null===(e=a._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0),!0)-a._spec.bandWidth/2+c},height:this._spec.bandWidth-c-h,x:function(){var t,e,i,n=null===(t=a._xAxisHelper)||void 0===t?void 0:t.dataToPosition([0],{bandPosition:a._bandPosition});return a._spec.clamp?MF(n,null===(i=null===(e=a._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0)):n},cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series)}},i.prototype._initTrackMark=function(){return this._trackMark=this._createMark(i.mark.track),this._trackMark},i.prototype._initTrackMarkStyle=function(){var e=this,i=this._trackMark;i&&("vertical"===this._spec.direction?this.setMarkStyle(i,{x:function(t){var i,n;return MF(e.dataToPositionX(t),null===(n=null===(i=e._xAxisHelper)||void 0===i?void 0:i.getScale)||void 0===n?void 0:n.call(i,0),!0)-e._spec.bandWidth/2},y:0,width:this._spec.bandWidth,height:function(){return e._scaleY.range()[0]},cornerRadius:this._spec.cornerRadius},"normal",t.AttributeLevel.Series):this.setMarkStyle(i,{x:0,y:function(t){var i,n;return MF(e.dataToPositionY(t),null===(n=null===(i=e._yAxisHelper)||void 0===i?void 0:i.getScale)||void 0===n?void 0:n.call(i,0),!0)-e._spec.bandWidth/2},height:this._spec.bandWidth,width:function(){return e._scaleX.range()[1]},cornerRadius:this._spec.cornerRadius},"normal",t.AttributeLevel.Series))},i.prototype.getInteractionTriggers=function(){var t=[];return this._trackMark&&t.push(this._trackMark),this._progressMark&&t.push(this._progressMark),this._parseInteractionConfig(t)},i.prototype.initAnimation=function(){var t,e,i,n,r={direction:this.direction},a=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._progressMark.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("linearProgress"))||void 0===i?void 0:i(r,a),ZV("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(qV(null===(n=KF.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),ZV("track",this._spec,this._markAttributeContext)))},i.prototype.initTooltip=function(){this._tooltipHelper=new vq(this),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark),this._trackMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._trackMark)},i.prototype.getActiveMarks=function(){return[this._progressMark]},i.type=t.SeriesTypeEnum.linearProgress,i.mark=gq,i.builtInTheme={linearProgress:yq},i}(lj),_q=function(){MG(),KF.registerAnimation("linearProgress",(function(t,e){return{appear:dq(t,e),enter:dq(t),disappear:cq(t)}})),XN(),KF.registerSeries(mq.type,mq)},bq=[0],xq=[20,40],kq=[200,500],Sq={shrink:!1,enlarge:!1,fontSizeLimitMin:0},Aq=["triangleForward","triangle","diamond","square","star","cardioid","circle","pentagon","rect"],Mq="".concat(mz,"_WORD_CLOUD_TEXT"),Tq=T(T({},VV),((fq={}).word={name:"word",type:"text"},fq.fillingWord={name:"fillingWord",type:"text"},fq.wordMask={name:"wordMask",type:"rect"},fq)),wq={word:{padding:1,style:{textAlign:"center",textBaseline:"alphabetic"}}},Cq=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._fontSizeRange=[20,20],t._isWordCloudShape=!1,t._dataChange=!0,t.handleMaskCanvasUpdate=function(e,i){t._maskCanvas=e},t.getWordColor=function(e){return e.isFillingWord?(t._fillingColorCallback&&!t._dataChange||(t._fillingColorCallback=t._wordCloudShapeConfig.fillingColorHexField?function(e){return e[t._wordCloudShapeConfig.fillingColorHexField]}:t.initColorCallback(t._wordCloudShapeConfig.fillingSeriesField,!0)),t._fillingColorCallback(e)):(t._keyWordColorCallback&&!t._dataChange||(t._keyWordColorCallback=t._spec.colorHexField?function(e){return e[t._spec.colorHexField]}:t.initColorCallback(t._seriesField,!1)),t._keyWordColorCallback(e))},t._calculateFontWeight=function(e){var i=t.getRawDataStatisticsByField(t._valueField,!0);return i.min===i.max?t._fontWeightRange[0]:t._fontWeightRange[0]+(t._fontWeightRange[t._fontWeightRange.length-1]-t._fontWeightRange[0])*(e[t._valueField]-i.min)/(i.max-i.min)},t}return M(i,e),i.prototype.setValueField=function(t){U(t)&&(this._valueField=t)},i.prototype.setFontSizeRange=function(t){U(t)?this._fontSizeRange=t:this._fontSizeRange=xq},i.prototype.setAttrFromSpec=function(){var t,i,n,r,a;e.prototype.setAttrFromSpec.call(this),this._padding=this._option.getChart().padding,this._nameField=this._spec.nameField,this._colorMode=null!==(t=this._spec.colorMode)&&void 0!==t?t:"ordinal",this._colorList=this._spec.colorList,this.setValueField(this._spec.valueField),this._fontWeightRange=null!==(i=this._spec.fontWeightRange)&&void 0!==i?i:kq,this._rotateAngles=null!==(n=this._spec.rotateAngles)&&void 0!==n?n:bq,this.setFontSizeRange(this._spec.fontSizeRange),this._maskShape=null!==(r=this._spec.maskShape)&&void 0!==r?r:"circle",this._textField=(null===(a=this._spec.word)||void 0===a?void 0:a.formatMethod)?Mq:this._nameField;var o=this._spec.wordCloudConfig;this._wordCloudConfig=T({drawOutOfBound:"hidden",layoutMode:"default",zoomToFit:Sq},this._spec.wordCloudConfig),o&&!j(o.layoutMode)||vx(this._option.mode)||(this._wordCloudConfig.layoutMode="fast"),this._wordCloudShapeConfig=T({fillingSeriesField:this.getSeriesField(),fillingRotateAngles:bq,layoutMode:"default"},this._spec.wordCloudShapeConfig),this._isWordCloudShape=!Aq.includes(this._maskShape)&&!["fast","grid","cloud"].includes(this._wordCloudConfig.layoutMode),this._defaultFontFamily=this._option.getTheme("fontFamily")},i.prototype.initData=function(){var t,i,n=this;e.prototype.initData.call(this),null===(i=null===(t=this.getViewData())||void 0===t?void 0:t.target)||void 0===i||i.addListener("change",(function(){n._dataChange=!0,n.compile()}))},i.prototype.initMark=function(){var e;this._wordMark=this._createMark(i.mark.word,{key:Sz,groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this._seriesField}),(null===(e=this._spec.wordMask)||void 0===e?void 0:e.visible)&&(this._maskMark=this._createMark(i.mark.wordMask,{dataView:!1}),this._maskMark.setMarkConfig({zIndex:t.LayoutZIndex.Mark-1}))},i.prototype.initMarkStyle=function(){var e=this;this.initMarkStyleOfWord(this._wordMark,this._spec.word,this._spec.colorHexField,this._seriesField),this._maskMark&&this.setMarkStyle(this._maskMark,{width:function(){return e._region.getLayoutRect().width},height:function(){return e._region.getLayoutRect().height},background:function(){return e._maskCanvas}},"normal",t.AttributeLevel.Series)},i.prototype.initMarkStyleOfWord=function(e,i,n,r,a){var o,s,l=this;e&&(this.setMarkStyle(e,{text:(null==i?void 0:i.formatMethod)?function(t){return i.formatMethod(t)}:function(t){return t[l._textField]},x:function(t){return t.x},y:function(t){return t.y},fontSize:function(t){return t.fontSize},fontStyle:function(t){return t.fontStyle},angle:function(t){return t.angle},visible:function(t){return t.visible}},"normal",t.AttributeLevel.Series),this.setMarkStyle(e,{fill:null!==(s=null===(o=null==i?void 0:i.style)||void 0===o?void 0:o.fill)&&void 0!==s?s:this.getWordColor,fontWeight:function(t){return t.fontWeight},fontFamily:function(t){return t.fontFamily}},"normal",t.AttributeLevel.User_Mark))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._wordMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._wordMark)},i.prototype.initAnimation=function(){var t=this;[this._wordMark].forEach((function(e){var i,n;if(e){var r=null===(n=null===(i=t._spec)||void 0===i?void 0:i.animationAppear)||void 0===n?void 0:n.preset,a={animationConfig:function(){var t,i;return null===(i=null===(t=e.getAnimationConfig())||void 0===t?void 0:t.appear)||void 0===i?void 0:i[0]}};e.setAnimationConfig(qV(KF.getAnimationInKey("wordCloud")(a,r),ZV("word",t._spec,t._markAttributeContext)))}}))},i.prototype.getWordOrdinalColorScale=function(t,e){var i,n,r,a,o,s=e?this._wordCloudShapeConfig.fillingColorList:this._colorList,l=t?null===(i=this.getViewData())||void 0===i?void 0:i.latestData.map((function(e){return e[t]})):[],u=null!==(r=null!=s?s:null===(n=this._option.globalScale.getScale("color"))||void 0===n?void 0:n.range())&&void 0!==r?r:this._getDataScheme();return null===(o=(a=(new xF).domain(l)).range)||void 0===o?void 0:o.call(a,u)},i.prototype.initColorCallback=function(t,e){var i,n,r,a,o=this;if("ordinal"===this._colorMode){var s=this.getWordOrdinalColorScale(t,e);return function(e){return s.scale(e[null!=t?t:Az])}}var l=null!==(i=e?this._colorList:this._wordCloudShapeConfig.fillingColorList)&&void 0!==i?i:this._option.globalScale.getScale("color").range();if(1===l.length)return function(t){return l[0]};if(this._valueField){var u=this.getRawDataStatisticsByField(this._valueField,!0);if(u.min===u.max)return l[0];var c=(new UL).domain([u.min,u.max]).range(l);return function(t){return c.scale(t[o._valueField])}}var h=(new UL).domain([0,null!==(a=null===(r=null===(n=this.getViewData())||void 0===n?void 0:n.latestData)||void 0===r?void 0:r.length)&&void 0!==a?a:1]).range(l);return function(t){return h.scale(t[kz])}},i.prototype.compile=function(){e.prototype.compile.call(this);var t=this._region.getLayoutRect(),i=t.width,n=t.height;if(et(i)&&et(n)&&n>0&&i>0){var r=[];this._isWordCloudShape?r.push(T({type:"wordcloudShape"},this._wordCloudShapeTransformOption())):r.push(T({type:"wordcloud"},this._wordCloudTransformOption())),this._wordMark.setTransform(r)}},i.prototype._getCommonTransformOptions=function(){var t,e,i,n,r,a=this,o=this._region.getLayoutRect(),s=o.width,l=o.height,u=null!==(t=this._spec.word)&&void 0!==t?t:{},c=null!==(e=u.style)&&void 0!==e?e:{};return{size:[s,l],shape:W(this._maskShape)&&"text"===this._maskShape.type&&j(this._maskShape.fontFamily)?T({fontFamily:this._option.getTheme("fontFamily")},this._maskShape):this._maskShape,onUpdateMaskCanvas:this.handleMaskCanvasUpdate,onLayoutFinished:function(){var t,e;return null===(e=null===(t=a._option.globalInstance.getChart().getOption().performanceHook)||void 0===t?void 0:t.afterWordcloudShapeDraw)||void 0===e?void 0:e.call(t,a._option.globalInstance)},dataIndexKey:Sz,text:u.formatMethod?function(t){return u.formatMethod(t)}:{field:this._textField},fontSize:this._valueField?{field:this._valueField}:this._fontSizeRange[0],fontSizeRange:"auto"===this._fontSizeRange?null:this._fontSizeRange,padding:null!==(n=null===(i=this._spec.word)||void 0===i?void 0:i.padding)&&void 0!==n?n:1,fontFamily:U(this._spec.fontFamilyField)?{field:this._spec.fontFamilyField}:null!==(r=c.fontFamily)&&void 0!==r?r:this._defaultFontFamily,fontWeight:U(this._spec.fontWeightField)?{field:this._spec.fontWeightField}:U(c.fontWeight)?c.fontWeight:U(this._valueField)?this._calculateFontWeight:"normal",fontStyle:U(this._spec.fontStyleField)?{field:this._spec.fontStyleField}:c.fontStyle,createCanvas:j_.createCanvas.bind(j_),getTextBounds:Sg}},i.prototype._wordCloudTransformOption=function(){var t,e,i=null!==(t=this._wordCloudConfig)&&void 0!==t?t:{};return T(T(T({},i),this._getCommonTransformOptions()),{layoutType:this._wordCloudConfig.layoutMode,rotate:this._rotateAngles,randomVisible:null===(e=this._spec.random)||void 0===e||e,clip:"clip"===this._wordCloudConfig.drawOutOfBound,shrink:this._wordCloudConfig.zoomToFit.shrink,enlarge:this._wordCloudConfig.zoomToFit.enlarge,minFontSize:this._wordCloudConfig.zoomToFit.fontSizeLimitMin,progressiveTime:this._wordCloudConfig.progressiveTime,progressiveStep:this._wordCloudConfig.progressiveStep,repeatFill:this._wordCloudConfig.zoomToFit.repeat})},i.prototype._wordCloudShapeTransformOption=function(){var t,e,i,n,r,a,o=null!==(e=null===(t=this._spec.fillingWord)||void 0===t?void 0:t.style)&&void 0!==e?e:{},s=null!==(i=this._wordCloudShapeConfig)&&void 0!==i?i:{};return T(T(T({},s),this._getCommonTransformOptions()),{createImage:Qv,rotateList:this._rotateAngles,fillingRotateList:s.fillingRotateAngles,fillingFontFamily:U(s.fillingFontFamilyField)?{field:s.fillingFontFamilyField}:null!==(n=o.fontFamily)&&void 0!==n?n:this._defaultFontFamily,fillingPadding:null!==(a=null===(r=this._spec.fillingWord)||void 0===r?void 0:r.padding)&&void 0!==a?a:1,fillingFontStyle:U(s.fillingFontStyleField)?{field:s.fillingFontStyleField}:o.fontStyle,fillingFontWeight:U(s.fillingFontWeightField)?{field:s.fillingFontWeightField}:o.fontWeight})},i.prototype.getStatisticFields=function(){var t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t},i.prototype.dataToPosition=function(t){return null},i.prototype.dataToPositionX=function(t){return null},i.prototype.dataToPositionY=function(t){return null},i.prototype.dataToPositionZ=function(t){return null},i.prototype.valueToPosition=function(t,e){return null},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this.compile(),this._dataChange=!1},i.prototype.getActiveMarks=function(){return[this._wordMark]},i.prototype.reInit=function(){e.prototype.reInit.call(this),this._keyWordColorCallback&&(this._keyWordColorCallback=null),this._fillingColorCallback&&(this._fillingColorCallback=null)},i.mark=Tq,i.builtInTheme={wordCloud:wq},i}(rj);function Eq(t,e){return!1===e?{}:"fadeIn"===e?{type:"fadeIn"}:function(t){return{type:"scaleIn",duration:200,delay:function(e,i){var n=t.animationConfig(),r=(null==n?void 0:n.duration)||200,a=(null==n?void 0:n.totalTime)||UN.appear.duration,o=i.context.graphicCount;return i.context.graphicIndex*function(t,e,i){return t*i<e?t+(e-i*t)/(i-1):(e-t)/(i-1)}(r,a,o)}}}(t)}var Pq=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"value",s=0,l=null!=n?n:-1,u=i;return t.forEach((function(t,n){var c,h,d={flattenIndex:++l,key:a?a(t):"".concat(null!==(c=null==r?void 0:r.key)&&void 0!==c?c:"","-").concat(n),maxDepth:-1,depth:i,index:n,value:t[o],isLeaf:!0,datum:r?r.datum.concat(t):[t],parentKey:null==r?void 0:r.key};if(null===(h=t.children)||void 0===h?void 0:h.length){d.children=[],d.isLeaf=!1;var p=Pq(t.children,d.children,i+1,l,d,a,o);d.value=j(t[o])?p.sum:Math.max(p.sum,ee(t[o])),l=p.flattenIndex,u=Math.max(p.maxDepth,u)}else d.isLeaf=!0,d.value=ee(t[o]);s+=Math.abs(d.value),e.push(d)})),{sum:s,maxDepth:u,flattenIndex:l}},Bq=function(t,e,i,n){var r=n;return t.forEach((function(t,n){var a;r=e(t,n,i,r),(null===(a=t.children)||void 0===a?void 0:a.length)&&(r=Bq(t.children,e,t,r))})),n},Rq=function(t,e,i,n){var r=n;return t.forEach((function(t,n){var a;(null===(a=t.children)||void 0===a?void 0:a.length)&&(r=Rq(t.children,e,t,r)),r=e(t,n,i,r)})),r},Lq=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,n=(null==i?void 0:i.maxDepth)>=0;return t.forEach((function(t){(!n||t.depth<=i.maxDepth)&&(e.push((null==i?void 0:i.callback)?i.callback(t):t),t.children&&(n&&t.depth===i.maxDepth?(t.children=null,t.isLeaf=!0):Lq(t.children,e,i)))})),e};function Iq(t,e){var i,n;if(Fq(e,t))return[e];for(i=0;i<t.length;++i)if(Dq(e,t[i])&&Fq(Hq(t[i],e),t))return[t[i],e];for(i=0;i<t.length-1;++i)for(n=i+1;n<t.length;++n)if(Dq(Hq(t[i],t[n]),e)&&Dq(Hq(t[i],e),t[n])&&Dq(Hq(t[n],e),t[i])&&Fq(Nq(t[i],t[n],e),t))return[t[i],t[n],e];Ot.getInstance().error("error when packEncloseRandom")}function Dq(t,e){var i=t.radius-e.radius,n=e.x-t.x,r=e.y-t.y;return i<0||i*i<n*n+r*r}function Oq(t,e){var i=t.radius-e.radius+1e-9*Math.max(t.radius,e.radius,1),n=e.x-t.x,r=e.y-t.y;return i>0&&i*i>n*n+r*r}function Fq(t,e){for(var i=0;i<e.length;++i)if(!Oq(t,e[i]))return!1;return!0}function zq(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,radius:t.radius}}(t[0]);case 2:return Hq(t[0],t[1]);case 3:return Nq(t[0],t[1],t[2])}}function Hq(t,e){var i=t.x,n=t.y,r=t.radius,a=e.x,o=e.y,s=e.radius,l=a-i,u=o-n,c=s-r,h=Math.sqrt(l*l+u*u);return{x:(i+a+l/h*c)/2,y:(n+o+u/h*c)/2,radius:(h+r+s)/2}}function Nq(t,e,i){var n=t.x,r=t.y,a=t.radius,o=e.x,s=e.y,l=e.radius,u=i.x,c=i.y,h=i.radius,d=n-o,p=n-u,f=r-s,v=r-c,g=l-a,y=h-a,m=n*n+r*r-a*a,_=m-o*o-s*s+l*l,b=m-u*u-c*c+h*h,x=p*f-d*v,k=(f*b-v*_)/(2*x)-n,S=(v*g-f*y)/x,A=(p*_-d*b)/(2*x)-r,M=(d*y-p*g)/x,T=S*S+M*M-1,w=2*(a+k*S+A*M),C=k*k+A*A-a*a,E=-(Math.abs(T)>1e-6?(w+Math.sqrt(w*w-4*T*C))/(2*T):C/w);return{x:n+k+S*E,y:r+A+M*E,radius:E}}function Vq(t,e,i){var n,r,a,o,s=t.x-e.x,l=t.y-e.y,u=s*s+l*l;u?(r=e.radius+i.radius,r*=r,o=t.radius+i.radius,r>(o*=o)?(n=(u+o-r)/(2*u),a=Math.sqrt(Math.max(0,o/u-n*n)),i.x=t.x-n*s-a*l,i.y=t.y-n*l+a*s):(n=(u+r-o)/(2*u),a=Math.sqrt(Math.max(0,r/u-n*n)),i.x=e.x+n*s-a*l,i.y=e.y+n*l+a*s)):(i.x=e.x+i.radius,i.y=e.y)}function jq(t,e){var i=t.radius+e.radius-1e-6,n=e.x-t.x,r=e.y-t.y;return i>0&&i*i>n*n+r*r}function Uq(t){var e=t._,i=t.next._,n=e.radius+i.radius,r=(e.x*i.radius+i.x*e.radius)/n,a=(e.y*i.radius+i.y*e.radius)/n;return r*r+a*a}function Wq(t){return{_:t,next:null,prev:null}}function Gq(t,e){var i=(t=St(t)).length;if(!i)return 0;var n=t[0];if(n.x=0,n.y=0,1===i)return n.radius;var r=t[1];if(n.x=-r.radius,r.x=n.radius,r.y=0,2===i)return n.radius+r.radius;var a=t[2];Vq(r,n,a);var o,s,l,u,c,h,d,p=Wq(n),f=Wq(r),v=Wq(a);p.next=f,v.prev=f,f.next=v,p.prev=v,v.next=p,f.prev=p;for(var g=3;g<i;++g){d=!1,a=t[g],Vq(p._,f._,a),v=Wq(a),o=f.next,s=p.prev,l=f._.radius,u=p._.radius;do{if(l<=u){if(jq(o._,v._)){f=o,p.next=f,f.prev=p,--g,d=!0;break}l+=o._.radius,o=o.next}else{if(jq(s._,v._)){(p=s).next=f,f.prev=p,--g,d=!0;break}u+=s._.radius,s=s.prev}}while(o!==s.next);if(!d){for(v.prev=p,v.next=f,p.next=f.prev=f=v,c=Uq(p),v=v.next;v!==f;)(h=Uq(v))<c&&(p=v,c=h),v=v.next;f=p.next}}var y=[f._];for(v=f.next;v!==f;)y.push(v._),v=v.next;a=function(t,e){for(var i,n,r=0,a=Ct(Array.from(t),e),o=a.length,s=[];r<o;)i=a[r],n&&Oq(n,i)?++r:(n=zq(s=Iq(s,i)),r=0);return n}(y,e);for(var m=0;m<i;++m)(n=t[m]).x-=a.x,n.y-=a.y;return a.radius}function Yq(t){return function(e){e.children||(e.radius=Math.max(0,+t(e)||0))}}function Xq(t,e,i){return function(n){var r=null==n?void 0:n.children;if(r){var a,o=r.length,s=t(n)*e||0;if(s)for(a=0;a<o;++a)r[a].radius+=s;var l=Gq(r,i);if(s)for(a=0;a<o;++a)r[a].radius-=s;n.radius=l+s}}}function Kq(t,e){return function(i,n,r){i.radius*=t,i.maxDepth=e,r&&(i.x=r.x+t*i.x,i.y=r.y+t*i.y)}}var qq=function(){function t(e){r(this,t),this.options=e;var i=null==e?void 0:e.nodeKey,n=V(i)?i:i?oe(i):null;this._getNodeKey=n,this._getPadding=Q(null==e?void 0:e.padding)?function(t){return e.padding}:q(null==e?void 0:e.padding)?function(t){var i;return null!==(i=e.padding[t.depth+1])&&void 0!==i?i:0}:function(){return 0},this._maxDepth=-1}return o(t,[{key:"layout",value:function(e,i){var n,r="width"in i?{x0:0,x1:i.width,y0:0,y1:i.height,width:i.width,height:i.height}:{x0:Math.min(i.x0,i.x1),x1:Math.max(i.x0,i.x1),y0:Math.min(i.y0,i.y1),y1:Math.max(i.y0,i.y1),width:Math.abs(i.x1-i.x0),height:Math.abs(i.y1-i.y0)};if(!e||!e.length)return[];var a=[],o=Pq(e,a,0,-1,null,this._getNodeKey);this._maxDepth=o.maxDepth;var s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(){return(t=(1664525*t+1013904223)%ne)/ne}}(),l={flattenIndex:-1,maxDepth:-1,key:"root",depth:-1,index:-1,value:o.sum,datum:null,children:a,x:r.x0+r.width/2,y:r.y0+r.height/2},u=null!==(n=this.options)&&void 0!==n?n:{},c=u.nodeSort,h=u.setRadius,d=u.padding,p=u.includeRoot;if(!1!==c){var f=V(c)?this.options.nodeKey:t.defaultOpionts.nodeSort;Bq([l],(function(t){t.children&&t.children.length&&t.children.sort(f)}))}if(h)Bq([l],Yq(h)),Rq([l],Xq(this._getPadding,.5,s)),Bq([l],Kq(1,this._maxDepth));else{var v=Math.min(r.width,r.height);Bq([l],Yq(t.defaultOpionts.setRadius)),Rq([l],Xq(ue,1,s)),d&&Rq([l],Xq(this._getPadding,l.radius/v,s)),Bq([l],Kq(v/(2*l.radius),this._maxDepth))}return p?[l]:a}}])}();qq.defaultOpionts={setRadius:function(t){return Math.sqrt(t.value)},padding:0,nodeSort:function(t,e){return e.value-t.value}};var Zq=function(t){var e=0;return t.forEach((function(t,i){var n;j(t.value)&&((null===(n=t.children)||void 0===n?void 0:n.length)?t.value=Zq(t.children):t.value=0),e+=Math.abs(t.value)})),e};function Jq(t){return t.depth}function Qq(t,e){return e-1-t.endDepth}var $q=function(t,e){return(null==t?void 0:t.y0)-(null==e?void 0:e.y0)},tZ=function(t,e){if(j(t.value))return null;var i=(e?t.targetLinks:t.sourceLinks).reduce((function(t,e){return j(e.value)?t.count+=1:t.sum+=e.value,t}),{sum:0,count:0});return i.count>0?(t.value-i.sum)/i.count:null},eZ={left:Jq,right:Qq,justify:function(t,e){return t.sourceLinks.length?t.depth:e-1},center:function(t,e,i){return t.targetLinks.length?t.depth:t.sourceLinks.length?Tt(t.sourceLinks.map((function(t){return i[t.target].depth})))-1:0},start:Jq,end:Qq},iZ=qt(0,1),nZ=function(){return o((function t(e){var i=this;r(this,t),this._ascendingSourceBreadth=function(t,e){return $q(i._nodeMap[t.source],i._nodeMap[e.source])||t.index-e.index},this._ascendingTargetBreadth=function(t,e){return $q(i._nodeMap[t.target],i._nodeMap[e.target])||t.index-e.index},this.options=Object.assign({},t.defaultOptions,e);var n=this.options.nodeKey,a=V(n)?n:n?oe(n):null;this._getNodeKey=a,this._logger=Ot.getInstance(),this._alignFunc=V(this.options.setNodeLayer)?function(t){return i.options.setNodeLayer(t.datum)}:eZ[this.options.nodeAlign]}),[{key:"layout",value:function(t,e){var i=this;if(!t)return null;var n="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};"vertical"===this.options.direction?this._viewBox={x0:n.y0,x1:n.y1,y0:n.x0,y1:n.x1,width:n.height,height:n.width}:this._viewBox=n;var r=this.computeNodeLinks(t),a=r.nodes,o=r.links;if(this._nodeMap=r.nodeMap,this.computeNodeValues(a),this.computeNodeDepths(a),["right","end","justify"].includes(this.options.nodeAlign)&&this.computeNodeEndDepths(a),this._maxDepth<=0)return null;var s=this.computeNodeBreadths(a);if(this.computeLinkBreadths(a),a.forEach((function(t){t.sourceLinks=t.sourceLinks.filter((function(t){return!j(t.source)&&!j(t.target)})),t.targetLinks=t.targetLinks.filter((function(t){return!j(t.source)&&!j(t.target)}))})),o=o.filter((function(t){return!j(t.source)&&!j(t.target)})),"vertical"===this.options.direction)if(this.options.inverse){var l=this._viewBox.x1;a.forEach((function(t){var e=t.y0,i=t.y1,n=t.x0,r=t.x1;t.y0=l-r,t.y1=l-n,t.x0=e,t.x1=i})),o.forEach((function(t){t.vertical=!0;var e=t.x0,i=t.x1,n=t.y0,r=t.y1;t.x0=n,t.x1=r,t.y0=l-e,t.y1=l-i}))}else a.forEach((function(t){var e=t.y0,i=t.y1;t.y0=t.x0,t.y1=t.x1,t.x0=e,t.x1=i})),o.forEach((function(t){t.vertical=!0;var e=t.x0,i=t.x1;t.x0=t.y0,t.x1=t.y1,t.y0=e,t.y1=i}));else this.options.inverse&&(a.forEach((function(t){var e=t.x0,i=t.x1;t.x0=n.x1-i,t.x1=n.x1-e})),o.forEach((function(t){t.x0=n.x1-t.x0,t.x1=n.x1-t.x1})));return o.forEach((function(t){var e=i._nodeMap[t.source],n=i._nodeMap[t.target];t.sourceRect={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1},t.targetRect={x0:n.x0,x1:n.x1,y1:n.y1,y0:n.y0}})),{nodes:a,links:o,columns:s}}},{key:"computeHierarchicNodeLinks",value:function(t){var e=this,i=[],n=[],r={},a={},o=[];Zq(t);var s=function(t,n,a){t.forEach((function(t,l){var u=e._getNodeKey?e._getNodeKey(t):a?"".concat(a[a.length-1].key,"-").concat(l):"".concat(n,"-").concat(l),c=j(t.value)?0:ee(t.value);if(r[u])r[u].value=void 0;else{var h={depth:n,datum:t,index:l,key:u,value:c,sourceLinks:[],targetLinks:[]};r[u]=h,i.push(h)}a&&o.push({source:a[a.length-1].key,target:u,value:c,parents:a}),t.children&&t.children.length&&s(t.children,n+1,a?a.concat([r[u]]):[r[u]])}))};return s(t,0,null),o.forEach((function(t,e){var i="".concat(t.source,"-").concat(t.target),o=yt(t,["parents"]);if(o.parents=t.parents.map((function(t){return yt(t,["sourceLinks","targetLinks"])})),a[i])return a[i].value+=ee(t.value),void a[i].datum.push(o);var s={index:e,key:"".concat(t.source,"-").concat(t.target),source:t.source,target:t.target,datum:[o],value:t.value,parents:t.parents.map((function(t){return t.key}))};n.push(s),r[t.source].sourceLinks.push(s),r[t.target].targetLinks.push(s),a[i]=s})),{nodes:i,links:n,nodeMap:r}}},{key:"computeSourceTargetNodeLinks",value:function(t){var e=this,i=[],n=[],r={};t.nodes&&t.nodes.forEach((function(t,n){var a={depth:-1,datum:t,index:n,key:e._getNodeKey?e._getNodeKey(t):n,value:t.value,sourceLinks:[],targetLinks:[]};r[a.key]=a,i.push(a)}));var a=[];return t.links.forEach((function(o,s){var l=!j(o.source),u=!j(o.target);if(!t.nodes||r[o.source]&&r[o.target]){t.nodes||!l||r[o.source]||(r[o.source]={value:void 0,depth:-1,index:i.length,key:o.source,datum:null,sourceLinks:[],targetLinks:[]},i.push(r[o.source])),t.nodes||!u||r[o.target]||(r[o.target]={value:void 0,depth:-1,index:i.length,key:o.target,datum:null,sourceLinks:[],targetLinks:[]},i.push(r[o.target]));var c={index:s,source:o.source,target:o.target,datum:o,value:o.value};e.options.divideNodeValueToLink&&j(o.value)&&a.push(c),n.push(c),l&&r[o.source].sourceLinks.push(c),u&&r[o.target].targetLinks.push(c)}})),this.options.divideNodeValueToLink&&a.length&&a.forEach((function(t){var e=[tZ(r[t.source]),tZ(r[t.target],!0)].filter((function(t){return!j(t)}));e.length&&(t.value=Tt(e))})),{nodeMap:r,nodes:i,links:n}}},{key:"computeNodeLinks",value:function(t){var e;"links"in t?e=this.computeSourceTargetNodeLinks(t):(this._isHierarchic=!0,e=this.computeHierarchicNodeLinks(t.nodes));var i=e.nodes,n=e.links;if(this.options.linkSortBy)for(var r=0,a=i.length;r<a;r++)i[r].sourceLinks.sort(this.options.linkSortBy),i[r].targetLinks.sort(this.options.linkSortBy);return this.options.dropIsolatedNode&&(i=i.filter((function(t){return t.targetLinks.length||t.sourceLinks.length}))),{nodes:i,links:n,nodeMap:e.nodeMap}}},{key:"computeNodeValues",value:function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e];n.value=Math.max(j(n.value)?0:ee(n.value),n.sourceLinks.reduce((function(t,e){var i;return t+(null!==(i=ee(e.value))&&void 0!==i?i:0)}),0),n.targetLinks.reduce((function(t,e){var i;return t+(null!==(i=ee(e.value))&&void 0!==i?i:0)}),0))}}},{key:"computeNodeDepths",value:function(t){for(var e,i,n,r=t.length,a=t,o=0,s=-1,l=V(this.options.setNodeLayer)?this.options.setNodeLayer:null;a.length&&o<r;){i=[],n={};for(var u=0,c=a.length;u<c;u++){var h=a[u];if(h&&(h.depth=l&&null!==(e=l(h.datum))&&void 0!==e?e:o,l&&(s=Math.max(h.depth,s)),h.sourceLinks&&h.sourceLinks.length))for(var d=0,p=h.sourceLinks.length;d<p;d++){var f=h.sourceLinks[d];n[f.target]||(i.push(this._nodeMap[f.target]),n[f.target]=!0)}}a=i,o+=1}o>r&&this._logger.warn("Error: there is a circular link"),this._maxDepth=l?s+1:o}},{key:"computeNodeEndDepths",value:function(t){for(var e,i,n=t.length,r=t,a=0;r.length&&a<n;){e=[],i={};for(var o=0,s=r.length;o<s;o++){var l=r[o];if(l){l.endDepth=a;for(var u=0,c=l.targetLinks.length;u<c;u++){var h=l.targetLinks[u];i[h.source]||(e.push(this._nodeMap[h.source]),i[h.source]=!0)}}}r=e,a+=1}a>n&&this._logger.warn("Error: there is a circular link")}},{key:"computeNodeLayers",value:function(t){var e=this.options.nodeWidth,i=this.options.linkWidth,n=this.options.minStepWidth,r=this._viewBox.width,a=null,o=null,s=!1;if(K(e)){var l=Xt(parseFloat(e.replace("%",""))/100,0,1),u=r/(this._maxDepth-1+l);n>0&&(u=Math.max(n,u)),a=u*l,o=u*(1-l),s=!0}else if(Q(e)){if(a=e,Q(i))o=i;else if(j(i)){var c=(r-e)/(this._maxDepth-1);n>0&&(c=Math.max(n,c)),o=c-e}s=!0}else V(e)&&Q(i)&&(o=i);for(var h=[],d=0,p=t.length;d<p;d++){var f=t[d];f.layer=this._isHierarchic?f.depth:Xt(Math.floor(this._alignFunc(f,this._maxDepth,this._nodeMap)),0,this._maxDepth-1);var v=f.layer;v===this._maxDepth-1&&(f.isLastLayer=!0),s&&(f.x0=this._viewBox.x0+v*(a+o),f.x1=f.x0+a),h[v]?h[v].push(f):h[v]=[f]}if(this.options.nodeSortBy)for(var g=0,y=h.length;g<y;g++)h[g].sort(this.options.nodeSortBy);if(!s&&V(e))for(var m=this._viewBox.x0,_=0;_<this._maxDepth;_++){for(var b=h[_],x=0,k=0,S=0,A=b&&b.length;S<A;S++){var M=b[S],T=e(M);M.x0=m,M.x1=m+T,x=Math.max(a,T);for(var w=M.sourceLinks,C=0,E=w.length;C<E;C++){var P=w[C],B=V(i)?i(P,this._viewBox):o;k=Math.max(k,B)}}m+=x+k}return h}},{key:"initializeNodeBreadths",value:function(t){var e,i,n,r=this,a=null!==(e=this.options.minLinkHeight)&&void 0!==e?e:0,o=null!==(i=this.options.minNodeHeight)&&void 0!==i?i:0,s=null!==(n=this.options.maxNodeHeight)&&void 0!==n?n:1/0,l=this.options.maxLinkHeight;(j(o)||o<a)&&(o=a),(j(l)||l>s)&&(l=s);var u=0,c=null,h=null;if(V(this.options.nodeGap))c=this.options.nodeGap,u=t.reduce((function(t,e){var i=e.reduce((function(t,e){return t+e.value}),0),n=e.reduce((function(t,e){return t+r.options.nodeGap(e)}),0);return Math.min(t,(r._viewBox.height-n)/i)}),1/0);else{var d=t.reduce((function(t,e){return Math.max(t,e.length)}),0),p=this._viewBox.height/d,f=Math.min(this.options.nodeGap,p);if(o+f>p&&(f=o>=p?p/2:(p-o)/2,o=Math.min(p-f,o)),c=function(){return f},this._gapY=f,this.options.equalNodeHeight)h=this._viewBox.height/d-f;else{var v=o>0?Math.max(f,o):f;u=t.reduce((function(t,e){var i=e.reduce((function(t,e){return t+e.value}),0);return Math.min(t,(r._viewBox.height-((e.length-1)*v+o))/i)}),1/0)}}for(var g="start"===this.options.gapPosition,y=!g&&"end"!==this.options.gapPosition,m=Q(this.options.nodeHeight)?function(t){return r.options.nodeHeight}:V(this.options.nodeHeight)?this.options.nodeHeight:h>0?function(t){return h}:function(t){return Math.max(t.value*u,0)},_=Q(this.options.linkHeight)?function(){return r.options.linkHeight}:V(this.options.linkHeight)?this.options.linkHeight:function(t,e,i){return Math.min(Math.max(e.value?i*iZ(t.value/e.value):0,a,0),l)},b=function(){var e=t[x];if(!e||!e.length)return 1;for(var i=r._viewBox.y0,n=0,a=0,l=0,u=0,h=e.length;u<h;u++){var d=e[u];n=c(d),g&&(i+=n),l=m(d),a=Math.min(Math.max(l,o),s),d.y0=i,d.y1=i+a,i=g?d.y1:d.y1+n;for(var p=0,f=d.sourceLinks.length;p<f;p++){var v=d.sourceLinks[p];v.thickness=_(v,d,l)}}var b=r._viewBox.y1-i+(y?n:0);if(b>0)if("start"===r.options.crossNodeAlign);else if("end"===r.options.crossNodeAlign)for(var k=0,S=e.length;k<S;++k){var A=e[k];A.y0+=b,A.y1+=b}else if("parent"===r.options.crossNodeAlign){var M=e.reduce((function(t,e){return e.targetLinks&&e.targetLinks.length&&e.targetLinks.forEach((function(e){t[e.source]=!0})),t}),{});if(Object.keys(M).length&&t[x-1]&&t[x-1].length){var T=t[x-1].filter((function(t){return M[t.key]}));if(T&&T.length&&T[0].y0!==e[0].y0)for(var w=T[0].y0-e[0].y0,C=0,E=e.length;C<E;++C){var P=e[C];P.y0+=w,P.y1+=w}}}else{b/=e.length+1;for(var B=0,R=e.length;B<R;++B){var L=e[B];L.y0+=b*(B+1),L.y1+=b*(B+1)}}else if(b<0&&e.length>1&&n+(b/=e.length-1)>=0){n+=b,r._gapY=Math.min(n);for(var I=1,D=e.length;I<D;++I){var O=e[I];O.y0+=b*I,O.y1+=b*I}}r.reorderLinks(e)},x=0,k=t.length;x<k;x++)b()}},{key:"computeNodeBreadths",value:function(t){var e=this.computeNodeLayers(t);this.initializeNodeBreadths(e);var i=this.options.iterations;if(!this._isHierarchic&&!V(this.options.setNodeLayer)&&!V(this.options.nodeGap))for(var n=0;n<i;++n){var r=Math.pow(.99,n),a=Math.max(1-r,(n+1)/i);this.relaxRightToLeft(e,r,a),this.relaxLeftToRight(e,r,a)}return e}},{key:"relaxLeftToRight",value:function(t,e,i){for(var n=1,r=t.length;n<r;++n){for(var a=t[n],o=0,s=a.length;o<s;o++){for(var l=a[o],u=0,c=0,h=0,d=l.targetLinks.length;h<d;h++){var p=l.targetLinks[h],f=p.value*(l.layer-this._nodeMap[p.source].layer);u+=this.targetTop(this._nodeMap[p.source],l)*f,c+=f}if(c>0){var v=(u/c-l.y0)*e;l.y0+=v,l.y1+=v,this.reorderNodeLinks(l)}}j(this.options.nodeSortBy)&&a.sort($q),this.resolveCollisions(a,i)}}},{key:"relaxRightToLeft",value:function(t,e,i){for(var n=t.length-2;n>=0;--n){for(var r=t[n],a=0,o=r.length;a<o;a++){for(var s=r[a],l=0,u=0,c=0,h=s.sourceLinks.length;c<h;c++){var d=s.sourceLinks[c],p=d.value*(this._nodeMap[d.target].layer-s.layer);l+=this.sourceTop(s,this._nodeMap[d.target])*p,u+=p}if(u>0){var f=(l/u-s.y0)*e;s.y0+=f,s.y1+=f,this.reorderNodeLinks(s)}}void 0===this.options.nodeSortBy&&r.sort($q),this.resolveCollisions(r,i)}}},{key:"resolveCollisions",value:function(t,e){var i=t.length>>1,n=t[i];this.resolveCollisionsBottomToTop(t,n.y0-this._gapY,i-1,e),this.resolveCollisionsTopToBottom(t,n.y1+this._gapY,i+1,e),this.resolveCollisionsBottomToTop(t,this._viewBox.y1,t.length-1,e),this.resolveCollisionsTopToBottom(t,this._viewBox.y0,0,e)}},{key:"resolveCollisionsTopToBottom",value:function(t,e,i,n){for(;i<t.length;++i){var r=t[i],a=(e-r.y0)*n;a>1e-6&&(r.y0+=a,r.y1+=a),e=r.y1+this._gapY}}},{key:"resolveCollisionsBottomToTop",value:function(t,e,i,n){for(;i>=0;--i){var r=t[i],a=(r.y1-e)*n;a>1e-6&&(r.y0-=a,r.y1-=a),e=r.y0-this._gapY}}},{key:"targetTop",value:function(t,e){var i,n,r,a=t.y0-(t.sourceLinks.length-1)*this._gapY/2;for(i=0,n=t.sourceLinks.length;i<n&&(r=t.sourceLinks[i]).target!==e.key;i++)a+=r.thickness+this._gapY;for(i=0,n=e.targetLinks.length;i<n&&(r=e.targetLinks[i]).source!==t.key;i++)a-=r.thickness;return a}},{key:"sourceTop",value:function(t,e){var i,n,r,a=e.y0-(e.targetLinks.length-1)*this._gapY/2;for(i=0,n=e.targetLinks.length;i<n&&(r=e.targetLinks[i]).source!==t.key;i++)a+=r.thickness+this._gapY;for(i=0,n=t.sourceLinks.length;i<n&&(r=t.sourceLinks[i]).target!==e.key;i++)a-=r.thickness;return a}},{key:"computeLinkBreadthsNoOverlap",value:function(t){for(var e=0,i=t.length;e<i;e++){for(var n=t[e],r=n.y0,a=!1,o=0,s=n.sourceLinks.length;o<s;o++){var l=n.sourceLinks[o];a||(l.y0=r+l.thickness/2),l.x0=n.x1,r+l.thickness>n.y1||a?(l.y0=n.y1-l.thickness/2,a=!0):r+=l.thickness}var u=n.y0;a=!1;for(var c=0,h=n.targetLinks.length;c<h;c++){var d=n.targetLinks[c];a||(d.y1=u+d.thickness/2),d.x1=n.x0,u+d.thickness>n.y1||a?(d.y1=n.y1-d.thickness/2,a=!0):u+=d.thickness}}}},{key:"computeLinkBreadthsOverlap",value:function(t){for(var e=this.options.linkOverlap,i=0,n=t.length;i<n;i++){for(var r=t[i],a="start"===e?r.y0:"end"===e?r.y1:(r.y0+r.y1)/2,o="start"===e?.5:"end"===e?-.5:0,s=0,l=r.sourceLinks.length;s<l;s++){var u=r.sourceLinks[s];u.y0=a+o*u.thickness,u.x0=r.x1}for(var c=0,h=r.targetLinks.length;c<h;c++){var d=r.targetLinks[c];d.y1=a+o*d.thickness,d.x1=r.x0}}}},{key:"computeLinkBreadths",value:function(t){this.options.linkOverlap?this.computeLinkBreadthsOverlap(t):this.computeLinkBreadthsNoOverlap(t)}},{key:"reorderNodeLinks",value:function(t){if(j(this.options.linkSortBy)){for(var e=t.targetLinks,i=t.sourceLinks,n=0,r=e.length;n<r;n++){var a=e[n];this._nodeMap[a.source].sourceLinks.sort(this._ascendingTargetBreadth)}for(var o=0,s=i.length;o<s;o++){var l=i[o];this._nodeMap[l.target].targetLinks.sort(this._ascendingSourceBreadth)}}}},{key:"reorderLinks",value:function(t){if(j(this.options.linkSortBy))for(var e=0,i=t.length;e<i;e++){var n=t[e];n.sourceLinks.sort(this._ascendingTargetBreadth),n.targetLinks.sort(this._ascendingSourceBreadth)}}}])}();function rZ(t,e,i,n,r){for(var a,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{x0:"x0",x1:"x1",y0:"y0",y1:"y1"},s=t.children,l=-1,u=s.length,c=t.value&&(n-e)/t.value;++l<u;)(a=s[l])[o.y0]=i,a[o.y1]=r,a[o.x0]=e,a[o.x1]=e+=a.value*c}nZ.defaultOptions={iterations:6,nodeAlign:"justify",direction:"horizontal",nodeWidth:24,nodeGap:8,crossNodeAlign:"middle",dropIsolatedNode:!0};var aZ={x0:"startAngle",x1:"endAngle",y0:"innerRadius",y1:"outerRadius"},oZ=function(){return o((function t(e){var i=this;r(this,t),this._layoutNode=function(t){if(t.maxDepth=i._maxDepth,t.children){var e=i._parsedInnerRadius[t.depth+1],n=i._parsedOutterRadius[t.depth+1];rZ(t,t.startAngle,Math.min(e,n),t.endAngle,Math.max(e,n),aZ);var r=q(i.options.label)?i.options.label[t.depth+1]:i.options.label;t.children.forEach((function(t){if(t.x=i._parsedCenter[0],t.y=i._parsedCenter[1],r)return i._layoutLabel(t,N(r)?{align:"center",rotate:"radial"}:r)}))}},this.options=e?Object.assign({},t.defaultOpionts,e):Object.assign({},t.defaultOpionts);var n=this.options.nodeKey,a=V(n)?n:n?oe(n):null;this._getNodeKey=a,this._maxDepth=-1}),[{key:"_parseRadius",value:function(t,e){var i=this,n=t.x0+le(this.options.center[0],t.width),r=t.y0+le(this.options.center[1],t.height),a=Math.min(t.width/2,t.height/2),o=this.options.innerRadius,s=this.options.outerRadius,l=q(o),u=l?o.map((function(t){return le(t,a)})):le(o,a),c=q(s),h=this.options.gapRadius,d=c?s.map((function(t){return le(t,a)})):le(s,a),p=Pt(0,e+1);if(l)this._parsedInnerRadius=p.map((function(t,e){var i=u[e];return j(i)?a:i})),this._parsedOutterRadius=p.map((function(t,n){var r,o;return c?null!==(r=d[n])&&void 0!==r?r:a:n<e?i._parsedInnerRadius[n+1]-(q(h)?null!==(o=h[n])&&void 0!==o?o:0:h):d}));else if(c)this._parsedOutterRadius=p.map((function(t,e){return j(d[e])?a:d[e]})),this._parsedInnerRadius=p.map((function(t,e){var n;return 0===e?u:i._parsedOutterRadius[e-1]-(q(h)?null!==(n=h[e])&&void 0!==n?n:0:h)}));else{var f=le(o,a),v=(d-f)/(e+1);this._parsedInnerRadius=p.map((function(t,e){return f+e*v})),this._parsedOutterRadius=p.map((function(t,e){var n;return i._parsedInnerRadius[e]+v-(q(h)?null!==(n=h[e])&&void 0!==n?n:0:h)}))}this._parsedCenter=[n,r],this._maxRadius=a}},{key:"layout",value:function(t,e){var i="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};if(!t||!t.length)return[];var n=[],r=Pq(t,n,0,-1,null,this._getNodeKey);return this._parseRadius(i,r.maxDepth),this._maxDepth=r.maxDepth,this._layout(n,{flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:r.sum,datum:null,children:n,startAngle:this.options.startAngle,endAngle:this.options.endAngle}),n}},{key:"_layout",value:function(t,e){var i=this;this._layoutNode(e),t.forEach((function(t){var e;(null===(e=null==t?void 0:t.children)||void 0===e?void 0:e.length)?i._layout(t.children,t):i._layoutNode(t)}))}},{key:"_layoutLabel",value:function(t,e){var i,n=(t.startAngle+t.endAngle)/2,r=("start"===e.align?t.innerRadius:"end"===e.align?t.outerRadius:(t.innerRadius+t.outerRadius)/2)+(null!==(i=e.offset)&&void 0!==i?i:0),a=Ve({x:this._parsedCenter[0],y:this._parsedCenter[1]},r,n);if(t.label={x:a.x,y:a.y,textBaseline:"middle"},"tangential"===e.rotate)t.label.angle=n-Math.PI/2,t.label.textAlign="center",t.label.maxLineWidth=Math.abs(t.endAngle-t.startAngle)*r;else{var o=n%(2*Math.PI),s=o<0?o+2*Math.PI:o;s>Math.PI/2&&s<1.5*Math.PI?(t.label.angle=s+Math.PI,t.label.textAlign="start"===e.align?"end":"end"===e.align?"start":"center"):(t.label.angle=s,t.label.textAlign=e.align),t.label.maxLineWidth=t.isLeaf?void 0:Math.abs(t.outerRadius-t.innerRadius)}}}])}();function sZ(t,e,i,n,r){for(var a,o=t.children,s=-1,l=o.length,u=t.value&&(r-i)/t.value;++s<l;)(a=o[s]).x0=e,a.x1=n,a.y0=i,i+=a.value*u,a.y1=i}oZ.defaultOpionts={startAngle:Math.PI/2,endAngle:-3*Math.PI/2,center:["50%","50%"],gapRadius:0,innerRadius:0,outerRadius:"70%"};var lZ=function(t){return function(e,i,n,r,a){!function(t,e,i,n,r,a){for(var o,s,l,u,c,h,d,p,f,v,g,y=[],m=e.children,_=0,b=0,x=m.length,k=e.value;_<x;){l=r-i,u=a-n;do{c=m[b++].value}while(!c&&b<x);for(h=c,d=c,g=c*c*(v=Math.max(u/l,l/u)/(k*t)),f=Math.max(d/g,g/h);b<x;++b){if((s=m[b].value)<h&&(h=s),s>d&&(d=s),g=(c+=s)*c*v,(p=Math.max(d/g,g/h))>f){c-=s;break}f=p}o=Object.assign({},e,{value:c,children:m.slice(_,b)}),y.push(o),l<u?rZ(o,i,n,r,k?n+=u*c/k:a):sZ(o,i,n,k?i+=l*c/k:r,a),k-=c,_=b}}(t,e,i,n,r,a)}},uZ={binary:function(t,e,i,n,r){var a=t.children,o=a.length,s=0,l=new Array(o+1);l[0]=0;for(var u=0;u<o;++u)s+=a[u].value,l[u+1]=s;var c=function(t,e,i,n,r,o,s){if(t>=e-1){var u=a[t];return u.x0=n,u.y0=r,u.x1=o,void(u.y1=s)}for(var h=l[t],d=i/2+h,p=t+1,f=e-1;p<f;){var v=p+f>>>1;l[v]<d?p=v+1:f=v}d-l[p-1]<l[p]-d&&t+1<p&&--p;var g=l[p]-h,y=i-g;if(o-n>s-r){var m=i?(n*y+o*g)/i:o;c(t,p,g,n,r,m,s),c(p,e,y,m,r,o,s)}else{var _=i?(r*y+s*g)/i:s;c(t,p,g,n,r,o,_),c(p,e,y,n,_,o,s)}};c(0,o,t.value,e,i,n,r)},dice:rZ,slice:sZ,sliceDice:function(t,e,i,n,r){(t.depth%2==1?sZ:rZ)(t,e,i,n,r)}},cZ=function(){return o((function t(e){var i,n=this;r(this,t),this._filterByArea=function(t,e){var i,r=n._getMinAreaByDepth(t.depth);if(r>0&&t.value*e<r)return!1;if(null===(i=t.children)||void 0===i?void 0:i.length){var a=t.children.filter((function(t){return n._filterByArea(t,e)}));a.length?a.length!==t.children.length&&(t.children=a):(t.isLeaf=!0,t.children=null)}return!0},this._getMinAreaByDepth=function(t){var e;return t<0?0:null!==(e=q(n.options.minVisibleArea)?n.options.minVisibleArea[t]:n.options.minVisibleArea)&&void 0!==e?e:0},this._getGapWidthByDepth=function(t){var e;return t<0?0:null!==(e=q(n.options.gapWidth)?n.options.gapWidth[t]:n.options.gapWidth)&&void 0!==e?e:0},this._getPaddingByDepth=function(t){var e;return t<0?0:null!==(e=q(n.options.padding)?n.options.padding[t]:n.options.padding)&&void 0!==e?e:0},this._getLabelPaddingByDepth=function(t){var e;return t<0?0:null!==(e=q(n.options.labelPadding)?n.options.labelPadding[t]:n.options.labelPadding)&&void 0!==e?e:0},this._layoutNode=function(t){var e=n._getGapWidthByDepth(t.depth),i=t.x0,r=t.y0,a=t.x1,o=t.y1;if(t.maxDepth=n._maxDepth,e>0&&((i+=e/2)>(a-=e/2)&&(a=i=(i+a)/2),(r+=e/2)>(o-=e/2)&&(o=r=(r+o)/2),t.x0=i,t.x1=a,t.y0=r,t.y1=o),t.children){var s=n._getLabelPaddingByDepth(t.depth),l=n._getPaddingByDepth(t.depth);l>0&&l<Math.min(a-i,o-r)/2&&(r+=l,o-=l,i+=l,a-=l),s>0&&("top"===n.options.labelPosition&&r+s<o?(t.labelRect={x0:i,y0:r,x1:a,y1:r+s},r+=s):"bottom"===n.options.labelPosition&&o-s>r?(t.labelRect={x0:i,y0:o-s,x1:a,y1:o},o-=s):"left"===n.options.labelPosition&&i+s<a?(t.labelRect={x0:i,y0:r,x1:i+s,y1:o},i+=s):"right"===n.options.labelPosition&&a-s>i&&(t.labelRect={x0:a-s,y0:r,x1:a,y1:o},a-=s));var u=n._getGapWidthByDepth(t.depth+1);u>0&&(i-=u/2,a+=u/2,r-=u/2,o+=u/2),n._splitNode(t,i,r,a,o)}},this.options=Object.assign({},t.defaultOpionts,e);var a=this.options.nodeKey,o=V(a)?a:a?oe(a):null;this._getNodeKey=o,this._splitNode="squarify"===this.options.splitType?lZ(this.options.aspectRatio):null!==(i=uZ[this.options.splitType])&&void 0!==i?i:uZ.binary,this._maxDepth=-1}),[{key:"layout",value:function(t,e){var i;if(!t||!t.length)return[];var n="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)},r=[],a=Pq(t,r,0,-1,null,this._getNodeKey,this.options.valueField);if(this._maxDepth=a.maxDepth,a.sum<=0)return[];var o={flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:a.sum,datum:null,x0:n.x0,x1:n.x1,y0:n.y0,y1:n.y1,children:r},s=n.width*n.height/a.sum;return this._filterByArea(o,s),this._layout(o),null!==(i=o.children)&&void 0!==i?i:[]}},{key:"_filterChildren",value:function(t){var e=this.options.maxDepth;if(Q(e)&&e>=0&&t.depth>=e)return!1;var i=this.options.minChildrenVisibleArea;if(Q(i)&&Math.abs((t.x1-t.x0)*(t.y1-t.y0))<i)return!1;var n=this.options.minChildrenVisibleSize;return!Q(n)||!(Math.abs(t.x1-t.x0)<n||Math.abs(t.y1-t.y0)<n)}},{key:"_layout",value:function(t){var e,i=this;this._filterChildren(t)||(t.children=null,t.isLeaf=!0),this._layoutNode(t),(null===(e=t.children)||void 0===e?void 0:e.length)&&t.children.forEach((function(t){var e;(null===(e=null==t?void 0:t.children)||void 0===e?void 0:e.length)?i._layout(t):i._layoutNode(t)}))}}])}();function hZ(t,e,i){return Math.min(t,e)*Math.min(t,e)*Math.PI<=i+Ni?Math.abs(t-e):function(t,e,i,n){var r,a,o=null!==(r=null==n?void 0:n.maxIterations)&&void 0!==r?r:100,s=null!==(a=null==n?void 0:n.tolerance)&&void 0!==a?a:1e-10,l=t(e),u=t(i),c=i-e;if(l*u>0)return Ot.getInstance().error("Initial bisect points must have opposite signs"),NaN;if(0===l)return e;if(0===u)return i;for(var h=0;h<o;++h){var d=e+(c/=2),p=t(d);if(p*l>=0&&(e=d),Math.abs(c)<s||0===p)return d}return e+c}((function(n){return Ui(t,e,n)-i}),0,t+e)}function dZ(t,e){var i,n=(e=e||{}).restarts||10,r=[],a={};for(i=0;i<t.length;++i){var o=t[i];1===o.sets.length&&(a[o.sets[0]]=r.length,r.push(o))}var s=function(t,e,i){var n=rn(e.length,e.length),r=rn(e.length,e.length);return t.filter((function(t){return 2===t.sets.length})).map((function(t){var a=i[t.sets[0]],o=i[t.sets[1]],s=hZ(Math.sqrt(e[a].size/Math.PI),Math.sqrt(e[o].size/Math.PI),t.size);n[a][o]=n[o][a]=s;var l=0;t.size+1e-10>=Math.min(e[a].size,e[o].size)?l=1:t.size<=1e-10&&(l=-1),r[a][o]=r[o][a]=l})),{distances:n,constraints:r}}(t,r,a),l=s.distances,u=s.constraints,c=an(l.map(an))/l.length;l=l.map((function(t){return t.map((function(t){return t/c}))}));var h,d,p=function(t,e){return function(t,e,i,n){var r,a=0;for(r=0;r<e.length;++r)e[r]=0;for(r=0;r<i.length;++r)for(var o=t[2*r],s=t[2*r+1],l=r+1;l<i.length;++l){var u=t[2*l],c=t[2*l+1],h=i[r][l],d=n[r][l],p=(u-o)*(u-o)+(c-s)*(c-s),f=Math.sqrt(p),v=p-h*h;d>0&&f<=h||d<0&&f>=h||(a+=2*v*v,e[2*r]+=4*v*(o-u),e[2*r+1]+=4*v*(s-c),e[2*l]+=4*v*(u-o),e[2*l+1]+=4*v*(c-s))}return a}(t,e,l,u)};for(i=0;i<n;++i){var f=nn(2*l.length).map((function(t,e){return ie(e)}));d=cn(p,f,e),(!h||d.fx<h.fx)&&(h=d)}var v=h.x,g={};for(i=0;i<r.length;++i){var y=r[i];g[y.sets[0]]={x:v[2*i]*c,y:v[2*i+1]*c,radius:Math.sqrt(y.size/Math.PI)}}if(e.history)for(i=0;i<e.history.length;++i)on(e.history[i].x,c);return g}function pZ(t,e){for(var i=0,n=0;n<e.length;++n){var r=e[n],a=void 0;if(1!==r.sets.length){if(2===r.sets.length){var o=t[r.sets[0]],s=t[r.sets[1]];a=Ui(o.radius,s.radius,Oe.distancePP(o,s))}else a=Vi(r.sets.map((function(e){return t[e]})));i+=(r.hasOwnProperty("weight")?r.weight:1)*(a-r.size)*(a-r.size)}}return i}function fZ(t,e){var i=function(t,e){for(var i=e&&e.lossFunction?e.lossFunction:pZ,n={},r={},a=0;a<t.length;++a){var o=t[a];if(1===o.sets.length){var s=o.sets[0];n[s]={x:1e10,y:1e10,size:o.size,radius:Math.sqrt(o.size/Math.PI),setId:s},r[s]=[]}}t=t.filter((function(t){return 2===t.sets.length}));for(var l=0;l<t.length;++l){var u=t[l],c=u.hasOwnProperty("weight")?u.weight:1,h=u.sets[0],d=u.sets[1];u.size+Ni>=Math.min(n[h].size,n[d].size)&&(c=0),r[h].push({set:d,size:u.size,weight:c}),r[d].push({set:h,size:u.size,weight:c})}var p=[];for(var f in r)if(r.hasOwnProperty(f)){for(var v=0,g=0;g<r[f].length;++g)v+=r[f][g].size*r[f][g].weight;p.push({set:f,size:v})}function y(t,e){return e.size-t.size}p.sort(y);var m={};function _(t){return t.set in m}function b(t,e){n[e].x=t.x,n[e].y=t.y,m[e]=!0}b({x:0,y:0},p[0].set);for(var x=1;x<p.length;++x){var k=p[x].set,S=r[k].filter(_),A=n[k];if(S.sort(y),0===S.length)throw"ERROR: missing pairwise overlap information";for(var M=[],T=0;T<S.length;++T){var w=n[S[T].set],C=hZ(A.radius,w.radius,S[T].size);M.push({x:w.x+C,y:w.y}),M.push({x:w.x-C,y:w.y}),M.push({y:w.y+C,x:w.x}),M.push({y:w.y-C,x:w.x});for(var E=T+1;E<S.length;++E)for(var P=n[S[E].set],B=hZ(A.radius,P.radius,S[E].size),R=Wi({x:w.x,y:w.y,radius:C},{x:P.x,y:P.y,radius:B}),L=0;L<R.length;++L)M.push(R[L])}for(var I=1e50,D=M[0],O=0;O<M.length;++O){n[k].x=M[O].x,n[k].y=M[O].y;var F=i(n,t);F<I&&(I=F,D=M[O])}b(D,k)}return n}(t,e),n=e.lossFunction||pZ;if(t.length>=8){var r=dZ(t,e);n(r,t)+1e-8<n(i,t)&&(i=r)}return i}function vZ(t,e,i){var n;if(null===i?t.sort((function(t,e){return e.radius-t.radius})):t.sort(i),t.length>0){var r=t[0].x,a=t[0].y;for(n=0;n<t.length;++n)t[n].x-=r,t[n].y-=a}if(2===t.length&&Oe.distancePP(t[0],t[1])<Math.abs(t[1].radius-t[0].radius)&&(t[1].x=t[0].x+t[0].radius-t[1].radius-1e-10,t[1].y=t[0].y),t.length>1){var o,s,l=Math.atan2(t[1].x,t[1].y)-e,u=Math.cos(l),c=Math.sin(l);for(n=0;n<t.length;++n)o=t[n].x,s=t[n].y,t[n].x=u*o-c*s,t[n].y=c*o+u*s}if(t.length>2){for(var h=Math.atan2(t[2].x,t[2].y)-e;h<0;)h+=2*Math.PI;for(;h>2*Math.PI;)h-=2*Math.PI;if(h>Math.PI){var d=t[1].y/(1e-10+t[1].x);for(n=0;n<t.length;++n){var p=(t[n].x+d*t[n].y)/(1+d*d);t[n].x=2*p-t[n].x,t[n].y=2*p*d-t[n].y}}}}function gZ(t){var e=function(e){return{max:Math.max.apply(null,t.map((function(t){return t[e]+t.radius}))),min:Math.min.apply(null,t.map((function(t){return t[e]-t.radius})))}};return{xRange:e("x"),yRange:e("y")}}function yZ(t,e,i){null===e&&(e=Math.PI/2);var n=[];for(var r in t)if(t.hasOwnProperty(r)){var a=t[r];n.push({x:a.x,y:a.y,radius:a.radius,setId:r})}for(var o=function(t){function e(t){return t.parent!==t&&(t.parent=e(t.parent)),t.parent}t.map((function(t){t.parent=t}));for(var i=0;i<t.length;++i)for(var n=i+1;n<t.length;++n){var r=t[i].radius+t[n].radius;Oe.distancePP(t[i],t[n])+1e-10<r&&(a=t[n],o=t[i],s=void 0,l=void 0,s=e(a),l=e(o),s.parent=l)}for(var a,o,s,l,u,c={},h=0;h<t.length;++h)(u=e(t[h]).parent.setId)in c||(c[u]=[]),c[u].push(t[h]);t.map((function(t){delete t.parent}));var d=[];for(u in c)c.hasOwnProperty(u)&&d.push(c[u]);return d}(n),s=0;s<o.length;++s){vZ(o[s],e,i);var l=gZ(o[s]);o[s].size=(l.xRange.max-l.xRange.min)*(l.yRange.max-l.yRange.min),o[s].bounds=l}o.sort((function(t,e){return e.size-t.size}));var u=(n=o[0]).bounds,c=(u.xRange.max-u.xRange.min)/50;function h(t,e,i){if(t){var r,a,o,s=t.bounds;e?r=u.xRange.max-s.xRange.min+c:(r=u.xRange.max-s.xRange.max,(o=(s.xRange.max-s.xRange.min)/2-(u.xRange.max-u.xRange.min)/2)<0&&(r+=o)),i?a=u.yRange.max-s.yRange.min+c:(a=u.yRange.max-s.yRange.max,(o=(s.yRange.max-s.yRange.min)/2-(u.yRange.max-u.yRange.min)/2)<0&&(a+=o));for(var l=0;l<t.length;++l)t[l].x+=r,t[l].y+=a,n.push(t[l])}}for(var d=1;d<o.length;)h(o[d],!0,!1),h(o[d+1],!1,!0),h(o[d+2],!0,!0),d+=3,u=gZ(n);for(var p={},f=0;f<n.length;++f)p[n[f].setId]=n[f];return p}function mZ(t,e){for(var i={},n=function(t){var e={},i=[];for(var n in t)i.push(n),e[n]=[];for(var r=0;r<i.length;r++)for(var a=t[i[r]],o=r+1;o<i.length;++o){var s=t[i[o]],l=Oe.distancePP(a,s);l+s.radius<=a.radius+1e-10?e[i[o]].push(i[r]):l+a.radius<=s.radius+1e-10&&e[i[r]].push(i[o])}return e}(t),r=0;r<e.length;++r){for(var a=e[r].sets,o={},s={},l=0;l<a.length;++l){o[a[l]]=!0;for(var u=n[a[l]],c=0;c<u.length;++c)s[u[c]]=!0}var h=[],d=[];for(var p in t)p in o?h.push(t[p]):p in s||d.push(t[p]);var f=_Z(h,d);i[a.toString()]=f,f.disjoint&&e[r].size>0&&Ot.getInstance().error("Area "+a+" not represented on screen")}return i}function _Z(t,e){for(var i=[],n=0;n<t.length;++n){var r=t[n];i.push({x:r.x,y:r.y}),i.push({x:r.x+r.radius/2,y:r.y}),i.push({x:r.x-r.radius/2,y:r.y}),i.push({x:r.x,y:r.y+r.radius/2}),i.push({x:r.x,y:r.y-r.radius/2})}for(var a=i[0],o=bZ(i[0],t,e),s=1;s<i.length;++s){var l=bZ(i[s],t,e);l>=o&&(a=i[s],o=l)}for(var u=ln((function(i){return-1*bZ({x:i[0],y:i[1]},t,e)}),[a.x,a.y],{maxIterations:500,minErrorDelta:1e-10}).x,c={x:u[0],y:u[1]},h=!0,d=0;d<t.length;++d)if(Oe.distancePP(c,t[d])>t[d].radius){h=!1;break}for(var p=0;p<e.length;++p)if(Oe.distancePP(c,e[p])<e[p].radius){h=!1;break}if(!h)if(1===t.length)c={x:t[0].x,y:t[0].y};else{var f={};Vi(t,f),c=0===f.arcs.length?{x:0,y:-1e3,disjoint:!0}:1===f.arcs.length?{x:f.arcs[0].circle.x,y:f.arcs[0].circle.y}:e.length?_Z(t,[]):Gi(f.arcs.map((function(t){return t.p1})))}return c}function bZ(t,e,i){var n,r,a=e[0].radius-Oe.distancePP(e[0],t);for(n=1;n<e.length;++n)(r=e[n].radius-Oe.distancePP(e[n],t))<=a&&(a=r);for(n=0;n<i.length;++n)(r=Oe.distancePP(i[n],t)-i[n].radius)<=a&&(a=r);return a}cZ.defaultOpionts={aspectRatio:(1+Math.sqrt(5))/2,gapWidth:0,labelPadding:0,labelPosition:"top",splitType:"binary",minVisibleArea:10};var xZ=function(t){var e={},i=Object.values(t);if(!i.length)return[];Vi(i,e);for(var n=e.arcs.map((function(t){var e=t.p1,i=t.p2,n=t.circle,r=t.width;return{p1:e,p2:i,radius:n.radius,setId:n.setId,largeArcFlag:r>n.radius}})),r=[],a=0,o=n[0],s=function(){var t=o.p2;r.push(o),o=n.find((function(e){return Oe.distancePP(e.p1,t)<Ni})),a++};a<n.length&&o;)s();return r},kZ=function(t){if(!(null==t?void 0:t.length))return"";for(var e=0,i=t[0],n=i.p1,r="M".concat(n.x,",").concat(n.y);i;){var a=i,o=a.p2,s=a.radius,l=a.largeArcFlag;r+="A".concat(s,",").concat(s," 0 ").concat(l?1:0,",0 ").concat(o.x,",").concat(o.y),i=t[++e]}return r+=" Z"},SZ=function(t){var e;return null!==(e=null==t?void 0:t.map((function(t){var e=t.p1,i=t.p2,n=t.radius,r=t.largeArcFlag,a=t.setId,o=e.x,s=e.y,l=i.x,u=i.y,c=Math.pow(Math.pow(l-o,2)+Math.pow(u-s,2),.5),h=(o+l)/2,d=(s+u)/2,p=Math.pow(Math.pow(n,2)-Math.pow(c/2,2),.5),f=h+p*(u-s)/c,v=d-p*(l-o)/c;return(Ee([l-o,u-s],[f-o,v-s])>0||r)&&(f=h-p*(u-s)/c,v=d+p*(l-o)/c),{x:f,y:v,radius:n,setId:a}})))&&void 0!==e?e:[]},AZ=function(t,e){var i=t.x0,n=t.x1,r=t.y0,a=t.y1,o=t.setField,s=void 0===o?"sets":o,l=t.valueField,u=void 0===l?"size":l,c=t.orientation,h=void 0===c?Math.PI/2:c,d=t.orientationOrder,p=void 0===d?null:d,f={},v={};if(e.length>0){var g=e.map((function(t){return{sets:St(t[s]),size:t[u]}})),y=function(t,e){(e=e||{}).maxIterations=e.maxIterations||500;var i=e.initialLayout||fZ,n=e.lossFunction||pZ,r=i(t=function(t){t=t.slice();for(var e=[],i={},n=0;n<t.length;++n){var r=t[n];if(1===r.sets.length)e.push(r.sets[0]);else if(2===r.sets.length){var a=r.sets[0],o=r.sets[1];i[[a,o].toString()]=!0,i[[o,a].toString()]=!0}}e.sort((function(t,e){return+(t>e)}));for(var s=0;s<e.length;++s)for(var l=e[s],u=s+1;u<e.length;++u){var c=e[u];[l,c].toString()in i||t.push({sets:[l,c],size:0})}return t}(t),e),a=[],o=[];for(var s in r)r.hasOwnProperty(s)&&(a.push(r[s].x),a.push(r[s].y),o.push(s));for(var l=ln((function(e){for(var i={},a=0;a<o.length;++a){var s=o[a];i[s]={x:e[2*a],y:e[2*a+1],radius:r[s].radius}}return n(i,t)}),a,e).x,u=0;u<o.length;++u){var c=o[u];r[c].x=l[2*u],r[c].y=l[2*u+1]}return r}(g,t);y=yZ(y,h,p),f=function(t,e,i,n,r){e=Math.max(e,1),i=Math.max(i,1);var a=[],o=[];for(var s in t)t.hasOwnProperty(s)&&(o.push(s),a.push(t[s]));var l=gZ(a),u=l.xRange,c=l.yRange;if(u.max===u.min||c.max===c.min)return console.log("not scaling solution: zero size detected"),t;for(var h=e/(u.max-u.min),d=i/(c.max-c.min),p=Math.min(d,h),f=(e-(u.max-u.min)*p)/2,v=(i-(c.max-c.min)*p)/2,g={},y=0;y<a.length;++y){var m=a[y];g[o[y]]={radius:p*m.radius,x:n+f+(m.x-u.min)*p,y:r+v+(m.y-c.min)*p,setId:m.setId}}return g}(y,n-i,a-r,i,r),v=mZ(f,g)}return e.map((function(t){var e=St(t[s]),i=e.toString(),n=v[i],r=Object.assign(Object.assign({},t),{datum:t,sets:e,key:i,size:t[u],labelX:null==n?void 0:n.x,labelY:null==n?void 0:n.y}),a=f[i];if(a)return Object.assign(Object.assign({},r),{type:"circle",x:a.x,y:a.y,radius:a.radius});var o=xZ(e.map((function(t){return f[t]})));return Object.assign(Object.assign({},r),{type:"overlap",x:0,y:0,path:kZ(o),arcs:o})}))},MZ=function(t,e){return e.filter((function(e){return e.type===t.datumType}))},TZ={triangleForward:function(){return function(t){var e=t%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}},triangleUpright:wZ,triangle:wZ,diamond:function(){return function(t){var e=t%(2*Math.PI/4);return 1/(Math.cos(e)+Math.sin(e))}},square:function(){return function(t){return Math.min(1/Math.abs(Math.cos(t)),1/Math.abs(Math.sin(t)))}},star:function(){return function(t){var e=(t+.955)%(2*Math.PI/10);return(t+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-e)+3.07768*Math.sin(2*Math.PI/10-e)):1/(Math.cos(e)+3.07768*Math.sin(e))}},cardioid:function(){return function(t){return 1+Math.sin(t)}},circle:function(){return function(){return 1}},pentagon:function(){return function(t){var e=(t+.955)%(2*Math.PI/5);return 1/(Math.cos(e)+.726543*Math.sin(e))}}};function wZ(){return function(t){var e=(t+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}}function CZ(t,e){var i=e[0],n=e[1],r=1,a=[e[0]>>1,e[1]>>1];switch(t){case"cardioid":a[1]=~~(n/2.7*.4),r=Math.floor(Math.min(i/2.3,n/2.6));break;case"triangleForward":r=n/Math.sqrt(.75)>i?Math.floor(i/2):Math.floor(n/(2*Math.sqrt(.75)));break;case"triangle":case"triangleUpright":a[1]=~~(n/1.5),r=Math.floor(Math.min(n/1.5,i/2));break;case"circle":case"diamond":case"square":case"star":case"pentagon":r=Math.floor(Math.min(i/2,n/2));break;default:r=Math.floor(Math.max(i/2,n/2))}return{maxRadius:r,center:a}}var EZ=function(t){return TZ[t]?TZ[t]():TZ.circle()},PZ=function(t,e){return"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(e-t)+t).toFixed()+"%)"};function BZ(t){return V(t)?t:function(){return t}}var RZ=function(){return o((function t(e){var i,n,a=this;switch(r(this,t),this.options=gt({},t.defaultOptions,e),V(this.options.shape)?this.shape=this.options.shape:this.shape=EZ(this.options.shape),this.getText=null!==(i=BZ(this.options.text))&&void 0!==i?i:function(t){return t},this.getTextFontWeight=BZ(this.options.fontWeight),this.getTextFontSize=BZ(this.options.fontSize),this.getTextFontStyle=BZ(this.options.fontStyle),this.getTextFontFamily=BZ(this.options.fontFamily),this.outputCallback=null!==(n=this.options.outputCallback)&&void 0!==n?n:function(t){return t},this.options.color){case"random-dark":this.getTextColor=function(){return PZ(10,50)};break;case"random-light":this.getTextColor=function(){return PZ(50,90)};break;default:this.getTextColor=BZ(this.options.color)}if(j(this.options.rotate))if(this.options.useRandomRotate){var o=Math.abs(this.options.maxRotation-this.options.minRotation),s=Math.abs(Math.floor(this.options.rotationSteps)),l=Math.min(this.options.maxRotation,this.options.minRotation);this.getTextRotate=function(){return 0===a.options.rotateRatio||Math.random()>a.options.rotateRatio?0:0===o?l:s>0?l+Math.floor(Math.random()*s)*o/(s-1):l+Math.random()*o}}else this.getTextRotate=function(){return 0};else this.getTextRotate=V(this.options.rotate)?function(t){var e;return Fe(null!==(e=a.options.rotate(t))&&void 0!==e?e:0)}:function(t,e){var i=St(a.options.rotate),n=a.options.random?Math.random():ie(e);return Fe(i[Math.floor(n*i.length)])}}),[{key:"canRepeat",value:function(){return!1}},{key:"exceedTime",value:function(){var t;return this.options.progressiveStep>0?this.progressiveIndex>=((null!==(t=this.currentStepIndex)&&void 0!==t?t:-1)+1)*this.options.progressiveStep:this.options.progressiveTime>0&&(new Date).getTime()-this.escapeTime>this.options.progressiveTime}},{key:"progressiveRun",value:function(){var t;if(this.options.progressiveStep>0?this.currentStepIndex=(null!==(t=this.currentStepIndex)&&void 0!==t?t:-1)+1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.data&&this.progressiveIndex<this.data.length){this.progressiveResult=[];for(var e=this.progressiveIndex,i=0,n=this.options.maxSingleWordTryCount,r=Math.min(this.options.maxFailCount,this.originalData.length);e<this.data.length&&this.failCount<r;){var a=this.layoutWord(e);if(i++,(a||i>n)&&(e++,i=0,this.failCount=a?0:this.failCount+1),this.progressiveIndex=e,this.exceedTime())break;e===this.data.length&&this.failCount<r&&this.options.repeatFill&&this.canRepeat()&&(this.data=[].concat(b(this.data),b(this.originalData.map((function(t){return Object.assign(Object.assign({},t),{isFill:!0})})))),this.isTryRepeatFill=!0)}return this.progressiveResult}return this.result}},{key:"initProgressive",value:function(){this.failCount=0,this.progressiveIndex=0,this.options.progressiveStep>0?this.currentStepIndex=-1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.progressiveResult=[]}},{key:"output",value:function(){return this.result?this.outputCallback(this.result):null}},{key:"progressiveOutput",value:function(){return this.progressiveResult?this.outputCallback(this.progressiveResult):null}},{key:"unfinished",value:function(){return this.data&&this.data.length&&!j(this.progressiveIndex)&&this.progressiveIndex<this.data.length}},{key:"release",value:function(){this.data=null,this.result=null,this.progressiveIndex=null,this.progressiveResult=null}}])}();RZ.defaultOptions={fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",fontStyle:"normal",minFontSize:12,drawOutOfBound:!1,shrink:!1,minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationSteps:0,rotateRatio:.1,random:!1,shape:"circle",progressiveTime:0,progressiveStep:0,repeatFill:!1,fillTextFontSize:12,maxFailCount:20};var LZ={archimedean:function(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}},rectangular:function(t){var e=4*t[0]/t[1],i=0,n=0;return function(t){var r=t<0?-1:1;switch(Math.sqrt(1+4*r*t)-r&3){case 0:i+=e;break;case 1:n+=4;break;case 2:i-=e;break;default:n-=4}return[i,n]}}};var IZ=function(t){function e(t){var i,a;return r(this,e),(i=n(this,e,[gt({},e.defaultOptions,t)])).cw=64,i.ch=2048,i._size=[256,256],i._isBoardExpandCompleted=!1,i._placeStatus=0,i._tTemp=null,i._dtTemp=null,i._dy=0,i.cacheMap=new Map,i.options.minFontSize<=e.defaultOptions.minFontSize&&(i.options.minFontSize=e.defaultOptions.minFontSize),i.spiral=K(i.options.spiral)?null!==(a=LZ[i.options.spiral])&&void 0!==a?a:LZ.archimedean:i.options.spiral,i.random=i.options.random?Math.random:function(){return 1},i.getTextPadding=BZ(i.options.padding),i}return h(e,t),o(e,[{key:"zoomRatio",value:function(){return this._originSize[0]/this._size[0]}},{key:"dy",value:function(){return this._dy}},{key:"layoutWord",value:function(t){var e=this.data[t];if(""===(""+e.text).trim())return!0;var i=CZ(this.options.shape,this._size),n=i.maxRadius,r=i.center;if(e.x=r[0],e.y=r[1],function(t,e,i,n,r,a){if(e.sprite)return;var o=t.context,s=t.ratio;o.setTransform(s,0,0,s,0,0),o.clearRect(0,0,(r<<5)/s,a/s);var l,u,c,h,d,p=0,f=0,v=0,g=i.length;for(--n;++n<g;){if(e=i[n],o.save(),o.font=e.fontStyle+" "+e.fontWeight+" "+~~((e.fontSize+1)/s)+"px "+e.fontFamily,l=o.measureText(e.text+"m").width*s,c=e.fontSize<<1,e.angle){var y=Math.sin(e.angle),m=Math.cos(e.angle),_=l*m,b=l*y,x=c*m,k=c*y;l=Math.max(Math.abs(_+k),Math.abs(_-k))+31>>5<<5,c=~~Math.max(Math.abs(b+x),Math.abs(b-x))}else l=l+31>>5<<5;if(c>v&&(v=c),p+l>=r<<5&&(p=0,f+=v,v=0),f+c>=a)break;o.translate((p+(l>>1))/s,(f+(c>>1))/s),e.angle&&o.rotate(e.angle),o.fillText(e.text,0,0),e.padding&&(o.lineWidth=2*e.padding,o.strokeText(e.text,0,0)),o.restore(),e.width=l,e.height=c,e.xoff=p,e.yoff=f,e.x1=l>>1,e.y1=c>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,p+=l}for(var S=o.getImageData(0,0,(r<<5)/s,a/s).data,A=[];--n>=0;)if((e=i[n]).hasText){for(u=(l=e.width)>>5,c=e.y1-e.y0,h=0;h<c*u;h++)A[h]=0;if(null==(p=e.xoff))return;f=e.yoff;var M=0,T=-1;for(d=0;d<c;d++){for(h=0;h<l;h++){var w=u*d+(h>>5),C=S[(f+d)*(r<<5)+(p+h)<<2]?1<<31-h%32:0;A[w]|=C,M|=C}M?T=d:(e.y0++,c--,d--,f++)}e.y1=e.y0+T,e.sprite=A.slice(0,(e.y1-e.y0)*u)}}(this.contextAndRatio,e,this.data,t,this.cw,this.ch),this._placeStatus=0,e.hasText&&this.place(this._board,e,this._bounds,n))return this.result.push(e),this._bounds?function(t,e){var i=t[0],n=t[1];e.x+e.x0<i.x&&(i.x=e.x+e.x0),e.y+e.y0<i.y&&(i.y=e.y+e.y0),e.x+e.x1>n.x&&(n.x=e.x+e.x1),e.y+e.y1>n.y&&(n.y=e.y+e.y1)}(this._bounds,e):this._bounds=[{x:e.x+e.x0,y:e.y+e.y0},{x:e.x+e.x1,y:e.y+e.y1}],e.x-=this._size[0]>>1,e.y-=this._size[1]>>1,this._tTemp=null,this._dtTemp=null,!0;if(this.updateBoardExpandStatus(e.fontSize),e.hasText&&this.shouldShrinkContinue()){if(1===this._placeStatus){var a=e.fontSize*this._originSize[0]/this.options.minFontSize,o=Math.max(e.width,e.height);if(o<=a)this.expandBoard(this._board,this._bounds,o/this._size[0]);else{if(!this.options.clip)return!0;this.expandBoard(this._board,this._bounds,a/this._size[0])}}else this._placeStatus,this.expandBoard(this._board,this._bounds);return this.updateBoardExpandStatus(e.fontSize),!1}return this._tTemp=null,this._dtTemp=null,!0}},{key:"layout",value:function(t,e){var i=this;this.initProgressive(),this.result=[],this._size=[e.width,e.height],this.clearCache(),this._originSize=b(this._size);var n=this.getContext(this.options.createCanvas({width:1,height:1}));this.contextAndRatio=n,this._board=new Array((this._size[0]>>5)*this._size[1]).fill(0),this._bounds=null,t.length,this.result=[];var r=t.map((function(t,e){return{text:i.getText(t),fontFamily:i.getTextFontFamily(t),fontStyle:i.getTextFontStyle(t),fontWeight:i.getTextFontWeight(t),angle:i.getTextRotate(t,e),fontSize:~~i.getTextFontSize(t),padding:i.getTextPadding(t),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:t,x:0,y:0,width:0,height:0}})).sort((function(t,e){return e.fontSize-t.fontSize}));if(this.originalData=r,this.data=r,this.progressiveRun(),!this.options.clip&&this.options.enlarge&&this._bounds&&this.shrinkBoard(this._bounds),this._bounds&&["cardioid","triangle","triangle-upright"].includes(this.options.shape)){var a=(this._bounds[0].y+this._bounds[1].y)/2;this._dy=-(a-this._originSize[1]/2)}return this.result}},{key:"formatTagItem",value:function(t){for(var e,i,n=this._size,r=this.zoomRatio(),a=this.dy(),o=n[0]>>1,s=n[1]>>1,l=t.length,u=[],c=0;c<l;++c)e=t[c],(i={}).datum=e.datum,i.x=(e.x+o)*r,i.y=(e.y+s+a)*r,i.fontFamily=e.fontFamily,i.fontSize=e.fontSize*r,i.fontStyle=e.fontStyle,i.fontWeight=e.fontWeight,i.angle=e.angle,u.push(i);return u}},{key:"output",value:function(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.result)):this.formatTagItem(this.result)}},{key:"progressiveOutput",value:function(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.progressiveResult)):this.formatTagItem(this.progressiveResult)}},{key:"updateBoardExpandStatus",value:function(t){this._isBoardExpandCompleted=t*(this._originSize[0]/this._size[0])<this.options.minFontSize}},{key:"shouldShrinkContinue",value:function(){return!this.options.clip&&this.options.shrink&&!this._isBoardExpandCompleted}},{key:"shrinkBoard",value:function(t){var e=t[0],i=t[1];if(!(i.x>=this._size[0]||i.y>=this._size[1])){var n=Math.min(e.x,this._size[0]-i.x),r=Math.min(e.y,this._size[1]-i.y),a=2*Math.min(n/this._size[0],r/this._size[1]);this._size=this._size.map((function(t){return t*(1-a)}))}}},{key:"expandBoard",value:function(t,e,i){var n=this._size[0]*(i||1.1)-this._size[0]>>5,r=2*n>2?n:2;r%2!=0&&r++;var a=Math.ceil(this._size[1]*(r<<5)/this._size[0]);a%2!=0&&a++;var o=this._size[0],s=this._size[1],l=new Array(r).fill(0),u=new Array(a/2*(r+(o>>5))).fill(0);this.insertZerosToArray(t,s*(o>>5),u.length+r/2);for(var c=s-1;c>0;c--)this.insertZerosToArray(t,c*(o>>5),l.length);this.insertZerosToArray(t,0,u.length+r/2),this._size=[o+(r<<5),s+a],e&&(e[0].x+=(r<<5)/2,e[0].y+=a/2,e[1].x+=(r<<5)/2,e[1].y+=a/2)}},{key:"insertZerosToArray",value:function(t,e,i){if(this.options.customInsertZerosToArray)return this.options.customInsertZerosToArray(t,e,i);for(var n=Math.floor(i/6e4),r=i%6e4,a=0;a<n;a++)t.splice.apply(t,[e+6e4*a,0].concat(b(new Array(6e4).fill(0))));t.splice.apply(t,[e+6e4*n,0].concat(b(new Array(r).fill(0))))}},{key:"getContext",value:function(t){t.width=1,t.height=1;var e=t.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,1,1),i=Math.sqrt(e.data.length>>2);t.width=(this.cw<<5)/i,t.height=this.ch/i;var n=t.getContext("2d",{willReadFrequently:!0});return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:i,canvas:t}}},{key:"place",value:function(t,e,i,n){var r=!1;if(this.shouldShrinkContinue()&&(e.width>this._size[0]||e.height>this._size[1]))return this._placeStatus=1,!1;var a=this.random()<.5?1:-1;if(!this.shouldShrinkContinue()&&this.isSizeLargerThanMax(e,a))return null;var o,s,l,u,c=e.x,h=e.y,d=Math.sqrt(this._size[0]*this._size[0]+this._size[1]*this._size[1]),p=this.spiral(this._size),f=-a;for(this._tTemp=null,this._dtTemp=null;o=p(f+=a);){s=o[0],l=o[1];var v=Math.sqrt(Math.pow(s,2)+Math.pow(l,2)),g=Math.atan(l/s);s<0?g+=Math.PI:l<0&&(g=2*Math.PI+g);var y=this.shape(g);if(Math.min(Math.abs(s),Math.abs(l))>=d)break;if(v>=n)r&&null===this._tTemp&&(this._tTemp=f,this._dtTemp=a);else{if(e.x=c+~~(v*y*Math.cos(-g)),e.y=h+~~(v*y*Math.sin(-g)),u=e,this.options.clip)if(this.shouldShrinkContinue()){if(zZ(u,this._size)){r&&null===this._tTemp&&(this._tTemp=f,this._dtTemp=a);continue}}else{if(FZ(u,this._size)){r&&null===this._tTemp&&(this._tTemp=f,this._dtTemp=a);continue}zZ(u,this._size)&&(u=HZ(u,this._size))}else if(zZ(u,this._size)){r&&null===this._tTemp&&(this._tTemp=f,this._dtTemp=a);continue}if(r=!0,(!i||OZ(u,i))&&(!i||!DZ(u,t,this._size))){for(var m=u.sprite,_=u.width>>5,b=this._size[0]>>5,x=u.x-(_<<4),k=127&x,S=32-k,A=u.y1-u.y0,M=void 0,T=(u.y+u.y0)*b+(x>>5),w=0;w<A;w++){M=0;for(var C=0;C<=_;C++)t[T+C]|=M<<S|(C<_?(M=m[w*_+C])>>>k:0);T+=b}return e.sprite=null,u.sprite=null,!0}}}return null!==this._tTemp&&(this._placeStatus=3),!this.shouldShrinkContinue()&&this.setCache(u,a),!1}},{key:"clearCache",value:function(){this.cacheMap.clear()}},{key:"setCache",value:function(t,e){var i="".concat(t.angle,"-").concat(e),n=t.x1-t.x0,r=t.y1-t.y0;if(this.cacheMap.has(i)){var a=this.cacheMap.get(i),o=a.width,s=a.height;(n<o&&r<s||n<=o&&r<s)&&this.cacheMap.set(i,{width:n,height:r})}else this.cacheMap.set(i,{width:n,height:r})}},{key:"isSizeLargerThanMax",value:function(t,e){var i="".concat(t.angle,"-").concat(e);if(!this.cacheMap.has(i))return!1;var n=this.cacheMap.get(i),r=n.width,a=n.height,o=t.x1-t.x0,s=t.y1-t.y0;return o>=r&&s>=a}}])}(RZ);function DZ(t,e,i){for(var n,r=i[0]>>5,a=t.sprite,o=t.width>>5,s=t.x-(o<<4),l=127&s,u=32-l,c=t.y1-t.y0,h=(t.y+t.y0)*r+(s>>5),d=0;d<c;d++){n=0;for(var p=0;p<=o;p++)if((n<<u|(p<o?(n=a[d*o+p])>>>l:0))&e[h+p])return!0;h+=r}return!1}function OZ(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}IZ.defaultOptions={enlarge:!1,minFontSize:2,maxSingleWordTryCount:2};var FZ=function(t,e){return t.x+t.x0>e[0]||t.y+t.y0>e[0]||t.x+t.x1<0||t.y+t.y1<0},zZ=function(t,e){return t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>e[0]||t.y+t.y1>e[1]};function HZ(t,e){for(var i=t.sprite,n=t.y1-t.y0,r=t.width>>5,a=0,o=[],s=Math.max(-(t.y0+t.y),0),l=Math.min(n+(e[1]-(t.y1+t.y)),n),u=Math.max(-(t.x0+t.x),0)>>5,c=Math.min(r+(e[0]-(t.x1+t.x)>>5)+1,r),h=0;h<n;h++){for(var d=0;d<r;d++)h<s||l<=h||d<u||c<=d||o.push(i[a+d]);a+=r}var p=u<<5,f=r-c<<5,v=s,g=n-l;return Object.assign(Object.assign({},t),{width:t.width-p-f,height:t.height-v-g,x0:t.x0+p,x1:t.x1-f,y0:t.y0+v,y1:t.y1-g,x:t.x+p/2-f/2,sprite:o})}var NZ=function(t,e,i){var n=null!=e?e:{},r=n.threshold,a=n.invert,o=void 0!==a&&a;if(!t||"#fff"===t)return function(t,e,i){var n=t.width;if(0===t.data[e*n*4+4*i+3])return!o;var a=t.data[e*n*4+4*i+0],s=t.data[e*n*4+4*i+1],l=t.data[e*n*4+4*i+2];if(255===a&&255===s&&255===l)return!o;if(et(r)){var u=.3*a+.59*s+.11*l;return o?u<=r:u>=r}return!1};var s=i({width:1,height:1}).getContext("2d",{willReadFrequently:!0});s.fillStyle=t,s.fillRect(0,0,1,1);var l=s.getImageData(0,0,1,1).data;return function(t,e,i){var n=t.width;return[0,1,2,3].every((function(r){return o?t.data[4*(e*n+i)+r]!==l[r]:t.data[4*(e*n+i)+r]===l[r]}))}},VZ=function(t,e,i,n){var r,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,s=t.backgroundColor,l=void 0===s?"#fff":s,u=t.fill,c=void 0===u?"#000":u;a&&(l=(r=[c,l])[0],c=r[1]);var h=n||o({width:e,height:i,dpr:1}),d=h.getContext("2d",{willReadFrequently:!0});if(n){var p=n.width,f=n.height;d.clearRect(0,0,p,f),n.style.width="".concat(e,"px"),n.style.height="".concat(i,"px"),n.width=e,n.height=i}return d.fillStyle=l,d.fillRect(0,0,h.width,h.height),"text"===t.type?jZ(t,c,h.width,h.height,d):"geometric"===t.type&&GZ(t,c,h.width,h.height,d),h},jZ=function(t,e,i,n,r){var a=t.fontFamily,o=void 0===a?"sans-serif":a,s=t.fontWeight,l=void 0===s?"normal":s,u=t.fontStyle,c=void 0===u?"normal":u,h=t.fontVariant,d=void 0===h?"normal":h,p=t.text,f=t.hollow,v=12;r.font="".concat(c," ").concat(d," ").concat(l," ").concat(v,"px ").concat(o),r.textAlign="center",r.textBaseline="middle",r.fillStyle=e;var g=r.measureText(p),y="normal"!==c?1.1:1,m=U(g.actualBoundingBoxRight)&&U(g.actualBoundingBoxLeft)?Math.ceil(y*(Math.abs(g.actualBoundingBoxRight)+Math.abs(g.actualBoundingBoxLeft))):0,_=Math.max(Math.ceil(g.width),m,v);if(f&&(r.globalCompositeOperation="xor"),_>i){var b=Math.min(i/_,n/v);r.fillText(p,i/2,n/2),r.scale(b,b)}else v=Math.floor(v*i/_),v=Math.min(v,n),r.font="".concat(c," ").concat(d," ").concat(l," ").concat(v,"px ").concat(o),r.fillText(p,Math.floor(i/2),Math.floor(n/2))},UZ=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0,r=2*Math.PI/n;return new Array(n).fill(0).map((function(n,a){return Ve(t,e,i+a*r)}))},WZ=function(t,e){t.beginPath(),e.forEach((function(e,i){0===i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)})),t.closePath(),t.fill()},GZ=function(t,e,i,n,r){var a=t.hollow,o=CZ(t.shape,[i,n]),s=o.center,l=o.maxRadius;r.fillStyle=e,a&&(r.globalCompositeOperation="xor");var u=s[0],c=s[1];if("cardioid"===t.shape)!function(t,e){var i;t.beginPath(),e.forEach((function(e,n){0===n?t.moveTo(e.x,e.y):t.bezierCurveTo(e.x,e.y,i.x,i.y,e.x,e.y),i=e})),t.closePath(),t.fill()}(r,function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0,r=2*Math.PI/n,a=EZ("cardioid");return new Array(n).fill(0).map((function(n,o){var s=i+o*r,l=e*a(s);return Ve(t,l,s)}))}({x:u,y:c},l,0,100));else if("circle"===t.shape)r.beginPath(),r.arc(u,c,l,0,2*Math.PI,!0),r.fill();else if("diamond"===t.shape)WZ(r,UZ({x:u,y:c},l,-Math.PI/2,4));else if("square"===t.shape)WZ(r,UZ({x:u,y:c},l,-Math.PI/4,4));else if("pentagon"===t.shape)WZ(r,UZ({x:u,y:c},l,Math.PI/2,5));else if("triangle"===t.shape||"triangleUpright"===t.shape)WZ(r,UZ({x:u,y:c},l,-Math.PI/2,3));else if("triangleForward"===t.shape)WZ(r,UZ({x:u,y:c},l,0,3));else if("star"===t.shape){for(var h=UZ({x:u,y:c},l,-Math.PI/2,5),d=UZ({x:u,y:c},l/(2*Math.cos(Math.PI/5)),-Math.PI/2+Math.PI/5,5),p=[],f=0;f<5;f++)p.push(h[f]),p.push(d[f]);WZ(r,p)}else r.fillRect(0,0,i,n)};function YZ(t){for(var e=t.size,i=t.maskCanvas,n=i.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,i.width,i.height),r=new Array(e[0]*e[1]).fill(0),a=1,o=[[0,1],[1,0],[-1,0],[0,-1]],l=[],u=0;u<e[1];u++)for(var c=0;c<e[0];c++)if(0===r[u*e[0]+c]&&!t.isEmptyPixel(n,u,c)){r[u*e[0]+c]=a,l.push([u,c]);for(var h=0;h<l.length;h++)for(var d=0;d<4;d++){var p=l[h][0]+o[d][0],f=l[h][1]+o[d][1];p=p<0?0:p>=e[1]?e[1]-1:p,f=f<0?0:f>=e[0]?e[0]-1:f,0!==r[p*e[0]+f]||t.isEmptyPixel(n,p,f)||(r[p*e[0]+f]=a,l.push([p,f]))}a++,l=[]}for(var v={},g={},y={},_={},x={},k={},S={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0,width:0,height:0},A=[],M=0;M<e[1];M++)for(var T=0;T<e[0];T++){var w=r[M*e[0]+T];0!==w&&(X(M,T)&&(A.push([M,T]),v[w]=v[w]||[],v[w].push([T,M]),_[w]||(_[w]=[1/0,-1/0,1/0,-1/0]),M<_[w][0]&&(_[w][0]=M),M>_[w][1]&&(_[w][1]=M),T<_[w][2]&&(_[w][2]=T),T>_[w][3]&&(_[w][3]=T),T<S.x1&&(S.x1=T),T>S.x2&&(S.x2=T),M<S.y1&&(S.y1=M),M>S.y2&&(S.y2=M)),g[w]=(g[w]||0)+1)}var C=[];for(var E in v){var P=v[E],B=~~(P.reduce((function(t,e){return t+e[0]}),0)/P.length),R=~~(P.reduce((function(t,e){return t+e[1]}),0)/P.length);y[E]=[B,R],C.push.apply(C,b(P));var L=m(_[E],4),I=L[0],D=L[1],O=L[2],F=L[3];x[E]=~~Math.max(Math.sqrt(Math.pow(B-O,2)+Math.pow(R-I,2)),Math.sqrt(Math.pow(B-F,2)+Math.pow(R-D,2)),Math.sqrt(Math.pow(B-O,2)+Math.pow(R-D,2)),Math.sqrt(Math.pow(B-F,2)+Math.pow(R-I,2))),k[E]=(F-O)/(D-I)}var z=Object.keys(y).map((function(t){return{label:t-1,boundary:v[t],area:g[t],center:y[t],maxPoint:_[t],maxR:x[t],ratio:k[t]}}));S.width=S.x2-S.x1+1,S.height=S.y2-S.y1+1;var H=~~(C.reduce((function(t,e){return t+e[0]}),0)/C.length),N=~~(C.reduce((function(t,e){return t+e[1]}),0)/C.length),V=~~Math.max(Math.sqrt(Math.pow(H-S.x1,2)+Math.pow(N-S.y1,2)),Math.sqrt(Math.pow(H-S.x2,2)+Math.pow(N-S.y2,2)),Math.sqrt(Math.pow(H-S.x1,2)+Math.pow(N-S.y2,2)),Math.sqrt(Math.pow(H-S.x2,2)+Math.pow(N-S.y1,2))),j=S.width/S.height,U=Object.keys(g).reduce((function(t,e){return t+g[e]}),0),W={regions:z,labels:r,labelNumber:a-1};if(t.blur){var G=t.blur,Y=function(t,e,i,n){for(var r=n/3,a=Math.ceil(n/2),o=function(t,e){for(var i=new Array(2*t+1).fill(0),n=t,r=0,a=-t;a<=t;a++){var o=Math.exp(-a*a/(2*e*e));i[a+n]=o,r+=o}for(var s=0;s<i.length;s++)i[s]/=r;return i}(a,r),s=new Array(t.length).fill(0),l=new Array(t.length).fill(0),u=0;u<i;u++)for(var c=0;c<e;c++){for(var h=0,d=-a;d<=a;d++)h+=t[u*e+Math.min(Math.max(c+d,0),e-1)]*o[d+a];s[u*e+c]=h}for(var p=0;p<e;p++)for(var f=0;f<i;f++){for(var v=0,g=-a;g<=a;g++)v+=s[Math.min(Math.max(f+g,0),i-1)*e+p]*o[g+a];l[f*e+p]=Math.max(0,Math.min(1,v))}return l}(r,e[0],e[1],G);(function(t,e,i,n){var r,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=new Array(t.length).fill(0),l=s(e);try{for(l.s();!(r=l.n()).done;){var u=m(r.value,2),c=u[0],h=u[1];if(o[c*i+h]=1,a>1)for(var d=1-a;d<=a-1;d++)for(var p=1-a;p<=a-1;p++)if(Math.sqrt(d*d+p*p)<a){var f=c+d,v=h+p;f>=0&&f<n&&v>=0&&v<i&&(o[f*i+v]=1)}}}catch(t){l.e(t)}finally{l.f()}return o})(r,A,e[0],e[1],Math.ceil(G/2)).forEach((function(t,e){1===t&&(r[e]=Y[e])}))}return Object.assign(t,{segmentation:W,shapeBounds:S,shapeMaxR:V,shapeRatio:j,shapeCenter:[H,N],shapeArea:U});function X(t,i){var n=[[0,1],[1,0],[-1,0],[0,-1]];if(0===t||0===i||t===e[1]-1||i===e[0]-1)return!0;for(var a=0;a<4;a++){var o=t+n[a][0],s=i+n[a][1];if(o=o<0?0:o>=e[1]?e[1]-1:o,s=s<0?0:s>=e[0]?e[0]-1:s,0===r[o*e[0]+s])return!0}return!1}}var XZ=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[gt({},e.defaultOptions,t)])).fillGridAt=function(t,e){t>=i.ngx||e>=i.ngy||t<0||e<0||(i.grid[t][e]=!1)},i.updateGrid=function(t,e,n,r,a){for(var o=a.occupied,s=o.length;s--;){var l=t+o[s][0],u=e+o[s][1];l>=i.ngx||u>=i.ngy||l<0||u<0||i.fillGridAt(l,u)}},i.gridSize=Math.max(Math.floor(i.options.gridSize),4),i}return h(e,t),o(e,[{key:"getPointsAtRadius",value:function(t){if(this.pointsAtRadius[t])return this.pointsAtRadius[t];var e=8*t,i=e,n=[];for(0===t&&n.push([this.center[0],this.center[1],0]);i--;){var r=this.shape(i/e*2*Math.PI);n.push([this.center[0]+t*r*Math.cos(-i/e*2*Math.PI),this.center[1]+t*r*Math.sin(-i/e*2*Math.PI)*this.options.ellipticity,i/e*2*Math.PI])}return this.pointsAtRadius[t]=n,n}},{key:"getTextInfo",value:function(t){var e,i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,a=this.options.clip?1:n,o=Math.max(Math.floor((this.isTryRepeatFill?this.options.fillTextFontSize:this.getTextFontSize(t))*a),this.options.minFontSize),s=this.getText(t)+"";if(this.options.clip&&(s=s.slice(0,Math.ceil(s.length*n))),!s)return null;var l=this.getTextFontWeight(t),u=this.getTextFontStyle(t),c=this.getTextRotate&&null!==(e=this.getTextRotate(t,r))&&void 0!==e?e:0,h=this.getTextFontFamily(t),d=this.options.createCanvas({width:1,height:1}),p=d.getContext("2d",{willReadFrequently:!0});p.font=u+" "+l+" "+o.toString(10)+"px "+h;var f=p.measureText(s).width,v=Math.max(o,p.measureText("m").width,p.measureText("Ｗ").width),g=f+2*v,y=3*v,m=Math.ceil(g/this.gridSize),_=Math.ceil(y/this.gridSize);g=m*this.gridSize,y=_*this.gridSize;var b=-f/2,x=.4*-v,k=Math.ceil((g*Math.abs(Math.sin(c))+y*Math.abs(Math.cos(c)))/this.gridSize),S=Math.ceil((g*Math.abs(Math.cos(c))+y*Math.abs(Math.sin(c)))/this.gridSize),A=S*this.gridSize,M=k*this.gridSize;d.setAttribute("width",""+A),d.setAttribute("height",""+M),p.scale(1,1),p.translate(A/2,M/2),p.rotate(-c),p.font=u+" "+l+" "+o.toString(10)+"px "+h,p.fillStyle="#000",p.textBaseline="middle",p.fillText(s,b,x);var T=p.getImageData(0,0,A,M).data;if(this.exceedTime())return null;for(var w,C=[],E=S,P=[k/2,S/2,k/2,S/2],B=function(t,e,n){for(var r=i.gridSize;r--;)for(var a=i.gridSize;a--;)if(T[4*((e*i.gridSize+r)*A+(t*i.gridSize+a))+3])return n.push([t,e]),t<P[3]&&(P[3]=t),t>P[1]&&(P[1]=t),e<P[0]&&(P[0]=e),void(e>P[2]&&(P[2]=e))};E--;)for(w=k;w--;)B(E,w,C);return{datum:t,occupied:C,bounds:P,gw:S,gh:k,fillTextOffsetX:b,fillTextOffsetY:x,fillTextWidth:f,fillTextHeight:v,fontSize:o,fontStyle:u,fontWeight:l,fontFamily:h,angle:c,text:s}}},{key:"calculateEmptyRate",value:function(){for(var t=this.ngx*this.ngy,e=0,i=0;i<this.ngx;i++)for(var n=0;n<this.ngy;n++)this.grid[i][n]&&e++;return e/t}},{key:"canFitText",value:function(t,e,i,n,r){for(var a=r.length;a--;){var o=t+r[a][0],s=e+r[a][1];if(o>=this.ngx||s>=this.ngy||o<0||s<0){if(!this.options.drawOutOfBound)return!1}else if(!this.grid[o][s])return!1}return!0}},{key:"layoutWord",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.data[t],r=this.getTextInfo(n,i,t);if(!r)return!1;if(this.exceedTime())return!1;if(!this.options.drawOutOfBound&&(!this.options.shrink||r.fontSize<=this.options.minFontSize)&&!this.options.clip){var a=r.bounds;if(a[1]-a[3]+1>this.ngx||a[2]-a[0]+1>this.ngy)return!1}for(var o=this.maxRadius+1,s=function(t){var i=Math.floor(t[0]-r.gw/2),n=Math.floor(t[1]-r.gh/2),a=r.gw,s=r.gh;return!!e.canFitText(i,n,a,s,r.occupied)&&(r.distance=e.maxRadius-o,r.theta=t[2],e.outputText(i,n,r),e.updateGrid(i,n,a,s,r),!0)};o--;){var l=this.getPointsAtRadius(this.maxRadius-o);if(this.options.random&&Ct(l=[].concat(l)),l.some(s))return!0}return(this.options.clip||!!(this.options.shrink&&r.fontSize>this.options.minFontSize))&&this.layoutWord(t,.75*i)}},{key:"outputText",value:function(t,e,i){var n=this.getTextColor(i),r={text:i.text,datum:i.datum,color:n,fontStyle:i.fontStyle,fontWeight:i.fontWeight,fontFamily:i.fontFamily,angle:i.angle,width:i.fillTextWidth,height:i.fillTextHeight,x:(t+i.gw/2)*this.gridSize,y:(e+i.gh/2)*this.gridSize+i.fillTextOffsetY+.5*i.fontSize,fontSize:i.fontSize};this.result.push(r),this.progressiveResult&&this.progressiveResult.push(r)}},{key:"initGrid",value:function(t){var e=this;this.grid=[];var i=this.options.shape;if(W(i)){var n=VZ(i,t.width,t.height,void 0,!1,this.options.createCanvas),r=n.getContext("2d").getImageData(0,0,this.ngx*this.gridSize,this.ngy*this.gridSize);this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(n);for(var a=NZ(i.backgroundColor,void 0,this.options.createCanvas),o=function(t,i){for(var n=e.gridSize;n--;)for(var o=e.gridSize;o--;)if(!a(r,i*e.gridSize+n,t*e.gridSize+o))return void(e.grid[t][i]=!0);e.grid[t][i]=!1},s=this.ngx;s--;){this.grid[s]=[];for(var l=this.ngy;l--;)o(s,l),!1!==this.grid[s][l]&&(this.grid[s][l]=!0)}r=a=void 0}else for(var u=this.ngx;u--;){this.grid[u]=[];for(var c=this.ngy;c--;)this.grid[u][c]=!0}}},{key:"canRepeat",value:function(){return this.calculateEmptyRate()>.001}},{key:"layout",value:function(t,e){this.initProgressive(),this.drawnCount=0,this.isTryRepeatFill=!1,this.originalData=t,this.data=t,this.pointsAtRadius=[],this.ngx=Math.floor(e.width/this.gridSize),this.ngy=Math.floor(e.height/this.gridSize);var i=CZ(this.options.shape,[e.width,e.height]),n=i.center,r=i.maxRadius;return this.center=e.origin?[e.origin[0]/this.gridSize,e.origin[1]/this.gridSize]:[n[0]/this.gridSize,n[1]/this.gridSize],this.maxRadius=Math.floor(r/this.gridSize),this.initGrid(e),this.result=[],this.progressiveRun()}}])}(RZ);XZ.defaultOptions={gridSize:8,ellipticity:1,maxSingleWordTryCount:1};var KZ=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[gt({},e.defaultOptions,t)])).random=i.options.random?Math.random:function(){return 0},i.aspectRatio=1,i}return h(e,t),o(e,[{key:"fit",value:function(t){for(var e=0,i=this.result.length;e<i;e++)if(qZ(t,this.result[e]))return!1;return!0}},{key:"getTextInfo",value:function(t,e){var i={datum:t,fontSize:this.getTextFontSize(t),fontWeight:this.getTextFontWeight(t),fontStyle:this.getTextFontStyle(t),fontFamily:this.getTextFontFamily(t),angle:this.getTextRotate(t,e),text:this.getText(t)+"",x:this.center[0],y:this.center[1]},n=this.options.getTextBounds(i);return i.width=n.width(),i.height=n.height(),i.top=this.center[1]-i.height+.21*i.height,i.left=this.center[0]-i.width/2,i}},{key:"layoutWord",value:function(t){for(var e=this.getTextInfo(this.data[t],t),i=2*Math.PI,n=0,r=e.left,a=e.top,o=e.width,s=e.height,l=1,u=this.fit(e);!u&&n<this.maxRadius;)n+=.5,l=this.shape(n/this.maxRadius*2*Math.PI),i+=.5*(this.options.random?this.random()>.5?1:-1:t%2==0?1:-1),r=this.center[0]-o/2+n*l*Math.cos(i)*this.aspectRatio,a=this.center[1]-s/2+n*l*Math.sin(i),e.left=r,e.top=a,e.x=r+o/2,e.y=a+s/2,u=this.fit(e);return!!u&&!!(this.options.clip||e.left>=0&&e.left+e.width<=this.width&&e.top>=0&&e.top+e.height<=this.height)&&(this.result.push(e),!0)}},{key:"layout",value:function(t,e){var i=this;if(!(null==t?void 0:t.length))return[];this.initProgressive(),this.result=[],this.maxRadius=Math.sqrt(e.width*e.width+e.height*e.height)/2,this.center=[e.width/2,e.height/2],this.width=e.width,this.height=e.height,this.data=t.sort((function(t,e){return i.getTextFontSize(e)-i.getTextFontSize(t)}));for(var n=0;n<t.length&&(this.layoutWord(n),n++,this.progressiveIndex=n,!this.exceedTime()););return this.result}}])}(RZ);function qZ(t,e){return!(t.left+t.width<e.left||t.top+t.height<e.top||t.left>e.left+e.width||t.top>e.top+e.height)}KZ.defaultOptions={enlarge:!1};var ZZ,JZ={x:"x",y:"y",z:"z",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle"},QZ=function(t,e){var i,n,r,a,o,s;if(t.size&&(t.size[0]<=0||t.size[1]<=0))return Ot.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];var l=e,u=(null!==(i=t.size)&&void 0!==i?i:[500,500]).slice();u[0]=Math.floor(u[0]),u[1]=Math.floor(u[1]);var c=t.fontFamily?$Z(t.fontFamily):"sans-serif",h=t.fontStyle?$Z(t.fontStyle):"normal",d=t.fontWeight?$Z(t.fontWeight):"normal",p=t.rotate?$Z(t.rotate):0,f=$Z(t.text),v=null!==(n=t.spiral)&&void 0!==n?n:"archimedean",g=t.padding?$Z(t.padding):1,y=null!==(r=t.shape)&&void 0!==r?r:"square",m=null!==(a=t.shrink)&&void 0!==a&&a,_=null!==(o=t.enlarge)&&void 0!==o&&o,b=null!==(s=t.clip)&&void 0!==s&&s,x=t.minFontSize,k=t.randomVisible,S=t.as?Object.assign(Object.assign({},JZ),t.as):JZ,A=t.depth_3d,M=t.postProjection,T=t.fontSize?$Z(t.fontSize):14,w=t.fontSizeRange;if(w&&!Q(T)){var C=T,E=eJ(iJ(C,l),w);T=function(t){return E(C(t))}}var P=IZ;"fast"===t.layoutType?P=KZ:"grid"===t.layoutType&&(P=XZ);var B=new P(Object.assign(Object.assign({},t),{text:f,padding:g,spiral:v,shape:y,rotate:p,fontFamily:c,fontStyle:h,fontWeight:d,fontSize:T,shrink:m,clip:b,enlarge:_,minFontSize:x,random:k,outputCallback:function(e){for(var i,n,r=[],a=0,o=e.length;a<o;a++)(i=(n=e[a]).datum)[S.x]=n.x,i[S.y]=n.y,i[S.fontFamily]=n.fontFamily,i[S.fontSize]=n.fontSize,i[S.fontStyle]=n.fontStyle,i[S.fontWeight]=n.fontWeight,i[S.angle]=n.angle,"StereographicProjection"===M&&nJ(u,n,i,S,A),t.dataIndexKey&&(i[t.dataIndexKey]="".concat(a)),r.push(i);return r}}));return B.layout(l,{width:u[0],height:u[1]}),t.progressiveStep>0||t.progressiveTime>0?{progressive:B}:B.output()},$Z=function(t){return K(t)||Q(t)||V(t)||q(t)?t:function(e){return e[t.field]}},tJ=function(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)},eJ=function(t,e,i){if(t[0]===t[1])return function(t){return e[0]};var n=tJ(t[0]),r=tJ(t[1]),a=Math.min(n,r),o=Math.max(n,r);return function(t){return(tJ(t)-a)/(o-a)*(e[1]-e[0])+e[0]}},iJ=function(t,e){for(var i,n=1/0,r=-1/0,a=e.length,o=0;o<a;++o)(i=Rt(t(e[o])))<n&&(n=i),i>r&&(r=i);return 1===e.length&&n===r&&(n-=1e4),[n,r]};function nJ(t,e,i,n,r){var a=Math.max(t[0],t[1])/2,o=function(t,e,i,n,r){var a=r.x,o=r.y,s=a/t*Math.PI*2,l=Math.PI-o/e*Math.PI;return l+=(l<Math.PI/2?1:-1)*Math.pow(Math.min(l-Math.PI/2,1),2)/5,{x:i*Math.sin(l)*Math.cos(s)+n.x,y:i*Math.cos(l)+n.y,z:i*Math.sin(l)*Math.sin(s)+n.z}}(t[0],t[1],a,{x:a,y:a,z:null!=r?r:a},e);i[n.x]=o.x,i[n.y]=o.y,i[n.z]=o.z}!function(t){t.BEFORE_WORDCLOUD_SHAPE_LAYOUT="beforeWordcloudShapeLayout",t.AFTER_WORDCLOUD_SHAPE_LAYOUT="afterWordcloudShapeLayout",t.AFTER_WORDCLOUD_SHAPE_DRAW="afterWordcloudShapeDraw"}(ZZ||(ZZ={}));var rJ=function(t){return/^[\u4e00-\u9fa5]+$/.test(t)},aJ=function(t,e){if(j(t))return 0;var i,n=0,r=s(t);try{for(r.s();!(i=r.n()).done;){var a=i.value;rJ(a)?n+=1:n+=.53}}catch(t){r.e(t)}finally{r.f()}return n};function oJ(t,e,i){var n=e.stepFactor,r=e.importantWordCount,a=e.globalShinkLimit,o=i.size,s=i.segmentation.regions,l=i.tempCanvas,u=i.boardSize,c=i.shapeCenter,h=i.shapeMaxR,d=i.shapeRatio,p=l.getContext("2d",{willReadFrequently:!0}),f=hJ(i),v=f.slice(0),g=e.fontSizeShrinkFactor,y=null,m=1,_=1,b=r,x=0;t.length>b&&(x=t.sort((function(t,e){return e.weight-t.weight}))[b].weight);for(var k=0;k<s.length;k++){for(var S=s[k],A=S.words,M=S.center,T=S.maxR,w=S.ratio,C=!1,E=0;E<A.length;E++){cJ(l,p,t,E);var P=A[E];if(P.x=M[0],P.y=M[1],!P.skip&&P.hasText&&P.sprite&&sJ(v,P,T,w,o,u,n))P.hasPlaced=!0;else{if(!P.skip&&P.weight>x&&_>a){var B=P.datum[Symbol.for("vGrammar_id")];B!==y&&(y=B,m=_),_*=g,t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*g})),v=f.slice(0),C=!0;break}if(!P.skip&&P.datum[Symbol.for("vGrammar_id")]===y){t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/_})),P.skip=!0,_=m,y=null,v=f.slice(0),C=!0;break}}}C&&(k=-1)}for(var R=0;R<e.textLayoutTimes;R++){var L=t.filter((function(t){return t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced}));if(0===L.length)break;for(var I=0;I<L.length;I++){var D=L[I];cJ(l,p,L,I),D.x=c[0],D.y=c[1],D.hasText&&sJ(v,D,h,d,o,u,n)&&(D.hasPlaced=!0)}}e.board=v}function sJ(t,e,i,n,r,a,o){for(var s,l,u,c=e.x,h=e.y,d=function(t){return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}(n),p=1*o,f=-p;s=d(f+=p);){e.wordSize;var v=e.bounds,g=v.dTop,y=v.dBottom,m=v.dLeft,_=v.dRight;if(l=s[0],u=s[1],Math.min(Math.abs(l),Math.abs(u))>=i)break;if(e.x=~~(c+l),e.y=~~(h+u),!(e.x-m<0||e.x+_>r[0]||e.y-g<0||e.y+y>r[1]||uJ(e,t,a)))return lJ(e,t,a),!0}return!1}function lJ(t,e,i){var n,r=t.wordSize,a=t.sprite,o=r[0]>>5,s=i[0]>>5,l=t.x-(o<<4),u=l%32,c=32-u,h=r[1],d=(t.y-(r[1]>>1))*s+(l>>5);if(0===u)for(var p=0;p<h;p++){for(var f=0;f<o;f++)e[d+f]|=a[p*o+f];d+=s}else for(var v=0;v<h;v++){n=0;for(var g=0;g<=o;g++)e[d+g]|=n<<c|(g<o?(n=a[v*o+g])>>>u:0);d+=s}}function uJ(t,e,i){var n,r=t.sprite,a=t.wordSize,o=i[0]>>5,s=a[0]>>5,l=t.x-(s<<4),u=l%32,c=32-u,h=a[1],d=(t.y-(a[1]>>1))*o+(l>>5);if(0===u)for(var p=0;p<h;p++){for(var f=0;f<s;f++)if(e[d+f]&r[p*s+f])return!0;d+=o}else for(var v=0;v<h;v++){n=0;for(var g=0;g<=s;g++)if((n<<c|(g<s?(n=r[v*s+g])>>>u:0))&e[d+g])return!0;d+=o}return!1}function cJ(t,e,i,n){if(!i[n].sprite&&0!==i[n].fontSize){var r=2048,a=Math.PI/180,o=i.length;t.width=r,t.height=2048,e.clearRect(0,0,r,2048),e.textAlign="center";var s,l,u=0,c=0,h=0,d=0,p=n;for(--n;++n<o;){var f=i[n],v=Math.max(f.fontSize,2);if(e.save(),e.font=f.fontStyle+" "+f.fontWeight+" "+v+"px "+f.fontFamily,s=e.measureText(f.text+"m").width+2*f.padding,l=2*v+2*f.padding,0!==f.rotate){var g=Math.sin(f.rotate*a),y=Math.cos(f.rotate*a),_=s*y,b=s*g,x=l*y,k=l*g;s=Math.max(Math.abs(_+k),Math.abs(_-k)),l=~~Math.max(Math.abs(b+x),Math.abs(b-x))}if(s=s+31>>5<<5,(l=Math.ceil(l))>h&&(h=l),u+s>=r&&(u=0,c+=h,h=l),c+l>=2048){if(0===c){f.hasText=!1;continue}break}c+l>=d&&(d=c+l),e.translate(u+(s>>1),c+(l>>1)),0!==f.rotate&&e.rotate(f.rotate*a),e.fillText(f.text,0,0),f.padding&&(e.lineWidth=2*f.padding,e.strokeText(f.text,0,0)),e.restore(),f.LT=[u,c],f.wordSize=[s,l],f.hasText=!0,u+=s}if(0!==d)for(var S,A,M=e.getImageData(0,0,r,d).data;--n>=p;){var T=i[n];if(!T.hasText){T.bounds={dTop:1/0,dBottom:-1/0,dLeft:1/0,dRight:-1/0};break}var w=T.LT,C=void 0===w?[0,0]:w,E=T.wordSize,P=m(C,2);u=P[0],c=P[1];var B=E[0]>>5,R=new Array(B*E[1]).fill(0),L=1/0,I=-1/0,D=1/0,O=-1/0;for(A=0;A<E[1];A++){var F=void 0;for(S=0;S<E[0];S++)if(M[4*((c+A)*r+(u+S))+3]>0){var z=1<<31-S%32;R[B*A+(S>>5)]|=z,S<D&&(D=S),S>O&&(O=S),F|=z}F&&(A<L&&(L=A),A>I&&(I=A))}T.bounds={dTop:(E[1]>>1)-L,dBottom:I-(E[1]>>1),dLeft:(E[0]>>1)-D,dRight:O-(E[0]>>1)},T.sprite=R,delete T.LT}}}function hJ(t){for(var e=t.segmentation.labels,i=t.boardSize,n=t.size,r=i[0]>>5,a=new Array(r*n[1]).fill(0),o=0;o<n[1];o++)for(var s=0;s<n[0];s++)if(0===e[o*n[0]+s]){var l=1<<31-s%32;a[r*o+(s>>5)]|=l}if(i[0]>n[0])for(var u=(1<<i[0]-n[0])-1,c=0;c<n[1];c++)a[r*c+r-1]|=u;return a}function dJ(t,e,i){(function(t,e){var i=e.segmentation.regions,n=-1/0,r=0,a=0;i.forEach((function(t,e){var i=t.area;i>n&&(n=i,a=e),r+=i}));var o=0;i.forEach((function(e){var i=e.area,a=Math.ceil(i/r*t.length),s=i/n;e.words=[],e.regionNum=a,e.regionWeight=s,o+=a})),o<t.length&&(i[a].wordsNum+=t.length-o);var s=a,l=i.map((function(t){return t.regionNum}));t.forEach((function(t){var e=0,n=0;t.regionIndex=-1;do{if(l[s]>0&&t.weight<=i[s].regionWeight){t.regionIndex=s,i[s].words.push(t),l[s]--,s=(s+1)%i.length;break}s=(s+1)%i.length,e++,++n>i.length+1&&(i.forEach((function(t){t.regionWeight+=.15})),n=0)}while(-1===t.regionIndex&&e<3*i.length);-1===t.regionIndex&&(t.regionIndex=a,i[a].words.push(t),l[a]--)})),i.forEach((function(t){t.words.sort((function(t,e){return e.weight-t.weight}))}))})(t,i),"ensureMapping"===e.layoutMode?oJ(t,e,i):"ensureMappingEnlarge"===e.layoutMode?function(t,e,i){var n=e.size,r=e.stepFactor,a=e.importantWordCount,o=i.segmentation.regions,s=i.tempCanvas,l=i.boardSize,u=i.shapeCenter,c=i.shapeMaxR,h=i.shapeRatio,d=s.getContext("2d",{willReadFrequently:!0}),p=hJ(i),f=p.slice(0),v=e.fontSizeEnlargeFactor,g=Math.min(a,t.length),y=0;t.length>g&&(y=t.sort((function(t,e){return e.weight-t.weight}))[g-1].weight);for(var m=0,_=1,b=!1,x=0;x<o.length;x++){for(var k=o[x],S=k.words,A=k.center,M=k.maxR,T=k.ratio,w=!1,C=0;C<S.length;C++){cJ(s,d,t,C);var E=S[C];if(E.x=A[0],E.y=A[1],E.hasText&&E.sprite&&sJ(f,E,M,T,n,l,r)){if(E.hasPlaced=!0,E.weight>=y&&m++,m>=g&&!b){_*=v,t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*v})),f=p.slice(0),w=!0,m=0;break}}else{if(E.weight>=y&&_>1){t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/v})),_/=v,b=!0,f=p.slice(0),w=!0;break}if(E.weight>=y)return oJ(t,e,i)}}w&&(x=-1)}for(var P=0;P<e.textLayoutTimes;P++){var B=t.filter((function(t){return t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced}));if(0===B.length)break;for(var R=0;R<B.length;R++){var L=B[R];cJ(s,d,B,R),L.x=u[0],L.y=u[1],L.hasText&&sJ(f,L,c,h,n,l,r)&&(L.hasPlaced=!0)}}e.board=f}(t,e,i):function(t,e,i){var n,r=e.size,a=e.stepFactor,o=i.segmentation.regions,l=i.tempCanvas,u=i.boardSize,c=i.shapeCenter,h=i.shapeMaxR,d=i.shapeRatio,p=hJ(i),f=l.getContext("2d",{willReadFrequently:!0}),v=s(o);try{for(v.s();!(n=v.n()).done;)for(var g=n.value,y=g.words,m=g.center,_=g.maxR,b=g.ratio,x=0;x<y.length;x++){cJ(l,f,t,x);var k=y[x];k.x=m[0],k.y=m[1],k.hasText&&k.sprite&&sJ(p,k,_,b,r,u,a)&&(k.hasPlaced=!0)}}catch(t){v.e(t)}finally{v.f()}for(var S=0;S<e.textLayoutTimes;S++){var A=t.filter((function(t){return t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced}));if(0===A.length)break;for(var M=0;M<A.length;M++){var T=A[M];cJ(l,f,A,M),T.x=c[0],T.y=c[1],T.hasText&&sJ(p,T,h,d,r,u,a)&&(T.hasPlaced=!0)}}e.board=p}(t,e,i);for(var n=function(t,e,i){for(var n=e.size,r=e.fillingTimes,a=e.fillingXStep,o=e.fillingYStep,s=e.getFillingFontStyle,l=e.getFillingFontWeight,u=e.getFillingFontFamily,c=e.fillingInitialFontSize,h=e.fillingDeltaFontSize,d=e.fillingInitialOpacity,p=e.fillingDeltaOpacity,f=e.fillingRotateList,v=e.getFillingPadding,g=e.random,y=e.board,m=e.minFillFontSize,_=i.boardSize,b=i.shapeBounds,x=i.tempCanvas,k=i.randomGenerator,S=x.getContext("2d",{willReadFrequently:!0}),A=c,M=d,T=[],w=0;w<r;w++)C(A,M),A=Math.max(A>h?A-h:h,m),M=M>p?M-p:p;return T;function C(e,i){var r=t.map((function(t){var n=t.text,r=t.color,a=t.fillingColor,o=t.hasPlaced,c=t.datum;return{x:0,y:0,weight:0,text:n,fontFamily:u(c),fontStyle:s(c),fontWeight:l(c),fontSize:e,rotate:f[~~(k()*f.length)],padding:v(c),opacity:i,visible:!0,color:r,fillingColor:a,hasPlaced:o,datum:c}}));E(r);for(var c=0,h=b.x1,d=b.y1,p=b.x2,m=b.y2,A=h+~~(k()*a*2),M=d+~~(k()*o*2);M<=m;M+=o)for(var w=A;w<=p;w+=a){cJ(x,S,r,c);var C=r[c];C.x=w,C.y=M,C.wordSize;var P=C.bounds;if(C.hasPlaced&&P){var B=P.dTop,R=P.dBottom,L=P.dLeft,I=P.dRight;C.x-L<0||C.x+I>n[0]||C.y-B<0||C.y+R>n[1]||C.hasText&&C.sprite&&!uJ(C,y,_)&&(lJ(C,y,_),T.push(Object.assign({},C)),++c===r.length&&(c=0,g&&E(r)))}else++c===r.length&&(c=0,g&&E(r))}}function E(t){return t.sort((function(){return k()-.5}))}}(t,e,i),r=[],a=[],o=0;o<t.length;o++)t[o].hasPlaced?a.push(t[o]):r.push(t[o]);return r.forEach((function(t){return t.visible=!1})),{fillingWords:n,successedWords:a,failedWords:r}}var pJ={x:"x",y:"y",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle",opacity:"opacity",visible:"visible",isFillingWord:"isFillingWord",color:"color"},fJ=function(){return o((function t(e){r(this,t),this.progressiveResult=[],this.options=e}),[{key:"layout",value:function(t){var e=this;this.data=t;var i=this.options,n={shapeUrl:i.shape,size:i.size,ratio:i.ratio||.8,tempCanvas:void 0,boardSize:[0,0],random:!1,randomGenerator:void 0},r=this.options.createCanvas({width:i.size[0],height:i.size[1]}),a=r.getContext("2d",{willReadFrequently:!0});a.textAlign="center",a.textBaseline="middle",n.tempCanvas=r;var o=i.size[0]+31>>5<<5;if(n.boardSize=[o,i.size[1]],n.random?n.randomGenerator=Math.random:n.randomGenerator=function(){var t=-1,e=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9];return function(){return e[t=(t+1)%e.length]}}(),this.segmentationInput=n,K(n.shapeUrl)){n.isEmptyPixel=NZ(void 0,void 0,this.options.createCanvas);var s=function(t,e){return t&&(it(t)||nt(t)||t.startsWith("<svg"))?new Promise((function(i,n){var r,a=e({image:t}),o=null===(r=a.resources)||void 0===r?void 0:r.get(t);o&&"success"===o.state&&o.data?i(o.data):(a.successCallback=function(){var e;if(a){var r=null===(e=a.resources)||void 0===e?void 0:e.get(t);r&&"success"===r.state&&r.data?i(r.data):n(new Error("image load failed: "+t))}else n(new Error("image load failed: "+t))},a.failCallback=function(){n(new Error("image load failed: "+t))})})):null}(n.shapeUrl,this.options.createImage);s?(this.isImageFinished=!1,this.isLayoutFinished=!1,s.then((function(t){e.isImageFinished=!0;var r=e.options.createCanvas({width:i.size[0],height:i.size[1],dpr:1});n.maskCanvas=r;var a=r.getContext("2d");i.removeWhiteBorder&&function(t,e,i){e.width=t.width,e.height=t.height;var n=e.getContext("2d",{willReadFrequently:!0});n.clearRect(0,0,e.width,e.height),n.drawImage(t,0,0);for(var r=e.width,a=n.getImageData(0,0,e.width,e.height),o=0,s=a.height,l=0,u=a.width,c=function(t,e){for(var n=0;n<t;++n)if(!i(a,e,n))return!1;return!0},h=function(t,e,n){for(var r=e;r<n;++r)if(!i(a,r,t))return!1;return!0};o<s&&c(r,o);)++o;for(;s-1>o&&c(r,s-1);)--s;for(;l<u&&h(l,o,s);)++l;for(;u-1>l&&h(u-1,o,s);)--u;var d=n.getImageData(l,o,u-l,s-o);e.width=d.width,e.height=d.height,n.clearRect(0,0,e.width,e.height),n.putImageData(d,0,0)}(t,r,n.isEmptyPixel);var o=function(t,e){var i=t.width,n=t.height,r=e[0]/i;n*r>e[1]&&(r=e[1]/n);var a=Math.floor(r*i),o=Math.floor(r*n);return{x:(e[0]-a)/2,y:(e[1]-o)/2,width:a,height:o,scale:r}}(t,i.size);a.clearRect(0,0,i.size[0],i.size[1]),a.drawImage(t,o.x,o.y,o.width,o.height),e.options.onUpdateMaskCanvas&&e.options.onUpdateMaskCanvas(n.maskCanvas)})).catch((function(t){e.isImageFinished=!0}))):(this.isImageFinished=!0,this.isLayoutFinished=!0)}else if(n.shapeUrl&&("text"===n.shapeUrl.type||"geometric"===n.shapeUrl.type)){n.isEmptyPixel=NZ(n.shapeUrl.backgroundColor,void 0,this.options.createCanvas);var l=VZ(n.shapeUrl,i.size[0],i.size[1],void 0,!1,this.options.createCanvas);n.maskCanvas=l,this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(l),this.doLayout(),this.isImageFinished=!0,this.isLayoutFinished=!0}}},{key:"canAnimate",value:function(){return!0}},{key:"unfinished",value:function(){return!this.isLayoutFinished}},{key:"output",value:function(){return this.progressiveResult}},{key:"progressiveRun",value:function(){this.isImageFinished&&!this.isLayoutFinished&&(this.segmentationInput.maskCanvas&&this.doLayout(),this.isLayoutFinished=!0)}},{key:"progressiveOutput",value:function(){return this.progressiveResult}},{key:"doLayout",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b,x=this.segmentationInput,k=YZ(x);if(k.segmentation.regions.length){var S=this.options,A=this.data,M=S.colorMode||"ordinal",T={getText:se(S.text),getFontSize:se(S.fontSize),fontSizeRange:S.fontSizeRange,colorMode:M,getColor:S.colorField?se(S.colorField):se(S.text),getFillingColor:se(S.fillingColorField),colorList:S.colorList||("ordinal"===M?["#2E62F1"]:["#537EF5","#2E62F1","#2358D8","#184FBF","#0C45A6","#013B8E"]),getColorHex:se(S.colorHexField),getFontFamily:se(S.fontFamily||"sans-serif"),rotateList:S.rotateList||[0],getPadding:se(S.padding||1),getFontStyle:se(S.fontStyle||"normal"),getFontWeight:se(S.fontWeight||"normal"),getFontOpacity:S.fontOpacity?se(S.fontOpacity):function(){return 1}};gJ(A,T,k);var w={size:S.size,ratio:S.ratio||.8,shapeUrl:S.shape,random:void 0===S.random||S.random,textLayoutTimes:null!==(t=S.textLayoutTimes)&&void 0!==t?t:3,removeWhiteBorder:S.removeWhiteBorder,layoutMode:null!==(e=S.layoutMode)&&void 0!==e?e:"default",fontSizeShrinkFactor:null!==(i=S.fontSizeShrinkFactor)&&void 0!==i?i:.8,stepFactor:null!==(n=S.stepFactor)&&void 0!==n?n:1,importantWordCount:null!==(r=S.importantWordCount)&&void 0!==r?r:10,globalShinkLimit:S.globalShinkLimit||.2,fontSizeEnlargeFactor:null!==(a=S.fontSizeEnlargeFactor)&&void 0!==a?a:1.5,fillingRatio:null!==(o=S.fillingRatio)&&void 0!==o?o:.7,fillingTimes:null!==(s=S.fillingTimes)&&void 0!==s?s:4,fillingXStep:S.fillingXRatioStep?Math.max(Math.floor(S.size[0]*S.fillingXRatioStep),1):null!==(l=S.fillingXStep)&&void 0!==l?l:4,fillingYStep:S.fillingYRatioStep?Math.max(Math.floor(S.size[1]*S.fillingYRatioStep),1):null!==(u=S.fillingYStep)&&void 0!==u?u:4,fillingInitialFontSize:S.fillingInitialFontSize,fillingDeltaFontSize:S.fillingDeltaFontSize,fillingInitialOpacity:null!==(c=S.fillingInitialOpacity)&&void 0!==c?c:.8,fillingDeltaOpacity:null!==(h=S.fillingDeltaOpacity)&&void 0!==h?h:.05,getFillingFontFamily:se(S.fillingFontFamily||"sans-serif"),getFillingFontStyle:se(S.fillingFontStyle||"normal"),getFillingFontWeight:se(S.fillingFontWeight||"normal"),getFillingPadding:se(null!==(d=S.fillingPadding)&&void 0!==d?d:.4),fillingRotateList:null!==(p=S.fillingRotateList)&&void 0!==p?p:[0,90],fillingDeltaFontSizeFactor:null!==(f=S.fillingDeltaFontSizeFactor)&&void 0!==f?f:.2,fillingColorList:S.fillingColorList||["#537EF5"],sameColorList:!1,minInitFontSize:null!==(v=S.minInitFontSize)&&void 0!==v?v:10,minFontSize:null!==(g=S.minFontSize)&&void 0!==g?g:4,minFillFontSize:null!==(y=S.minFillFontSize)&&void 0!==y?y:2},C=function(t,e){if(1===e.length&&"#537EF5"===e[0])return!0;if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}(T.colorList,w.fillingColorList);w.sameColorList=C,vJ(A,T,w,S),function(t,e,i,n){var r=e.getText,a=i.fillingInitialFontSize,o=i.fillingDeltaFontSize,s=i.fillingRatio,l=Math.ceil(Math.sqrt(n.shapeArea)/4);if(!a||!o){var u,c=s/100,h=t.reduce((function(t,e){var i=aJ(r(e));return i>l?t:t+i}),0)/t.length;if(0===h)u=8;else{var d=.2*n.shapeArea;u=Math.sqrt(c*(d/h))}a=~~u,o=u*i.fillingDeltaFontSizeFactor,Object.assign(i,{fillingInitialFontSize:a,fillingDeltaFontSize:o})}}(A,T,w,k);var E=T.getText,P=T.getFontFamily,B=T.getFontStyle,R=T.getFontWeight,L=T.getPadding,I=T.getColor,D=T.getFillingColor,O=T.getColorHex,F=T.fontSizeScale,z=T.colorScale,H=T.fillingColorScale,N=T.getFontOpacity,V=T.rotateList,j=A.map((function(t){var e,i;return{x:0,y:0,weight:0,text:E(t),fontFamily:P(t),fontWeight:R(t),fontStyle:B(t),rotate:V[~~(x.randomGenerator()*V.length)],fontSize:Math.max(w.minInitFontSize,~~F(t)),opacity:N(t),padding:L(t),color:O&&O(t)||z&&z(I(t))||"black",fillingColor:!D||(null===(e=S.colorField)||void 0===e?void 0:e.field)===(null===(i=S.fillingColorField)||void 0===i?void 0:i.field)&&C?void 0:O&&O(t)||H&&H(D(t))||"black",datum:t,visible:!0,hasPlaced:!1}})),U=Mt(j.map((function(t){return t.fontSize})));j.forEach((function(t){return t.weight=t.fontSize/U})),j.sort((function(t,e){return e.weight-t.weight}));for(var W,G,Y=dJ(j,w,k),X=Y.fillingWords,K=Y.successedWords,q=Y.failedWords,Z=null!==(_=null===(m=S.text)||void 0===m?void 0:m.field)&&void 0!==_?_:"textKey",J=null!==(b=S.dataIndexKey)&&void 0!==b?b:"defaultDataIndexKey",Q=S.as?Object.assign(Object.assign({},pJ),S.as):pJ,$=[],tt=0;tt<j.length;++tt)(G=(W=j[tt]).datum)[Q.x]=W.x,G[Q.y]=W.y,G[Q.fontFamily]=W.fontFamily,G[Q.fontSize]=W.fontSize,G[Q.fontStyle]=W.fontStyle,G[Q.fontWeight]=W.fontWeight,G[Q.angle]=Fe(W.rotate),G[Q.opacity]=W.opacity,G[Q.visible]=W.visible,G[Q.isFillingWord]=!1,G[Q.color]=W.color,G[J]="".concat(W.text,"_").concat(tt,"_keyword"),$.push(G);var et=[];X.forEach((function(t,e){var i,n,r=Object.assign({},t.datum);r[Q.x]=t.x,r[Q.y]=t.y,r[Q.fontFamily]=t.fontFamily,r[Q.fontSize]=t.fontSize,r[Q.fontStyle]=t.fontStyle,r[Q.fontWeight]=t.fontWeight,r[Q.angle]=Fe(t.rotate),r[Q.opacity]=t.opacity,r[Q.visible]=t.visible,r[Q.isFillingWord]=!0,r[Q.color]=D?(null===(i=S.colorField)||void 0===i?void 0:i.field)===(null===(n=S.fillingColorField)||void 0===n?void 0:n.field)&&C?t.color:t.fillingColor:w.fillingColorList[~~(x.randomGenerator()*w.fillingColorList.length)],r[Z]=t.text,r[J]="".concat(t.text,"_").concat(e,"_fillingWords"),et.push(r)})),this.options.onLayoutFinished&&this.options.onLayoutFinished({successedWords:K,failedWords:q}),this.progressiveResult=$.concat(et)}}},{key:"release",value:function(){this.segmentationInput=null,this.data=null,this.progressiveResult=null,this.options=null}}])}(),vJ=function(t,e,i,n){var r,a,o,s,l,u,c=e.colorMode,h=e.getColor,d=e.getFillingColor,p=i.sameColorList,f=e.colorList,v=i.fillingColorList;if("ordinal"===c){var g=t.map((function(t){return h(t)}));if(l=function(t){return(new _L).domain(g).range(f).scale(t)},d&&((null===(r=n.colorField)||void 0===r?void 0:r.field)!==(null===(a=n.fillingColorField)||void 0===a?void 0:a.field)||!p)){var y=t.map((function(t){return d(t)}));u=function(t){return(new _L).domain(y).range(v).scale(t)}}}else{1===f.length&&(f=[f[0],f[0]]);var m=(new UL).domain(bJ(h,t)).range(f);if(l=function(t){return m.scale(t)},d&&((null===(o=n.colorField)||void 0===o?void 0:o.field)!==(null===(s=n.fillingColorField)||void 0===s?void 0:s.field)||!p)){1===v.length&&(v=[v[0],v[0]]);var _=(new UL).domain(bJ(d,t)).range(v);u=function(t){return _.scale(t)}}}Object.assign(e,{colorScale:l,fillingColorScale:u})},gJ=function(t,e,i){var n,r,a=e.fontSizeRange,o=e.getFontSize,s=e.getText;if(o){if(o&&a){var l=(new qL).domain(bJ(o,t)).range(a);n=function(t){return l.scale(o(t))}}else if(o&&V(o)&&!a){var u=m(bJ(o,t),2),c=u[0],h=u[1],d=t.map((function(t){return{text:s(t),value:o(t),weight:h===c?1:(o(t)-c)/(h-c)}})),p=yJ(d,i,!0);a=[~~(.5*p),~~p];var f=(new qL).domain(bJ(o,t)).range(a);n=function(t){return f.scale(o(t))}}}else{var v=t.map((function(t){return{text:s(t)}})),g=yJ(v,i,!1);n="function"==typeof(r=g)?r:function(){return r}}Object.assign(e,{getFontSize:o,fontSizeRange:a,fontSizeScale:n})},yJ=function(t,e,i){var n=e.shapeArea,r=e.ratio,a=e.segmentation.regions,o=Math.ceil(Math.sqrt(n)/12),s=t.reduce((function(t,e){var n=aJ(e.text);return n<o?t+n*(i?Math.pow(.5+.5*e.weight,2):1):t}),0);if(0===s)return 12;var l=20;if(1===a.length)l=Math.sqrt(r*(n/(1.7*s)));else{for(var u=[],c=0;c<a.length;c++){var h=a[c].area,d=a[c].ratio,p=h/n;if(!(p<.1)){var f=p*(s*(d<1?2.7-d:1.7)),v=Math.sqrt(r*(h/f));u.push(v)}}l=u.length?Math.min.apply(Math,u):Math.sqrt(r*(n/(1.7*s)))}return l};var mJ,_J,bJ=function(t,e){for(var i,n=1/0,r=-1/0,a=e.length,o=0;o<a;++o)(i=Rt(t(e[o])))<n&&(n=i),i>r&&(r=i);return 1===e.length&&n===r&&(n-=1e4),[n,r]},xJ=function(t,e,i){if(!t.size||j(t.size[0])||j(t.size[1])||t.size[0]<=0||t.size[1]<=0)return Ot.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];if(t.size=[Math.ceil(t.size[0]),Math.ceil(t.size[1])],t.shape||Ot.getInstance().error("WordcloudShape shape must be specified."),t.text||Ot.getInstance().error("WordcloudShape text must be specified."),t.onBeforeLayout&&t.onBeforeLayout(),!e||0===e.length)return[];var n=new fJ(t);return n.layout(e),n.unfinished()?{progressive:n}:n.output()},kJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.wordCloud,i}return M(i,e),i.type=t.SeriesTypeEnum.wordCloud,i}(Cq),SJ=function(){KF.registerGrammarTransform("wordcloud",{transform:QZ}),mX(),KF.registerAnimation("wordCloud",(function(t,e){return{appear:Eq(t,e),enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}}})),KF.registerSeries(kJ.type,kJ)},AJ=function(t,e){var i,n,r=t.map((function(t){return T({},t)}));if(!r||0===r.length)return r;var a=e.valueField,o=e.asTransformRatio,s=e.asReachRatio,l=e.asHeightRatio,u=e.asValueRatio,c=e.asNextValueRatio,h=e.asLastValueRatio,d=e.asLastValue,p=e.asCurrentValue,f=e.asNextValue,v=e.heightVisual,g=void 0!==v&&v,y=e.isCone,m=void 0===y||y,_=e.range,b=r.reduce((function(t,e){return Math.max(t,Number.parseFloat(e[a])||-1/0)}),-1/0),x=r.reduce((function(t,e){return Math.min(t,Number.parseFloat(e[a])||1/0)}),1/0),k=[null!==(i=null==_?void 0:_.min)&&void 0!==i?i:x,null!==(n=null==_?void 0:_.max)&&void 0!==n?n:b];return r.forEach((function(t,e){var i,n,v=Number.parseFloat(t[a]),y=Number.parseFloat(null===(i=r[e-1])||void 0===i?void 0:i[a]),_=Number.parseFloat(null===(n=r[e+1])||void 0===n?void 0:n[a]),b=et(_*v)&&0!==v?_/v:0,x=et(v*y)&&0!==y?v/y:0;d&&(t[d]=y),f&&(t[f]=_),o&&(t[o]=b),s&&(t[s]=0===e?1:x),l&&(t[l]=!0===g?b:1/r.length),u&&(t[u]=v/k[1]),c&&(t[c]=e===r.length-1?m?0:t[u]:_/k[1]),h&&(t[h]=0===e?1:y/k[1]),p&&(t[p]=v)})),r},MJ=function(t,e){var i,n,r=null===(n=null===(i=t[0])||void 0===i?void 0:i.latestData)||void 0===n?void 0:n.map((function(t){return T({},t)}));return r&&0!==r.length?(r.shift(),r.forEach((function(t){t[e.asIsTransformLevel]=!0})),r):r},TJ="".concat(mz,"_FUNNEL_TRANSFORM_RATIO"),wJ="".concat(mz,"_FUNNEL_REACH_RATIO"),CJ="".concat(mz,"_FUNNEL_HEIGHT_RATIO"),EJ="".concat(mz,"_FUNNEL_VALUE_RATIO"),PJ="".concat(mz,"_FUNNEL_LAST_VALUE_RATIO"),BJ="".concat(mz,"_FUNNEL_NEXT_VALUE_RATIO"),RJ="".concat(mz,"_FUNNEL_LAST_VALUE"),LJ="".concat(mz,"_FUNNEL_CURRENT_VALUE"),IJ="".concat(mz,"_FUNNEL_NEXT_VALUE"),DJ="".concat(mz,"_FUNNEL_TRANSFORM_LEVEL"),OJ=function(t){function e(e){var i,n,r=this;return(r=t.call(this,e)||this).dimensionTooltipTitleCallback=function(t,e){var i,n,a,o=r.series;return"transform"===(null===(i=null==e?void 0:e.mark)||void 0===i?void 0:i.name)?r._transformRatioText:null!==(n=r._getDimensionData(t))&&void 0!==n?n:null===(a=t.properties)||void 0===a?void 0:a["".concat(o.getCategoryField())]},r.markTooltipValueCallback=function(t,e){var i;if("transform"===(null===(i=null==e?void 0:e.mark)||void 0===i?void 0:i.name)){var n=null==t?void 0:t[wJ];return"".concat((100*n).toFixed(1),"%")}return r._getMeasureData(t)},r.markTooltipKeyCallback=function(t,e){var i;if("transform"===(null===(i=null==e?void 0:e.mark)||void 0===i?void 0:i.name))return r._transformRatioText;var n=r._seriesCacheInfo,a=n.dimensionFields,o=n.seriesFields,s=a[a.length-1];return U(o[0])?null==t?void 0:t[o[0]]:null==t?void 0:t[s]},r._transformRatioText=null!==(n=null===(i=e.getSpec())||void 0===i?void 0:i.transformRatioText)&&void 0!==n?n:"转化率",r}return M(e,t),e}(EV),FJ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultStyle=function(){return T(T({},t.prototype._getDefaultStyle.call(this)),{points:[]})},e}(RN),zJ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return M(e,t),e.prototype._getDefaultStyle=function(){return T(T({},t.prototype._getDefaultStyle.call(this)),{lineWidth:0})},e.type="polygon",e}(FJ),HJ=function(){KF.registerMark(zJ.type,zJ),lC(),iC(),$N(),KF.registerGraphicComponent("polygon",yg)},NJ=T(T({},VV),((mJ={}).funnel={name:"funnel",type:"polygon"},mJ.transform={name:"transform",type:"polygon"},mJ.transformLabel={name:"transformLabel",type:"text"},mJ.outerLabel={name:"outerLabel",type:"text"},mJ.outerLabelLine={name:"outerLabelLine",type:"rule"},mJ)),VJ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"funnel"),t.isTransform&&this._addMarkLabelSpec(t,"transform","transformLabel")},e}(nj),jJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.funnel,i._funnelMarkName="funnel",i._funnelMarkType="polygon",i._transformMarkName="transform",i._transformMarkType="polygon",i.transformerConstructor=VJ,i._funnelMark=null,i._funnelTransformMark=null,i._labelMark=null,i._transformLabelMark=null,i._funnelOuterLabelMark={},i}return M(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.setAttrFromSpec=function(){var t,i,n,r,a;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this._funnelOrient=null!==(t=this._spec.funnelOrient)&&void 0!==t?t:"top",this._shape=null!==(i=this._spec.shape)&&void 0!==i?i:"trapezoid",this._minLabelLineWidth=null!==(a=null===(r=null===(n=this._spec.outerLabel)||void 0===n?void 0:n.line)||void 0===r?void 0:r.minLength)&&void 0!==a?a:20,this._isHorizontal()?this._funnelAlign=["top","bottom"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center":this._funnelAlign=["left","right"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center",!this._seriesField&&this._spec.categoryField&&this.setSeriesField(this._spec.categoryField)},i.prototype.initData=function(){if(e.prototype.initData.call(this),this._data){kH(this._dataSet,"funnel",AJ),kH(this._dataSet,"funnelTransform",MJ);var t=new hs(this._dataSet,{name:"".concat(mz,"_series_").concat(this.id,"_viewDataTransform")});t.parse([this.getViewData()],{type:"dataview"}),this._viewDataTransform=new wN(this._option,t)}},i.prototype.compile=function(){var t,i;e.prototype.compile.call(this),this._funnelOuterLabelMark&&(null===(t=this._funnelOuterLabelMark.label)||void 0===t||t.compile({group:this._rootMark.getProduct()}),null===(i=this._funnelOuterLabelMark.line)||void 0===i||i.compile({group:this._rootMark.getProduct()}))},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._viewDataTransform)||void 0===t||t.compile()},i.prototype.getStatisticFields=function(){var t=[];return t.push({key:this._categoryField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t},i.prototype._statisticViewData=function(){var t,i,n,r,a,o,s,l,u;e.prototype._statisticViewData.call(this),this._data.getDataView().transform({type:"funnel",options:{valueField:this.getValueField(),isCone:this._spec.isCone,asCurrentValue:LJ,asTransformRatio:TJ,asReachRatio:wJ,asHeightRatio:CJ,asValueRatio:EJ,asNextValueRatio:BJ,asLastValueRatio:PJ,asLastValue:RJ,asNextValue:IJ,range:{min:null!==(i=null===(t=this._spec.range)||void 0===t?void 0:t.min)&&void 0!==i?i:null===(r=null===(n=this.getViewDataStatistics().latestData)||void 0===n?void 0:n[this.getValueField()])||void 0===r?void 0:r.min,max:null!==(o=null===(a=this._spec.range)||void 0===a?void 0:a.max)&&void 0!==o?o:null===(l=null===(s=this.getViewDataStatistics().latestData)||void 0===s?void 0:s[this.getValueField()])||void 0===l?void 0:l.max}}}),null===(u=this._viewDataTransform.getDataView())||void 0===u||u.transform({type:"funnelTransform",options:{asIsTransformLevel:DJ}})},i.prototype.initMark=function(){var t,e,n,r,a,o,s,l;if(this._funnelMark=this._createMark(T(T({},i.mark.funnel),{name:this._funnelMarkName,type:this._funnelMarkType}),{themeSpec:null===(t=this._theme)||void 0===t?void 0:t.funnel,groupKey:this._seriesField,isSeriesMark:!0,noSeparateStyle:!0},{morph:$V(this._spec,this._funnelMarkName),morphElementKey:this._seriesField}),this._spec.isTransform&&(this._funnelTransformMark=this._createMark(T(T({},i.mark.transform),{name:this._transformMarkName,type:this._transformMarkType}),{themeSpec:null===(e=this._theme)||void 0===e?void 0:e.transform,noSeparateStyle:!0}),this._funnelTransformMark&&this._funnelTransformMark.setData(this._viewDataTransform)),null===(r=null===(n=this._spec)||void 0===n?void 0:n.outerLabel)||void 0===r?void 0:r.visible){var u=(null!==(a=this._spec.outerLabel)&&void 0!==a?a:{}).line,c=(null!==(s=null===(o=this._theme)||void 0===o?void 0:o.outerLabel)&&void 0!==s?s:{}).line;this._funnelOuterLabelMark.label=this._createMark(i.mark.outerLabel,{themeSpec:null===(l=this._theme)||void 0===l?void 0:l.outerLabel,markSpec:this._spec.outerLabel,noSeparateStyle:!0,parent:!1}),this._funnelOuterLabelMark.line=this._createMark(i.mark.outerLabelLine,{themeSpec:c,markSpec:u,noSeparateStyle:!0,parent:!1})}},i.prototype.initTooltip=function(){this._tooltipHelper=new OJ(this),this._funnelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelMark),this._funnelTransformMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelTransformMark)},i.prototype.getDimensionField=function(){return this._seriesField?[this._seriesField]:[]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.getGroupFields=function(){return null},i.prototype.initMarkStyle=function(){var e,i,n,r,a=this,o=this._funnelMark;o&&this.setMarkStyle(o,{points:function(t){return a.getPoints(t)},visible:function(t){return U(t[a._valueField])},fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series);var s=this._funnelTransformMark;s&&this.setMarkStyle(s,{points:function(t){return a.getPoints(t)}},"normal",t.AttributeLevel.Series);var l=this._funnelOuterLabelMark.label;l&&(this.setMarkStyle(l,{text:function(t){return"".concat(t[a.getCategoryField()])},x:function(t){return a._computeOuterLabelPosition(t).x},y:function(t){return a._computeOuterLabelPosition(t).y},textAlign:function(t){return a._computeOuterLabelPosition(t).align},textBaseline:function(t){return a._computeOuterLabelPosition(t).textBaseline},maxLineWidth:function(t){return a._computeOuterLabelLimit(t)},width:0,height:0},"normal",t.AttributeLevel.Series),V(this._spec.outerLabel.formatMethod)&&this.setMarkStyle(l,{text:function(t){return a._spec.outerLabel.formatMethod("".concat(t[a.getCategoryField()]),t)}},"normal",t.AttributeLevel.User_Mark));var u=this._funnelOuterLabelMark.line;if(u&&l){this.setMarkStyle(u,{x:function(t){return a._computeOuterLabelLinePosition(t).x1},y:function(t){return a._computeOuterLabelLinePosition(t).y1},x1:function(t){return a._computeOuterLabelLinePosition(t).x2},y1:function(t){return a._computeOuterLabelLinePosition(t).y2}},"normal",t.AttributeLevel.Series);var c=null!==(n=null===(i=null===(e=this._spec.outerLabel)||void 0===e?void 0:e.line)||void 0===i?void 0:i.visible)&&void 0!==n?n:null===(r=this._spec.outerLabel)||void 0===r?void 0:r.visible;U(c)&&u.setVisible(c)}},i.prototype.initLabelMarkStyle=function(e){var i,n=this;if(e){var r=e.getTarget(),a=e.getComponent();if(r===this._funnelMark){this._labelMark=e,this.setMarkStyle(e,{text:function(t){return"".concat(t[n.getCategoryField()]," ").concat(t[n.getValueField()])},x:function(t){return n._computeLabelPosition(t).x},y:function(t){return n._computeLabelPosition(t).y},maxLineWidth:function(t){return n._computeLabelLimit(t,n._spec.label)},stroke:this.getColorAttribute()},"normal",t.AttributeLevel.Series);var o=this.getCompiler().getRootMarks();this._funnelOuterLabelMark.label&&lx(o,this._funnelOuterLabelMark.label,a),this._funnelOuterLabelMark.line&&lx(o,this._funnelOuterLabelMark.line,null!==(i=this._funnelOuterLabelMark.label)&&void 0!==i?i:a)}else this._funnelTransformMark&&r===this._funnelTransformMark&&(this._transformLabelMark=e,this.setMarkStyle(e,{text:function(t){var e=lF(wJ).bind(n)(t);return"".concat((100*e).toFixed(1),"%")},x:function(t){return n._computeLabelPosition(t).x},y:function(t){return n._computeLabelPosition(t).y},maxLineWidth:function(t){return n._computeLabelLimit(t,n._spec.transformLabel)}},"normal",t.AttributeLevel.Series))}},i.prototype.initAnimation=function(){var t,e,i,n,r,a,o,s=this,l=null!==(i=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset)&&void 0!==i?i:"clipIn";"clipIn"===l&&this._rootMark&&this._rootMark.setAnimationConfig(qV(null===(n=KF.getAnimationInKey("cartesianGroupClip"))||void 0===n?void 0:n({direction:function(){return s._isHorizontal()?"x":"y"},width:function(){var t=s.getRootMark().getProduct();if(t){var e=t.AABBBounds,i=e.x1,n=e.x2;return Math.max(i,n)}return s.getLayoutRect().width},height:function(){var t=s.getRootMark().getProduct();if(t){var e=t.AABBBounds,i=e.y1,n=e.y2;return Math.max(i,n)}return s.getLayoutRect().height},orient:function(){return s._isReverse()?"negative":"positive"}},l),ZV("group",this._spec,this._markAttributeContext))),[null===(r=this._funnelOuterLabelMark)||void 0===r?void 0:r.label].forEach((function(t){t&&t.setAnimationConfig(qV(KF.getAnimationInKey("fadeInOut")(),ZV(t.name,s._spec,s._markAttributeContext)))})),[this._funnelMark,this._funnelTransformMark].forEach((function(t){t&&t.setAnimationConfig(qV(KF.getAnimationInKey("funnel")({},l),ZV(t.name,s._spec,s._markAttributeContext)))})),(null===(a=this._funnelOuterLabelMark)||void 0===a?void 0:a.line)&&this._funnelOuterLabelMark.line.setAnimationConfig(qV(null===(o=KF.getAnimationInKey("fadeInOut"))||void 0===o?void 0:o(),ZV("outerLabelLine",this._spec,this._markAttributeContext)))},i.prototype.initGroups=function(){},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return null},i.prototype.initEvent=function(){var t,i=this;e.prototype.initEvent.call(this),null===(t=this._viewDataTransform.getDataView())||void 0===t||t.target.addListener("change",(function(t){i._viewDataTransform.updateData()}))},i.prototype.getPoints=function(t){var e,i,n=this.isTransformLevel(t),r=this._getMainAxisLength(n)/2;n?(e="rect"===this._shape?this._getSecondaryAxisLength(t[PJ])/2:this._getSecondaryAxisLength(t[EJ])/2,i=this._getSecondaryAxisLength(t[EJ])/2):(e=this._getSecondaryAxisLength(t[EJ])/2,i="rect"===this._shape?e:this._getSecondaryAxisLength(t[BJ])/2);var a=this._getPositionByData(t),o=a.x,s=a.y,l=this._getPolygonPoints([o,s],e,i,e,i,r);return"center"!==this._funnelAlign&&this._adjustPoints(l),l},i.prototype.isTransformLevel=function(t){return!!(null==t?void 0:t[DJ])},i.prototype._buildMarkAttributeContext=function(){e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getPoints=this.getPoints.bind(this),this._markAttributeContext.isTransformLevel=this.isTransformLevel.bind(this)},i.prototype.valueToPosition=function(t){var e,i,n,r=this,a=null===(n=null===(i=null===(e=this.getViewData())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i.find)||void 0===n?void 0:n.call(i,(function(e){return e[r._categoryField]===t}));return U(a)?this._getPolygonCenter(this.getPoints(a)):null},i.prototype.dataToPosition=function(t,e){return e&&!this.isDatumInViewData(t)?null:this.valueToPosition(t[this._categoryField])},i.prototype.dataToPositionX=function(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.x},i.prototype.dataToPositionY=function(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.y},i.prototype.dataToPositionZ=function(t){return 0},i.prototype._getMainAxisLength=function(t){var e;void 0===t&&(t=!1);var i=this.getViewData().latestData.length,n=this._isHorizontal()?this.getLayoutRect().width:this.getLayoutRect().height,r=!!this._spec.isTransform,a=r?0:null!==(e=this._spec.gap)&&void 0!==e?e:0,o=r?Math.max(0,i-1):0,s=this._spec.heightRatio||.5,l=(n-a*Math.max(0,i-1))/(i+s*o);return t?r?l*s:0:l},i.prototype._getSecondaryAxisLength=function(t){var e=Number.isNaN(t)||!Number.isFinite(t)?0:t,i=this._computeMaxSize(),n=this._computeMinSize();return n+(i-n)*e},i.prototype._getPositionByData=function(t){var e,i=this,n=null===(e=this.getViewData().latestData)||void 0===e?void 0:e.findIndex((function(e){return e[i._categoryField]===t[i._categoryField]&&e[Sz]===t[Sz]}));if(!U(n)||n<0)return{};var r=this.isTransformLevel(t),a=this._isHorizontal(),o=a?this.getLayoutRect().height:this.getLayoutRect().width,s=a?this.getLayoutRect().width:this.getLayoutRect().height,l=o/2,u=0,c=this._getMainAxisLength(),h=this._getMainAxisLength(!0);return u+=n*(c+h),u+=r?-h/2:c/2,!this._spec.isTransform&&this._spec.gap&&(u+=this._spec.gap*n),this._isReverse()&&(u=s-u),this._isHorizontal()?{x:u,y:l}:{x:l,y:u}},i.prototype._getPolygonPoints=function(t,e,i,n,r,a){var o=t[0],s=t[1];switch(this._funnelOrient){case"left":return[{x:o-a,y:s+e},{x:o-a,y:s-n},{x:o+a,y:s-r},{x:o+a,y:s+i}];case"right":return[{x:o+a,y:s-n},{x:o+a,y:s+n},{x:o-a,y:s+i},{x:o-a,y:s-i}];case"bottom":return[{x:o+e,y:s+a},{x:o-n,y:s+a},{x:o-r,y:s-a},{x:o+i,y:s-a}];default:return[{x:o-e,y:s-a},{x:o+n,y:s-a},{x:o+r,y:s+a},{x:o-i,y:s+a}]}},i.prototype._getPolygonCenter=function(t){if(this._isHorizontal()){var e=(t[0].x+t[3].x)/2,i=(t[0].y+t[3].y)/2;return{x:(e+(t[1].x+t[2].x)/2)/2,y:(i+(t[1].y+t[2].y)/2)/2}}var n=(t[0].x+t[3].x)/2,r=(t[0].y+t[3].y)/2;return{x:(n+(t[1].x+t[2].x)/2)/2,y:(r+(t[1].y+t[2].y)/2)/2}},i.prototype._adjustPoints=function(t){var e,i,n;return this._isHorizontal()?(n="y","left"===this._funnelOrient?(e="bottom"===this._funnelAlign?-t[1].y:t[1].y,i="bottom"===this._funnelAlign?-t[2].y:t[2].y):(e="bottom"===this._funnelAlign?-t[0].y:t[0].y,i="bottom"===this._funnelAlign?-t[3].y:t[3].y)):(n="x","top"===this._funnelOrient?(e="left"===this._funnelAlign?t[0].x:-t[0].x,i="left"===this._funnelAlign?t[3].x:-t[3].x):(e="left"===this._funnelAlign?t[1].x:-t[1].x,i="left"===this._funnelAlign?t[2].x:-t[2].x)),t[0][n]-=e,t[1][n]-=e,t[2][n]-=i,t[3][n]-=i,t},i.prototype._computeLabelPosition=function(t){var e=this.getPoints(t);return this._getPolygonCenter(e)},i.prototype._computeLabelLimit=function(t,e){var i=null==e?void 0:e.limit;if(Q(i))return i;var n=this.getPoints(t);return"shapeSize"===i?this._isHorizontal()?Math.abs(n[3].x-n[0].x):(Math.abs(n[0].x-n[1].x)+Math.abs(n[2].x-n[3].x))/2:this._isHorizontal()?Math.abs(n[3].x-n[0].x):void 0},i.prototype._computeOuterLabelPosition=function(t){var e,i,n,r,a,o=null===(i=this._spec.outerLabel)||void 0===i?void 0:i.position,s="center",l="middle";if(o=this._isHorizontal()?["top","bottom"].includes(o)?o:"bottom"===this._funnelAlign?"top":"bottom":["left","right"].includes(o)?o:"left"===this._funnelAlign?"right":"left",!1!==(null===(n=this._spec.outerLabel)||void 0===n?void 0:n.alignLabel))r=(e=this._getPositionByData(t)).x,a=e.y,"left"===o?(r=0,s="left"):"right"===o?(r=this.getLayoutRect().width,s="right"):"top"===o?(a=0,l="top"):"bottom"===o&&(a=this.getLayoutRect().height,l="bottom");else{var u=this._computeOuterLabelLinePosition(t);r=u.x2,a=u.y2,"left"===o?(r-=5,s="right"):"right"===o?(r+=5,s="left"):"top"===o?(a-=5,l="bottom"):"bottom"===o&&(a+=5,l="top")}return{x:r,y:a,align:s,textBaseline:l}},i.prototype._computeOuterLabelLimit=function(t){var e,i,n,r,a,o;if(this._isHorizontal())return this._getMainAxisLength(this.isTransformLevel(t));var s=this.getPoints(t),l=(Math.abs(s[0].x-s[1].x)+Math.abs(s[2].x-s[3].x))/2,u=this.getCategoryField(),c=null===(r=null===(n=null===(i=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent())||void 0===i?void 0:i.getComponent())||void 0===n?void 0:n.find((function(e){var i,n=e.attribute;return"text"===e.type&&(null===(i=n.data)||void 0===i?void 0:i[u])===t[u]}),!0))||void 0===r?void 0:r.AABBBounds,h=c?c.x2-c.x1:0,d=this._funnelOuterLabelMark.line?this._minLabelLineWidth:0,p=this.getLayoutRect().width-Math.max(l,h);return"center"===this._funnelAlign&&(p/=2),p-d-(null!==(o=null===(a=this._spec.outerLabel)||void 0===a?void 0:a.spaceWidth)&&void 0!==o?o:5)},i.prototype._computeOuterLabelLinePosition=function(t){var e,i,n,r,a,o,s,l,u,c,h,d,p,f,v=this.getCategoryField(),g=null===(r=null===(n=null===(i=null===(e=this._funnelOuterLabelMark)||void 0===e?void 0:e.label)||void 0===i?void 0:i.getGraphics())||void 0===n?void 0:n.find((function(e){var i;return(null===(i=e.context.data[0])||void 0===i?void 0:i[v])===t[v]})))||void 0===r?void 0:r.AABBBounds,y=null===(o=null===(a=this._labelMark)||void 0===a?void 0:a.getComponent())||void 0===o?void 0:o.getComponent(),m=null===(s=null==y?void 0:y.find((function(e){var i,n=e.attribute;return"text"===e.type&&(null===(i=n.data)||void 0===i?void 0:i[v])===t[v]}),!0))||void 0===s?void 0:s.AABBBounds,_=null!==(l=this._spec.outerLabel)&&void 0!==l?l:{};if(this._isHorizontal()){var b=null!==(u=_.spaceWidth)&&void 0!==u?u:5,x=this.getPoints(t),k=(Math.abs(x[0].y-x[1].y)+Math.abs(x[2].y-x[3].y))/2;return"top"===this._spec.outerLabel.position||"bottom"===this._funnelAlign?(p=this._getPolygonCenter(x).y-k/2-b,f=!1!==_.alignLabel?(null==g?void 0:g.y2)+b:p-b,h=this._getPolygonCenter(x).x,p-f<this._minLabelLineWidth&&(f=p-this._minLabelLineWidth),d=h):(p=this._getPolygonCenter(x).y+k/2+b,f=!1!==_.alignLabel?(null==g?void 0:g.y1)-b:p+b,h=this._getPolygonCenter(x).x,f-p<this._minLabelLineWidth&&(f=p+this._minLabelLineWidth),d=h),{x1:h,x2:d,y1:p,y2:f}}var S=this.getPoints(t),A=(Math.abs(S[0].x-S[1].x)+Math.abs(S[2].x-S[3].x))/2,M=(null==m?void 0:m.x2)-(null==m?void 0:m.x1)||0,T=null!==(c=_.spaceWidth)&&void 0!==c?c:5;return"right"===this._spec.outerLabel.position||"left"===this._funnelAlign?(h=this._getPolygonCenter(S).x+Math.max(M/2,A/2)+T,d=!1!==_.alignLabel?(null==g?void 0:g.x1)-T:h+T,p=this._getPolygonCenter(S).y,d-h<this._minLabelLineWidth&&(d=h+this._minLabelLineWidth),f=p):(h=this._getPolygonCenter(S).x-Math.max(M/2,A/2)-T,d=!1!==_.alignLabel?(null==g?void 0:g.x2)+T:h-T,p=this._getPolygonCenter(S).y,h-d<this._minLabelLineWidth&&(d=h-this._minLabelLineWidth),f=p),{x1:h,x2:d,y1:p,y2:f}},i.prototype._computeMaxSize=function(){var t,e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return BF(null!==(t=this._spec.maxSize)&&void 0!==t?t:"80%",e)},i.prototype._computeMinSize=function(){var t,e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return BF(null!==(t=this._spec.minSize)&&void 0!==t?t:0,e)},i.prototype._isHorizontal=function(){return"left"===this._funnelOrient||"right"===this._funnelOrient},i.prototype._isReverse=function(){return"bottom"===this._funnelOrient||"right"===this._funnelOrient},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._funnelMark]},i.type=t.SeriesTypeEnum.funnel,i.mark=NJ,i.builtInTheme={funnel:$F},i.transformerConstructor=VJ,i}(rj),UJ=function(){HJ(),mX(),CY(),KF.registerSeries(jJ.type,jJ),KF.registerAnimation("funnel",(function(t,e){return T({appear:"clipIn"===e?void 0:{type:"fadeIn"}},GN)})),KF.registerAnimation("cartesianGroupClip",(function(t){return{appear:{custom:lB,customParameters:function(e,i){return{animationType:"in",group:i,direction:t.direction(),width:t.width(),height:t.height(),orient:t.orient()}}},disappear:{custom:lB,customParameters:function(e,i){return{animationType:"out",group:i,direction:t.direction(),width:t.width(),height:t.height(),orient:t.orient()}}}}})),XN()},WJ=function(t,e){var i=(t-e[0])/(e[1]-e[0]||1);return Math.max(0,Math.min(1,i))},GJ=function(t){var e=t.filter((function(t){return t.context.diffState===gN.update})),i=Tt(e.map((function(t){var e,i;return null===(i=null===(e=null==t?void 0:t.context)||void 0===e?void 0:e.data)||void 0===i?void 0:i[0].depth})));return e.filter((function(t){var e,n;return(null===(n=null===(e=null==t?void 0:t.context)||void 0===e?void 0:e.data)||void 0===n?void 0:n[0].depth)===i}))},YJ=function(t,e,i){if(lt(t))return[e,i];var n=Tt(t.map((function(t){return 1*t.getFinalAttribute().startAngle}))),r=Mt(t.map((function(t){return 1*t.getFinalAttribute().endAngle})));return[n,r]},XJ=function(t){return{channel:{startAngle:{from:function(e,i){var n=t.animationInfo(),r=n.startAngle,a=n.endAngle,o=GJ(i.parent.children),s=YJ(o,r,a);return WJ(i.getFinalAttribute().startAngle,s)*(a-r)+r},to:function(t,e){return e.getFinalAttribute().startAngle}},endAngle:{from:function(e,i){var n=t.animationInfo(),r=n.startAngle,a=n.endAngle,o=GJ(i.parent.children),s=YJ(o,r,a);return WJ(i.getFinalAttribute().endAngle,s)*(a-r)+r},to:function(t,e){return e.getFinalAttribute().endAngle}},outerRadius:{from:function(t,e){return e.getFinalAttribute().innerRadius},to:function(t,e){return e.getFinalAttribute().outerRadius}},innerRadius:{from:function(t,e){return e.getFinalAttribute().innerRadius},to:function(t,e){return e.getFinalAttribute().innerRadius}}}}},KJ=function(t){var e=Tt(t.map((function(t){return 1*t.getFinalAttribute().startAngle}))),i=Mt(t.map((function(t){return 1*t.getFinalAttribute().endAngle})));return[e,i]},qJ=function(t){return{channel:{startAngle:{from:function(t,e){return e.getFinalAttribute().startAngle},to:function(e,i){var n=t.animationInfo(),r=n.startAngle,a=n.endAngle,o=GJ(i.parent.children),s=KJ(o);return WJ(i.getFinalAttribute().startAngle,s)*(a-r)+r}},endAngle:{from:function(t,e){return e.getFinalAttribute().endAngle},to:function(e,i){var n=t.animationInfo(),r=n.startAngle,a=n.endAngle,o=GJ(i.parent.children),s=KJ(o);return WJ(i.getFinalAttribute().endAngle,s)*(a-r)+r}},outerRadius:{from:function(t,e){return e.getFinalAttribute().outerRadius},to:function(){return t.animationInfo().innerRadius}},innerRadius:{from:function(t,e){return e.getFinalAttribute().innerRadius},to:function(){return t.animationInfo().innerRadius}}}}},ZJ=function(t,e){switch(e){case"fadeIn":return{type:"fadeIn"};case"growAngle":return{type:"growAngleIn"};default:return{type:"growRadiusIn"}}},JJ=function(t,e){if(void 0===e&&(e={}),!t)return[];var i=[];return Lq(t,i,e),i},QJ=function(t,e){if(!t)return t;var i=e(),n=i.width,r=i.height;return new oZ(i).layout(t,{width:n,height:r})},$J=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markTooltipKeyCallback=function(t){return null==t?void 0:t[e.series.getDimensionField()[0]]},e}return M(e,t),e}(EV);!function(t){t.DrillDown="drillDown",t.DrillUp="drillUp"}(_J||(_J={}));var tQ,eQ=function(t,e){var i,n=e.info(),r=e.keyField(),a=null==n?void 0:n.key;if(j(a))return t;if(n.type===_J.DrillDown)return St(i=eH(t,a,r,"children"));if(n.type===_J.DrillUp&&(i=iH(t,a,r,"children")))return St(i);return t},iQ=function(){function e(){}return e.prototype._getDrillTriggerEvent=function(t){var e;return null===(e=lY(this._drillParams.mode))||void 0===e?void 0:e[t]},e.prototype._hideTooltip=function(){var t=this.getChart().getComponentsByType(I.tooltip)[0];t&&t.hideTooltip()},e.prototype.initDrillable=function(t){this._drillParams=t},e.prototype.initDrillableData=function(t){var e=this,i=this._drillParams.getRawData;kH(t,"drillFilter",eQ),i().transform({type:"drillFilter",options:{info:function(){return e._drillInfo},keyField:function(){return e._drillParams.drillField()}}})},e.prototype.bindDrillEvent=function(){var t=this,e=this._drillParams,i=e.event,n=e.getRawData,r=(0,e.drillField)();this._getDrillTriggerEvent("start")&&i.on(this._getDrillTriggerEvent("start"),(function(e){var i,a,o;if(j(e.datum)||j(null===(i=e.datum)||void 0===i?void 0:i[r]))t.drillUp();else{t._hideTooltip();var s=e.datum[r],l=null!==(o=null===(a=t._drillInfo)||void 0===a?void 0:a.path)&&void 0!==o?o:[],u=function(t,e,i,n){void 0===i&&(i="key"),void 0===n&&(n="children");var r=[],a=function(t,o){var s,l;try{for(var u=P(t),c=u.next();!c.done;c=u.next()){var h=c.value;if(h[i]===e)return r.push.apply(r,R(R([],B(o),!1),[h[i].toString()],!1)),!0;if(h[n]){var d=a(h[n],R(R([],B(o),!1),[h[i]],!1));if(!0===d)return d}}}catch(t){s={error:t}}finally{try{c&&!c.done&&(l=u.return)&&l.call(u)}finally{if(s)throw s.error}}return!1};return a(t,[]),r}(n().rawData,s,r,"children");l[l.length-1]===u[u.length-1]?t.drillUp():t.drillDown(u)}}))},e.prototype.drillDown=function(e){void 0===e&&(e=[]);var i=this._drillParams,n=i.getRawData,r=i.event;if(!q(e)||lt(e))return e;var a=e[e.length-1];return this._drillInfo={key:a,path:e,type:_J.DrillDown},n().reRunAllTransform(),r.emit(t.ChartEvent.drill,{value:{path:e,type:_J.DrillDown},model:this}),e},e.prototype.drillUp=function(){var e,i,n=this._drillParams,r=n.getRawData,a=n.event,o=null!==(i=null===(e=this._drillInfo)||void 0===e?void 0:e.path)&&void 0!==i?i:[];if(!q(o)||lt(o))return o;var s=o.pop();return this._drillInfo={key:s,path:o,type:_J.DrillUp},r().reRunAllTransform(),a.emit(t.ChartEvent.drill,{value:{path:o,type:_J.DrillUp},model:this}),o},e}(),nQ=T(T({},VV),((tQ={}).sunburst={name:"sunburst",type:"arc"},tQ)),rQ=function(t,e,i){return t.push({key:e,operations:["values"]}),t.push({key:i,operations:["max","min"]}),t.push({key:IV,operations:["max","min","values"]}),t.push({key:DV,operations:["values"]}),t},aQ={innerRadius:0,outerRadius:1,startAngle:-90,endAngle:270,gap:0,labelLayout:{align:"center",offset:0,rotate:"radial"},sunburst:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1,cursor:"pointer"}},label:{visible:!0,style:{cursor:"pointer",fill:{type:"palette",key:"primaryFontColor"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},oQ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.sunburst,i}return M(i,e),i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.getValueField=function(){return this._valueField},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.setAttrFromSpec=function(){var t,i=this;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:DV),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:function(){var t;return null!==(t=i._spec.drillField)&&void 0!==t?t:Sz},getRawData:function(){return i.getRawData()}}),this._startAngle=Fe(this._spec.startAngle),this._endAngle=Fe(this._spec.endAngle),this._centerX=this._spec.centerX,this._centerY=this._spec.centerY,this._offsetX=this._spec.offsetX,this._offsetY=this._spec.offsetY,this.__innerRadius=this._spec.innerRadius,this.__outerRadius=this._spec.outerRadius,this._gap=this._spec.gap,this._labelLayout=this._spec.labelLayout,this._sunburst=this._spec.sunburst,this._label=this._spec.label,this._labelAutoVisible=this._spec.labelAutoVisible},i.prototype.initData=function(){var t=this;e.prototype.initData.call(this);var i=this.getRawData();i&&(this._spec.drill&&this.initDrillableData(this._dataSet),kH(this._dataSet,"sunburstLayout",QJ),kH(this._dataSet,"flatten",JJ),i.transform({type:"sunburstLayout",options:function(){var e=t._computeLevel(),i=e.innerRadius,n=e.outerRadius,r=e.gap,a=e.label;return{nodeKey:t._categoryField,width:t.getLayoutRect().width,height:t.getLayoutRect().height,center:[U(t._centerX)?t._centerX:t.getLayoutRect().width/2,U(t._centerY)?t._centerY:t.getLayoutRect().height/2],startAngle:t._startAngle,endAngle:t._endAngle,innerRadius:i,outerRadius:n,gapRadius:r,label:a}}}),i.transform({type:"flatten",options:{callback:function(t){if(t.datum){var e=t.datum[t.depth];return T(T({},t),e)}return t}}}))},i.prototype.getStatisticFields=function(){return rQ(e.prototype.getStatisticFields.call(this),this._categoryField,this._valueField)},i.prototype._addDataIndexAndKey=function(){var t=this.getRawData();j(null==t?void 0:t.dataSet)||(kH(t.dataSet,"addVChartProperty",xV),t.transform({type:"addVChartProperty",options:{beforeCall:HV.bind(this),call:NV}}))},i.prototype.initMark=function(){this._initArcMark(),this._initLabelMark()},i.prototype.initMarkStyle=function(){this._initArcMarkStyle(),this._initLabelMarkStyle()},i.prototype._initArcMark=function(){if(!1!==this._sunburst.visible){var t=this._createMark(i.mark.sunburst,{isSeriesMark:!0});this._sunburstMark=t}},i.prototype._initArcMarkStyle=function(){var e=this;j(this._sunburstMark)||this.setMarkStyle(this._sunburstMark,{x:function(t){return t.x+(U(e._offsetX)?e._offsetX:0)},y:function(t){return t.y+(U(e._offsetY)?e._offsetY:0)},outerRadius:function(t){return t.outerRadius},innerRadius:function(t){return t.innerRadius},startAngle:function(t){return t.startAngle},endAngle:function(t){return t.endAngle},fill:this.getColorAttribute()},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype._initLabelMark=function(){if(!0===this._label.visible){var t=this._createMark(i.mark.label,{isSeriesMark:!1});this._labelMark=t}},i.prototype._initLabelMarkStyle=function(){var e=this;j(this._labelMark)||this.setMarkStyle(this._labelMark,{visible:function(t){var i,n=e._labelAutoVisible;return W(n)&&!0===n.enable?(t.endAngle-t.startAngle)*(t.outerRadius-t.innerRadius)>(null!==(i=null==n?void 0:n.circumference)&&void 0!==i?i:10):e._spec.label.visible},x:function(t){var i;return(null===(i=t.label)||void 0===i?void 0:i.x)+(U(e._offsetX)?e._offsetX:0)},y:function(t){var i;return(null===(i=t.label)||void 0===i?void 0:i.y)+(U(e._offsetY)?e._offsetY:0)},textBaseline:function(t){var e;return null===(e=t.label)||void 0===e?void 0:e.textBaseline},textAlign:function(t){var e;return null===(e=t.label)||void 0===e?void 0:e.textAlign},angle:function(t){var e,i;return null!==(i=null===(e=t.label)||void 0===e?void 0:e.angle)&&void 0!==i?i:0},fontSize:10,text:function(t){return t.name}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.initTooltip=function(){this._tooltipHelper=new $J(this),this._sunburstMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._sunburstMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)},i.prototype.initAnimation=function(){var t,e,i=this,n={animationInfo:function(){return{innerRadius:i._computeRadius(St(i.__innerRadius))[0],outerRadius:i._computeRadius(St(i.__outerRadius))[0],startAngle:St(i._startAngle)[0],endAngle:St(i._endAngle)[0]}}},r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this.getMarksInType("arc").forEach((function(t){var e;t.setAnimationConfig(qV(null===(e=KF.getAnimationInKey("sunburst"))||void 0===e?void 0:e(n,r),ZV(t.name,i._spec,i._markAttributeContext)))})),this.getMarksInType("text").forEach((function(t){var e;t.setAnimationConfig(qV(null===(e=KF.getAnimationInKey("fadeInOut"))||void 0===e?void 0:e(),ZV(t.name,i._spec,i._markAttributeContext)))}))},i.prototype.initEvent=function(){e.prototype.initEvent.call(this),this._spec.drill&&this.bindDrillEvent()},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this._rawData.reRunAllTransform()},i.prototype._computeRadius=function(t){var e=this;return q(t)?t.map((function(t){return e._computeLayoutRadius()*t})):this._computeLayoutRadius()*t},i.prototype._computeLevel=function(){return{innerRadius:this._computeRadius(this.__innerRadius),outerRadius:this._computeRadius(this.__outerRadius),gap:this._gap,label:this._labelLayout}},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype._noAnimationDataKey=function(t,e){},i.prototype.getActiveMarks=function(){return[this._sunburstMark]},i.prototype.getMarkData=function(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t},i.type=t.SeriesTypeEnum.sunburst,i.mark=nQ,i.builtInTheme={sunburst:aQ},i}(OX);kt(oQ,iQ);var sQ,lQ=function(){KF.registerSeries(oQ.type,oQ),ZX(),mX(),XN(),KF.registerAnimation("sunburst",(function(t,e){return{appear:ZJ(0,e),enter:XJ(t),exit:qJ(t),disappear:qJ(t)}}))},uQ=function(t,e){if(!t)return t;var i=e(),n=i.width,r=i.height;return 0===n||0===r?t:new qq(i).layout(t,{width:n,height:r})},cQ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markTooltipKeyCallback=function(t){return null==t?void 0:t[e.series.getDimensionField()[0]]},e}return M(e,t),e}(EV),hQ=function(t){return"fadeIn"===t?{type:"fadeIn"}:{type:"growRadiusIn"}},dQ=T(T({},VV),((sQ={}).circlePacking={name:"circlePacking",type:"arc"},sQ)),pQ={layoutPadding:5,circlePacking:{visible:!0,style:{cursor:"pointer",lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}},label:{visible:!0,style:{cursor:"pointer",fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},fQ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.circlePacking,i}return M(i,e),i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.getValueField=function(){return this._valueField},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.setAttrFromSpec=function(){var t,i=this;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:DV),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:function(){var t;return null!==(t=i._spec.drillField)&&void 0!==t?t:Sz},getRawData:function(){return i.getRawData()}}),this._circlePacking=this._spec.circlePacking,this._label=this._spec.label,this._layoutPadding=this._spec.layoutPadding},i.prototype.initData=function(){var t=this;e.prototype.initData.call(this);var i=this.getRawData();j(i)||(this._spec.drill&&this.initDrillableData(this._dataSet),kH(this._dataSet,"circlePackingLayout",uQ),kH(this._dataSet,"flatten",JJ),i.transform({type:"circlePackingLayout",options:function(){return{nodeKey:t._categoryField,padding:t._layoutPadding,includeRoot:!1,width:t.getLayoutRect().width||1,height:t.getLayoutRect().height||1}}}),i.transform({type:"flatten",options:{callback:function(t){if(t.datum){var e=t.datum[t.depth];return T(T({},t),e)}return t}}}))},i.prototype._addDataIndexAndKey=function(){var t=this.getRawData();j(null==t?void 0:t.dataSet)||(kH(t.dataSet,"addVChartProperty",xV),t.transform({type:"addVChartProperty",options:{beforeCall:HV.bind(this),call:NV}}))},i.prototype.initMark=function(){this._initCirclePackingMark(),this._initLabelMark()},i.prototype.initMarkStyle=function(){this._initCirclePackingMarkStyle(),this._initLabelMarkStyle()},i.prototype._initCirclePackingMark=function(){var t;if(!1!==(null===(t=this._circlePacking)||void 0===t?void 0:t.visible)){var e=this._createMark(i.mark.circlePacking,{isSeriesMark:!0});this._circlePackingMark=e}},i.prototype._initCirclePackingMarkStyle=function(){j(this._circlePackingMark)||this.setMarkStyle(this._circlePackingMark,{x:function(t){return t.x},y:function(t){return t.y},outerRadius:function(t){return t.radius},innerRadius:0,startAngle:0,endAngle:2*Math.PI,fill:this.getColorAttribute(),zIndex:function(t){return t.depth}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype._initLabelMark=function(){var t;if(!1!==(null===(t=this._label)||void 0===t?void 0:t.visible)){var e=this._createMark(i.mark.label,{isSeriesMark:!1});this._labelMark=e}},i.prototype._initLabelMarkStyle=function(){j(this._labelMark)||this.setMarkStyle(this._labelMark,{x:function(t){return t.x},y:function(t){return t.y},text:function(t){return t.key},cursor:"pointer"},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.getStatisticFields=function(){return rQ(e.prototype.getStatisticFields.call(this),this._categoryField,this._valueField)},i.prototype.initTooltip=function(){this._tooltipHelper=new cQ(this),this._circlePackingMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._circlePackingMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)},i.prototype.initAnimation=function(){var t,e=this,i=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;this.getMarksInType("arc").forEach((function(t){var n;t.setAnimationConfig(qV(null===(n=KF.getAnimationInKey("circlePacking"))||void 0===n?void 0:n(void 0,i),ZV(t.name,e._spec,e._markAttributeContext)))})),this.getMarksInType("text").forEach((function(t){var i;t.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("scaleInOut"))||void 0===i?void 0:i(),ZV(t.name,e._spec,e._markAttributeContext)))}))},i.prototype.initEvent=function(){e.prototype.initEvent.call(this),this._spec.drill&&this.bindDrillEvent()},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this._rawData.reRunAllTransform()},i.prototype._noAnimationDataKey=function(t,e){},i.prototype.getActiveMarks=function(){return[this._circlePackingMark]},i.prototype.getMarkData=function(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t},i.type=t.SeriesTypeEnum.circlePacking,i.mark=dQ,i.builtInTheme={circlePacking:pQ},i}(lj);kt(fQ,iQ);var vQ=function(){KF.registerSeries(fQ.type,fQ),ZX(),mX(),YN(),KF.registerAnimation("circlePacking",(function(t,e){return{appear:hQ(e),enter:{type:"growRadiusIn"},exit:{type:"growRadiusOut"},disappear:{type:"growRadiusOut"}}}))},gQ=function(t,e,i){e.forEach((function(e){j(e[i])||t.add(e[i]),e.children&&e.children.length>0&&gQ(t,e.children,i)}))},yQ=function(t){var e;if(!t||!q(t))return[];if(t.length>1){var i={links:[],nodes:[]};return t.forEach((function(t){"links"!==t.id&&"nodes"!==t.id||(i[t.id]=t.values)})),[i]}return(null===(e=t[0])||void 0===e?void 0:e.latestData)?t[0].latestData:t},mQ=function(t,e){if(!t||!(null==e?void 0:e.view)||!t.length)return[];var i=e.view();if(i.x1-i.x0==0||i.y1-i.y0==0||i.x1-i.x0==-1/0||i.x1-i.x0==1/0||i.y1-i.y0==-1/0||i.y1-i.y0==1/0)return[];var n=t[0];if(("source"!==e.sourceField||"target"!==e.targetField||"value"!==e.valueField)&&n.links){var r=[];n.links.forEach((function(t){var i={};for(var n in t)n===e.sourceField?i.source=t[e.sourceField]:n===e.targetField?i.target=t[e.targetField]:n===e.valueField?i.value=t[e.valueField]:i[n]=t[n];r.push(i)})),n.links=r}var a=new nZ(e),o=[];return o.push(a.layout(n,i)),o},_Q=function(t){var e,i;return t&&q(t)&&(null===(e=t[0])||void 0===e?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!==(i=t[0].latestData[0].nodes)&&void 0!==i?i:[]},bQ=function(t){var e,i;return t&&q(t)&&(null===(e=t[0])||void 0===e?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!==(i=t[0].latestData[0].links)&&void 0!==i?i:[]},xQ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._getDimensionData=function(t){if(t.source){if(Q(t.source)){var i=e.series.getSeriesKeys();return i[t.source]+" => "+i[t.target]}return t.source+" => "+t.target}return t.datum?t.datum[e.series.getSpec().categoryField]:t.key},e.markTooltipValueCallback=function(t){return t.value},e}return M(e,t),e}(EV),kQ=function(t,e){return void 0===e&&(e=!0),{type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:{overall:e?t.growFrom():e,orient:"positive"}}},SQ=function(t,e){return"fadeIn"===e?{type:"fadeIn"}:kQ(t)},AQ=function(t){return"fadeIn"===t?{type:"fadeIn"}:{type:"linkPathGrowIn"}},MQ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.onBind=function(){var e,i,n;t.prototype.onBind.call(this),(null===(e=this.params)||void 0===e?void 0:e.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);var r,a,o=(r=this.target,this.params.options,this.params,a={x0:r.getFinalAttribute().x0,x1:r.getFinalAttribute().x1,y0:r.getFinalAttribute().y0,y1:r.getFinalAttribute().y1,thickness:r.getFinalAttribute().thickness},{from:Object.assign({},a,{x1:a.x0,y1:a.y0}),to:a}),s=o.from,l=o.to,u=null!==(n=null===(i=this.target.context)||void 0===i?void 0:i.lastAttrs)&&void 0!==n?n:s,c=this.target.getFinalAttribute();c&&Object.assign(this.target.attribute,c),this.props=l,this.propKeys=Object.keys(l).filter((function(t){return null!=l[t]})),this.animate.reSyncProps(),this.from=u,this.to=l,this.target.setAttributes(u)},e.prototype.onUpdate=function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.setAttributes(r)},e}(zP),TQ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.onBind=function(){var e,i,n;t.prototype.onBind.call(this),(null===(e=this.params)||void 0===e?void 0:e.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);var r,a,o=(r=this.target,this.params.options,this.params,{from:a={x0:r.getFinalAttribute().x0,x1:r.getFinalAttribute().x1,y0:r.getFinalAttribute().y0,y1:r.getFinalAttribute().y1,thickness:r.getFinalAttribute().thickness},to:Object.assign({},a,{x1:a.x0,y1:a.y0})}),s=o.from,l=o.to,u=null!==(n=null===(i=this.target.context)||void 0===i?void 0:i.lastAttrs)&&void 0!==n?n:s;this.props=l,this.propKeys=Object.keys(l).filter((function(t){return null!=l[t]})),this.animate.reSyncProps(),this.from=u,this.to=l,this.target.setAttributes(u)},e.prototype.onUpdate=function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.setAttributes(r)},e}(zP);!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}M(e,t),e.prototype.onBind=function(){var t,e,i;(null===(t=this.params)||void 0===t?void 0:t.diffAttrs)&&this.target.setAttributes(this.params.diffAttrs);var n=function(t,e,i){var n,r=t.getFinalAttribute();n={x0:r.x0,x1:r.x1,y0:r.y0,y1:r.y1};var a=t.attribute;return{from:n,to:{x0:a.x0,x1:a.x1,y0:a.y0,y1:a.y1}}}(this.target,this.params.options,this.params),r=n.from,a=n.to,o=null!==(i=null===(e=this.target.context)||void 0===e?void 0:e.lastAttrs)&&void 0!==i?i:r;this.props=a,this.propKeys=Object.keys(a).filter((function(t){return null!=a[t]})),this.animate.reSyncProps(),this.from=o,this.to=a,this.target.setAttributes(o)},e.prototype.onUpdate=function(t,e,i){var n=this,r=this.target.attribute;this.propKeys.forEach((function(t){r[t]=n.from[t]+(n.to[t]-n.from[t])*e})),this.target.setAttributes(r)}}(zP);var wQ,CQ,EQ=function(t,e){var i,n=null!==(i=t.curvature)&&void 0!==i?i:.5,r="number"==typeof e?t.thickness*e:t.thickness,a=t.x0,o=t.x1,s=t.y0,l=t.y1,u=a+n*(o-a),c=o+n*(a-o),h=function(t){return t};!1!==t.round&&(a=Math.round(a),o=Math.round(o),s=Math.round(s),l=Math.round(l),u=Math.round(u),c=Math.round(c),h=Math.round),"line"===t.pathType?"M".concat(a,",").concat(s,"L").concat(o,",").concat(l):"polyline"===t.pathType?"M".concat(a,",").concat(s,"L").concat(u,",").concat(s,"L").concat(u,",").concat(l,"L").concat(o,",").concat(l):"M".concat(a,",").concat(s,"C").concat(u,",").concat(s,",").concat(c,",").concat(l,",").concat(o,",").concat(l),"center"===t.align?(s=h(t.y0-r/2),l=h(t.y1-r/2)):"end"===t.align?(s=h(t.y0+t.thickness/2-r),l=h(t.y1+t.thickness/2-r)):(s=h(t.y0-t.thickness/2),l=h(t.y1-t.thickness/2));var d=h(s+r),p=h(l+r),f=Math.abs(o-a)>1e-6,v=t.endArrow&&f?"L".concat(o,",").concat(h(l-r/2),"L").concat(h(o+r),",").concat(h((l+p)/2),"L").concat(o,",").concat(h(p+r/2)):"",g=t.startArrow&&f?"L".concat(a,",").concat(h(d+r/2),"L").concat(h(a-r),",").concat(h((s+d)/2),"L").concat(a,",").concat(h(s-r/2)):"";return"line"===t.pathType?"M".concat(a,",").concat(s,"L").concat(o,",").concat(l).concat(v,"L").concat(o,",").concat(p,"L").concat(a,",").concat(d).concat(g,"Z"):"polyline"===t.pathType?"M".concat(a,",").concat(s,"L").concat(u,",").concat(s,"L").concat(u,",").concat(l,"L").concat(o,",").concat(l,"\n    ").concat(v,"L").concat(o,",").concat(p,"L").concat(u,",").concat(p,"L").concat(u,",").concat(d,"L").concat(a,",").concat(d).concat(g,"Z"):"M".concat(a,",").concat(s,"C").concat(u,",").concat(s,",").concat(c,",").concat(l,",").concat(o,",").concat(l,"\n  ").concat(v,"L").concat(o,",").concat(p,"C").concat(c,",").concat(p,",").concat(u,",").concat(d,",").concat(a,",").concat(d).concat(g,"Z")},PQ=function(t,e){var i,n=null!==(i=t.curvature)&&void 0!==i?i:.5,r="number"==typeof e?t.thickness*e:t.thickness,a=t.y0,o=t.y1,s=t.x0,l=t.x1,u=a+n*(o-a),c=o+n*(a-o),h=function(t){return t};!1!==t.round&&(h=Math.round,a=Math.round(a),o=Math.round(o),s=Math.round(s),l=Math.round(l),u=Math.round(u),c=Math.round(c)),"line"===t.pathType?"M".concat(s,",").concat(a,"L").concat(l,",").concat(o):"polyline"===t.pathType?"M".concat(s,",").concat(a,"L").concat(s,",").concat(u,"L").concat(l,",").concat(u,"L").concat(l,",").concat(o):"M".concat(s,",").concat(a,"C").concat(s,",").concat(u,",").concat(l,",").concat(c,",").concat(l,",").concat(o),"center"===t.align?(s=h(t.x0-r/2),l=h(t.x1-r/2)):"end"===t.align?(s=h(t.x0+t.thickness/2-r),l=h(t.x1+t.thickness/2-r)):(s=h(t.x0-t.thickness/2),l=h(t.x1-t.thickness/2));var d=h(s+r),p=h(l+r),f=Math.abs(o-a)>1e-6,v=t.endArrow&&f?"L".concat(h(l-r/2),",").concat(o,"L").concat(h((l+p)/2),",").concat(h(o+r),"L").concat(h(p+r/2),",").concat(o):"",g=t.startArrow&&f?"L".concat(h(d+r/2),",").concat(a,"L").concat(h((d+s)/2),",").concat(h(a-r),"L").concat(h(s-r/2),",").concat(a):"";return"line"===t.pathType?"M".concat(s,",").concat(a,"L").concat(l,",").concat(o).concat(v,"L").concat(p,",").concat(o,"L").concat(d,",").concat(a).concat(g,"Z"):"polyline"===t.pathType?"M".concat(s,",").concat(a,"L").concat(s,",").concat(u,"L").concat(l,",").concat(u,"L").concat(l,",").concat(o,"\n    ").concat(v,"L").concat(p,",").concat(o,"L").concat(p,",").concat(u,"L").concat(d,",").concat(u,"L").concat(d,",").concat(a).concat(g,"Z"):"M".concat(s,",").concat(a,"C").concat(s,",").concat(u,",").concat(l,",").concat(c,",").concat(l,",").concat(o,"\n  ").concat(v,"L").concat(p,",").concat(o,"C").concat(p,",").concat(c,",").concat(d,",").concat(u,",").concat(d,",").concat(a).concat(g,"Z")},BQ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._subMarks={back:{type:"path",defaultAttributes:{zIndex:0}},front:{type:"path",defaultAttributes:{zIndex:1}}},i._positionChannels=["x0","y0","x1","y1","thickness","round","curvature","ratio","pathType","align","endArrow","startArrow","ratio"],i._channelEncoder={backgroundStyle:function(t){return{back:t}}},i._positionEncoder=function(t,e,n){var r,a,o=T(T({},n.attribute),t),s=null!==(r=o.direction)&&void 0!==r?r:null===(a=i._glyphConfig)||void 0===a?void 0:a.direction,l=["vertical","TB","BT"].includes(s)?PQ:EQ,u="number"==typeof o.ratio&&o.ratio>=0&&o.ratio<=1;return{back:{path:u?l(o,1):""},front:{path:l(o,u?o.ratio:1)}}},i}return M(e,t),e.prototype._getDefaultStyle=function(){return T(T({},t.prototype._getDefaultStyle.call(this)),{x:0,y:0,x0:0,y0:0,x1:100,y1:100,thickness:1,round:!0})},e.type="linkPath",e}($Y),RQ=T(T({},VV),((wQ={}).node={name:"node",type:"rect"},wQ.link={name:"link",type:"linkPath"},wQ)),LQ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"node")},e}(nj),IQ=function(t,e,i,n,r){void 0===n&&(n=!0),t.runtimeStateCache||(t.runtimeStateCache={}),t.runtimeStateCache[e]=i,t.hasState(e)&&t.removeState(e),t.addState(e,n,r)},DQ={link:{style:{fillOpacity:.15,round:!0}}},OQ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.sankey,i.transformerConstructor=LQ,i._nodeLayoutZIndex=t.LayoutZIndex.Node,i._labelLayoutZIndex=t.LayoutZIndex.Label,i._viewBox=new mi,i._fillByNode=function(t){var e,n,r,a,o;if(t&&t.sourceRect&&t.targetRect)return i._fillByLink(t);var s=null===(n=null===(e=i._spec.node)||void 0===e?void 0:e.style)||void 0===n?void 0:n.fill;if(U(s))return s;if(U(i._spec.seriesField)){var l=null===(a=null===(r=i._option)||void 0===r?void 0:r.globalScale)||void 0===a?void 0:a.getScale("color"),u=(null==t?void 0:t.datum)?t.datum:t;return null==l?void 0:l.scale(null==u?void 0:u[i._spec.seriesField])}return null===(o=i._colorScale)||void 0===o?void 0:o.scale(i._getNodeNameFromData(t))},i._fillByLink=function(t){var e,n,r,a,o,s,l=null===(n=null===(e=i._spec.link)||void 0===e?void 0:e.style)||void 0===n?void 0:n.fill;if(l)return l;if(U(i._spec.seriesField)){var u=null===(r=i._nodesSeriesData.latestData)||void 0===r?void 0:r.find((function(e){return t.source===e.key})),c=null==u?void 0:u.datum,h=null===(o=null===(a=i._option)||void 0===a?void 0:a.globalScale)||void 0===o?void 0:o.getScale("color");return null==h?void 0:h.scale(null==c?void 0:c[i._spec.seriesField])}var d=Q(t.source)?i.getNodeList()[t.source]:t.source;return null===(s=i._colorScale)||void 0===s?void 0:s.scale(d)},i._handleEmphasisElement=function(t){var e,n=null!==(e=i._spec.emphasis)&&void 0!==e?e:{},r=t.item;"adjacency"===n.effect?r&&t.mark===i._nodeMark?i._handleNodeAdjacencyClick(r):r&&t.mark===i._linkMark?i._handleLinkAdjacencyClick(r):i._handleClearEmpty():"related"===n.effect&&(r&&t.mark===i._nodeMark?i._handleNodeRelatedClick(r):r&&t.mark===i._linkMark?i._handleLinkRelatedClick(r):i._handleClearEmpty())},i._handleClearEmpty=function(){var e,n;if(i._needClear){var r=null===(e=i._nodeMark)||void 0===e?void 0:e.getGraphics();if(r&&r.length){var a=null===(n=i._linkMark)||void 0===n?void 0:n.getGraphics();a&&a.length&&(r.forEach((function(e){e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE)})),a.forEach((function(e){e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE)})),i._needClear=!1)}}},i._handleNodeAdjacencyClick=function(e){var n=cH(e),r=[n.key];if(i._linkMark){var a=i._linkMark.getGraphics();if(!a||!a.length)return;a.forEach((function(e,i){var a=cH(e);a.source===n.key?(r.includes(a.target)||r.push(a.target),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,!0)):a.target===n.key?(r.includes(a.source)||r.push(a.source),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,!0)):(e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE,!0))}))}i._nodeMark&&i._highLightElements(i._nodeMark.getGraphics(),r),i._needClear=!0},i._handleLinkAdjacencyClick=function(e){var n=cH(e),r=[n.source,n.target];if(i._linkMark){var a=i._linkMark.getGraphics();if(!a||!a.length)return;a.forEach((function(i){i===e?(i.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),IQ(i,t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:1})):(i.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),i.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE,!0))}))}i._nodeMark&&i._highLightElements(i._nodeMark.getGraphics(),r),i._needClear=!0},i._handleNodeRelatedClick=function(e){var n,r=cH(e),a=i._nodeMark.getGraphics();if(a&&a.length){var o=i._linkMark.getGraphics();if(o&&o.length){var s=(null===(n=cH(o[0]))||void 0===n?void 0:n.parents)?"parents":"source";if("source"===s){var l=[r.key],u=[];if(o.forEach((function(t,e){var i,n,o,s,c=cH(t),h=(null==c?void 0:c.parents)?"parents":"source";if(St(c[h]).includes(r.key)){if(u.includes(null!==(i=c.key)&&void 0!==i?i:c.index)||u.push(null!==(n=c.key)&&void 0!==n?n:c.index),l.includes(c.source)||l.push(c.source),!l.includes(c.target)){l.push(c.target);for(var d=a.find((function(t){return t.data[0].key===c.target})).data[0].sourceLinks,p=function(){var t=[];return d.forEach((function(e){var i,n;if(!u.includes(null!==(i=e.key)&&void 0!==i?i:e.index)&&(u.push(null!==(n=e.key)&&void 0!==n?n:e.index),!l.includes(e.target))){l.push(e.target);var r=a.find((function(t){return t.data[0].key===e.target}));t.push(r.data[0].targetLinks)}})),d=t,{value:void 0}};(null==d?void 0:d.length)>0;){var f=p();if("object"==typeof f)return f.value}}}else if(c.target===r.key&&(u.includes(null!==(o=c.key)&&void 0!==o?o:c.index)||u.push(null!==(s=c.key)&&void 0!==s?s:c.index),!l.includes(c.source))){l.push(c.source);for(var v=a.find((function(t){return t.data[0].key===c.source})).data[0].targetLinks,g=function(){var t=[];return v.forEach((function(e){var i,n;if(!u.includes(null!==(i=e.key)&&void 0!==i?i:e.index)&&(u.push(null!==(n=e.key)&&void 0!==n?n:e.index),!l.includes(e.source))){l.push(e.source);var r=a.find((function(t){return t.data[0].key===e.source}));t.push(r.data[0].targetLinks)}})),v=t,{value:void 0}};(null==v?void 0:v.length)>0;){var y=g();if("object"==typeof y)return y.value}}})),i._linkMark){var c=i._linkMark.getGraphics();if(!c||!c.length)return;c.forEach((function(e,i){var n,r=cH(e);u.includes(null!==(n=r.key)&&void 0!==n?n:r.index)?(e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,!0)):(e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE,!0))}))}i._nodeMark&&i._highLightElements(i._nodeMark.getGraphics(),l)}else{var h=[r.key],d=r.targetLinks.reduce((function(t,e){return St(e.datum).forEach((function(e){for(var i=e.parents,n=i.length,a=function(n){var a=i[n].key,o=i[n+1]?i[n+1].key:r.key,s=e.value,l=t.find((function(t){return t.source===a&&t.target===o}));l?l.value+=s:t.push({source:a,target:o,value:s})},o=0;o<n;o++)a(o)})),t}),[]);o.forEach((function(e,i){var n=cH(e),a=n.datum,o=a?a.filter((function(t){return t[s].some((function(t){return t.key===r.key}))})):null,l=d.find((function(t){return t.source===n.source&&t.target===n.target}));if(o&&o.length){h.includes(n.source)||h.push(n.source),h.includes(n.target)||h.push(n.target);var u=o.reduce((function(t,e){return t+e.value}),0),c=u/n.value;return e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),void IQ(e,t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:c})}if(l)return h.includes(n.source)||h.push(n.source),h.includes(n.target)||h.push(n.target),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),void IQ(e,t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:l.value/n.value});e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE,!0)})),i._nodeMark&&i._highLightElements(i._nodeMark.getGraphics(),h)}i._needClear=!0}}},i._handleLinkRelatedClick=function(e){var n=i._nodeMark.getGraphics();if(n&&n.length){var r=i._linkMark.getGraphics();if(r&&r.length){if("source"===(cH(e)?"parents":"source"))i._linkMark&&r.forEach((function(e){e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE)})),i._nodeMark&&n.forEach((function(e){e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE)}));else{var a=cH(e),o=[a.source,a.target],s=[];St(a.datum).forEach((function(t){for(var e=t.parents,i=e.length,n=function(i){var n=e[i].key,r=e[i+1].key,a=t.value,o=s.find((function(t){return t.source===n&&t.target===r}));s.push({source:e[i].key,target:e[i+1].key,value:t.value}),o?o.value+=a:s.push({source:n,target:r,value:a})},r=0;r<i-1;r++)n(r)})),r.forEach((function(e){var i=cH(e),n=i.datum;if(i.source===a.source&&i.target===a.target)return e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),void IQ(e,t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:1});var r=n?n.filter((function(t){var e=t.parents.map((function(t){return t.key}));return e.includes(a.source)&&e.includes(a.target)})):null;if(r&&r.length){o.includes(i.source)||o.push(i.source),o.includes(i.target)||o.push(i.target);var l=r.filter((function(t){return t.parents.some((function(e,i){var n;return e.key===a.source&&(null===(n=t.parents[i+1])||void 0===n?void 0:n.key)===a.target}))})).reduce((function(t,e){return t+e.value}),0),u=l/i.value;return e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),void IQ(e,t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:u})}var c=s.find((function(t){return t.source===i.source&&t.target===i.target}));if(c)return o.includes(i.source)||o.push(i.source),o.includes(i.target)||o.push(i.target),e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),void IQ(e,t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:c.value/i.value});e.removeState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE,!0)})),i._highLightElements(n,o)}i._needClear=!0}}},i}return M(i,e),Object.defineProperty(i.prototype,"direction",{get:function(){var t;return null!==(t=this._spec.direction)&&void 0!==t?t:"horizontal"},enumerable:!1,configurable:!0}),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:this._spec.categoryField)},i.prototype.initData=function(){var i,n,r,a,o=this;e.prototype.initData.call(this);var s=this.getViewData(),l=this.getRawData();if(l&&s){kH(this._dataSet,"sankeyLayout",mQ),kH(this._dataSet,"sankeyFormat",yQ),l.transform({type:"sankeyFormat"},!1),s.transform({type:"sankeyLayout",options:{view:function(){return{x0:o._viewBox.x1,x1:o._viewBox.x2,y0:o._viewBox.y1,y1:o._viewBox.y2}},sourceField:this._spec.sourceField,targetField:this._spec.targetField,valueField:this._spec.valueField,direction:this.direction,crossNodeAlign:this._spec.crossNodeAlign,nodeAlign:null!==(i=this._spec.nodeAlign)&&void 0!==i?i:"justify",nodeGap:null!==(n=this._spec.nodeGap)&&void 0!==n?n:8,nodeWidth:null!==(r=this._spec.nodeWidth)&&void 0!==r?r:10,linkWidth:this._spec.linkWidth,minStepWidth:this._spec.minStepWidth,minNodeHeight:null!==(a=this._spec.minNodeHeight)&&void 0!==a?a:4,maxNodeHeight:this._spec.maxNodeHeight,minLinkHeight:this._spec.minLinkHeight,maxLinkHeight:this._spec.maxLinkHeight,iterations:this._spec.iterations,nodeKey:this._spec.nodeKey,linkSortBy:this._spec.linkSortBy,nodeSortBy:this._spec.nodeSortBy,setNodeLayer:this._spec.setNodeLayer,dropIsolatedNode:this._spec.dropIsolatedNode,nodeHeight:this._spec.nodeHeight,linkHeight:this._spec.linkHeight,equalNodeHeight:this._spec.equalNodeHeight,linkOverlap:this._spec.linkOverlap,inverse:this._spec.inverse},level:t.TransformLevel.sankeyLayout});var u=this._option.dataSet;kH(u,"sankeyNodes",_Q),kH(u,"flatten",JJ);var c=new hs(u,{name:"sankey-node-".concat(this.id,"-data")});c.parse([this.getViewData()],{type:"dataview"}),c.transform({type:"sankeyNodes"}),c.transform({type:"flatten",options:{callback:function(t){if(t.datum){var e=t.datum[t.depth];return T(T({},t),e)}return t}}},!1),c.transform({type:"addVChartProperty",options:{beforeCall:FV.bind(this),call:zV}},!1),this._nodesSeriesData=c,kH(u,"sankeyLinks",bQ);var h=new hs(u,{name:"sankey-link-".concat(this.id,"-data")});h.parse([this.getViewData()],{type:"dataview"}),h.transform({type:"sankeyLinks"}),h.transform({type:"addVChartProperty",options:{beforeCall:FV.bind(this),call:zV}},!1),this._linksSeriesData=h}},i.prototype.compileData=function(){var t,i;e.prototype.compileData.call(this),null===(t=this._linkMark)||void 0===t||t.compileData(),null===(i=this._nodeMark)||void 0===i||i.compileData()},i.prototype.initMark=function(){this._rootMark.setMarkConfig({overflow:this._spec.overflow,interactive:!!this._spec.overflow});var t=this._createMark(i.mark.node,{isSeriesMark:!0,dataView:this._nodesSeriesData});t&&(t.setMarkConfig({zIndex:this._nodeLayoutZIndex}),this._nodeMark=t);var e=this._createMark(i.mark.link,{dataView:this._linksSeriesData});e&&(this._linkMark=e)},i.prototype._buildMarkAttributeContext=function(){e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.valueToNode=this.valueToNode.bind(this),this._markAttributeContext.valueToLink=this.valueToLink.bind(this)},i.prototype.valueToNode=function(t){var e=this._nodesSeriesData.latestData,i=St(t)[0];return e&&e.find((function(t){return t.key===i}))},i.prototype.valueToLink=function(t){var e=this._linksSeriesData.latestData,i=St(t);return e&&e.find((function(t){return t&&t.source===i[0]&&t.target===i[1]}))},i.prototype.valueToPositionX=function(t){var e=this.valueToNode(t);return null==e?void 0:e.x0},i.prototype.valueToPositionY=function(t){var e=this.valueToNode(t);return null==e?void 0:e.y0},i.prototype.initMarkStyle=function(){this._initNodeMarkStyle(),this._initLinkMarkStyle()},i.prototype._initNodeMarkStyle=function(){var e,i,n=this._nodeMark;n&&(this.setMarkStyle(n,{x:function(t){return t.x0},x1:function(t){return t.x1},y:function(t){return t.y0},y1:function(t){return t.y1}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Mark),this.setMarkStyle(n,{fill:null!==(i=null===(e=this._spec.node.style)||void 0===e?void 0:e.fill)&&void 0!==i?i:this._fillByNode},"normal",t.AttributeLevel.User_Mark))},i.prototype._initLinkMarkStyle=function(){var e,i,n=this._linkMark;n&&(n.setGlyphConfig({direction:this.direction}),this.setMarkStyle(n,{x0:function(t){return t.x0},x1:function(t){return t.x1},y0:function(t){return t.y0},y1:function(t){return t.y1},thickness:function(t){return t.thickness}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series),this.setMarkStyle(n,{fill:null!==(i=null===(e=this._spec.link.style)||void 0===e?void 0:e.fill)&&void 0!==i?i:this._fillByLink},"normal",t.AttributeLevel.User_Mark))},i.prototype.initLabelMarkStyle=function(t,e){var i=this;if(t){var n=e.position;n&&n.includes("inside")?this.setMarkStyle(t,{fill:"#ffffff",text:function(t){return i._createText(t,e)},maxLineWidth:function(t){var i;return null!==(i=e.limit)&&void 0!==i?i:t.x1-t.x0}}):this.setMarkStyle(t,{fill:this._fillByNode,text:function(t){return i._createText(t,e)},maxLineWidth:e.limit}),t.setMarkConfig({zIndex:this._labelLayoutZIndex})}},i.prototype._createText=function(t,e){if(j(t)||j(t.datum))return"";var i=t.datum[this._spec.categoryField]||"",n=e||{},r=mV(n.formatMethod,n.formatter,i,t.datum),a=r.formatFunc,o=r.args;return a&&(i=a.apply(void 0,R(R([],B(o),!1),[{series:this}],!1))),i},i.prototype.initAnimation=function(){var t,e,i,n,r=this,a={direction:this.direction,growFrom:function(){var t,e;return"horizontal"===r.direction?null===(t=r._xAxisHelper)||void 0===t?void 0:t.getScale(0).scale(0):null===(e=r._yAxisHelper)||void 0===e?void 0:e.getScale(0).scale(0)}},o=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._nodeMark&&this._nodeMark.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("sankeyNode"))||void 0===i?void 0:i(a,o),ZV("node",this._spec,this._markAttributeContext))),this._linkMark&&this._linkMark.setAnimationConfig(qV(null===(n=KF.getAnimationInKey("sankeyLinkPath"))||void 0===n?void 0:n(a,o),ZV("link",this._spec,this._markAttributeContext)))},i.prototype.initEvent=function(){var t,i,n;e.prototype.initEvent.call(this),null===(t=this._nodesSeriesData)||void 0===t||t.target.addListener("change",this.nodesSeriesDataUpdate.bind(this)),null===(i=this._linksSeriesData)||void 0===i||i.target.addListener("change",this.linksSeriesDataUpdate.bind(this));var r=null!==(n=this._spec.emphasis)&&void 0!==n?n:{};if(!0!==this._option.disableTriggerEvent&&r.enable&&("adjacency"===r.effect||"related"===r.effect)){var a="hover"===r.trigger?"pointerover":"pointerdown";this.event.on(a,{level:gH.chart},this._handleEmphasisElement)}},i.prototype.nodesSeriesDataUpdate=function(){this._nodeMark.getData().updateData(),this._nodeList=null,this._setNodeOrdinalColorScale()},i.prototype.linksSeriesDataUpdate=function(){this._linkMark.getData().updateData()},i.prototype._highLightElements=function(e,i){e&&e.length&&e.forEach((function(e){e.removeState([t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE,t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS]),i.includes(cH(e).key)?e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,!0):e.addState(t.STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE,!0)}))},i.prototype.initTooltip=function(){this._tooltipHelper=new xQ(this),this._nodeMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodeMark),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark)},i.prototype._setNodeOrdinalColorScale=function(){var t,e,i,n,r,a=null===(e=null===(t=this._option)||void 0===t?void 0:t.globalScale)||void 0===e?void 0:e.getScale("color");if(null==a?void 0:a._specified)this._colorScale=a;else{var o,s;a&&(o=a.domain(),s=a.range()),s||(s=this._getDataScheme()),o&&!j(o[0])||(o=this.getNodeList()).length>10&&(s=null===(i=this._getDataScheme()[1])||void 0===i?void 0:i.scheme);var l=new xF;null===(r=(n=l.domain(o)).range)||void 0===r||r.call(n,s),this._colorScale=l}},i.prototype.getNodeList=function(){var t,e,i=this;if(this._nodeList)return this._nodeList;var n=this._rawData.latestData[0],r=(null==n?void 0:n.nodes)?(null===(t=n.nodes[0])||void 0===t?void 0:t.children)?Array.from(this.extractNamesFromTree(n.nodes,this._spec.categoryField)):n.nodes.map((function(t,e){return t[i._spec.categoryField]})):(null==n?void 0:n.links)?Array.from(this.extractNamesFromLink(n.links)):null===(e=null==n?void 0:n.values)||void 0===e?void 0:e.map((function(t,e){return t[i._spec.categoryField]}));return this._nodeList=r,r},i.prototype._getNodeNameFromData=function(t){var e;return(null==t?void 0:t.datum)?t.datum[this._spec.categoryField]:null!==(e=t.key)&&void 0!==e?e:t[this._spec.categoryField]},i.prototype.extractNamesFromTree=function(t,e){var i=this,n=new Set;return t.forEach((function(t){(n.add(t[e]),t.children)&&i.extractNamesFromTree(t.children,e).forEach((function(t){return n.add(t)}))})),n},i.prototype.extractNamesFromLink=function(t){var e=new Set,i=this._spec,n=i.sourceField,r=i.targetField;return t.forEach((function(t){U(t[n])&&e.add(t[n]),U(t[r])&&e.add(t[r])})),e},i.prototype.getDimensionField=function(){return[this._spec.categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.getRawDataStatisticsByField=function(t,e){var i;(this._rawStatisticsCache||(this._rawStatisticsCache={}),this._rawStatisticsCache[t])||(this._viewDataStatistics&&this.getViewData().transformsArr.length<=1&&(null===(i=this._viewDataStatistics.latestData)||void 0===i?void 0:i[t])?this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t]:this._rawData&&(this._rawStatisticsCache[t]={values:this._collectByField(t)}));return this._rawStatisticsCache[t]},i.prototype._collectByField=function(t){var e,i,n,r=this,a=[],o=null===(i=null===(e=this.getRawData())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i[0];if(!o)return[];if(o.links)(null===(n=o.nodes)||void 0===n?void 0:n.length)&&o.nodes.forEach((function(t){t[r._seriesField]&&a.push(t[r._seriesField])}));else if(o.nodes){var s=new Set;return gQ(s,o.nodes,this._seriesField),Array.from(s)}return a},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this.getViewData().reRunAllTransform()},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype._noAnimationDataKey=function(t,e){},i.prototype.getActiveMarks=function(){return[this._nodeMark,this._linkMark]},i.prototype.getMarkData=function(t){return t.datum?q(t.datum)?t.datum[t.datum.length-1]:t.datum:t},i.type=t.SeriesTypeEnum.sankey,i.transformerConstructor=LQ,i.mark=RQ,i.builtInTheme={sankey:DQ},i}(lj),FQ=function(){MG(),tX(),tC(),KF.registerGraphicComponent("path",(function(t){return lg(t)})),KF.registerMark(BQ.type,BQ),mX(),KF.registerAnimation("sankeyNode",(function(t,e){return T({appear:SQ(t,e)},GN)})),KF.registerAnimation("sankeyLinkPath",(function(t,e){return{appear:AQ(e),enter:{type:"linkPathGrowIn"},exit:{type:"linkPathGrowOut"},disappear:{type:"linkPathGrowOut"}}})),wP.registerBuiltInAnimate("linkPathGrowOut",TQ),wP.registerBuiltInAnimate("linkPathGrowIn",MQ),XN(),KF.registerSeries(OQ.type,OQ)},zQ=function(t,e){var i={},n=e.fields;if(V(n)&&(n=n()),!(null==n?void 0:n.length)||!(null==t?void 0:t.length))return i;if(!t[0].latestData)return i;var r=t[0].latestData,a=JJ(r);return i=BV([{latestData:a}],e)},HQ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markTooltipKeyCallback=function(t){var i,n;return null===(n=null===(i=e.series)||void 0===i?void 0:i.getMarkData(t))||void 0===n?void 0:n[e.series.getDimensionField()[0]]},e.markTooltipValueCallback=function(t){var i,n,r=e._seriesCacheInfo.measureFields,a=null===(i=e.series)||void 0===i?void 0:i.getMarkData(t);if(r[0]&&a)return null!==(n=a[r[0]])&&void 0!==n?n:t.value},e.dimensionTooltipTitleCallback=function(t){var i,n=e._seriesCacheInfo.dimensionFields,r=null===(i=e.series)||void 0===i?void 0:i.getMarkData(t);if(n[0]&&r)return r[n[0]]},e}return M(e,t),Object.defineProperty(e.prototype,"defaultShapeType",{get:function(){return"square"},enumerable:!1,configurable:!0}),e}(EV),NQ=T(T({},VV),((CQ={}).nonLeaf={name:"nonLeaf",type:"rect"},CQ.leaf={name:"leaf",type:"rect"},CQ.nonLeafLabel={name:"nonLeafLabel",type:"text"},CQ)),VQ=function(t){return"fadeIn"===t?{type:"fadeIn"}:{type:"growCenterIn"}},jQ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"nonLeaf","nonLeafLabel","initNonLeafLabelMarkStyle"),this._addMarkLabelSpec(t,"leaf")},e}(nj),UQ=function(){KF.registerGrammarTransform("filter",{transform:function(t,e){return null==e?void 0:e.filter(t.callback)}})},WQ=function(){KF.registerGrammarTransform("map",{transform:function(t,e){return null==e||e.forEach((function(e,i){t.callback(e)})),e}})},GQ=function(t,e){if(e.getViewBox()){var i=new cZ(e).layout(t,e.getViewBox()),n=[];return Lq(i,n,{maxDepth:null==e?void 0:e.maxDepth}),n.forEach((function(t,i){t&&[DV,"name"].forEach((function(i){t[i]=t.datum[t.depth][e.nameField]}))})),n}return[]},YQ={gapWidth:1,nodePadding:[5],nonLeaf:{visible:!1,style:{fillOpacity:.5}},label:{style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},nonLeafLabel:{padding:24,style:{fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},textBaseline:"middle",textAlign:"center"}}},XQ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.treemap,i.transformerConstructor=jQ,i._categoryField="name",i._valueField="value",i._viewBox=new mi,i._enableAnimationHook=i.enableMarkAnimation.bind(i),i.isHierarchyData=function(){return!0},i}return M(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.setAttrFromSpec=function(){var t,i=this;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:DV),this._spec.roam&&(this.initZoomable(this.event,this._option.mode),this._matrix=new xi),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:function(){var t,e;return null!==(e=null!==(t=i._spec.drillField)&&void 0!==t?t:i._categoryField)&&void 0!==e?e:Sz},getRawData:function(){return i.getRawData()}}),et(this._spec.maxDepth)&&(this._maxDepth=this._spec.maxDepth-1)},i.prototype.initData=function(){var t,i,n,r,a,o=this;e.prototype.initData.call(this),kH(this._dataSet,"treemap",GQ),null===(t=this._data.getDataView())||void 0===t||t.transform({type:"treemap",options:{nameField:this._categoryField,valueField:this._valueField,getViewBox:function(){return o._viewBox.empty()?null:{x0:o._viewBox.x1,x1:o._viewBox.x2,y0:o._viewBox.y1,y1:o._viewBox.y2}},maxDepth:this._maxDepth,gapWidth:this._spec.gapWidth,padding:this._spec.nodePadding,splitType:this._spec.splitType,aspectRatio:this._spec.aspectRatio,labelPadding:(null===(i=this._spec.nonLeafLabel)||void 0===i?void 0:i.visible)?null===(n=this._spec.nonLeafLabel)||void 0===n?void 0:n.padding:0,labelPosition:null===(r=this._spec.nonLeafLabel)||void 0===r?void 0:r.position,minVisibleArea:null!==(a=this._spec.minVisibleArea)&&void 0!==a?a:10,minChildrenVisibleArea:this._spec.minChildrenVisibleArea,minChildrenVisibleSize:this._spec.minChildrenVisibleSize}}),this.getViewData()&&this._spec.drill&&this.initDrillableData(this._dataSet)},i.prototype._runTreemapTransform=function(t){void 0===t&&(t=!1),this._data.getDataView().reRunAllTransform(),t&&this.getCompiler().renderNextTick()},i.prototype._addDataIndexAndKey=function(){var t;(null===(t=this._rawData)||void 0===t?void 0:t.dataSet)&&(kH(this._rawData.dataSet,"addVChartProperty",xV),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:HV.bind(this),call:NV}}))},i.prototype.getRawDataStatisticsByField=function(t,e){var i;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]&&this._rawData){var n=zQ([this._rawData],{fields:[{key:t,operations:e?["min","max"]:["values"]}]})[t];this._rawStatisticsCache[t]=gt(null!==(i=this._rawStatisticsCache[t])&&void 0!==i?i:{},n)}return this._rawStatisticsCache[t]},i.prototype._createHierarchyDataStatistics=function(t,e){var i=this;kH(this._dataSet,"hierarchyDimensionStatistics",zQ),kH(this._dataSet,"flatten",JJ);var n=new hs(this._dataSet,{name:t});return n.parse(e,{type:"dataview"}),n.transform({type:"hierarchyDimensionStatistics",options:{fields:function(){var t=i.getStatisticFields();return i._seriesField&&i._seriesField!==i._categoryField&&t.push({key:i._seriesField,operations:["values"]}),t}}},!1),n},i.prototype.getStatisticFields=function(){return rQ(e.prototype.getStatisticFields.call(this),this._categoryField,this._valueField)},i.prototype.initMark=function(){var t=this,e=this._createMark(i.mark.nonLeaf,{isSeriesMark:!0});e&&(e.setTransform([{type:"filter",callback:function(e){return!t._shouldFilterElement(e,"nonLeaf")}}]),this._nonLeafMark=e);var n=this._createMark(i.mark.leaf,{isSeriesMark:!0});n&&(n.setTransform([{type:"filter",callback:function(e){return!t._shouldFilterElement(e,"leaf")}}]),this._leafMark=n)},i.prototype.initMarkStyle=function(){this._initLeafMarkStyle(),this._initNonLeafMarkStyle()},i.prototype._initLeafMarkStyle=function(){this._leafMark&&this.setMarkStyle(this._leafMark,{x:function(t){return t.x0},y:function(t){return t.y0},x1:function(t){return t.x1},y1:function(t){return t.y1},fill:this.getColorAttribute()},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype._initNonLeafMarkStyle=function(){this._nonLeafMark&&this.setMarkStyle(this._nonLeafMark,{x:function(t){return t.x0},y:function(t){return t.y0},x1:function(t){return t.x1},y1:function(t){return t.y1},fill:this.getColorAttribute()},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype._initRichStyleOfLabelMark=function(e){"rich"===e.getTextType()&&this.setMarkStyle(e,{maxWidth:function(t){return Math.abs(t.x0-t.x1)},maxHeight:function(t){return Math.abs(t.y0-t.y1)},ellipsis:!0},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.initLabelMarkStyle=function(e){var i=this;e&&(this._labelMark=e,e.setRule("treemap"),this.setMarkStyle(e,{x:function(t){return(t.x0+t.x1)/2},y:function(t){return(t.y0+t.y1)/2},text:function(t){var e;return null===(e=t.datum[t.depth])||void 0===e?void 0:e[i.getDimensionField()[0]]},maxLineWidth:function(t){return t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series),this._initRichStyleOfLabelMark(e))},i.prototype.initNonLeafLabelMarkStyle=function(e){var i=this;e&&(this._nonLeafLabelMark=e,e.setRule("treemap"),this.setMarkStyle(e,{x:function(t){return t.labelRect?(t.labelRect.x0+t.labelRect.x1)/2:(t.x0+t.x1)/2},y:function(t){return t.labelRect?(t.labelRect.y0+t.labelRect.y1)/2:(t.y0+t.y1)/2},text:function(t){var e;return null===(e=t.datum[t.depth])||void 0===e?void 0:e[i.getDimensionField()[0]]},maxLineWidth:function(t){return t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series),this._initRichStyleOfLabelMark(e))},i.prototype.initAnimation=function(){var t=this;this.getMarksInType("rect").forEach((function(e){var i;e.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("treemap"))||void 0===i?void 0:i(),ZV(e.name,t._spec,t._markAttributeContext)))}))},i.prototype.initEvent=function(){var t=this;e.prototype.initEvent.call(this),this._spec.roam&&(this.initDragEventOfSeries(this),this.event.on("panmove",(function(e){t.handlePan(e)})),this.initZoomEventOfSeries(this),this.event.on("zoom",(function(e){t.handleZoom(e)}))),this._spec.drill&&this.bindDrillEvent()},i.prototype._getDataIdKey=function(){return"key"},i.prototype.initTooltip=function(){this._tooltipHelper=new HQ(this),this._leafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._leafMark),this._nonLeafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nonLeafMark)},i.prototype._shouldFilterElement=function(t,e){var i=t.isLeaf;return"leaf"===e?!i:i},i.prototype.handlePan=function(t){var e=t.delta;if(0!==e[0]||0!==e[1]){this._matrix.reset(),this._matrix.translate(e[0],e[1]);var i=this._matrix,n=i.a,r=i.b,a=i.c,o=i.d,s=i.e,l=i.f;this._matrix.multiply(n,r,a,o,s,l),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}},i.prototype.handleZoom=function(t){var e=t.scale,i=t.scaleCenter;if(1!==e){this._matrix.reset();var n=i.x,r=i.y;this._matrix.translate(n,r),this._matrix.scale(e,e),this._matrix.translate(-n,-r);var a=this._matrix,o=a.a,s=a.b,l=a.c,u=a.d,c=a.e,h=a.f;this._matrix.multiply(o,s,l,u,c,h),this.disableMarkAnimation(),this.event.on(lH.AFTER_DO_RENDER,this._enableAnimationHook),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this._viewBox.set(0,0,this.getLayoutRect().width,this.getLayoutRect().height),this._runTreemapTransform()},i.prototype.enableMarkAnimation=function(){this.getMarks().forEach((function(t){})),[this._labelMark,this._nonLeafLabelMark].forEach((function(t){t&&t.getComponent()&&t.getComponent().getProduct().enableAnimation()})),this.event.off(lH.AFTER_DO_RENDER,this._enableAnimationHook)},i.prototype.disableMarkAnimation=function(){this.getMarks().forEach((function(t){})),[this._labelMark,this._nonLeafLabelMark].forEach((function(t){t&&t.getComponent()&&t.getComponent().getProduct().disableAnimation()}))},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._nonLeafMark,this._leafMark]},i.prototype.getMarkData=function(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t},i.type=t.SeriesTypeEnum.treemap,i.mark=NQ,i.builtInTheme={treemap:YQ},i.transformerConstructor=jQ,i}(lj);kt(XQ,iQ),kt(XQ,cY);var KQ,qQ,ZQ=function(){UQ(),WQ(),MG(),mX(),KF.registerAnimation("treemap",(function(t,e){return{appear:VQ(e),enter:{type:"growCenterIn"},exit:{type:"growCenterOut"},disappear:{type:"growCenterOut"}}})),XN(),KF.registerSeries(XQ.type,XQ)},JQ=T(T({},$K),((KQ={}).segment={name:"segment",type:"arc"},KQ.track={name:"track",type:"arc"},KQ)),QQ=T(T({},VV),((qQ={}).pin={name:"pin",type:"path"},qQ.pinBackground={name:"pinBackground",type:"path"},qQ.pointer={name:"pointer",type:["path","rect"]},qQ)),$Q={type:"fadeIn"};function t$(t,e){return"fadeIn"===e?$Q:function(t){return{channel:{angle:{from:t.startAngle+Math.PI/2}}}}(t)}var e$=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!1,e}return M(e,t),e}(nj),i$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.enableByType=function(t){return"dimension"!==t},e}(EV),n$="M1 0 C1 0.55228 0.55228 1 0 1 C-0.552285 1 -1 0.55228 -1 0 C-1 -0.552285 -0.552285 -1 0 -1 C0.55228 -1 1 -0.552285 1 0Z",r$={pointer:{type:"path",width:.4,height:.4,style:{path:"M-0.020059 -0.978425 C-0.018029 -0.9888053 -0.013378 -1 0 -1 C0.01342 -1 0.01812 -0.989146 0.0201 -0.978425 C0.02161 -0.9702819 0.0692 -0.459505 0.09486 -0.184807 C0.10298 -0.097849 0.1089 -0.034548 0.11047 -0.018339 C0.11698 0.04908 0.07373 0.11111 0.00002 0.11111 C-0.07369 0.11111 -0.117184 0.04991 -0.110423 -0.018339 C-0.103662 -0.086591 -0.022089 -0.9680447 -0.020059 -0.978425Z"}},pin:{width:.025,height:.025,style:{path:n$,fill:"#888"}},pinBackground:{width:.06,height:.06,style:{path:n$,fill:"#ddd"}}},a$=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.gaugePointer,i.transformerConstructor=e$,i._pinMark=null,i._pointerMark=null,i._pinBackgroundMark=null,i}return M(i,e),i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this.setRadiusField(this._spec.radiusField),this._pointerType="rect"===(null===(t=this._spec.pointer)||void 0===t?void 0:t.type)?"rect":"path"},i.prototype.initMark=function(){this._pinBackgroundMark=this._createMark(i.mark.pinBackground),this._pointerMark=this._createMark(T(T({},i.mark.pointer),{type:this._pointerType}),{isSeriesMark:!0}),this._pinMark=this._createMark(i.mark.pin)},i.prototype.initMarkStyle=function(){this.initPinBackgroundMarkStyle(),this.initPointerMarkStyle(),this.initPinMarkStyle()},i.prototype.initGroups=function(){},i.prototype.initPointerMarkStyle=function(){var t=this,e=this._pointerMark,i=this._spec.pointer;e&&(this.setMarkStyle(e,{x:function(e){var n,r;return t._getPointerAnchor(e,i).x-t._getPointerWidth()*(null!==(r=null===(n=null==i?void 0:i.center)||void 0===n?void 0:n[0])&&void 0!==r?r:0)},y:function(e){var n,r;return t._getPointerAnchor(e,i).y-t._getPointerHeight(e)*(null!==(r=null===(n=null==i?void 0:i.center)||void 0===n?void 0:n[1])&&void 0!==r?r:0)},anchor:function(e){var n=t._getPointerAnchor(e,i);return[n.x,n.y]},fill:this.getColorAttribute(),zIndex:200}),"path"===this._pointerType?this.setMarkStyle(e,{scaleX:this._getPointerWidth.bind(this),scaleY:this._getPointerHeight.bind(this),angle:function(e){return t._getPointerAngle(e)+Math.PI/2}}):this.setMarkStyle(e,{width:this._getPointerWidth.bind(this),height:this._getPointerHeight.bind(this),angle:function(e){return t._getPointerAngle(e)-Math.PI/2}}))},i.prototype.initTooltip=function(){this._tooltipHelper=new i$(this),this._pointerMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pointerMark)},i.prototype._getPointerAnchor=function(t,e){var i;return null===(i=e.isOnCenter)||void 0===i||i?this.angleAxisHelper.center():this.radiusAxisHelper.coordToPoint({radius:this._innerRadius*this._computeLayoutRadius(),angle:this.angleAxisHelper.dataToPosition([t[this._angleField[0]]])})},i.prototype._getPointerWidth=function(){return this._spec.pointer.width*this._computeLayoutRadius()},i.prototype._getPointerHeight=function(t){var e,i,n=this._spec.pointer,r=this._radiusField[0];return U(this.radiusAxisHelper)&&U(r)?this.radiusAxisHelper.dataToPosition([t[r]])-(null!==(e=null==n?void 0:n.innerPadding)&&void 0!==e?e:0)-(null!==(i=null==n?void 0:n.outerPadding)&&void 0!==i?i:10):n.height*this._computeLayoutRadius()},i.prototype._getPointerAngle=function(t){var e=this.angleAxisHelper.getScale().domain(),i=Mt(e),n=Tt(e),r=Xt(t[this._angleField[0]],n,i);return this.angleAxisHelper.dataToPosition([r])},i.prototype._getRotatedPointerCenterOffset=function(t){var e,i,n,r,a=this._spec.pointer,o=this._getPointerWidth()*(null!==(i=null===(e=null==a?void 0:a.center)||void 0===e?void 0:e[0])&&void 0!==i?i:0),s=-this._getPointerHeight(t)*(null!==(r=null===(n=null==a?void 0:a.center)||void 0===n?void 0:n[1])&&void 0!==r?r:0),l=this._getPointerAngle(t)-Math.PI/2,u=Math.cos(l),c=Math.sin(l);return{x:o*u+s*c,y:-(s*u-o*c)}},i.prototype.initPinBackgroundMarkStyle=function(){var t=this,e=this._pinBackgroundMark,i=this._spec.pinBackground;e&&this.setMarkStyle(e,{x:function(e){return t._getPointerAnchor(e,i).x},y:function(e){return t._getPointerAnchor(e,i).y},scaleX:function(){return i.width*t._computeLayoutRadius()},scaleY:function(){return i.height*t._computeLayoutRadius()},fill:this.getColorAttribute(),zIndex:100})},i.prototype.initPinMarkStyle=function(){var t=this,e=this._pinMark,i=this._spec.pin;e&&this.setMarkStyle(e,{x:function(e){return t._getPointerAnchor(e,i).x},y:function(e){return t._getPointerAnchor(e,i).y},scaleX:function(){return i.width*t._computeLayoutRadius()},scaleY:function(){return i.height*t._computeLayoutRadius()},fill:this.getColorAttribute(),zIndex:300})},i.prototype.getInteractionTriggers=function(){return this._parseInteractionConfig(this._pointerMark?[this._pointerMark]:[])},i.prototype.initAnimation=function(){var t,e,i,n=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._pointerMark.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("gaugePointer"))||void 0===i?void 0:i({startAngle:this._startAngle},n),ZV("pointer",this._spec,this._markAttributeContext)))},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[]},i.type=t.SeriesTypeEnum.gaugePointer,i.mark=QQ,i.builtInTheme={gaugePointer:r$},i.transformerConstructor=e$,i}(tq),o$=function(){KF.registerSeries(a$.type,a$),nY(),MG(),KF.registerAnimation("gaugePointer",(function(t,e){var i=t$(t,e);return{appear:i,enter:i,disappear:{type:"fadeOut"}}})),xK(),_K()},s$=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!1,e}return M(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"segment")},e}(nj),l$={outerRadius:.8,innerRadius:.6,padAngle:1.146,segment:{style:{fillOpacity:1}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}},u$=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.gauge,i.transformerConstructor=s$,i._segmentMark=null,i._trackMark=null,i._padAngle=0,i}return M(i,e),i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this._padAngle=Fe(null!==(t=this._spec.padAngle)&&void 0!==t?t:0)},i.prototype.initData=function(){var t,i=this;e.prototype.initData.call(this);kH(this._option.dataSet,"spiltSegment",(function(t,e){var n=t.slice();return n.sort((function(t,e){return t[i._angleField[0]]-e[i._angleField[0]]})),n.forEach((function(t,e){t[jz]=t[i._angleField[0]],t[Vz]=e>0?n[e-1][jz]:void 0})),n})),null===(t=this.getViewData())||void 0===t||t.transform({type:"spiltSegment"},!1)},i.prototype.initMark=function(){e.prototype.initMark.call(this),this._trackMark=this._createMark(i.mark.track,{parent:this._arcGroupMark,dataView:!1}),this._segmentMark=this._createMark(i.mark.segment,{parent:this._arcGroupMark,isSeriesMark:!0})},i.prototype.initMarkStyle=function(){e.prototype.initMarkStyle.call(this),this.initTrackMarkStyle(),this.initSegmentMarkStyle()},i.prototype.initSegmentMarkStyle=function(){var t,e=this,i=this._segmentMark;i&&this.setMarkStyle(i,{x:function(){return e.angleAxisHelper.center().x},y:function(){return e.angleAxisHelper.center().y},startAngle:this._getAngleValueStart.bind(this),endAngle:this._getAngleValueEnd.bind(this),innerRadius:function(){var t;return e._computeLayoutRadius()*(null!==(t=e._spec.innerRadius)&&void 0!==t?t:0)},outerRadius:function(){var t,i;return e._computeLayoutRadius()*(null!==(i=null!==(t=e._spec.radius)&&void 0!==t?t:e._spec.outerRadius)&&void 0!==i?i:1)},cap:null!==(t=this._spec.roundCap)&&void 0!==t&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0})},i.prototype.generateRadiusStyle=function(t){var e=this;if(t){var i={};return t.outerRadius&&(i.outerRadius=function(){return e._computeLayoutRadius()*t.outerRadius}),t.innerRadius&&(i.innerRadius=function(){return e._computeLayoutRadius()*t.innerRadius}),i}},i.prototype.initMarkStyleWithSpec=function(i,n){if(e.prototype.initMarkStyleWithSpec.call(this,i,n),i&&"segment"===i.name){var r=this.getSpec().segment;if(r)for(var a in r.state||{})this.setMarkStyle(i,this.generateRadiusStyle(r.state[a]),a,t.AttributeLevel.User_Mark)}},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._segmentMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._segmentMark)},i.prototype.initTrackMarkStyle=function(){var t,e=this,i=this._trackMark;i&&this.setMarkStyle(i,{x:function(){return e.angleAxisHelper.center().x},y:function(){return e.angleAxisHelper.center().y},startAngle:this._startAngle,endAngle:this._endAngle,innerRadius:function(){var t;return e._computeLayoutRadius()*(null!==(t=e._spec.innerRadius)&&void 0!==t?t:0)},outerRadius:function(){var t,i;return e._computeLayoutRadius()*(null!==(i=null!==(t=e._spec.radius)&&void 0!==t?t:e._spec.outerRadius)&&void 0!==i?i:1)},cap:null!==(t=this._spec.roundCap)&&void 0!==t&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,zIndex:100})},i.prototype._getAngleValueStartWithoutMask=function(t){var e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t),n=qt(e,(e+i)/2)(e+(i>e?1:-1)*Math.abs(this._padAngle/2));return this._spec.clamp?MF(n,this.angleAxisHelper.getScale(0)):n},i.prototype._getAngleValueEndWithoutMask=function(t){var e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t),n=qt(i,(e+i)/2)(i-(i>e?1:-1)*Math.abs(this._padAngle/2));return this._spec.clamp?MF(n,this.angleAxisHelper.getScale(0)):n},i.prototype._getAngleValueStartWithoutPadAngle=function(t){return U(t[Vz])?this.angleAxisHelper.dataToPosition([t[Vz]]):this._startAngle},i.prototype._getAngleValueEndWithoutPadAngle=function(t){return this.angleAxisHelper.dataToPosition([t[jz]])},i.prototype.initAnimation=function(){var t,e,i,n=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._segmentMark.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("circularProgress"))||void 0===i?void 0:i({startAngle:this._startAngle},n),ZV("segment",this._spec,this._markAttributeContext)))},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[]},i.type=t.SeriesTypeEnum.gauge,i.mark=JQ,i.builtInTheme={gauge:l$},i.transformerConstructor=s$,i}(tq),c$=function(){KF.registerSeries(u$.type,u$),ZX(),rq(),_K()},h$=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return M(e,t),e.prototype._getDefaultStyle=function(){return T(T({},t.prototype._getDefaultStyle.call(this)),{fill:void 0,lineWidth:0,padding:0})},e.prototype._createGraphic=function(t){return void 0===t&&(t={}),Fv(t)},e.prototype._transformGraphicAttributes=function(e,i,n){var r,a,o,s=t.prototype._transformGraphicAttributes.call(this,e,i,n),l=null!==(a=null!==(r=s.shape)&&void 0!==r?r:s.symbolType)&&void 0!==a?a:null===(o=e.attribute)||void 0===o?void 0:o.symbolType;return j(l)?s.symbolType="rect":s.symbolType=l,s},e.type="cell",e}(RN);function d$(t){return!1===t?{}:{type:"fadeIn"}}var p$,f$,v$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.enableByType=function(t){return"dimension"!==t},e}(EV),g$=T(T({},VV),((p$={}).cell={name:"cell",type:"cell"},p$.cellBackground={name:"cellBackground",type:"cell"},p$)),y$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"cell")},e}(nj),m$={cell:{style:{shape:"square",fillOpacity:1}},cellBackground:{visible:!1}},_$=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.heatmap,i.transformerConstructor=y$,i}return M(i,e),i.prototype.getFieldValue=function(){return this._fieldValue},i.prototype.setFieldValue=function(t){this._fieldValue=St(t)},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setFieldValue(this._spec.valueField)},i.prototype.initMark=function(){this._cellMark=this._createMark(i.mark.cell,{isSeriesMark:!0},{morph:$V(this._spec,i.mark.cell.name),morphElementKey:this.getDimensionField()[0]}),this._backgroundMark=this._createMark(i.mark.cellBackground)},i.prototype.initMarkStyle=function(){this.initCellMarkStyle(),this.initCellBackgroundMarkStyle()},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:function(t){return t[e.getMeasureField()[0]]}})},i.prototype.initCellMarkStyle=function(){var e=this;this.setMarkStyle(this._cellMark,{x:function(t){return e.dataToPositionX(t)},y:function(t){return e.dataToPositionY(t)},size:function(){return[e.getCellSize(e._xAxisHelper),e.getCellSize(e._yAxisHelper)]},fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series)},i.prototype.initCellBackgroundMarkStyle=function(){var e,i,n,r=this,a=Di(null!==(n=null===(i=null===(e=this._spec.cellBackground)||void 0===e?void 0:e.style)||void 0===i?void 0:i.padding)&&void 0!==n?n:0);this.setMarkStyle(this._backgroundMark,{x:function(t){var e=r.getCellSize(r._xAxisHelper);return r.dataToPositionX(t)-e/2+a[3]},y:function(t){var e=r.getCellSize(r._yAxisHelper);return r.dataToPositionY(t)-e/2+a[0]},width:function(){return r.getCellSize(r._xAxisHelper)-a[1]-a[3]},height:function(){return r.getCellSize(r._yAxisHelper)-a[0]-a[2]}},"normal",t.AttributeLevel.Series)},i.prototype.getColorAttribute=function(){var t;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:this.getFieldValue[0]}},i.prototype.getInteractionTriggers=function(){return this._parseInteractionConfig(this._cellMark?[this._cellMark]:[])},i.prototype.initAnimation=function(){var t,e,i,n=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset,r=sj(this);this._cellMark.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("heatmap"))||void 0===i?void 0:i(n),ZV("cell",this._spec,this._markAttributeContext),r))},i.prototype.getCellSize=function(t){var e,i;return null!==(i=null===(e=t.getBandwidth)||void 0===e?void 0:e.call(t,0))&&void 0!==i?i:6},i.prototype.initTooltip=function(){this._tooltipHelper=new v$(this),this._cellMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._cellMark)},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getDimensionField=function(){return[].concat(this.fieldX,this.fieldY)},i.prototype.getMeasureField=function(){return this.getFieldValue()},i.prototype.getActiveMarks=function(){return[this._cellMark]},i.type=t.SeriesTypeEnum.heatmap,i.mark=g$,i.builtInTheme={heatmap:m$},i.transformerConstructor=y$,i}(lj),b$=function(){mX(),KF.registerMark(h$.type,h$),KF.registerGraphicComponent("symbol",Fv),lC(),cC(),HI(),KF.registerAnimation("heatmap",(function(t,e){return T(T({},GN),{appear:d$(e)})})),WU(),NU(),KF.registerSeries(_$.type,_$)},x$=T(T({},VV),((f$={}).nodePoint={name:"nodePoint",type:"symbol"},f$.ripplePoint={name:"ripplePoint",type:"ripple"},f$.centerPoint={name:"centerPoint",type:"symbol"},f$.centerLabel={name:"centerLabel",type:"text"},f$)),k$="".concat(mz,"_CORRELATION_X"),S$="".concat(mz,"_CORRELATION_Y"),A$="".concat(mz,"_CORRELATION_SIZE"),M$=function(t,e){var i,n,r,a,o,s,l,u,c,h,d,p,f,v,g;if(!t||!(null==e?void 0:e.view)||!q(t))return t;var y=e.view();if(y.x1-y.x0==0||y.y1-y.y0==0||y.x1-y.x0==-1/0||y.x1-y.x0==1/0||y.y1-y.y0==-1/0||y.y1-y.y0==1/0)return t;var m=Fe(null!==(i=e.startAngle)&&void 0!==i?i:-90),_=Fe(null!==(n=e.endAngle)&&void 0!==n?n:270),b=Math.max((y.x1-y.x0)/2,(y.y1-y.y0)/2),x=le(null!==(r=e.innerRadius)&&void 0!==r?r:0,b),k=le(e.outerRadius,b),S=[Q(null===(a=e.center)||void 0===a?void 0:a[0])?e.center[0]:y.x0+le(null!==(s=null===(o=e.center)||void 0===o?void 0:o[0])&&void 0!==s?s:"50%",y.x1-y.x0),Q(null===(l=e.center)||void 0===l?void 0:l[1])?e.center[1]:y.y0+le(null!==(c=null===(u=e.center)||void 0===u?void 0:u[1])&&void 0!==c?c:"50%",y.y1-y.y0)],A=oe(e.field),M=t.map(A),w=B(ce(M),2),C=w[0],E=w[1],P=C===E?function(t){return(x+k)/2}:function(t){return x+(k-x)*(t-C)/(E-C)},R=j(e.radiusField)?A:oe(e.radiusField),L=null!==(d=null===(h=null==e?void 0:e.radiusRange)||void 0===h?void 0:h[1])&&void 0!==d?d:5,I=function(t){return L};if(R){var D=B(R!==A?ce(t.map(R)):[C,E],2),O=D[0],F=D[1],z=null!==(f=null===(p=e.radiusRange)||void 0===p?void 0:p[0])&&void 0!==f?f:5,H=null!==(g=null===(v=e.radiusRange)||void 0===v?void 0:v[1])&&void 0!==g?g:5;O!==F&&(I=function(t){return z+(H-z)*(R(t)-O)/(F-O)})}var N=Math.min(m,_),V=Math.max(m,_),U=T$(N,V,t.length),W=[],G=(V-N)/60;return t.forEach((function(t,e){for(var i,n,r,a=P(M[e]),o=I(t),s=U[e],l=0;l<60&&(n=S[0]+a*Math.cos(s),r=S[1]+a*Math.sin(s),w$({x:n,y:r,size:o},W)||n-o<y.x0||n+o>y.x1||r-o<y.y0||r+o>y.y1);l++)l<59&&((s+=G)>V?s=N:s<N&&(s=V));W.push(T(((i={})[k$]=n,i[S$]=r,i[A$]=o,i),t))})),W},T$=function(t,e,i){for(var n=0,r=Math.max(Math.ceil(2*(e-t)/Math.PI),2),a=(e-t)/r,o=0,s=1,l=0,u=0,c=[],h=t;l<i;)u<r&&(c.push(h+(u%2?Math.floor(u/2)+Math.floor(r/2):u/2)*a*s),u++),l++,u===r&&(u=0,0===n?n=a/2:n/=2,h=-1===(s*=-1)?e-n:t+n,(o+=1)>=2&&(a/=2,r*=2));return c},w$=function(t,e){return!(!e||!e.length)&&e.some((function(e){return Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)<Math.pow(t.size+e.size,2)}))},C$=function(t,e){var i;if(!t||!q(t))return[];var n=e.keyword,r=e.categoryField,a=t[0].latestData[0];return(i={})[r]=n,i[kz]=null==a?void 0:a[kz],i[Az]=null==a?void 0:a[Az],i},E$=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._subMarks={ripple0:{type:"symbol",defaultAttributes:{fillOpacity:.75}},ripple1:{type:"symbol",defaultAttributes:{fillOpacity:.5}},ripple2:{type:"symbol",defaultAttributes:{fillOpacity:.25}}},i._positionChannels=["ripple","size"],i._positionEncoder=function(t,e,i){var n=t.ripple,r=void 0===n?i.attribute.ripple:n,a=t.size,o=void 0===a?i.attribute.size:a,s=Xt(r,0,1),l=.5*o;return{ripple0:{size:o+l*s,fillOpacity:.75-.25*s},ripple1:{size:o+l*(1+s),fillOpacity:.5-.25*s},ripple2:{size:o+l*(2+s),fillOpacity:.25-.25*s}}},i}return M(e,t),e.prototype._getDefaultStyle=function(){return T(T({},t.prototype._getDefaultStyle.call(this)),{x:0,y:0,ripple:0})},e.type="ripple",e}($Y),P$=function(){tX(),cC(),KF.registerMark(E$.type,E$),KF.registerGraphicComponent("symbol",(function(t){return Fv(t)}))},B$=function(t,e){return"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"}},R$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"nodePoint"),this._addMarkLabelSpec(t,"centerPoint","centerLabel")},e}(nj),L$={centerLabel:{visible:!0,position:"center",style:{fill:"#fff",text:""}},label:{visible:!0,position:"bottom",style:{fill:"#000"}}},I$=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.correlation,i.transformerConstructor=R$,i._viewBox=new mi,i}return M(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.getSeriesField=function(){return this._seriesField},i.prototype.setSeriesField=function(t){U(t)&&(this._seriesField=t)},i.prototype.getSizeField=function(){return this._sizeField},i.prototype.setSizeField=function(t){U(t)&&(this._sizeField=t)},i.prototype.getSizeRange=function(){return this._sizeRange},i.prototype.setSizeRange=function(t){U(t)&&(this._sizeRange=t)},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(this._spec.seriesField),this.setSizeField(this._spec.sizeField),this.setSizeRange(this._spec.sizeRange)},i.prototype.initData=function(){var t,i,n;if(e.prototype.initData.call(this),this._data){kH(this._dataSet,"correlation",M$);var r=new cs;SH(r,"dataview",ss),kH(r,"correlationCenter",C$);var a=new hs(r,{name:"".concat(this.type,"_").concat(this.id,"_center")});a.parse([this.getViewData()],{type:"dataview"}),a.transform({type:"correlationCenter",options:{keyword:null!==(n=null===(i=null===(t=this._spec.centerLabel)||void 0===t?void 0:t.style)||void 0===i?void 0:i.text)&&void 0!==n?n:"",categoryField:this._spec.categoryField}}),this._centerSeriesData=new wN(this._option,a)}},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._centerSeriesData)||void 0===t||t.compile()},i.prototype._statisticViewData=function(){var t=this;e.prototype._statisticViewData.call(this),this._data.getDataView().transform({type:"correlation",options:{view:function(){return{x0:t._viewBox.x1,x1:t._viewBox.x2,y0:t._viewBox.y1,y1:t._viewBox.y2}},field:this._spec.valueField,radiusRange:this._spec.sizeRange,radiusField:this._spec.sizeField,center:[this._spec.centerX,this._spec.centerY],innerRadius:this._spec.innerRadius,outerRadius:this._spec.outerRadius,startAngle:this._spec.startAngle,endAngle:this._spec.endAngle}})},i.prototype.initMark=function(){var e=this._createMark(i.mark.nodePoint,{groupKey:this._seriesField,isSeriesMark:!0,key:kz});e&&(e.setMarkConfig({zIndex:t.LayoutZIndex.Node}),this._nodePointMark=e);var n=this._createMark(i.mark.ripplePoint,{key:kz,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId()});n&&(this._ripplePointMark=n);var r=this._createMark(i.mark.centerPoint,{key:kz,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId()});r&&(r.setMarkConfig({zIndex:t.LayoutZIndex.Node}),this._centerPointMark=r)},i.prototype.initMarkStyle=function(){this._initNodePointMarkStyle(),this._initRipplePointMarkStyle(),this._initCenterPointMarkStyle()},i.prototype._initNodePointMarkStyle=function(){var e,i,n,r,a=this._nodePointMark;if(a){var o=null!==(i=null===(e=this._spec.nodePoint)||void 0===e?void 0:e.style)&&void 0!==i?i:{};this.setMarkStyle(a,{x:function(t){return t[k$]},y:function(t){return t[S$]},size:function(t){return t[A$]},fill:null!==(n=o.fill)&&void 0!==n?n:this.getColorAttribute(),fillOpacity:null!==(r=o.fillOpacity)&&void 0!==r?r:1,lineWidth:0},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)}},i.prototype._initRipplePointMarkStyle=function(){var e,i,n,r,a,o=this,s=this._ripplePointMark;if(s){var l=null!==(i=null===(e=this._spec.ripplePoint)||void 0===e?void 0:e.style)&&void 0!==i?i:{};this.setMarkStyle(s,{x:function(){var t;return null!==(t=o._spec.centerX)&&void 0!==t?t:(o._viewBox.x1+o._viewBox.x2)/2},y:function(){var t;return null!==(t=o._spec.centerY)&&void 0!==t?t:(o._viewBox.y1+o._viewBox.y2)/2},size:function(){return Math.max(o._viewBox.x2-o._viewBox.x1,o._viewBox.y2-o._viewBox.y1)/2},fill:null!==(n=l.fill)&&void 0!==n?n:this.getColorAttribute(),opacity:null!==(r=l.fillOpacity)&&void 0!==r?r:.2,ripple:null!==(a=l.ripple)&&void 0!==a?a:0},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)}},i.prototype._initCenterPointMarkStyle=function(){var e,i,n,r,a,o,s=this,l=this._centerPointMark;l&&this.setMarkStyle(l,{x:function(){var t;return null!==(t=s._spec.centerX)&&void 0!==t?t:(s._viewBox.x1+s._viewBox.x2)/2},y:function(){var t;return null!==(t=s._spec.centerY)&&void 0!==t?t:(s._viewBox.y1+s._viewBox.y2)/2},size:function(){return.2*Math.max(s._viewBox.x2-s._viewBox.x1,s._viewBox.y2-s._viewBox.y1)/2},fill:null!==(n=null===(i=null===(e=this._spec.centerPoint)||void 0===e?void 0:e.style)||void 0===i?void 0:i.fill)&&void 0!==n?n:this.getColorAttribute(),fillOpacity:null!==(o=null===(a=null===(r=this._spec.centerPoint)||void 0===r?void 0:r.style)||void 0===a?void 0:a.fillOpacity)&&void 0!==o?o:1},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._nodePointMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodePointMark)},i.prototype.initLabelMarkStyle=function(e){var i=this;e&&this.setMarkStyle(e,{fill:this.getColorAttribute(),text:function(t){return t[i._categoryField]},z:this.dataToPositionZ.bind(this)},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.initAnimation=function(){var t,e,i=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;this._nodePointMark.setAnimationConfig(qV(null===(e=KF.getAnimationInKey("correlation"))||void 0===e?void 0:e({},i),ZV("nodePoint",this._spec,this._markAttributeContext)))},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype.getActiveMarks=function(){return[this._nodePointMark,this._centerPointMark]},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this._rawData.reRunAllTransform(),this.getViewData().reRunAllTransform()},i.type=t.SeriesTypeEnum.correlation,i.mark=x$,i.builtInTheme={correlation:L$},i.transformerConstructor=R$,i}(OX),D$=function(){Ij(),P$(),KF.registerSeries(I$.type,I$),KF.registerAnimation("correlation",(function(t,e){return T({appear:B$(0,e)},WN)}))},O$={duration:2e3,loop:!0,channel:{wave:{from:0,to:1}}},F$=function(t){return{duration:2e3,channel:{wave:{from:0,to:1},height:t.height,dy:t.dy}}},z$=F$;function H$(t,e){switch(e){case"wave":default:return O$;case"grow":return F$(t);case"waveGrow":return z$(t)}}function N$(t,e){switch(e){case"wave":default:return O$;case"grow":case"waveGrow":return function(t){return{duration:2e3,channel:{dy:t.dy}}}(t)}}var V$,j$=T(T({},VV),((V$={}).liquidGroup={name:"liquidGroup",type:"group"},V$.liquid={name:"liquid",type:"liquid"},V$.liquidBackground={name:"liquidBackground",type:"group"},V$.liquidOutline={name:"liquidOutline",type:"group"},V$)),U$=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._subMarks={wave0:{type:"area",defaultAttributes:{curveType:"monotoneX",fillOpacity:1}},wave1:{type:"area",defaultAttributes:{curveType:"monotoneX",fillOpacity:.66}},wave2:{type:"area",defaultAttributes:{curveType:"monotoneX",fillOpacity:.33}}},i._positionChannels=["wave","y","height"],i._positionEncoder=function(t,e,i){for(var n=t.wave,r=void 0===n?i.attribute.wave:n,a=t.y,o=void 0===a?i.attribute.y:a,s=t.height,l=void 0===s?i.attribute.height:s,u=[],c=[],h=[],d=0;d<21;d++){var p=50*d-500,f=o+(d%2==0?20:0),v=o+l;u.push({x:p+100*r,y:f,y1:v}),c.push({x:p+200*r-40,y:f,y1:v}),h.push({x:p+300*r-20,y:f,y1:v})}return{wave0:{x:0,y:0,points:u},wave1:{x:0,y:0,points:c},wave2:{x:0,y:0,points:h}}},i}return M(e,t),e.prototype._getDefaultStyle=function(){return T(T({},t.prototype._getDefaultStyle.call(this)),{wave:0})},e.type="liquid",e}($Y),W$=function(t,e){return"drop"===t?function(t,e,i){var n=4*i/3,r=Math.max(n,2*i),a=n/2,o=t,s=a+e-r/2,l=Math.asin(a/(.85*(r-a))),u=Math.sin(l)*a,c=Math.cos(l)*a,h=o-c,d=s+u,p=t,f=s+a/Math.sin(l);return"\n      M ".concat(h," ").concat(d,"\n      A ").concat(a," ").concat(a," 0 1 1 ").concat(h+2*c," ").concat(d,"\n      Q ").concat(p," ").concat(f," ").concat(t," ").concat(e+r/2,"\n      Q ").concat(p," ").concat(f," ").concat(h," ").concat(d,"\n      Z \n    ")}(0,0,e):t};var G$,Y$=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markTooltipKeyCallback=function(t){return e.series.getValueField()},e.markTooltipValueCallback=function(t){return t[e.series.getValueField()]},e.shapeStrokeCallback=function(t){return e.series.getMarkInName("liquid").getAttribute("fill",t)},e}return M(e,t),e}(EV),X$={outlinePadding:10,liquidBackground:{style:{lineWidth:0,fillOpacity:.2}},liquidOutline:{style:{lineWidth:2}}},K$=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.liquid,i.transformerConstructor=Dj,i._liquidBackgroundMark=null,i._liquidOutlineMark=null,i._getLiquidPosY=function(){var t=i._getLiquidBackPosAndSize(),e=t.height,n=t.startY;return(i._reverse?e*i._heightRatio:e*(1-i._heightRatio))+n},i._getLiquidHeight=function(){return i._getLiquidBackPosAndSize().height*i._heightRatio},i._getLiquidBackPosAndSize=function(t){var e,n;void 0===t&&(t=!1);var r=i._marginSpec,a=r.top,o=void 0===a?0:a,s=r.bottom,l=void 0===s?0:s,u=r.left,c=void 0===u?0:u,h=r.right,d=void 0===h?0:h,p=t?{}:i._paddingSpec,f=p.top,v=void 0===f?0:f,g=p.bottom,y=void 0===g?0:g,m=p.left,_=void 0===m?0:m,b=p.right,x=void 0===b?0:b;"triangle"===i._maskShape&&(l/=Math.sqrt(3),o=o/Math.sqrt(3)*2,y/=Math.sqrt(3),v=v/Math.sqrt(3)*2);var k=null!==(n=null===(e=i._region)||void 0===e?void 0:e.getLayoutRect())&&void 0!==n?n:{width:0,height:0},S=k.width,A=k.height,M=S/2+(c+_-(d+x))/2,T=A/2+(o+v-(l+y))/2,w=S-(c+d+_+x),C=A-(o+l+v+y),E=Math.min(w,C);return"rect"!==i._maskShape&&(w=E,C=E),{x:M,y:T,size:E,width:w,height:C,startX:M-w/2,startY:T-C/2,endX:M+w/2,endY:T+C/2}},i._getLiquidBackPath=function(t){var e,n;if(void 0===t&&(t=!1),"rect"===i._maskShape){var r=i._getLiquidBackPosAndSize(t),a=r.x,o=r.y,s=r.width,l=r.height;n=Wv({x:a-s/2,y:o-l/2,width:s,height:l,fill:!0})}else{var u=i._getLiquidBackPosAndSize(t),c=(a=u.x,o=u.y,u.size);n=Fv({x:a,y:o,size:c,symbolType:W$(null!==(e=i._spec.maskShape)&&void 0!==e?e:"circle",c),fill:!0})}return[n]},i}return M(i,e),i.prototype.setValueField=function(t){U(t)&&(this._valueField=t)},i.prototype.getValueField=function(){return this._valueField},i.prototype.setAttrFromSpec=function(){var t,i;e.prototype.setAttrFromSpec.call(this),this._marginSpec=IF(this._spec.outlineMargin),this._paddingSpec=IF(this._spec.outlinePadding),this.setValueField(this._spec.valueField),this._reverse=null!==(t=this._spec.reverse)&&void 0!==t&&t,this._maskShape=null!==(i=this._spec.maskShape)&&void 0!==i?i:"circle"},i.prototype.viewDataUpdate=function(t){var i=this;e.prototype.viewDataUpdate.call(this,t),this._heightRatio=ke.apply(void 0,R([],B(this._data.getLatestData().map((function(t){return t[i._valueField]}))),!1))},i.prototype.initMark=function(){this._initLiquidOutlineMark(),this._initLiquidBackgroundMark(),this._initLiquidMark()},i.prototype.initMarkStyle=function(){this._initLiquidOutlineMarkStyle(),this._initLiquidBackgroundMarkStyle(),this._initLiquidMarkStyle()},i.prototype._initLiquidOutlineMark=function(){return this._liquidOutlineMark=this._createMark(i.mark.liquidOutline,{isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidOutlineMark},i.prototype._initLiquidBackgroundMark=function(){return this._liquidBackgroundMark=this._createMark(i.mark.liquidBackground,{isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidBackgroundMark},i.prototype._initLiquidMark=function(){return this._liquidGroupMark=this._createMark(i.mark.liquidGroup,{parent:this._liquidBackgroundMark,isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidMark=this._createMark(i.mark.liquid,{parent:this._liquidGroupMark,isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidMark},i.prototype._buildMarkAttributeContext=function(){e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.getLiquidBackPosAndSize=this._getLiquidBackPosAndSize,this._markAttributeContext.getLiquidPosY=this._getLiquidPosY,this._markAttributeContext.getLiquidHeight=this._getLiquidHeight},i.prototype._initLiquidOutlineMarkStyle=function(){var e=this,i=this._liquidOutlineMark;i.created(),this.setMarkStyle(i,{stroke:this.getColorAttribute(),width:function(){return e._region.getLayoutRect().width},height:function(){return e._region.getLayoutRect().height},path:function(){return e._getLiquidBackPath(!0)}},"normal",t.AttributeLevel.Series),this._liquidOutlineMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex})},i.prototype._initLiquidBackgroundMarkStyle=function(){var e=this,i=this._liquidBackgroundMark;i.created(),this.setMarkStyle(i,{width:function(){return e._region.getLayoutRect().width},height:function(){return e._region.getLayoutRect().height},path:function(){return e._getLiquidBackPath()}},"normal",t.AttributeLevel.Series),this._liquidBackgroundMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex,clip:!0})},i.prototype._initLiquidMarkStyle=function(){var e=this,i=this._liquidMark,n=this._liquidGroupMark;n&&this.setMarkStyle(n,{x:function(){return e._region.getLayoutStartPoint().x+e._region.getLayoutRect().width/2},angle:this._reverse?-Math.PI:0,y:0,dy:this._getLiquidPosY}),i&&this.setMarkStyle(i,{y:0,dy:0,height:this._getLiquidHeight,fill:this.getColorAttribute(),wave:0},"normal",t.AttributeLevel.Series)},i.prototype.initTooltip=function(){this._tooltipHelper=new Y$(this),this._liquidMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._liquidMark)},i.prototype.getInteractionTriggers=function(){return this._parseInteractionConfig(this._liquidMark?[this._liquidMark]:[])},i.prototype.initAnimation=function(){var t,e,i,n,r=this,a={height:{from:0,to:function(){return r._getLiquidHeight()}},dy:{from:function(){var t=r._getLiquidBackPosAndSize(),e=t.height,i=t.startY;return(r._reverse?0:e)+i}}},o=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._liquidMark.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("liquid"))||void 0===i?void 0:i(a,o),ZV("liquid",this._spec,this._markAttributeContext))),this._liquidGroupMark.setAnimationConfig(qV(null===(n=KF.getAnimationInKey("liquidGroup"))||void 0===n?void 0:n(a,o),ZV("liquidGroup",this._spec,this._markAttributeContext)))},i.prototype.initEvent=function(){var i=this;e.prototype.initEvent.call(this),this._spec.indicatorSmartInvert&&this._option.getChart().getComponentsByKey("indicator")&&this.event.on(t.ChartEvent.renderFinished,(function(){i._option.getChart().getComponentsByKey("indicator").forEach((function(t){var e,n,r,a=null===(e=i._liquidMark.getGraphics()[0].getSubGraphic())||void 0===e?void 0:e[0],o=a.globalAABBBounds,s=o.y1,l=o.y2;s+=i._region.getLayoutStartPoint().y,l+=i._region.getLayoutStartPoint().y,null===(r=null===(n=null==t?void 0:t.getIndicatorComponent())||void 0===n?void 0:n.getChildren()[0])||void 0===r||r.getChildren().forEach((function(t){var e=t.globalAABBBounds,i=e.y1,n=e.y2;if(s<i&&l>n){var r=DC(t.attribute.fill,a.attribute.fill);t.setAttribute("fill",r)}}))}))}))},i.prototype.dataToPosition=function(t){return null},i.prototype.dataToPositionX=function(t){return null},i.prototype.dataToPositionY=function(t){return null},i.prototype.valueToPosition=function(t,e){return null},i.prototype.getStatisticFields=function(){return[]},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype.getActiveMarks=function(){return[this._liquidMark]},i.type=t.SeriesTypeEnum.liquid,i.mark=j$,i.builtInTheme={liquid:X$},i.transformerConstructor=Dj,i}(rj),q$=function(){tX(),jw(),KF.registerMark(U$.type,U$),KF.registerGraphicComponent("area",(function(t){return hg(t)})),IN(),KF.registerAnimation("liquid",(function(t,e){return{appear:H$(t,e),enter:H$(t,e),exit:H$(t,e)}})),KF.registerAnimation("liquidGroup",(function(t,e){return{appear:N$(t,e),enter:N$(t,e),exit:N$(t,e)}})),KF.registerSeries(K$.type,K$)},Z$=function(t){return St(t).join(",")},J$=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dimensionTooltipTitleCallback=function(t){return Z$(null==t?void 0:t[e.series.getDimensionField()[0]])},e.markTooltipKeyCallback=function(t){return Z$(null==t?void 0:t[e.series.getDimensionField()[0]])},e}return M(e,t),e}(EV),Q$=T(T({},VV),((G$={}).circle={name:"circle",type:"arc"},G$.overlap={name:"overlap",type:"path"},G$.overlapLabel={name:"overlapLabel",type:"text"},G$)),$$=function(t){switch(t){case"fadeIn":default:return{type:"fadeIn"};case"growIn":return{type:"growRadiusIn"};case"scaleIn":return{type:"scaleIn"}}},t0=function(t){switch(t){case"fadeIn":default:return{type:"fadeIn"};case"scaleIn":return{type:"scaleIn"}}},e0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.onBind=function(){var t,e,i=this;this.fromCircles={},null===(t=SZ(this.target.attribute.arcs))||void 0===t||t.forEach((function(t){i.fromCircles[t.setId]=t})),this.toCircles={},null===(e=SZ(this.target.getFinalAttribute().arcs))||void 0===e||e.forEach((function(t){i.toCircles[t.setId]=t}))},e.prototype.onUpdate=function(t,e,i){var n=this,r=[];Object.keys(this.fromCircles).forEach((function(t){var i=n.fromCircles[t],a=n.toCircles[t];i&&a&&r.push({radius:i.radius+(a.radius-i.radius)*e,x:i.x+(a.x-i.x)*e,y:i.y+(a.y-i.y)*e,setId:t})}));var a=xZ(r);this.target.setAttributes({arcs:a,path:kZ(a)})},e}(zP),i0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"circle"),this._addMarkLabelSpec(t,"overlap","overlapLabel","initOverlapLabelMarkStyle")},e}(nj),n0=function(t,e){var i=e.getViewBox();return i&&(null==t?void 0:t.length)?AZ(T({setField:e.setField,valueField:e.valueField},i),t):[]},r0={circle:{style:{opacity:.8},state:{hover:{opacity:1}}},overlap:{style:{opacity:.8},state:{hover:{opacity:1,stroke:"white",lineWidth:2}}},label:{visible:!0,style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"}}},overlapLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},a0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.venn,i.transformerConstructor=i0,i._viewBox=new mi,i}return M(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.setAttrFromSpec=function(){var t,i,n;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(null!==(t=this._spec.categoryField)&&void 0!==t?t:"sets"),this.setValueField(null!==(i=this._spec.valueField)&&void 0!==i?i:"size"),this.setSeriesField(null!==(n=this._spec.seriesField)&&void 0!==n?n:Sz)},i.prototype.initData=function(){var t,i=this;e.prototype.initData.call(this),kH(this._dataSet,"venn",n0),null===(t=this._data.getDataView())||void 0===t||t.transform({type:"venn",options:{getViewBox:function(){return i._viewBox.empty()?null:{x0:i._viewBox.x1,x1:i._viewBox.x2,y0:i._viewBox.y1,y1:i._viewBox.y2}},setField:this._categoryField,valueField:this._valueField}})},i.prototype.compile=function(){e.prototype.compile.call(this),this._runVennTransform()},i.prototype._runVennTransform=function(t){void 0===t&&(t=!1),this._data.getDataView().reRunAllTransform(),t&&this.getCompiler().renderNextTick()},i.prototype.initMark=function(){var t=this._createMark(i.mark.circle,{isSeriesMark:!0});t&&(t.setTransform([{type:"vennMark",datumType:"circle"}]),this._circleMark=t);var e=this._createMark(i.mark.overlap,{isSeriesMark:!0});e&&(e.setTransform([{type:"vennMark",datumType:"overlap"}]),this._overlapMark=e)},i.prototype.initMarkStyle=function(){this._initCircleMarkStyle(),this._initOverlapMarkStyle()},i.prototype._initCircleMarkStyle=function(){this._circleMark&&this.setMarkStyle(this._circleMark,{x:function(t){return t.x},y:function(t){return t.y},innerRadius:0,outerRadius:function(t){return t.radius},startAngle:0,endAngle:2*Math.PI,fill:this.getColorAttribute(),stroke:this.getColorAttribute()},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype._initOverlapMarkStyle=function(){this._overlapMark&&(this.setMarkStyle(this._overlapMark,{x:function(t){return t.x},y:function(t){return t.y},path:function(t){return t.path},arcs:function(t){return t.arcs},fill:this.getColorAttribute(),stroke:this.getColorAttribute(),zIndex:function(t){return 100*t.sets.length}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series),this.setMarkStyle(this._overlapMark,{zIndex:function(t){return 100*t.sets.length+1}},t.STATE_VALUE_ENUM.STATE_HOVER,t.AttributeLevel.Series))},i.prototype.initLabelMarkStyle=function(e){e&&(this._labelMark=e,e.setRule("venn"),this.setMarkStyle(e,{x:function(t){return t.labelX},y:function(t){return t.labelY},text:function(t){return Z$(t.sets)},maxLineWidth:function(t){var e=t,i=e.x,n=e.radius,r=e.labelX,a=i-n,o=i+n;return Math.min(r-a,o-r)}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series))},i.prototype.initOverlapLabelMarkStyle=function(e){e&&(this._labelMark=e,e.setRule("venn"),this.setMarkStyle(e,{x:function(t){return t.labelX},y:function(t){return t.labelY},text:function(t){return Z$(t.sets)}},t.STATE_VALUE_ENUM.STATE_NORMAL,t.AttributeLevel.Series))},i.prototype.initTooltip=function(){this._tooltipHelper=new J$(this),this._circleMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._circleMark),this._overlapMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._overlapMark)},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.onLayoutEnd=function(){e.prototype.onLayoutEnd.call(this),this._viewBox.set(0,0,this.getLayoutRect().width,this.getLayoutRect().height),this._runVennTransform()},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[this._circleMark,this._overlapMark]},i.prototype.getStatisticFields=function(){var t=[];return t.push({key:this._categoryField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t},i.prototype.getGroupFields=function(){return null},i.prototype.dataToPosition=function(t,e){return{x:t.x,y:t.y}},i.prototype.dataToPositionX=function(t){return t.x},i.prototype.dataToPositionY=function(t){return t.y},i.prototype.valueToPosition=function(t,e){throw new Error("Method not implemented.")},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return null},i.prototype._getSeriesInfo=function(t,e){var i=this,n=this.getDefaultShapeType();return e.map((function(e){var r;return{key:Z$(e),originalKey:e,style:i.getSeriesStyle((r={},r[t]=e,r)),shapeType:n}}))},i.prototype.getSeriesFieldValue=function(t,i){var n=e.prototype.getSeriesFieldValue.call(this,t,i);return Z$(n)},i.prototype.legendSelectedFilter=function(t,e){if(t.type===I.discreteLegend){var i=t.getLegendDefaultData(!0);if(0===e.length&&i.length)return[];if(e.length===i.length)return e;var n={};e.forEach((function(t){n[t]=!0}));var r=i.filter((function(t){return!n[Z$(t)]})),a=i.filter((function(t){return!r.includes(t)&&r.some((function(e){return St(e).every((function(e){return t.includes(e)}))}))}));e=e.slice(),a.forEach((function(t){e.splice(e.indexOf(Z$(t)),1)}))}return e},i.prototype.initAnimation=function(){var t=this;this.getMarksInType("arc").forEach((function(e){var i;e.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("vennCircle"))||void 0===i?void 0:i(),ZV(e.name,t._spec,t._markAttributeContext)))})),this.getMarksInType("path").forEach((function(e){var i;e.setAnimationConfig(qV(null===(i=KF.getAnimationInKey("vennOverlap"))||void 0===i?void 0:i(),ZV(e.name,t._spec,t._markAttributeContext)))}))},i.type=t.SeriesTypeEnum.venn,i.mark=Q$,i.builtInTheme={venn:r0},i.transformerConstructor=i0,i}(rj),o0=function(){ZX(),nY(),KF.registerAnimation("vennCircle",(function(t,e){return{appear:$$(e),enter:{type:"growRadiusIn"},exit:{type:"growRadiusOut"},disappear:{type:"growRadiusOut"}}})),KF.registerAnimation("vennOverlap",(function(t,e){return{appear:t0(e),update:{custom:e0},enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}}})),XN(),KF.registerGrammarTransform("vennMark",{transform:MZ}),KF.registerSeries(a0.type,a0)},s0={label:{visible:!1,position:"center",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},bar:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}}},l0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.mosaic,i.transformerConstructor=EG,i}return M(i,e),Object.defineProperty(i.prototype,"bandWidthField",{get:function(){return this._bandWidthField},enumerable:!1,configurable:!0}),i.prototype.getStack=function(){return!0},i.prototype.getPercent=function(){return this._spec.percent},i.prototype.getGroupFields=function(){return"vertical"===this.direction?this._specXField:this._specYField},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this);var t=this.getPercent();"horizontal"===this.direction?(t&&(this.setFieldX(zz),this.setFieldX2(Fz)),this.setFieldY(Nz),this.setFieldY2(Hz)):(t&&(this.setFieldY(zz),this.setFieldY2(Fz)),this.setFieldX(Nz),this.setFieldX2(Hz)),this._spec.bandWidthField&&(this._bandWidthField=this._spec.bandWidthField)},i.prototype.parseLabelStyle=function(t,e){if((null==e?void 0:e.filterByGroup)&&j(t.dataFilter)){var i=this.getGroupFields(),n=e.filterByGroup,r=n.field,a=n.type,o=void 0===a?"max":a,s=n.filter;delete t.filterField;var l=i.indexOf(r);if(l<0)return;var u=!!(l%2)?"min"===o?"horizontal"===this.direction?this._fieldY2:this._fieldX2:"horizontal"===this.direction?this._fieldY:this._fieldX:"min"===o?"horizontal"===this.direction?this._fieldX2:this._fieldY2:"horizontal"===this.direction?this._fieldX:this._fieldY,c="min"===o?function(t,e){var i,n;return(null===(i=t.data)||void 0===i?void 0:i[u])<(null===(n=e.data)||void 0===n?void 0:n[u])}:function(t,e){var i,n;return(null===(i=t.data)||void 0===i?void 0:i[u])>(null===(n=e.data)||void 0===n?void 0:n[u])};t.dataFilter=function(t){var e={};return t.forEach((function(t){var i=t.data,n=null==i?void 0:i[r];j(n)||s&&!s(t)||e[n]&&!c(t,e[n])||(e[n]=t)})),t.filter((function(t){var i,n=null===(i=t.data)||void 0===i?void 0:i[r];return e[n]&&e[n]===t}))}}return t},i.type=t.SeriesTypeEnum.mosaic,i.builtInTheme={mosaic:s0},i.transformerConstructor=EG,i}(BG),u0=function(){MG(),mX(),XN(),NU(),KF.registerSeries(l0.type,l0)},c0=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return M(i,e),i.prototype._isValidSeries=function(e){return e===t.SeriesTypeEnum.map},i.prototype._getDefaultSeriesSpec=function(t){return e.prototype._getDefaultSeriesSpec.call(this,t,["type","nameField","valueField","map","nameProperty","centroidProperty","nameMap","area","defaultFillColor","showDefaultName"])},i.prototype.transformSpec=function(t){e.prototype.transformSpec.call(this,t),t.region.forEach((function(t){t.coordinate="geo"})),e.prototype.transformSeriesSpec.call(this,t)},i}(_W),h0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=c0,i.type="map",i.seriesType=t.SeriesTypeEnum.map,i}return M(i,e),i.type="map",i.seriesType=t.SeriesTypeEnum.map,i.transformerConstructor=c0,i}(yW),d0=function(){QW(),yY(),KF.registerChart(h0.type,h0)},p0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._isValidSeries=function(t){return!this.seriesType||t===this.seriesType},e.prototype.getIndicatorSpec=function(t){var e,i,n,r=St(t.indicator),a=null!==(e=t.innerRadius)&&void 0!==e?e:null===(n=null===(i=t.series)||void 0===i?void 0:i[0])||void 0===n?void 0:n.innerRadius;return U(a)&&r.forEach((function(t){j(t.limitRatio)&&(t.limitRatio=a)})),r},e.prototype._getDefaultSeriesSpec=function(e,i){return t.prototype._getDefaultSeriesSpec.call(this,e,["radius","outerRadius","innerRadius","startAngle","endAngle","sortDataByAxis"],i)},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),q(e.dataZoom)&&e.dataZoom.length>0&&e.dataZoom.forEach((function(t){"axis"===t.filterMode&&(t.filterMode="filter")})),this.transformSeriesSpec(e),U(e.indicator)&&(e.indicator=this.getIndicatorSpec(e))},e}(_W),f0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e,["startAngle","endAngle","centerX","centerY"]);return i.categoryField=e.categoryField||e.radiusField,i.valueField=e.valueField||e.angleField,i},e.prototype._transformProgressAxisSpec=function(t,e,i,n,r){var a,o;t.axes||(t.axes=[]);var s=(null!==(a=t.axes)&&void 0!==a?a:[]).find((function(t){return"radius"===t.orient})),l=(null!==(o=t.axes)&&void 0!==o?o:[]).find((function(t){return"angle"===t.orient}));l||(l=e,t.axes.push(l)),s||(s=i,t.axes.push(s)),j(l.type)&&(l.type="linear"),j(s.type)&&(s.type="band");var u=Xj(l,{min:0,max:1});j(l.min)&&(l.min=u.min),j(l.max)&&(l.max=u.max),n&&Object.assign(l,XF({},n,l)),r&&Object.assign(s,XF({},r,s))},e}(p0),v0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.needAxes=function(){return!0},e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e);return i.categoryField=e.categoryField||e.angleField,i.valueField=e.valueField||e.radiusField,i},e.prototype.transformSpec=function(e){var i;if(t.prototype.transformSpec.call(this,e),this.needAxes()){e.axes||(e.axes=[]);var n={radius:!1,angle:!1};(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){var e=t.orient;"radius"===e&&(n.radius=!0),"angle"===e&&(n.angle=!0)})),n.angle||e.axes.push({orient:"angle"}),n.radius||e.axes.push({orient:"radius"})}},e}(p0),g0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){var i,n=t.prototype._getDefaultSeriesSpec.call(this,e,["center","centerOffset","cornerRadius","padAngle","minAngle","emptyPlaceholder","showAllZero","supportNegative","useSequentialAnimation","layoutRadius"]);return n.categoryField=e.categoryField||e.seriesField,n.valueField=e.valueField||e.angleField,n.emptyCircle=null===(i=e.emptyPlaceholder)||void 0===i?void 0:i.emptyCircle,n},e}(p0),y0=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transformerConstructor=g0,e}return M(e,t),e.transformerConstructor=g0,e}(yW),m0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=g0,i.type="pie",i.seriesType=t.SeriesTypeEnum.pie,i}return M(i,e),i.type="pie",i.seriesType=t.SeriesTypeEnum.pie,i.transformerConstructor=g0,i}(y0),_0=function(){QW(),nK(),KF.registerChart(m0.type,m0)},b0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r,a=t.prototype._getDefaultSeriesSpec.call(this,e);return a.radius=null!==(i=e.radius)&&void 0!==i?i:uU,a.outerRadius=null!==(n=e.outerRadius)&&void 0!==n?n:uU,a.innerRadius=null!==(r=e.innerRadius)&&void 0!==r?r:0,a.stack=e.stack,a.percent=e.percent,a},e.prototype.transformSpec=function(e){var i;t.prototype.transformSpec.call(this,e),(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){["domainLine","grid","label","tick"].forEach((function(e){t[e]||(t[e]={visible:!1})})),"angle"===t.orient&&j(t.bandPosition)&&(t.bandPosition=.5)})),e.crosshair=St(e.crosshair||{}).map((function(t){return XF({categoryField:{visible:!0,line:{visible:!0,type:"rect"}}},t)}))},e}(v0),x0=function(t,e){if(!t)return null;var i=Sj(t,(function(t){return"angle"===t.getOrient()}),e),n=Sj(t,(function(t){return"radius"===t.getOrient()}),e);if(!(i&&i.length||n&&n.length))return null;var r=[],a=function(t){return t.getDimensionField()[0]},o=e.x,s=e.y;return i&&i.forEach((function(t){var e,i=t.getScale();if(i&&$R(i.type)){var l=i.domain(),u=i.range(),c=t.getCenter(),h={x:o-t.getLayoutStartPoint().x-c.x,y:s-t.getLayoutStartPoint().y-c.y},d=$O({x:1,y:0},h);d=function(t,e){var i=2*Math.PI,n=Tt(e),r=Mt(e);return t<n?t+=Math.ceil((n-t)/i)*i:t>r&&(t-=Math.ceil((t-r)/i)*i),t}(d,u);var p=tF(h),f=null===(e=n[0])||void 0===e?void 0:e.getScale(),v=null==f?void 0:f.range();if((d-(null==u?void 0:u[0]))*(d-(null==u?void 0:u[1]))>0||(p-(null==v?void 0:v[0]))*(p-(null==v?void 0:v[1]))>0)return;var g=t.invert(d);if(j(g))return;var y=l.findIndex((function(t){return(null==t?void 0:t.toString())===g.toString()}));y<0&&(y=void 0);var m=xj(g,t,"polar",a);r.push({index:y,value:g,position:i.scale(g),axis:t,data:m})}})),n&&n.forEach((function(t){var e,n=t.getScale(),l=null==n?void 0:n.range();if(n&&$R(n.type)){var u=t.getCenter(),c={x:o-t.getLayoutStartPoint().x-u.x,y:s-t.getLayoutStartPoint().y-u.y},h=$O({x:1,y:0},c);h<-Math.PI/2&&(h=2*Math.PI+h);var d=tF(c),p=null===(e=i[0])||void 0===e?void 0:e.getScale(),f=null==p?void 0:p.range();if((h-(null==f?void 0:f[0]))*(h-(null==f?void 0:f[1]))>0||(d-(null==l?void 0:l[0]))*(d-(null==l?void 0:l[1]))>0)return;var v=n.invert(d);if(j(v))return;var g=n.domain().findIndex((function(t){return(null==t?void 0:t.toString())===v.toString()}));g<0&&(g=void 0);var y=xj(v,t,"polar",a);r.push({index:g,value:v,position:n.scale(v),axis:t,data:y})}})),r.length?r:null},k0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=b0,i.type="rose",i.seriesType=t.SeriesTypeEnum.rose,i}return M(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=x0},i.type="rose",i.seriesType=t.SeriesTypeEnum.rose,i.transformerConstructor=b0,i}(yW);kt(k0,AW);var S0=function(){ZW(),QW(),CW(),wW(),AK(),KF.registerChart(k0.type,k0)},A0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n=t.prototype._getDefaultSeriesSpec.call(this,e);return n.line=e.line,n.point=e.point,n.stack=e.stack,n.percent=e.percent,n.area=XF({visible:!1},e.area),n.seriesMark=null!==(i=e.seriesMark)&&void 0!==i?i:"area",n.activePoint=e.activePoint,n.pointDis=e.pointDis,n.pointDisMul=e.pointDisMul,n.markOverlap=e.markOverlap,n},e.prototype.transformSpec=function(e){var i;t.prototype.transformSpec.call(this,e),(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){"radius"===t.orient&&(["domainLine","label","tick"].forEach((function(e){t[e]||(t[e]={visible:!1})})),t.grid||(t.grid={visible:!0}))})),e.crosshair=St(e.crosshair||{}).map((function(t){return XF({categoryField:{visible:!0,line:{visible:!0,type:"line"}}},t)}))},e}(v0),M0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=A0,i.type="radar",i.seriesType=t.SeriesTypeEnum.radar,i}return M(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=x0},i.type="radar",i.seriesType=t.SeriesTypeEnum.radar,i.transformerConstructor=A0,i}(yW);kt(M0,AW);var T0=function(){ZW(),QW(),tG(),CW(),wW(),HK(),KF.registerChart(M0.type,M0)},w0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e);return delete i.data,i},e.prototype._transformAxisSpec=function(t){var e=this;t.axes&&t.autoBandSize&&t.series.forEach((function(i,n){var r;if("bar"===i.type){var a=e._findBandAxisBySeries(i,n,t.axes);if(a&&!a.bandSize&&!a.maxBandSize&&!a.minBandSize){var o=W(i.autoBandSize)&&null!==(r=i.autoBandSize.extend)&&void 0!==r?r:0,s=i.barMaxWidth,l=i.barMinWidth,u=i.barWidth,c=i.barGapInGroup;e._applyAxisBandSize(a,o,{barMaxWidth:s,barMinWidth:l,barWidth:u,barGapInGroup:c})}}}))},e.prototype.transformSpec=function(e){var i=this;if(t.prototype.transformSpec.call(this,e),e.series&&e.series.length){var n=this._getDefaultSeriesSpec(e);e.series.forEach((function(t){i._isValidSeries(t.type)&&Object.keys(n).forEach((function(e){e in t||(t[e]=n[e])}))}))}e.axes&&e.axes.length&&e.axes.forEach((function(t){ut(t,"trimPadding")&&XF(t,ZH(i.type,e))})),this._transformAxisSpec(e)},e}(_W),C0=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transformerConstructor=w0,e.type="common",e}return M(e,t),e.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=function(t,e,i){var n,r;return R(R([],B(null!==(n=IW(t,e,i))&&void 0!==n?n:[]),!1),B(null!==(r=x0(t,e))&&void 0!==r?r:[]),!1)},this._modelOption.getDimensionInfoByValue=OW,this._modelOption.getRectByDimensionData=jW},e.type="common",e.transformerConstructor=w0,e}(yW);kt(C0,AW);var E0=function(){ZW(),QW(),tG(),CW(),KF.registerChart(C0.type,C0),wW()},P0=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return M(i,e),i.prototype._getSeriesDataLength=function(t,e){var i,n;if(e.data){var r=St(e.data)[0];return r instanceof hs?null===(i=r.latestData)||void 0===i?void 0:i.length:null===(n=r.values)||void 0===n?void 0:n.length}var a=St(t.data).find((function(t,i){return e.dataId?t instanceof hs?t.name===e.dataId:t.id===e.dataId:e.dataIndex===i}));return a?a instanceof hs?a.latestData.length:a.values.length:0},i.prototype.addAttrToComponentSpec=function(t,e,i){return Array.isArray(t)?t[0][e]=i:t[e]=i,t},i.prototype.addPaddingRow=function(t,e,i){t.push({index:e,size:i})},i.prototype.addOrientAxes=function(t,e,i,n){t.push({id:"regionAxesRow".concat(i)}),e.push({modelId:"axesRow".concat(i),col:1,row:i}),n.axes[0].id="axesRow".concat(i),n.axes[0].regionIndex=Array.from(Array(n.series.length),(function(t,e){return"top"===n.axes[0].orient?e+1:e}))},i.prototype.transformSpec=function(i){var n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m=this;e.prototype.transformSpec.call(this,i);var _=0,b=[],x=[],k=[],S=[],A=[],M=this._option.getCompiler().getStage(),w=(M.viewWidth,M.viewHeight),C=0;if(null==i?void 0:i.legends){b.push({modelId:"legendRow".concat(_),col:1,row:_}),this.addAttrToComponentSpec(i.legends,"id","legendRow".concat(_));var E=St(i.legends),P=null!==(n=E[0].height)&&void 0!==n?n:40;if(E[0].padding){var L=IF(E[0].padding);P+=Number(null!==(r=null==L?void 0:L.bottom)&&void 0!==r?r:0),P+=Number(null!==(a=null==L?void 0:L.top)&&void 0!==a?a:0),E[0].offsetY=Number(null!==(s=null===(o=E[0])||void 0===o?void 0:o.offsetY)&&void 0!==s?s:0)+Number(null!==(l=null==L?void 0:L.top)&&void 0!==l?l:0)}A.push({index:_,size:P}),C+=P,_++}(null==i?void 0:i.dataZoom)&&(b.push({modelId:"dataZoomRow".concat(_),col:1,row:_}),this.addAttrToComponentSpec(i.dataZoom,"id","dataZoomRow".concat(_)),C+=60,_++,this.addPaddingRow(A,_,10),C+=10,_++),C+=60,null!==i.axes&&"top"!==(null===(c=null===(u=null==i?void 0:i.axes)||void 0===u?void 0:u[0])||void 0===c?void 0:c.orient)||(this.addOrientAxes(x,b,_,i),_++);var I=i.series.filter((function(e){return e.type!==t.SeriesTypeEnum.link})).length,D=(w-C-20*I)/I,O=(null===(h=null==i?void 0:i.appendPadding)||void 0===h?void 0:h.left)||0,F=(null===(d=null==i?void 0:i.appendPadding)||void 0===d?void 0:d.right)||0;null===(p=null==i?void 0:i.series)||void 0===p||p.forEach((function(e){var n,r;if([t.SeriesTypeEnum.bar,t.SeriesTypeEnum.line,t.SeriesTypeEnum.area,t.SeriesTypeEnum.dot].includes(e.type)){if(b.push({modelId:"".concat(e.type,"Row").concat(_),col:1,row:_}),b.push({modelId:"axesLeftRow".concat(_),col:0,row:_}),x.push({id:"".concat(e.type,"Row").concat(_),clip:!1}),A.push({index:_,size:(null==e?void 0:e.height)||D}),k.push({orient:"left",id:"axesLeftRow".concat(_),type:e.type===t.SeriesTypeEnum.dot?"band":"linear",visible:e.type!==t.SeriesTypeEnum.dot,title:{visible:!0,autoRotate:!1,style:{text:null==e?void 0:e.barTitle,dx:-20,textBaseline:"middle",textAlign:"end"}},grid:{visible:"boolean"!=typeof(null===(n=null==e?void 0:e.grid)||void 0===n?void 0:n.visible)||(null===(r=null==e?void 0:e.grid)||void 0===r?void 0:r.visible),style:function(t,i){var n,r,a,o,s,l=0;if(0===i){var u=null===(n=null==e?void 0:e.grid)||void 0===n?void 0:n.style;l=null!==(a=null!==(r=null==u?void 0:u.lineWidth)&&void 0!==r?r:null==u?void 0:u.strokeWidth)&&void 0!==a?a:1}return{lineWidth:l,stroke:(null===(s=null===(o=null==e?void 0:e.grid)||void 0===o?void 0:o.style)||void 0===s?void 0:s.stroke)||"#dfdfdf",lineDash:[0,0]}}},domainLine:{visible:!1},tick:{visible:!1},label:{visible:!1},regionIndex:x.length-1}),e.type===t.SeriesTypeEnum.dot){b.push({modelId:"scrollBarRightRow".concat(_),col:2,row:_});var a=m._getSeriesDataLength(i,e),o=0;a&&(o=((null==e?void 0:e.height)||D)/(30*a)),S.push(T({orient:"right",visible:e.type===t.SeriesTypeEnum.dot&&o<1,id:"scrollBarRightRow".concat(_),start:0,end:Math.min(o,1),filterMode:"axis",regionIndex:x.length-1,axisId:"axesLeftRow".concat(_)},St(null==i?void 0:i.scrollBar)[0]))}e.regionIndex=x.length-1,_++,m.addPaddingRow(A,_,(null==e?void 0:e.padding)||20),_++,e.leftAppendPadding=O,e.type===t.SeriesTypeEnum.dot&&(e.title.style.dx=-O,e.subTitle.style.dx=-O)}})),this.addPaddingRow(A,_,20),_++,null===(f=null==i?void 0:i.series)||void 0===f||f.forEach((function(e){if(e.type===t.SeriesTypeEnum.link){var n=e.dotSeriesIndex+1;b.push({modelId:"".concat(e.type,"Row").concat(n),col:1,row:n-1}),e.regionIndex=i.series[e.dotSeriesIndex].regionIndex,e.leftAppendPadding=O,e.height=i.series[e.dotSeriesIndex].height,e.clipHeight=i.series[e.dotSeriesIndex].clipHeight}})),(null==i?void 0:i.legends)&&this.addAttrToComponentSpec(i.legends,"regionIndex",[x.length-1]),"bottom"===(null===(g=null===(v=null==i?void 0:i.axes)||void 0===v?void 0:v[0])||void 0===g?void 0:g.orient)&&(this.addOrientAxes(x,b,_,i),_++);var z={type:"grid",col:4,row:_,colWidth:[{index:0,size:O},{index:2,size:12},{index:3,size:F}],rowHeight:A,elements:b};i.layout=z,i.region=x,null===(y=i.axes)||void 0===y||y.push.apply(y,R([],B(k),!1)),i.scrollBar=S},i}(_W),B0=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.transformerConstructor=P0,t.type="sequence",t}return M(i,e),i.prototype._createSeries=function(e,i){if(e){var n,r=i.spec,a=w(i,["spec"]);if(r.type===t.SeriesTypeEnum.link&&(r.dotSeriesSpec=this._spec.series[r.dotSeriesIndex]),r.regionId&&(n=this.getRegionsInUserId(r.regionId)),n||(n=this.getRegionsInIndex(r.regionIndex?[r.regionIndex]:void 0)[0]),n){var o=new e(r,T(T(T({},this._modelOption),a),{region:n,specKey:"series",globalScale:this._globalScale}));o&&(o.created(),this._series.push(o),n.addSeries(o))}}},i.type="sequence",i.transformerConstructor=P0,i}(yW),R0=function(){ZW(),QW(),YK(),QK(),WU(),NU(),KF.registerChart(B0.type,B0)},L0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),e.axes.forEach((function(t){return t.type="linear"}))},e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["x2Field","y2Field","barMinHeight","barBackground","barGap"])},e}(bW),I0=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transformerConstructor=L0,e}return M(e,t),e.transformerConstructor=L0,e}(yW);kt(I0,AW);var D0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),XH(e)},e}(L0),O0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=D0,i.type="histogram",i.seriesType=t.SeriesTypeEnum.bar,i}return M(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=IW,this._modelOption.getDimensionInfoByValue=OW,this._modelOption.getRectByDimensionData=jW},i.type="histogram",i.seriesType=t.SeriesTypeEnum.bar,i.transformerConstructor=D0,i}(I0),F0=function(){ZW(),QW(),tG(),CW(),wW(),RG(),KF.registerChart(O0.type,O0)},z0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=t.prototype._getDefaultSeriesSpec.call(this,e);return r.progress=e.progress,r.track=e.track,r.tickMask=e.tickMask,r.cornerRadius=null!==(i=e.cornerRadius)&&void 0!==i?i:0,r.roundCap=null!==(n=e.roundCap)&&void 0!==n&&n,r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this._transformProgressAxisSpec(e,{orient:"angle",visible:!1},{orient:"radius",visible:!1},{forceInitTick:e.tickMask&&!1!==e.tickMask.visible})},e}(f0),H0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=z0,i.type="circularProgress",i.seriesType=t.SeriesTypeEnum.circularProgress,i}return M(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=x0},i.type="circularProgress",i.seriesType=t.SeriesTypeEnum.circularProgress,i.transformerConstructor=z0,i}(yW);kt(H0,AW);var N0=function(){ZW(),QW(),CW(),wW(),lq(),KF.registerChart(H0.type,H0)},V0=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return M(i,e),i.prototype._getDefaultSeriesSpec=function(t){var i=e.prototype._getDefaultSeriesSpec.call(this,t);return i.radiusField=t.radiusField,i.pin=t.pin,i.pinBackground=t.pinBackground,i.pointer=t.pointer,i},i.prototype._getDefaultCircularProgressSeriesSpec=function(i){var n=e.prototype._getDefaultSeriesSpec.call(this,i);return n.type=t.SeriesTypeEnum.circularProgress,n},i.prototype.transformSpec=function(i){var n,r,a,o,s;e.prototype.transformSpec.call(this,i);var l=null===(n=i.series)||void 0===n?void 0:n.find((function(e){return e.type===t.SeriesTypeEnum.gauge||e.type===t.SeriesTypeEnum.circularProgress}));j(l)&&("circularProgress"===(l=null!==(r=i.gauge)&&void 0!==r?r:this._getDefaultCircularProgressSeriesSpec(i)).type&&(j(l.radiusField)&&j(l.categoryField)&&(l.radiusField=null!==(o=null!==(a=i.radiusField)&&void 0!==a?a:i.categoryField)&&void 0!==o?o:i.seriesField),j(l.valueField)&&j(l.angleField)&&(l.valueField=null!==(s=i.valueField)&&void 0!==s?s:i.angleField)),1===i.series.length?i.series.push(l):i.series.forEach((function(t){t.type===l.type&&Object.keys(l).forEach((function(e){e in t||(t[e]=l[e])}))}))),l.type===t.SeriesTypeEnum.circularProgress?this._transformProgressAxisSpec(i,{orient:"angle",visible:!0,domainLine:{visible:!1},grid:{visible:!1}},{orient:"radius",visible:!1},{zIndex:t.LayoutZIndex.Region+50}):this._transformGaugeAxisSpec(i)},i.prototype._transformGaugeAxisSpec=function(e){var i;e.axes||(e.axes=[]);var n={radius:null,angle:null};(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){var e=t.orient;"radius"===e&&(n.radius=t),"angle"===e&&(n.angle=t)})),n.angle||(n.angle={orient:"angle",visible:!0},e.axes.push(n.angle)),n.radius||(n.radius={orient:"radius",visible:!1},e.axes.push(n.radius)),j(n.angle.type)&&(n.angle.type="linear"),j(n.radius.type)&&(n.radius.type="linear"),j(n.angle.zIndex)&&(n.angle.zIndex=t.LayoutZIndex.Region+50)},i}(f0),j0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=V0,i.type="gauge",i.seriesType=t.SeriesTypeEnum.gaugePointer,i}return M(i,e),i.type="gauge",i.seriesType=t.SeriesTypeEnum.gaugePointer,i.transformerConstructor=V0,i}(yW),U0=function(){QW(),o$(),c$(),lq(),KF.registerChart(j0.type,j0)},W0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["nameField","valueField","fontFamilyField","fontWeightField","fontStyleField","colorHexField","colorMode","colorList","rotateAngles","fontWeightRange","fontSizeRange","maskShape","keepAspect","random","wordCloudConfig","wordCloudShapeConfig","word","fillingWord","wordMask"])},e}(_W),G0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=W0,i.type="wordCloud",i.seriesType=t.SeriesTypeEnum.wordCloud,i}return M(i,e),i.transformerConstructor=W0,i}(yW),Y0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=W0,i.type="wordCloud",i.seriesType=t.SeriesTypeEnum.wordCloud,i}return M(i,e),i.type="wordCloud",i.seriesType=t.SeriesTypeEnum.wordCloud,i.transformerConstructor=W0,i}(G0),X0=function(){QW(),SJ(),KF.registerChart(Y0.type,Y0)},K0=function(){KF.registerGrammarTransform("wordcloudShape",{transform:xJ}),SJ(),X0()},q0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","funnelAlign","funnelOrient","heightRatio","shape","funnel","transform","outerLabel","transformLabel","isTransform","maxSize","minSize","gap","isCone","range","transformRatioText"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),t.prototype.transformSeriesSpec.call(this,e)},e}(_W),Z0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=q0,i.type="funnel",i.seriesType=t.SeriesTypeEnum.funnel,i}return M(i,e),i.type="funnel",i.seriesType=t.SeriesTypeEnum.funnel,i.transformerConstructor=q0,i}(yW),J0=function(){QW(),UJ(),KF.registerChart(Z0.type,Z0)},Q0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=t.prototype._getDefaultSeriesSpec.call(this,e,["bandWidth","progress","track","clamp"]);return r.direction=null!==(i=e.direction)&&void 0!==i?i:"horizontal",r.cornerRadius=null!==(n=e.cornerRadius)&&void 0!==n?n:0,r},e.prototype.transformSpec=function(e){var i,n;if(t.prototype.transformSpec.call(this,e),e.axes||(e.axes=[]),"vertical"===e.direction){var r=null,a=null;(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){var e=t.orient;"left"===e&&(r=t),"bottom"===e&&(a=t)})),r||(r={orient:"left",visible:!1},e.axes.push(r)),a||(a={orient:"bottom",visible:!1},e.axes.push(a)),j(a.type)&&(a.type="band"),j(r.type)&&(r.type="linear");var o=Xj(r,{min:0,max:1});j(r.min)&&(r.min=o.min),j(r.max)&&(r.max=o.max)}else{var s=null,l=null;(null!==(n=e.axes)&&void 0!==n?n:[]).forEach((function(t){var e=t.orient;"left"===e&&(s=t),"bottom"===e&&(l=t)})),s||(s={type:"band",orient:"left",visible:!1},e.axes.push(s)),l||(l={orient:"bottom",visible:!1},e.axes.push(l)),j(l.type)&&(l.type="linear"),j(s.type)&&(s.type="band");o=Xj(l,{min:0,max:1});j(l.min)&&(l.min=o.min),j(l.max)&&(l.max=o.max)}},e}(bW),$0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=Q0,i.type="linearProgress",i.seriesType=t.SeriesTypeEnum.linearProgress,i}return M(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=IW,this._modelOption.getDimensionInfoByValue=OW,this._modelOption.getRectByDimensionData=jW},i.type="linearProgress",i.seriesType=t.SeriesTypeEnum.linearProgress,i.transformerConstructor=Q0,i}(yW);kt($0,AW);var t1=function(){ZW(),QW(),CW(),wW(),_q(),KF.registerChart($0.type,$0)},e1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=t.prototype._getDefaultSeriesSpec.call(this,e,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barBackground","barMinHeight","stackCornerRadius","bar"]);return"horizontal"===e.direction?r.xField=null!==(i=e.xField)&&void 0!==i?i:[e.minField,e.maxField]:r.yField=null!==(n=e.yField)&&void 0!==n?n:[e.minField,e.maxField],r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),XH(e)},e}(bW),i1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=e1,i.type="rangeColumn",i.seriesType=t.SeriesTypeEnum.rangeColumn,i}return M(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=IW,this._modelOption.getDimensionInfoByValue=OW,this._modelOption.getRectByDimensionData=jW},i.type="rangeColumn",i.seriesType=t.SeriesTypeEnum.rangeColumn,i.transformerConstructor=e1,i}(yW),n1=function(){ZW(),QW(),CW(),wW(),BX(),KF.registerChart(i1.type,i1)},r1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i=U(e.startAngle)?e.startAngle:-90,n=U(e.endAngle)?e.endAngle:i+ze(2*Math.PI),r=t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","centerX","centerY","offsetX","offsetY","innerRadius","outerRadius","gap","labelLayout","label","labelAutoVisible","drill","drillField"]);return r.startAngle=i,r.endAngle=n,r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(_W),a1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=r1,i.type="sunburst",i.seriesType=t.SeriesTypeEnum.sunburst,i}return M(i,e),i.type="sunburst",i.seriesType=t.SeriesTypeEnum.sunburst,i.transformerConstructor=r1,i}(yW),o1=function(){QW(),lQ(),KF.registerChart(a1.type,a1)},s1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","layoutPadding","circlePacking","drill","drillField"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(_W),l1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=s1,i.type="circlePacking",i.seriesType=t.SeriesTypeEnum.circlePacking,i}return M(i,e),i.type="circlePacking",i.seriesType=t.SeriesTypeEnum.circlePacking,i.transformerConstructor=s1,i}(yW),u1=function(){QW(),vQ(),KF.registerChart(l1.type,l1)},c1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","aspectRatio","splitType","maxDepth","gapWidth","nodePadding","minVisibleArea","minChildrenVisibleArea","minChildrenVisibleSize","roam","drill","drillField","leaf","nonLeaf","nonLeafLabel"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(_W),h1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=c1,i.type="treemap",i.seriesType=t.SeriesTypeEnum.treemap,i}return M(i,e),i.type="treemap",i.seriesType=t.SeriesTypeEnum.treemap,i.transformerConstructor=c1,i}(yW),d1=function(){QW(),ZQ(),KF.registerChart(h1.type,h1)},p1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),e.legends&&St(e.legends).forEach((function(t){t.select=!1,t.hover=!1,t.filter=!1})),XH(e)},e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e);return i.bar=e.bar,i.stackLabel=e.stackLabel,i.leaderLine=e.leaderLine,i.total=e.total,i},e}(LG),f1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=p1,i.type="waterfall",i.seriesType=t.SeriesTypeEnum.waterfall,i}return M(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=IW,this._modelOption.getDimensionInfoByValue=OW,this._modelOption.getRectByDimensionData=jW},i.type="waterfall",i.seriesType=t.SeriesTypeEnum.waterfall,i.transformerConstructor=p1,i}(IG),v1=function(){ZW(),QW(),tG(),CW(),wW(),KY(),KF.registerChart(f1.type,f1)},g1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n=[e.maxField,e.medianField,e.q1Field,e.q3Field,e.minField,e.outliersField],r=t.prototype._getDefaultSeriesSpec.call(this,e,["boxPlot","minField","maxField","q1Field","medianField","q3Field","outliersField","outliersStyle"]);return r.direction=null!==(i=e.direction)&&void 0!==i?i:"vertical",r["horizontal"===r.direction?"xField":"yField"]=n,r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),e.axes||(e.axes=[{orient:"bottom"},{orient:"left"}]),XH(e)},e}(bW),y1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=g1,i.type="boxPlot",i.seriesType=t.SeriesTypeEnum.boxPlot,i}return M(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=IW,this._modelOption.getDimensionInfoByValue=OW,this._modelOption.getRectByDimensionData=jW},i.type="boxPlot",i.seriesType=t.SeriesTypeEnum.boxPlot,i.transformerConstructor=g1,i}(yW),m1=function(){ZW(),QW(),CW(),wW(),gX(),KF.registerChart(y1.type,y1)},_1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","sourceField","targetField","direction","nodeAlign","crossNodeAlign","nodeGap","nodeWidth","linkWidth","minStepWidth","minNodeHeight","maxNodeHeight","minLinkHeight","maxLinkHeight","dropIsolatedNode","nodeHeight","linkHeight","equalNodeHeight","linkOverlap","iterations","nodeKey","linkSortBy","nodeSortBy","setNodeLayer","node","link","emphasis","inverse","overflow"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(_W),b1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=_1,i.type="sankey",i.seriesType=t.SeriesTypeEnum.sankey,i}return M(i,e),i.prototype._setStateInDatum=function(t,e,i,n){var r=q(e)?e[0]:e;if(r){var a=null;this.filterGraphicsByDatum(r,{filter:function(t,e){return"text"!==e.type&&e.getProduct()&&(!i||i(t,e))},region:n,getDatum:function(t){var e,i=null===(e=cH(t))||void 0===e?void 0:e.datum;return q(i)&&(i=i[0]),i},callback:function(t,e,i,n){var r,a,o=e.getProductId();o&&(o.includes("node")||o.includes("link"))&&(null===(a=(r=i)._handleEmphasisElement)||void 0===a||a.call(r,{item:t,mark:e}))},regionCallback:function(t,e){r&&t.length&&(a=t[0])}}),a&&this._interaction.updateStateOfGraphics(t,[a])}else this._interaction.clearByState(t)},i.type="sankey",i.seriesType=t.SeriesTypeEnum.sankey,i.transformerConstructor=_1,i}(yW),x1=function(){QW(),yc.load(CC),FQ(),KF.registerChart(b1.type,b1)},k1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=t.prototype._getDefaultSeriesSpec.call(this,e);return r.area=e.area,r.point=e.point,r.line=e.line,"horizontal"===e.direction?r.xField=null!==(i=e.xField)&&void 0!==i?i:[e.minField,e.maxField]:r.yField=null!==(n=e.yField)&&void 0!==n?n:[e.minField,e.maxField],r.stack=!1,r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),XH(e)},e}(bW),S1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=k1,i.type="rangeArea",i.seriesType=t.SeriesTypeEnum.rangeArea,i}return M(i,e),i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=IW,this._modelOption.getDimensionInfoByValue=OW,this._modelOption.getRectByDimensionData=jW},i.type="rangeArea",i.seriesType=t.SeriesTypeEnum.rangeArea,i.transformerConstructor=k1,i}(yW),A1=function(){ZW(),QW(),tG(),CW(),wW(),DX(),KF.registerChart(S1.type,S1)},M1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["valueField","cell"])},e}(bW),T1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=M1,i.type="heatmap",i.seriesType=t.SeriesTypeEnum.heatmap,i}return M(i,e),i.type="heatmap",i.seriesType=t.SeriesTypeEnum.heatmap,i.transformerConstructor=M1,i}(yW),w1=function(){QW(),b$(),KF.registerChart(T1.type,T1)},C1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","sizeField","sizeRange","centerX","centerY","innerRadius","outerRadius","startAngle","endAngle","ripplePoint","centerPoint","centerLabel","nodePoint"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(_W),E1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=C1,i.type="correlation",i.seriesType=t.SeriesTypeEnum.correlation,i}return M(i,e),i.type="correlation",i.seriesType=t.SeriesTypeEnum.correlation,i.transformerConstructor=C1,i}(yW),P1=function(){QW(),D$(),KF.registerChart(E1.type,E1)};function B1(t){var e,i,n=T({},t);return lt(t.style)||(n.textStyle=sH(t.style)),lt(t.textStyle)||XF(n.textStyle,sH(t.textStyle)),(null===(e=t.shape)||void 0===e?void 0:e.style)&&sH(n.shape.style),(null===(i=t.background)||void 0===i?void 0:i.style)&&sH(n.background.style),n}var R1=function(t,e){var i=[],n={},r=e.series,a=e.seriesField;return r().forEach((function(t){var e=a(t);(e===t.getSeriesField()?t.getSeriesInfoList():t.getSeriesInfoInField(e)).forEach((function(t){n[t.key]||(n[t.key]=!0,i.push(t))}))})),i},L1=function(t,e){var i,n,r,a=e.series,o=e.selected,s=e.field,l=e.data,u=e.customFilter,c=o(),h=l();if(0===c.length&&h.length)return[];if(c.length===h.length)return t;var d={};c.forEach((function(t){d[t]=!0}));var p=null!==(i=s())&&void 0!==i?i:Az;return u?u(t,c,p):(q(t)&&(null===(n=t[0])||void 0===n?void 0:n.nodes)?(t[0].nodes=t[0].nodes.filter((function(t){return!0===d[t.key]})),(null===(r=t[0])||void 0===r?void 0:r.links)&&(t[0].links=t[0].links.filter((function(t){return!0===d[t.source]&&!0===d[t.target]})))):U(p)&&(t=t.filter((function(t){return!0===d[a.getSeriesFieldValue(t,p)]}))),t)},I1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.layoutType="normal",i.layoutZIndex=t.LayoutZIndex.Legend,i.layoutLevel=t.LayoutLevel.Legend,i.specKey="legends",i._orient="left",i._visible=!0,i._position="middle",i._preSelectedData=[],i._selectedData=[],i.effect={onSelectedDataChange:function(){iF(i._regions,(function(t){var e;null===(e=t.getViewData())||void 0===e||e.markRunning()}),{userId:i._seriesUserId,specIndex:i._seriesIndex}),iF(i._regions,(function(t){t.reFilterViewData()}),{userId:i._seriesUserId,specIndex:i._seriesIndex})}},i}return M(i,e),Object.defineProperty(i.prototype,"orient",{get:function(){return this._orient},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),i.prototype.getLegendData=function(){return this._legendData.getLatestData()},i.prototype.getSelectedData=function(){return this._selectedData},i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this._orient=CF(this._spec.orient)?this._spec.orient:"left",this._position=null!==(t=this._spec.position)&&void 0!==t?t:"middle",this._visible=!1!==this._spec.visible;var i=this._spec,n=i.regionId,r=i.regionIndex,a=i.seriesId,o=i.seriesIndex;U(a)&&(this._seriesUserId=St(a)),U(n)&&(this._regionUserId=St(n)),U(o)&&(this._seriesIndex=St(o)),U(r)&&(this._regionUserIndex=St(r)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionUserIndex)},i.prototype.created=function(){e.prototype.created.call(this),this.initData()},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reRender=!0,(null==t?void 0:t.orient)!==(null==i?void 0:i.orient)?(n.reMake=!0,n):(bt(i,t)||(n.reCompile=!0),n)},i.prototype._bindLegendDataChange=function(){this._preSelectedData=this._selectedData.slice(),this._initSelectedData(),this._forceLayout()},i.prototype.initData=function(){var e=this,i=this._initLegendData();i.target.addListener("change",this._bindLegendDataChange.bind(this)),this._legendData=new wN(this._option,i),this._initSelectedData(),iF(this._regions,(function(i){i.event.on(t.ChartEvent.rawDataUpdate,{filter:function(t){var e=t.model;return(null==e?void 0:e.id)===i.id}},(function(){e._legendData.getDataView().reRunAllTransform({skipEqual:!0})}))}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype.setSelectedData=function(e){var i,n,r,a=this,o=this._selectedData;j(e)||JSON.stringify(o)===JSON.stringify(e)||(iF(this._regions,(function(t){t.legendSelectedFilter&&(e=t.legendSelectedFilter(a,e))}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._selectedData=R([],B(e),!1),null===(n=(i=this.effect).onSelectedDataChange)||void 0===n||n.call(i),this.event.emit(t.ChartEvent.legendSelectedDataChange,{model:this}),null===(r=this._legendComponent)||void 0===r||r.setSelected(this._selectedData))},i.prototype.afterSetLayoutStartPoint=function(t){if(e.prototype.afterSetLayoutStartPoint.call(this,t),this._legendComponent){var i=t.x,n=t.y;et(i*n)&&this._legendComponent.setAttributes({x:i,y:n})}},i.prototype.getBoundsInRect=function(t,e){var i=this;if(!this._visible)return this._legendComponent&&this._legendComponent.parent&&(this._legendComponent.parent.removeChild(this._legendComponent),this._legendComponent=null),{x1:0,y1:0,x2:0,y2:0};var n={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0},r=this._getLegendAttributes(t);if(r.disableTriggerEvent=this._option.disableTriggerEvent,this._legendComponent)bt(r,this._cacheAttrs)||this._legendComponent.setAttributes(XF({},r,{defaultSelected:this._selectedData}));else{var a=new(this._getLegendConstructor())(XF({},r,{defaultSelected:this._selectedData}));a.name="legend",this._legendComponent=a,this.getContainer().add(a),this._option.disableTriggerEvent||this._initEvent(),a.on("*",(function(t,e){return i._delegateEvent(i._legendComponent,t,e)}))}this._cacheAttrs=r;var o=isFinite(this._legendComponent.AABBBounds.width())?this._legendComponent.AABBBounds.width():0,s=isFinite(this._legendComponent.AABBBounds.height())?this._legendComponent.AABBBounds.height():0;if("normal-inline"!==this.layoutType){var l="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",u=this._position,c=e.width,h=e.height,d=0,p=0;"horizontal"===l?"middle"===u?d=(c-o)/2:"end"===u&&(d=c-o):"middle"===u?p=(h-s)/2:"end"===u&&(p=h-s),this._legendComponent.setAttributes({dx:d,dy:p})}return n.x2=n.x1+o,n.y2=n.y1+s,n},i.prototype.onDataUpdate=function(){var e,i;if(JSON.stringify(this._preSelectedData)!==JSON.stringify(this._selectedData)){if(this._legendComponent){var n=this._getLegendAttributes(this.getLayoutRect());bt(n,this._cacheAttrs)||this._legendComponent.setAttributes(XF({},n,{defaultSelected:this._selectedData}))}null===(i=(e=this.effect).onSelectedDataChange)||void 0===i||i.call(e),this.event.emit(t.ChartEvent.legendSelectedDataChange,{model:this})}},i.prototype._getNeedClearVRenderComponents=function(){return[this._legendComponent]},i.prototype.clear=function(){e.prototype.clear.call(this),this._cacheAttrs=null,this._preSelectedData=null},i.specKey="legends",i}(yU),D1={orient:"bottom",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"primaryFontColor"},fontWeight:"normal"},space:12},pager:{textStyle:{fill:{type:"palette",key:"discreteLegendPagerTextColor"}},handler:{style:{fill:{type:"palette",key:"discreteLegendPagerHandlerColor"}},state:{disable:{fill:{type:"palette",key:"discreteLegendPagerHandlerDisableColor"}}}}},item:{visible:!0,spaceCol:10,spaceRow:6,padding:2,background:{state:{selectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}},unSelectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}}}},shape:{space:6,style:{lineWidth:0,fillOpacity:1,opacity:1},state:{unSelected:{fillOpacity:.2,opacity:1}}},label:{space:6,style:{fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},opacity:1},state:{unSelected:{fill:{type:"palette",key:"disableFontColor"},opacity:1}}}},allowAllCanceled:!1},O1=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=I.discreteLegend,t.name=I.discreteLegend,t}return M(i,e),i.getSpecInfo=function(t){return _V(t,this.specKey,this.type,(function(t){return!t.type||"discrete"===t.type}))},i.prototype.init=function(i){var n=this;e.prototype.init.call(this,i),iF(this._regions,(function(e){e.addViewDataFilter({type:"discreteLegendFilter",options:{series:e,selected:function(){return n._selectedData},field:function(){return n._getSeriesLegendField(e)},data:function(){return n.getLegendDefaultData()},customFilter:n._spec.customFilter},level:t.TransformLevel.legendFilter})}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype._initLegendData=function(){var t=this;kH(this._option.dataSet,"discreteLegendFilter",L1),kH(this._option.dataSet,"discreteLegendDataMake",R1);var e=new hs(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});return e.transform({type:"discreteLegendDataMake",options:{series:function(){var e=[];return iF(t._regions,(function(t){e.push(t)}),{specIndex:t._spec.seriesIndex,userId:t._spec.seriesId}),e},seriesField:function(e){return t._getSeriesLegendField(e)}}}),e},i.prototype._getSeriesLegendField=function(t){var e,i,n,r=t.getSeriesField(),a=null!==(e=this._spec.scaleName)&&void 0!==e?e:this._spec.scale;if(j(a))return r;if(!t.getRawData())return r;var o=this._option.globalScale.getScaleSpec(a);if(!o)return r;if(this._spec.field)return this._spec.field;if(!xx(o.domain))return r;var s=o.domain.find((function(e){return e.dataId===t.getRawData().name}));return s&&null!==(n=null===(i=s.fields)||void 0===i?void 0:i[0])&&void 0!==n?n:r},i.prototype._initSelectedData=function(){var t=this,e=this.getLegendDefaultData();if(this._unselectedData){var i=[],n=[];e.forEach((function(e){t._unselectedData.includes(e)?n.push(e):i.push(e)})),this._selectedData=i,this._unselectedData=n}else this._spec.defaultSelected?this._selectedData=R([],B(this._spec.defaultSelected),!1):this._selectedData=e},i.prototype.getLegendDefaultData=function(t){return V(this._spec.data)?this._getLegendItems().map((function(t){return t.label})):this._legendData.getLatestData().map(t?function(t){return t.originalKey}:function(t){return t.key})},i.prototype._addDefaultTitleText=function(t){var e,i,n,r;if((null===(e=t.title)||void 0===e?void 0:e.visible)&&j(t.title.text)&&j(null===(i=t.title.style)||void 0===i?void 0:i.text)){var a=null===(r=null===(n=this._regions)||void 0===n?void 0:n[0])||void 0===r?void 0:r.getSeries()[0];if(!a)return;t.title.text=Yz(a.getRawData(),a.getSeriesField())}},i.prototype._getLegendAttributes=function(t){var e="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",i=T(T({layout:e,items:this._getLegendItems(),zIndex:this.layoutZIndex},function(t,e){var i=t.title,n=void 0===i?{}:i,r=t.item,a=void 0===r?{}:r,o=t.pager,s=void 0===o?{}:o,l=t.background,u=void 0===l?{}:l;t.type,t.id,t.visible,t.orient,t.position,t.data,t.filter,t.regionId,t.regionIndex,t.seriesIndex,t.seriesId,t.padding;var c=w(t,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return n.visible?c.title=B1(n):c.title={visible:!1},lt(a.focusIconStyle)||sH(a.focusIconStyle),a.shape&&(a.shape=rH(a.shape)),a.label&&(a.label=rH(a.label)),a.value&&(a.value=rH(a.value)),a.background&&(a.background=rH(a.background)),EF(a.maxWidth)&&(a.maxWidth=Number(a.maxWidth.substring(0,a.maxWidth.length-1))*e.width/100),EF(a.width)&&(a.width=Number(a.width.substring(0,a.width.length-1))*e.width/100),EF(a.height)&&(a.height=Number(a.height.substring(0,a.height.length-1))*e.width/100),c.item=a,"scrollbar"===s.type?(lt(s.railStyle)||sH(s.railStyle),lt(s.sliderStyle)||sH(s.sliderStyle)):(lt(s.textStyle)||sH(s.textStyle),s.handler&&rH(s.handler)),c.pager=s,u.visible&&!lt(u.style)&&(XF(c,u.style),U(u.padding)&&(c.padding=u.padding)),c}(this._spec,t)),{maxWidth:t.width,maxHeight:t.height});return this._addDefaultTitleText(i),this._addLegendItemFormatMethods(i),i},i.prototype._getLegendConstructor=function(){return dO},i.prototype.setSelectedData=function(t){t&&(this._unselectedData=this.getLegendDefaultData().filter((function(e){return!t.includes(e)}))),e.prototype.setSelectedData.call(this,t)},i.prototype._initEvent=function(){var e=this;if(this._legendComponent){var i=!1!==this._spec.filter;this._legendComponent.addEventListener(rO.legendItemClick,(function(n){var r=ut(n,"detail.currentSelected");i&&e.setSelectedData(r),e.event.emit(t.ChartEvent.legendItemClick,{model:e,value:r,event:n})})),this._legendComponent.addEventListener(rO.legendItemHover,(function(i){var n=ut(i,"detail");e.event.emit(t.ChartEvent.legendItemHover,{model:e,value:n,event:i})})),this._legendComponent.addEventListener(rO.legendItemUnHover,(function(i){var n=ut(i,"detail");e.event.emit(t.ChartEvent.legendItemUnHover,{model:e,value:n,event:i})}))}},i.prototype._getLegendItems=function(){var t=(this._legendData.getLatestData()||[]).map((function(t){var e,i,n=t.style("fillOpacity"),r=t.style("strokeOpacity"),a=t.style("opacity"),o=t.style("texture");return{label:t.key,shape:{symbolType:null!==(i=null!==(e=t.style("symbolType"))&&void 0!==e?e:t.shapeType)&&void 0!==i?i:"circle",fillOpacity:et(n)?n:1,strokeOpacity:et(r)?r:1,opacity:et(a)?a:1,texturePadding:o?1:null,textureSize:o?4:null,texture:o,fill:t.style("fill"),stroke:t.style("stroke"),textureColor:t.style("textureColor"),innerBorder:t.style("innerBorder"),outerBorder:t.style("outerBorder"),lineDash:t.style("lineDash"),lineDashOffset:t.style("lineDashOffset"),lineWidth:t.style("lineWidth")}}}));return V(this._spec.data)?this._spec.data(t,this._option.globalScale.getScale("color"),this._option.globalScale):t},i.prototype._addLegendItemFormatMethods=function(t){var e,i,n,r,a=null!==(i=null===(e=this._spec.item)||void 0===e?void 0:e.label)&&void 0!==i?i:{},o=a.formatMethod,s=a.formatter,l=null!==(r=null===(n=this._spec.item)||void 0===n?void 0:n.value)&&void 0!==r?r:{},u=l.formatMethod,c=l.formatter,h=mV(o,s).formatFunc;s&&!o&&h&&(t.item.label.formatMethod=function(t,e){return h(t,e,s)});var d=mV(u,c).formatFunc;c&&!u&&d&&(t.item.value.formatMethod=function(t,e){return d(c,t,e,s)})},i.specKey="legends",i.builtInTheme={discreteLegend:D1},i.type=I.discreteLegend,i}(I1),F1=function(){KF.registerComponent(O1.type,O1)},z1=function(t,e){var i=e.series,n=e.field,r=e.scale,a=n();if(n&&a){var o=1/0,s=-1/0;return i().forEach((function(t){var e=t.getRawDataStatisticsByField(a,!0),i=null==e?void 0:e.min,n=null==e?void 0:e.max;et(i)&&(o=Math.min(i,o)),et(n)&&(s=Math.max(n,s))})),[o,s]}if(r){var l=r();return l?l.domain():[]}return[]},H1=function(t,e){var i=e.selected,n=e.field,r=e.data,a=e.isHierarchyData,o=e.customFilter,s=i(),l=n(),u=a||function(t){return t&&t.some((function(t){return t&&(void 0===i&&(i="children"),!!W(e=t)&&!!e.hasOwnProperty(i)&&Array.isArray(e[i]));var e,i}))};if(s===r())return t;if(l&&!lt(s)){var c=B(s,2),h=c[0],d=c[1];return o?o(t,s,l):u(t)?nH(t,+h,+d,l):t.filter((function(t){return t[l]>=h&&t[l]<=d}))}return t};var N1={color:gO,size:mO},V1={orient:"right",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"primaryFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},endText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},handlerText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6}},j1=function(t){var e={width:200,height:8,style:{fill:{type:"palette",key:"sliderRailColor"}}};return t?(e.width=200,e.height=8):(e.width=8,e.height=200),T(T({},V1),{rail:e,handler:{style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:"#ffffff"},shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"}}}})},U1={horizontal:j1(!0),vertical:j1(!1)},W1=function(t){var e={style:{fill:{type:"palette",key:"sliderRailColor"}}};return t?(e.width=200,e.height=4):(e.height=200,e.width=4),T(T({},V1),{sizeBackground:{fill:{type:"palette",key:"dataZoomChartColor"}},track:{style:{fill:{type:"palette",key:"sliderTrackColor",a:.8}}},rail:e,handler:{style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:{type:"palette",key:"sliderTrackColor"}},fill:{type:"palette",key:"sliderHandleColor"}}}})},G1={horizontal:W1(!0),vertical:W1(!1)},Y1=["#C4E7FF","#98CAFF","#75ACFF","#518FF9","#2775DC","#005CBE","#00429F","#00287E"],X1=[2,10],K1=function(e){function i(t,i){var n=e.call(this,t,i)||this;n.type=I.colorLegend,n.name=I.colorLegend;var r="color"===n._spec.type?I.colorLegend:I.sizeLegend;return n.type=r,n.name=r,n}return M(i,e),i.getSpecInfo=function(t){var e=_V(t,this.specKey,this.type,(function(t){return function(t){return"color"===t||"size"===t}(t.type)}));return e&&e.forEach((function(t){t.type="color"===t.spec.type?I.colorLegend:I.sizeLegend})),e},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this._field=this._spec.field,this._legendType=this._spec.type},i.prototype.init=function(i){var n=this;e.prototype.init.call(this,i),iF(this._regions,(function(e){e.addViewDataFilter({type:"continuousLegendFilter",options:{selected:function(){return n._selectedData},field:function(){return n._field},data:function(){return n._legendData.getLatestData()},isHierarchyData:e.isHierarchyData,customFilter:n._spec.customFilter},level:t.TransformLevel.legendFilter})}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype._getScaleInGlobal=function(){var t=this._option.globalScale,e=this._spec.scale;return e||(e=this._legendType),t.getScale(e)},i.prototype._initLegendData=function(){var t=this;kH(this._option.dataSet,"continuousLegendFilter",H1),kH(this._option.dataSet,"continuousLegendDataMake",z1);var e=new hs(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});return e.transform({type:"continuousLegendDataMake",options:{series:function(){return nF(t._regions,{userId:t._seriesUserId,specIndex:t._seriesIndex})},field:function(){return t._field},scale:this._getScaleInGlobal.bind(this)}}),e},i.prototype._initSelectedData=function(){this._spec.defaultSelected?this._selectedData=this._spec.defaultSelected.slice():this._selectedData=this._legendData.getLatestData()},i.prototype._addDefaultTitleText=function(t){var e,i,n,r;if((null===(e=t.title)||void 0===e?void 0:e.visible)&&j(t.title.text)&&j(null===(i=t.title.style)||void 0===i?void 0:i.text)){var a=this._field;if(a){var o=null===(r=null===(n=this._regions)||void 0===n?void 0:n[0])||void 0===r?void 0:r.getSeries()[0];if(!o)return;return void(t.title.text=Yz(o.getRawData(),a))}var s=this._spec.scale;s||(s=this._legendType);var l=this._option.globalScale.getScaleSpec(s);if(!xx(null==l?void 0:l.domain))return;var u=l.domain[0];if(0===u.fields.length)return;t.title.text=Yz(this._option.dataSet.getDataView(u.dataId),u.fields[0])}else;},i.prototype._getLegendAttributes=function(t){var e,i,n,r="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",a="horizontal"===r?"bottom":this.layoutOrient,o=[],s=this._getScaleInGlobal();s&&"linear"===s.type&&(o=s.range()),lt(o)&&(o="color"===this._legendType?Y1:X1);var l=null!==(i=this._legendData.getLatestData()[0])&&void 0!==i?i:0,u=null!==(n=this._legendData.getLatestData()[1])&&void 0!==n?n:1;this._legendData.getLatestData()[0]===this._legendData.getLatestData()[1]&&(l=Math.min(0,this._legendData.getLatestData()[0]),u=0===this._legendData.getLatestData()[0]?1:Math.max(0,this._legendData.getLatestData()[0]));var c=T(((e={layout:r,align:a,zIndex:this.layoutZIndex,min:l,max:u,value:this._spec.defaultSelected})["color"===this._legendType?"colors":"sizeRange"]=o,e),function(t){var e=XF({},t),i=e.title,n=void 0===i?{}:i,r=e.handler,a=void 0===r?{}:r,o=e.rail,s=void 0===o?{}:o,l=e.track,u=void 0===l?{}:l,c=e.startText,h=e.endText,d=e.handlerText,p=e.sizeBackground,f=e.background,v=void 0===f?{}:f;e.type,e.id,e.visible,e.orient,e.position,e.data,e.defaultSelected,e.field,e.filter,e.regionId,e.regionIndex,e.seriesIndex,e.seriesId,e.padding;var g=w(e,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return n.visible?g.title=B1(n):g.title={visible:!1},g.showHandler=!1!==a.visible,lt(a.style)||(g.handlerStyle=sH(a.style)),U(s.width)&&(g.railWidth=s.width),U(s.height)&&(g.railHeight=s.height),lt(s.style)||(g.railStyle=sH(s.style)),lt(u.style)||(g.trackStyle=sH(u.style)),g.startText=rH(c),g.endText=rH(h),g.handlerText=rH(d),lt(p)||(g.sizeBackground=sH(p)),v.visible&&!lt(v.style)&&(XF(g,v.style),U(v.padding)&&(g.padding=v.padding)),g}(this._spec));return this._addDefaultTitleText(c),c},i.prototype._getLegendConstructor=function(){return N1[this._legendType]},i.prototype._initEvent=function(){var e=this;if(this._legendComponent){var i=!1!==this._spec.filter;this._legendComponent.addEventListener("change",Jt((function(n){var r=ut(n,"detail.value");i&&e.setSelectedData(r),e.event.emit(t.ChartEvent.legendFilter,{model:e,value:r,event:n})}),30))}},i.specKey="legends",i.builtInTheme={colorLegend:U1,sizeLegend:G1},i.type=I.continuousLegend,i}(I1),q1=function(){KF.registerComponent(K1.type,K1)},Z1=function(t,e){return U(e)?t.map((function(t){return e[t]})):void 0},J1=function(t,e){return function(i){return t.every((function(t,n){return i[t]===(null==e?void 0:e[n])}))}},Q1=function(t){return!j(t)&&(q(t)?t.length>0&&t.every(U):Object.keys(t).length>0)};function $1(t,e,i){var n,r,a,o=T({regionIndex:0},e),s=i.getOption(),l=s.getRegionsInUserIdOrIndex(U(o.regionId)?[o.regionId]:void 0,U(o.regionIndex)?[o.regionIndex]:void 0)[0];if(!l)return"none";var u,c=i2(t,l),h=null!==(n=o.activeType)&&void 0!==n?n:c.length>1?"dimension":"mark",d=l.getLayoutStartPoint(),p=l.getLayoutRect(),f=s.globalInstance.getContainer(),v=T({x:0,y:0},f?{x:(u=f.getBoundingClientRect()).x,y:u.y}:{}),g=function(t){var e,i=t.data,n=i.dimensionFields,r=i.dimensionData,a=i.measureFields,o=i.measureData,s=i.groupField,l=i.groupData,u=null===(e=t.series.getViewData())||void 0===e?void 0:e.latestData.find((function(t){return J1(n,r)(t)&&J1(a,o)(t)&&(j(s)||J1([s],[l])(t))}));return u},y=function(t){var e,i,n=function(t){return{x:Math.min(Math.max(t.x,0),p.width),y:Math.min(Math.max(t.y,0),p.height)}}(t),r=null!==(e=o.x)&&void 0!==e?e:d.x+n.x,a=null!==(i=o.y)&&void 0!==i?i:d.y+n.y;return{canvasX:r,canvasY:a,clientX:v.x+r,clientY:v.y+a}};if("dimension"===h){var m=c[0];if(!m)return"none";var _=new Map;c.forEach((function(t){var e;_.has(t.series)||_.set(t.series,[]),null===(e=_.get(t.series))||void 0===e||e.push(t)}));var b=[{value:t[m.data.dimensionFields[0]],data:R([],B(_.keys()),!1).map((function(t){var e,i;return{series:t,datum:null!==(i=null===(e=_.get(t))||void 0===e?void 0:e.map((function(t){return g(t)})))&&void 0!==i?i:[]}}))}];U(m.dimType)&&(b[0].position=m.pos[m.dimType],b[0].dimType=m.dimType);var x={changePositionOnly:!1,action:"enter",tooltip:null,dimensionInfo:b,chart:null!==(r=s.globalInstance.getChart())&&void 0!==r?r:void 0,datum:void 0,model:void 0,source:vH.chart,event:y({x:c.reduce((function(t,e){return t+e.pos.x}),0)/c.length,y:c.reduce((function(t,e){return t+e.pos.y}),0)/c.length}),item:void 0};i.processor.dimension.showTooltip(b,x,!1);var k=s.globalInstance;return pV.globalConfig.uniqueTooltip&&pV.hideTooltip(k.id),h}if("mark"===h){var S=c[0];if(!S)return"none";var A=T(T({},g(S)),t),M=[{datum:[A],series:S.series}];x={changePositionOnly:!1,tooltip:null,dimensionInfo:b=[{value:A[S.data.dimensionFields[0]],data:M}],chart:null!==(a=s.globalInstance.getChart())&&void 0!==a?a:void 0,datum:A,model:S.series,source:vH.chart,event:y(S.pos),item:void 0};i.processor.mark.showTooltip({datum:A,mark:null,series:S.series},x,!1);k=s.globalInstance;return pV.globalConfig.uniqueTooltip&&pV.hideTooltip(k.id),h}return"none"}var t2,e2,i2=function(e,i){var n=i.getSeries(),r=[];return n.forEach((function(i){var n,a,o,s,l,u,c,h=i.getDimensionField(),d=i.getMeasureField(),p=i.getSeriesField(),f=U(p)?e[p]:void 0,v=U(p)&&null!==(s=null===(o=null===(a=null===(n=i.getViewDataStatistics)||void 0===n?void 0:n.call(i))||void 0===a?void 0:a.latestData[p])||void 0===o?void 0:o.values)&&void 0!==s?s:[],g=Z1(h,e),y=Z1(d,e),m=Q1(y),_=!m&&U(p)&&j(f)&&v.length>0,b=function(){var e,n=null===(e=i.getViewData())||void 0===e?void 0:e.latestData.find(J1(h,g));if(m||(y=Z1(d,n),Q1(y))){var a=i.type===t.SeriesTypeEnum.pie?i.dataToCentralPosition(n):i.dataToPosition(n);j(a)||isNaN(a.x)||isNaN(a.y)||r.push({pos:a,data:{dimensionFields:h,dimensionData:g,measureFields:d,measureData:y,hasMeasureData:m,groupField:p,groupData:f},series:i})}};if("cartesian"===i.coordinate){var x=i,k=$R(null===(u=null===(l=i.getYAxisHelper())||void 0===l?void 0:l.getScale(0))||void 0===u?void 0:u.type)?"y":"x",S=h.map((function(t,e){return[t,e]})).filter((function(t){var e=B(t,2)[1];return j(null==g?void 0:g[e])})),A=[null!=g?g:[]];S.length>0&&S.forEach((function(t){var e,n,r,a,o=B(t,2),s=o[0],l=o[1],u=null!==(a=null===(r=null===(n=null===(e=i.getViewDataStatistics)||void 0===e?void 0:e.call(i))||void 0===n?void 0:n.latestData[s])||void 0===r?void 0:r.values)&&void 0!==a?a:[],c=[];A.forEach((function(t){u.forEach((function(e){var i,n=null!==(i=null==t?void 0:t.slice())&&void 0!==i?i:[];n[l]=e,c.push(n)}))})),A=c})),A.forEach((function(t){var e,n;if(_){var a=null===(e=x.getViewData())||void 0===e?void 0:e.latestData.filter(J1(h,t));v.forEach((function(e){var n=a.find((function(t){return t[p]===e}));if(y=Z1(d,n),Q1(y)){var o=x.dataToPosition(n);j(o)||isNaN(o.x)||isNaN(o.y)||r.push({pos:o,data:{dimensionFields:h,dimensionData:t,measureFields:d,measureData:y,hasMeasureData:m,groupField:p,groupData:e},series:i,dimType:k})}}))}else{var o=null===(n=x.getViewData())||void 0===n?void 0:n.latestData.find(J1(h,t));if(!m&&(y=Z1(d,o),!Q1(y)))return;var s=x.dataToPosition(o);if(j(s)||isNaN(s.x)||isNaN(s.y))return;r.push({pos:s,data:{dimensionFields:h,dimensionData:t,measureFields:d,measureData:y,hasMeasureData:m,groupField:p,groupData:f},dimType:k,series:i})}}))}else if("polar"===i.coordinate)if(i.type===t.SeriesTypeEnum.pie)b();else{var M=i;if(_){var T=(null===(c=M.getViewData())||void 0===c?void 0:c.latestData.filter(J1(h,g))).find((function(t){return t[p]===f}));v.forEach((function(t){if(y=Z1(d,T),Q1(y)){var e=M.dataToPosition(T);j(e)||isNaN(e.x)||isNaN(e.y)||r.push({pos:e,data:{dimensionFields:h,dimensionData:g,measureFields:d,measureData:y,hasMeasureData:m,groupField:p,groupData:t},series:i})}}))}else b()}else"geo"===i.coordinate&&b()})),r},n2=function(t){return U(t)&&!q(t)},r2=function(t){return U(t)&&q(t)},a2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._shouldMergeThemeToSpec=function(){return!1},e.prototype._initTheme=function(e,i){var n,r,a,o=t.prototype._initTheme.call(this,e,i),s=o.spec,l=o.theme;return s.style=XF({},this._theme,s.style),s.offset=XF({},l.offset,e.offset),s.transitionDuration=null!==(n=e.transitionDuration)&&void 0!==n?n:l.transitionDuration,s.trigger=null!==(r=e.trigger)&&void 0!==r?r:l.trigger,s.triggerOff=null!==(a=e.triggerOff)&&void 0!==a?a:l.triggerOff,{spec:s,theme:l}},e.prototype._transformSpecAfterMergingTheme=function(e,i,n){var r,a,o,s,l,u,c;t.prototype._transformSpecAfterMergingTheme.call(this,e,i,n),e.visible=null===(r=e.visible)||void 0===r||r,e.activeType=function(t){var e,i,n;if(!1===(null==t?void 0:t.visible))return[];var r={mark:!1!==(null===(e=null==t?void 0:t.mark)||void 0===e?void 0:e.visible),dimension:!1!==(null===(i=null==t?void 0:t.dimension)||void 0===i?void 0:i.visible),group:!1!==(null===(n=null==t?void 0:t.group)||void 0===n?void 0:n.visible)};return U(null==t?void 0:t.activeType)&&Object.keys(r).forEach((function(e){var i;r[e]=null===(i=null==t?void 0:t.activeType)||void 0===i?void 0:i.includes(e)})),Object.keys(r).filter((function(t){return r[t]}))}(e),e.renderMode=null!==(a=e.renderMode)&&void 0!==a?a:yx(this._option.mode)||!vx(this._option.mode)?"canvas":"html",e.trigger=null!==(o=e.trigger)&&void 0!==o?o:"hover",e.className=null!==(s=e.className)&&void 0!==s?s:"vchart-tooltip-element",e.enterable=null!==(l=e.enterable)&&void 0!==l&&l,e.transitionDuration=null!==(u=e.transitionDuration)&&void 0!==u?u:150,e.confine=null!==(c=e.confine)&&void 0!==c?c:"canvas"===e.renderMode,U(e.parentElement)?K(e.parentElement)&&(e.parentElement=j_.getElementById(e.parentElement)):vx(this._option.mode)&&(e.parentElement=null==fx?void 0:fx.body)},e}(gU),o2={offset:{x:10,y:10},panel:{padding:{top:10,left:10,right:10,bottom:10},backgroundColor:{type:"palette",key:"popupBackgroundColor"},border:{color:{type:"palette",key:"popupBackgroundColor"},width:0,radius:3},shadow:{x:0,y:4,blur:12,spread:0,color:{type:"palette",key:"shadowColor"}}},spaceRow:6,titleLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0},shape:{size:8,spacing:6},keyLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle",spacing:26},valueLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0}},s2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.layoutZIndex=1,i.type=I.tooltip,i.name=I.tooltip,i.transformerConstructor=a2,i.specKey="tooltip",i.layoutType="none",i._isReleased=!1,i._alwaysShow=!1,i._eventList=[],i._isTooltipShown=!1,i._clickLock=!1,i._mountEvent=function(t,e,n){i.event.on(t,e,n),i._eventList.push({eventType:t,handler:n})},i._handleClickToLock=function(t){var e,n;if(i._clickLock)i._handleChartMouseOut(t),i._clickLock=!1;else{if(!i._isTooltipShown&&!(null===(n=null===(e=i.tooltipHandler)||void 0===e?void 0:e.isTooltipShown)||void 0===n?void 0:n.call(e)))return;i._clickLock=!0}},i._getMouseOutHandler=function(t){return function(e){var n,r,a,o,s;if(!i._isReleased&&!i._alwaysShow&&!i._clickLock&&(i._isTooltipShown||(null===(r=null===(n=i.tooltipHandler)||void 0===n?void 0:n.isTooltipShown)||void 0===r?void 0:r.call(n)))){var l=vx(null===(a=i._option)||void 0===a?void 0:a.mode),u=e.event,c=u.clientX,h=u.clientY;l&&t&&i._isPointerInChart({x:c,y:h})||(i._enterable?i._outTimer=setTimeout((function(){i._handleChartMouseOut(e)}),null!==(s=null===(o=i._spec)||void 0===o?void 0:o.showDelay)&&void 0!==s?s:50):i._handleChartMouseOut(e))}}},i._handleChartMouseOut=function(t){i._alwaysShow||i._isReleased||i._isEnterTooltip||"none"!==i._spec.triggerOff&&(i._hideTooltipByHandler(T(T({},t),{tooltip:i})),i._handleMouseMove&&i._handleMouseMove.cancel&&i._handleMouseMove.cancel(),i._cacheEnterableRect=null,i._cacheInfo=void 0,i._cacheParams=void 0,i._cacheActiveType=void 0)},i._getMouseMoveHandler=function(t){return function(e){var n,r,a,o;i._isReleased||i._isEnterTooltip||(i._outTimer&&(clearTimeout(i._outTimer),i._outTimer=null),i.tooltipHandler||i._initHandler(),i.processor||i._initProcessor(),i._alwaysShow||(i._clickLock?t&&(i._handleChartMouseOut(e),i._clickLock=!1):!t&&i._enterable&&(null===(r=null===(n=i.tooltipHandler)||void 0===n?void 0:n.isTooltipShown)||void 0===r?void 0:r.call(n))?(i._showTimer&&clearTimeout(i._showTimer),i._showTimer=setTimeout((function(){i._handleChartMouseMove(e,t)}),null!==(o=null===(a=i._spec)||void 0===a?void 0:a.showDelay)&&void 0!==o?o:50)):i._handleChartMouseMove(e,t)))}},i._handleChartMouseMove=function(t,e){if(!i._isReleased){for(var n=i._getMouseEventData(t),r=n.tooltipInfo.dimension,a=n.ignore.mark,o={mark:!1,dimension:!1,group:!1},s=["group","mark","dimension"],l=0,u=s.length;l<u;l++){var c=s[l];if(!!i.processor[c]&&i._showTooltipByMouseEvent(c,n,t,e)){o[c]=!0;break}}Object.values(o).every((function(t){return!t}))&&!function(t){return j(t.mark)&&j(t.model)&&j(t.datum)}(t)&&(a&&n2(i._cacheInfo)?o.mark=i._showTooltipByMouseEvent("mark",n,t,e,!0):U(r)&&(o.dimension=i._showTooltipByMouseEvent("dimension",n,t,e))),o.mark||o.group||o.dimension&&!j(r)?i._initEventOfTooltipContent():i._handleChartMouseOut(t)}},i._showTooltipByMouseEvent=function(t,e,n,r,a){var o,s,l=i.processor[t];if(!l.shouldHandleTooltip(n,e.tooltipInfo[t]))return!1;if(i._hideTimer&&clearTimeout(i._hideTimer),a)s=!l.showTooltip(i._cacheInfo,n,!0);else{var u=e.tooltipInfo[t],c=i._isSameAsCache(u,n,t);(s=!l.showTooltip(u,n,c))&&(i._cacheInfo=u,i._cacheParams=n,i._cacheActiveType=t)}s&&(i._isTooltipShown=!0,r&&i._spec.lockAfterClick&&!i._clickLock?i._clickLock=!0:Number.isFinite(i._spec.hideTimer)&&(i._hideTimer=setTimeout((function(){i._handleChartMouseOut()}),i._spec.hideTimer)));var h=null===(o=i._option)||void 0===o?void 0:o.globalInstance;return s&&pV.globalConfig.uniqueTooltip&&h&&pV.hideTooltip(h.id),s},i._getMouseEventData=function(t){var e={tooltipInfo:{},ignore:{}};return Object.keys(i.processor).forEach((function(n){var r=i.processor[n].getMouseEventData(t),a=r.tooltipInfo,o=r.ignore;e.tooltipInfo[n]=a,e.ignore[n]=o})),e},i._hideTooltipByHandler=function(e){var n,r,a;if(!i._isTooltipShown&&!(null===(r=null===(n=i.tooltipHandler)||void 0===n?void 0:n.isTooltipShown)||void 0===r?void 0:r.call(n)))return 0;i.event.emit(t.ChartEvent.tooltipHide,T(T({},e),{source:vH.chart,tooltip:i})),Object.values(i.processor).forEach((function(t){t.clearCache()}));var o=null!==(a=i._spec.handler)&&void 0!==a?a:i.tooltipHandler;if(o.hideTooltip){var s=o.hideTooltip.call(o,e);return s||(i._isTooltipShown=!1),s}return 1},i.hideTooltip=function(){if(i._isReleased)return!1;var t={changePositionOnly:!1,tooltip:i,item:void 0,datum:void 0,source:vH.chart};return i._alwaysShow=!1,!i._hideTooltipByHandler(t)},i}return M(i,e),i.prototype.isTooltipShown=function(){return this._isTooltipShown},i.prototype._registerEvent=function(){},i.prototype._releaseEvent=function(){},i.prototype.onLayoutEnd=function(){},i.prototype.created=function(){e.prototype.created.call(this),this._regions=this._option.getAllRegions(),this._initEvent()},i.prototype.release=function(){var t,i,n=this;e.prototype.release.call(this),this._isReleased=!0,this._hideTimer&&clearTimeout(this._hideTimer),this._eventList.forEach((function(t){var e=t.eventType,i=t.handler;n.event.off(e,i)})),this._eventList=[],null===(i=null===(t=this.tooltipHandler)||void 0===t?void 0:t.release)||void 0===i||i.call(t),this._isTooltipShown=!1},i.prototype.beforeRelease=function(){this.event.emit(t.ChartEvent.tooltipHide,{tooltip:this,chart:this.getChart()}),this.event.emit(t.ChartEvent.tooltipRelease,{tooltip:this,chart:this.getChart()})},i.prototype._initHandler=function(){var t,e,i,n=null!==(t=this._spec.renderMode)&&void 0!==t?t:"html",r=this._option.globalInstance.getTooltipHandlerByUser();if(r)this.tooltipHandler=r,this._enterable=!1;else{var a="canvas"===n?YW.canvas:YW.dom,o=KF.getComponentPluginInType(a);o||hx("Can not find tooltip handler: "+a);var s=new o;s.name="".concat(this._spec.className,"-").concat(null!==(e=this._option.globalInstance.id)&&void 0!==e?e:0,"-").concat(this.getSpecIndex()),null===(i=this.pluginService)||void 0===i||i.load([s]),this.tooltipHandler=s,this._spec.enterable&&"html"===n&&this.tooltipHandler?(this._enterable=!0,this._needInitEventOfTooltip=!0):this._enterable=!1}},i.prototype._initEventOfTooltipContent=function(){var t,e,i=this;if(this._needInitEventOfTooltip){var n=null===(e=(t=this.tooltipHandler).getRootDom)||void 0===e?void 0:e.call(t);n&&(n.addEventListener("pointerenter",(function(){var t;if(i._enterable){i._isEnterTooltip=!0;var e=null===(t=n.getBoundingClientRect)||void 0===t?void 0:t.call(n);e&&(i._cacheEnterableRect={width:e.width,height:e.height}),i._outTimer&&(clearTimeout(i._outTimer),i._outTimer=null),i._showTimer&&(clearTimeout(i._showTimer),i._showTimer=null)}})),n.addEventListener("pointerleave",(function(){var t,e,r;if(i._enterable&&(i._isEnterTooltip=!1,"none"!==i._spec.triggerOff&&i._cacheEnterableRect)){var a=null===(t=n.getBoundingClientRect)||void 0===t?void 0:t.call(n);a&&Object.keys(i._cacheEnterableRect).every((function(t){return i._cacheEnterableRect[t]===a[t]}))&&(i._cacheEnterableRect=null,i._outTimer=setTimeout(i.hideTooltip,null!==(r=null===(e=i._spec)||void 0===e?void 0:e.showDelay)&&void 0!==r?r:50))}})),this._needInitEventOfTooltip=!1)}},i.prototype._initProcessor=function(){var t=this,e=this._spec.activeType;this.processor={},e.forEach((function(e){var i=KF.createTooltipProcessor(e,t);i&&(t.processor[e]=i)}))},i.prototype._initEvent=function(){var t,e=this;if(!this._option.disableTriggerEvent){var i=St(null!==(t=this._spec.trigger)&&void 0!==t?t:"hover"),n=St(this._spec.triggerOff),r=this._option.mode;i.forEach((function(t){var i;"hover"===t?(e._handleMouseMove=e._throttle(e._getMouseMoveHandler(!1)),e._mountEvent("pointermove",{source:"chart"},e._handleMouseMove),(gx(r)||yx(r))&&(e._mountEvent("pointerdown",{source:"chart"},e._getMouseMoveHandler(!1)),e._mountEvent("pointerup",{source:"window"},e._getMouseOutHandler(!0))),e._mountEvent("pointerleave",{source:"chart"},e._getMouseOutHandler(!1))):"click"===t?(e._mountEvent("pointertap",{source:"chart"},e._getMouseMoveHandler(!0)),e._mountEvent("pointerup",{source:"window"},e._getMouseOutHandler(!0))):W(t)&&e._mountEvent(t.eventType,{source:null!==(i=t.source)&&void 0!==i?i:"chart",consume:t.consume},e._getMouseMoveHandler(!0))})),n.filter((function(t){return W(t)})).forEach((function(t){var i,n;e._mountEvent(t.eventType,{source:null!==(i=t.source)&&void 0!==i?i:"chart",consume:t.consume},e._getMouseOutHandler(null!==(n=t.checkOutside)&&void 0!==n&&n))})),!i.includes("click")&&this._spec.lockAfterClick&&this._mountEvent("pointertap",{source:"chart"},this._handleClickToLock)}},i.prototype._throttle=function(t){return Qt(t,Q(this._spec.throttleInterval)?this._spec.throttleInterval:"html"===this._spec.renderMode&&this._spec.transitionDuration?50:10)},i.prototype.reInit=function(t){var i,n,r;if(e.prototype.reInit.call(this,t),this.tooltipHandler){var a=null!==(i=this._spec.renderMode)&&void 0!==i?i:"html",o=this._spec.enterable&&"html"===a;o&&!this._enterable&&(this._needInitEventOfTooltip=!0),this._enterable=o,null===(r=(n=this.tooltipHandler).reInit)||void 0===r||r.call(n)}else this._initHandler()},i.prototype.showTooltip=function(t,e){var i;if(this.tooltipHandler||this._initHandler(),this.processor||this._initProcessor(),!(null===(i=this.tooltipHandler)||void 0===i?void 0:i.showTooltip))return!1;var n=$1(t,e,this);return"none"!==n&&(this._alwaysShow=!!(null==e?void 0:e.alwaysShow)),n},i.prototype._isSameAsCache=function(t,e,i){if(i!==this._cacheActiveType)return!1;if(t===this._cacheInfo)return!0;if(j(this._cacheInfo)||j(t))return!1;if(r2(t)){if(n2(this._cacheInfo))return!1;var n=this._cacheInfo,r=n.length===t.length&&t.every((function(t,e){return bj(t,n[e])}));return r}if(r2(this._cacheInfo))return!1;var a=this._cacheInfo;if(!((null==t?void 0:t.datum)===a.datum&&(null==t?void 0:t.mark)===a.mark&&(null==t?void 0:t.series)===a.series))return!1;var o=this._cacheParams;return!j(o)&&!j(e)&&(o.mark===e.mark&&o.model===e.model&&o.datum===e.datum)},i.prototype._isPointerInChart=function(t){var e,i=null===(e=this._option)||void 0===e?void 0:e.globalInstance;if(!i)return!1;if(!i.getChart())return!1;var n=t.x,r=t.y,a=i.getCanvas().getBoundingClientRect(),o=a.x,s=a.y,l=a.width,u=a.height;return n>=o&&n<=o+l&&r>=s&&r<=s+u},i.prototype.getVisible=function(){return!1!==this._spec.visible},i.type=I.tooltip,i.transformerConstructor=a2,i.builtInTheme={tooltip:o2},i.specKey="tooltip",i}(yU),l2=function(){KF.registerComponent(s2.type,s2)};t.TooltipResult=void 0,(t2=t.TooltipResult||(t.TooltipResult={}))[t2.success=0]="success",t2[t2.failed=1]="failed",function(t){t[t.ALL=3]="ALL",t[t.HORIZONTAL=2]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(e2||(e2={}));var u2={x:["top","bottom"],y:["left","right"],category:["angle"],value:["radius"]},c2=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.specKey="crosshair",r.layoutType="none",r.gridZIndex=t.LayoutZIndex.CrossHair_Grid,r.labelZIndex=t.LayoutZIndex.CrossHair,r.trigger="hover",r._handleIn=function(t){if(r._option){var e=r.calculateTriggerPoint(t),i=e.x,n=e.y;r.showDefault=!1,r._layoutCrosshair(i,n);var a=r._getNeedClearVRenderComponents();r._hasActive=a.some((function(t){return t&&!1!==t.attribute.visible}))}},r._handleClickInEvent=function(t){if(!r._hasActive||!r._spec.lockAfterClick||r._clickLock)return r._clickLock?(r._clickLock=!1,void r._handleOutEvent()):void(r._onlyLockClick||(r._handleIn(t),Q(r.triggerOff)&&(r._timer&&clearTimeout(r._timer),r._timer=setTimeout((function(){r._handleOutEvent()}),r.triggerOff))));r._clickLock=!0},r._handleHoverInEvent=Qt((function(t){r._clickLock||r._handleIn(t)}),10),r._handleOutEvent=function(){r.enableRemain||r._clickLock||!r._hasActive||(r.clearOutEvent(),r.hide())},r._handleTooltipShow=function(t){var e=t.tooltipData;if(!t.isEmptyTooltip&&e&&e.length)if(W(r._spec.followTooltip)&&!1===r._spec.followTooltip[t.activeType])r._handleTooltipHideOrRelease();else{var i=r.calculateTriggerPoint(t),n=i.x,a=i.y;r.showDefault=!1,r._layoutCrosshair(n,a,e,t.activeType);var o=r._getNeedClearVRenderComponents();r._hasActive=o.some((function(t){return t&&!1!==t.attribute.visible}))}else r._handleTooltipHideOrRelease()},r._handleTooltipHideOrRelease=function(){r.clearOutEvent(),r.hide()},r.enable=!0,r.showDefault=!0,r}return M(i,e),Object.defineProperty(i.prototype,"enableRemain",{get:function(){return"none"===this.triggerOff},enumerable:!1,configurable:!0}),i.prototype._setAllAxisValues=function(t,e,i){var n=this,r=!1;if(t.forEach((function(t){$R(t.axis.getScale().type)&&(r?n.enable=!1:r=!0)})),!this.enable)return!1;var a=this._stateByField[i].currentValue;return t.forEach((function(t,i){var r=t.axis;a.set(i,{datum:n._getDatumAtPoint(r,e),axis:r})})),!0},i.prototype.clearAxisValue=function(){var t=this;Object.keys(this._stateByField).forEach((function(e){t._stateByField[e].currentValue.clear()}))},i.prototype.hideCrosshair=function(){this.clearAxisValue(),this.hide()},i.prototype.showCrosshair=function(t){var e=this;t&&t.length&&(this.showDefault=!1,this.clearAxisValue(),t.forEach((function(t){var i=t.axis,n=t.value;e.setAxisValue(n,i)})),this.layoutByValue(!1))},i.prototype._getLimitBounds=function(){var t,e;if(!this._limitBounds){var i=null!==(e=null===(t=this._option.globalInstance.getChart())||void 0===t?void 0:t.getViewRect())&&void 0!==e?e:{width:0,height:0},n=i.width,r=i.height;this._limitBounds={x1:0,y1:0,x2:n,y2:r}}return this._limitBounds},i.prototype._showDefaultCrosshairBySpec=function(){var t=this;Object.keys(this._stateByField).forEach((function(e){var i=t._spec[e];if(i&&i.visible&&i.defaultSelect){var n=i.defaultSelect,r=n.axisIndex,a=void 0===r?0:r,o=n.datum,s=t._option.getComponentsByKey("axes").find((function(t){return t.getSpecIndex()===a}));s&&(t._stateByField[e].currentValue.clear(),t._stateByField[e].currentValue.set(a,{axis:s,datum:o}))}}))},i.prototype._updateVisibleCrosshair=function(){var t=this,e=!1;Object.keys(this._stateByField).forEach((function(i){var n=t._spec[i];n&&n.visible&&t._stateByField[i].currentValue.size?e=!0:t._hideByField(i)})),e&&this.layoutByValue(!1)},i.prototype._showDefaultCrosshair=function(){this.showDefault?(this._showDefaultCrosshairBySpec(),this.layoutByValue(!1)):this._updateVisibleCrosshair()},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this._parseCrosshairSpec()},i.prototype.created=function(){e.prototype.created.call(this),this._initEvent()},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reMake||bt(i,t)||(n.reRender=!0,n.reMake=!0),n},i.prototype._initEvent=function(){var t=this;if(!this._option.disableTriggerEvent)if(this._spec.followTooltip)this._registerTooltipEvent();else{var e=this._getTriggerEvent();e&&e.forEach((function(e){t._registerEvent(e.in,!1,e.click),e.out&&t._registerEvent(e.out,!0)}))}},i.prototype._registerEvent=function(t,e,i){var n=this,r=e?this._handleOutEvent:i?this._handleClickInEvent:this._handleHoverInEvent,a=e?{level:gH.chart}:{source:vH.chart};q(t)?t.forEach((function(t){n.event.on(t,a,r)})):this.event.on(t,a,r)},i.prototype._eventOff=function(t,e,i){var n=this,r=e?this._handleOutEvent:i?this._handleClickInEvent:this._handleHoverInEvent;q(t)?t.forEach((function(t){n.event.off(t,r)})):this.event.off(t,r)},i.prototype.onBeforeRender=function(){this._limitBounds=null,this._showDefaultCrosshair()},i.prototype.calculateTriggerPoint=function(t){var e=t.event,i=this._option.getCompiler().getStage().getLayer(void 0),n={x:e.viewX,y:e.viewY};return i.globalTransMatrix.transformPoint({x:e.viewX,y:e.viewY},n),{x:n.x-this.getLayoutStartPoint().x,y:n.y-this.getLayoutStartPoint().y}},i.prototype._getTriggerEvent=function(){var e=this,i=this._option.mode,n=function(e){return e===t.RenderModeEnum["desktop-browser"]||e===t.RenderModeEnum["desktop-miniApp"]?{click:"pointertap",hover:"pointermove",hoverOut:"pointerleave",clickOut:"pointerleave"}:gx(e)||yx(e)?{click:"tap",hover:["pointerdown","pointermove"],hoverOut:"pointerleave",clickOut:"pointerleave"}:null}(void 0===i?t.RenderModeEnum["desktop-browser"]:i);if(n){var r=St(this.trigger||"hover");this._spec.lockAfterClick&&!r.includes("click")?(r.push("click"),this._onlyLockClick=!0):this._onlyLockClick=!1;var a=[];return r.forEach((function(t){var i;a.push({click:"click"===t,in:n[t],out:(i=t,"click"===i?"none"===e.triggerOff?null:n.clickOut:n.hoverOut)})})),a}return null},i.prototype._registerTooltipEvent=function(){this.event.on(t.ChartEvent.tooltipHide,{source:vH.chart},this._handleTooltipHideOrRelease),this.event.on(t.ChartEvent.tooltipShow,{source:vH.chart},this._handleTooltipShow),this.event.on(t.ChartEvent.tooltipRelease,{source:vH.chart},this._handleTooltipHideOrRelease)},i.prototype._getAxisInfoByField=function(t){var e,i,n=null===(i=(e=this._option).getComponentsByKey)||void 0===i?void 0:i.call(e,"axes");if(!(null==n?void 0:n.length))return null;var r=ut(this._spec,"".concat(t,"Field.bindingAxesIndex"));if(r||(r=[],n.forEach((function(e,i){u2[t].includes(e.getOrient())&&r.push(i)}))),!r.length)return null;var a=new Map,o=1/0,s=1/0,l=-1/0,u=-1/0,c=this.getLayoutStartPoint(),h=c.x,d=c.y;return r.forEach((function(t){o=1/0,s=1/0,l=-1/0,u=-1/0;var e=n.find((function(e){return e.getSpecIndex()===t}));e&&(e.getRegions().forEach((function(t){var e=t.getLayoutStartPoint(),i=e.x,n=e.y;o=Math.min(o,i-h),s=Math.min(s,n-d),l=Math.max(l,i+t.getLayoutRect().width-h),u=Math.max(u,n+t.getLayoutRect().height-d)})),a.set(t,{x1:o,y1:s,x2:l,y2:u,axis:e}))})),a},i.prototype.onLayoutEnd=function(){var t=this._regions[0];this.setLayoutRect(t.getLayoutRect()),this.setLayoutStartPosition(t.getLayoutStartPoint()),e.prototype.onLayoutEnd.call(this)},i.prototype._releaseEvent=function(){var t=this;this.clearOutEvent();var e=this._getTriggerEvent();e&&e.forEach((function(e){t._eventOff(e.in,!1,e.click),e.out&&t._eventOff(e.out,!0)}))},i.prototype._parseFieldInfo=function(){var t=this;Object.keys(this._stateByField).forEach((function(e){var i,n=t._spec[e],r=t._stateByField[e].crosshairComp;if(n&&n.visible){if(t._stateByField[e].attributes=t._parseField(n,e),r){var a=t._stateByField[e].attributes,o=a.style,s="rect"===a.type?"rectStyle":"lineStyle";r.setAttributes(((i={})[s]=o,i))}}else r&&r.parent&&r.parent.removeChild(r)}))},i.prototype._parseCrosshairSpec=function(){this._parseFieldInfo();var t=this._spec,e=t.trigger,i=t.triggerOff,n=t.labelZIndex,r=t.gridZIndex;e&&(this.trigger=e),("none"===i||Q(i)&&i>0)&&(this.triggerOff=i),void 0!==n&&(this.labelZIndex=n),void 0!==r&&(this.gridZIndex=r)},i.prototype._parseField=function(t,e){var i,n,r,a={},o=t.line,s=void 0===o?{}:o,l=t.label,u=void 0===l?{}:l,c=t.visible;if(a.visible=c,a.type=s.type||"line",!1===s.visible)a.style={visible:!1};else{var h=s.style||{},d=h,p=d.stroke,f=d.fill,v=d.lineWidth,g=h,y=g.strokeOpacity,m=g.fillOpacity,_=g.opacity,b=w(g,["strokeOpacity","fillOpacity","opacity"]),x="line"===a.type,k=x?y:m;if(Q(_)&&(k=(null!=k?k:1)*_),a.style=T({opacity:k,pickable:!1,visible:!0},b),x)a.style.stroke=p||f,a.style.lineWidth=ut(s,"width",v||2);else{a.style.fill=f||p,(null===(n=null===(i=null==t?void 0:t.line)||void 0===i?void 0:i.style)||void 0===n?void 0:n.stroke)&&(a.style.stroke=t.line.style.stroke);var S=ut(s,"width");if("string"==typeof S){var A=parseInt(S.substring(0,S.length-1),10)/100;a.style.sizePercent=A}else"number"!=typeof S&&"function"!=typeof S||(a.style.size=S)}}if(u.visible){var M=u.labelBackground||{},C=null!==(r=u.syncAxisLabelAngle)&&void 0!==r&&r,E=u.style||{},P=M.style||{},B=P.fill,R=void 0===B?"rgba(47, 59, 82, 0.9)":B,L=P.stroke,I=P.outerBorder,D=w(P,["fill","stroke","outerBorder"]);a.label={visible:!0,formatMethod:u.formatMethod,formatter:u.formatter,minWidth:M.minWidth,maxWidth:M.maxWidth,padding:M.padding,syncAxisLabelAngle:C,textStyle:T(T({fontSize:14,pickable:!1},E),{fill:E.fill||"#fff",stroke:ut(E,"stroke")}),panel:(N(M.visible)?M.visible:M)?T({visible:!0,pickable:!1,fill:R,stroke:L,outerBorder:T({stroke:R,distance:0,lineWidth:3},I)},D):{visible:!1},zIndex:this.labelZIndex,childrenPickable:!1,pickable:!1}}else a.label={visible:!1};return a},i.prototype._filterAxisByPoint=function(t,e,i){return t&&t.forEach((function(n){var r,a,o,s=n.axis;if(a=e,o=i,((r=n).x1>a||r.x2<a||r.y1>o||r.y2<o)&&t.delete(s.getSpecIndex()),s.type.startsWith("polarAxis")){var l=s.getCenter(),u=s.getInnerRadius(),c=s.getOuterRadius(),h=Oe.distancePP({x:e,y:i},l);(h>c||h<u)&&t.delete(s.getSpecIndex())}})),t},i.prototype._updateCrosshairLabel=function(t,e,i){var n=this.getContainer();t?t.setAttributes(e):(t=new tE(e),null==n||n.add(t),i(t)),function(t,e){var i=e.x1,n=e.y1,r=e.x2,a=e.y2,o=t.AABBBounds,s=o.x1,l=o.y1,u=o.x2,c=o.y2,h=t.attribute,d=h.dx,p=void 0===d?0:d,f=h.dy,v=void 0===f?0:f,g=0,y=0;s<i&&(g=i-s),l<n&&(y=n-l),u>r&&(g=r-u),c>a&&(y=a-c),g&&t.setAttribute("dx",g+p),y&&t.setAttribute("dy",y+v)}(t,this._getLimitBounds())},i.prototype.clearOutEvent=function(){this._timer&&(clearTimeout(this._timer),this._timer=null),this._clickLock&&(this._clickLock=null),this._hasActive&&(this._hasActive=null)},i.prototype._hideByField=function(t){var e=this._stateByField[t],i=e.crosshairComp,n=e.labelsComp;i&&i.hideAll(),n&&Object.keys(n).forEach((function(t){n[t]&&n[t].hideAll()}))},i.prototype.hide=function(){var t=this;Object.keys(this._stateByField).forEach((function(e){t._hideByField(e)}))},i.prototype._getNeedClearVRenderComponents=function(){var t=this;return Object.keys(this._stateByField).reduce((function(e,i){var n=t._stateByField[i],r=n.crosshairComp,a=n.labelsComp;return r&&e.push(r),a&&Object.keys(a).forEach((function(t){a[t]&&e.push(a[t])})),e}),[])},i.specKey="crosshair",i}(yU),h2={trigger:"hover",bandField:{visible:!1,line:{type:"rect",visible:!0,style:{fill:{type:"palette",key:"axisGridColor"},opacity:.7,lineWidth:0,stroke:{type:"palette",key:"markLineStrokeColor"},lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}},linearField:{visible:!1,line:{type:"line",visible:!0,style:{stroke:{type:"palette",key:"markLineStrokeColor"},fill:"transparent",opacity:.7,lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}}},d2=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=I.cartesianCrosshair,n.name=I.cartesianCrosshair,n._stateByField={xField:{coordKey:"x",anotherAxisKey:"y",currentValue:new Map,labelsComp:{top:null,bottom:null}},yField:{coordKey:"y",anotherAxisKey:"x",currentValue:new Map,labelsComp:{left:null,right:null}}},n}return M(e,t),e.getSpecInfo=function(t){return _V(t,this.specKey,this.type,(function(t){return t.xField&&!1!==t.xField.visible||t.yField&&!1!==t.yField.visible}))},e.prototype._findAllAxisContains=function(t,e){var i=this._getAxisInfoByField("x"),n=this._getAxisInfoByField("y");return{xAxisMap:this._filterAxisByPoint(i,t,e),yAxisMap:this._filterAxisByPoint(n,t,e)}},e.prototype._getDatumAtPoint=function(t,e){var i=uj(t.getOrient())?"x":"y",n=e[i]-(t.getLayoutStartPoint()[i]-this.getLayoutStartPoint()[i]);return t.getScale().invert(n)},e.prototype.setAxisValue=function(t,e){uj(e.getOrient())?this._stateByField.xField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e}):this._stateByField.yField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e})},e.prototype._layoutCrosshair=function(t,e,i,n){var r,a=t,o=e;if(i&&i.length)if("dimension"===n){var s=i[0],l=s.data.findIndex((function(t){return t.datum.length>0})),u=void 0;if(l>-1)u=(c=s.data[l]).series.dataToPosition(c.datum[0]);(U(s.dimType)?"y"===s.dimType:cj(null===(r=null==s?void 0:s.axis)||void 0===r?void 0:r.getOrient()))?o=null==u?void 0:u.y:a=null==u?void 0:u.x}else if("mark"===n){var c;a=null==(u=(c=i[0]).series.dataToPosition(c.datum[0]))?void 0:u.x,o=null==u?void 0:u.y}this.clearAxisValue();var h=this._findAllAxisContains(a,o),d=h.xAxisMap,p=h.yAxisMap;if(d&&0===d.size||p&&0===p.size){if(this.enableRemain)return;this.hide()}else d&&d.size&&this._setAllAxisValues(d,{x:a,y:o},"xField"),p&&p.size&&this._setAllAxisValues(p,{x:a,y:o},"yField"),this.layoutByValue()},e.prototype.layoutByValue=function(t){var e=this;if(this.enable){var i=sF(this._regions,"cartesian");i&&(FW(this._stateByField,i,this.getLayoutStartPoint(),null!=t?t:this.enableRemain),Object.keys(this._stateByField).forEach((function(t){e._layoutByField(t)})))}},e.prototype._layoutByField=function(t){var e=this,i=this._stateByField[t],n=i.cacheInfo,r=i.attributes,a=i.labelsComp,o=i.bandSize,s=i.coordKey;if(r&&n&&(!n._isCache||!this.enableRemain)){var l=n.coord,u=n.labels,c=n.visible,h=n.labelsTextStyle;if(c){var d=NW(this._stateByField[t]);this._updateCrosshairByField(t,d),Object.keys(u).forEach((function(i){var c,d,p,f;if(u[i].visible){var v=T(T(T(((c={})[s]=l+o/2,c),u[i]),r.label),{angle:r.label.syncAxisLabelAngle&&null!==(p=null===(d=n.axisLabel)||void 0===d?void 0:d.attribute.angle)&&void 0!==p?p:0,textStyle:T(T({},null===(f=r.label)||void 0===f?void 0:f.textStyle),h[i]),zIndex:e.labelZIndex,visible:!0});e._updateCrosshairLabel(a[i],v,(function(e){e.name="crosshair-".concat(t.replace("Field",""),"-").concat(i,"-label"),a[i]=e}))}else a[i]&&a[i].hideAll()}))}else this._hideByField(t)}},e.prototype._updateCrosshairByField=function(t,e){var i=this.getContainer(),n=this._stateByField[t].attributes,r=this._stateByField[t].crosshairComp;if(r)r.setAttributes(e);else{var a=n.style;"line"===n.type?r=new _E(T(T({},e),{lineStyle:a,zIndex:this.gridZIndex+1,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1})):"rect"===n.type&&(r=new bE(T(T({},e),{rectStyle:a,zIndex:this.gridZIndex,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1}))),null==i||i.add(r),this._stateByField[t].crosshairComp=r}},e.specKey="crosshair",e.builtInTheme={crosshair:h2},e.type=I.cartesianCrosshair,e}(c2),p2=function(){KF.registerComponent(d2.type,d2)},f2=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=I.polarCrosshair,n.name=I.polarCrosshair,n._stateByField={categoryField:{coordKey:"angle",anotherAxisKey:"radius",currentValue:new Map,labelsComp:{all:null}},valueField:{coordKey:"radius",anotherAxisKey:"angle",currentValue:new Map,labelsComp:{all:null}}},n}return M(e,t),e.getSpecInfo=function(t){return _V(t,this.specKey,this.type,(function(t){return t.categoryField&&!1!==t.categoryField.visible||t.valueField&&!1!==t.valueField.visible}))},e.prototype.setAxisValue=function(t,e){"radius"===e.getOrient()?this._stateByField.valueField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e}):this._stateByField.categoryField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e})},e.prototype._findAllAxisContains=function(t,e){var i=this._getAxisInfoByField("category"),n=this._getAxisInfoByField("value");return{angleAxisMap:this._filterAxisByPoint(i,t,e),radiusAxisMap:this._filterAxisByPoint(n,t,e)}},e.prototype._getDatumAtPoint=function(t,e){var i=t.getLayoutStartPoint(),n=i.x,r=i.y,a=this.getLayoutStartPoint(),o=a.x,s=a.y;return t.positionToData({x:e.x-(n-o),y:e.y-(r-s)})},e.prototype._layoutCrosshair=function(t,e,i,n){var r=t,a=e;if(i&&i.length)if("dimension"===n){var o=i[0];if(o.axis){var s=o.axis.pointToCoord({x:r,y:a}),l="radius"===o.axis.getOrient()?{radius:o.position,angle:s.angle}:{radius:s.radius,angle:o.position},u=o.axis.coordToPoint(l);r=u.x,a=u.y}}else if("mark"===n){var c=i[0],h=c.series.dataToPosition(c.datum[0]);r=h.x,a=h.y}this.clearAxisValue();var d=this._findAllAxisContains(r,a),p=d.angleAxisMap,f=d.radiusAxisMap;if(0!==p.size||0!==f.size)p&&this._setAllAxisValues(p,{x:r,y:a},"categoryField"),f&&this._setAllAxisValues(f,{x:r,y:a},"valueField"),this.layoutByValue();else{if(this.enableRemain)return;this.hide()}},e.prototype.layoutByValue=function(t){var e=this;if(this.enable){var i=sF(this._regions,"polar");i&&(!function(t,e,i){void 0===i&&(i=!1),Object.keys(t).forEach((function(n){var r=t[n],a=r.attributes,o=r.currentValue,s=r.cacheInfo,l=r.coordKey;if(a){var u=!!o.size,c=i&&!u&&U(s),h=c?s:{coord:0,axis:null,visible:u,coordRange:[0,0],sizeRange:[0,0],labels:{all:{visible:!1,text:"",offset:0}}};if(s&&(s._isCache=c),"valueField"===n&&(h.sides=e.angleAxisHelper.getScale(0).domain().length),o.forEach((function(t){var i,r=t.axis,o=t.datum,s=void 0===o?"":o,l=r.niceLabelFormatter;if((null===(i=a.label)||void 0===i?void 0:i.visible)&&(h.labels.all.visible=!0,h.labels.all.defaultFormatter=l,h.labels.all.text=s,h.labels.all.offset=Yj(r.getSpec())),"categoryField"===n){var u=e.angleAxisHelper.dataToPosition([s]),c=e.angleAxisHelper.getBandwidth(0),d=r.getOuterRadius();h.coord=u,h.coordRange=[u-c/2,u+c/2],h.sizeRange=[d,d]}else u=r.startAngle,d=e.radiusAxisHelper.dataToPosition([s]),h.coord=d,h.coordRange=[d,d],h.sizeRange=[u,u];h.axis=r})),h&&!c&&h.labels.all.visible&&a&&a.label){var d=h.labels.all,p=a.label,f=mV(p.formatMethod,p.formatter,d.text,{label:d.text,orient:l}),v=f.formatFunc,g=f.args;v?d.text=v.apply(void 0,R([],B(g),!1)):d.defaultFormatter&&(d.text=d.defaultFormatter(d.text))}t[n].cacheInfo=h}}))}(this._stateByField,i,null!=t?t:this.enableRemain),Object.keys(this._stateByField).forEach((function(t){e._layoutByField(t)})))}},e.prototype._layoutByField=function(t){var e,i,n,r=this._stateByField[t],a=r.cacheInfo,o=r.attributes,s=r.crosshairComp,l=r.labelsComp,u=r.coordKey;if(!(!a||a._isCache&&this.enableRemain)){var c=this.getContainer(),h=a.visible,d=a.labels,p=a.coord,f=a.sizeRange,v=a.axis;if(h){var g=this.getLayoutStartPoint(),y=null===(i=null===(e=this._spec.valueField)||void 0===e?void 0:e.line)||void 0===i?void 0:i.smooth,m=function(t,e,i){var n=t.cacheInfo,r=t.coordKey,a=t.attributes,o=n.axis,s=n.coord,l=n.sizeRange,u=n.coordRange,c=o.getCenter(),h={x:c.x+e.x,y:c.y+e.y};if("angle"===r)return"sector"==("rect"===a.type?"sector":"line")?{center:h,innerRadius:o.getInnerRadius(),radius:o.getOuterRadius(),startAngle:u[0],endAngle:u[1]}:{start:Ve(h,o.getInnerRadius(),s),end:Ve(h,o.getOuterRadius(),s)};var d=o.startAngle,p=o.endAngle,f=n.sides,v=s;if(!i){var g=o.getCenter(),y=o.coordToPoint({angle:l[0],radius:s}),m=Ue(g,y),_=(p-d)/f,b=Math.floor((m-d)/_),x=b*_+d,k=Math.min((b+1)*_+d,p),S=Ve(g,s,x),A=Ve(g,s,k),M=qe([A.x,A.y],[S.x,S.y],[g.x,g.y],[y.x,y.y]);M&&(v=Xt(Oe.distancePN(y,M[0],M[1])+s,o.getInnerRadius(),o.getOuterRadius()))}return{center:h,startAngle:d,endAngle:p,radius:v,sides:f}}(this._stateByField[t],g,y);if(s)s.setAttributes(m);else{var _,b;if("angle"===u)"line"===(b="rect"===o.type?"sector":"line")?_=new _E(T(T({},m),{lineStyle:o.style,zIndex:this.gridZIndex,pickable:!1})):"sector"===b&&(_=new kE(T(T({},m),{sectorStyle:o.style,zIndex:this.gridZIndex,pickable:!1})));else _="polygon"===(b=y?"circle":"polygon")?new SE(T(T({},m),{lineStyle:o.style,zIndex:this.gridZIndex+1})):new xE(T(T({},m),{lineStyle:o.style,zIndex:this.gridZIndex}));this._stateByField[t].crosshairComp=_,c.add(_)}var x=d.all;if(x.visible){var k=v.getCenter(),S={x:k.x+g.x,y:k.y+g.y},A="angle"===u?function(t){return{align:(t=We(t))>=Math.PI*(5/3)||t<=Math.PI*(1/3)?"left":t>=Math.PI*(2/3)&&t<=Math.PI*(4/3)?"right":"center",baseline:t>=Math.PI*(7/6)&&t<=Math.PI*(11/6)?"bottom":t>=Math.PI*(1/6)&&t<=Math.PI*(5/6)?"top":"middle"}}(p):function(t){return{align:(t=We(t))>=Math.PI*(7/6)&&t<=Math.PI*(11/6)?"right":t>=Math.PI*(1/6)&&t<=Math.PI*(5/6)?"left":"center",baseline:t>=Math.PI*(5/3)||t<=Math.PI*(1/3)?"bottom":t>=Math.PI*(2/3)&&t<=Math.PI*(4/3)?"top":"middle"}}(v.startAngle),M="angle"===u?Ve(S,f[1]+x.offset,p):Ve(S,m.radius,v.startAngle),w=T(T(T(T({},M),o.label),x),{textStyle:T(T({},null===(n=o.label)||void 0===n?void 0:n.textStyle),{textAlign:A.align,textBaseline:A.baseline}),zIndex:this.labelZIndex});this._updateCrosshairLabel(l.all,w,(function(t){t.name="crosshair-".concat(u,"-label"),l.all=t}))}else l.all&&l.all.hideAll()}}},e.specKey="crosshair",e.builtInTheme={crosshair:h2},e.type=I.polarCrosshair,e}(c2),v2=function(){KF.registerComponent(f2.type,f2)},g2=function(t,e){var i=e.getNewDomain,n=e.isContinuous,r=e.field,a=e.originalFields,o=r(),s=i();if(j(s)||j(o))return t;var l=a(),u=q(o)?o[0]:o;return t[u]&&l&&l[u]&&l[u].lockStatisticsByDomain&&!n()&&(t[u].values=s),t},y2=function(t,e){var i=e.getNewDomain,n=e.isContinuous,r=(0,e.field)(),a=i();if(j(a)||j(r))return t;if(0===a.length)return[];var o={};a.forEach((function(t){o[t]||(o[t]=1)}));var s=null;return s=n()?function(t){var e=!1;return St(r).every((function(i){t[i]>=a[0]&&t[i]<=At(a)&&(e=!0)})),e}:function(t){var e=!1;return St(r).every((function(i){(o[t[i]+""]||o[t[i]])&&(e=!0)})),e},t.filter(s)},m2=function(t,e){var i=e.input,n=i.stateFields,r=i.valueFields,a=i.dataCollection,o=i.isCategoryState,s=e.output,l=s.stateField,u=s.valueField,c={},h=[],d=[],p=!1;a.forEach((function(t,e){var i;if(!j(n[e])){var a=null===(i=t.getFields())||void 0===i?void 0:i[n[e]];a&&a.lockStatisticsByDomain&&(p=!0,a.domain.forEach((function(t){j(c[t])&&(d.push(t),c[t]=0)}))),t.latestData.forEach((function(t){St(n[e]).forEach((function(i){j(t[i])||(j(c[t[i]])&&(d.push(t[i]),c[t[i]]=0),j(r[e])||(c[t[i]]+=isNaN(parseFloat(t[r[e]]))?1:parseFloat(t[r[e]])))}))}))}}));var f=p?d:!1===o?d.sort((function(t,e){return t-e})):Object.keys(c);return f.forEach((function(t){var e,i=((e={})[l]=t,e);u&&(i[u]=c[t]),h.push(i)})),h},_2=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.layoutType="none",n._orient="left",n._cacheVisibility=void 0,n._dataUpdating=!1,n._shouldChange=!0,n._stateField="x",n._activeRoam=!0,n._zoomAttr={enable:!0,rate:1,focus:!0},n._dragAttr={enable:!0,rate:1,reverse:!0},n._scrollAttr={enable:!0,rate:1,reverse:!0},n.effect={onZoomChange:function(t){var e,i,r=n._relatedAxisComponent;if(r&&"axis"===n._filterMode){var a=r.getScale(),o=r.getSpec();n._auto&&n._getAxisBandSize(o)&&n._spec.ignoreBandSize&&(a.bandwidth("auto"),a.maxBandwidth("auto"),a.minBandwidth("auto")),n._updateRangeFactor(t),n._auto&&(null===(i=null===(e=n._component)||void 0===e?void 0:e.setStartAndEnd)||void 0===i||i.call(e,n._start,n._end)),r.effect.scaleUpdate({value:"force"})}else iF(n._regions,(function(t){var e;null===(e=t.getViewData())||void 0===e||e.markRunning()}),{userId:n._seriesUserId,specIndex:n._seriesIndex}),iF(n._regions,(function(t){t.reFilterViewData()}),{userId:n._seriesUserId,specIndex:n._seriesIndex})}},n._visible=!0,n._handleStateChange=function(t,e,i){var r,a;return n._startValue=t,n._endValue=e,n._newDomain=n._parseDomainFromState(n._startValue,n._endValue),null===(a=(r=n.effect).onZoomChange)||void 0===a||a.call(r,i),!0},n._handleChartZoom=function(t,e){var i,r;if(n._activeRoam&&(!n._zoomAttr.filter||n._zoomAttr.filter(t,e))){var a=t.zoomDelta,o=t.zoomX,s=t.zoomY,l=n._regions[0].getLayoutStartPoint(),u=l.x,c=l.y,h=n._regions[0].getLayoutRect(),d=h.width,p=h.height,f=Math.abs(n._start-n._end),v=null!==(r=null===(i=n._spec.roamZoom)||void 0===i?void 0:i.rate)&&void 0!==r?r:1;if(!(f>=1&&a<1||f<=.01&&a>1)){var g=n._isHorizontal?o:s,y=f*(a-1)*v,m=y/2,_=y/2;if(g){var b=n._isHorizontal?u:c,x=n._isHorizontal?d:p;m=Math.abs(b-g)/Math.abs(x-b)*y,_=Math.abs(x-g)/Math.abs(x-b)*y}var k=Xt(n._start+m,0,1),S=Xt(n._end-_,0,1);n._handleChange(Math.min(k,S),Math.max(k,S),!0)}}},n._handleChartScroll=function(t,e){var i;if(!n._activeRoam||n._scrollAttr.filter&&!n._scrollAttr.filter(t,e))return!1;var r=t.scrollX,a=t.scrollY,o=n._isHorizontal?r:a,s=n._isHorizontal?_e(r/a)>=.5:_e(a/r)>=.5;n._scrollAttr.reverse||(o=-o),s&&n._handleChartMove(o,null!==(i=n._scrollAttr.rate)&&void 0!==i?i:1);var l=0!==n._start&&1!==n._end;return s&&l},n._handleChartDrag=function(t,e){var i,r;if(n._activeRoam&&(!n._dragAttr.filter||n._dragAttr.filter(t,e))){(null===(i=n._spec.roamDrag)||void 0===i?void 0:i.autoVisible)&&n.show();var a=B(t,2),o=a[0],s=a[1],l=n._isHorizontal?o:s;n._dragAttr.reverse&&(l=-l),n._handleChartMove(l,null!==(r=n._dragAttr.rate)&&void 0!==r?r:1)}},n._handleChartMove=function(t,e){var i=n._isHorizontal?n.getLayoutRect().width:n.getLayoutRect().height;if(Math.abs(t)>=1e-6)if(t>0&&n._end<1){var r=Math.min(1-n._end,t/i)*e;n._handleChange(n._start+r,n._end+r,!0)}else if(t<0&&n._start>0){r=Math.max(-n._start,t/i)*e;n._handleChange(n._start+r,n._end+r,!0)}return!1},n._orient=dj(t),n._isHorizontal="horizontal"===pj(n._orient),n}return M(i,e),Object.defineProperty(i.prototype,"relatedAxisComponent",{get:function(){return this._relatedAxisComponent},enumerable:!1,configurable:!0}),i.prototype.setStartAndEnd=function(t,e,i){void 0===i&&(i=["percent","percent"]);var n=B(i,2),r=n[0],a=void 0===r?"percent":r,o=n[1],s=void 0===o?"percent":o,l="percent"===a?t:this.dataToStatePoint(t),u="percent"===s?e:this.dataToStatePoint(e);this._handleChange(l,u,!0)},i.prototype.enableInteraction=function(){this._activeRoam=!0},i.prototype.disableInteraction=function(){this._activeRoam=!1},i.prototype.zoomIn=function(t){this._handleChartZoom({zoomDelta:1.2,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})},i.prototype.zoomOut=function(t){this._handleChartZoom({zoomDelta:.8,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})},i.prototype._handleChange=function(t,e,i){var n,r;null!==(r=null===(n=this._spec)||void 0===n?void 0:n.zoomLock)&&void 0!==r&&r||e-t!==this._spanCache&&(e-t<this._minSpan||e-t>this._maxSpan)?this._shouldChange=!1:(this._shouldChange=!0,this._spanCache=e-t)},i.prototype._isReverse=function(){var t=this._relatedAxisComponent;if(!t)return!1;var e=t.getScale();return e.range()[0]>e.range()[1]&&(!t.getInverse()||this._isHorizontal)},i.prototype._updateRangeFactor=function(t){var e=this._relatedAxisComponent,i=e.getScale(),n=this._isReverse(),r=n?[1-this._end,1-this._start]:[this._start,this._end];if(n)switch(t){case"startHandler":e.scaleRangeFactorEnd(r[1]);break;case"endHandler":e.scaleRangeFactorStart(r[0]);break;default:e.scaleRangeFactorStart(r[0],!0),e.scaleRangeFactorEnd(r[1])}else switch(t){case"startHandler":e.scaleRangeFactorStart(r[0]);break;case"endHandler":e.scaleRangeFactorEnd(r[1]);break;default:e.scaleRangeFactorEnd(r[1],!0),e.scaleRangeFactorStart(r[0])}var a=i.rangeFactor();a?(this._start=n?1-a[1]:a[0],this._end=n?1-a[0]:a[1]):(this._start=0,this._end=1)},Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),i.prototype.created=function(){e.prototype.created.call(this),this._setAxisFromSpec(),this._setRegionsFromSpec(),this._initEvent(),this._initData(),this._initStateScale(),this._setStateFromSpec()},i.prototype.initLayout=function(){e.prototype.initLayout.call(this),this._layout&&(this._layout.layoutOrient=this._orient)},i.prototype._setAxisFromSpec=function(){var t=this;if(U(this._spec.axisId)?this._relatedAxisComponent=this._option.getComponentByUserId(this._spec.axisId):U(this._spec.axisIndex)&&(this._relatedAxisComponent=this._option.getComponentByIndex("axes",this._spec.axisIndex)),j(this._spec.field)&&!this._relatedAxisComponent){var e=this._option.getComponentsByKey("axes"),i=e.find((function(e){return e._orient===t._orient}));if(i)this._relatedAxisComponent=i;else{var n=e.find((function(t){return!JR(t.getScale().type)}));this._relatedAxisComponent=n}}this._relatedAxisComponent&&"axis"===this._filterMode&&(this._relatedAxisComponent.autoIndentOnce=!0)},i.prototype._setRegionsFromSpec=function(){var t,e;this._regions=this._relatedAxisComponent?this._relatedAxisComponent.getRegions():this._option.getAllRegions();var i=this._relatedAxisComponent?null===(e=(t=this._relatedAxisComponent).getBindSeriesFilter)||void 0===e?void 0:e.call(t):null;if(U(i)&&(U(i.userId)&&(this._seriesUserId=St(i.userId)),U(i.specIndex)&&(this._seriesIndex=St(i.specIndex))),U(this._spec.seriesId)){var n=St(this._spec.seriesId);this._seriesUserId?this._seriesUserId=this._seriesUserId.filter((function(t){return n.includes(t)})):this._seriesUserId=n}if(U(this._spec.seriesIndex)){var r=St(this._spec.seriesIndex);this._seriesIndex?this._seriesIndex=this._seriesIndex.filter((function(t){return r.includes(t)})):this._seriesIndex=r}if(U(this._spec.regionIndex)){var a=this._option.getRegionsInIndex(St(this._spec.regionIndex));this._regions=this._regions.filter((function(t){return a.includes(t)}))}else if(U(this._spec.regionId)){var o=St(this._spec.regionId);this._regions=o.length?this._regions.filter((function(t){return o.includes(t.id)})):[]}else;},i.prototype.onDataUpdate=function(){var t,e=this._computeDomainOfStateScale(JR(this._stateScale.type));this._stateScale.domain(e,!1),this._handleChange(this._start,this._end,!0),this._spec.auto&&!bt(this._domainCache,e)&&(this._domainCache=e,this._dataUpdating=!0,null===(t=this.getChart())||void 0===t||t.setLayoutTag(!0,null,!1))},i.prototype._computeDomainOfStateScale=function(t){var e=this;if(this._spec.customDomain)return this._spec.customDomain;var i=this._data.getLatestData().map((function(t){return t[e._stateField]}));if(t){var n=i.map((function(t){return 1*t}));return i.length?[Tt(n),Mt(n)]:[-1/0,1/0]}return i},i.prototype._initEvent=function(){this._initCommonEvent()},i.prototype._initData=function(){var t,e=this,i=[],n=[],r=[];if(this._relatedAxisComponent){var a={};iF(this._regions,(function(o){var s,l,u="cartesian"===o.coordinate?o.getXAxisHelper():"polar"===o.coordinate?o.angleAxisHelper:null,c="cartesian"===o.coordinate?o.getYAxisHelper():"polar"===o.coordinate?o.radiusAxisHelper:null;if(u&&c){var h=u.getAxisId()===e._relatedAxisComponent.id?u:c.getAxisId()===e._relatedAxisComponent.id?c:e._isHorizontal?u:c,d=h===u?c:u;i.push(o.getRawData());var p=o.getSpec(),f="cartesian"===o.coordinate?St(p.xField):St(null!==(s=p.angleField)&&void 0!==s?s:p.categoryField),v="cartesian"===o.coordinate?St(p.yField):St(null!==(l=p.radiusField)&&void 0!==l?l:p.valueField);if(a[o.id]="link"===o.type?["from_xField"]:h===u?f:v,JR(h.getScale(0).type)?(t=!1,n.push(a[o.id])):n.push(a[o.id][0]),e._valueField){var g="link"===o.type?["from_yField"]:d===u?f:v;JR(d.getScale(0).type)&&r.push.apply(r,R([],B(g),!1))}}}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._originalStateFields=a}else iF(this._regions,(function(t){i.push(t.getRawData()),n.push(e._field),e._valueField&&r.push(e._spec.valueField)}),{userId:this._seriesUserId,specIndex:this._seriesIndex});var o=this._option.dataSet;SH(o,"dataview",ss),kH(o,"dataFilterComputeDomain",m2);var s=new hs(o,{name:"".concat(this.type,"_").concat(this.id,"_data")});s.transform({type:"dataFilterComputeDomain",options:{input:{dataCollection:i,stateFields:n,valueFields:r,isCategoryState:t},output:{stateField:this._stateField,valueField:this._valueField}}},!1),this._data=new wN(this._option,s),s.reRunAllTransform(),o.multipleDataViewAddListener(i,"change",this._handleDataCollectionChange.bind(this))},i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),!0===this._spec.roamZoom||this._spec.roamZoom?this._zoomAttr=gt({},this._zoomAttr,this._spec.roamZoom):this._zoomAttr.enable=!1,!0===this._spec.roamDrag||this._spec.roamDrag?this._dragAttr=gt({},this._dragAttr,this._spec.roamDrag):this._dragAttr.enable=!1,!0===this._spec.roamScroll||this._spec.roamScroll?this._scrollAttr=gt({},this._scrollAttr,this._spec.roamScroll):this._scrollAttr.enable=!1,this._field=this._spec.field,this._width=this._computeWidth(),this._height=this._computeHeight(),this._visible=null===(t=this._spec.visible)||void 0===t||t},i.prototype.statePointToData=function(t){var e=this._stateScale,i=e.domain();if(JR(e.type))return this._isReverse()?i[0]+(At(i)-i[0])*(1-t):i[0]+(At(i)-i[0])*t;var n=e.range();this._isReverse()&&(n=n.slice().reverse());var r=n[0]+(At(n)-n[0])*t;return e.invert(r)},i.prototype.dataToStatePoint=function(t){var e=this._stateScale,i=e.scale(t),n=e.range();return!this._isHorizontal&&JR(e.type)&&(n=n.slice().reverse()),(i-n[0])/(At(n)-n[0])},i.prototype._modeCheck=function(t,e){return"start"===t?"percent"===e&&U(this._spec.start)||"value"===e&&U(this._spec.startValue):"percent"===e&&U(this._spec.end)||"value"===e&&U(this._spec.endValue)},i.prototype._setStateFromSpec=function(){var t,e,i,n;if(this._auto=!!this._spec.auto,this._spec.rangeMode){var r=B(this._spec.rangeMode,2),a=r[0],o=r[1];this._modeCheck("start",a)&&this._modeCheck("end",o)&&(i="percent"===a?this._spec.start:this.dataToStatePoint(this._spec.startValue),n="percent"===o?this._spec.end:this.dataToStatePoint(this._spec.endValue))}else i=this._spec.start?this._spec.start:this._spec.startValue?this.dataToStatePoint(this._spec.startValue):0,n=this._spec.end?this._spec.end:this._spec.endValue?this.dataToStatePoint(this._spec.endValue):1;this._startValue=this.statePointToData(i),this._endValue=this.statePointToData(n),this._start=i,this._end=n,this._minSpan=null!==(t=this._spec.minSpan)&&void 0!==t?t:0,this._maxSpan=null!==(e=this._spec.maxSpan)&&void 0!==e?e:1,JR(this._stateScale.type)&&this._stateScale.domain()[0]!==At(this._stateScale.domain())&&(this._spec.minValueSpan&&(this._minSpan=this._spec.minValueSpan/(At(this._stateScale.domain())-this._stateScale.domain()[0])),this._spec.maxValueSpan&&(this._maxSpan=this._spec.maxValueSpan/(At(this._stateScale.domain())-this._stateScale.domain()[0]))),this._minSpan=Math.max(0,this._minSpan),this._maxSpan=Math.min(this._maxSpan,1),this._relatedAxisComponent&&"axis"===this._filterMode||0===this._start&&1===this._end||(this._newDomain=this._parseDomainFromState(this._startValue,this._endValue))},i.prototype._parseFieldOfSeries=function(t){var e;return null===(e=this._originalStateFields)||void 0===e?void 0:e[t.id]},i.prototype._initStateScale=function(){var t=[0,1];if(this._relatedAxisComponent){var e=this._relatedAxisComponent.getScale(),i=JR(e.type),n=this._computeDomainOfStateScale(i);if(this._stateScale=e.clone(),i){var r=n.map((function(t){return 1*t}));this._stateScale.domain(n.length?[Tt(r),Mt(r)]:[0,1],!0).range(t)}else this._stateScale.domain(n,!0).range(t)}else this._stateScale=new kL,this._stateScale.domain(this._computeDomainOfStateScale(),!0).range(t)},i.prototype.init=function(t){e.prototype.init.call(this,t),this._addTransformToSeries(),0===this._start&&1===this._end||this.effect.onZoomChange()},i.prototype._addTransformToSeries=function(){var e=this;this._relatedAxisComponent&&"axis"===this._filterMode||(kH(this._option.dataSet,"dataFilterWithNewDomain",y2),kH(this._option.dataSet,"lockStatisticsFilter",g2),iF(this._regions,(function(i){i.getViewDataStatistics().transform({type:"lockStatisticsFilter",options:{originalFields:function(){return i.getViewDataStatistics().getFields()},getNewDomain:function(){return e._newDomain},field:function(){var t;return null!==(t=e._field)&&void 0!==t?t:e._parseFieldOfSeries(i)},isContinuous:function(){return JR(e._stateScale.type)}},level:1},!1),i.addViewDataFilter({type:"dataFilterWithNewDomain",options:{getNewDomain:function(){return e._newDomain},field:function(){var t;return null!==(t=e._field)&&void 0!==t?t:e._parseFieldOfSeries(i)},isContinuous:function(){return JR(e._stateScale.type)}},level:t.TransformLevel.dataZoomFilter})}),{userId:this._seriesUserId,specIndex:this._seriesIndex}))},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reMake||bt(i,t)||(n.reRender=!0,n.reMake=!0),n},i.prototype.reInit=function(t){var i=this;e.prototype.reInit.call(this,t),this._marks.forEach((function(t){t.getMarks().forEach((function(t){i.initMarkStyleWithSpec(t,i._spec[t.name])}))}))},i.prototype._parseDomainFromState=function(t,e){if(JR(this._stateScale.type))return[Math.min(e,t),Math.max(e,t)];var i=this._stateScale.domain(),n=i.indexOf(t),r=i.indexOf(e);return i.slice(Math.min(n,r),Math.max(n,r)+1)},i.prototype._initCommonEvent=function(){var t,e,i,n,r,a,o,s,l=this,u={delayType:null!==(e=null===(t=this._spec)||void 0===t?void 0:t.delayType)&&void 0!==e?e:"throttle",delayTime:U(null===(i=this._spec)||void 0===i?void 0:i.delayType)?null!==(r=null===(n=this._spec)||void 0===n?void 0:n.delayTime)&&void 0!==r?r:30:0,realTime:null===(o=null===(a=this._spec)||void 0===a?void 0:a.realTime)||void 0===o||o,allowComponentZoom:!0};if(this._zoomAttr.enable&&this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom,u),this._scrollAttr.enable&&this.initScrollEventOfRegions(this._regions,null,this._handleChartScroll,u),this._dragAttr.enable&&this.initDragEventOfRegions(this._regions,null,this._handleChartDrag,u),null===(s=this._spec.roamDrag)||void 0===s?void 0:s.autoVisible){this._throttledHide=Qt((function(){return l.hide()}),300),this.event.on("panend",(function(){l._throttledHide()}))}},i.prototype.updateLayoutAttribute=function(){this._visible&&this._createOrUpdateComponent(),e.prototype.updateLayoutAttribute.call(this)},i.prototype._autoVisible=function(e){var i,n;if(this._auto){e?this.show():this.hide();var r=this._isHorizontal?"height":"width";this.layout.setLayoutRect(((i={})[r]=e?this["_".concat(r)]:0,i),((n={})[r]=t.AttributeLevel.Built_In,n))}},i.prototype.onLayoutStart=function(t,i){e.prototype.onLayoutStart.call(this,t,i);var n=this._autoUpdate(t);this._autoVisible(n),this._dataUpdating=!1},i.prototype.onLayoutEnd=function(){var t=!(0===this._start&&1===this._end);this._autoVisible(t),e.prototype.onLayoutEnd.call(this)},i.prototype.getBoundsInRect=function(t){var e={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0};return this._isHorizontal?(e.y2=e.y1+this._height,e.x2=e.x1+t.width):(e.x2=e.x1+this._width,e.y2=e.y1+t.height),e},i.prototype.hide=function(){var t;null===(t=this._component)||void 0===t||t.hideAll()},i.prototype.show=function(){var t;null===(t=this._component)||void 0===t||t.showAll()},i.prototype._getAxisBandSize=function(t){var e=null==t?void 0:t.bandSize,i=null==t?void 0:t.maxBandSize,n=null==t?void 0:t.minBandSize;if(e||n||i)return{bandSize:e,maxBandSize:i,minBandSize:n}},i.prototype._autoUpdate=function(t){var e,i,n,r,a,o;if(!this._auto)return this._cacheVisibility=void 0,!0;var s=this._relatedAxisComponent,l=null==s?void 0:s.getSpec(),u=null==s?void 0:s.getScale(),c=this._getAxisBandSize(l);if(!this._dataUpdating&&$R(u.type)&&(null==t?void 0:t.height)===(null===(e=this._cacheRect)||void 0===e?void 0:e.height)&&(null==t?void 0:t.width)===(null===(i=this._cacheRect)||void 0===i?void 0:i.width)&&this._fixedBandSize===(null==c?void 0:c.bandSize))return this._cacheVisibility;var h=!0;if(this._isHorizontal&&(null==t?void 0:t.width)!==(null===(n=this._cacheRect)||void 0===n?void 0:n.width)?u.range(s.getInverse()?[t.width,0]:[0,t.width]):(null==t?void 0:t.height)!==(null===(r=this._cacheRect)||void 0===r?void 0:r.height)&&u.range(s.getInverse()?[0,t.height]:[t.height,0]),this._cacheRect={width:null==t?void 0:t.width,height:null==t?void 0:t.height},this._fixedBandSize=null==c?void 0:c.bandSize,$R(u.type)){c&&(this._start||this._end)&&(this.type===I.scrollBar&&(this._start=0,this._end=1),this._updateRangeFactor());var d=B(null!==(a=u.rangeFactor())&&void 0!==a?a:[],2),p=d[0],f=d[1];h=(!j(p)||!j(f))&&!(0===p&&1===f)}else{var v=B(null!==(o=u.rangeFactor())&&void 0!==o?o:[this._start,this._end],2);p=v[0],f=v[1];h=!(0===p&&1===f)}return this.setStartAndEnd(this._start,this._end),this._cacheVisibility=h,h},i.prototype._getNeedClearVRenderComponents=function(){return[this._component]},i.prototype.clear=function(){this._throttledHide=null},i}(yU);kt(_2,cY);var b2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._mergeThemeToSpec=function(t,e){var i=this,n=this._theme,r=t;if(this._shouldMergeThemeToSpec()){var a=function(t){var e=XF({selectedBackgroundChart:{line:{},area:{}}},i._theme,t),n=t.selectedBackgroundChart,r=void 0===n?{}:n,a=r.line,o=r.area;return a&&!1!==a.visible&&(e.selectedBackgroundChart.line.style=T(T({},e.selectedBackgroundChart.line.style),{visible:!0})),o&&!1!==o.visible&&(e.selectedBackgroundChart.area.style=T(T({},e.selectedBackgroundChart.area.style),{visible:!0})),e},o=t;r=q(o)?o.map((function(t){return a(t)})):a(o)}return this._adjustPadding(r),{spec:r,theme:n}},e}(gU),x2=function(t){return{area:{style:{visible:t,stroke:!1,fill:{type:"palette",key:"dataZoomChartColor"}}},line:{style:{visible:t,stroke:{type:"palette",key:"dataZoomChartColor"},lineWidth:1}}}},k2={padding:[12,0],showDetail:"auto",brushSelect:!1,middleHandler:{visible:!1,background:{size:6,style:{stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},cornerRadius:2}},icon:{style:{size:4,fill:{type:"palette",key:"sliderHandleColor"},stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}}},background:{size:20,style:{fill:{type:"palette",key:"sliderRailColor"},lineWidth:0}},selectedBackground:{style:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.1,outerBorder:{stroke:{type:"palette",key:"sliderTrackColor"},strokeOpacity:.2,distance:-.5,lineWidth:1}}},selectedBackgroundChart:x2(!1),startHandler:{style:{symbolType:"M-0.5-2.4h0.9c0.4,0,0.7,0.3,0.7,0.7v3.3c0,0.4-0.3,0.7-0.7,0.7h-0.9c-0.4,0-0.7-0.3-0.7-0.7v-3.3\nC-1.2-2-0.9-2.4-0.5-2.4z M-0.4-1.4L-0.4-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC-0.4-1.4-0.4-1.4-0.4-1.4z M0.3-1.4L0.3-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC0.3-1.4,0.3-1.4,0.3-1.4z;",fill:{type:"palette",key:"sliderHandleColor"},scaleX:1.2,scaleY:1.2,stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},lineWidth:1}},endHandler:{style:{symbolType:"M-0.5-2.4h0.9c0.4,0,0.7,0.3,0.7,0.7v3.3c0,0.4-0.3,0.7-0.7,0.7h-0.9c-0.4,0-0.7-0.3-0.7-0.7v-3.3\nC-1.2-2-0.9-2.4-0.5-2.4z M-0.4-1.4L-0.4-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC-0.4-1.4-0.4-1.4-0.4-1.4z M0.3-1.4L0.3-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC0.3-1.4,0.3-1.4,0.3-1.4z;",fill:{type:"palette",key:"sliderHandleColor"},scaleX:1.2,scaleY:1.2,stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},lineWidth:1}},startText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},endText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},backgroundChart:x2(!0)},S2=function(e){function i(i,n){var r,a=this;return(a=e.call(this,i,n)||this).type=I.dataZoom,a.name=I.dataZoom,a.transformerConstructor=b2,a.specKey="dataZoom",a.layoutZIndex=t.LayoutZIndex.DataZoom,a.layoutLevel=t.LayoutLevel.DataZoom,a.layoutType="region-relative",a._isReverseCache=!1,a._dataToPositionX=function(t){var e="left"===a._orient?a._middleHandlerSize:0,i=a._isHorizontal?a._startHandlerSize/2:0,n=a._isHorizontal?a._stateScale:a._valueScale,r=a._isHorizontal?a._stateField:a._valueField;return n.scale(t[r])+a.getLayoutStartPoint().x+e+i},a._dataToPositionX2=function(t){var e="left"===a._orient?a._middleHandlerSize:0,i=a._isHorizontal?a._startHandlerSize/2:0,n=a._isHorizontal?a._stateScale:a._valueScale,r=n.domain()[0];return n.scale(r)+a.getLayoutStartPoint().x+e+i},a._dataToPositionY=function(t){var e=a._isHorizontal?a._middleHandlerSize:0,i=a._isHorizontal?0:a._startHandlerSize/2,n=a._isHorizontal?a._valueScale:a._stateScale,r=a._isHorizontal?a._valueField:a._stateField;return n.scale(t[r])+a.getLayoutStartPoint().y+e+i},a._dataToPositionY2=function(t){var e=a._isHorizontal?a._middleHandlerSize:0,i=a._isHorizontal?0:a._startHandlerSize/2,n=a._isHorizontal?a._valueScale:a._stateScale,r=n.domain()[0];return n.scale(r)+a.getLayoutStartPoint().y+e+i},a._valueField="y",a._filterMode=null!==(r=i.filterMode)&&void 0!==r?r:"filter",a}return M(i,e),i.prototype.created=function(){e.prototype.created.call(this),this._initValueScale()},i.prototype.setAttrFromSpec=function(){var t,i,n,r,a,o,s,l,u,c;e.prototype.setAttrFromSpec.call(this),N(this._spec.roam)&&(this._zoomAttr.enable=this._spec.roam,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.event,this._option.mode),this._backgroundSize=null!==(i=null===(t=this._spec.background)||void 0===t?void 0:t.size)&&void 0!==i?i:30,this._middleHandlerSize=this._computeMiddleHandlerSize(),this._width=this._computeWidth(),this._height=this._computeHeight(),j(null===(a=null===(r=null===(n=this._spec)||void 0===n?void 0:n.startHandler)||void 0===r?void 0:r.style)||void 0===a?void 0:a.size)&&(this._spec.startHandler.style.size=this._isHorizontal?this._height-this._middleHandlerSize:this._width-this._middleHandlerSize),j(null===(l=null===(s=null===(o=this._spec)||void 0===o?void 0:o.endHandler)||void 0===s?void 0:s.style)||void 0===l?void 0:l.size)&&(this._spec.endHandler.style.size=this._isHorizontal?this._height-this._middleHandlerSize:this._width-this._middleHandlerSize);var h=null===(u=this._spec.startHandler.style.visible)||void 0===u||u,d=null===(c=this._spec.endHandler.style.visible)||void 0===c||c;this._startHandlerSize=h?this._spec.startHandler.style.size:0,this._endHandlerSize=d?this._spec.endHandler.style.size:0},i.prototype.onLayoutEnd=function(){this._updateScaleRange(),this._isReverse()&&!this._isReverseCache&&(this._isReverseCache=this._isReverse(),this.effect.onZoomChange()),!1!==this._cacheVisibility&&e.prototype.onLayoutEnd.call(this)},i.prototype._initValueScale=function(){var t=this._computeDomainOfValueScale();if(t){var e=new UL;e.domain(t),this._valueScale=e}},i.prototype._updateScaleRange=function(){var t,e,i=this._startHandlerSize+this._endHandlerSize;if(this._stateScale&&this._valueScale){var n,r=this._isHorizontal?this.getLayoutRect().width-i:this.getLayoutRect().height-i,a=null!==(e=null===(t=this._relatedAxisComponent)||void 0===t?void 0:t.getScale().range())&&void 0!==e?e:[this._startHandlerSize/2,r+this._startHandlerSize/2],o=this._computeWidth(),s=this._computeHeight();this._isHorizontal?(n=this._visible?[this._startHandlerSize/2,o-i+this._startHandlerSize/2]:a,this._stateScale.range(n),this._valueScale.range([s-this._middleHandlerSize,0])):(n=this._visible?[this._startHandlerSize/2,s-i+this._startHandlerSize/2]:a,this._stateScale.range(n),"left"===this.layoutOrient?this._valueScale.range([o-this._middleHandlerSize,0]):this._valueScale.range([0,o-this._middleHandlerSize])),this._component&&!1!==this._cacheVisibility&&this._component.setAttributes({size:{width:o,height:s},position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y}})}},i.prototype._computeDomainOfValueScale=function(){var t=this,e=this._data.getLatestData().map((function(e){return e[t._valueField]})),i=e.map((function(t){return 1*t}));return e.length?[Tt(i),Mt(i)]:null},i.prototype._computeMiddleHandlerSize=function(){var t,e,i,n,r=0;if(null===(e=null===(t=this._spec)||void 0===t?void 0:t.middleHandler)||void 0===e?void 0:e.visible){var a=null!==(i=this._spec.middleHandler.icon.style.size)&&void 0!==i?i:8,o=null!==(n=this._spec.middleHandler.background.size)&&void 0!==n?n:40;r+=Math.max(a,o)}return r},i.prototype._computeWidth=function(){return!1===this._visible?0:Q(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:this._backgroundSize+this._middleHandlerSize},i.prototype._computeHeight=function(){return!1===this._visible?0:Q(this._spec.height)?this._spec.height:this._isHorizontal?this._backgroundSize+this._middleHandlerSize:this.getLayoutRect().height},i.prototype._isScaleValid=function(t){if(!t||!t.domain())return!1;var e,i=t.domain();return(!JR(t.type)||i[0]!==At(i))&&(!$R(t.type)||1!==(e=i,e&&q(e)?Array.from(new Set(St(e))):e).length)},i.prototype._getAttrs=function(t){var e,i,n,r,a,o=null!==(e=this._spec)&&void 0!==e?e:{};return T({zIndex:this.layoutZIndex,start:this._start,end:this._end,position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y},orient:this._orient,size:{width:this._computeWidth(),height:this._computeHeight()},showDetail:o.showDetail,brushSelect:null!==(i=o.brushSelect)&&void 0!==i&&i,zoomLock:null!==(n=o.zoomLock)&&void 0!==n&&n,minSpan:this._minSpan,maxSpan:this._maxSpan,delayType:o.delayType,delayTime:U(o.delayType)?null!==(r=o.delayTime)&&void 0!==r?r:30:0,realTime:null===(a=o.realTime)||void 0===a||a,previewData:t&&this._data.getLatestData(),previewPointsX:t&&this._dataToPositionX,previewPointsY:t&&this._dataToPositionY,tolerance:this._spec.tolerance},this._getComponentAttrs(t))},i.prototype._createOrUpdateComponent=function(){var t=this;if(this._visible){var e=this._isHorizontal?this._stateScale:this._valueScale,i=this._isHorizontal?this._valueScale:this._stateScale,n=this._isScaleValid(e)&&this._isScaleValid(i)&&!1!==this._spec.showBackgroundChart,r=this._getAttrs(n);if(this._component)this._component.setAttributes(r);else{var a=this.getContainer();this._component=new dD(r),this._isHorizontal?n&&this._component.setPreviewPointsY1(this._dataToPositionY2):n&&this._component.setPreviewPointsX1(this._dataToPositionX2),this._component.setStatePointToData((function(e){return t.statePointToData(e)})),this._component.addEventListener("change",(function(e){var i=e.detail,n=i.start,r=i.end,a=i.tag;t._handleChange(n,r,void 0,a)})),a.add(this._component),this._updateScaleRange()}}},i.prototype._handleChange=function(i,n,r,a){if(e.prototype._handleChange.call(this,i,n,r),this._shouldChange){r&&this._component&&this._component.setStartAndEnd(i,n),this._start=i,this._end=n;var o=this.statePointToData(i),s=this.statePointToData(n);(V(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(i,n,o,s):this._handleStateChange(o,s,a))&&this.event.emit(t.ChartEvent.dataZoomChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:i,end:n,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}},i.prototype._handleDataCollectionChange=function(){var t,e=this._data.getDataView();if(e.reRunAllTransform(),null===(t=this._component)||void 0===t||t.setPreviewData(e.latestData),this._valueScale){var i=this._computeDomainOfValueScale();i&&this._valueScale.domain(i)}},i.prototype._getComponentAttrs=function(t){var e,i,n,r,a,o,s,l,u,c,h,d=this._spec,p=d.middleHandler,f=void 0===p?{}:p,v=d.startText,g=void 0===v?{}:v,y=d.endText,m=void 0===y?{}:y,_=d.backgroundChart,b=void 0===_?{}:_,x=d.selectedBackgroundChart,k=void 0===x?{}:x;return{backgroundStyle:sH(null===(e=this._spec.background)||void 0===e?void 0:e.style),startHandlerStyle:sH(null===(i=this._spec.startHandler)||void 0===i?void 0:i.style),middleHandlerStyle:f.visible?{visible:!0,icon:sH(null===(n=f.icon)||void 0===n?void 0:n.style),background:{size:null===(r=f.background)||void 0===r?void 0:r.size,style:sH(null===(a=f.background)||void 0===a?void 0:a.style)}}:{visible:!1},endHandlerStyle:sH(null===(o=this._spec.endHandler)||void 0===o?void 0:o.style),startTextStyle:{padding:g.padding,formatMethod:this._getHandlerTextFormatMethod(g),textStyle:sH(g.style)},endTextStyle:{padding:m.padding,formatMethod:this._getHandlerTextFormatMethod(m),textStyle:sH(m.style)},selectedBackgroundStyle:sH(this._spec.selectedBackground.style),dragMaskStyle:sH(null===(s=this._spec.dragMask)||void 0===s?void 0:s.style),backgroundChartStyle:t?{line:XF(sH(null===(l=b.line)||void 0===l?void 0:l.style),{fill:!1}),area:T({curveType:"basis",visible:!0},sH(null===(u=b.area)||void 0===u?void 0:u.style))}:{line:{visible:!1},area:{visible:!1}},selectedBackgroundChartStyle:t?{line:XF(sH(null===(c=k.line)||void 0===c?void 0:c.style),{fill:!1}),area:T({curveType:"basis",visible:!0},sH(null===(h=k.area)||void 0===h?void 0:h.style))}:{line:{visible:!1},area:{visible:!1}},disableTriggerEvent:this._option.disableTriggerEvent}},i.prototype._getHandlerTextFormatMethod=function(t){var e=t.formatMethod,i=t.formatter,n=mV(e,i).formatFunc;return n?function(t){return n(t,{label:t},i)}:void 0},i.prototype._getNeedClearVRenderComponents=function(){return[this._component]},i.prototype.clear=function(){if(this._component){var t=this.getContainer();this._component.removeAllChild(),t&&t.removeChild(this._component),this._component=null}e.prototype.clear.call(this)},i.type=I.dataZoom,i.transformerConstructor=b2,i.builtInTheme={dataZoom:k2},i.specKey="dataZoom",i}(_2),A2=function(){KF.registerComponent(S2.type,S2)},M2={horizontal:{height:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}},vertical:{width:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}}},T2=function(e){function i(i,n){var r,a=this;return(a=e.call(this,i,n)||this).type=I.scrollBar,a.name=I.scrollBar,a.specKey="scrollBar",a.layoutZIndex=t.LayoutZIndex.DataZoom,a.layoutLevel=t.LayoutLevel.DataZoom,a.layoutType="region-relative",a._filterMode=null!==(r=i.filterMode)&&void 0!==r?r:"axis",a}return M(i,e),i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),N(this._spec.roam)&&(this._zoomAttr.enable=!1,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.event,this._option.mode)},i.prototype.onLayoutEnd=function(){var t,i;this._updateScaleRange(),null===(i=(t=this.effect).onZoomChange)||void 0===i||i.call(t),e.prototype.onLayoutEnd.call(this)},i.prototype._updateScaleRange=function(){this._component&&this._component.setAttributes({x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height})},i.prototype._computeWidth=function(){return Q(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:12},i.prototype._computeHeight=function(){return Q(this._spec.height)?this._spec.height:this._isHorizontal?12:this.getLayoutRect().height},i.prototype._getAttrs=function(){var t,e,i,n,r,a;return T({zIndex:this.layoutZIndex,x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height,range:[this._start,this._end],direction:this._isHorizontal?"horizontal":"vertical",delayType:null===(t=this._spec)||void 0===t?void 0:t.delayType,delayTime:U(null===(e=this._spec)||void 0===e?void 0:e.delayType)?null!==(n=null===(i=this._spec)||void 0===i?void 0:i.delayTime)&&void 0!==n?n:30:0,realTime:null===(a=null===(r=this._spec)||void 0===r?void 0:r.realTime)||void 0===a||a},this._getComponentAttrs())},i.prototype._createOrUpdateComponent=function(){var t=this,e=this._getAttrs();if(this._component)this._component.setAttributes(e);else{var i=this.getContainer();this._component=new AC(e),this._component.addEventListener("scrollDrag",(function(e){var i=e.detail.value;t._handleChange(i[0],i[1])})),this._component.addEventListener("scrollUp",(function(e){var i=e.detail.value;t._handleChange(i[0],i[1])})),i.add(this._component)}},i.prototype._handleChange=function(i,n,r){e.prototype._handleChange.call(this,i,n,r);var a=XO(this._start,i)&&XO(this._end,n);if(this._shouldChange&&(!a||!1===this._spec.realTime)){r&&this._component&&this._component.setAttribute("range",[i,n]),this._start=i,this._end=n;var o=this.statePointToData(i),s=this.statePointToData(n);(V(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(i,n,o,s):this._handleStateChange(this.statePointToData(i),this.statePointToData(n)))&&this.event.emit(t.ChartEvent.scrollBarChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:this._start,end:this._end,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}},i.prototype._handleDataCollectionChange=function(){this._spec.auto&&this._data.getDataView().reRunAllTransform()},i.prototype._getComponentAttrs=function(){var t=this._spec,e=t.rail,i=t.slider,n=t.innerPadding,r={};return j(n)||(r.padding=n),lt(null==e?void 0:e.style)||(r.railStyle=sH(e.style)),lt(null==i?void 0:i.style)||(r.sliderStyle=sH(i.style)),r.disableTriggerEvent=this._option.disableTriggerEvent,r},i.prototype._getNeedClearVRenderComponents=function(){return[this._component]},i.type=I.scrollBar,i.builtInTheme={scrollBar:M2},i.specKey="scrollBar",i}(_2),w2=function(){KF.registerComponent(T2.type,T2)},C2=function(t,e){var i=e.datum,n=e.title,r=e.content,a=[],o=i.call(null);return n.visible&&a.push({type:"title",index:0,datum:o,spec:n}),St(r).forEach((function(t,e){t.visible&&a.push({type:"content",index:e,datum:o,spec:t})})),a},E2=function(t,e){return{fontSize:{type:"token",key:t},fill:{type:"palette",key:e},fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}},P2={title:{visible:!0,autoLimit:!1,autoFit:!1,style:E2("l1FontSize","primaryFontColor")},content:{visible:!0,style:E2("l2FontSize","tertiaryFontColor")}},B2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=I.indicator,i.name=I.indicator,i.specKey="indicator",i.layoutType="none",i.layoutZIndex=t.LayoutZIndex.Indicator,i.layoutLevel=t.LayoutLevel.Indicator,i._gap=0,i._activeDatum=null,i}return M(i,e),i.getSpecInfo=function(t){return _V(t,this.specKey,this.type,(function(t){return t&&!1!==t.visible}))},i.prototype.created=function(){e.prototype.created.call(this),this.initData(),this.initEvent()},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this._gap=this._spec.gap||0,this._title=this._spec.title,this._content=St(this._spec.content),this._regions=this._option.getRegionsInUserIdOrIndex(St(this._spec.regionId),St(this._spec.regionIndex))},i.prototype.initEvent=function(){var t=this;this._option.disableTriggerEvent||"none"!==this._spec.trigger&&("hover"===this._spec.trigger?(this.event.on("element-highlight:start",(function(e){var i=e.graphics[0];t.isRelativeModel(i)&&t.updateDatum(cH(i))})),this.event.on("element-highlight:reset",(function(e){t._activeDatum&&t.updateDatum(null)}))):(this.event.on("element-select:start",(function(e){var i=e.graphics[0];t.isRelativeModel(i)&&t.updateDatum(cH(i))})),this.event.on("element-select:reset",(function(e){t._activeDatum&&t.updateDatum(null)}))))},i.prototype.updateDatum=function(t){this._activeDatum=t,this._displayData.updateData();var e=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(e)},i.prototype.initData=function(){var t=this;kH(this._option.dataSet,"indicatorFilter",C2);var e=new hs(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});e.transform({type:"indicatorFilter",options:{title:this._title,content:this._content,datum:function(){return t._activeDatum}}}),e.target.addListener("change",this.updateDatum.bind(this)),this._displayData=new wN(this._option,e)},i.prototype.updateLayoutAttribute=function(){var t=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(t),e.prototype.updateLayoutAttribute.call(this)},i.prototype._getIndicatorAttrs=function(){var t=this;if(!1===this._spec.visible||!1===this._spec.fixed&&null===this._activeDatum)return{visible:!1};var e=this._regions[0],i=e.getLayoutRect(),n=i.width,r=i.height,a=e.getLayoutStartPoint(),o=a.x,s=a.y,l=this._spec,u=l.content,c=l.offsetX,h=l.offsetY,d=l.limitRatio,p=l.title,f=w(l,["content","offsetX","offsetY","limitRatio","title"]),v=[];return St(u).forEach((function(e){var i=XF({},t._theme.content,e);v.push({visible:!1!==i.visible&&(!i.field||null!==t._activeDatum),space:i.space||t._gap,autoLimit:i.autoLimit,autoFit:i.autoFit,fitPercent:i.fitPercent,fitStrategy:i.fitStrategy,style:T(T({},oH(yt(i.style,["text"]),t._activeDatum)),{text:t._createText(i.field,i.style.text)})})})),T({visible:!0,size:{width:n,height:r},zIndex:this.layoutZIndex,x:o,y:s,dx:c?OF(c,this._computeLayoutRadius()):0,dy:h?OF(h,this._computeLayoutRadius()):0,limitRatio:d||1/0,title:{visible:!1!==p.visible&&(!U(p.field)||null!==this._activeDatum),space:p.space||this._gap,autoLimit:p.autoLimit,autoFit:p.autoFit,fitPercent:p.fitPercent,fitStrategy:p.fitStrategy,style:T(T({},oH(yt(p.style,["text"]),this._activeDatum)),{text:this._createText(p.field,p.style.text)})},content:v},f)},i.prototype._createOrUpdateIndicatorComponent=function(t){var e=this;if(!1===t.visible)return this._indicatorComponent&&this._indicatorComponent.parent&&this._indicatorComponent.parent.removeChild(this._indicatorComponent),void(this._indicatorComponent=null);if(this._indicatorComponent)bt(t,this._cacheAttrs)||this._indicatorComponent.setAttributes(t);else{var i=this.getContainer(),n=new SO(t);n.name="indicator",i.add(n),this._indicatorComponent=n,this._indicatorComponent.on("*",(function(t,i){return e._delegateEvent(e._indicatorComponent,t,i)}))}this._cacheAttrs=t},i.prototype._createText=function(t,e){var i;return t?this._activeDatum?this._activeDatum[t]:"":V(e)?null!==(i=e(this._activeDatum,void 0))&&void 0!==i?i:"":null!=e?e:""},i.prototype._computeLayoutRadius=function(){var t=this._regions[0].getLayoutRect(),e=t.width,i=t.height;return Math.min(e/2,i/2)},i.prototype.isRelativeModel=function(t){return this._regions.some((function(e){return!!e.getSeriesInId(t.context.modelId)}))},i.prototype._getNeedClearVRenderComponents=function(){return[this._indicatorComponent]},i.prototype.clear=function(){this._cacheAttrs=null,e.prototype.clear.call(this)},i.prototype.getIndicatorComponent=function(){return this._indicatorComponent},i.type=I.indicator,i.builtInTheme={indicator:P2},i.specKey="indicator",i}(yU),R2=function(){KF.registerComponent(B2.type,B2)},L2=["sum","average","min","max","variance","standardDeviation","median"];function I2(t,e,i){if(!i)return!1;var n=t.map((function(t){return 1*t})),r=Tt(n),a=Mt(n);return e<r||e>a}function D2(t,e,i,n,r,a){var o,s,l=n.relativeSeries;return Q(t.x)&&I2(e,t.x,i)&&(null===(s=null==l?void 0:(o=l.getXAxisHelper()).setExtendDomain)||void 0===s||s.call(o,"marker_xAxis_extend",t.x)),EF(t.x)?H2(t.x,r)+a.x:N2(l.getXAxisHelper(),[t.x])+a.x}function O2(t,e,i,n,r,a){var o,s,l=n.relativeSeries;return Q(t.y)&&I2(e,t.y,i)&&(null===(s=null===(o=l.getYAxisHelper())||void 0===o?void 0:o.setExtendDomain)||void 0===s||s.call(o,"marker_yAxis_extend",t.y)),EF(t.y)?H2(t.y,r)+a.y:N2(l.getYAxisHelper(),[t.y])+a.y}function F2(t,e,i,n){var r,a,o=n.relativeSeries;return Q(t.angle)&&I2(e,t.angle,i)&&(null===(a=null===(r=o.angleAxisHelper)||void 0===r?void 0:r.setExtendDomain)||void 0===a||a.call(r,"marker_angleAxis_extend",t.angle)),N2(o.angleAxisHelper,[t.angle])}function z2(t,e,i,n){var r,a,o=n.relativeSeries;return Q(t.radius)&&I2(e,t.radius,i)&&(null===(a=null===(r=o.radiusAxisHelper)||void 0===r?void 0:r.setExtendDomain)||void 0===a||a.call(r,"marker_radiusAxis_extend",t.radius)),N2(o.radiusAxisHelper,[t.radius])}function H2(t,e){return Number(t.substring(0,t.length-1))*e/100}function N2(t,e){var i=t.getScale(0);return JR(i.type)&&i.domain()[0]===i.domain()[1]&&e[0]!==i.domain()[0]?NaN:t.dataToPosition(e)}function V2(t){return L2.includes(t)}function j2(t,e,i,n,r){var a=e.getRegion(),o=a.getLayoutStartPoint(),s=i.getRegion(),l=s.getLayoutStartPoint(),u=Math.abs(Math.min(o.x,l.x)-Math.max(o.x+a.getLayoutRect().width,l.x+s.getLayoutRect().width)),c=Math.abs(Math.min(o.y,l.y)-Math.max(o.y+a.getLayoutRect().height,l.y+s.getLayoutRect().height)),h={relativeSeries:n,startRelativeSeries:e,endRelativeSeries:i},d=[],p=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,f=n.getXAxisHelper().getScale(0).domain(),v=n.getYAxisHelper().getScale(0).domain();return p.forEach((function(t){var e=U(t.x),i=U(t.y);if(e&&i){var n=D2(t,f,r,h,u,o),p=O2(t,v,r,h,c,o);d.push([{x:n,y:p}])}else if(e){n=D2(t,f,r,h,u,o),p=Math.max(o.y+a.getLayoutRect().height,l.y+s.getLayoutRect().height);var g=Math.min(o.y,l.y);d.push([{x:n,y:p},{x:n,y:g}])}else if(i){n=Math.min(o.x,l.x),p=O2(t,v,r,h,c,o);var y=Math.max(o.x+a.getLayoutRect().width,l.x+s.getLayoutRect().width);d.push([{x:n,y:p},{x:y,y:p}])}})),d}function U2(t,e,i,n,r){var a={relativeSeries:n,startRelativeSeries:e,endRelativeSeries:i},o=[],s=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,l=n.angleAxisHelper.getScale(0).domain(),u=n.radiusAxisHelper.getScale(0).domain(),c=Math.min(n.getRegion().getLayoutRect().width/2,n.getRegion().getLayoutRect().height/2);return s.forEach((function(t){var e=U(t.angle),i=U(t.radius);if(e&&i){var n=F2(t,l,r,a),s=z2(t,u,r,a);o.push([{angle:n,radius:s}])}else if(e){n=F2(t,l,r,a);o.push([{angle:n,radius:-c},{angle:n,radius:c}])}else if(i){s=z2(t,u,r,a);o.push([{radius:s,angle:0},{radius:s,angle:2*Math.PI}])}})),o}function W2(t,e,i,n){var r=[],a=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,o=q(n);return a.forEach((function(t,a){var s,l,u,c,h=(null==t?void 0:t.getRefRelativeSeries)?t.getRefRelativeSeries():e,d=h.getRegion(),p=d.getLayoutStartPoint(),f=d.getLayoutRect(),v=f.width,g=f.height,y=0,m=0;if(n){var _=o?n[a]:n,b=_.x,x=_.y;b&&(y=EF(b)?Number(b.substring(0,b.length-1))*v/100:b),x&&(m=EF(x)?Number(x.substring(0,x.length-1))*g/100:x)}var k=h.getXAxisHelper().getScale(0).domain(),S=h.getYAxisHelper().getScale(0).domain(),A=St(t.x),M=St(t.y);1===A.length&&Q(A[0])&&I2(k,A[0],i)&&(null===(l=null===(s=h.getXAxisHelper())||void 0===s?void 0:s.setExtendDomain)||void 0===l||l.call(s,"marker_xAxis_extend",A[0])),1===M.length&&Q(M[0])&&I2(S,M[0],i)&&(null===(c=null===(u=h.getYAxisHelper())||void 0===u?void 0:u.setExtendDomain)||void 0===c||c.call(u,"marker_yAxis_extend",M[0])),r.push({x:N2(h.getXAxisHelper(),A)+p.x+y,y:N2(h.getYAxisHelper(),M)+p.y+m})})),r}function G2(t,e,i){var n=[];return(t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData).forEach((function(t){var r,a,o,s,l=(null==t?void 0:t.getRefRelativeSeries)?t.getRefRelativeSeries():e,u=l.angleAxisHelper.getScale(0).domain(),c=l.radiusAxisHelper.getScale(0).domain(),h=St(t.angle),d=St(t.radius);1===h.length&&Q(h[0])&&I2(u,h[0],i)&&(null===(a=null===(r=l.angleAxisHelper)||void 0===r?void 0:r.setExtendDomain)||void 0===a||a.call(r,"marker_xAxis_extend",h[0])),1===d.length&&Q(d[0])&&I2(c,d[0],i)&&(null===(s=null===(o=l.radiusAxisHelper)||void 0===o?void 0:o.setExtendDomain)||void 0===s||s.call(o,"marker_yAxis_extend",d[0])),n.push({angle:N2(l.angleAxisHelper,h),radius:N2(l.radiusAxisHelper,d)})})),n}function Y2(t,e,i){var n=t.x,r=t.y;return EF(n)&&(n=H2(n,e)),EF(r)&&(r=H2(r,i)),{x:n,y:r}}function X2(t,e,i){var n;if(n=V(t)?St(t(e.getData().getLatestData(),e)):St(t),i){var r=e.getRegion(),a=r.getLayoutStartPoint(),o=a.x,s=a.y,l=r.getLayoutRect(),u=l.width,c=l.height;return n.map((function(t){var e=Y2(t,u,c),i=e.x,n=e.y;return{x:i+=o,y:n+=s}}))}var h=e.getOption().getChart().getViewRect(),d=h.width,p=h.height;return n.map((function(t){return Y2(t,d,p)}))}function K2(t){var e=1/0,i=-1/0,n=1/0,r=-1/0;return t.forEach((function(t){var a=t.getLayoutStartPoint(),o=t.getLayoutRect();a.x<e&&(e=a.x),a.x+o.width>i&&(i=a.x+o.width),a.y<n&&(n=a.y),a.y+o.height>r&&(r=a.y+o.height)})),{minX:e,maxX:i,minY:n,maxY:r}}function q2(t,e,i){var n=t.labelBackground,r=void 0===n?{}:n,a=t.style,o=t.shape,s=w(t,["labelBackground","style","shape"]);if(!1!==t.visible){var l=s;return(null==o?void 0:o.visible)?l.shape=T({visible:!0},sH(o.style)):l.shape={visible:!1},!1!==r.visible?(l.panel=T({visible:!0,customShape:r.customShape},J2(sH(r.style),e,i)),U(r.padding)&&(l.padding=Di(r.padding))):(l.panel={visible:!1},l.padding=0),a&&(l.textStyle=J2(sH(a),e,i)),l}return{visible:!1}}function Z2(t,e,i){for(var n in t)V(t[n])&&(t[n]=t[n](e,i));return t}function J2(t,e,i){return V(t)?t(e,i):t}function Q2(t,e){return V(t)?t(e):t}function $2(t,e,i){return U(t)?"regionLeft"===e?i.getLayoutStartPoint().x-t.x:"regionRight"===e?i.getLayoutStartPoint().x+i.getLayoutRect().width-t.x:"regionTop"===e?i.getLayoutStartPoint().y-t.y:"regionBottom"===e?i.getLayoutStartPoint().y+i.getLayoutRect().height-t.y:e:e}function t3(t){return{isXProcess:U(t.x),isYProcess:U(t.y),isX1Process:U(t.x1),isY1Process:U(t.y1),isAngleProcess:U(t.angle),isRadiusProcess:U(t.radius),isAngle1Process:U(t.angle1),isRadius1Process:U(t.radius1),isCoordinatesProcess:U(t.coordinates),isValidProcess:U(t.process)}}function e3(t){var e=t3(t),i=e.isXProcess,n=e.isYProcess,r=e.isX1Process,a=e.isY1Process,o=e.isAngleProcess,s=e.isRadiusProcess,l=e.isAngle1Process,u=e.isRadius1Process,c=e.isCoordinatesProcess,h=e.isValidProcess;return{doXProcess:i&&!n&&!a,doXYY1Process:i&&n&&a,doYProcess:n&&!i&&!r,doYXX1Process:n&&i&&r,doXYProcess:i&&n&&r&&a,doAngleProcess:o&&!l&&!s&&!u,doRadiusProcess:s&&!u&&!o&&!l,doAngRadRad1Process:o&&!l&&s&&u,doRadAngAng1Process:s&&o&&l&&!u,doRadAngProcess:o&&s&&l&&u,doCoordinatesProcess:c&&(!h||"process"in t&&"xy"in t.process)}}function i3(t){var e=t3(t),i=e.isXProcess,n=e.isYProcess,r=e.isX1Process,a=e.isY1Process,o=e.isAngleProcess,s=e.isRadiusProcess,l=e.isAngle1Process,u=e.isRadius1Process;return{doXProcess:i&&r&&!n&&!a,doYProcess:n&&a&&!i&&!r,doXYProcess:i&&r&&n&&a,doAngleProcess:o&&l&&!s&&!u,doRadiusProcess:s&&u&&!o&&!l,doRadAngProcess:o&&s&&l&&u,doCoordinatesProcess:e.isCoordinatesProcess}}function n3(t){return{doXYProcess:U(t.x)&&U(t.y),doPolarProcess:U(t.angle)&&U(t.radius),doGeoProcess:U(t.areaName)}}function r3(t,e){var i;if(e.coordinates){var n,r=e,a=r.coordinates,o=r.coordinateType,s=r.getSeriesByIdOrIndex,l=w(r,["coordinates","coordinateType","getSeriesByIdOrIndex"]),u=void 0;if(V(a)){var c=e.getRelativeSeries();u=a(c.getData().getLatestData(),c)}else u=a;i=(u=St(u)).map((function(t){var e=s(t.refRelativeSeriesId,t.refRelativeSeriesIndex);if("cartesian"===o){var i=e.getSpec(),r=i.xField,a=i.yField,u=t.xFieldDim,c=t.xFieldIndex,h=t.yFieldDim,d=t.yFieldIndex,p=r;U(c)&&(p=St(r)[c]),u&&St(r).includes(u)&&(p=u);var f=a;U(d)&&(f=St(a)[d]),h&&St(a).includes(h)&&(f=h),n=T({x:void 0,y:void 0},l),K(t[p])&&V2(t[p])?n.x={field:p,aggrType:t[p]}:n.x=St(p).map((function(e){return t[e]})),K(t[f])&&V2(t[f])?n.y={field:f,aggrType:t[f]}:n.y=St(f).map((function(e){return t[e]}))}else if("polar"===o){var v=e.getSpec(),g=v.valueField,y=v.categoryField,m=t.angleFieldDim,_=t.angleFieldIndex,b=y;U(_)&&(b=St(y)[_]),m&&St(y).includes(m)&&(b=m);var x=g;n=T({angle:void 0,radius:void 0},l),K(t[b])&&V2(t[b])?n.angle={field:b,aggrType:t[b]}:n.angle=St(b).map((function(e){return t[e]})),K(t[x])&&V2(t[x])?n.radius={field:x,aggrType:t[x]}:n.radius=St(x).map((function(e){return t[e]}))}return n.getRefRelativeSeries=function(){return e},n}))}else i=e;var h=[];return i.forEach((function(e){var i={x:null,y:null,angle:null,radius:null,areaName:null};if(U(e.x)){var n=e.x;q(n)?i.x=n.map((function(i){return o3(i,t,e)})):i.x=o3(n,t,e)}if(U(e.y)){var r=e.y;q(r)?i.y=r.map((function(i){return o3(i,t,e)})):i.y=o3(r,t,e)}if(U(e.angle)){var a=e.angle;q(a)?i.angle=a.map((function(i){return o3(i,t,e)})):i.angle=o3(a,t,e)}if(U(e.radius)){var o=e.radius;q(o)?i.radius=o.map((function(i){return o3(i,t,e)})):i.radius=o3(o,t,e)}if(U(e.areaName)){var s=e.areaName;i.areaName=o3(s,t,e)}e.getRefRelativeSeries&&(i.getRefRelativeSeries=e.getRefRelativeSeries),h.push(i)})),h}var a3={min:function(t,e){return KO(t[0].latestData,e.field)},max:function(t,e){return qO(t[0].latestData,e.field)},sum:function(t,e){return ZO(t[0].latestData,e.field)},average:function(t,e){return JO(t[0].latestData,e.field)},variance:function(t,e){return QO(t[0].latestData,e.field)},standardDeviation:function(t,e){return function(t,e){return Math.sqrt(QO(t,e))}(t[0].latestData,e.field)},median:function(t,e){return function(t,e){return Nt(t.map((function(t){return t[e]})))}(t[0].latestData,e.field)}};function o3(t,e,i){var n=i.getRelativeSeries(),r=i.getStartRelativeSeries(),a=i.getEndRelativeSeries(),o=n.getData().getLatestData(),s=r.getData().getLatestData(),l=a.getData().getLatestData();if(V(t))return t(o,s,l,n,r,a);if(Y(t)){var u=t,c=u.aggrType,h=u.field;return a3[c](e,{field:h})}return t}function s3(t,e){if(e&&e.getRelativeSeries){var i=e.getRelativeSeries();if(i){var n=i.getViewData();return n&&n.latestData&&n.latestData.length?t:[]}}return t}var l3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layoutType="none",e._layoutOffsetX=0,e._layoutOffsetY=0,e}return M(e,t),e.prototype.getRelativeSeries=function(){return this._relativeSeries},e.prototype.getMarkerData=function(){return this._markerData},e._getMarkerCoordinateType=function(t){return"cartesian"},e.getSpecInfo=function(t){var e=this;return _V(t,this.specKey,this.type,(function(t){return!1!==t.visible&&e._getMarkerCoordinateType(t)===e.coordinateType}))},e.prototype.getMarkAttributeContext=function(){return this._markAttributeContext},e.prototype._buildMarkerAttributeContext=function(){this._markAttributeContext={relativeSeries:this._relativeSeries,startRelativeSeries:this._startRelativeSeries,endRelativeSeries:this._endRelativeSeries,vchart:this._option.globalInstance}},e.prototype.created=function(){t.prototype.created.call(this),this._bindSeries(),this._initDataView(),this.initEvent(),this._buildMarkerAttributeContext()},e.prototype._getAllRelativeSeries=function(){var t=this;return{getRelativeSeries:function(){return t._relativeSeries},getStartRelativeSeries:function(){return t._startRelativeSeries},getEndRelativeSeries:function(){return t._endRelativeSeries}}},e.prototype._getFieldInfoFromSpec=function(t,e,i){return K(e)&&V2(e)?{field:i.getSpec()[{x:"xField",y:"yField",radius:"valueField",angle:"categoryField",areaName:"nameField"}[t]],aggrType:e}:e},e.prototype._processSpecByDims=function(t){var e=this,i=this._relativeSeries,n={};return t.forEach((function(t){return n[t.dim]=e._getFieldInfoFromSpec(t.dim,t.specValue,i)})),T(T({},n),this._getAllRelativeSeries())},e.prototype._processSpecCoo=function(t){var e=this;return T(T({coordinates:t.coordinates||t.coordinate},this._getAllRelativeSeries()),{getSeriesByIdOrIndex:function(t,i){return e._getSeriesByIdOrIndex(t,i)},coordinateType:this.coordinateType})},e.prototype._getRelativeDataView=function(){if(this._specifiedDataSeries){var t=[];St(this._specifiedDataSeries).forEach((function(e){t=t.concat(e.getViewData().latestData)}));var e=new cs;return e.registerParser("array",D),new hs(e).parse(t,{type:"array"})}return this._relativeSeries.getViewData()},e.prototype.updateLayoutAttribute=function(){var e,i,n,r=this;if(null===(e=this._spec.visible)||void 0===e||e){if(!this._markerComponent){var a=this._createMarkerComponent();a.name=null!==(i=this._spec.name)&&void 0!==i?i:this.type,a.id=null!==(n=this._spec.id)&&void 0!==n?n:"".concat(this.type,"-").concat(this.id),this._markerComponent=a,this.getContainer().add(this._markerComponent),this._markerComponent.on("*",(function(t,e){r._delegateEvent(r._markerComponent,t,e,null,r.getMarkerData.bind(r))}))}this._markerLayout()}t.prototype.updateLayoutAttribute.call(this)},e.prototype._getSeriesByIdOrIndex=function(t,e){var i,n,r;return(r=null===(i=this._option.getSeriesInUserIdOrIndex(U(t)?[t]:[],[e]))||void 0===i?void 0:i[0])||(r=null!==(n=this._relativeSeries)&&void 0!==n?n:this._getFirstSeries()),r},e.prototype._bindSeries=function(){var t=this._spec;this._relativeSeries=this._getSeriesByIdOrIndex(t.relativeSeriesId,t.relativeSeriesIndex),this._startRelativeSeries=this._getSeriesByIdOrIndex(t.startRelativeSeriesId,t.startRelativeSeriesIndex),this._endRelativeSeries=this._getSeriesByIdOrIndex(t.endRelativeSeriesId,t.endRelativeSeriesIndex),t.specifiedDataSeriesIndex&&"all"===t.specifiedDataSeriesIndex||t.specifiedDataSeriesId&&"all"===t.specifiedDataSeriesId?this._specifiedDataSeries=this._option.getAllSeries():(t.specifiedDataSeriesIndex||t.specifiedDataSeriesId)&&(this._specifiedDataSeries=this._getSeriesByIdOrIndex(t.specifiedDataSeriesId,t.specifiedDataSeriesIndex))},e.prototype.initEvent=function(){"cartesian"!==this._relativeSeries.coordinate&&(this._relativeSeries.event.on("zoom",this._markerLayout.bind(this)),this._relativeSeries.event.on("panmove",this._markerLayout.bind(this)),this._relativeSeries.event.on("scroll",this._markerLayout.bind(this)))},e.prototype.clear=function(){t.prototype.clear.call(this),this._firstSeries=null},e.prototype._getFirstSeries=function(){var t;if(this._firstSeries)return this._firstSeries;var e=sF(this._regions);return e?(this._firstSeries=e,e):(null===(t=this._option)||void 0===t||t.onError("need at least one series"),null)},e.prototype._getNeedClearVRenderComponents=function(){return[this._markerComponent]},e.prototype.onLayoutStart=function(e,i){j(this._spec.offsetX)||(this._layoutOffsetX=BF(this._spec.offsetX,i.width,i)),j(this._spec.offsetY)||(this._layoutOffsetY=BF(this._spec.offsetY,i.height,i)),t.prototype.onLayoutStart.call(this,e,i)},e.prototype._compareSpec=function(e,i){var n=t.prototype._compareSpec.call(this,e,i);return bt(i,e)||(n.reRender=!0,n.reMake=!0,n.change=!0),n},e.prototype._initCommonDataView=function(){var t=this,e=this._computeOptions().options,i=this._getRelativeDataView();kH(this._option.dataSet,"markerAggregation",r3),kH(this._option.dataSet,"markerFilter",s3);var n=new hs(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});n.parse([i],{type:"dataview"}),n.transform({type:"markerAggregation",options:e}),n.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),n.target.on("change",(function(){t._markerLayout()})),this._markerData=n},e}(yU);function u3(t,e){return function(t,e,i){var n,r,a=pe(t,(function(t){return t[e]}),(function(t){return t[i]})).predict,o=KO(t,e),s=qO(t,e),l=a(o),u=a(s);return[(n={},n[e]=o,n[i]=l,n),(r={},r[e]=s,r[i]=u,r)]}(t[0].latestData,e.fieldX,e.fieldY)}var c3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.specKey="markLine",i.layoutZIndex=t.LayoutZIndex.MarkLine,i}return M(i,e),i._getMarkerCoordinateType=function(t){var e=e3(t),i=e.doAngleProcess,n=e.doRadiusProcess,r=e.doAngRadRad1Process,a=e.doRadAngAng1Process,o=e.doRadAngProcess;return"polar"===t.coordinateType||i||n||r||a||o?"polar":"cartesian"},i.prototype._createMarkerComponent=function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p=this,f=this._spec,v=f.startSymbol,g=void 0===v?{}:v,y=f.endSymbol,m=void 0===y?{}:y,_=St(null!==(t=this._spec.label)&&void 0!==t?t:{}),b={zIndex:this.layoutZIndex,interactive:null===(e=this._spec.interactive)||void 0===e||e,hover:null===(i=this._spec.interactive)||void 0===i||i,select:null===(n=this._spec.interactive)||void 0===n||n,points:[{x:0,y:0},{x:0,y:0}],center:{x:0,y:0},radius:0,startAngle:0,endAngle:0,lineStyle:J2(sH(null===(r=this._spec.line)||void 0===r?void 0:r.style),this._markerData,this._markAttributeContext),clipInRange:null!==(a=this._spec.clip)&&void 0!==a&&a,label:_.map((function(t){return q2(t,p._markerData,p._markAttributeContext)})),state:{line:Z2(null!==(s=null===(o=this._spec.line)||void 0===o?void 0:o.state)&&void 0!==s?s:{},this._markerData,this._markAttributeContext),lineStartSymbol:Z2(null!==(u=null===(l=this._spec.startSymbol)||void 0===l?void 0:l.state)&&void 0!==u?u:{},this._markerData,this._markAttributeContext),lineEndSymbol:Z2(null!==(h=null===(c=this._spec.endSymbol)||void 0===c?void 0:c.state)&&void 0!==h?h:{},this._markerData,this._markAttributeContext),label:_.map((function(t){var e;return Z2(null!==(e=t.state)&&void 0!==e?e:{},p._markerData,p._markAttributeContext)})),labelBackground:_.map((function(t){var e,i;return Z2(null!==(i=null===(e=t.labelBackground)||void 0===e?void 0:e.state)&&void 0!==i?i:{},p._markerData,p._markAttributeContext)}))},animation:null!==(d=this._spec.animation)&&void 0!==d&&d,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return g.visible?b.startSymbol=T(T({},g),{visible:!0,style:J2(sH(g.style),this._markerData,this._markAttributeContext)}):b.startSymbol={visible:!1},m.visible?b.endSymbol=T(T({},m),{visible:!0,style:J2(sH(m.style),this._markerData,this._markAttributeContext)}):b.endSymbol={visible:!1},this._newMarkLineComponent(b)},i.prototype._getUpdateMarkerAttrs=function(){var t,e,i,n=this._spec,r=this._markerData,a=this._startRelativeSeries,o=this._endRelativeSeries,s=this._relativeSeries,l=this._computePointsAttr(),u=s.getViewData().latestData,c=r.latestData[0]&&r.latestData[0].latestData?r.latestData[0].latestData:r.latestData;if(n.clip||St(n.label).some((function(t){return null==t?void 0:t.confine}))){var h=K2([a.getRegion(),o.getRegion(),s.getRegion()]),d=h.minX,p=h.maxX,f=h.minY;i={x:d,y:f,width:p-d,height:h.maxY-f}}var v=St((null!==(e=null===(t=this._markerComponent)||void 0===t?void 0:t.attribute)&&void 0!==e?e:{}).label),g=St(this._spec.label),y=v.map((function(t,e){var i=g[e]||{};return T(T({},t),{text:i.formatMethod?i.formatMethod(c,u):null==t?void 0:t.text})}));return T(T({},l),{label:y,limitRect:i,dx:this._layoutOffsetX,dy:this._layoutOffsetY})},i.prototype._markerLayout=function(){var t,e=this._getUpdateMarkerAttrs();null===(t=this._markerComponent)||void 0===t||t.setAttributes(e)},i.prototype._initDataView=function(){var t=this,e=this._spec,i="coordinates"in e,n=e3(e),r=n.doXProcess,a=n.doYProcess,o=n.doXYY1Process,s=n.doYXX1Process,l=n.doXYProcess,u=n.doAngleProcess,c=n.doRadiusProcess,h=n.doAngRadRad1Process,d=n.doRadAngAng1Process,p=n.doRadAngProcess;if(this._markerData=this._getRelativeDataView(),r||a||o||s||l||u||c||h||d||p||i){kH(this._option.dataSet,"markerAggregation",r3),kH(this._option.dataSet,"markerRegression",u3),kH(this._option.dataSet,"markerFilter",s3);var f=this._computeOptions(),v=f.options,g=f.needAggr,y=f.needRegr,m=f.processData,_=new hs(this._option.dataSet);_.parse([m],{type:"dataview"}),g&&_.transform({type:"markerAggregation",options:v}),y&&_.transform({type:"markerRegression",options:v}),_.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),_.target.on("change",(function(){t._markerLayout()})),this._markerData=_}},i.specKey="markLine",i}(l3),h3=function(t){return{visible:t,symbolType:"triangle",size:10,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}}},d3={style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fontStyle:"normal",fill:{type:"palette",key:"primaryFontColor"}},labelBackground:{padding:{top:2,bottom:2,right:4,left:4},style:{cornerRadius:3,fill:{type:"palette",key:"markLabelBackgroundColor"}}},refY:5},p3={line:{style:{lineDash:[3,3],stroke:{type:"palette",key:"markLineStrokeColor"}}},startSymbol:h3(!1),endSymbol:h3(!0),label:d3},f3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=I.markLine,e.name=I.markLine,e.coordinateType="cartesian",e}return M(e,t),e.prototype._newMarkLineComponent=function(t){return new XD(t)},e.prototype._computePointsAttr=function(){var t,e=this._spec,i=this._markerData,n=this._startRelativeSeries,r=this._endRelativeSeries,a=this._relativeSeries,o=U(e.coordinates),s=U(e.process),l=s&&U(e.process.x),u=s&&U(e.process.y),c=U(e.positions),h=null!==(t=e.autoRange)&&void 0!==t&&t,d=e3(e),p=d.doXProcess,f=d.doYProcess,v=d.doXYY1Process,g=d.doYXX1Process,y=d.doXYProcess,m=d.doCoordinatesProcess,_=[];if(p||v||f||g||y||o&&l||o&&u){var b=j2(i,n,r,a,h);_=1===b.length?b[0]:b.map((function(t){return t[0]}))}else m?_=W2(i,a,h,e.coordinatesOffset):c&&(_=X2(e.positions,a,e.regionRelative));return{points:_}},e.prototype._markerLayout=function(){var t,e,i,n,r=this._getUpdateMarkerAttrs();if("type-step"===this._spec.type){var a=this._startRelativeSeries,o=this._endRelativeSeries,s=this._spec.line||{},l=s.multiSegment,u=s.mainSegmentIndex,c=this._spec,h=c.connectDirection,d=c.expandDistance,p=void 0===d?0:d,f=void 0;if(EF(p)){var v=a.getRegion(),g=v.getLayoutStartPoint(),y=o.getRegion(),m=y.getLayoutStartPoint();if("bottom"===h||"top"===h){var _=Math.abs(Math.min(g.y,m.y)-Math.max(g.y+v.getLayoutRect().height,m.y+y.getLayoutRect().height));f=Number(p.substring(0,p.length-1))*_/100}else{var b=Math.abs(Math.min(g.x,m.x)-Math.max(g.x+v.getLayoutRect().width,m.x+y.getLayoutRect().width));f=Number(p.substring(0,p.length-1))*b/100}}else f=p;var x,k=r.points,S=r.limitRect,A=function(t,e,i,n){void 0===n&&(n=0);var r=[],a=t.y-e.y,o=t.x-e.x;switch(i){case"top":r.push(t),r.push({x:t.x,y:a>0?t.y-n-Math.abs(a):t.y-n}),r.push({x:e.x,y:a>0?e.y-n:e.y-n-Math.abs(a)}),r.push(e);break;case"bottom":r.push(t),r.push({x:t.x,y:a<0?t.y+n+Math.abs(a):t.y+n}),r.push({x:e.x,y:a<0?e.y+n:e.y+n+Math.abs(a)}),r.push(e);break;case"left":r.push(t),r.push({x:o>0?t.x-n-Math.abs(o):t.x-n,y:t.y}),r.push({x:o>0?e.x-n:e.x-n-Math.abs(o),y:e.y}),r.push(e);break;case"right":r.push(t),r.push({x:o>0?t.x+n:t.x+n+Math.abs(o),y:t.y}),r.push({x:o>0?e.x+n+Math.abs(o):e.x+n,y:e.y}),r.push(e)}return r}(k[0],k[1],h,f);x=l&&U(u)?{position:"middle",autoRotate:!1}:T({position:"start",autoRotate:!1},function(t,e,i,n){void 0===n&&(n=0);var r=t.y-e.y,a=t.x-e.x;return"bottom"===i?{dx:a>0?-a/2:Math.abs(a/2),dy:r>0?n:Math.abs(r)+n}:"top"===i?{dx:a>0?-Math.abs(a/2):+Math.abs(a/2),dy:r>0?-(Math.abs(r)+n):-n}:"left"===i?{dx:a>0?-a-n:-n,dy:r>0?-r/2:Math.abs(r/2)}:"right"===i?{dx:a>0?n:Math.abs(a)+n,dy:r>0?-r/2:Math.abs(r/2)}:{}}(k[0],k[1],h,f));var M=St((null!==(e=null===(t=this._markerComponent)||void 0===t?void 0:t.attribute)&&void 0!==e?e:{}).label),w=St(r.label),C=St(this._spec.label);null===(i=this._markerComponent)||void 0===i||i.setAttributes({points:l?[[A[0],A[1]],[A[1],A[2]],[A[2],A[3]]]:A,label:w.map((function(t,e){var i,n,r,a,o=0,s=0,l=null!==(i=x.dx)&&void 0!==i?i:0,u=null!==(n=x.dy)&&void 0!==n?n:0,c=null!==(r=C[e])&&void 0!==r?r:C[0];return et(null==c?void 0:c.refX)&&(o+=c.refX),et(null==c?void 0:c.refY)&&(s+=c.refY),et(null==c?void 0:c.dx)&&(l+=c.dx),et(null==c?void 0:c.dy)&&(u+=c.dy),T(T(T({},t),x),{refX:o,refY:s,dx:l,dy:u,textStyle:T(T({},null===(a=M[e])||void 0===a?void 0:a.textStyle),{textAlign:"center",textBaseline:"middle"})})})),limitRect:S,multiSegment:l,mainSegmentIndex:u,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}else null===(n=this._markerComponent)||void 0===n||n.setAttributes(r)},e.prototype._computeOptions=function(){var t,e=this._getRelativeDataView(),i=!0,n=!1,r=this._spec,a=this._relativeSeries,o=e3(r),s=o.doXProcess,l=o.doYProcess,u=o.doXYY1Process,c=o.doYXX1Process,h=o.doXYProcess,d=o.doCoordinatesProcess;if(h)t=[this._processSpecByDims([{dim:"x",specValue:r.x},{dim:"y",specValue:r.y}]),this._processSpecByDims([{dim:"x",specValue:r.x1},{dim:"y",specValue:r.y1}])];else if(s)t=[this._processSpecByDims([{dim:"x",specValue:r.x}])];else if(l)t=[this._processSpecByDims([{dim:"y",specValue:r.y}])];else if(u)t=[this._processSpecByDims([{dim:"x",specValue:r.x},{dim:"y",specValue:r.y}]),this._processSpecByDims([{dim:"x",specValue:r.x},{dim:"y",specValue:r.y1}])];else if(c)t=[this._processSpecByDims([{dim:"x",specValue:r.x},{dim:"y",specValue:r.y}]),this._processSpecByDims([{dim:"x",specValue:r.x1},{dim:"y",specValue:r.y}])];else if(d){if(t=this._processSpecCoo(r),i=!1,e=new hs(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")}).parse([a.getViewData()],{type:"dataview"}).transform({type:"markerAggregation",options:t}),r.process&&U(r.process.x)&&(t=[this._processSpecByDims([{dim:"x",specValue:r.process.x}])],i=!0),r.process&&U(r.process.y)&&(t=t=[this._processSpecByDims([{dim:"y",specValue:r.process.y}])],i=!0),r.process&&U(r.process.xy)){var p=a.getSpec();t={fieldX:p.xField,fieldY:p.yField},n=!0}}else i=!1;return{options:t,needAggr:i,needRegr:n,processData:e}},e.type=I.markLine,e.coordinateType="cartesian",e.builtInTheme={markLine:p3},e}(c3),v3=function(){KF.registerComponent(f3.type,f3),YD()},g3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=I.polarMarkLine,e.name=I.polarMarkLine,e.coordinateType="polar",e}return M(e,t),e.prototype._newMarkLineComponent=function(t){var e=e3(this._spec),i=e.doRadiusProcess,n=e.doRadAngAng1Process;return i||n?new ZD(t):new XD(t)},e.prototype._computePointsAttr=function(){var t,e=this._spec,i=this._markerData,n=this._startRelativeSeries,r=this._endRelativeSeries,a=this._relativeSeries,o=null!==(t=e.autoRange)&&void 0!==t&&t,s=e3(e),l=s.doAngleProcess,u=s.doRadiusProcess,c=s.doAngRadRad1Process,h=s.doRadAngAng1Process,d=s.doRadAngProcess,p=s.doCoordinatesProcess,f=[],v={},g={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(l||u||c||h||d){var y=U2(i,n,r,a,o);f=1===y.length?y[0]:y.map((function(t){return t[0]})),v=f[0].radius===f[1].radius?{radius:f[0].radius,startAngle:f[0].angle,endAngle:f[1].angle,center:g}:{points:f.map((function(t){return Ve(g,t.radius,t.angle)}))}}else p&&(v={points:(f=G2(i,a,o)).map((function(t){return Ve(g,t.radius,t.angle)}))});return v},e.prototype._computeOptions=function(){var t,e=this._spec,i=e3(e),n=i.doAngleProcess,r=i.doRadiusProcess,a=i.doAngRadRad1Process,o=i.doRadAngAng1Process,s=i.doRadAngProcess,l=i.doCoordinatesProcess,u=this._getRelativeDataView();return s?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:n?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle}])]:r?t=[this._processSpecByDims([{dim:"radius",specValue:e.radius}])]:a?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius1}])]:o?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:l&&(t=this._processSpecCoo(e)),{options:t,needAggr:!0,needRegr:!1,processData:u}},e.type=I.polarMarkLine,e.coordinateType="polar",e.builtInTheme={polarMarkLine:p3},e}(c3),y3=function(){KF.registerComponent(g3.type,g3),ZD._animate=wD,YD()},m3={padding:{top:4,bottom:20},textStyle:{fontSize:{type:"token",key:"l3FontSize"},lineHeight:{type:"token",key:"l3LineHeight"},fill:{type:"palette",key:"primaryFontColor"}},subtextStyle:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fill:{type:"palette",key:"tertiaryFontColor"}}},_3=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.type=I.title,r.specKey=I.title,r.layoutType="normal",r.layoutZIndex=t.LayoutZIndex.Title,r.layoutLevel=t.LayoutLevel.Title,r._orient="top",r._orient=CF(i.orient)?i.orient:"top",r}return M(i,e),Object.defineProperty(i.prototype,"orient",{get:function(){return this._orient},enumerable:!1,configurable:!0}),i.prototype.initLayout=function(){e.prototype.initLayout.call(this),this._layout&&(this._layout.layoutOrient=this._orient)},i.getSpecInfo=function(t){return _V(t,this.specKey,I.title,(function(t){return!1!==t.visible}))},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return(null==i?void 0:i.orient)===(null==t?void 0:t.orient)&&(null==i?void 0:i.visible)===t.visible||(n.reMake=!0),n.change=!0,n.reRender=!0,n},i.prototype.afterSetLayoutStartPoint=function(t){et(t.x)&&this._titleComponent&&this._titleComponent.setAttribute("x",t.x),et(t.y)&&this._titleComponent&&this._titleComponent.setAttribute("y",t.y),e.prototype.afterSetLayoutStartPoint.call(this,t)},i.prototype.getBoundsInRect=function(t){var e;this.setLayoutRect(t);var i=this._getTitleAttrs();this._createOrUpdateTitleComponent(i),e=this._getTitleLayoutRect();var n=this.getLayoutStartPoint(),r=n.x,a=n.y;return{x1:r,y1:a,x2:r+e.width,y2:a+e.height}},i.prototype._getTitleLayoutRect=function(){var t=this._titleComponent.AABBBounds;return{width:this._spec.width?this._spec.width:et(t.width())?t.width():0,height:this._spec.height?this._spec.height:et(t.height())?t.height():0}},i.prototype._getTitleAttrs=function(){var t,e,i,n,r,a,o,s;if(!1===this._spec.visible)return{visible:!1};var l=this.getLayoutRect(),u=BF(this._spec.width,l.width,null,l.width),c=BF(this._spec.maxWidth,l.width,null,l.width),h=Math.max(Math.min(u,c,l.width),0),d=T(T({},yt(this._spec,["padding"])),{textType:null!==(t=this._spec.textType)&&void 0!==t?t:"text",text:null!==(e=this._spec.text)&&void 0!==e?e:"",subtextType:null!==(i=this._spec.subtextType)&&void 0!==i?i:"text",subtext:null!==(n=this._spec.subtext)&&void 0!==n?n:"",x:null!==(r=this._spec.x)&&void 0!==r?r:0,y:null!==(a=this._spec.y)&&void 0!==a?a:0,height:this._spec.height,minWidth:this._spec.minWidth,maxWidth:h,minHeight:this._spec.minHeight,maxHeight:this._spec.maxHeight,padding:this._spec.innerPadding,align:null!==(o=this._spec.align)&&void 0!==o?o:"left",verticalAlign:null!==(s=this._spec.verticalAlign)&&void 0!==s?s:"top",textStyle:T({width:h,maxLineWidth:h},this._spec.textStyle),subtextStyle:T({maxLineWidth:h},this._spec.subtextStyle)});return U(this._spec.width)&&(d.textStyle.width=Math.max(u,l.width),d.subtextStyle.width=d.textStyle.width),d},i.prototype._createOrUpdateTitleComponent=function(t){var e=this;if(this._titleComponent)bt(t,this._cacheAttrs)||this._titleComponent.setAttributes(t);else{var i=this.getContainer(),n=new _O(t);n.name="title",i.add(n),this._titleComponent=n,n.on("*",(function(t,i){return e._delegateEvent(n,t,i)}))}return this._cacheAttrs=t,this._titleComponent},i.prototype._getNeedClearVRenderComponents=function(){return[this._titleComponent]},i.prototype.clear=function(){e.prototype.clear.call(this),this._cacheAttrs=null},i.type=I.title,i.specKey=I.title,i.builtInTheme={title:m3},i}(yU),b3=function(){KF.registerComponent(_3.type,_3)},x3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.specKey="markArea",i.layoutZIndex=t.LayoutZIndex.MarkArea,i}return M(i,e),i._getMarkerCoordinateType=function(t){var e=i3(t),i=e.doAngleProcess,n=e.doRadiusProcess,r=e.doRadAngProcess;return"polar"===t.coordinateType||i||n||r?"polar":"cartesian"},i.prototype._createMarkerComponent=function(){var t,e,i,n,r,a,o,s,l=this,u=St(null!==(t=this._spec.label)&&void 0!==t?t:{}),c={zIndex:this.layoutZIndex,interactive:null===(e=this._spec.interactive)||void 0===e||e,hover:null===(i=this._spec.interactive)||void 0===i||i,select:null===(n=this._spec.interactive)||void 0===n||n,points:[{x:0,y:0}],center:{x:0,y:0},innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,areaStyle:J2(sH(null===(r=this._spec.area)||void 0===r?void 0:r.style),this._markerData,this._markAttributeContext),clipInRange:null!==(a=this._spec.clip)&&void 0!==a&&a,label:u.map((function(t){return q2(t,l._markerData,l._markAttributeContext)})),state:{area:Z2(null===(o=this._spec.area)||void 0===o?void 0:o.state,this._markerData,this._markAttributeContext),label:u.map((function(t){return Z2(t.state,l._markerData,l._markAttributeContext)})),labelBackground:u.map((function(t){var e;return Z2(null===(e=t.labelBackground)||void 0===e?void 0:e.state,l._markerData,l._markAttributeContext)}))},animation:null!==(s=this._spec.animation)&&void 0!==s&&s,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return this._newMarkAreaComponent(c)},i.prototype._markerLayout=function(){var t,e,i=this._spec,n=this._markerData,r=this._startRelativeSeries,a=this._endRelativeSeries,o=this._relativeSeries,s=this._computePointsAttr(),l=this._getRelativeDataView().latestData,u=n?n.latestData[0]&&n.latestData[0].latestData?n.latestData[0].latestData:n.latestData:l;if(i.clip||St(i.label).some((function(t){return null==t?void 0:t.confine}))){var c=K2([r.getRegion(),a.getRegion(),o.getRegion()]),h=c.minX,d=c.maxX,p=c.minY;e={x:h,y:p,width:d-h,height:c.maxY-p}}if(this._markerComponent){var f=St(null===(t=this._markerComponent.attribute)||void 0===t?void 0:t.label),v=St(this._spec.label);this._markerComponent.setAttributes(T(T({},s),{label:f.map((function(t,e){var i=v[e]||{};return T(T({},t),{text:i.formatMethod?i.formatMethod(u,l):null==t?void 0:t.text})})),limitRect:e,dx:this._layoutOffsetX,dy:this._layoutOffsetY}))}},i.prototype._initDataView=function(){var t=i3(this._spec),e=t.doXProcess,i=t.doYProcess,n=t.doXYProcess,r=t.doAngleProcess,a=t.doRadiusProcess,o=t.doRadAngProcess,s=t.doCoordinatesProcess;if(!(e||i||n||r||a||o||s))return null;this._initCommonDataView()},i.specKey="markArea",i}(l3),k3={area:{style:{fill:{type:"palette",key:"axisDomainColor",a:.25}}},label:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fontStyle:"normal",fill:{type:"palette",key:"primaryFontColor"}},labelBackground:{padding:{top:2,bottom:2,right:4,left:4},style:{cornerRadius:3,fill:{type:"palette",key:"markLabelBackgroundColor"}}}}},S3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=I.markArea,e.name=I.markArea,e.coordinateType="cartesian",e}return M(e,t),e.prototype._newMarkAreaComponent=function(t){return new qD(t)},e.prototype._computePointsAttr=function(){var t,e=this._spec,i=this._markerData,n=this._startRelativeSeries,r=this._endRelativeSeries,a=this._relativeSeries,o=i3(e),s=o.doXProcess,l=o.doYProcess,u=o.doXYProcess,c=o.doCoordinatesProcess,h=U(e.positions),d=null!==(t=e.autoRange)&&void 0!==t&&t,p=[];if(u){var f=B(j2(i,n,r,a,d),2),v=f[0],g=f[1];v&&v.length&&g&&g.length&&(p=[{x:v[0].x,y:g[0].y},v[0],{x:g[0].x,y:v[0].y},g[0]])}else if(s||l){var y=B(j2(i,n,r,a,d),2);v=y[0],g=y[1];v&&v.length&&g&&g.length&&(p=R(R([],B(v),!1),[g[1],g[0]],!1))}else c?p=W2(i,a,d,e.coordinatesOffset):h&&(p=X2(e.positions,a,e.regionRelative));return{points:p}},e.prototype._computeOptions=function(){var t,e=this._spec,i=i3(e),n=i.doXProcess,r=i.doYProcess,a=i.doXYProcess,o=i.doCoordinatesProcess;return a?t=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"x",specValue:e.x1},{dim:"y",specValue:e.y1}])]:n?t=[this._processSpecByDims([{dim:"x",specValue:e.x}]),this._processSpecByDims([{dim:"x",specValue:e.x1}])]:r?t=[this._processSpecByDims([{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"y",specValue:e.y1}])]:o&&(t=this._processSpecCoo(e)),{options:t}},e.type=I.markArea,e.coordinateType="cartesian",e.builtInTheme={markArea:k3},e}(x3),A3=function(){KF.registerComponent(S3.type,S3),KD()},M3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=I.polarMarkArea,e.name=I.polarMarkArea,e.coordinateType="polar",e}return M(e,t),e.prototype._newMarkAreaComponent=function(t){var e=i3(this._spec),i=e.doRadiusProcess,n=e.doAngleProcess,r=e.doRadAngProcess;return n||i||r?new JD(t):new qD(t)},e.prototype._computePointsAttr=function(){var t,e=this._spec,i=this._markerData,n=this._startRelativeSeries,r=this._endRelativeSeries,a=this._relativeSeries,o=i3(e),s=o.doAngleProcess,l=o.doRadiusProcess,u=o.doRadAngProcess,c=o.doCoordinatesProcess,h=null!==(t=e.autoRange)&&void 0!==t&&t,d={},p={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(s||l||u){var f=U2(i,n,r,a,h);u?d={innerRadius:f[0][0].radius,outerRadius:f[1][0].radius,startAngle:f[0][0].angle,endAngle:f[1][0].angle,center:p}:s?d={innerRadius:0,outerRadius:Math.abs(f[0][0].radius),startAngle:f[0][1].angle,endAngle:f[1][1].angle,center:p}:l&&(d={innerRadius:f[0][0].radius,outerRadius:f[1][0].radius,startAngle:f[0][0].angle,endAngle:f[1][1].angle,center:p})}else c&&(d={points:G2(i,a,h).map((function(t){return Ve(p,t.radius,t.angle)}))});return d},e.prototype._computeOptions=function(){var t,e=this._spec,i=i3(e),n=i.doAngleProcess,r=i.doRadiusProcess,a=i.doRadAngProcess,o=i.doCoordinatesProcess;return a?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:n?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:r?t=[this._processSpecByDims([{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"radius",specValue:e.radius1}])]:o&&(t=this._processSpecCoo(e)),{options:t}},e.type=I.polarMarkArea,e.coordinateType="polar",e.builtInTheme={polarMarkArea:k3},e}(x3),T3=function(){KF.registerComponent(M3.type,M3),JD._animate=ED,KD()},w3=function(t){return sH(T({},t))},C3=function(t){return T(T({},t),{style:T({},sH(t.style))})},E3=function(t){var e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y=w3(null!==(i=null===(e=null==t?void 0:t.slider)||void 0===e?void 0:e.trackStyle)&&void 0!==i?i:{}),m=w3(null!==(r=null===(n=null==t?void 0:t.slider)||void 0===n?void 0:n.railStyle)&&void 0!==r?r:{}),_=(g=null!==(o=null===(a=null==t?void 0:t.slider)||void 0===a?void 0:a.handlerStyle)&&void 0!==o?o:{},sH(T({},g))),b=C3(null!==(l=null===(s=null==t?void 0:t.controller)||void 0===s?void 0:s.start)&&void 0!==l?l:{}),x=C3(null!==(c=null===(u=null==t?void 0:t.controller)||void 0===u?void 0:u.pause)&&void 0!==c?c:{}),k=C3(null!==(d=null===(h=null==t?void 0:t.controller)||void 0===h?void 0:h.backward)&&void 0!==d?d:{}),S=C3(null!==(f=null===(p=null==t?void 0:t.controller)||void 0===p?void 0:p.forward)&&void 0!==f?f:{}),A=T(T({},t),{direction:t.direction,interval:t.interval,visible:t.visible,orient:null!==(v=t.orient)&&void 0!==v?v:"bottom",slider:T(T({},t.slider),{trackStyle:y,railStyle:m,handlerStyle:_}),controller:T(T({},t.controller),{start:b,pause:x,backward:k,forward:S})});return t.visible||(A.controller.visible=!1,A.slider.visible=!1),A},P3=function(t){return"left"===t||"right"===t},B3=function(t){return"top"===t||"bottom"===t},R3={visible:!0,position:"start",padding:{top:20,bottom:20},slider:{space:10,trackStyle:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.8},railStyle:{fill:{type:"palette",key:"sliderRailColor"}},handlerStyle:{size:15,stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fill:{type:"palette",key:"playerControllerColor"}}},controller:{start:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},pause:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},backward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},forward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}}}},L3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.layoutZIndex=t.LayoutZIndex.Player,i.layoutLevel=t.LayoutLevel.Player,i.specKey="player",i.type=I.player,i._orient="bottom",i._getPlayerAttrs=function(){var t,e,n,r,a,o,s,l,u=i._spec.type,c={size:{width:i._width,height:i._height},dx:null!==(t=i._spec.dx)&&void 0!==t?t:0+i._dx,dy:null!==(e=i._spec.dy)&&void 0!==e?e:0+i._dy};return"discrete"===u?T(T(T({},(s=i._spec,l=i._specs,T(T({},E3(s)),{data:l,type:"discrete"}))),c),{disableTriggerEvent:i._option.disableTriggerEvent,loop:null===(r=null===(n=i._spec)||void 0===n?void 0:n.loop)||void 0===r||r}):T(T(T({},function(t,e){return T(T({},E3(t)),{data:e,type:"continuous"})}(i._spec,i._specs)),c),{disableTriggerEvent:i._option.disableTriggerEvent,loop:null===(o=null===(a=i._spec)||void 0===a?void 0:a.loop)||void 0===o||o})},i._createOrUpdatePlayerComponent=function(){var t=T({},i._getPlayerAttrs()),e=i.getContainer();i._playerComponent?bt(t,i._cacheAttrs)||(i._cacheAttrs=t,i._playerComponent.setAttributes(t),i._playerComponent._initAttributes(),i._playerComponent.render()):("discrete"===t.type?i._playerComponent=new DO(t):i._playerComponent=new zO(t),i._cacheAttrs=t,i._playerComponent.name="player",e.add(i._playerComponent),i._initEvent())},i._maxSize=function(){var t,e,n,r,a,o,s,l,u;return Math.max.apply(Math,R(R(R(R(R([],B(St(null===(e=null===(t=i._spec.controller.start)||void 0===t?void 0:t.style)||void 0===e?void 0:e.size)),!1),B(St(null===(r=null===(n=i._spec.controller.pause)||void 0===n?void 0:n.style)||void 0===r?void 0:r.size)),!1),B(St(null===(o=null===(a=i._spec.controller.backward)||void 0===a?void 0:a.style)||void 0===o?void 0:o.size)),!1),B(St(null===(l=null===(s=i._spec.controller.forward)||void 0===s?void 0:s.style)||void 0===l?void 0:l.size)),!1),[null!==(u=P3(i._orient)?i._spec.slider.railStyle.width:i._spec.slider.railStyle.height)&&void 0!==u?u:10],!1))},i._sliderExceededSize=function(){var t,e,n,r,a,o,s,l,u,c=null!==(t=P3(i._orient)?i._spec.slider.railStyle.width:i._spec.slider.railStyle.height)&&void 0!==t?t:10,h=Math.max.apply(Math,R(R(R(R([],B(St(null===(n=null===(e=i._spec.controller.start)||void 0===e?void 0:e.style)||void 0===n?void 0:n.size)),!1),B(St(null===(a=null===(r=i._spec.controller.pause)||void 0===r?void 0:r.style)||void 0===a?void 0:a.size)),!1),B(St(null===(s=null===(o=i._spec.controller.backward)||void 0===o?void 0:o.style)||void 0===s?void 0:s.size)),!1),B(St(null===(u=null===(l=i._spec.controller.forward)||void 0===l?void 0:l.style)||void 0===u?void 0:u.size)),!1));return c>=h?c-h:0},i._initEvent=function(){i._option.disableTriggerEvent||(i._option.globalInstance.on(t.ChartEvent.rendered,(function(){var t;(null===(t=i._spec)||void 0===t?void 0:t.auto)&&(i._playerComponent.pause(),i._playerComponent.play())})),i._playerComponent.addEventListener(wO.end,(function(){var e;i.event.emit(t.ChartEvent.playerEnd,{model:i}),i._alternate&&"discrete"===i._spec.type&&(i._direction="default"===i._direction?"reverse":"default",i._playerComponent.setAttributes({direction:i._direction,dataIndex:"reverse"===i._direction?i._specs.length-2:1})),(null===(e=i._spec)||void 0===e?void 0:e.loop)&&i._playerComponent.play()})),i._playerComponent.addEventListener(wO.change,(function(t){var e=t.detail.index;i.changePlayerIndex(e)})),i._playerComponent.addEventListener(wO.backward,(function(e){var n=e.detail.index,r=i._specs[n];i.event.emit(t.ChartEvent.playerBackward,{model:i,value:{spec:r,index:n,specs:i._specs}})})),i._playerComponent.addEventListener(wO.forward,(function(e){var n=e.detail.index,r=i._specs[n];i.event.emit(t.ChartEvent.playerForward,{model:i,value:{spec:r,index:n,specs:i._specs}})})),i._playerComponent.addEventListener(wO.play,(function(e){var n=e.detail.index,r=i._specs[n];i.event.emit(t.ChartEvent.playerPlay,{model:i,value:{spec:r,index:n,specs:i._specs}})})),i._playerComponent.addEventListener(wO.pause,(function(e){var n=e.detail.index,r=i._specs[n];i.event.emit(t.ChartEvent.playerPause,{model:i,value:{spec:r,index:n,specs:i._specs}})})))},i}return M(i,e),Object.defineProperty(i.prototype,"orient",{get:function(){return this._orient},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"layoutOrient",{set:function(t){this._orient=t},enumerable:!1,configurable:!0}),i.prototype.setAttrFromSpec=function(){var t,i,n,r,a,o,s,l;e.prototype.setAttrFromSpec.call(this),this._orient=null!==(t=this._spec.orient)&&void 0!==t?t:"bottom",this._specs=null!==(i=this._spec.specs)&&void 0!==i?i:[],this._direction=null!==(n=this._spec.direction)&&void 0!==n?n:"default",this._alternate=null!==(r=this._spec.alternate)&&void 0!==r&&r,this._dx=null!==(a=this._spec.dx)&&void 0!==a?a:0,this._dy=null!==(o=this._spec.dy)&&void 0!==o?o:0,this._position=null!==(s=this._spec.position)&&void 0!==s?s:"middle",this._visible=null===(l=this._spec.visible)||void 0===l||l},i.prototype.afterSetLayoutStartPoint=function(t){if(e.prototype.afterSetLayoutStartPoint.call(this,t),et(t.x)){var i=P3(this._orient)?t.x+this._sliderExceededSize()/2:t.x;this._playerComponent&&this._playerComponent.setAttribute("x",i)}if(et(t.y)){var n=B3(this._orient)?t.y+this._sliderExceededSize()/2:t.y;this._playerComponent&&this._playerComponent.setAttribute("y",n)}},i.prototype.getBoundsInRect=function(t,e){this._width=this._computeWidth(t),this._height=this._computeHeight(t),this._dx=this._computeDx(e),this._dy=this._computeDy(e);var i=this._computeLayoutRect(t,this._width,this._height);return this._createOrUpdatePlayerComponent(),i},i.prototype._getNeedClearVRenderComponents=function(){return[this._playerComponent]},i.prototype._computeLayoutRect=function(t,e,i){if(!1===this._visible)return{x1:0,x2:0,y1:0,y2:0};switch(this._orient){case"top":case"left":return{x1:0,y1:0,x2:e,y2:i};case"right":return{x1:t.width-e,y1:0,x2:t.width,y2:t.height};default:return{x1:0,y1:t.height-i,x2:t.width,y2:t.height}}},i.prototype._computeWidth=function(t){return Q(this._spec.width)?Math.min(t.width,Number(this._spec.width)):P3(this._orient)?this._maxSize():t.width},i.prototype._computeHeight=function(t){return Q(this._spec.height)?(this._height=this._spec.height,Math.min(t.height,Number(this._spec.height))):B3(this._orient)?this._maxSize():t.height},i.prototype._computeDx=function(t){return P3(this._orient)||"start"===this._position?0:"middle"===this._position?(t.width-this._width)/2:t.width-this._width},i.prototype._computeDy=function(t){return B3(this._orient)||"start"===this._position?0:"middle"===this._position?(t.height-this._height)/2:t.height-this._height},i.prototype.changePlayerIndex=function(e){var i=this._specs[e];this._option.globalInstance.updateFullData(i.data),this.event.emit(t.ChartEvent.playerChange,{model:this,value:{spec:i,index:e,specs:this._specs}})},i.builtInTheme={player:R3},i.specKey="player",i.type=I.player,i}(yU),I3=function(){KF.registerComponent(L3.type,L3)},D3=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.type=I.label,r.name=I.label,r.layoutType="none",r.layoutZIndex=t.LayoutZIndex.Label,r._regions=n.getRegionsInIndex(n.regionIndexes),r}return M(i,e),i.prototype._interactiveConfig=function(t){var e=t.interactive,i={hover:!1,select:!1,state:t.state};if(!0!==e)return i;var n=this._option.getChart().getSpec(),r=n.hover,a=n.select;return!1===r&&!1===r.enable||(i.hover=!0),!1===a&&!1===a.enable||(i.select=!0),i},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reRender=!0,bt(i,t)||(n.reMake=!0),n},i.prototype._getDataLabelType=function(t,e){var i=t.type;return"line"===i||"area"===i?null!=e?e:"line-data":"rect"===i?"rect":"arc"===i?"arc":"symbol"===i||"cell"===i?"symbol":t.setDataLabelType?t.setDataLabelType():""},i.prototype._setTransformOfComponent=function(t,e){var i=this;t.setAttributeTransform((function(t){var n=t.labelStyle,r=t.size,a=t.itemEncoder,o=r(),s=gF({type:"palette",key:"secondaryFontColor"},i.getColorScheme()),l=St(e).map((function(t,e){var r=n(e),l=[],u=t.getGraphics();if(u)return r.data&&r.data.length?r.data.forEach((function(t,i){if(u[i]){var n=a(t,{labelIndex:e});j(n.fill)&&(n.fill=s),j(n.data)&&(n.data=t),l.push(n)}})):u.forEach((function(t){var i=t.context,n=i.data;i.diffState!==gN.exit&&n.forEach((function(t,i){var n=a(t,{labelIndex:e});j(n.fill)&&(n.fill=s),j(n.data)&&(n.data=t),l.push(n)}))})),Y(r.overlap)&&j(r.overlap.size)&&(r.overlap.size=T({},o)),T(T({smartInvert:!1,baseMarkGroupName:t.getProductId(),getBaseMarks:function(){return u}},r),{type:i._getDataLabelType(t,r.type),data:l})}));return{dataLabels:l,size:o}}))},i.prototype.getVRenderComponents=function(){var t=[];return this.getMarks().forEach((function(e){var i=e.getComponent();i&&t.push(i)})),t},i.prototype.clear=function(){e.prototype.clear.call(this),this.getMarks().forEach((function(t){t&&t.clearComponent()}))},i.type=I.label,i}(yU),O3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skipEncode=!1,e}return M(e,t),e.prototype.getRule=function(){return this._rule},e.prototype.setRule=function(t){this._rule=t},e.prototype.getTarget=function(){return this._target},e.prototype.setTarget=function(t){this._target=t,this._rule||this.setRule(t.type)},e.prototype.getComponent=function(){return this._component},e.prototype.setComponent=function(t){this._component=t},e.prototype.render=function(){},e.type="text",e.constructorType="label",e}(yX),F3=function(){mX(),KF.registerMark(O3.constructorType,O3)},z3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._initTheme=function(t,e){return{spec:t,theme:this._theme}},e}(gU),H3=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.type=I.label,r.name=I.label,r.specKey="label",r.transformerConstructor=z3,r.layoutZIndex=t.LayoutZIndex.Label,r._layoutRule=i.labelLayout||"series",r}return M(i,e),i.getSpecInfo=function(t,e){var i=this,n=[],r=(null==e?void 0:e.region)||[];return r.forEach((function(r,a){var o=(r.seriesIndexes||[]).some((function(t){var i=e.series[t].markLabelSpec,n=void 0===i?{}:i;return Object.values(n).some((function(t){return Array.isArray(t)&&function(t){return t.some((function(t){return t.visible}))}(t)}))}));o&&n.push({spec:t,type:I.label,specInfoPath:["component",i.specKey,a],regionIndexes:[a]})})),n},i.prototype.init=function(t){e.prototype.init.call(this,t),this.initEvent(),this._initTextMark(),this._initLabelComponent(),this._initTextMarkStyle()},i.prototype.reInit=function(t){e.prototype.reInit.call(this,t),this._labelInfoMap&&(this._labelInfoMap.forEach((function(t){t.forEach((function(t){t.labelMark.release()}))})),this._labelInfoMap.clear()),this._labelInfoMap&&this._labelInfoMap.clear(),this._initTextMark(),this._initLabelComponent(),this._initTextMarkStyle()},i.prototype.initEvent=function(){var e=this;this.event.on(t.ChartEvent.dataZoomChange,(function(){e._labelComponentMap.forEach((function(t,e){var i=e.getComponent();i&&i.disableAnimation()})),e.event.on(lH.AFTER_MARK_RENDER_END,i)}));var i=function(){e._labelComponentMap.forEach((function(t,e){var i=e.getComponent();i&&i.enableAnimation()})),e.event.off(lH.AFTER_MARK_RENDER_END,i)}},i.prototype._initTextMark=function(){var t=this;this._labelInfoMap||(this._labelInfoMap=new Map),this._labelComponentMap||(this._labelComponentMap=new Map),iF(this._regions,(function(e){var i=e.getSpecInfo().markLabelSpec,n=void 0===i?{}:i,r=Object.keys(n),a=e.getRegion();t._labelInfoMap.get(a)||t._labelInfoMap.set(a,[]);for(var o=function(i){var o=r[i],s=e.getMarkInName(o);if(!s)return"continue";n[o].forEach((function(i,n){var r,l,u;if(i.visible){var c=t._labelInfoMap.get(a),h=t._createMark({type:"label",name:"".concat(null!==(r=e.userId)&&void 0!==r?r:e.id,"-").concat(o,"-label-").concat(n)},{attributeContext:e.getMarkAttributeContext()});i.showRelatedMarkTooltip&&(null===(u=null===(l=e.tooltipHelper)||void 0===l?void 0:l.activeTriggerSet.mark)||void 0===u||u.add(h)),h.setTarget(s),c.push({labelMark:h,baseMark:s,series:e,labelSpec:i})}}))},s=0;s<r.length;s++)o(s)}))},i.prototype._initLabelComponent=function(){var t=this,e={};this._labelComponentMap.forEach((function(t,i){e[i.name]=i})),this._labelInfoMap.forEach((function(i,n){if("region"===t._layoutRule){var r=!1,a="".concat(n.getGroupMark().name,"-label-component"),o=e[a];o||(r=!0,o=t._createMark({type:"component",name:a},{componentType:"label"},{support3d:t._spec.support3d})),o&&(r&&(o.setSkipBeforeLayouted(!0),t._marks.addMark(o),i.forEach((function(t){var e;null===(e=t.baseMark.getData())||void 0===e||e.addRelatedMark(o)}))),i[0]&&U(i[0].labelSpec.zIndex)&&o.setMarkConfig({zIndex:i[0].labelSpec.zIndex}),t._labelComponentMap.set(o,(function(){return t._labelInfoMap.get(n)})),e[a]=null)}else i.forEach((function(i,r){var a,o=!1,s="".concat(i.labelMark.name,"-component"),l=e[s];l||(o=!0,l=t._createMark({type:"component",name:s},{componentType:"label",noSeparateStyle:!0},{support3d:i.baseMark.getMarkConfig().support3d})),l&&(U(i.labelSpec.zIndex)&&l.setMarkConfig({zIndex:i.labelSpec.zIndex}),o&&(l.setSkipBeforeLayouted(!0),t._marks.addMark(l),null===(a=i.baseMark.getData())||void 0===a||a.addRelatedMark(l)),t._labelComponentMap.set(l,(function(){return t._labelInfoMap.get(n)[r]})),e[s]=null)}))})),Object.keys(e).forEach((function(i){var n=e[i];n&&(n.release(),t._labelComponentMap.delete(n))}))},i.prototype._initTextMarkStyle=function(){var e=this;this._labelComponentMap.forEach((function(t,e){St(t()).forEach((function(t){t.labelMark.setComponent(e)}))})),this._labelInfoMap.forEach((function(i){i.forEach((function(i){var n,r,a=i.labelMark,o=i.labelSpec,s=i.series;if(e.initMarkStyleWithSpec(a,o),V(null==o?void 0:o.getStyleHandler)){var l=o.getStyleHandler(s);null==l||l.call(s,a,o)}(null===(r=null===(n=a.stateStyle)||void 0===n?void 0:n.normal)||void 0===r?void 0:r.lineWidth)&&a.setAttribute("stroke",s.getColorAttribute(),"normal",t.AttributeLevel.Base_Series)}))}))},i.prototype.updateLayoutAttribute=function(){var t=this;e.prototype.updateLayoutAttribute.call(this),this._labelComponentMap.forEach((function(e,i){var n=e();q(n)?t._updateMultiLabelAttribute(n,i):t._updateSingleLabelAttribute(n,i)}))},i.prototype._updateMultiLabelAttribute=function(t,e){this._updateLabelComponentAttribute(e,t.map((function(t){return t.baseMark})),t)},i.prototype._updateSingleLabelAttribute=function(t,e){var i=t.baseMark;this._updateLabelComponentAttribute(e,i,[t])},i.prototype._updateLabelComponentAttribute=function(t,e,i){var n=this,r=this._option.getComponentsByType("totalLabel");t.setMarkConfig({interactive:!1}),t.setSimpleStyle({labelStyle:function(t){var e,a,o=i[t],s=o.labelSpec,l=o.labelMark,u=o.series,c=l.getRule(),h=n._interactiveConfig(s),d=null!==(a=null===(e=n._spec)||void 0===e?void 0:e.centerOffset)&&void 0!==a?a:0,p=XF({textStyle:T({pickable:!0===s.interactive},s.style),overlap:{avoidMarks:r.map((function(t){return t.getMarks()[0].getProductId()}))}},DY(c,o),T(T(T({},yt(s,["position","style","state","type","stackDataFilterType","getStyleHandler"])),h),{centerOffset:d}),s.stackDataFilterType?{dataFilter:"min"===s.stackDataFilterType?function(t){return t.filter((function(t){return t.data[Oz]}))}:function(t){return t.filter((function(t){return t.data[Dz]}))}}:{});return u&&u.parseLabelStyle&&(p=u.parseLabelStyle(p,s,l)),"line"!==c&&"area"!==c||(p.type=c),p},size:function(){var t;return T({padding:null===(t=i[0].labelSpec.overlap)||void 0===t?void 0:t.padding},i[0].series.getRegion().getLayoutRect())},itemEncoder:function(t,e){var n=e.labelIndex;return i[n]&&!i[n].labelMark.skipEncode?OY(i[n],t,i[n].labelSpec.formatMethod,i[n].labelSpec.formatter):{data:t}}}),this._setTransformOfComponent(t,e)},i.prototype.compileMarks=function(){var t=this;this.getMarks().forEach((function(e){var i,n=t._labelComponentMap.get(e)();i=q(n)?n[0].series.getRegion().getGroupMark().getProduct():n.series.getRegion().getGroupMark().getProduct(),e.compile({group:i})}))},i.prototype.getLabelInfoByTextGraphic=function(t){var e,i=null==t?void 0:t.parent,n=null==i?void 0:i.parent;if(n){var r=n.getChildren().indexOf(i);this._labelComponentMap.forEach((function(t,i){i.getComponent()===n&&(e=St(t())[r])}))}return e},i.type=I.label,i.specKey="label",i.transformerConstructor=z3,i}(D3),N3=function(){KF.registerGraphicComponent(H3.type,(function(t){return new qI(t)})),F3(),_U(),KF.registerComponent(H3.type,H3,!0,1/0)},V3={visible:!1,offset:5,overlap:{clampForce:!0,strategy:[]},smartInvert:!1,animation:!1,style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"primaryFontColor"}}},j3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=I.totalLabel,i.name=I.totalLabel,i.specKey="totalLabel",i.layoutZIndex=t.LayoutZIndex.Label,i}return M(i,e),i.getSpecInfo=function(t,e){var i,n=this,r=[];return null===(i=null==e?void 0:e.region)||void 0===i||i.forEach((function(t,i){var a;null===(a=t.seriesIndexes)||void 0===a||a.forEach((function(t){var a=e.series[t].spec[n.specKey];(null==a?void 0:a.visible)&&r.push({spec:a,type:I.totalLabel,specPath:["series",t,n.specKey],specInfoPath:["component",n.specKey,t],regionIndexes:[i],seriesIndexes:[t]})}))})),r},i.prototype.init=function(t){e.prototype.init.call(this,t),this._initTextMark(),this._initLabelComponent()},i.prototype.reInit=function(t){e.prototype.reInit.call(this,t),this._initTextMark()},i.prototype._initTextMark=function(){var t,e=this._getSeries();if(null===(t=e.getSpec().totalLabel)||void 0===t?void 0:t.visible){var i=e.getSeriesMark();if(i){var n=this._createMark({type:"label",name:"".concat(i.name,"-total-label")});this._baseMark=i,this._textMark=n,this._initTextMarkStyle()}}},i.prototype._initTextMarkStyle=function(){var i;e.prototype.initMarkStyleWithSpec.call(this,this._textMark,this._spec),this.setMarkStyle(this._textMark,{text:function(t){return t[Lz]}},"normal",t.AttributeLevel.Default);var n=this._getSeries();null===(i=n.initTotalLabelMarkStyle)||void 0===i||i.call(n,this._textMark)},i.prototype._initLabelComponent=function(){var t,e=this._getSeries(),i=this._createMark({type:"component",name:"".concat(null!==(t=e.name)&&void 0!==t?t:e.type,"-total-label-component")},{componentType:"label"},{support3d:this._spec.support3d});i&&(this._marks.addMark(i),e.getData().addRelatedMark(i))},i.prototype.updateLayoutAttribute=function(){var t=this;e.prototype.updateLayoutAttribute.call(this);var i=this._getSeries();this._marks.forEach((function(e,n){e.setMarkConfig({interactive:!1}),e.setSimpleStyle({labelStyle:function(){var e,n;if(t._baseMark){var r=t._spec,a=r.offset,o=r.animation,s=r.overlap,l=r.position,u=void 0===l?"top":l,c=t._interactiveConfig(t._spec);return XF({textStyle:{pickable:!0===t._spec.interactive},position:U3(i,t._baseMark.type,u),x:0,y:0},null!==(n=null===(e=i.getTotalLabelComponentStyle)||void 0===e?void 0:e.call(i,{baseMark:t._baseMark,labelMark:t._textMark}))&&void 0!==n?n:{},T({offset:a,animation:o,overlap:s,dataFilter:function(t){return t.filter((function(t){return"bottom"===u?t.data[Oz]:t.data[Dz]}))}},c))}},size:function(){var e;return T({padding:null===(e=t._spec.overlap)||void 0===e?void 0:e.padding},t._regions[0].getLayoutRect())},itemEncoder:function(e){return OY({baseMark:t._baseMark,labelMark:t._textMark,series:i,labelSpec:i.getSpec().totalLabel},e,t._spec.formatMethod)}}),t._setTransformOfComponent(e,t._baseMark)}))},i.prototype.compileMarks=function(){var t=this;this.getMarks().forEach((function(e){var i=t._regions[0].getGroupMark().getProduct();e.compile({group:i,context:{model:t}})}))},i.prototype._getSeries=function(){return this._option.getSeriesInIndex([this.getSpecPath()[1]])[0]},i.type=I.totalLabel,i.builtInTheme={totalLabel:V3},i.specKey="totalLabel",i}(D3);function U3(t,e,i){var n,r,a;void 0===i&&(i="top");var o,s=t.direction;o="bottom"===i?{vertical:["bottom","top"],horizontal:["left","right"]}:{vertical:["top","bottom"],horizontal:["right","left"]};var l=("horizontal"===s?null===(n=t.getXAxisHelper())||void 0===n?void 0:n.isInverse():null===(r=t.getYAxisHelper())||void 0===r?void 0:r.isInverse())?1:0;switch(e){case"rect":case"symbol":a=o[s][l];break;default:a="top"}return a}var W3=function(){KF.registerGraphicComponent(j3.type,(function(t){return new qI(t)})),F3(),_U(),KF.registerComponent(j3.type,j3,!0)},G3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.specKey="markPoint",i.layoutZIndex=t.LayoutZIndex.MarkPoint,i}return M(i,e),i._getMarkerCoordinateType=function(t){var e=n3(t),i=e.doPolarProcess,n=e.doGeoProcess;return"polar"===t.coordinateType||i?"polar":"geo"===t.coordinateType||n?"geo":"cartesian"},i.prototype._createMarkerComponent=function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b,x,k,S,A,M,C,E,P,B,R,L,I=this._spec,D=I.itemContent,O=void 0===D?{}:D,F=I.itemLine,z=void 0===F?{}:F,H=I.targetSymbol,N=void 0===H?{}:H,V=O,j=V.type,U=void 0===j?"text":j,W=V.text,G=V.symbol,Y=V.image,X=V.richText,K=V.customMark,q=V.textStyle,Z=V.symbolStyle,J=V.imageStyle,Q=V.richTextStyle,$=V.customMarkStyle,tt=V.style,et=void 0===tt?{}:tt,it=V.state,nt=void 0===it?{}:it,rt=w(V,["type","text","symbol","image","richText","customMark","textStyle","symbolStyle","imageStyle","richTextStyle","customMarkStyle","style","state"]),at=null,ot=null;"text"===U?(at=null!==(t=null==W?void 0:W.state)&&void 0!==t?t:nt,ot=q2(gt({dx:0,dy:0},null!==(e=null!=W?W:q)&&void 0!==e?e:et),this._markerData,this._markAttributeContext)):"richText"===U?(at=null!==(i=null==X?void 0:X.state)&&void 0!==i?i:nt,ot=J2(gt({width:100,height:100},null!==(r=null!==(n=null==X?void 0:X.style)&&void 0!==n?n:Q)&&void 0!==r?r:et),this._markerData,this._markAttributeContext)):"symbol"===U?(at=null!==(a=null==G?void 0:G.state)&&void 0!==a?a:nt,ot=sH(J2(gt({symbolType:"star",fill:"rgb(48, 115, 242)",fillOpacity:.8,size:20},null!==(s=null!==(o=null==G?void 0:G.style)&&void 0!==o?o:Z)&&void 0!==s?s:et),this._markerData,this._markAttributeContext))):"image"===U?(at=null!==(l=null==Y?void 0:Y.state)&&void 0!==l?l:nt,ot=J2(gt({width:80,height:80},null!==(c=null!==(u=null==Y?void 0:Y.style)&&void 0!==u?u:J)&&void 0!==c?c:et),this._markerData,this._markAttributeContext)):"custom"===U&&(at=null!==(h=null==K?void 0:K.state)&&void 0!==h?h:nt,ot=J2(null!==(p=null!==(d=null==K?void 0:K.style)&&void 0!==d?d:$)&&void 0!==p?p:et,this._markerData,this._markAttributeContext));var st={zIndex:this.layoutZIndex,interactive:null===(f=this._spec.interactive)||void 0===f||f,hover:null===(v=this._spec.interactive)||void 0===v||v,select:null===(g=this._spec.interactive)||void 0===g||g,position:{x:0,y:0},clipInRange:null!==(y=this._spec.clip)&&void 0!==y&&y,itemContent:T(T({type:U,offsetX:Q2(O.offsetX,this._relativeSeries.getRegion()),offsetY:Q2(O.offsetX,this._relativeSeries.getRegion())},rt),{style:J2(ot,this._markerData,this._markAttributeContext)}),targetSymbol:{offset:null!==(m=N.offset)&&void 0!==m?m:0,visible:null!==(_=N.visible)&&void 0!==_&&_,size:null!==(b=N.size)&&void 0!==b?b:20,style:J2(N.style,this._markerData,this._markAttributeContext)},state:{line:Z2(null!==(k=null===(x=this._spec.itemLine.line)||void 0===x?void 0:x.state)&&void 0!==k?k:{},this._markerData,this._markAttributeContext),lineStartSymbol:Z2(null!==(A=null===(S=this._spec.itemLine.startSymbol)||void 0===S?void 0:S.state)&&void 0!==A?A:{},this._markerData,this._markAttributeContext),lineEndSymbol:Z2(null!==(C=null===(M=this._spec.itemLine.endSymbol)||void 0===M?void 0:M.state)&&void 0!==C?C:{},this._markerData,this._markAttributeContext),itemContent:Z2(at,this._markerData,this._markAttributeContext),textBackground:Z2(null===(P=null===(E=this._spec.itemContent.text)||void 0===E?void 0:E.labelBackground)||void 0===P?void 0:P.state,this._markerData,this._markAttributeContext),targetItem:Z2(null!==(R=null===(B=this._spec.targetSymbol)||void 0===B?void 0:B.state)&&void 0!==R?R:{},this._markerData,this._markAttributeContext)},animation:null!==(L=this._spec.animation)&&void 0!==L&&L,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate},lt=z.visible,ut=z.line,ct=void 0===ut?{}:ut,ht=w(z,["visible","line"]);return st.itemLine=!1!==lt?T(T({},ht),{visible:!0,lineStyle:sH(ct.style)}):{visible:!1},new $D(st)},i.prototype._markerLayout=function(){var t,e,i,n,r,a,o=this._spec,s=this._markerData,l=this._relativeSeries,u=this._computePointsAttr().point,c=this._getRelativeDataView().latestData,h=s?s.latestData[0]&&s.latestData[0].latestData?s.latestData[0].latestData:s.latestData:c;if(o.clip||(null===(t=o.itemContent)||void 0===t?void 0:t.confine)){var d=K2([l.getRegion()]),p=d.minX,f=d.maxX,v=d.minY;a={x:p,y:v,width:f-p,height:d.maxY-v}}if(this._markerComponent){var g=null!==(e=this._markerComponent.attribute)&&void 0!==e?e:{},y=null!==(n=null===(i=g.itemContent)||void 0===i?void 0:i.textStyle)&&void 0!==n?n:{};this._markerComponent.setAttributes({position:void 0===u?{x:null,y:null}:u,itemContent:T(T({},g.itemContent),{textStyle:T(T({},y),{text:(null===(r=this._spec.itemContent.text)||void 0===r?void 0:r.formatMethod)?this._spec.itemContent.text.formatMethod(h,c):y.text}),offsetX:$2(u,g.itemContent.offsetX,this._relativeSeries.getRegion()),offsetY:$2(u,g.itemContent.offsetY,this._relativeSeries.getRegion())}),limitRect:a,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}},i.prototype._initDataView=function(){var t=this._spec,e=n3(t),i=e.doXYProcess,n=e.doPolarProcess,r=e.doGeoProcess;(U(t.coordinate)||i||n||r)&&this._initCommonDataView()},i.specKey="markPoint",i}(l3),Y3={itemLine:{decorativeLine:{visible:!1},startSymbol:{size:5,visible:!0,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},endSymbol:{style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},line:{style:{stroke:{type:"palette",key:"markLineStrokeColor"}}}},itemContent:{offsetY:-50}},X3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=I.markPoint,e.name=I.markPoint,e.coordinateType="cartesian",e}return M(e,t),e.prototype._computePointsAttr=function(){var t,e,i,n,r=this._spec,a=this._markerData,o=this._relativeSeries,s=U(r.x)&&U(r.y),l=U(r.coordinate),u=U(r.position),c=null!==(t=null==r?void 0:r.autoRange)&&void 0!==t&&t;return s?n=null===(i=null===(e=j2(a,o,o,o,c))||void 0===e?void 0:e[0])||void 0===i?void 0:i[0]:l?n=W2(a,o,c,r.coordinatesOffset)[0]:u&&(n=X2(r.position,o,r.regionRelative)[0]),{point:n}},e.prototype._computeOptions=function(){var t,e=this._spec,i=n3(e).doXYProcess,n=U(e.coordinate);return i?t=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}])]:n&&(t=this._processSpecCoo(e)),{options:t}},e.type=I.markPoint,e.coordinateType="cartesian",e.builtInTheme={markPoint:Y3},e}(G3),K3=function(){KF.registerComponent(X3.type,X3),QD()},q3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=I.polarMarkPoint,e.name=I.polarMarkPoint,e.coordinateType="polar",e}return M(e,t),e.prototype._computePointsAttr=function(){var t,e,i=this._markerData,n=this._relativeSeries,r=U2(i,n,n,n,null!==(e=null===(t=this._spec)||void 0===t?void 0:t.autoRange)&&void 0!==e&&e)[0][0];return{point:Ve({x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y},r.radius,r.angle)}},e.prototype._computeOptions=function(){var t=this._spec;return{options:[this._processSpecByDims([{dim:"radius",specValue:t.radius},{dim:"angle",specValue:t.angle}])]}},e.type=I.polarMarkPoint,e.coordinateType="polar",e.builtInTheme={polarMarkPoint:Y3},e}(G3),Z3=function(){KF.registerComponent(q3.type,q3),QD()},J3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=I.geoMarkPoint,e.name=I.geoMarkPoint,e.coordinateType="geo",e}return M(e,t),e.prototype._computePointsAttr=function(){var t=function(t,e){var i=[];return(t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData).forEach((function(t){U(t.areaName)&&i.push([{x:e.nameValueToPosition(t.areaName).x+e.getRegion().getLayoutStartPoint().x,y:e.nameValueToPosition(t.areaName).y+e.getRegion().getLayoutStartPoint().y}])})),i}(this._markerData,this._relativeSeries)[0][0];return{point:t}},e.prototype._computeOptions=function(){var t=this._spec;return{options:[this._processSpecByDims([{dim:"areaName",specValue:t.areaName}])]}},e.type=I.geoMarkPoint,e.coordinateType="geo",e.builtInTheme={geoMarkPoint:Y3},e}(G3),Q3=function(){KF.registerComponent(J3.type,J3),QD()},$3={style:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",lineWidth:2},brushMode:"single",brushType:"rect",brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:0},t5="inBrush",e5="outOfBrush",i5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.layoutType="none",i.type=I.brush,i.name=I.brush,i.specKey="brush",i.layoutZIndex=t.LayoutZIndex.Brush,i._linkedSeries=[],i._itemMap={},i._linkedItemMap={},i._inBrushElementsMap={},i._outOfBrushElementsMap={},i._linkedInBrushElementsMap={},i._linkedOutOfBrushElementsMap={},i._cacheInteractiveRangeAttrs=[],i._releatedAxes=[],i._regionAxisMap={},i._axisDataZoomMap={},i._zoomRecord=[],i}return M(i,e),i.getSpecInfo=function(t){return _V(t,this.specKey,this.type,(function(t){return!1!==t.visible}))},i.prototype.init=function(){var e=this._transformBrushedMarkAttr(this._spec.inBrush),i=this._transformBrushedMarkAttr(this._spec.outOfBrush);this._option.getAllSeries().forEach((function(n){n.getActiveMarks().forEach((function(r){r&&(n.setMarkStyle(r,T({},e),t5,t.AttributeLevel.Series),n.setMarkStyle(r,T({},i),e5,t.AttributeLevel.Series))}))}))},i.prototype._initNeedOperatedItem=function(){var t=this,e=this._spec.seriesId,i=this._spec.seriesIndex;this._relativeRegions.forEach((function(n){var r=[];n.getSeries().forEach((function(a){(e&&St(e).includes(a.userId.toString())||i&&St(i).includes(a.getSpecIndex())||!i&&!e)&&r.push.apply(r,R([],B(a.getMarksWithoutRoot()),!1)),t._itemMap[n.id]=r}))})),this._linkedSeries.forEach((function(e){t._linkedItemMap[e.id]=e.getMarksWithoutRoot()}))},i.prototype.created=function(){e.prototype.created.call(this),this.initEvent(),this._bindRegions(),this._bindLinkedSeries(),this._initRegionAxisMap(),this._initAxisDataZoomMap(),this._initNeedOperatedItem()},i.prototype._bindRegions=function(){U(this._spec.regionId)||U(this._spec.regionIndex)?this._relativeRegions=this._option.getRegionsInUserIdOrIndex(St(this._spec.regionId),St(this._spec.regionIndex)):this._relativeRegions=this._option.getAllRegions()},i.prototype._bindLinkedSeries=function(){(U(this._spec.brushLinkSeriesId)||U(this._spec.brushLinkSeriesIndex))&&(this._linkedSeries=this._option.getSeriesInUserIdOrIndex(St(this._spec.brushLinkSeriesId),St(this._spec.brushLinkSeriesIndex)))},i.prototype._initRegionAxisMap=function(){var t=this;U(this._spec.axisId)?St(this._spec.axisId).forEach((function(e){t._releatedAxes.push(t._option.getComponentByUserId(e))})):U(this._spec.axisIndex)?St(this._spec.axisIndex).forEach((function(e){t._releatedAxes.push(t._option.getComponentByIndex("axes",e))})):this._releatedAxes=this._option.getComponentsByKey("axes"),this._releatedAxes.forEach((function(e){null==e||e.getRegions().forEach((function(i){t._regionAxisMap["region_"+i.id]?t._regionAxisMap["region_"+i.id].push(e):t._regionAxisMap["region_"+i.id]=[e]}))}))},i.prototype._initAxisDataZoomMap=function(){var t=this;this._option.getComponentsByKey("dataZoom").forEach((function(e){e.relatedAxisComponent&&(t._axisDataZoomMap[e.relatedAxisComponent.id]=e)}))},i.prototype.initEvent=function(){},i.prototype._compareSpec=function(t,i){var n=this;this._brushComponents&&this._relativeRegions.forEach((function(t,e){n._updateBrushComponent(t,e)}));var r=e.prototype._compareSpec.call(this,t,i);return bt(i,t)||(r.reRender=!0,r.reMake=!0),r},i.prototype.onLayoutEnd=function(){var t,i=this;(e.prototype.onLayoutEnd.call(this),this._option.disableTriggerEvent)||(null===(t=this._spec.visible)||void 0===t||t)&&(this._brushComponents?this._relativeRegions.forEach((function(t,e){i._updateBrushComponent(t,e)})):(this._brushComponents=[],this._relativeRegions.forEach((function(t,e){i._createBrushComponent(t,e)}))))},i.prototype._updateBrushComponent=function(t,e){var i=this._getBrushInteractiveAttr(t),n=this._brushComponents[e];n.setAttributes(i),this._initMarkBrushState(e,""),n.children[0].removeAllChild()},i.prototype._createBrushComponent=function(e,i){var n,r,a=this,o=this._getBrushInteractiveAttr(e),s=new VO(T(T(T({zIndex:this.layoutZIndex,brushStyle:sH(null===(n=this._spec)||void 0===n?void 0:n.style)},o),this._spec),{disableTriggerEvent:this._option.disableTriggerEvent}));s.id=null!==(r=this._spec.id)&&void 0!==r?r:"brush-".concat(this.id),this.getContainer().add(s),this._brushComponents.push(s),this._cacheInteractiveRangeAttrs.push(o),s.addEventListener(FO.brushActive,(function(n){a._initMarkBrushState(i,e5),a._emitEvent(t.ChartEvent.brushActive,e)})),s.addEventListener(FO.drawStart,(function(i){a._setRegionMarkPickable(e,!0),a._emitEvent(t.ChartEvent.brushStart,e)})),s.addEventListener(FO.moveStart,(function(i){a._setRegionMarkPickable(e,!0),a._emitEvent(t.ChartEvent.brushStart,e)})),s.addEventListener(FO.drawing,(function(i){a._setRegionMarkPickable(e,!1),a._handleBrushChange(e,i),a._emitEvent(t.ChartEvent.brushChange,e)})),s.addEventListener(FO.moving,(function(i){a._setRegionMarkPickable(e,!1),a._handleBrushChange(e,i),a._emitEvent(t.ChartEvent.brushChange,e)})),s.addEventListener(FO.brushClear,(function(n){a._setRegionMarkPickable(e,!0),a._initMarkBrushState(i,""),a._emitEvent(t.ChartEvent.brushClear,e)})),s.addEventListener(FO.drawEnd,(function(n){var r;a._setRegionMarkPickable(e,!0);var o=n.detail.operateMask,s=a._spec.updateElementsState,l=void 0===s||s;if(null===(r=a._spec)||void 0===r?void 0:r.onBrushEnd)!0===a._spec.onBrushEnd(n)?(a.clearGraphic(),a._initMarkBrushState(i,""),a._emitEvent(t.ChartEvent.brushClear,e)):(a._spec.onBrushEnd(n),a._emitEvent(t.ChartEvent.brushEnd,e));else{var u=a._extendDataInBrush(a._inBrushElementsMap);(!a._spec.zoomWhenEmpty&&u.length>0||!l)&&a._setAxisAndDataZoom(o,e),a._emitEvent(t.ChartEvent.brushEnd,e)}})),s.addEventListener(FO.moveEnd,(function(i){a._setRegionMarkPickable(e,!0);var n=i.detail.operateMask,r=a._spec.updateElementsState,o=void 0===r||r,s=a._extendDataInBrush(a._inBrushElementsMap);(!a._spec.zoomWhenEmpty&&s.length>0||o)&&a._setAxisAndDataZoom(n,e),a._emitEvent(t.ChartEvent.brushEnd,e)}))},i.prototype._getBrushInteractiveAttr=function(t){var e=t.getLayoutStartPoint(),i=t.getLayoutRect(),n=e.x,r=n+i.width,a=e.y,o=a+i.height;return{interactiveRange:{minY:a,maxY:o,minX:n,maxX:r},xRange:[n,r],yRange:[a,o]}},i.prototype._transformBrushedMarkAttr=function(t){var e={};return(null==t?void 0:t.symbol)&&(e.symbolType=t.symbol),(null==t?void 0:t.symbolSize)&&(e.size=t.symbolSize),(null==t?void 0:t.color)&&(e.fill=t.color),(null==t?void 0:t.colorAlpha)&&(e.fillOpacity=t.colorAlpha),T(T({},sH(t)),e)},i.prototype._handleBrushChange=function(t,e){var i=e.detail.operateMask,n=this._spec.updateElementsState;(void 0===n||n)&&(this._reconfigItem(i,t),this._reconfigLinkedItem(i,t))},i.prototype._extendDataInBrush=function(t){var e,i,n=[];for(var r in t)for(var a in t[r])n.push(T({},null===(i=null===(e=t[r][a].context)||void 0===e?void 0:e.data)||void 0===i?void 0:i[0]));return n},i.prototype._extendDatumOutOfBrush=function(t){var e,i,n=[];for(var r in t)n.push(null===(i=null===(e=t[r].context)||void 0===e?void 0:e.data)||void 0===i?void 0:i[0]);return n},i.prototype._emitEvent=function(t,e){var i;this.event.emit(t,{model:this,value:{operateType:t,operateRegion:e,inBrushData:this._extendDataInBrush(this._inBrushElementsMap),outOfBrushData:this._extendDatumOutOfBrush(this._outOfBrushElementsMap),linkInBrushData:this._extendDataInBrush(this._linkedInBrushElementsMap),linkOutOfBrushData:this._extendDatumOutOfBrush(this._linkedOutOfBrushElementsMap),inBrushElementsMap:this._inBrushElementsMap,outOfBrushElementsMap:this._outOfBrushElementsMap,linkedInBrushElementsMap:this._linkedInBrushElementsMap,linkedOutOfBrushElementsMap:this._linkedOutOfBrushElementsMap,zoomRecord:this._zoomRecord},vchart:null===(i=this._option)||void 0===i?void 0:i.globalInstance})},i.prototype._reconfigItem=function(t,e){var i,n,r,a=this;if((null==t?void 0:t.globalTransMatrix)&&(null===(i=null==t?void 0:t.attribute)||void 0===i?void 0:i.points)){var o=null!==(r=null===(n=null==t?void 0:t.attribute)||void 0===n?void 0:n.points)&&void 0!==r?r:[],s=t.globalTransMatrix,l=s.a,u=s.b,c=s.c,h=s.d,d=s.e,p=s.f,f=o.map((function(t){return{x:l*t.x+c*t.y+d,y:u*t.x+h*t.y+p}})),v=this._spec.markTypeFilter,g=void 0===v?[]:v;this._itemMap[e.id].forEach((function(e){if(!g.includes(e.type)){var i=e.getGraphics();i&&i.length&&i.forEach((function(i){var n,r,o,s=e.id+"_"+i.context.key,l=a._isBrushContainItem(t.globalAABBBounds,f,i);(null===(n=a._outOfBrushElementsMap)||void 0===n?void 0:n[s])&&l?(i.addState(t5,!0),a._inBrushElementsMap[null==t?void 0:t.name]||(a._inBrushElementsMap[null==t?void 0:t.name]={}),a._inBrushElementsMap[null==t?void 0:t.name][s]=i,delete a._outOfBrushElementsMap[s]):(null===(o=null===(r=a._inBrushElementsMap)||void 0===r?void 0:r[null==t?void 0:t.name])||void 0===o?void 0:o[s])&&!l&&(i.removeState(t5),i.addState(e5,!0),a._outOfBrushElementsMap[s]=i,delete a._inBrushElementsMap[t.name][s])}))}}))}},i.prototype._reconfigLinkedItem=function(t,e){var i,n=this;if((null==t?void 0:t.globalTransMatrix)&&(null===(i=null==t?void 0:t.attribute)||void 0===i?void 0:i.points)){var r=e.getLayoutStartPoint(),a=e.getSeries().map((function(t){return t.id}));this._linkedSeries.forEach((function(e){var i,o;if(!a.includes(e.id)){var s=e.getRegion().getLayoutStartPoint(),l=s.x-r.x,u=s.y-r.y,c=null!==(o=null===(i=null==t?void 0:t.attribute)||void 0===i?void 0:i.points)&&void 0!==o?o:[],h=t.globalTransMatrix,d=h.a,p=h.b,f=h.c,v=h.d,g=h.e,y=h.f,m=l||0,_=u||0,b=c.map((function(t){return{x:d*t.x+f*t.y+g+m,y:p*t.x+v*t.y+y+_}}));t.globalAABBBounds.clone().set(t.globalAABBBounds.x1+m,t.globalAABBBounds.y1+_,t.globalAABBBounds.x2+m,t.globalAABBBounds.y2+_);var x=n._spec.markTypeFilter,k=void 0===x?[]:x;n._linkedItemMap[e.id].forEach((function(e){if(!k.includes(e.type)){var i=e.getGraphics();i&&i.length&&i.forEach((function(i){var r,a,o;i.context.key;var s=e.id+"_"+i.context.key;(null===(r=n._linkedOutOfBrushElementsMap)||void 0===r?void 0:r[s])&&n._isBrushContainItem(t.globalAABBBounds,b,i)?(i.addState(t5,!0),n._linkedInBrushElementsMap[null==t?void 0:t.name]||(n._linkedInBrushElementsMap[null==t?void 0:t.name]={}),n._linkedInBrushElementsMap[null==t?void 0:t.name][s]=i,delete n._linkedOutOfBrushElementsMap[s]):(null===(o=null===(a=n._linkedInBrushElementsMap)||void 0===a?void 0:a[null==t?void 0:t.name])||void 0===o?void 0:o[s])&&!n._isBrushContainItem(t.globalAABBBounds,b,i)&&(i.removeState(t5),i.addState(e5,!0),n._linkedOutOfBrushElementsMap[s]=i)}))}}))}}))}},i.prototype._isBrushContainItem=function(t,e,i){if(["symbol","rect"].includes(i.type)){var n=null==i?void 0:i.globalAABBBounds,r=n.x1,a=n.x2,o=n.y1,s=n.y2;return function(t,e){for(var i=0;i<e.length;i++){if(li(t,e[i].x,e[i].y))return!0;if(i>0&&si(e[i-1].x,e[i-1].y,e[i].x,e[i].y,t))return!0}return!1}(e,[{x:r,y:o},{x:a,y:o},{x:a,y:s},{x:r,y:s}])}return t.intersects(i.globalAABBBounds)},i.prototype._initItemMap=function(t,e,i){var n=this._spec.markTypeFilter,r=void 0===n?[]:n;Object.entries(t).forEach((function(t){var n=B(t,2);n[0],n[1].forEach((function(t){if(!r.includes(t.type)){var n=t.getGraphics();n&&n.length&&n.forEach((function(n){var r=t.id+"_"+n.context.key;n.removeState(t5),n.removeState(e5),i&&n.addState(i,!0),e[r]=n}))}}))}))},i.prototype._initMarkBrushState=function(t,e){this._brushComponents.forEach((function(e,i){i!==t&&e.children[0].removeAllChild()})),this._inBrushElementsMap={},this._outOfBrushElementsMap={},this._linkedInBrushElementsMap={},this._linkedOutOfBrushElementsMap={},this._initItemMap(this._itemMap,this._outOfBrushElementsMap,e),this._initItemMap(this._linkedItemMap,this._linkedOutOfBrushElementsMap,e)},i.prototype._setRegionMarkPickable=function(t,e){t.getGroupMark().getGraphics().forEach((function(t){return t.setAttribute("childrenPickable",e)}))},i.prototype._stateClamp=function(t){return Math.min(Math.max(0,t),1)},i.prototype._setAxisAndDataZoom=function(t,e){var i,n=this;if(this._zoomRecord=[],this._spec.zoomAfterBrush){var r=t.AABBBounds;null===(i=this._regionAxisMap["region_"+e.id])||void 0===i||i.forEach((function(t){var i,a,o="bottom"===t.layoutOrient||"top"===t.layoutOrient,s=null!==(i=n._spec.axisRangeExpand)&&void 0!==i?i:0,l=r.x1,u=r.x2,c=r.y1,h=r.y2,d=o?"x":"y",p=o?l:c,f=o?u:h;if(n._axisDataZoomMap[t.id]){var v=n._axisDataZoomMap[t.id],g=v.relatedAxisComponent,y=g.getScale().invert(p-e.getLayoutStartPoint()[d]),m=g.getScale().invert(f-e.getLayoutStartPoint()[d]),_=v.dataToStatePoint(y),b=v.dataToStatePoint(m),x=n._stateClamp(_-s),k=n._stateClamp(b+s);v.setStartAndEnd(Math.min(x,k),Math.max(x,k),["percent","percent"]),n._zoomRecord.push({operateComponent:v,start:x,end:k,startValue:v.statePointToData(x),endValue:v.statePointToData(k)})}else{var S=t.getScale().range(),A=null!==(a=t.scaleRangeFactor())&&void 0!==a?a:[0,1],M=At(S)<S[0],T=p-e.getLayoutStartPoint()[d],w=f-e.getLayoutStartPoint()[d],C=M?Math.min(T,w):Math.max(T,w),E=M?Math.max(T,w):Math.min(T,w),P=(E-S[0])/(At(S)-S[0])*(A[1]-A[0])+A[0],B=(C-S[0])/(At(S)-S[0])*(A[1]-A[0])+A[0],R=n._stateClamp(P-s),L=n._stateClamp(B+s);t.scaleRangeFactor([R,L]),t.effect.scaleUpdate(),n._zoomRecord.push({operateComponent:t,start:R,end:L,startValue:t.getScale().invert(E),endValue:t.getScale().invert(C)})}}))}},i.prototype._getNeedClearVRenderComponents=function(){return this._brushComponents},i.prototype.clearGraphic=function(){this._brushComponents&&this._brushComponents.forEach((function(t){t._container.incrementalClearChild()}))},i.prototype.clear=function(){var t=this;if(this._brushComponents){var e=this.getContainer();this._brushComponents.forEach((function(i,n){t._initMarkBrushState(n,""),i.removeAllChild(),i.releaseBrushEvents(),e&&e.removeChild(i)})),this._brushComponents=null}},i.type=I.brush,i.builtInTheme={brush:$3},i.specKey="brush",i}(yU),n5=function(){KF.registerComponent(i5.type,i5)},r5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=I.customMark,i.specKey="customMark",i.layoutType="none",i.layoutZIndex=t.LayoutZIndex.CustomMark,i.layoutLevel=t.LayoutLevel.CustomMark,i}return M(i,e),i.prototype.created=function(){e.prototype.created.call(this),this.initMarks(),this.initEvent()},i.prototype.getMarkAttributeContext=function(){return this._markAttributeContext},i.prototype._buildMarkAttributeContext=function(){var t=this;this._markAttributeContext={vchart:this._option.globalInstance,globalScale:function(e,i){var n;return null===(n=t._option.globalScale.getScale(e))||void 0===n?void 0:n.scale(i)}}},i.prototype.initMarks=function(){var t=this;if(this._spec){var e=null;if(this._spec.parent){var i=this.getChart().getAllMarks().find((function(e){return e.getUserId()===t._spec.parent}));"group"===i.type&&(e=i)}this._createExtensionMark(this._spec,e,"".concat(mz,"_series_").concat(this.id,"_extensionMark"),0)}},i.prototype._createExtensionMark=function(t,e,i,n){var r,a,o=this;void 0===n&&(n=0);var s=this._createMark({type:t.type,name:U(t.name)?"".concat(t.name):"".concat(i,"_").concat(n)},{skipBeforeLayouted:!0,attributeContext:this._getMarkAttributeContext(),componentType:t.componentType,key:t.dataKey});if(s){if(U(t.id)&&s.setUserId(t.id),(null===(r=this._option.globalInstance)||void 0===r?void 0:r.isAnimationEnable())&&t.animation){var l=qV({},ZV(t.type,t,this._markAttributeContext));s.setAnimationConfig(l)}if(j(e)?this._marks.addMark(s):e&&e.addMark(s),this.initMarkStyleWithSpec(s,t),"group"===t.type&&(i="".concat(i,"_").concat(n),null===(a=t.children)||void 0===a||a.forEach((function(t,e){o._createExtensionMark(t,s,i,e)}))),U(t.dataId)||et(t.dataIndex)){var u=this.getChart().getSeriesData(t.dataId,t.dataIndex);u&&(u.target.addListener("change",(function(){s.getData().updateData()})),s.setDataView(u))}}},i.prototype.initEvent=function(){},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return bt(i,t)||(n.reMake=!0),n.change=!0,n.reRender=!0,n},i.prototype._getMarkAttributeContext=function(){var t=this;return{vchart:this._option.globalInstance,chart:this.getChart(),globalScale:function(e,i){var n;return null===(n=t._option.globalScale.getScale(e))||void 0===n?void 0:n.scale(i)},getLayoutBounds:function(){var e=t.getLayoutStartPoint(),i=e.x,n=e.y,r=t.getLayoutRect(),a=r.width,o=r.height;return(new mi).set(i,n,i+a,n+o)}}},i.prototype._getLayoutRect=function(){var t=new mi;return this.getMarks().forEach((function(e){var i=e.getProduct();i&&t.union(i.AABBBounds)})),t.empty()?{width:0,height:0}:{width:t.width(),height:t.height()}},i.prototype.getBoundsInRect=function(t){this.setLayoutRect(t);var e=this._getLayoutRect(),i=this.getLayoutStartPoint(),n=i.x,r=i.y;return{x1:n,y1:r,x2:n+e.width,y2:r+e.height}},i.prototype.getVRenderComponents=function(){var t=[],e=function(i){if(i&&"group"===i.type)i.getMarks().forEach((function(t){e(t)}));else if("component"===i.type){var n=null==i?void 0:i.getComponent();n&&t.push(n)}};return this.getMarks().forEach((function(t){e(t)})),t},i.type=I.customMark,i.specKey="customMark",i}(yU),a5=function(){KF.registerComponent(r5.type,r5)},o5=function(){function t(t,e){this._chartLayoutRect={x:0,y:0,width:1,height:1},this._col=1,this._row=1,this._elementMap=new Map,this.standardizationSpec(t),this._gridInfo=t,this._col=t.col,this._row=t.row,this._colSize=new Array(this._col).fill(null),this._rowSize=new Array(this._row).fill(null),this._colElements=new Array(this._col).fill([]),this._rowElements=new Array(this._row).fill([]),this._onError=null==e?void 0:e.onError,this.initUserSetting()}return t.prototype.standardizationSpec=function(t){var e,i,n;t.col=null!==(e=t.col)&&void 0!==e?e:1,t.row=null!==(i=t.row)&&void 0!==i?i:1,t.elements=null!==(n=t.elements)&&void 0!==n?n:[]},t.prototype.initUserSetting=function(){var t=this;this._gridInfo.colWidth&&this.setSizeFromUserSetting(this._gridInfo.colWidth,this._colSize,this._col,this._chartLayoutRect.width),this._gridInfo.rowHeight&&this.setSizeFromUserSetting(this._gridInfo.rowHeight,this._rowSize,this._row,this._chartLayoutRect.height),this._colSize.forEach((function(e,i){e||(t._colSize[i]={value:0,isUserSetting:!1,isLayoutSetting:!1})})),this._rowSize.forEach((function(e,i){e||(t._rowSize[i]={value:0,isUserSetting:!1,isLayoutSetting:!1})}))},t.prototype.setSizeFromUserSetting=function(t,e,i,n){t.forEach((function(t){t.index<0&&t.index>=i||(et(t.size)?e[t.index]={value:+t.size,isUserSetting:!0,isLayoutSetting:!1}:V(t.size)&&(e[t.index]={value:t.size(n),isUserSetting:!0,isLayoutSetting:!1}))}))},t.prototype.clearLayoutSize=function(){this._colSize.forEach((function(t){t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)})),this._rowSize.forEach((function(t){t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)}))},t.prototype.getItemGridInfo=function(t){var e,i,n=this._elementMap.get(t);return n||((i=null===(e=this._gridInfo.elements)||void 0===e?void 0:e.find((function(e){var i;if("modelId"in e&&U(e.modelId)){if(U(t.model.userId)&&t.model.userId===e.modelId)return!0}else if("modelKey"in e&&U(e.modelKey)&&"modelIndex"in e&&U(e.modelIndex)){if((null!==(i=t.model.specKey)&&void 0!==i?i:t.model.type)===e.modelKey&&t.model.getSpecIndex()===e.modelIndex)return!0}return!1})))||(i={col:0,colSpan:1,row:0,rowSpan:1}),this._elementMap.set(t,i),i)},t.prototype.getSizeFromGrid=function(t,e){for(var i,n="col"===e?this._colSize:this._rowSize,r=0,a=t[e];a<t[e]+(null!==(i=t["".concat(e,"Span")])&&void 0!==i?i:1);a++)r+=n[a].value;return r},t.prototype.getSizeFromUser=function(t,e){var i,n,r="col"===e?this._colSize:this._rowSize;if(null===(i=r[t[e]])||void 0===i?void 0:i.isUserSetting){for(var a=0,o=t[e];o<t[e]+(null!==(n=t["".concat(e,"Span")])&&void 0!==n?n:1);o++){if(!r[o].isUserSetting)return;a+=r[o].value}return a}},t.prototype.setItemLayoutSizeToGrid=function(t,e){if(s5(t)){if(e.colSpan&&e.colSpan>1)return;if(this._colSize[e.col].isUserSetting)return;this._colSize[e.col].value=Math.max(this._colSize[e.col].value,t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight),this._colSize[e.col].isLayoutSetting=!0}else{if(e.rowSpan&&e.rowSpan>1)return;if(this._rowSize[e.row].isUserSetting)return;this._rowSize[e.row].value=Math.max(this._rowSize[e.row].value,t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom),this._rowSize[e.row].isLayoutSetting=!0}},t.prototype.layoutGrid=function(t){var e="col"===t?this._colSize:this._rowSize,i="col"===t?this._chartLayoutRect.width:this._chartLayoutRect.height,n=[];e.forEach((function(t){t.isUserSetting||t.isLayoutSetting?i-=t.value:n.push(t)})),i<0&&console.warn("layout content ".concat(t," size bigger than chart")),n.forEach((function(t){return t.value=i/n.length}))},t.prototype.getItemPosition=function(t){for(var e=this.getItemGridInfo(t),i={x:this._chartLayoutRect.x,y:this._chartLayoutRect.y},n=0;n<e.col;n++)i.x+=this._colSize[n].value;for(var r=0;r<e.row;r++)i.y+=this._rowSize[r].value;return i.x+=t.layoutPaddingLeft+t.layoutOffsetX,i.y+=t.layoutPaddingTop+t.layoutOffsetY,i},t.prototype.getItemLayoutRect=function(t){var e,i,n=this.getItemGridInfo(t);return{width:(null!==(e=this.getSizeFromGrid(n,"col"))&&void 0!==e?e:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!==(i=this.getSizeFromGrid(n,"row"))&&void 0!==i?i:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom}},t.prototype.layoutItems=function(t,e,i,n){var r=this;this._chartLayoutRect=i,this._chartViewBox=n,this.clearLayoutSize(),e.sort((function(t,e){return e.layoutLevel-t.layoutLevel}));var a=e.filter((function(t){return"normal"===t.layoutType&&!1!==t.getModelVisible()})),o=a.filter((function(t){return s5(t)})),s=a.filter((function(t){return!s5(t)}));a.forEach((function(t){r.layoutOneItem(t,"user",!1)}));var l=e.filter((function(t){return"region-relative"===t.layoutType})),u=l.filter((function(t){return s5(t)})),c=l.filter((function(t){return!s5(t)}));u.forEach((function(t){return r.layoutOneItem(t,"user",!1)})),this.layoutGrid("col"),s.forEach((function(t){return r.layoutOneItem(t,"colGrid",!1)})),c.forEach((function(t){r.layoutOneItem(t,"colGrid",!1)})),this.layoutGrid("row"),c.forEach((function(t){r.layoutOneItem(t,"grid",!1)})),o.forEach((function(t){return r.layoutOneItem(t,"grid",!1)})),u.forEach((function(t){r.layoutOneItem(t,"grid",!0)})),this.layoutGrid("col"),e.filter((function(t){return"region"===t.layoutType})).forEach((function(t){return r.layoutOneItem(t,"grid",!1)})),this.layoutAbsoluteItems(e.filter((function(t){return"absolute"===t.layoutType}))),e.filter((function(t){return"absolute"!==t.layoutType})).forEach((function(t){t.setLayoutStartPosition(r.getItemPosition(t))}))},t.prototype.layoutAbsoluteItems=function(t){var e=this;t.forEach((function(t){t.absoluteLayoutInRect(e._chartLayoutRect)}))},t.prototype.layoutOneItem=function(t,e,i){var n,r,a="rowGrid"===e||"grid"===e?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),o="colGrid"===e||"grid"===e?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),s=this.getItemGridInfo(t),l={width:(null!==(n=o(s,"col"))&&void 0!==n?n:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!==(r=a(s,"row"))&&void 0!==r?r:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom},u=t.computeBoundsInRect(l);et(u.width)||(u.width=l.width),et(u.height)||(u.height=l.height),t.setLayoutRect("grid"!==e?u:l),this.setItemLayoutSizeToGrid(t,s)},t.type="grid",t}();function s5(t){return"left"===t.layoutOrient||"right"===t.layoutOrient}var l5=function(){KF.registerLayout(o5.type,o5)},u5=function(){yc.load(yE)},c5="vchart-tooltip",h5="".concat(c5,"-container"),d5="".concat(c5,"-title"),p5="".concat(c5,"-content-box"),f5={offsetX:10,offsetY:10},v5="99999999999999";function g5(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\(/g,"&#40;").replace(/  /g," &nbsp;")}var y5=function(t,e){return t?(e||(e=t.getBoundingClientRect()),t.offsetWidth>0?e.width/t.offsetWidth:t.offsetHeight>0?e.height/t.offsetHeight:1):1},m5=function(t){return K(t)&&""!==(null==t?void 0:t.trim())||Q(t)?g5(t):""},_5=function(t,e){var i;if(U(t))if(Q(t))i=t;else if(V(t)){var n=t(e);Q(n)&&(i=n)}return i},b5={left:[-2,0],right:[2,0],top:[0,-2],bottom:[0,2],insideTop:[0,-1.5],insideBottom:[0,1.5],insideLeft:[-1.5,0],insideRight:[1.5,0],insideTopLeft:[-1.5,-1.5],insideTopRight:[1.5,-1.5],insideBottomLeft:[-1.5,1.5],insideBottomRight:[1.5,1.5],lt:[-2,-2],tl:[-2,-2],rt:[2,-2],tr:[2,-2],bl:[-2,2],lb:[-2,2],br:[2,2],rb:[2,2],inside:[0,0],center:[0,0],centerBottom:[0,1],centerTop:[0,-1],centerLeft:[-1,0],centerRight:[1,0]},x5=function(t,e,i){var n,r;return void 0===i&&(i=2),null!==(r=null===(n=b5[t])||void 0===n?void 0:n["x"===e?0:1])&&void 0!==r?r:i},k5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._visible=!0,e._isReleased=!1,e.showTooltip=function(t,i,n){return n.changePositionOnly?e.changeTooltipPosition(n,i):e.changeTooltip(!0,n,i)},e.changeTooltip=function(t,i,n){return e._isReleased?1:t?e.changeTooltipPosition(i,n):(e._updateTooltip(!1,i),0)},e.changeTooltipPosition=function(t,i){var n,r,a,o,s;if(e._isReleased)return 1;var l=t.event,u=t.tooltipSpec,c=t.activeTooltipSpec,h=t.changePositionOnly;if(!c)return 1;var d=c.activeType;if(c.handler)return null!==(a=null===(r=(n=c.handler).showTooltip)||void 0===r?void 0:r.call(n,d,i,t))&&void 0!==a?a:0;var p=c,f=e._getActualTooltipPosition(c,t,e._getTooltipBoxSize(c,h));c.position=f;var v=null!==(o=c.updatePosition)&&void 0!==o?o:null===(s=u[d])||void 0===s?void 0:s.updatePosition;v&&(c.position=v(c.position,i,t));var g=!1!==(null==p?void 0:p.visible);return i&&"pointerout"!==l.type&&c.visible&&(c.title||c.content)||(g=!1),e._updateTooltip(g,T(T({},t),{changePositionOnly:h})),0},e._getActualTooltipPosition=function(t,i,n){var r,a,o,s,l,u,c,h,d,p=e._chartOption.getRectByDimensionData,f=i.tooltipSpec,v={x:1/0,y:1/0};if(!f)return v;var g,y=i.event,m=t.activeType,_=t.data,b="dimension"===m?null===(a=null===(r=_[0])||void 0===r?void 0:r.data)||void 0===a?void 0:a[0]:null==_?void 0:_[0],x=e._option,k=x.offsetX,S=x.offsetY,A=f[m],M=SV(null==A?void 0:A.position,_,i),T=null!==(o=SV(null==A?void 0:A.positionMode,_,i))&&void 0!==o?o:"mark"===m?"mark":"pointer",w=null!=n?n:{},C=w.width,E=void 0===C?0:C,P=w.height,B=void 0===P?0:P,R="canvas"===f.renderMode,L=null===(s=null==i?void 0:i.chart)||void 0===s?void 0:s.getCanvasRect(),I=null!==(l=null==L?void 0:L.width)&&void 0!==l?l:_z,D=null!==(u=null==L?void 0:L.height)&&void 0!==u?u:bz,O=!1,F={width:0,height:0},z={x:0,y:0},H={x:0,y:0},N=1,j=1,G=vx(e._env);if(G&&!f.confine?(F.width=window.innerWidth,F.height=window.innerHeight):(F.width=I,F.height=D),G&&!R){var Y=e._getParentElement(f);H=null!==(h=null===(c=null==Y?void 0:Y.getBoundingClientRect)||void 0===c?void 0:c.call(Y))&&void 0!==h?h:v;var X=null!==(d=e._compiler.getCanvas())&&void 0!==d?d:e._chartContainer;g=null==X?void 0:X.getBoundingClientRect(),z={x:g.x-H.x,y:g.y-H.y},N=y5(X,g),j=y5(Y,H)}var K,q=j/N,Z={},J={x:M,y:M},$={x:["left","right"],y:["top","bottom"]},tt=function(t,e){var n,r,a,o=t.orient,s=t.mode,l=t.offset,u=i.model,c=null==u?void 0:u.getLayoutStartPoint(),h=null!=l?l:"x"===e?k:S;if("mark"===s){O=!0;var d=i.item,f=null==d?void 0:d.AABBBounds;f&&c&&(r=("x"===e?f.x1:f.y1)+c[e],a=("x"===e?f.x2:f.y2)+c[e])}else if(p&&"crosshair"===s&&"cartesian"===(null===(n=null==b?void 0:b.series)||void 0===n?void 0:n.coordinate)&&b.datum&&b.datum.length){O=!0;var v=p(b,c);v&&(r=v.start[e],a=v.end[e])}else J[e]=o;if(O){var g=$[e][0],y="x"===e?E:B;switch(x5(o,e)){case-2:Z[g]=r-y*q-h;break;case-1.5:Z[g]=r+h;break;case 0:Z[g]=(r+a)/2-y*q/2;break;case-1:Z[g]=(r+a)/2-y*q-h;break;case 1:Z[g]=(r+a)/2+h;break;case 1.5:Z[g]=a-y*q-h;break;case 2:Z[g]=a+h}}},it=["x","y"];if(W(M))if(W(K=M)&&(U(K.left)||U(K.right)||U(K.top)||U(K.bottom))){var nt=M,rt=nt.left,at=nt.right,ot=nt.top,st=nt.bottom;Z.left=_5(rt,y),Z.top=_5(ot,y),Z.right=_5(at,y),Z.bottom=_5(st,y)}else(function(t){return W(t)&&(U(t.x)||U(t.y))})(M)&&it.forEach((function(t){var e=M[t];Q(e)||V(e)?Z[$[t][0]]=_5(e,y):tt(e,t)}));else U(M)&&(tt({orient:M,mode:T},"x"),tt({orient:M,mode:T},"y"));var lt={x:null,y:null};return it.forEach((function(t){var e,i="x"===t?E:B,n="x"===t?I:D,r="x"===t?k:S,a=x5(J[t],t);if(et(Z[$[t][0]]))lt[t]=Z[$[t][0]];else if(et(Z[$[t][1]]))lt[t]=n-i*q-Z[$[t][1]];else{var o="x"===t?y.canvasX:y.canvasY;lt[t]=a>0?o+r:0===a?o-i*q/2:o-i*q-r}lt[t]*=N,G&&(lt[t]+=z[t]),lt[t]/=j;var s="x"===t?F.width:F.height,l=f.confine?-(H[t]-(null!==(e=null==g?void 0:g[t])&&void 0!==e?e:0)/N)/j:-H[t]/j,u=s/j+l-i;2!==a&&lt[t]<l?O?lt[t]=l:(lt[t]+=0===a?r+i/2:2*r+i,lt[t]>u&&(lt[t]=u)):-2!==a&&lt[t]>u&&(O?lt[t]=u:(lt[t]-=0===a?r+i/2:2*r+i,lt[t]<l&&(lt[t]=l)))})),lt},e}return M(e,t),Object.defineProperty(e.prototype,"env",{get:function(){return this._env},enumerable:!1,configurable:!0}),e.prototype.onAdd=function(e){t.prototype.onAdd.call(this,e);var i=e.component;this._component=i,this._chartOption=i.getOption(),this._env=this._chartOption.mode,this._chartContainer=this._chartOption.globalInstance.getContainer(),this._compiler=i.getCompiler(),this._initFromSpec()},e.prototype.hideTooltip=function(t){return this.changeTooltip(!1,t)},e.prototype.release=function(){var t,e,i,n,r=null!==(e=null===(t=this._component)||void 0===t?void 0:t.getSpec())&&void 0!==e?e:{};r.handler?null===(n=(i=r.handler).release)||void 0===n||n.call(i):(this._removeTooltip(),this._isReleased=!0,this._chartOption=null,this._component=null)},e.prototype._getDefaultOption=function(){var t,e,i=this._component.getSpec().offset;return i?{offsetX:null!==(t=i.x)&&void 0!==t?t:f5.offsetX,offsetY:null!==(e=i.y)&&void 0!==e?e:f5.offsetY}:f5},e.prototype._getParentElement=function(t){return t.parentElement},e.prototype.getTooltipContainer=function(){return this._container},e.prototype._initFromSpec=function(){this._option=this._getDefaultOption()},e.prototype.reInit=function(){this._initFromSpec()},e.specKey="tooltip",e}(Uj),S5=function(t,e){return U(t)?q(t)?t.map((function(t){return"".concat(t,"px")})).join(" "):"".concat(t,"px"):null!=e?e:"initial"},A5=function(t,e){var i,n;void 0===t&&(t={}),void 0===e&&(e={}),U(t.fontFamily)&&(e.fontFamily=t.fontFamily);var r=null!==(i=t.fill)&&void 0!==i?i:t.fontColor;return U(r)&&(e.color=r),U(t.fontWeight)&&(e.fontWeight=t.fontWeight),U(t.textAlign)&&(e.textAlign=t.textAlign),U(t.fontSize)&&(e.fontSize=S5(t.fontSize)),U(t.maxWidth)&&(e.maxWidth=S5(t.maxWidth)),t.multiLine||U(t.maxWidth)&&!1!==t.multiLine?(e.whiteSpace="initial",e.wordBreak=null!==(n=t.wordBreak)&&void 0!==n?n:"break-word"):(e.wordBreak="normal",e.whiteSpace="nowrap"),e},M5=function(t){void 0===t&&(t={});var e=t.lineHeight;return t.fontSize?BF(e,t.fontSize):0},T5=function(t){var e,i=t.backgroundColor,n=t.border,r=t.shadow,a=t.padding,o={borderWidth:"".concat(null!==(e=null==n?void 0:n.width)&&void 0!==e?e:0,"px")},s=null;(null==n?void 0:n.color)&&(o.borderColor=n.color),i&&(o.backgroundColor=i),o.boxShadow=r?"".concat(r.x,"px ").concat(r.y,"px ").concat(r.blur,"px ").concat(r.spread,"px ").concat(r.color):"initial";var l=(null!=n?n:{}).radius;return U(l)&&(o.borderRadius=et(l)?"".concat(l,"px"):"".concat(l)),a&&(s=Di(a),o.padding=S5(s)),{panelStyle:o,panelPadding:s}};function w5(t,e){t&&t.style&&e&&Object.keys(e).forEach((function(i){t.style[i]=e[i]}))}var C5=function(t){KF.registerComponentPlugin(t.type,t)};var E5=function(t){function e(){var i=t.call(this,e.type)||this;return i.type=YW.dom,i._tooltipContainer=null==fx?void 0:fx.body,i}return M(e,t),e.prototype.getVisibility=function(){return!!this._rootDom&&"visible"===this._rootDom.style.visibility},e.prototype.setVisibility=function(t){t!==this.getVisibility()&&this._rootDom&&(this._rootDom.style.visibility=t?"visible":"hidden")},e.prototype.getRootDom=function(){return this._rootDom},e.prototype.onAdd=function(e){t.prototype.onAdd.call(this,e),this._initStyle(),this.initEl()},e.prototype.initEl=function(){var t=this._component.getSpec().parentElement;if(fx&&t&&t.children&&t.children.length){for(var e=0;e<t.children.length;e++)if(t.children[e].classList.contains(h5)){this._container=t.children[e];break}this._container||(this._container=fx.createElement("div"),this._container.style.position="relative",this._container.style.zIndex=v5,this._container.classList.add(h5),t.appendChild(this._container))}},e.prototype.initRootDom=function(){var t,e=this._component.getSpec(),i=document.createElement("div"),n=null===(t=this._chartOption)||void 0===t?void 0:t.getTheme("fontFamily");w5(i,T({left:"0",top:"0",pointerEvents:"none",padding:"12px",position:"absolute",zIndex:v5,fontFamily:null!=n?n:NF.fontFamily,fontSize:"11px",borderRadius:"3px",borderStyle:"solid",lineHeight:"initial",background:"#fff",boxShadow:"2px 2px 4px rgba(0, 0, 0, 0.1)",maxWidth:"100wh",maxHeight:"100vh",visibility:"hidden"},this._domStyle.panel)),i.classList.add(e.className),i.setAttribute("vchart-tooltip-id","".concat(this.id)),this._container.appendChild(i),this._rootDom=i},e.prototype._getTooltipBoxSize=function(t,e){var i;this._rootDom||this.initRootDom(),e||this._updateDomStringByCol(t),this._updateDomStyle("height",e);var n=null===(i=this._rootDom)||void 0===i?void 0:i.getBoundingClientRect();return{width:null==n?void 0:n.width,height:null==n?void 0:n.height}},e.prototype._removeTooltip=function(){this._rootDom&&this._rootDom.parentNode&&(this._rootDom.parentNode.removeChild(this._rootDom),this._rootDom=null),this._container=null},e.prototype._updateTooltip=function(t,e){var i,n;if(t&&this._rootDom){var r=e.tooltipSpec,a=e.activeTooltipSpec;e.changePositionOnly||(this._tooltipActual=a);var o=this._rootDom;if(o){var s=null!==(i=a.position)&&void 0!==i?i:{},l=s.x,u=void 0===l?0:l,c=s.y,h=void 0===c?0:c,d={x:u,y:h},p=this.getVisibility();r.updateElement&&(this._updatePosition(null!==(n=this._cacheCustomTooltipPosition)&&void 0!==n?n:{x:u,y:h}),r.updateElement(o,a,e),d=this._getActualTooltipPosition(a,e,{width:o.offsetWidth,height:o.offsetHeight}),this._cacheCustomTooltipPosition=d),!p&&t&&(this._rootDom.style.transition="none",this._updatePosition(d,!1),this._rootDom.getBoundingClientRect()),this._updatePosition(d)}this.setVisibility(t)}else this.setVisibility(t),this._cacheCustomTooltipPosition=void 0},e.prototype._initStyle=function(){var t=this._component.getSpec();this._domStyle=function(t){var e,i,n,r;void 0===t&&(t={});var a=t.style,o=void 0===a?{}:a,s=t.enterable,l=t.transitionDuration,u=o.panel,c=void 0===u?{}:u,h=o.titleLabel,d=o.shape,p=o.keyLabel,f=o.valueLabel,v=o.spaceRow,g=o.align,y=T5(c),m=y.panelStyle,_=y.panelPadding,b={marginTop:"0px",marginBottom:"0px"};m.pointerEvents=s?"auto":"none",l&&(m.transitionDuration=l?"".concat(l,"ms"):"initial",m.transitionProperty=l?"transform":"initial",m.transitionTimingFunction=l?"ease-out":"initial"),et(v)&&(b.marginBottom="".concat(v,"px"));var x={width:S5(null!==(e=null==d?void 0:d.size)&&void 0!==e?e:8)},k=A5(h),S=A5(p),A=A5(f),M="right"===g?"marginLeft":"marginRight";"right"===g&&(m.direction="rtl"),j(k.textAlign)&&(k.textAlign="right"===g?"right":"left"),j(S.textAlign)&&(S.textAlign="right"===g?"right":"left"),j(A.textAlign)&&(A.textAlign="right"===g?"left":"right"),x[M]=S5(null!==(i=d.spacing)&&void 0!==i?i:8),S[M]=S5(null!==(n=p.spacing)&&void 0!==n?n:26),A[M]=S5(null!==(r=f.spacing)&&void 0!==r?r:0);var T=Math.max(M5(f),M5(p));return b.lineHeight=T>0?"".concat(T,"px"):"20px",{panelPadding:_,row:b,panel:m,title:k,shape:x,key:S,value:A}}(t)},e.prototype._updateDomStringByCol=function(t){var e,i=this,n=t.title,r=void 0===n?{}:n,a=t.content,o=a&&a.length,s=this._domStyle.row,l=R([],B(this._rootDom.children),!1),u=l.find((function(t){return t.className.includes(d5)})),c=l.find((function(t){return t.className.includes(p5)}));if(!u&&!1!==r.visible){u=document.createElement("h2");var h=document.createElement("span");u.appendChild(h),u.classList.add(d5),this._rootDom.firstChild?this._rootDom.insertBefore(u,this._rootDom.firstChild):this._rootDom.appendChild(u)}u&&!1!==r.visible?(w5(u,T(T(T({},this._domStyle.title),o?s:{marginBottom:"0px"}),{marginTop:"0px"})),u.firstChild.innerHTML="".concat(null!==(e=r.value)&&void 0!==e?e:"")):u&&!1===r.visible&&u.parentNode.removeChild(u);var d=["shape","key","value"];if(!c&&o&&(c=document.createElement("div"),d.forEach((function(t){var e=document.createElement("div");e.classList.add("".concat(c5,"-column")),e.classList.add("".concat(c5,"-").concat(t,"-column")),e.setAttribute("data-col",t),c.appendChild(e)})),c.classList.add(p5),this._rootDom.appendChild(c)),c&&o){var p=R([],B(c.children),!1);w5(c,{whiteSpace:"nowrap"}),p.forEach((function(t,e){var n=t.getAttribute("data-col");if(n&&d.includes(n)){var r="shape"===n&&a.every((function(t){return!t.hasShape||!t.shapeType}));w5(t,T(T({},i._domStyle[n]),{display:r?"none":"inline-block",verticalAlign:"top"}));var o=R([],B(t.children),!1);o.slice(a.length).forEach((function(t){t.parentNode.removeChild(t)})),a.forEach((function(e,r){var l=o[r];l||((l=document.createElement("div")).classList.add("".concat(c5,"-").concat(n)),t.appendChild(l));var u=T({},s);r===a.length-1&&(u.marginBottom="0px"),u.display=!1===e.visible?"none":"block",u.height="initial","key"===n?(l.innerHTML=m5(e.key),e.keyStyle&&A5(e.keyStyle,u)):"value"===n?(l.innerHTML=m5(e.value),e.valueStyle&&A5(e.valueStyle,u)):"shape"===n&&(l.innerHTML=function(t,e){var i,n,r,a,o,s;if(!t||!t.hasShape||!t.shapeType)return"";var l,u,c='style="display:inline-block;vertical-align:middle;"',h=t.shapeType,d=t.shapeFill,p=t.shapeStroke,f=t.shapeHollow,v=void 0!==f&&f,g=null!==(i=t.shapeSize)&&void 0!==i?i:8,y=t.shapeLineWidth?g5(t.shapeLineWidth)+"px":"0px",m="currentColor",_=function(){return p?g5(p):m},b=g,x=function(t){return new Ov({symbolType:t,size:b,fill:!0})},k=x(h),S=k.getParsedPath();if(!S.path&&S.pathStr&&(k=x(S.pathStr)),k.getParsedPath().path){var A=k.getParsedPath().path;u=A.toString(),l=A.bounds}else S.isSvg&&S.svgCache&&(u=S.svgCache.map((function(t){return t.path.toString()})).join(),l=S.svgCache.reduce((function(t,e){return t.union(e.path.bounds)}),new mi));var M="".concat(l.x1," ").concat(l.y1," ").concat(l.width()," ").concat(l.height());if("0px"!==y){var T=B(M.split(" ").map((function(t){return Number(t)})),4),w=T[0],C=T[1],E=T[2],P=T[3],R=Number(y.slice(0,-2));M="".concat(w-R/2," ").concat(C-R/2," ").concat(E+R," ").concat(P+R)}if(!d||K(d)||v)return m=v?"none":d?g5(d):"currentColor","\n    <svg ".concat(c,' width="').concat(g,'" height="').concat(g,'" viewBox="').concat(M,'">\n      <path\n        d="').concat(u,'"\n        style="fill: ').concat(m,"; stroke: ").concat(_(),"; stroke-width: ").concat(y,'"\n      >\n      </path>\n    </svg>');if(W(d)){m="gradientColor"+(null!=e?e:"");var L="",I=(null!==(n=d.stops)&&void 0!==n?n:[]).map((function(t){return'<stop offset="'.concat(g5(t.offset.toString()),'" stop-color="').concat(g5(t.color),'"/>')})).join("");return"radial"===d.gradient?L='<radialGradient id="'.concat(m,'" cx="50%" cy="50%" r="50%" fx="0%" fy="0%">\n      ').concat(I,"\n      </radialGradient>"):"linear"===d.gradient&&(L='<linearGradient id="'.concat(m,'" x1="').concat(100*(null!==(r=d.x0)&&void 0!==r?r:0),'%" y1="').concat(100*(null!==(a=d.y0)&&void 0!==a?a:0),'%" x2="').concat(100*(null!==(o=d.x1)&&void 0!==o?o:0),'%" y2="').concat(100*(null!==(s=d.y1)&&void 0!==s?s:0),'%">\n      ').concat(I,"\n      </linearGradient>")),"\n    <svg ".concat(c,' width="').concat(g,'" height="').concat(g,'" viewBox="-0.5 -0.5 1 1">\n      ').concat(L,'\n      <path\n        d="').concat(u,'"\n        style="fill: url(#').concat(m,"); stroke: ").concat(_(),"; stroke-width: ").concat(y,'"\n      >\n      </path>\n    </svg>')}return""}(e,"".concat(i.id,"_").concat(r))),w5(l,u)}))}}))}else c&&!o&&c.parentNode.removeChild(c)},e.prototype._updateDomStyle=function(t,e){var i,n,r,a,o;void 0===t&&(t="width");var s=this._rootDom,l=R([],B(s.children),!1).find((function(t){return t.className.includes(p5)})),u=R([],B(s.children),!1).find((function(t){return t.className.includes(d5)}));if(l){var c=this._component.getSpec(),h={},d=null===(i=c.style)||void 0===i?void 0:i.titleLabel;if(d&&d.autoWidth&&!1!==d.multiLine&&u){var p=R([],B(l.children),!1).reduce((function(e,i){return"height"===t?e+i.getBoundingClientRect().width:Math.max(e,i.getBoundingClientRect().width)}),0);p>0&&(u.style.maxWidth="".concat(p,"px"),u.style.maxWidth="".concat(Math.ceil(l.getBoundingClientRect().width),"px"))}if(U(null===(n=null==c?void 0:c.style)||void 0===n?void 0:n.maxContentHeight)){var f=u&&u.className.includes(d5)?u.getBoundingClientRect().height+(null!==(r=c.style.spaceRow)&&void 0!==r?r:0):0,v=this._chartOption.getChartViewRect(),g=BF(c.style.maxContentHeight,Math.min(v.height,document.body.clientHeight)-f-(this._domStyle.panelPadding?this._domStyle.panelPadding[0]+this._domStyle.panelPadding[1]:0));g>0&&(h.maxHeight="".concat(g,"px"),h.overflowY="auto",h.width="calc(100% + ".concat(this._domStyle.panelPadding?this._domStyle.panelPadding[1]+"px":"10px",")"),w5(l,h))}var y=l.children,m=[];if(y){for(var _=0;_<y.length;_++)for(var b=null!==(a=y[_].children)&&void 0!==a?a:[],x=0;x<b.length;x++){e&&(b[x].style[t]="initial");var k=b[x].getBoundingClientRect()[t];(void 0===m[x]||m[x]<k)&&(m[x]=k)}for(_=0;_<y.length;_++)for(b=null!==(o=y[_].children)&&void 0!==o?o:[],x=0;x<b.length;x++)b[x].style[t]="".concat(m[x],"px")}}},e.prototype._getParentElement=function(e){var i;return null!==(i=this._container)&&void 0!==i?i:t.prototype._getParentElement.call(this,e)},e.prototype.isTooltipShown=function(){return this.getVisibility()},e.prototype.reInit=function(){t.prototype.reInit.call(this),this._initStyle(),this._rootDom&&w5(this._rootDom,this._domStyle.panel),this.getVisibility()&&(this._updateDomStringByCol(this._tooltipActual),this._updateDomStyle("height",!1))},e.prototype._updatePosition=function(t,e){var i=t.x,n=t.y;void 0===e&&(e=!0),this._rootDom&&(this._rootDom.style.transform="translate3d(".concat(i,"px, ").concat(n,"px, 0)"),e&&""!==this._rootDom.style.transition&&(this._rootDom.style.transition="",Object.assign(this._rootDom.style,this._domStyle.panel)))},e.type=YW.dom,e}(k5),P5=function(){C5(E5)},B5={fontFamily:NF.fontFamily,spacing:10,wordBreak:"break-word"},R5=function(t,e){var i,n,r;"rich"!==(null==t?void 0:t.type)&&"html"!==(null==t?void 0:t.type)?(t=(null!=t?t:"").toString(),n=e.multiLine?(n=t.split("\n")).map((function(t,e){return e<n.length-1?t+"\n":t})):[t],r=n.map((function(t){return T(T({},e),{text:t})}))):(r=t.text,n=t);var a,o=(a={wordBreak:null!==(i=e.wordBreak)&&void 0!==i?i:"break-word",maxWidth:e.maxWidth?e.maxWidth:void 0,width:0,height:0,textConfig:r},xg||(xg=kg.CreateGraphic("richtext",{})),xg.setAttributes(a),xg.AABBBounds);return{width:o.width(),height:o.height(),text:n}};function L5(t,e,i){var n,r;return void 0===t&&(t={}),T(T({},null!=i?i:B5),{fill:null!==(n=t.fill)&&void 0!==n?n:t.fontColor,textAlign:t.textAlign,textBaseline:t.textBaseline,fontFamily:null!==(r=t.fontFamily)&&void 0!==r?r:e,fontSize:t.fontSize,fontWeight:t.fontWeight,lineHeight:t.lineHeight,spacing:t.spacing,multiLine:U(t.maxWidth)?!1!==t.multiLine:t.multiLine,maxWidth:t.maxWidth,wordBreak:t.wordBreak,autoWidth:t.autoWidth})}var I5=function(t){var e,i=t.backgroundColor,n=t.border,r=t.shadow,a={lineWidth:null!==(e=null==n?void 0:n.width)&&void 0!==e?e:0,shadow:!!r};(null==n?void 0:n.color)&&(a.stroke=n.color),i&&(a.fill=i),r&&(a.shadowColor=r.color,a.shadowBlur=r.blur,a.shadowOffsetX=r.x,a.shadowOffsetY=r.y,a.shadowSpread=r.spread);var o=(null!=n?n:{}).radius;return U(o)&&(a.cornerRadius=[o,o,o,o]),a},D5=function(t){function e(){var i=t.call(this,e.type)||this;return i.type=YW.canvas,i._attributes=null,i}return M(e,t),e.prototype.onAdd=function(e){var i;t.prototype.onAdd.call(this,e),this._tooltipCanvasId=null===(i=this._chartOption.modeParams)||void 0===i?void 0:i.tooltipCanvasId},e.prototype._initTooltipComponent=function(t){var e=this._getLayer(t);this._tooltipComponent=new YO({autoCalculatePosition:!1,autoMeasure:!1}),e.add(this._tooltipComponent)},e.prototype._getLayer=function(t){if(this._layer)return this._layer;this._layer=t.createLayer(this._tooltipCanvasId);var e=this._layer.layerHandler.canvas.nativeCanvas;return e&&e.style&&(e.style.touchAction="none",e.style.pointerEvents="none"),this._layer},e.prototype._getTooltipBoxSize=function(t,e){var i,n;if(!e||j(this._attributes)){var r=null===(i=this._chartOption)||void 0===i?void 0:i.getTheme("fontFamily");this._attributes=function(t,e,i){var n,r,a,o,s,l=e.style,u=void 0===l?{}:l,c=e.enterable,h=e.transitionDuration,d=u.panel,p=void 0===d?{}:d,f=u.titleLabel,v=u.shape,g=u.keyLabel,y=u.valueLabel,m=u.spaceRow,_=u.align,b=Di(p.padding),x=IF(p.padding),k=L5(T({textAlign:"right"===_?"right":"left"},f),i),S=L5(T({textAlign:"right"===_?"right":"left"},g),i),A=L5(y,i),M={fill:!0,size:null!==(n=null==v?void 0:v.size)&&void 0!==n?n:8,spacing:null!==(r=null==v?void 0:v.spacing)&&void 0!==r?r:6},w={panel:I5(p),padding:b,title:{},content:[],titleStyle:{value:k,spaceRow:m},contentStyle:{shape:M,key:S,value:A,spaceRow:m},hasContentShape:!1,keyWidth:0,valueWidth:0,enterable:c,transitionDuration:h,align:_},C=t.title,E=void 0===C?{}:C,P=t.content,B=void 0===P?[]:P,R=x.left+x.right,L=x.top+x.bottom,I=0,D=!!B.length,O=0,F=0,z=0,H=0;if(D){var N=[],V=[],j=[],W=[],G=0;w.content=B.map((function(t,e){var i=0,n=t.hasShape,r=t.key,a=t.shapeType,o=void 0===a?"":a,s=t.shapeFill,l=t.shapeStroke,u=t.shapeLineWidth,c=t.shapeSize,h=t.value,d=t.isKeyAdaptive,p=t.spaceRow,f=t.keyStyle,v=t.valueStyle,g=t.shapeHollow,y={height:0,spaceRow:null!=p?p:m};if(U(r)){var _=XF({},S,L5(f,void 0,{})),b=R5(r,_),x=b.width,k=b.height,w=b.text;y.key=T(T({width:x,height:k},_),{text:w}),d?V.push(x):N.push(x),i=Math.max(i,k)}if(U(h)){var C=XF({},A,L5(v,void 0,{})),E=R5(h,C);x=E.width,k=E.height,w=E.text,y.value=T(T({width:x,height:k},C),{text:w}),j.push(x),i=Math.max(i,k)}if(n){var P={visible:!0,symbolType:o};g?P.stroke=s:P.fill=s,P.stroke=null!=l?l:s,P.lineWidth=u,y.shape=P;var R=null!=c?c:M.size;i=Math.max(R,i),W.push(R)}else y.shape={visible:!1};return y.height=i,G+=i,e<B.length-1&&(G+=y.spaceRow),y})),L+=G,O=N.length?Mt(N):0,F=V.length?Mt(V):0,z=j.length?Mt(j):0,H=W.length?Mt(W)+M.spacing:0,I=Math.max(H+O+S.spacing+z+A.spacing,H+F,I),w.hasContentShape=!!W.length,w.keyWidth=O,w.valueWidth=z}var Y=0,X=0,K=0,q=E.visible,Z=void 0===q||q,J=E.value,Q=void 0===J?"":J,$=E.valueStyle,tt=E.spaceRow;w.title.visible=Z,w.title.spaceRow=null!=tt?tt:m;var et={},it=function(){return et.autoWidth&&!1!==et.multiLine};if(Z){et=XF({},k,L5($,void 0,{})),it()&&(et.multiLine=null===(a=et.multiLine)||void 0===a||a,et.maxWidth=null!==(o=et.maxWidth)&&void 0!==o?o:D?Math.ceil(I):void 0);var nt=R5(Q,et),rt=nt.text,at=nt.width,ot=nt.height;w.title.value=T(T({width:it()?Math.min(at,null!==(s=et.maxWidth)&&void 0!==s?s:Number.MAX_VALUE):at,height:ot},et),{text:rt}),Y=w.title.value.width,K=(X=w.title.value.height)+(D?w.title.spaceRow:0)}return L+=K,w.title.width=Y,w.title.height=X,it()?R+=I||Y:R+=Math.max(Y,I),D&&w.content.forEach((function(t){var e,i=t.value;i&&(null===(e=i.autoWidth)||void 0===e||e)&&(i.width=R-x.left-x.right-H-O-S.spacing-A.spacing,i.maxWidth||(i.maxWidth=Math.ceil(i.width)),w.valueWidth=Math.max(w.valueWidth,i.width))})),w.panel.width=R,w.panel.height=L,w}(t,this._component.getSpec(),r)}var a=(null!==(n=this._attributes)&&void 0!==n?n:{}).panel;return{width:a.width+a.lineWidth,height:a.height+a.lineWidth}},e.prototype._removeTooltip=function(){this._layer&&this._layer.removeAllChild(),this._attributes=null},e.prototype._updateTooltip=function(t,e){this._visible=t;var i=this._compiler.getStage();if(i)if(t){this._tooltipComponent||this._initTooltipComponent(i);var n=e.activeTooltipSpec.position;e.changePositionOnly?U(n)&&this._tooltipComponent.setAttributes(n):this._tooltipComponent.setAttributes(T(T({},this._attributes),n)),this._tooltipComponent.attribute.visible||(this._tooltipComponent.showAll(),this._tooltipComponent.setAttributes({visibleAll:!0}))}else this._tooltipComponent&&this._tooltipComponent.attribute.visible&&(this._tooltipComponent.hideAll(),this._tooltipComponent.setAttributes({visibleAll:!1}))},e.prototype.isTooltipShown=function(){var t;return null===(t=this._tooltipComponent)||void 0===t?void 0:t.attribute.visibleAll},e.prototype.release=function(){var e;t.prototype.release.call(this),null===(e=this._layer)||void 0===e||e.release()},e.type=YW.canvas,e}(k5),O5=function(){C5(D5)},F5=function(t){KF.registerChartPlugin(t.type,t)},z5=/\{([^}]+)\}/,H5=/\{([^}]+)\}/g,N5=/:/,V5=function(t){function e(){var i=t.call(this,e.type)||this;return i.type="formatterPlugin",i._timeModeFormat={utc:Xi.getInstance().timeUTCFormat,local:Xi.getInstance().timeFormat},i._formatter=i._format,i._timeFormatter=i._timeModeFormat.local,i._numericFormatter=tn.getInstance().format,i._numericSpecifier=tn.getInstance().formatter,i._numericFormatterCache=new Map,i._isNumericFormatterCache=new Map,i}return M(e,t),e.prototype.onInit=function(t,i){var n;if(t.globalInstance){this._spec=null!==(n=null==i?void 0:i[e.specKey])&&void 0!==n?n:{};var r=this._spec,a=r.timeMode,o=r.customFormatter,s=r.numericFormatter,l=r.timeFormatter;V(o)?this._formatter=o:(this._formatter=this._format.bind(this),V(l)?this._timeFormatter=l:a&&this._timeModeFormat[a]&&(this._timeFormatter=this._timeModeFormat[a]),s&&(this._numericFormatter=s,this._numericSpecifier=null,this._numericFormatterCache=null)),KF.registerFormatter(this._formatter)}},e.prototype._format=function(t,e,i){var n=this;return q(t)?t.map((function(t,r){var a=q(i)?i[r]:i;return a?n._formatSingleLine(t,e,a):t})):q(i)?i.map((function(i){return n._formatSingleLine(t,e,i)})):this._formatSingleLine(t,e,i)},e.prototype._formatSingleLine=function(t,e,i){var n,r=this;if(this._isNumericFormatterCache&&(this._isNumericFormatterCache.get(i)?n=this._isNumericFormatterCache.get(i):(n=z5.test(i),this._isNumericFormatterCache.set(i,n))),n){var a=i.replace(H5,(function(t,i){if(!N5.test(i)){var n=e[i.trim()];return void 0!==n?n:t}var a=i.split(":"),o=e[a.shift()],s=a.join(":");return r._formatSingleText(o,s)}));return a}return this._formatSingleText(t,i)},e.prototype._formatSingleText=function(t,e){if(Ji.test(e)&&this._numericFormatter){var i=void 0;return this._numericFormatterCache&&this._numericSpecifier?(this._numericFormatterCache.get(e)?i=this._numericFormatterCache.get(e):(i=this._numericSpecifier(e),this._numericFormatterCache.set(e,i)),i(Number(t))):this._numericFormatter(e,Number(t))}return e.includes("%")&&this._timeFormatter?this._timeFormatter(e,t):t},e.prototype.release=function(){t.prototype.release.call(this),this._format=null,this._timeFormatter=null,this._numericFormatter=null,this._numericSpecifier=null,this._numericFormatterCache=null,this._isNumericFormatterCache=null},e.pluginType="chart",e.specKey="formatter",e.type="formatterPlugin",e}(Uj),j5=function(){F5(V5)},U5={state:t.STATE_VALUE_ENUM.STATE_ACTIVE,trigger:"pointerover",triggerOff:"pointerout"},W5=function(t){function e(e){var i=t.call(this,e)||this;return i.type="element-active",i.handleStart=function(t){i.start(t.item)},i.handleReset=function(t){i.reset(t.item)},i.options=Object.assign({},U5,e),i.updateMarkIdByState([i.options.state]),i}return M(e,t),e.prototype.getEvents=function(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]},e.prototype.getStartState=function(){return this.options.state},e.prototype.start=function(t){if(t){var e=this.options,i=e.state,n=e.interaction;this.isGraphicInStateMark(t,i)&&(t.addState(i,!0),n.setStatedGraphics(this,[t]))}},e.prototype.reset=function(t){var e=this.options,i=e.interaction,n=e.state,r=i.getStatedGraphics(this),a=null!=t?t:null==r?void 0:r[0];a&&r.includes(a)&&(a.removeState(n),i.setStatedGraphics(this,r.filter((function(t){return t!==a}))))},e.type="element-active",e.defaultOptions=U5,e}(aV),G5=function(){KF.registerInteractionTrigger(W5.type,W5)},Y5="element-active-by-legend",X5={state:t.STATE_VALUE_ENUM.STATE_ACTIVE,filterType:"groupKey"},K5=function(e){function i(t){var i=e.call(this,t)||this;return i.type=Y5,i.handleStart=function(t){var e,n,r=t.event;r&&i.start(null===(n=null===(e=r.detail)||void 0===e?void 0:e.data)||void 0===n?void 0:n.id)},i.handleReset=function(t){i.resetAll()},i.options=Object.assign({},X5,t),i.updateMarkIdByState([i.options.state]),i}return M(i,e),i.prototype.getEvents=function(){return[{type:t.ChartEvent.legendItemHover,handler:this.handleStart},{type:t.ChartEvent.legendItemUnHover,handler:this.handleReset}]},i.prototype.getStartState=function(){return this.options.state},i.prototype.start=function(t){if(!j(t)){var e=this.options,i=e.interaction,n=e.state,r=nV(this.options),a=i.getStatedGraphics(this),o=[];this.getMarks().forEach((function(e){var i;null===(i=e.getGraphics())||void 0===i||i.forEach((function(e){r(e)===t&&o.push(e)}))})),i.updateStates(this,o,a,n),i.setStatedGraphics(this,o)}},i.prototype.resetAll=function(){var t=this.options,e=t.interaction,i=t.state;e.clearAllStatesOfTrigger(this,i),e.setStatedGraphics(this,[])},i.prototype.reset=function(t){var e=this.options,i=e.state,n=e.interaction;if(t){var r=n.getStatedGraphics(this);r&&r.includes(t)&&(t.removeState(i),n.setStatedGraphics(this,r.filter((function(e){return e!==t}))))}else this.resetAll()},i.type=Y5,i.defaultOptions=X5,i}(aV),q5=function(){KF.registerInteractionTrigger(Y5,K5)},Z5="element-highlight-by-group",J5=function(t){function e(e){var i=t.call(this,e)||this;return i.type=Z5,i.handleStart=function(t){i.start(t.item)},i.handleReset=function(t){var e=t.item;e&&i.isGraphicInMark(e)&&i.resetAll()},i.options=Object.assign({},rV,e),i.updateMarkIdByState([i.options.highlightState,i.options.blurState]),i}return M(e,t),e.prototype.getStartState=function(){return this.options.highlightState},e.prototype.getResetState=function(){return this.options.blurState},e.prototype.getEvents=function(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]},e.prototype.resetAll=function(){var t=this.options,e=t.interaction,i=t.highlightState,n=t.blurState;e.clearAllStatesOfTrigger(this,i,n),e.setStatedGraphics(this,[])},e.prototype._getHightlightKey=function(t){var e;return null===(e=t.context)||void 0===e?void 0:e.groupKey},e.prototype.start=function(t){var e=this;if(t&&this.isGraphicInMark(t)){var i=this._getHightlightKey(t);if(j(i))return;var n=this.options,r=n.interaction,a=n.highlightState,o=n.blurState,s=r.getStatedGraphics(this),l=[];this.getMarks().forEach((function(t){var n;null===(n=t.getGraphics())||void 0===n||n.forEach((function(t){e._getHightlightKey(t)===i&&l.push(t)}))})),r.updateStates(this,l,s,a,o),r.setStatedGraphics(this,l)}},e.prototype.reset=function(t){if(t){if(this.isGraphicInMark(t)){var e=this.options.interaction,i=e.getStatedGraphics(this);t.removeState([this.options.highlightState,this.options.blurState]),e.setStatedGraphics(this,i.filter((function(e){return e!==t})))}}else this.resetAll()},e.type=Z5,e.defaultOptions=rV,e}(aV),Q5=function(){KF.registerInteractionTrigger(Z5,J5)},$5="element-highlight-by-key",t4=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=$5,e}return M(e,t),e.prototype._getHightlightKey=function(t){var e;return null===(e=t.context)||void 0===e?void 0:e.key},e.type=$5,e}(J5),e4=function(){KF.registerInteractionTrigger($5,t4)},i4="element-highlight-by-legend",n4={highlightState:t.STATE_VALUE_ENUM.STATE_HIGHLIGHT,blurState:t.STATE_VALUE_ENUM.STATE_BLUR,filterType:"groupKey"},r4=function(e){function i(t){var i=e.call(this,t)||this;return i.type=i4,i.handleStart=function(t){var e,n,r=t.event;r&&i.start(null===(n=null===(e=r.detail)||void 0===e?void 0:e.data)||void 0===n?void 0:n.id)},i.handleReset=function(t){i.resetAll()},i.options=Object.assign({},n4,t),i.updateMarkIdByState([i.options.highlightState,i.options.blurState]),i}return M(i,e),i.prototype.getStartState=function(){return this.options.highlightState},i.prototype.getResetState=function(){return this.options.blurState},i.prototype.getEvents=function(){return[{type:t.ChartEvent.legendItemHover,handler:this.handleStart},{type:t.ChartEvent.legendItemUnHover,handler:this.handleReset}]},i.prototype.start=function(t){if(t){var e=nV(this.options),i=this.options,n=i.interaction,r=i.highlightState,a=i.blurState,o=n.getStatedGraphics(this),s=[];this.getMarks().forEach((function(i){var n;null===(n=i.getGraphics())||void 0===n||n.forEach((function(i){e(i)===t&&s.push(i)}))})),n.updateStates(this,s,o,r,a),n.setStatedGraphics(this,s)}},i.prototype.resetAll=function(){var t=this.options,e=t.interaction,i=t.highlightState,n=t.blurState;e.clearAllStatesOfTrigger(this,i,n),e.setStatedGraphics(this,[])},i.prototype.reset=function(t){var e=this.options,i=e.highlightState,n=e.blurState,r=e.interaction;if(t){var a=r.getStatedGraphics(this);a&&a.includes(t)&&(t.removeState([i,n]),r.setStatedGraphics(this,a.filter((function(e){return e!==t}))))}else this.resetAll()},i.type=i4,i.defaultOptions=n4,i}(aV),a4=function(){KF.registerInteractionTrigger(i4,r4)},o4="element-highlight-by-name",s4={highlightState:t.STATE_VALUE_ENUM.STATE_HIGHLIGHT,blurState:t.STATE_VALUE_ENUM.STATE_BLUR,filterType:"groupKey"},l4=function(t){function e(e){var i=t.call(this,e)||this;return i.type=o4,i.handleStart=function(t){if(i.options.shouldStart?i.options.shouldStart(t):i._filterByName(t)){var e=i._parseTargetKey(t);i.start(e)}},i.handleReset=function(t){(i.options.shouldReset?i.options.shouldReset(t):i._filterByName(t))&&i.resetAll()},i.options=Object.assign({},s4,e),i.updateMarkIdByState([i.options.highlightState,i.options.blurState]),i}return M(e,t),e.prototype.getStartState=function(){return this.options.highlightState},e.prototype.getResetState=function(){return this.options.blurState},e.prototype.getEvents=function(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]},e.prototype._filterByName=function(t){var e,i=St(this.options.graphicName);return(null===(e=null==t?void 0:t.node)||void 0===e?void 0:e.name)&&i.includes(t.node.name)},e.prototype._parseTargetKey=function(t){return this.options.parseData?this.options.parseData(t):"text"===t.node.type?t.node.attribute.text:null},e.prototype.start=function(t){if(t){var e=nV(this.options),i=this.options,n=i.interaction,r=i.highlightState,a=i.blurState,o=n.getStatedGraphics(this),s=[];this.getMarks().forEach((function(i){var n;null===(n=i.getGraphics())||void 0===n||n.forEach((function(i){e(i)===t&&s.push(i)}))})),n.updateStates(this,s,o,r,a),n.setStatedGraphics(this,s)}},e.prototype.resetAll=function(){var t=this.options,e=t.interaction,i=t.highlightState,n=t.blurState;e.clearAllStatesOfTrigger(this,i,n),e.setStatedGraphics(this,[])},e.prototype.reset=function(t){var e=this.options,i=e.highlightState,n=e.blurState,r=e.interaction;if(t){var a=r.getStatedGraphics(this);a&&a.includes(t)&&(t.removeState([i,n]),r.setStatedGraphics(this,a.filter((function(e){return e!==t}))))}else this.resetAll()},e.type=o4,e.defaultOptions=s4,e}(aV),u4=function(){KF.registerInteractionTrigger(o4,l4)},c4=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return M(e,t),e.prototype._getDefaultStyle=function(){return T(T({},t.prototype._getDefaultStyle.call(this)),{width:void 0,height:void 0,lineWidth:0})},e.type="image",e}(RN),h4=function(){KF.registerMark(c4.type,c4),lC(),Zw(),KF.registerGraphicComponent("image",Qv)},d4=function(){IN(),Rj(),Ij(),CY(),mX(),oG(),MG(),nY(),ZX(),HJ(),h4(),P$(),_U()};pV.useRegisters([nG,gG,OG,JG,_0,S0,T0,F0,d0,U0,X0,K0,J0,v1,m1,N0,t1,n1,A1,o1,u1,d1,x1,w1,R0,P1,E0,NU,WU,YU,KU,ZU,xK,_K,F1,q1,l2,p2,v2,A2,w2,R2,pY,v3,A3,K3,y3,T3,Z3,Q3,b3,I3,N3,W3,n5,a5,u5,l5,d4,P5,O5,j5,G5,q5,a4,u4,Q5,e4,tV,ox,rx]);var p4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["valueField","maskShape","reverse","outlineMargin","outlinePadding","indicatorSmartInvert","liquidBackground","liquidOutline"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(_W),f4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=p4,i.type="liquid",i.seriesType=t.SeriesTypeEnum.liquid,i}return M(i,e),i.type="liquid",i.seriesType=t.SeriesTypeEnum.liquid,i.transformerConstructor=p4,i}(yW),v4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","circle","overlap","overlapLabel"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(_W),g4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=v4,i.type="venn",i.seriesType=t.SeriesTypeEnum.venn,i}return M(i,e),i.type="venn",i.seriesType=t.SeriesTypeEnum.venn,i.transformerConstructor=v4,i}(yW),y4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barBackground","barMinHeight","stackCornerRadius","bar","bandWidthField"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),XH(e)},e.prototype._setDefaultXAxisSpec=function(t){return{orient:"bottom",type:"linear",label:{visible:!1}}},e.prototype._setDefaultYAxisSpec=function(t){return{orient:"left",type:"linear"}},e}(bW),m4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=y4,i.type="mosaic",i.seriesType=t.SeriesTypeEnum.mosaic,i.handleAfterStackRegion=function(t,e){t.getSeries().forEach((function(t){var i=t.getStackData(),n=t.getStackValue(),r=t.getStackValueField();i&&r&&(Zz(e[n],r),Jz(t,e[n]))}))},i}return M(i,e),i.prototype._beforeInit=function(){this._dataSet&&kH(this._dataSet,"stackSplit",kW)},i.prototype._initStack=function(){this._stack=new SW(this,{afterStackRegion:this.handleAfterStackRegion}),this._stack.init()},i.prototype._setModelOption=function(){this._modelOption.getDimensionInfo=IW,this._modelOption.getDimensionInfoByValue=OW,this._modelOption.getRectByDimensionData=jW},i.type="mosaic",i.seriesType=t.SeriesTypeEnum.mosaic,i.transformerConstructor=y4,i}(yW),_4=function(e,i,n){var r,a,o,s,l,u,c,h,d,p,f;void 0===e&&(e="chart");var v={modelInfo:[]};if("chart"===e)v.isChart=!0,v.modelInfo.push({spec:i,type:"chart"});else if("region"===e)v.modelType="region",v.specKey="region",null===(r=i.region)||void 0===r||r.forEach((function(t,e){v.modelInfo.push({spec:t,specPath:["region",e],type:"region"})}));else if("series"===e)v.modelType="series",v.specKey="series",null===(a=i.series)||void 0===a||a.forEach((function(t,e){v.modelInfo.push({spec:t,specPath:["series",e],type:t.type})}));else if(Object.values(t.SeriesTypeEnum).includes(e))v.modelType="series",v.specKey="series",v.type=e,null===(o=i.series)||void 0===o||o.forEach((function(t,i){t.type===e&&v.modelInfo.push({spec:t,specPath:["series",i],type:e})}));else if(Object.values(I).includes(e)){v.modelType="component",v.type=e,v.specKey=null===(s=KF.getComponentInKey(e))||void 0===s?void 0:s.specKey;var g=v.specKey,y=St(null!==(u=null===(l=n.component)||void 0===l?void 0:l[g])&&void 0!==u?u:[]);null===(h=St(null!==(c=i[g])&&void 0!==c?c:[]))||void 0===h||h.forEach((function(t,i){var n=y[i];n&&n.type===e?v.modelInfo.push(T(T({},n),{spec:t})):t&&!1===t.visible&&v.modelInfo.push({type:e,spec:t})}))}else{var m=KF.getComponents().filter((function(t){return t.cmp.specKey===e})).map((function(t){return t.cmp.type}));if(m.length>0){v.modelType="component";g=e;v.specKey=g;var _=St(null!==(p=null===(d=n.component)||void 0===d?void 0:d[g])&&void 0!==p?p:[]);St(null!==(f=i[g])&&void 0!==f?f:[]).forEach((function(t,e){var i=_[e];i&&m.includes(i.type)&&v.modelInfo.push(T(T({},i),{spec:t}))}))}}return v},b4=function(t,e,i,n){var r,a,o=t.spec,s=t.filter,l=t.filterType,u=t.forceAppend,c=function(t,e,i,n,r,a){void 0===t&&(t="chart");var o=_4(t,r,a);return T(T({},o),{modelInfo:o.modelInfo.filter((function(t){return!!j(e)||St(e).some((function(e){return V(e)?e(t,i,n):UF(t.spec,e)}))}))})}(l,s,t,e,i,n),h=c.isChart,d=c.modelType,p=c.specKey,f=c.type,v=c.modelInfo;if(0===v.length&&!u)return{chartSpec:i,hasChanged:!1};var g=XF({},i),y=V(o)?o(v,t,e):o;try{for(var m=P(v),_=m.next();!_.done;_=m.next()){var b=_.value,x=b.spec,k=b.specPath;if(h)return{chartSpec:XF(g,y),hasChanged:!0};var S=XF({},x,y);WF(g,k,S)}}catch(t){r={error:t}}finally{try{_&&!_.done&&(a=m.return)&&a.call(m)}finally{if(r)throw r.error}}if(0===v.length&&u){var A=T({type:f},y);q(g[p])?g[p].push(A):j(g[p])?g[p]="component"===d?A:[A]:g[p]=[g[p],A]}return{chartSpec:g,hasChanged:!0}},x4=function(t){function e(){var i=t.call(this,e.type)||this;return i.type="MediaQueryPlugin",i._currentMediaInfo={},i.currentActiveItems=new Set,i._initialized=!1,i}return M(e,t),e.prototype.onInit=function(t,i){if(null==i?void 0:i[e.specKey]){var n=t.globalInstance;this._option={globalInstance:t.globalInstance,updateSpec:function(t,e,i){i?n.updateSpecSync(t):e?n.updateSpecAndRecompile(t,!1,{transformSpec:!0}):n.setRuntimeSpec(t)}},this._spec=i[e.specKey],this._initialized=!0}},e.prototype.onBeforeResize=function(t,e,i){this._initialized&&this._changeSize(e,i,!0,!1)},e.prototype.onAfterChartSpecTransform=function(t,e,i){this._initialized&&"setCurrentTheme"===i&&this._reInit(!1,!1)},e.prototype.onAfterModelSpecTransform=function(t,e,i,n){this._initialized&&"updateSpec"===n&&this.onBeforeInitChart(t,e,"setCurrentTheme")},e.prototype.onBeforeInitChart=function(t,e,i){if(this._initialized){var n,r;switch(i){case"render":case"updateModelSpec":n=!1,r=!0;break;case"setCurrentTheme":n=!0,r=!1;break;case"updateSpecAndRecompile":n=!1,r=!1}if(n&&this.release(),this._initialized||this.onInit(t,e),n||r){var a=this._option.globalInstance.getCurrentSize(),o=a.width,s=a.height;this._changeSize(o,s,!1,!1)}}},e.prototype._changeSize=function(t,e,i,n){return(this._currentMediaInfo.width!==t||this._currentMediaInfo.height!==e)&&(this._currentMediaInfo.width=t,this._currentMediaInfo.height=e,this._applyQueries(i,n))},e.prototype._applyQueries=function(t,i){var n,r,a=this,o=[],s=[];if(this._spec.forEach((function(t){var e=a._check(t),i=e.hasChanged,n=e.isActive;i&&(n?o.push(t):s.push(t))})),!o.length&&!s.length)return!1;this._baseChartSpec||(this._baseChartSpec=YF(this._option.globalInstance.getSpec(),["data",e.specKey]),this._baseChartSpecInfo=this._option.globalInstance.getSpecInfo());var l=!1;return s.length>0?(n=YF(this._baseChartSpec,["data",e.specKey]),r=this._baseChartSpecInfo,Array.from(this.currentActiveItems).forEach((function(t){if(s.includes(t))a.currentActiveItems.delete(t);else{var e=a._apply(t,n,r);n=e.chartSpec}})),l=!0):(n=this._option.globalInstance.getSpec(),r=this._option.globalInstance.getSpecInfo()),o.forEach((function(t){a.currentActiveItems.add(t);var e=a._apply(t,n,r);n=e.chartSpec,l||(l=e.hasChanged)})),l&&this._option.updateSpec(n,t,i),!0},e.prototype._check=function(t){var e=this._option.globalInstance,i=function(t,e,i){for(var n in t)switch(n){case"maxHeight":if(U(t.maxHeight)&&e.height>t.maxHeight)return!1;break;case"minHeight":if(U(t.minHeight)&&e.height<t.minHeight)return!1;break;case"maxWidth":if(U(t.maxWidth)&&e.width>t.maxWidth)return!1;break;case"minWidth":if(U(t.minWidth)&&e.width<t.minWidth)return!1;break;case"onResize":if(U(t.onResize)&&!t.onResize(e,i))return!1}return!0}(t.query,this._currentMediaInfo,e);return{isActive:i,hasChanged:i!==this.currentActiveItems.has(t)}},e.prototype._apply=function(t,e,i){var n=t.query,r=t.action,a=!1;return St(r).forEach((function(t){var r=b4(t,n,e,i);e=r.chartSpec,a||(a=r.hasChanged)})),{chartSpec:e,hasChanged:a}},e.prototype._reInit=function(t,i){var n=this,r=this._option.globalInstance.getSpec();this._baseChartSpec=YF(r,["data",e.specKey]),this._baseChartSpecInfo=this._option.globalInstance.getSpecInfo();var a=!1;this.currentActiveItems.forEach((function(t){var e=n._apply(t,r,n._baseChartSpecInfo);r=e.chartSpec,a||(a=e.hasChanged)})),a&&this._option.updateSpec(r,t,i)},e.prototype.release=function(){t.prototype.release.call(this),this._initialized=!1,this._spec=[],this._option=void 0,this._currentMediaInfo={},this.currentActiveItems.clear()},e.pluginType="chart",e.specKey="media",e.type="MediaQueryPlugin",e}(Uj);var k4=function(){function t(t,e,i,n,r){this.state=t,this.graphics=e,this.config=i||[],this.beforeExecute=n,this.afterExecute=r}return t.prototype.execute=function(t,e){var i=this;if(this.graphics.length&&this.config.length){this.beforeExecute&&this.beforeExecute(this.graphics);var n=0,r=this.graphics.length,a=function(){++n>=r&&(i.afterExecute&&i.afterExecute(i.graphics),null==e||e())};this.graphics.forEach((function(t){if(t){"exit"===i.state&&(t.isExiting=!0);var e=i.config.length>1?i.config.map((function(e){return{name:i.state,animation:T(T({},e),{customParameters:t.context})}})):{name:i.state,animation:T(T({},i.config[0]),{customParameters:t.context})};t.applyAnimationState([i.state],[e],a)}else n++}))}else null==e||e()},t.prototype.executeOnGroup=function(t,e){var i=this;if(this.graphics.length&&this.config.length&&t){this.beforeExecute&&this.beforeExecute(this.graphics);var n=this.config[0],r=[{name:this.state,animation:T({},n)}];r.forEach((function(t){t.animation.customParameters=function(t,e){return e.context}})),t.applyAnimationState([this.state],r,(function(){i.afterExecute&&i.afterExecute(i.graphics),null==e||e()}))}else null==e||e()},t}(),S4=function(){function t(){this.name="verticalBarSplit"}return t.prototype.shouldApply=function(t,e){var i,n,r="rect"===t.type,a="vertical"===(null===(i=t.model)||void 0===i?void 0:i.direction),o=(null===(n=e.context)||void 0===n?void 0:n.diffAttrs)||{};return r&&a&&("x"in o||"width"in o||"x1"in o)&&("y"in o||"height"in o||"y1"in o)},t.prototype.split=function(t,e){var i,n=(null===(i=e.context)||void 0===i?void 0:i.diffAttrs)||{},r={},a={};Object.entries(n).forEach((function(t){var e=B(t,2),i=e[0],n=e[1];"x"===i||"width"===i||"x1"===i?r[i]=n:"y"===i||"height"===i||"y1"===i?a[i]=n:r[i]=n}));var o=e.context,s=o.fieldX,l=o.originalFieldX,u=Array.isArray(s)&&s.length>1,c=(l?!(Array.isArray(l)&&l.length>1):!u)&&u;return[{attrs:r,order:c?1:2},{attrs:a,order:c?2:1}]},t}(),A4=function(){function t(){this.name="horizontalBarSplit"}return t.prototype.shouldApply=function(t,e){var i,n,r="rect"===t.type,a="horizontal"===(null===(i=t.model)||void 0===i?void 0:i.direction),o=(null===(n=e.context)||void 0===n?void 0:n.diffAttrs)||{};return r&&a&&("y"in o||"height"in o||"y1"in o)&&("x"in o||"width"in o||"x1"in o)},t.prototype.split=function(t,e){var i,n=(null===(i=e.context)||void 0===i?void 0:i.diffAttrs)||{},r={},a={};Object.entries(n).forEach((function(t){var e=B(t,2),i=e[0],n=e[1];"y"===i||"height"===i||"y1"===i?r[i]=n:"x"===i||"width"===i||"x1"===i?a[i]=n:r[i]=n}));var o=e.context,s=o.fieldY,l=o.originalFieldY,u=Array.isArray(s)&&s.length>1,c=!(l?!(Array.isArray(l)&&l.length>1):!u)&&!u;return[{attrs:r,order:c?2:1},{attrs:a,order:c?1:2}]},t}(),M4=function(){function t(t){this.splitStrategies=[],this.mark=t,"rect"===t.type&&(this.registerStrategy(new S4),this.registerStrategy(new A4))}return t.prototype.registerStrategy=function(t){this.splitStrategies.push(t)},t.prototype.detect=function(t,e){var i=[],n=[],r=[],a=[],o=this.mark.model.fieldX,s=this.mark.model.fieldY;return t.forEach((function(t){var e=t.context;switch(e.fieldX&&(e.originalFieldX=e.fieldX),e.fieldY&&(e.originalFieldY=e.fieldY),e.fieldX=o,e.fieldY=s,t.context.animationState){case"update":n.push(t);break;case"enter":r.push(t);break;case"appear":a.push(t);break;default:t.context.diffState===gN.exit?i.push(t):t.context.diffState===gN.enter?r.push(t):n.push(t)}})),e.size>t.length&&e.forEach((function(t,e){t.context.diffState!==gN.exit||t.isExiting||i.push(t)})),{hasExit:i.length>0,hasUpdate:n.length>0,hasEnter:r.length>0,hasAppear:a.length>0,exitGraphics:i,updateGraphics:n,enterGraphics:r,appearGraphics:a}},t.prototype.createPlanners=function(t,e){var i=this,n=[];if(t.hasExit&&e.exit&&n.push(new k4("exit",t.exitGraphics,e.exit)),t.hasUpdate&&e.update){var r=new Map,a=[];t.updateGraphics.forEach((function(t){var e,n,o=!1,s=function(e){if(e.shouldApply(i.mark,t)){var n=e.split(i.mark,t),a={graphic:t,steps:n};return n.forEach((function(t){var e=t.order;r.has(e)||r.set(e,[]),r.get(e).push(a)})),o=!0,"break"}};try{for(var l=P(i.splitStrategies),u=l.next();!u.done;u=l.next()){if("break"===s(u.value))break}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}o||a.push(t)})),a.length>0&&n.push(new k4("update",a,e.update));var o=Array.from(r.keys()).sort((function(t,e){return t-e}));o.forEach((function(t){var i=r.get(t);if(i&&i.length>0){var a=i.map((function(e){var i=e.graphic,n=e.steps.find((function(e){return e.order===t}));return{graphic:i,attrs:(null==n?void 0:n.attrs)||{}}}));n.push(new k4("update",a.map((function(t){return t.graphic})),e.update,(function(t){t.forEach((function(t,e){var i=a[e].attrs,n=t.context;n._originalDiffAttrs||(n._originalDiffAttrs=t.context.diffAttrs),t.context.diffAttrs=i}))}),(function(e){t===o[o.length-1]&&e.forEach((function(t){var e=t.context;e._originalDiffAttrs&&(t.context.diffAttrs=e._originalDiffAttrs,delete e._originalDiffAttrs)}))})))}}))}return t.hasEnter&&e.enter&&n.push(new k4("enter",t.enterGraphics,e.enter)),t.hasAppear&&e.appear&&n.push(new k4("appear",t.appearGraphics,e.appear)),n},t}(),T4=function(){function t(){}return t.prototype.registerAnimationSplitStrategy=function(t){this._grammarDetector||(this._grammarDetector=new M4(this)),this._grammarDetector.registerStrategy(t)},t.prototype.getGrammarDetector=function(){return this.initGrammarDetector(),this._grammarDetector},t.prototype.initGrammarDetector=function(){this._grammarDetector||(this._grammarDetector=new M4(this))},t.prototype._runSequentialAnimations=function(t){this.initGrammarDetector();var e=this.getAnimationConfig(),i=this._grammarDetector.detect(t,this._graphicMap),n=this._grammarDetector.createPlanners(i,e);this._executePlanners(n,0)},t.prototype._executePlanners=function(t,e){var i=this;if(!(e>=t.length)){var n=t[e];n.execute(this._product,(function(){i._executePlanners(t,e+1),"exit"===n.state&&n.graphics.forEach((function(t){t.isExiting&&(i._graphicMap.delete(t.context.uniqueKey),t.parent&&t.parent.removeChild(t),t.release&&t.release())}))}))}},t}();t.ArcMark=qX,t.AreaChart=vG,t.AreaMark=aG,t.AreaSeries=dG,t.AxisSyncPlugin=Wj,t.BandAxisMixin=VU,t.BarChart=IG,t.BarChartSpecTransformer=LG,t.BarSeries=BG,t.BarSeriesSpecTransformer=EG,t.BaseArcMark=KX,t.BaseChart=yW,t.BaseChartSpecTransformer=_W,t.BaseComponent=yU,t.BaseComponentSpecTransformer=gU,t.BaseHistogramChart=I0,t.BaseMark=RN,t.BasePieChart=y0,t.BasePieChartSpecTransformer=g0,t.BasePieSeries=eK,t.BasePlugin=Uj,t.BasePolygonMark=FJ,t.BaseSeries=rj,t.BaseSeriesSpecTransformer=nj,t.BaseSeriesTooltipHelper=EV,t.BaseWordCloudChart=G0,t.BaseWordCloudChartSpecTransformer=W0,t.BaseWordCloudSeries=Cq,t.BoxPlotChart=y1,t.BoxPlotSeries=vX,t.Brush=i5,t.CanvasTooltipHandler=D5,t.CartesianAxis=MU,t.CartesianBandAxis=UU,t.CartesianChartSpecTransformer=bW,t.CartesianCrossHair=d2,t.CartesianLinearAxis=HU,t.CartesianLogAxis=XU,t.CartesianMarkArea=S3,t.CartesianMarkLine=f3,t.CartesianMarkPoint=X3,t.CartesianSeries=lj,t.CartesianSymlogAxis=qU,t.CartesianTimeAxis=GU,t.CirclePackingChart=l1,t.CirclePackingSeries=fQ,t.CircularProgressChart=H0,t.CircularProgressSeries=sq,t.CommonChart=C0,t.CommonChartSpecTransformer=w0,t.CompilableData=wN,t.ComponentMark=mU,t.ContinuousLegend=K1,t.CorrelationChart=E1,t.CorrelationSeries=I$,t.CustomMark=r5,t.DEFAULT_ANIMATION_CONFIG=UN,t.DEFAULT_CHART_HEIGHT=bz,t.DEFAULT_CHART_WIDTH=_z,t.DEFAULT_CLOSE_STROKE_JOIN=gV,t.DEFAULT_DATA_INDEX=kz,t.DEFAULT_DATA_KEY=Sz,t.DEFAULT_DATA_SERIES_FIELD=Az,t.DEFAULT_KEY=Uz,t.DEFAULT_LAYOUT_RECT_LEVEL=0,t.DEFAULT_LAYOUT_RECT_LEVEL_MIN=-1,t.DEFAULT_LINEAR_INTERPOLATE=vV,t.DEFAULT_MEASURE_CANVAS_ID=xz,t.DEFAULT_SERIES_STYLE_NAME=Mz,t.DEFAULT_SMOOTH_INTERPOLATE=fV,t.DataZoom=S2,t.DimensionClickEvent=_j,t.DimensionHoverEvent=Aj,t.DiscreteLegend=O1,t.DomTooltipHandler=E5,t.DotSeries=GK,t.ElementHighlight=sV,t.ElementSelect=cV,t.Event=pH,t.Factory=KF,t.FormatterPlugin=V5,t.FunnelChart=Z0,t.FunnelChartSpecTransformer=q0,t.FunnelSeries=jJ,t.FunnelSeriesSpecTransformer=VJ,t.GaugeChart=j0,t.GaugePointerSeries=a$,t.GaugeSeries=u$,t.GeoCoordinate=dY,t.GeoMarkPoint=J3,t.GeoSeries=QG,t.GlyphMark=$Y,t.GridLayout=o5,t.GroupMark=LN,t.HeatmapChart=T1,t.HeatmapSeries=_$,t.HistogramChart=O0,t.HistogramChartSpecTransformer=D0,t.ImageMark=c4,t.Indicator=B2,t.Label=H3,t.Layout=_N,t.LineChart=eG,t.LineMark=Bj,t.LineSeries=hW,t.LinearAxisMixin=IU,t.LinearProgressChart=$0,t.LinearProgressSeries=mq,t.LinkSeries=JK,t.LiquidChart=f4,t.LiquidSeries=K$,t.MOSAIC_CAT_END_PERCENT=Nz,t.MOSAIC_CAT_START_PERCENT=Hz,t.MOSAIC_VALUE_END_PERCENT=zz,t.MOSAIC_VALUE_START_PERCENT=Fz,t.ManualTicker=MP,t.MapChart=h0,t.MapSeries=gY,t.MediaQuery=x4,t.MosaicChart=m4,t.MosaicSeries=l0,t.PREFIX=mz,t.PathMark=iY,t.PieChart=m0,t.PieSeries=iK,t.PieSeriesSpecTransformer=QX,t.Player=L3,t.PolarAxis=vK,t.PolarBandAxis=bK,t.PolarCrossHair=f2,t.PolarLinearAxis=mK,t.PolarMarkArea=M3,t.PolarMarkLine=g3,t.PolarMarkPoint=q3,t.PolarSeries=OX,t.PolygonMark=zJ,t.ProgressLikeSeries=tq,t.RadarChart=M0,t.RadarSeries=IK,t.RangeAreaChart=S1,t.RangeAreaSeries=IX,t.RangeColumnChart=i1,t.RangeColumnSeries=PX,t.RangeColumnSeriesSpecTransformer=CX,t.RectMark=AG,t.RippleMark=E$,t.RoseChart=k0,t.RoseLikeSeries=dK,t.RoseSeries=SK,t.RuleMark=wY,t.SEGMENT_FIELD_END=jz,t.SEGMENT_FIELD_START=Vz,t.STACK_FIELD_END=Cz,t.STACK_FIELD_END_OffsetSilhouette=Rz,t.STACK_FIELD_END_PERCENT=Pz,t.STACK_FIELD_KEY=Tz,t.STACK_FIELD_START=wz,t.STACK_FIELD_START_OffsetSilhouette=Bz,t.STACK_FIELD_START_PERCENT=Ez,t.STACK_FIELD_TOTAL=Lz,t.STACK_FIELD_TOTAL_BOTTOM=Oz,t.STACK_FIELD_TOTAL_PERCENT=Iz,t.STACK_FIELD_TOTAL_TOP=Dz,t.SankeyChart=b1,t.SankeySeries=OQ,t.ScatterChart=qG,t.ScatterSeries=YG,t.ScrollBar=T2,t.SequenceChart=B0,t.StreamLight=xR,t.SunburstChart=a1,t.SunburstSeries=oQ,t.SymbolMark=Lj,t.TextMark=yX,t.ThemeManager=hz,t.Title=_3,t.Tooltip=s2,t.TotalLabel=j3,t.TreemapChart=h1,t.TreemapSeries=XQ,t.USER_LAYOUT_RECT_LEVEL=9,t.VChart=pV,t.VennChart=g4,t.VennSeries=a0,t.WaterfallChart=f1,t.WaterfallSeries=XY,t.WordCloudChart=Y0,t.WordCloudSeries=kJ,t.alternatingWave=function(t,e,i,n,r,a,o){var s=e/n,l=i/r,u=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)*Math.sin(2*a*Math.PI-2*l*Math.PI)+1)/2;return Math.min(1,Math.max(0,u))},t.animationConfig=qV,t.barGrowIn=mG,t.barGrowOut=_G,t.barPresetAnimation=kG,t.baseSeriesMark=VV,t.boundsInRect=LF,t.builtinThemes=tz,t.calcLayoutNumber=BF,t.calcPadding=RF,t.centerToCorner=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow((e-u)/u,2)+Math.pow((i-c)/c,2)),d=1-Math.min(h,1),p=s+l*(Math.sin(2*a*Math.PI-2*d*Math.PI)+1)/2;return Math.min(1,Math.max(0,p))},t.columnCenterToEdge=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=r/2,c=Math.abs(i-u)/u,h=s+l*(Math.sin(2*a*Math.PI-2*c*Math.PI)+1)/2;return Math.min(1,Math.max(0,h))},t.columnEdgeToCenter=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=r/2,c=1-Math.abs(i-u)/u,h=s+l*(Math.sin(2*a*Math.PI-2*c*Math.PI)+1)/2;return Math.min(1,Math.max(0,h))},t.columnLeftToRight=function(t,e,i,n,r,a,o){var s=i/r,l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.columnRightToLeft=function(t,e,i,n,r,a,o){var s=(r-1-i)/r,l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.computeActualDataScheme=fF,t.convertPoint=DF,t.cornerToCenter=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow((e-u)/u,2)+Math.pow((i-c)/c,2)),d=Math.min(h,1),p=s+l*(Math.sin(2*a*Math.PI-2*d*Math.PI)+1)/2;return Math.min(1,Math.max(0,p))},t.createArc=fg,t.createArea=hg,t.createGroup=Vf,t.createLine=Nv,t.createRect=Wv,t.createRichText=ag,t.createScale=SF,t.createScaleWithSpec=AF,t.createSymbol=Fv,t.createText=Iv,t.darkTheme=jF,t.dataScheme=FF,t.default=pV,t.defaultThemeName=ez,t.diagonalCenterToEdge=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow((e-u)/n,2)+Math.pow((i-c)/r,2)),d=s+l*(Math.sin(2*a*Math.PI-2*h*Math.PI)+1)/2;return Math.min(1,Math.max(0,d))},t.diagonalTopLeftToBottomRight=function(t,e,i,n,r,a,o){var s=(e/n+i/r)/2,l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.findMarkGraphic=hH,t.functionTransform=gz,t.getActualColor=gF,t.getActualNumValue=OF,t.getCartesianCrosshairRect=jW,t.getCartesianDimensionInfo=IW,t.getColorSchemeBySeries=bF,t.getCombinedSizeOfRegions=SU,t.getDataScheme=pF,t.getDatumOfGraphic=cH,t.getDiffAttributesOfGraphic=dH,t.getDimensionInfoByValue=OW,t.getFieldAlias=Yz,t.getFunnelTheme=QF,t.getGroupAnimationParams=sj,t.getMergedTheme=uz,t.getPolarDimensionInfo=x0,t.getRegionStackGroup=Xz,t.getSpecInfo=_V,t.getTheme=oz,t.hasThemeMerged=rz,t.isCollectionMark=uH,t.isColorKey=yF,t.isPercent=EF,t.isPercentOffset=PF,t.isPolarAxisSeries=aj,t.isProgressiveDataColorScheme=mF,t.isSpecValueWithScale=wF,t.isTokenKey=HF,t.isValidOrient=CF,t.isValueInScaleDomain=TF,t.isXAxis=uj,t.isYAxis=cj,t.isZAxis=hj,t.lightTheme=VF,t.lookup=bV,t.measureText=yz,t.mergeFields=Wz,t.normalizeLayoutPaddingSpec=IF,t.particleEffect=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=e*r+i,c=2*pC(u,0)*Math.PI,h=.5*pC(u,1)+.5,d=2*pC(u,2)*Math.PI,p=n/2,f=r/2,v=Math.sqrt(Math.pow((e-p)/p,2)+Math.pow((i-f)/f,2)),g=Math.min(v,1),y=(a-.4)/.6,m=Math.sin(y*h*8*Math.PI+c+d*y),_=Math.cos(g*Math.PI+y*Math.PI),b=s+l*((m+1)/2*Math.max(0,1-1.2*y)*(.3+.7*_));return Math.min(1,Math.max(0,b))},t.pieDisappear=GX,t.pieEnter=UX,t.pieExit=WX,t.piePresetAnimation=YX,t.pulseWave=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow((e-u)/u,2)+Math.pow((i-c)/c,2)),d=Math.min(h,1),p=2*a*Math.PI*3,f=Math.max(0,1-d),v=s+l*((Math.sin(p-4*d*Math.PI)+1)/2)*(.7*f+.3);return Math.min(1,Math.max(0,v))},t.queryColorFromColorScheme=vF,t.queryToken=zF,t.randomOpacity=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=2*pC(e*r+i)*Math.PI,c=s+l*(Math.sin(2*a*Math.PI+u)+1)/2;return Math.min(1,Math.max(0,c))},t.registerAllEnv=function(){OM()},t.registerAllMarks=d4,t.registerAnimate=tV,t.registerArcAnimation=JN,t.registerArcMark=ZX,t.registerAreaChart=gG,t.registerAreaMark=oG,t.registerAreaSeries=pG,t.registerBarChart=OG,t.registerBarSeries=RG,t.registerBoxplotChart=m1,t.registerBoxplotSeries=gX,t.registerBrowserEnv=FN,t.registerBrush=n5,t.registerCanvasTooltipHandler=O5,t.registerCartesianBandAxis=WU,t.registerCartesianCrossHair=p2,t.registerCartesianLinearAxis=NU,t.registerCartesianLogAxis=KU,t.registerCartesianSymlogAxis=ZU,t.registerCartesianTimeAxis=YU,t.registerChartPlugin=F5,t.registerCirclePackingChart=u1,t.registerCirclePackingSeries=vQ,t.registerCircularProgressChart=N0,t.registerCircularProgressSeries=lq,t.registerCommonChart=E0,t.registerComponentMark=_U,t.registerContinuousLegend=q1,t.registerCorrelationChart=P1,t.registerCustomAnimate=function(){wP.registerBuiltInAnimate("increaseCount",UP),wP.registerBuiltInAnimate("fromTo",bR),wP.registerBuiltInAnimate("scaleIn",ZB),wP.registerBuiltInAnimate("scaleOut",JB),wP.registerBuiltInAnimate("growHeightIn",SB),wP.registerBuiltInAnimate("growHeightOut",AB),wP.registerBuiltInAnimate("growWidthIn",NB),wP.registerBuiltInAnimate("growWidthOut",VB),wP.registerBuiltInAnimate("growCenterIn",bB),wP.registerBuiltInAnimate("growCenterOut",xB),wP.registerBuiltInAnimate("clipIn",dB),wP.registerBuiltInAnimate("clipOut",pB),wP.registerBuiltInAnimate("fadeIn",fB),wP.registerBuiltInAnimate("fadeOut",vB),wP.registerBuiltInAnimate("growPointsIn",wB),wP.registerBuiltInAnimate("growPointsOut",CB),wP.registerBuiltInAnimate("growPointsXIn",PB),wP.registerBuiltInAnimate("growPointsXOut",BB),wP.registerBuiltInAnimate("growPointsYIn",LB),wP.registerBuiltInAnimate("growPointsYOut",IB),wP.registerBuiltInAnimate("growAngleIn",mB),wP.registerBuiltInAnimate("growAngleOut",_B),wP.registerBuiltInAnimate("growRadiusIn",FB),wP.registerBuiltInAnimate("growRadiusOut",zB),wP.registerBuiltInAnimate("moveIn",fR),wP.registerBuiltInAnimate("moveOut",vR),wP.registerBuiltInAnimate("rotateIn",yR),wP.registerBuiltInAnimate("rotateOut",mR),wP.registerBuiltInAnimate("update",dR),wP.registerBuiltInAnimate("state",QB),wP.registerBuiltInAnimate("labelItemAppear",jB),wP.registerBuiltInAnimate("labelItemDisappear",UB),wP.registerBuiltInAnimate("poptipAppear",WB),wP.registerBuiltInAnimate("poptipDisappear",GB),wP.registerBuiltInAnimate("inputText",aB),wP.registerBuiltInAnimate("inputRichText",YB),wP.registerBuiltInAnimate("outputRichText",XB),wP.registerBuiltInAnimate("slideRichText",KB),wP.registerBuiltInAnimate("slideOutRichText",qB),wP.registerBuiltInAnimate("slideIn",$B),wP.registerBuiltInAnimate("growIn",tR),wP.registerBuiltInAnimate("spinIn",eR),wP.registerBuiltInAnimate("moveScaleIn",rR),wP.registerBuiltInAnimate("moveRotateIn",aR),wP.registerBuiltInAnimate("strokeIn",iR),wP.registerBuiltInAnimate("slideOut",oR),wP.registerBuiltInAnimate("growOut",sR),wP.registerBuiltInAnimate("spinOut",lR),wP.registerBuiltInAnimate("moveScaleOut",uR),wP.registerBuiltInAnimate("moveRotateOut",cR),wP.registerBuiltInAnimate("strokeOut",nR),wP.registerBuiltInAnimate("pulse",hR),wP.registerBuiltInAnimate("MotionPath",_R),wP.registerBuiltInAnimate("streamLight",xR),wP.registerBuiltInAnimate("dissolve",wR),wP.registerBuiltInAnimate("grayscale",CR),wP.registerBuiltInAnimate("distortion",ER),wP.registerBuiltInAnimate("particle",PR),wP.registerBuiltInAnimate("glitch",BR),wP.registerBuiltInAnimate("gaussianBlur",RR),wP.registerBuiltInAnimate("pixelation",LR)},t.registerCustomMark=a5,t.registerDataSetInstanceParser=SH,t.registerDataSetInstanceTransform=kH,t.registerDataZoom=A2,t.registerDimensionEvents=CW,t.registerDimensionHover=wW,t.registerDimensionTooltipProcessor=ZW,t.registerDiscreteLegend=F1,t.registerDomTooltipHandler=P5,t.registerDotSeries=YK,t.registerDragPlugin=function(){KF.registerStageEventPlugin("drag",Jx)},t.registerElementActive=G5,t.registerElementActiveByLegend=q5,t.registerElementHighlight=lV,t.registerElementHighlightByGroup=Q5,t.registerElementHighlightByKey=e4,t.registerElementHighlightByLegend=a4,t.registerElementHighlightByName=u4,t.registerElementSelect=hV,t.registerFormatPlugin=j5,t.registerFunnelChart=J0,t.registerFunnelSeries=UJ,t.registerGaugeChart=U0,t.registerGaugePointerSeries=o$,t.registerGaugeSeries=c$,t.registerGeoCoordinate=pY,t.registerGeoMarkPoint=Q3,t.registerGesturePlugin=eV,t.registerGlyphMark=tX,t.registerGridLayout=l5,t.registerGroupMark=IN,t.registerGroupTooltipProcessor=tG,t.registerHarmonyEnv=function(){yT(yc)},t.registerHeatmapChart=w1,t.registerHeatmapSeries=b$,t.registerHistogramChart=F0,t.registerHtmlAttributePlugin=rx,t.registerImageMark=h4,t.registerIndicator=R2,t.registerLabel=N3,t.registerLarkEnv=function(){_A(yc)},t.registerLineChart=nG,t.registerLineMark=Rj,t.registerLineSeries=pW,t.registerLinearProgressChart=t1,t.registerLinearProgressSeries=_q,t.registerLinkSeries=QK,t.registerLiquidChart=function(){QW(),q$(),KF.registerChart(f4.type,f4)},t.registerLiquidSeries=q$,t.registerLynxEnv=function(){FA(yc)},t.registerMapChart=d0,t.registerMapSeries=yY,t.registerMarkArea=A3,t.registerMarkFilterTransform=UQ,t.registerMarkLine=v3,t.registerMarkMapTransform=WQ,t.registerMarkPoint=K3,t.registerMarkTooltipProcessor=QW,t.registerMediaQuery=function(){F5(x4)},t.registerMosaicChart=function(){ZW(),QW(),tG(),CW(),wW(),u0(),KF.registerChart(m4.type,m4)},t.registerMosaicSeries=u0,t.registerNodeEnv=zN,t.registerPathMark=nY,t.registerPieChart=_0,t.registerPieSeries=nK,t.registerPlayer=I3,t.registerPolarBandAxis=xK,t.registerPolarCrossHair=v2,t.registerPolarLinearAxis=_K,t.registerPolarMarkArea=T3,t.registerPolarMarkLine=y3,t.registerPolarMarkPoint=Z3,t.registerPolygonAnimation=$N,t.registerPolygonMark=HJ,t.registerPoptip=u5,t.registerRadarChart=T0,t.registerRadarSeries=HK,t.registerRangeAreaChart=A1,t.registerRangeAreaSeries=DX,t.registerRangeColumnChart=n1,t.registerRangeColumnSeries=BX,t.registerReactAttributePlugin=ox,t.registerRectAnimation=ZN,t.registerRectMark=MG,t.registerRippleMark=P$,t.registerRoseChart=S0,t.registerRoseSeries=AK,t.registerRuleMark=CY,t.registerSankeyChart=x1,t.registerSankeySeries=FQ,t.registerScaleInOutAnimation=YN,t.registerScatterChart=JG,t.registerScatterSeries=XG,t.registerScrollBar=w2,t.registerSequenceChart=R0,t.registerSequentialAnimate=function(){kt(RN,T4)},t.registerStateTransition=function(){var t=TP.getInstance();t.registerTransition("update","*",(function(){return{allowTransition:!0,stopOriginalTransition:!1}})),t.registerTransition("update","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),t.registerTransition("update","exit",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),t.registerTransition("state","*",(function(){return{allowTransition:!0,stopOriginalTransition:!1}})),t.registerTransition("state","disappear",(function(){return{allowTransition:!0,stopOriginalTransition:!0}})),t.registerTransition("state","exit",(function(){return{allowTransition:!0,stopOriginalTransition:!0}}))},t.registerSunBurstSeries=lQ,t.registerSunburstChart=o1,t.registerSymbolMark=Ij,t.registerTTEnv=function(){tT(yc)},t.registerTaroEnv=function(){gM(yc)},t.registerTextMark=mX,t.registerTheme=az,t.registerTitle=b3,t.registerTooltip=l2,t.registerTotalLabel=W3,t.registerTreemapChart=d1,t.registerTreemapSeries=ZQ,t.registerVRenderAnimate=FP,t.registerVennChart=function(){QW(),o0(),KF.registerChart(g4.type,g4)},t.registerVennSeries=o0,t.registerWXEnv=function(){IM(yc)},t.registerWaterfallChart=v1,t.registerWaterfallSeries=KY,t.registerWordCloudChart=X0,t.registerWordCloudSeries=SJ,t.registerWordCloudShapeChart=K0,t.removeTheme=sz,t.rippleEffect=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow(e-u,2)+Math.pow(i-c,2))/Math.sqrt(Math.pow(n/2,2)+Math.pow(r/2,2)),d=s+l*(Math.sin(2*a*Math.PI*3-2*h*Math.PI)+1)/2;return Math.min(1,Math.max(0,d))},t.rotationScan=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.atan2(e-u,i-c),d=(h<0?h+2*Math.PI:h)/(2*Math.PI),p=s+l*(Math.sin(2*a*Math.PI-2*d*Math.PI)+1)/2;return Math.min(1,Math.max(0,p))},t.rowBottomToTop=function(t,e,i,n,r,a,o){var s=(n-1-e)/n,l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.rowCenterToEdge=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=Math.abs(e-u)/u,h=s+l*(Math.sin(2*a*Math.PI-2*c*Math.PI)+1)/2;return Math.min(1,Math.max(0,h))},t.rowEdgeToCenter=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=1-Math.abs(e-u)/u,h=s+l*(Math.sin(2*a*Math.PI-2*c*Math.PI)+1)/2;return Math.min(1,Math.max(0,h))},t.rowTopToBottom=function(t,e,i,n,r,a,o){var s=e/n,l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.setDefaultCrosshairForCartesianChart=XH,t.shouldMarkDoMorph=$V,t.snakeWave=function(t,e,i,n,r,a,o){var s=(e+i)%(n+r)/(n+r),l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-4*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.sortDataInAxisHelper=oj,t.sortStackValueGroup=Kz,t.specTransform=vz,t.spiralEffect=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow(e-u,2)+Math.pow(i-c,2)),d=Math.atan2(e-u,i-c),p=(h/Math.sqrt(Math.pow(n/2,2)+Math.pow(r/2,2))+d/(2*Math.PI))/2,f=s+l*(Math.sin(2*a*Math.PI-4*p*Math.PI)+1)/2;return Math.min(1,Math.max(0,f))},t.stack=$z,t.stackGroup=tH,t.stackMosaic=Jz,t.stackMosaicTotal=Zz,t.stackOffsetSilhouette=Qz,t.stackTotal=qz,t.themeExist=lz,t.themes=iz,t.token=NF,t.transformColorSchemeToStandardStruct=_F,t.transformToGraphic=sH,t.userAnimationConfig=ZV,t.valueInScaleRange=MF,t.version="2.0.4",t.vglobal=j_,t.warn=cx,Object.defineProperty(t,"__esModule",{value:!0})}));
