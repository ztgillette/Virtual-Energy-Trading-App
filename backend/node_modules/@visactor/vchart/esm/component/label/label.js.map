{"version":3,"sources":["../src/component/label/label.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,iBAAiB,EAAE,MAAM,mBAAmB,CAAC;AAGtD,OAAO,EAAE,wBAAwB,EAAE,qBAAqB,EAAE,MAAM,qBAAqB,CAAC;AACtF,OAAO,EAAE,UAAU,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAC;AAC9D,OAAO,EAAE,cAAc,EAAE,MAAM,0BAA0B,CAAC;AAC1D,OAAO,EAAE,YAAY,EAAE,MAAM,uBAAuB,CAAC;AAIrD,OAAO,EAAE,SAAS,EAAE,MAAM,4BAA4B,CAAC;AACvD,OAAO,EAAE,UAAU,EAAE,MAAM,kBAAkB,CAAC;AAG9C,OAAO,EAAE,kBAAkB,EAAE,aAAa,EAAE,MAAM,QAAQ,CAAC;AAE3D,OAAO,EAAE,qBAAqB,EAAE,MAAM,sBAAsB,CAAC;AAC7D,OAAO,EAAE,kBAAkB,EAAE,MAAM,cAAc,CAAC;AAGlD,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,UAAU,EAAE,OAAO,EAAE,WAAW,EAAE,MAAM,kBAAkB,CAAC;AAEpF,OAAO,EAAE,OAAO,EAAE,MAAM,oBAAoB,CAAC;AAE7C,OAAO,EAAE,iBAAiB,EAAE,MAAM,kBAAkB,CAAC;AAGrD,OAAO,EAAE,oBAAoB,EAAE,MAAM,qBAAqB,CAAC;AAG3D,OAAO,EAAE,SAAS,EAAE,MAAM,8BAA8B,CAAC;AAEzD,MAAM,OAAO,KAAkC,SAAQ,kBAAqB;IAmB1E,YAAY,IAAO,EAAE,OAAyB;QAC5C,KAAK,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAlBvB,SAAI,GAAG,iBAAiB,CAAC,KAAK,CAAC;QAC/B,SAAI,GAAW,iBAAiB,CAAC,KAAK,CAAC;QAGvC,YAAO,GAAG,OAAO,CAAC;QAGT,2BAAsB,GAAG,oBAAoB,CAAC;QAEvD,iBAAY,GAAW,YAAY,CAAC,KAAK,CAAC;QAUxC,IAAI,CAAC,WAAW,GAAI,IAAY,CAAC,WAAW,IAAI,QAAQ,CAAC;IAC3D,CAAC;IAED,MAAM,CAAC,WAAW,CAAC,SAAc,EAAE,aAA6B;QAC9D,MAAM,QAAQ,GAAqB,EAAE,CAAC;QACtC,MAAM,cAAc,GAAG,CAAA,aAAa,aAAb,aAAa,uBAAb,aAAa,CAAE,MAAM,KAAI,EAAE,CAAC;QACnD,MAAM,cAAc,GAAG,CAAC,aAA2B,EAAE,EAAE;YACrD,OAAO,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;QAC5D,CAAC,CAAC;QAEF,cAAc,CAAC,OAAO,CAAC,CAAC,UAAU,EAAE,CAAC,EAAE,EAAE;YACvC,MAAM,aAAa,GAAG,UAAU,CAAC,aAAa,IAAI,EAAE,CAAC;YACrD,MAAM,eAAe,GAAG,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE;gBACvD,MAAM,UAAU,GAAG,aAAa,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;gBACrD,MAAM,EAAE,aAAa,GAAG,EAAE,EAAE,GAAG,UAAU,CAAC;gBAE1C,OAAO,MAAM,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC,IAAI,CACtC,aAAa,CAAC,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,cAAc,CAAC,aAAa,CAAC,CAC/E,CAAC;YACJ,CAAC,CAAC,CAAC;YACH,IAAI,eAAe,EAAE;gBACnB,QAAQ,CAAC,IAAI,CAAC;oBACZ,IAAI,EAAE,SAAS;oBACf,IAAI,EAAE,iBAAiB,CAAC,KAAK;oBAC7B,YAAY,EAAE,CAAC,WAAW,EAAE,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC;oBAC5C,aAAa,EAAE,CAAC,CAAC,CAAC;iBACnB,CAAC,CAAC;aACJ;QACH,CAAC,CAAC,CAAC;QACH,OAAO,QAAQ,CAAC;IAClB,CAAC;IAED,IAAI,CAAC,MAAwB;QAC3B,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACnB,IAAI,CAAC,SAAS,EAAE,CAAC;QACjB,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,mBAAmB,EAAE,CAAC;QAC3B,IAAI,CAAC,kBAAkB,EAAE,CAAC;IAC5B,CAAC;IAED,MAAM,CAAC,IAAQ;QACb,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAEnB,IAAI,IAAI,CAAC,aAAa,EAAE;YACtB,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;gBACtC,UAAU,CAAC,OAAO,CAAC,CAAC,EAAE,SAAS,EAAE,EAAE,EAAE;oBACnC,SAAS,CAAC,OAAO,EAAE,CAAC;gBACtB,CAAC,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;SAC5B;QACD,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;QACjD,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,mBAAmB,EAAE,CAAC;QAC3B,IAAI,CAAC,kBAAkB,EAAE,CAAC;IAC5B,CAAC;IAED,SAAS;QACP,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,UAAU,CAAC,cAAc,EAAE,GAAG,EAAE;YAC5C,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,SAAS,EAAE,EAAE;gBAClD,MAAM,WAAW,GAAG,SAAS,CAAC,YAAY,EAAE,CAAC;gBAC7C,IAAI,WAAW,EAAE;oBACf,WAAW,CAAC,gBAAgB,EAAE,CAAC;iBAChC;YACH,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,UAAU,CAAC,qBAAqB,EAAE,eAAe,CAAC,CAAC;QACnE,CAAC,CAAC,CAAC;QACH,MAAM,eAAe,GAAG,GAAG,EAAE;YAC3B,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,SAAS,EAAE,EAAE;gBAClD,MAAM,WAAW,GAAG,SAAS,CAAC,YAAY,EAAE,CAAC;gBAC7C,IAAI,WAAW,EAAE;oBACf,WAAW,CAAC,eAAe,EAAE,CAAC;iBAC/B;YACH,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,qBAAqB,EAAE,eAAe,CAAC,CAAC;QACpE,CAAC,CAAC;IACJ,CAAC;IAES,aAAa;QACrB,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;YACvB,IAAI,CAAC,aAAa,GAAG,IAAI,GAAG,EAAE,CAAC;SAChC;QAED,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE;YAC5B,IAAI,CAAC,kBAAkB,GAAG,IAAI,GAAG,EAAE,CAAC;SACrC;QACD,UAAU,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,MAAe,EAAE,EAAE;YAC5C,MAAM,EAAE,aAAa,GAAG,EAAE,EAAE,GAAG,MAAM,CAAC,WAAW,EAAE,CAAC;YACpD,MAAM,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAC7C,MAAM,MAAM,GAAG,MAAM,CAAC,SAAS,EAAE,CAAC;YAElC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE;gBACnC,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;aACpC;YACD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACzC,MAAM,QAAQ,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;gBAC9B,MAAM,IAAI,GAAG,MAAM,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;gBAC5C,IAAI,CAAC,IAAI,EAAE;oBACT,SAAS;iBACV;gBACD,aAAa,CAAC,QAA8B,CAAC,CAAC,OAAO,CAAC,CAAC,IAA0B,EAAE,KAAa,EAAE,EAAE;;oBAClG,IAAI,IAAI,CAAC,OAAO,EAAE;wBAChB,MAAM,IAAI,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;wBAC5C,MAAM,SAAS,GAAG,IAAI,CAAC,WAAW,CAChC;4BACE,IAAI,SAAoB;4BACxB,IAAI,EAAE,GAAG,MAAA,MAAM,CAAC,MAAM,mCAAI,MAAM,CAAC,EAAE,IAAI,QAAQ,UAAU,KAAK,EAAE;yBACjE,EACD,EAAE,gBAAgB,EAAE,MAAM,CAAC,uBAAuB,EAAE,EAAE,CACzC,CAAC;wBAChB,IAAI,IAAI,CAAC,sBAAsB,EAAE;4BAC/B,MAAA,MAAA,MAAM,CAAC,aAAa,0CAAE,gBAAgB,CAAC,IAAI,0CAAE,GAAG,CAAC,SAAS,CAAC,CAAC;yBAC7D;wBACD,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;wBAC1B,IAAI,CAAC,IAAI,CAAC;4BACR,SAAS;4BACT,QAAQ,EAAE,IAAI;4BACd,MAAM;4BACN,SAAS,EAAE,IAAI;yBAChB,CAAC,CAAC;qBACJ;gBACH,CAAC,CAAC,CAAC;aACJ;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAES,mBAAmB;QAC3B,MAAM,iBAAiB,GAAmC,EAAE,CAAC;QAE7D,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC,SAAS,EAAE,IAAI,EAAE,EAAE;YAClD,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;QACtC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,eAAe,EAAE,MAAM,EAAE,EAAE;YACrD,IAAI,IAAI,CAAC,WAAW,KAAK,QAAQ,EAAE;gBACjC,IAAI,KAAK,GAAG,KAAK,CAAC;gBAClB,MAAM,SAAS,GAAG,GAAG,MAAM,CAAC,YAAY,EAAE,CAAC,IAAI,kBAAkB,CAAC;gBAClE,IAAI,SAAS,GAAG,iBAAiB,CAAC,SAAS,CAAC,CAAC;gBAE7C,IAAI,CAAC,SAAS,EAAE;oBACd,KAAK,GAAG,IAAI,CAAC;oBACb,SAAS,GAAG,IAAI,CAAC,WAAW,CAC1B,EAAE,IAAI,aAAwB,EAAE,IAAI,EAAE,SAAS,EAAE,EACjD;wBACE,aAAa,EAAE,OAAO;qBACvB,EACD;wBACE,SAAS,EAAG,IAAI,CAAC,KAAa,CAAC,SAAS;qBACzC,CACF,CAAC;iBACH;gBACD,IAAI,SAAS,EAAE;oBACb,IAAI,KAAK,EAAE;wBACT,SAAS,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;wBACtC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;wBAG/B,eAAe,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;;4BAClC,MAAA,SAAS,CAAC,QAAQ,CAAC,OAAO,EAAE,0CAAE,cAAc,CAAC,SAAS,CAAC,CAAC;wBAC1D,CAAC,CAAC,CAAC;qBACJ;oBAED,IAAI,eAAe,CAAC,CAAC,CAAC,IAAI,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE;wBACtE,SAAS,CAAC,aAAa,CAAC,EAAE,MAAM,EAAE,eAAe,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,CAAC;qBAC1E;oBACD,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,SAA2B,EAAE,GAAG,EAAE;wBAC5D,OAAO,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;oBACxC,CAAC,CAAC,CAAC;oBACH,iBAAiB,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC;iBACrC;aACF;iBAAM;gBACL,eAAe,CAAC,OAAO,CAAC,CAAC,SAAS,EAAE,CAAC,EAAE,EAAE;;oBACvC,IAAI,KAAK,GAAG,KAAK,CAAC;oBAClB,MAAM,SAAS,GAAG,GAAG,SAAS,CAAC,SAAS,CAAC,IAAI,YAAY,CAAC;oBAC1D,IAAI,SAAS,GAAG,iBAAiB,CAAC,SAAS,CAAC,CAAC;oBAC7C,IAAI,CAAC,SAAS,EAAE;wBACd,KAAK,GAAG,IAAI,CAAC;wBACb,SAAS,GAAG,IAAI,CAAC,WAAW,CAC1B,EAAE,IAAI,aAAwB,EAAE,IAAI,EAAE,SAAS,EAAE,EACjD;4BACE,aAAa,EAAE,OAAO;4BACtB,eAAe,EAAE,IAAI;yBACtB,EACD;4BACE,SAAS,EAAE,SAAS,CAAC,QAAQ,CAAC,aAAa,EAAE,CAAC,SAAS;yBACxD,CACF,CAAC;qBACH;oBACD,IAAI,SAAS,EAAE;wBACb,IAAI,OAAO,CAAC,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE;4BACvC,SAAS,CAAC,aAAa,CAAC,EAAE,MAAM,EAAE,SAAS,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,CAAC;yBACjE;wBACD,IAAI,KAAK,EAAE;4BACT,SAAS,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;4BAEtC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;4BAE/B,MAAA,SAAS,CAAC,QAAQ,CAAC,OAAO,EAAE,0CAAE,cAAc,CAAC,SAAS,CAAC,CAAC;yBACzD;wBACD,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,SAA2B,EAAE,GAAG,EAAE;4BAC5D,OAAO,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;wBAC3C,CAAC,CAAC,CAAC;wBACH,iBAAiB,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC;qBACrC;gBACH,CAAC,CAAC,CAAC;aACJ;QACH,CAAC,CAAC,CAAC;QAEH,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YAC5C,MAAM,IAAI,GAAG,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAErC,IAAI,IAAI,EAAE;gBACR,IAAI,CAAC,OAAO,EAAE,CAAC;gBACf,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;aACtC;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAES,kBAAkB;QAC1B,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC,WAAW,EAAE,cAAc,EAAE,EAAE;YAC9D,MAAM,cAAc,GAAG,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC;YAC5C,cAAc,CAAC,OAAO,CAAC,CAAC,EAAE,SAAS,EAAE,EAAE,EAAE;gBACvC,SAAS,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC;YACzC,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;YACtC,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;;gBACxB,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE,MAAM,EAAE,GAAG,IAAI,CAAC;gBAC9C,IAAI,CAAC,qBAAqB,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;gBACjD,IAAI,UAAU,CAAC,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,eAAe,CAAC,EAAE;oBAC1C,MAAM,YAAY,GAAG,SAAS,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;oBACvD,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,IAAI,CAAC,MAAM,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC;iBAClD;gBACD,IAAI,MAAA,MAAA,SAAS,CAAC,UAAU,0CAAE,MAAM,0CAAE,SAAS,EAAE;oBAC3C,SAAS,CAAC,YAAY,CAAC,QAAQ,EAAE,MAAM,CAAC,iBAAiB,EAAE,EAAE,QAAQ,EAAE,cAAc,CAAC,WAAW,CAAC,CAAC;iBACpG;YACH,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IAED,qBAAqB;QACnB,KAAK,CAAC,qBAAqB,EAAE,CAAC;QAC9B,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC,WAAW,EAAE,cAAc,EAAE,EAAE;YAC9D,MAAM,SAAS,GAAG,WAAW,EAAE,CAAC;YAChC,IAAI,OAAO,CAAC,SAAS,CAAC,EAAE;gBACtB,IAAI,CAAC,0BAA0B,CAAC,SAAyB,EAAE,cAAc,CAAC,CAAC;aAC5E;iBAAM;gBACL,IAAI,CAAC,2BAA2B,CAAC,SAAuB,EAAE,cAAc,CAAC,CAAC;aAC3E;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAES,0BAA0B,CAAC,SAAuB,EAAE,cAA8B;QAC1F,IAAI,CAAC,8BAA8B,CACjC,cAAc,EACd,SAAS,CAAC,GAAG,CAAC,CAAC,EAAE,QAAQ,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,EACzC,SAAS,CACV,CAAC;IACJ,CAAC;IAES,2BAA2B,CAAC,SAAqB,EAAE,cAA8B;QACzF,MAAM,EAAE,QAAQ,EAAE,GAAG,SAAS,CAAC;QAC/B,IAAI,CAAC,8BAA8B,CAAC,cAAc,EAAE,QAAQ,EAAE,CAAC,SAAS,CAAC,CAAC,CAAC;IAC7E,CAAC;IAES,8BAA8B,CACtC,cAA8B,EAC9B,QAAyB,EACzB,UAAwB;QAExB,MAAM,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,YAAY,CAAC,CAAC;QAEnE,cAAc,CAAC,aAAa,CAAC;YAC3B,WAAW,EAAE,KAAK;SACnB,CAAC,CAAC;QAEH,cAAc,CAAC,cAAc,CAAC;YAC5B,UAAU,EAAE,CAAC,UAAkB,EAAE,EAAE;;gBACjC,MAAM,SAAS,GAAG,UAAU,CAAC,UAAU,CAAC,CAAC;gBACzC,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE,MAAM,EAAE,GAAG,SAAS,CAAC;gBACnD,MAAM,IAAI,GAAG,SAAS,CAAC,OAAO,EAAE,CAAC;gBACjC,MAAM,WAAW,GAAG,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;gBAEvD,MAAM,YAAY,GAAG,MAAA,MAAC,IAAI,CAAC,KAAa,0CAAE,YAAY,mCAAI,CAAC,CAAC;gBAC5D,IAAI,IAAI,GAAG,SAAS,CAClB;oBACE,SAAS,kBAAI,QAAQ,EAAE,SAAS,CAAC,WAAW,KAAK,IAAI,IAAK,SAAS,CAAC,KAAK,CAAE;oBAC3E,OAAO,EAAE;wBACP,UAAU,EAAE,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAC,YAAY,EAAE,CAAC;qBACrE;iBACF,EACD,kBAAkB,CAAC,IAAI,EAAE,SAAS,CAAC,gDAE9B,WAAW,CAAC,SAAS,EAAE,CAAC,UAAU,EAAE,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,qBAAqB,EAAE,iBAAiB,CAAC,CAAC,GACxG,WAAW,KACd,YAAY,KAEd,SAAS,CAAC,mBAAmB;oBAC3B,CAAC,CAAC;wBACE,UAAU,EACR,SAAS,CAAC,mBAAmB,KAAK,KAAK;4BACrC,CAAC,CAAC,CAAC,IAAS,EAAE,EAAE;gCACZ,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,CAAM,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC,CAAC;4BACnE,CAAC;4BACH,CAAC,CAAC,CAAC,IAAS,EAAE,EAAE;gCACZ,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,CAAM,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC,CAAC;4BAChE,CAAC;qBACR;oBACH,CAAC,CAAC,EAAE,CACP,CAAC;gBAEF,IAAI,MAAM,IAAI,MAAM,CAAC,eAAe,EAAE;oBACpC,IAAI,GAAG,MAAM,CAAC,eAAe,CAAC,IAAI,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC;iBAC3D;gBAED,IAAI,IAAI,KAAK,MAAM,IAAI,IAAI,KAAK,MAAM,EAAE;oBACtC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;iBAClB;gBAED,OAAO,IAAI,CAAC;YACd,CAAC;YACD,IAAI,EAAE,GAAG,EAAE;;gBACT,uBACE,OAAO,EAAE,MAAA,UAAU,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,OAAO,0CAAE,OAAO,IAC9C,UAAU,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,aAAa,EAAE,EACnD;YACJ,CAAC;YACD,WAAW,EAAE,CAAC,KAAY,EAAE,EAAE,UAAU,EAA0B,EAAE,EAAE;gBACpE,OAAO,UAAU,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC,SAAS,CAAC,UAAU;oBAC3E,CAAC,CAAC,aAAa,CACX,UAAU,CAAC,UAAU,CAAC,EACtB,KAAK,EACL,UAAU,CAAC,UAAU,CAAC,CAAC,SAAS,CAAC,YAAY,EAC7C,UAAU,CAAC,UAAU,CAAC,CAAC,SAAS,CAAC,SAAS,CAC3C;oBACH,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC;YACtB,CAAC;SACF,CAAC,CAAC;QAEH,IAAI,CAAC,wBAAwB,CAAC,cAAc,EAAE,QAAQ,CAAC,CAAC;IAC1D,CAAC;IAED,YAAY;QACV,IAAI,CAAC,QAAQ,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;YAC1B,MAAM,SAAS,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,CAAmB,CAAC,EAAE,CAAC;YACrE,IAAI,KAAK,CAAC;YACV,IAAI,OAAO,CAAC,SAAS,CAAC,EAAE;gBACtB,KAAK,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,YAAY,EAAE,CAAC,UAAU,EAAY,CAAC;aAC/E;iBAAM;gBACL,KAAK,GAAG,SAAS,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,YAAY,EAAE,CAAC,UAAU,EAAY,CAAC;aAC5E;YACD,CAAC,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC;QACvB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,yBAAyB,CAAC,IAAc;QACtC,IAAI,SAAqB,CAAC;QAC1B,MAAM,YAAY,GAAG,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,MAAM,CAAC;QAClC,MAAM,gBAAgB,GAAG,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,MAAM,CAAC;QAC9C,IAAI,gBAAgB,EAAE;YACpB,MAAM,UAAU,GAAG,gBAAgB,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,YAAmB,CAAC,CAAC;YAC/E,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,SAAS,EAAE,EAAE;gBACtD,MAAM,WAAW,GAAG,SAAS,CAAC,YAAY,EAAE,CAAC;gBAC7C,IAAI,WAAW,KAAK,gBAAgB,EAAE;oBACpC,SAAS,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC;iBAC3C;YACH,CAAC,CAAC,CAAC;SACJ;QACD,OAAO,SAAS,CAAC;IACnB,CAAC;;AArYM,UAAI,GAAG,iBAAiB,CAAC,KAAK,CAAC;AAI/B,aAAO,GAAG,OAAO,CAAC;AAGT,4BAAsB,GAAG,oBAA2B,CAAC;AAiYvE,MAAM,CAAC,MAAM,aAAa,GAAG,GAAG,EAAE;IAChC,OAAO,CAAC,wBAAwB,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,KAAqB,EAAE,EAAE;QACrE,OAAO,IAAI,SAAS,CAAC,KAAK,CAAsB,CAAC;IACnD,CAAC,CAAC,CAAC;IACH,iBAAiB,EAAE,CAAC;IACpB,qBAAqB,EAAE,CAAC;IACxB,OAAO,CAAC,iBAAiB,CAAC,KAAK,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;AAC/D,CAAC,CAAC","file":"label.js","sourcesContent":["import type { IComponentOption } from '../interface';\n// eslint-disable-next-line no-duplicate-imports\nimport { ComponentTypeEnum } from '../interface/type';\nimport type { IRegion } from '../../region/interface';\nimport type { IModelInitOption, IModelSpecInfo } from '../../model/interface';\nimport { STACK_FIELD_TOTAL_BOTTOM, STACK_FIELD_TOTAL_TOP } from '../../constant/data';\nimport { ChartEvent, HOOK_EVENT } from '../../constant/event';\nimport { AttributeLevel } from '../../constant/attribute';\nimport { LayoutZIndex } from '../../constant/layout';\nimport type { IMark } from '../../mark/interface';\nimport { type IComponentMark, type ILabelMark } from '../../mark/interface';\nimport { MarkTypeEnum } from '../../mark/interface/type';\nimport { mergeSpec } from '@visactor/vutils-extension';\nimport { eachSeries } from '../../util/model';\nimport type { ISeries, SeriesMarkNameEnum } from '../../series/interface';\n// eslint-disable-next-line no-duplicate-imports\nimport { defaultLabelConfig, textAttribute } from './util';\n// eslint-disable-next-line no-duplicate-imports\nimport { registerComponentMark } from '../../mark/component';\nimport { BaseLabelComponent } from './base-label';\nimport type { Maybe } from '@visactor/vutils';\n// eslint-disable-next-line no-duplicate-imports\nimport { array, isArray, isFunction, isValid, pickWithout } from '@visactor/vutils';\nimport type { ILabelInfo, ILabelSpec, TransformedLabelSpec } from './interface';\nimport { Factory } from '../../core/factory';\n// eslint-disable-next-line no-duplicate-imports\nimport { registerLabelMark } from '../../mark/label';\nimport type { IChartSpecInfo } from '../../chart/interface';\nimport type { Datum, IChartSpec } from '../../typings';\nimport { LabelSpecTransformer } from './label-transformer';\nimport type { IGraphic, IGroup } from '@visactor/vrender-core';\nimport type { DataLabelAttrs } from '@visactor/vrender-components';\nimport { DataLabel } from '@visactor/vrender-components';\n\nexport class Label<T extends IChartSpec = any> extends BaseLabelComponent<T> {\n  static type = ComponentTypeEnum.label;\n  type = ComponentTypeEnum.label;\n  name: string = ComponentTypeEnum.label;\n\n  static specKey = 'label';\n  specKey = 'label';\n\n  static readonly transformerConstructor = LabelSpecTransformer as any;\n  readonly transformerConstructor = LabelSpecTransformer;\n\n  layoutZIndex: number = LayoutZIndex.Label;\n\n  protected _labelInfoMap: Map<IRegion, ILabelInfo[]>;\n\n  protected _labelComponentMap: Map<IComponentMark, () => ILabelInfo | ILabelInfo[]>;\n\n  protected _layoutRule: 'series' | 'region';\n\n  constructor(spec: T, options: IComponentOption) {\n    super(spec, options);\n    this._layoutRule = (spec as any).labelLayout || 'series';\n  }\n\n  static getSpecInfo(chartSpec: any, chartSpecInfo: IChartSpecInfo): Maybe<IModelSpecInfo[]> {\n    const specInfo: IModelSpecInfo[] = [];\n    const regionSpecInfo = chartSpecInfo?.region || [];\n    const isLabelVisible = (labelSpecList: ILabelSpec[]) => {\n      return labelSpecList.some(labelSpec => labelSpec.visible);\n    };\n\n    regionSpecInfo.forEach((regionInfo, i) => {\n      const seriesIndexes = regionInfo.seriesIndexes || [];\n      const hasVisibleLabel = seriesIndexes.some(seriesIndex => {\n        const seriesInfo = chartSpecInfo.series[seriesIndex];\n        const { markLabelSpec = {} } = seriesInfo;\n\n        return Object.values(markLabelSpec).some(\n          labelSpecList => Array.isArray(labelSpecList) && isLabelVisible(labelSpecList)\n        );\n      });\n      if (hasVisibleLabel) {\n        specInfo.push({\n          spec: chartSpec,\n          type: ComponentTypeEnum.label,\n          specInfoPath: ['component', this.specKey, i],\n          regionIndexes: [i]\n        });\n      }\n    });\n    return specInfo;\n  }\n\n  init(option: IModelInitOption): void {\n    super.init(option);\n    this.initEvent();\n    this._initTextMark();\n    this._initLabelComponent();\n    this._initTextMarkStyle();\n  }\n\n  reInit(spec?: T) {\n    super.reInit(spec);\n\n    if (this._labelInfoMap) {\n      this._labelInfoMap.forEach(labelInfos => {\n        labelInfos.forEach(({ labelMark }) => {\n          labelMark.release();\n        });\n      });\n      this._labelInfoMap.clear();\n    }\n    this._labelInfoMap && this._labelInfoMap.clear();\n    this._initTextMark();\n    this._initLabelComponent();\n    this._initTextMarkStyle();\n  }\n\n  initEvent() {\n    this.event.on(ChartEvent.dataZoomChange, () => {\n      this._labelComponentMap.forEach((info, component) => {\n        const graphicItem = component.getComponent();\n        if (graphicItem) {\n          graphicItem.disableAnimation();\n        }\n      });\n      this.event.on(HOOK_EVENT.AFTER_MARK_RENDER_END, enableAnimation);\n    });\n    const enableAnimation = () => {\n      this._labelComponentMap.forEach((info, component) => {\n        const graphicItem = component.getComponent();\n        if (graphicItem) {\n          graphicItem.enableAnimation();\n        }\n      });\n      this.event.off(HOOK_EVENT.AFTER_MARK_RENDER_END, enableAnimation);\n    };\n  }\n\n  protected _initTextMark() {\n    if (!this._labelInfoMap) {\n      this._labelInfoMap = new Map();\n    }\n\n    if (!this._labelComponentMap) {\n      this._labelComponentMap = new Map();\n    }\n    eachSeries(this._regions, (series: ISeries) => {\n      const { markLabelSpec = {} } = series.getSpecInfo();\n      const markNames = Object.keys(markLabelSpec);\n      const region = series.getRegion();\n\n      if (!this._labelInfoMap.get(region)) {\n        this._labelInfoMap.set(region, []);\n      }\n      for (let i = 0; i < markNames.length; i++) {\n        const markName = markNames[i];\n        const mark = series.getMarkInName(markName);\n        if (!mark) {\n          continue;\n        }\n        markLabelSpec[markName as SeriesMarkNameEnum].forEach((spec: TransformedLabelSpec, index: number) => {\n          if (spec.visible) {\n            const info = this._labelInfoMap.get(region);\n            const labelMark = this._createMark(\n              {\n                type: MarkTypeEnum.label,\n                name: `${series.userId ?? series.id}-${markName}-label-${index}`\n              },\n              { attributeContext: series.getMarkAttributeContext() }\n            ) as ILabelMark;\n            if (spec.showRelatedMarkTooltip) {\n              series.tooltipHelper?.activeTriggerSet.mark?.add(labelMark);\n            }\n            labelMark.setTarget(mark);\n            info.push({\n              labelMark,\n              baseMark: mark,\n              series,\n              labelSpec: spec\n            });\n          }\n        });\n      }\n    });\n  }\n\n  protected _initLabelComponent() {\n    const removedComponents: Record<string, IComponentMark> = {};\n\n    this._labelComponentMap.forEach((labelInfo, comp) => {\n      removedComponents[comp.name] = comp;\n    });\n\n    this._labelInfoMap.forEach((regionLabelInfo, region) => {\n      if (this._layoutRule === 'region') {\n        let isNew = false;\n        const labelName = `${region.getGroupMark().name}-label-component`;\n        let component = removedComponents[labelName];\n\n        if (!component) {\n          isNew = true;\n          component = this._createMark(\n            { type: MarkTypeEnum.component, name: labelName },\n            {\n              componentType: 'label'\n            },\n            {\n              support3d: (this._spec as any).support3d\n            }\n          );\n        }\n        if (component) {\n          if (isNew) {\n            component.setSkipBeforeLayouted(true);\n            this._marks.addMark(component);\n\n            // 当任意主图元数据更新的时候，都需要触发label的更新\n            regionLabelInfo.forEach(labelInfo => {\n              labelInfo.baseMark.getData()?.addRelatedMark(component);\n            });\n          }\n\n          if (regionLabelInfo[0] && isValid(regionLabelInfo[0].labelSpec.zIndex)) {\n            component.setMarkConfig({ zIndex: regionLabelInfo[0].labelSpec.zIndex });\n          }\n          this._labelComponentMap.set(component as IComponentMark, () => {\n            return this._labelInfoMap.get(region);\n          });\n          removedComponents[labelName] = null;\n        }\n      } else {\n        regionLabelInfo.forEach((labelInfo, i) => {\n          let isNew = false;\n          const labelName = `${labelInfo.labelMark.name}-component`;\n          let component = removedComponents[labelName];\n          if (!component) {\n            isNew = true;\n            component = this._createMark(\n              { type: MarkTypeEnum.component, name: labelName },\n              {\n                componentType: 'label',\n                noSeparateStyle: true\n              },\n              {\n                support3d: labelInfo.baseMark.getMarkConfig().support3d\n              }\n            );\n          }\n          if (component) {\n            if (isValid(labelInfo.labelSpec.zIndex)) {\n              component.setMarkConfig({ zIndex: labelInfo.labelSpec.zIndex });\n            }\n            if (isNew) {\n              component.setSkipBeforeLayouted(true);\n\n              this._marks.addMark(component);\n              // 当主图元数据更新的时候，都需要触发label的更新\n              labelInfo.baseMark.getData()?.addRelatedMark(component);\n            }\n            this._labelComponentMap.set(component as IComponentMark, () => {\n              return this._labelInfoMap.get(region)[i];\n            });\n            removedComponents[labelName] = null;\n          }\n        });\n      }\n    });\n\n    Object.keys(removedComponents).forEach(name => {\n      const comp = removedComponents[name];\n\n      if (comp) {\n        comp.release(); // todo 是否要上报\n        this._labelComponentMap.delete(comp);\n      }\n    });\n  }\n\n  protected _initTextMarkStyle() {\n    this._labelComponentMap.forEach((labelInfoCb, labelComponent) => {\n      const labelInfoArray = array(labelInfoCb());\n      labelInfoArray.forEach(({ labelMark }) => {\n        labelMark.setComponent(labelComponent);\n      });\n    });\n    this._labelInfoMap.forEach(labelInfos => {\n      labelInfos.forEach(info => {\n        const { labelMark, labelSpec, series } = info;\n        this.initMarkStyleWithSpec(labelMark, labelSpec);\n        if (isFunction(labelSpec?.getStyleHandler)) {\n          const styleHandler = labelSpec.getStyleHandler(series);\n          styleHandler?.call(series, labelMark, labelSpec);\n        }\n        if (labelMark.stateStyle?.normal?.lineWidth) {\n          labelMark.setAttribute('stroke', series.getColorAttribute(), 'normal', AttributeLevel.Base_Series);\n        }\n      });\n    });\n  }\n\n  updateLayoutAttribute(): void {\n    super.updateLayoutAttribute();\n    this._labelComponentMap.forEach((labelInfoCb, labelComponent) => {\n      const labelInfo = labelInfoCb();\n      if (isArray(labelInfo)) {\n        this._updateMultiLabelAttribute(labelInfo as ILabelInfo[], labelComponent);\n      } else {\n        this._updateSingleLabelAttribute(labelInfo as ILabelInfo, labelComponent);\n      }\n    });\n  }\n\n  protected _updateMultiLabelAttribute(labelInfo: ILabelInfo[], labelComponent: IComponentMark) {\n    this._updateLabelComponentAttribute(\n      labelComponent,\n      labelInfo.map(({ baseMark }) => baseMark),\n      labelInfo\n    );\n  }\n\n  protected _updateSingleLabelAttribute(labelInfo: ILabelInfo, labelComponent: IComponentMark) {\n    const { baseMark } = labelInfo;\n    this._updateLabelComponentAttribute(labelComponent, baseMark, [labelInfo]);\n  }\n\n  protected _updateLabelComponentAttribute(\n    labelComponent: IComponentMark,\n    baseMark: IMark | IMark[],\n    labelInfos: ILabelInfo[]\n  ) {\n    const totalLabels = this._option.getComponentsByType('totalLabel');\n\n    labelComponent.setMarkConfig({\n      interactive: false\n    });\n\n    labelComponent.setSimpleStyle({\n      labelStyle: (labelIndex: number) => {\n        const labelInfo = labelInfos[labelIndex];\n        const { labelSpec, labelMark, series } = labelInfo;\n        const rule = labelMark.getRule();\n        const interactive = this._interactiveConfig(labelSpec);\n        /** arc label When setting the centerOffset of the spec, the label also needs to be offset accordingly, and the centerOffset is not in the labelSpec */\n        const centerOffset = (this._spec as any)?.centerOffset ?? 0;\n        let spec = mergeSpec(\n          {\n            textStyle: { pickable: labelSpec.interactive === true, ...labelSpec.style },\n            overlap: {\n              avoidMarks: totalLabels.map(cmp => cmp.getMarks()[0].getProductId())\n            }\n          },\n          defaultLabelConfig(rule, labelInfo),\n          {\n            ...pickWithout(labelSpec, ['position', 'style', 'state', 'type', 'stackDataFilterType', 'getStyleHandler']),\n            ...interactive,\n            centerOffset\n          },\n          labelSpec.stackDataFilterType\n            ? {\n                dataFilter:\n                  labelSpec.stackDataFilterType === 'min'\n                    ? (data: any) => {\n                        return data.filter((d: any) => d.data[STACK_FIELD_TOTAL_BOTTOM]);\n                      }\n                    : (data: any) => {\n                        return data.filter((d: any) => d.data[STACK_FIELD_TOTAL_TOP]);\n                      }\n              }\n            : {}\n        );\n\n        if (series && series.parseLabelStyle) {\n          spec = series.parseLabelStyle(spec, labelSpec, labelMark);\n        }\n        // TODO 可以优化。vgrammar 的 label 图元类型分发是完全依赖 baseMark 的类型。默认情况下，line/area 图元的标签会使用'line-data'标签，此时需要 vchart 将类型传给 vgrammar\n        if (rule === 'line' || rule === 'area') {\n          spec.type = rule;\n        }\n\n        return spec;\n      },\n      size: () => {\n        return {\n          padding: labelInfos[0].labelSpec.overlap?.padding,\n          ...labelInfos[0].series.getRegion().getLayoutRect()\n        };\n      },\n      itemEncoder: (datum: Datum, { labelIndex }: { labelIndex: number }) => {\n        return labelInfos[labelIndex] && !labelInfos[labelIndex].labelMark.skipEncode\n          ? textAttribute(\n              labelInfos[labelIndex],\n              datum,\n              labelInfos[labelIndex].labelSpec.formatMethod,\n              labelInfos[labelIndex].labelSpec.formatter\n            )\n          : { data: datum };\n      }\n    });\n\n    this._setTransformOfComponent(labelComponent, baseMark);\n  }\n\n  compileMarks() {\n    this.getMarks().forEach(m => {\n      const labelInfo = this._labelComponentMap.get(m as IComponentMark)();\n      let group;\n      if (isArray(labelInfo)) {\n        group = labelInfo[0].series.getRegion().getGroupMark().getProduct() as IGroup;\n      } else {\n        group = labelInfo.series.getRegion().getGroupMark().getProduct() as IGroup;\n      }\n      m.compile({ group });\n    });\n  }\n\n  getLabelInfoByTextGraphic(text: IGraphic): ILabelInfo {\n    let labelInfo: ILabelInfo;\n    const vrenderLabel = text?.parent;\n    const vrenderDataLabel = vrenderLabel?.parent;\n    if (vrenderDataLabel) {\n      const labelIndex = vrenderDataLabel.getChildren().indexOf(vrenderLabel as any);\n      this._labelComponentMap.forEach((infoFunc, component) => {\n        const graphicItem = component.getComponent();\n        if (graphicItem === vrenderDataLabel) {\n          labelInfo = array(infoFunc())[labelIndex];\n        }\n      });\n    }\n    return labelInfo;\n  }\n}\n\nexport const registerLabel = () => {\n  Factory.registerGraphicComponent(Label.type, (attrs: DataLabelAttrs) => {\n    return new DataLabel(attrs) as unknown as IGroup;\n  });\n  registerLabelMark();\n  registerComponentMark();\n  Factory.registerComponent(Label.type, Label, true, Infinity); // 标签组件最后创建\n};\n"]}