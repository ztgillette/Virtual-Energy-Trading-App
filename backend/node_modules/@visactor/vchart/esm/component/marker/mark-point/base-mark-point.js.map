{"version":3,"sources":["../src/component/marker/mark-point/base-mark-point.ts"],"names":[],"mappings":"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","file":"base-mark-point.js","sourcesContent":["import type { IMarkPoint, IMarkPointSpec } from './interface';\nimport {\n  computeClipRange,\n  computeOffsetFromRegion,\n  getMarkPointProcessInfo,\n  transformLabelAttributes,\n  transformOffset,\n  transformState,\n  transformStyle\n} from '../utils';\nimport type { MarkPointAttrs } from '@visactor/vrender-components';\n// eslint-disable-next-line no-duplicate-imports\nimport { MarkPoint as MarkPointComponent } from '@visactor/vrender-components';\nimport { isValid, merge } from '@visactor/vutils';\nimport { transformToGraphic } from '../../../util/style';\nimport { BaseMarker } from '../base-marker';\nimport { LayoutZIndex } from '../../../constant/layout';\nimport type { IGroup } from '@visactor/vrender-core';\nimport type { IMarkerLabelSpec } from '../interface';\n\nexport abstract class BaseMarkPoint extends BaseMarker<IMarkPointSpec> implements IMarkPoint {\n  static specKey = 'markPoint';\n  specKey = 'markPoint';\n\n  layoutZIndex: number = LayoutZIndex.MarkPoint;\n  declare protected _markerComponent: MarkPointComponent;\n\n  protected abstract _computePointsAttr(): any;\n\n  static _getMarkerCoordinateType(markerSpec: any): string {\n    const { doPolarProcess, doGeoProcess } = getMarkPointProcessInfo(markerSpec);\n    if (markerSpec.coordinateType === 'polar' || doPolarProcess) {\n      return 'polar';\n    } else if (markerSpec.coordinateType === 'geo' || doGeoProcess) {\n      return 'geo';\n    }\n    return 'cartesian';\n  }\n\n  protected _createMarkerComponent() {\n    const { itemContent = {}, itemLine = {}, targetSymbol = {} } = this._spec;\n    const {\n      type = 'text',\n\n      // 老写法\n      text: label,\n      symbol,\n      image,\n      richText,\n      customMark,\n      textStyle,\n      symbolStyle,\n      imageStyle,\n      richTextStyle,\n      customMarkStyle,\n\n      // 新写法\n      style = {},\n      state = {},\n\n      ...restItemContent\n    } = itemContent as any;\n\n    let itemContentState = null;\n    let itemContentStyle = null;\n    let defaultStyle = {};\n\n    if (type === 'text') {\n      itemContentState = label?.state ?? state;\n      defaultStyle = {\n        dx: 0,\n        dy: 0\n      };\n      itemContentStyle = transformLabelAttributes(\n        merge(defaultStyle, label ?? textStyle ?? (style as IMarkerLabelSpec)),\n        this._markerData,\n        this._markAttributeContext\n      );\n    } else if ((type as any) === 'richText') {\n      itemContentState = richText?.state ?? state;\n      defaultStyle = {\n        width: 100,\n        height: 100\n      };\n      itemContentStyle = transformStyle(\n        merge(defaultStyle, richText?.style ?? richTextStyle ?? style),\n        this._markerData,\n        this._markAttributeContext\n      );\n    } else if (type === 'symbol') {\n      itemContentState = symbol?.state ?? state;\n      defaultStyle = {\n        symbolType: 'star',\n        fill: 'rgb(48, 115, 242)',\n        fillOpacity: 0.8,\n        size: 20\n      };\n      itemContentStyle = transformToGraphic(\n        transformStyle(\n          merge(defaultStyle, symbol?.style ?? symbolStyle ?? style),\n          this._markerData,\n          this._markAttributeContext\n        )\n      );\n    } else if (type === 'image') {\n      itemContentState = image?.state ?? state;\n      defaultStyle = {\n        width: 80,\n        height: 80\n      };\n      itemContentStyle = transformStyle(\n        merge(defaultStyle, image?.style ?? imageStyle ?? style),\n        this._markerData,\n        this._markAttributeContext\n      );\n    } else if (type === 'custom') {\n      itemContentState = customMark?.state ?? state;\n      itemContentStyle = transformStyle(\n        customMark?.style ?? customMarkStyle ?? style,\n        this._markerData,\n        this._markAttributeContext\n      );\n    }\n    const markPointAttrs: MarkPointAttrs = {\n      zIndex: this.layoutZIndex,\n      interactive: this._spec.interactive ?? true,\n      hover: this._spec.interactive ?? true,\n      select: this._spec.interactive ?? true,\n      position: { x: 0, y: 0 },\n      clipInRange: this._spec.clip ?? false,\n      itemContent: {\n        type,\n        offsetX: transformOffset(itemContent.offsetX, this._relativeSeries.getRegion()),\n        offsetY: transformOffset(itemContent.offsetX, this._relativeSeries.getRegion()),\n        ...restItemContent, // Tips: 因为网站 demo 上已经透出了 imageStyle richTextStyle 的写法，为了兼容所以这个需要在后面覆盖\n        style: transformStyle(itemContentStyle, this._markerData, this._markAttributeContext)\n      },\n      targetSymbol: {\n        offset: targetSymbol.offset ?? 0,\n        visible: targetSymbol.visible ?? false,\n        size: targetSymbol.size ?? 20,\n        style: transformStyle(targetSymbol.style, this._markerData, this._markAttributeContext)\n      },\n      state: {\n        line: transformState(this._spec.itemLine.line?.state ?? {}, this._markerData, this._markAttributeContext),\n        lineStartSymbol: transformState(\n          this._spec.itemLine.startSymbol?.state ?? {},\n          this._markerData,\n          this._markAttributeContext\n        ),\n        lineEndSymbol: transformState(\n          this._spec.itemLine.endSymbol?.state ?? {},\n          this._markerData,\n          this._markAttributeContext\n        ),\n        itemContent: transformState(itemContentState, this._markerData, this._markAttributeContext),\n        textBackground: transformState(\n          this._spec.itemContent.text?.labelBackground?.state,\n          this._markerData,\n          this._markAttributeContext\n        ),\n        targetItem: transformState(this._spec.targetSymbol?.state ?? {}, this._markerData, this._markAttributeContext)\n      },\n      animation: this._spec.animation ?? false,\n      animationEnter: this._spec.animationEnter,\n      animationExit: this._spec.animationExit,\n      animationUpdate: this._spec.animationUpdate\n    };\n\n    const { visible, line = {}, ...restItemLine } = itemLine;\n    if (visible !== false) {\n      markPointAttrs.itemLine = {\n        ...restItemLine,\n        visible: true,\n        lineStyle: transformToGraphic(line.style)\n      } as any;\n    } else {\n      markPointAttrs.itemLine = {\n        visible: false\n      };\n    }\n\n    const markPoint = new MarkPointComponent(markPointAttrs);\n    return markPoint as unknown as IGroup;\n  }\n\n  protected _markerLayout() {\n    const spec = this._spec;\n    const data = this._markerData;\n    const relativeSeries = this._relativeSeries;\n\n    const { point } = this._computePointsAttr();\n\n    const seriesData = this._getRelativeDataView().latestData;\n    const dataPoints = data\n      ? data.latestData[0] && data.latestData[0].latestData\n        ? data.latestData[0].latestData\n        : data.latestData\n      : seriesData;\n\n    let limitRect;\n    if (spec.clip || spec.itemContent?.confine) {\n      const { minX, maxX, minY, maxY } = computeClipRange([relativeSeries.getRegion()]);\n      limitRect = {\n        x: minX,\n        y: minY,\n        width: maxX - minX,\n        height: maxY - minY\n      };\n    }\n    if (this._markerComponent) {\n      const attribute = this._markerComponent.attribute ?? {};\n      const textStyle = (attribute.itemContent as any)?.textStyle ?? {};\n      this._markerComponent.setAttributes({\n        position: point === undefined ? { x: null, y: null } : point, // setAttrs时merge时undefined会被忽略, 所以这里做转换\n        itemContent: {\n          ...attribute.itemContent,\n          textStyle: {\n            ...textStyle,\n            text: this._spec.itemContent.text?.formatMethod\n              ? // type error here will be fixed in components\n                (this._spec.itemContent.text.formatMethod(dataPoints, seriesData) as any)\n              : textStyle.text\n          },\n          offsetX: computeOffsetFromRegion(point, attribute.itemContent.offsetX, this._relativeSeries.getRegion()),\n          offsetY: computeOffsetFromRegion(point, attribute.itemContent.offsetY, this._relativeSeries.getRegion())\n        } as any,\n        limitRect,\n        dx: this._layoutOffsetX,\n        dy: this._layoutOffsetY\n      });\n    }\n  }\n\n  protected _initDataView(): void {\n    const spec = this._spec as any;\n    const { doXYProcess, doPolarProcess, doGeoProcess } = getMarkPointProcessInfo(spec);\n    const isCoordinateProcess = isValid(spec.coordinate);\n    if (!isCoordinateProcess && !doXYProcess && !doPolarProcess && !doGeoProcess) {\n      return;\n    }\n\n    this._initCommonDataView();\n  }\n}\n"]}