{"version":3,"sources":["../src/layout/util.ts"],"names":[],"mappings":"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","file":"util.js","sourcesContent":["import { isNil, last, isEqual } from '@visactor/vutils';\nimport type { Layout } from './base-layout';\nimport type { ILayoutItem } from './interface';\nimport type { ILayoutRect } from '../typings';\n\nexport type IRecompute = {\n  recomputeWidth: boolean;\n  recomputeHeight: boolean;\n};\n\nfunction getPositionItems(items: ILayoutItem[]) {\n  const startItems: ILayoutItem[] = [];\n  const middleItems: ILayoutItem[] = [];\n  const endItems: ILayoutItem[] = [];\n\n  items.forEach(item => {\n    if (isNil(item.getSpec().position) || item.getSpec().position === 'start') {\n      startItems.push(item);\n    } else if (item.getSpec().position === 'middle') {\n      middleItems.push(item);\n    } else if (item.getSpec().position === 'end') {\n      endItems.push(item);\n    }\n  });\n\n  return {\n    startItems,\n    endItems,\n    middleItems\n  };\n}\n\nfunction adjustItemsToCenter(allItems: ILayoutItem[][], isVertical: boolean, containerLength: number) {\n  if (isVertical) {\n    allItems.forEach(items => {\n      const lastItem = last(items);\n      const length =\n        lastItem.getLayoutStartPoint().y + lastItem.getLayoutRect().height - items[0].getLayoutStartPoint().y;\n      const centerY = (containerLength - length) / 2;\n\n      items.forEach(item => {\n        item.setLayoutStartPosition({\n          x: item.getLayoutStartPoint().x,\n          y: item.getLayoutStartPoint().y + centerY\n        });\n      });\n    });\n  } else {\n    allItems.forEach(items => {\n      const lastItem = last(items);\n      const length =\n        lastItem.getLayoutStartPoint().x + lastItem.getLayoutRect().width - items[0].getLayoutStartPoint().x;\n      const centerX = (containerLength - length) / 2;\n\n      items.forEach(item => {\n        item.setLayoutStartPosition({\n          x: item.getLayoutStartPoint().x + centerX,\n          y: item.getLayoutStartPoint().y\n        });\n      });\n    });\n  }\n}\n\nfunction alignSelfOfItems(allItems: ILayoutItem[][], isVertical: boolean, maxSizes: number[], sign: number) {\n  let maxSize: number;\n\n  allItems.forEach((lineItems: ILayoutItem[], index: number) => {\n    if (lineItems.length > 1) {\n      maxSize = maxSizes[index];\n\n      lineItems.forEach(item => {\n        if (!item.alignSelf || item.alignSelf === 'start') {\n          return;\n        }\n\n        const pos = item.getLayoutStartPoint();\n        const ratio = item.alignSelf === 'middle' ? 0.5 : 1;\n        const delta = isVertical\n          ? maxSize - (item.getLayoutRect().width + item.layoutPaddingLeft + item.layoutPaddingRight)\n          : maxSize - (item.getLayoutRect().height + item.layoutPaddingTop + item.layoutPaddingBottom);\n\n        if (isVertical) {\n          item.setLayoutStartPosition({\n            x: pos.x + sign * delta * ratio,\n            y: pos.y\n          });\n        } else {\n          item.setLayoutStartPosition({\n            x: pos.x,\n            y: pos.y + sign * delta * ratio\n          });\n        }\n      });\n    }\n  });\n}\n\nfunction layoutLeftRightStartOrMiddleItems(\n  items: ILayoutItem[],\n  layout: Layout,\n  limitHeight: number,\n  isMiddle: boolean,\n  position: 'left' | 'right',\n  recompute: IRecompute\n) {\n  if (items.length) {\n    let maxWidth = 0;\n    const isRight = position === 'right';\n    const xSign = isRight ? -1 : 1;\n    let preX = isRight ? layout.rightCurrent : layout.leftCurrent;\n    let preTop = layout.topCurrent;\n\n    const allItems: ILayoutItem[][] = [];\n    let singleLineItems: ILayoutItem[] = [];\n    const maxWidths: number[] = [];\n    items.forEach(item => {\n      const { rect } = getItemLayoutWithTag(item, layout, recompute);\n      const itemTotalHeight = rect.height + item.layoutPaddingTop + item.layoutPaddingBottom;\n      const itemTotalWidth = rect.width + item.layoutPaddingLeft + item.layoutPaddingRight;\n      const itemOffsetX = isRight ? -rect.width - item.layoutPaddingRight : item.layoutPaddingLeft;\n      item.setLayoutStartPosition({\n        x: preX + item.layoutOffsetX + itemOffsetX,\n        y: preTop + item.layoutOffsetY + item.layoutPaddingTop\n      });\n\n      preTop += itemTotalHeight;\n      if (preTop > limitHeight && singleLineItems.length) {\n        maxWidths.push(maxWidth);\n        preX += xSign * maxWidth;\n        maxWidth = itemTotalWidth;\n        preTop = layout.topCurrent + itemTotalHeight;\n\n        item.setLayoutStartPosition({\n          x: preX + item.layoutOffsetX + itemOffsetX,\n          y: layout.topCurrent + item.layoutOffsetY + item.layoutPaddingTop\n        });\n        allItems.push(singleLineItems);\n        singleLineItems = [item];\n      } else {\n        maxWidth = Math.max(maxWidth, itemTotalWidth);\n        singleLineItems.push(item);\n      }\n    });\n    maxWidths.push(maxWidth);\n    allItems.push(singleLineItems);\n\n    alignSelfOfItems(allItems, true, maxWidths, xSign);\n\n    if (isMiddle) {\n      adjustItemsToCenter(allItems, true, limitHeight);\n    }\n\n    if (isRight) {\n      layout.rightCurrent = preX + xSign * maxWidth;\n    } else {\n      layout.leftCurrent = preX + xSign * maxWidth;\n    }\n  }\n}\n\nfunction layoutLeftRightEndItems(\n  items: ILayoutItem[],\n  layout: Layout,\n  limitWidth: number,\n  position: 'left' | 'right',\n  recompute: IRecompute\n) {\n  if (items.length) {\n    let maxWidth = 0;\n    const isRight = position === 'right';\n    const xSign = isRight ? -1 : 1;\n    let preX = isRight ? layout.rightCurrent : layout.leftCurrent;\n    let preBottom = layout.bottomCurrent;\n\n    const allItems: ILayoutItem[][] = [];\n    let singleLineItems: ILayoutItem[] = [];\n    const maxWidths: number[] = [];\n    items.forEach(item => {\n      const { rect } = getItemLayoutWithTag(item, layout, recompute);\n      const itemTotalHeight = rect.height + item.layoutPaddingTop + item.layoutPaddingBottom;\n      const itemTotalWidth = rect.width + item.layoutPaddingLeft + item.layoutPaddingRight;\n      const itemOffsetX = isRight ? -rect.width - item.layoutPaddingRight : item.layoutPaddingLeft;\n\n      if (preBottom < itemTotalHeight && singleLineItems.length) {\n        maxWidths.push(maxWidth);\n        preX += xSign * maxWidth;\n        maxWidth = itemTotalWidth;\n        preBottom = layout.bottomCurrent;\n\n        item.setLayoutStartPosition({\n          x: preX + item.layoutOffsetX + itemOffsetX,\n          y: preBottom + item.layoutOffsetY - rect.height - item.layoutPaddingBottom\n        });\n        allItems.push(singleLineItems);\n        singleLineItems = [item];\n      } else {\n        item.setLayoutStartPosition({\n          x: preX + item.layoutOffsetX + itemOffsetX,\n          y: preBottom + item.layoutOffsetY - rect.height - item.layoutPaddingBottom\n        });\n        maxWidth = Math.max(maxWidth, itemTotalWidth);\n        preBottom -= itemTotalHeight;\n        singleLineItems.push(item);\n      }\n    });\n    maxWidths.push(maxWidth);\n    allItems.push(singleLineItems);\n\n    alignSelfOfItems(allItems, true, maxWidths, xSign);\n\n    if (isRight) {\n      layout.rightCurrent = preX + xSign * maxWidth;\n    } else {\n      layout.leftCurrent = preX + xSign * maxWidth;\n    }\n  }\n}\n\nfunction layoutTopBottomStartOrMiddleItems(\n  items: ILayoutItem[],\n  layout: Layout,\n  limitWidth: number,\n  isMiddle: boolean,\n  position: 'top' | 'bottom',\n  recompute: IRecompute\n) {\n  if (items.length) {\n    const isTop = position === 'top';\n    const ySign = isTop ? 1 : -1;\n    let maxHeight = 0;\n    let preLeft = layout.leftCurrent;\n    let preY = isTop ? layout.topCurrent : layout.bottomCurrent;\n    const allItems: ILayoutItem[][] = [];\n    let singleLineItems: ILayoutItem[] = [];\n    const maxHeights: number[] = [];\n\n    items.forEach(item => {\n      const { rect } = getItemLayoutWithTag(item, layout, recompute);\n      const itemTotalHeight = rect.height + item.layoutPaddingTop + item.layoutPaddingBottom;\n      const itemTotalWidth = rect.width + item.layoutPaddingLeft + item.layoutPaddingRight;\n      const itemOffsetY = isTop ? item.layoutPaddingTop : -rect.height - item.layoutPaddingBottom;\n      item.setLayoutStartPosition({\n        x: preLeft + item.layoutOffsetX + item.layoutPaddingLeft,\n        y: preY + item.layoutOffsetY + itemOffsetY\n      });\n\n      preLeft += itemTotalWidth;\n      if (preLeft > limitWidth && singleLineItems.length) {\n        maxHeights.push(maxHeight);\n        preLeft = layout.leftCurrent + itemTotalWidth;\n        preY += ySign * maxHeight;\n        maxHeight = itemTotalHeight;\n        item.setLayoutStartPosition({\n          x: layout.leftCurrent + item.layoutOffsetX + item.layoutPaddingLeft,\n          y: preY + item.layoutOffsetY + itemOffsetY\n        });\n        allItems.push(singleLineItems);\n        singleLineItems = [item];\n      } else {\n        maxHeight = Math.max(maxHeight, itemTotalHeight);\n        singleLineItems.push(item);\n      }\n    });\n    maxHeights.push(maxHeight);\n    allItems.push(singleLineItems);\n\n    alignSelfOfItems(allItems, false, maxHeights, ySign);\n\n    if (isMiddle) {\n      adjustItemsToCenter(allItems, false, limitWidth);\n    }\n\n    if (isTop) {\n      layout.topCurrent = preY + ySign * maxHeight;\n    } else {\n      layout.bottomCurrent = preY + ySign * maxHeight;\n    }\n  }\n}\n\nfunction layoutTopBottomEndItems(\n  items: ILayoutItem[],\n  layout: Layout,\n  limitWidth: number,\n  position: 'top' | 'bottom',\n  recompute: IRecompute\n) {\n  if (items.length) {\n    const isTop = position === 'top';\n    const ySign = isTop ? 1 : -1;\n    let maxHeight = 0;\n    let preRight = layout.rightCurrent;\n    let preY = isTop ? layout.topCurrent : layout.bottomCurrent;\n\n    const allItems: ILayoutItem[][] = [];\n    let singleLineItems: ILayoutItem[] = [];\n    const maxHeights: number[] = [];\n\n    items.forEach(item => {\n      const { layoutTag, layoutRect, rect } = getItemLayoutWithTag(item, layout, recompute);\n      const itemTotalHeight = rect.height + item.layoutPaddingTop + item.layoutPaddingBottom;\n      const itemTotalWidth = rect.width + item.layoutPaddingLeft + item.layoutPaddingRight;\n      const itemOffsetY = isTop ? item.layoutPaddingTop : -rect.height - item.layoutPaddingBottom;\n\n      if (preRight < itemTotalWidth && singleLineItems.length) {\n        preRight = layout.rightCurrent;\n        preY += ySign * maxHeight;\n        maxHeight = itemTotalHeight;\n\n        item.setLayoutStartPosition({\n          x: layout.rightCurrent + item.layoutOffsetX - rect.width - item.layoutPaddingRight,\n          y: preY + item.layoutOffsetY + itemOffsetY\n        });\n        allItems.push(singleLineItems);\n        singleLineItems = [item];\n      } else {\n        singleLineItems.push(item);\n        item.setLayoutStartPosition({\n          x: preRight + item.layoutOffsetX - rect.width - item.layoutPaddingRight,\n          y: preY + item.layoutOffsetY + itemOffsetY\n        });\n        maxHeight = Math.max(maxHeight, itemTotalHeight);\n        preRight -= itemTotalWidth;\n      }\n    });\n    maxHeights.push(maxHeight);\n    allItems.push(singleLineItems);\n\n    alignSelfOfItems(allItems, false, maxHeights, ySign);\n\n    if (isTop) {\n      layout.topCurrent = preY + ySign * maxHeight;\n    } else {\n      layout.bottomCurrent = preY + ySign * maxHeight;\n    }\n  }\n}\n\nexport function layoutLeftInlineItems(\n  items: ILayoutItem[],\n  layout: Layout,\n  limitHeight: number,\n  recompute: IRecompute\n) {\n  const { startItems, middleItems, endItems } = getPositionItems(items);\n  if (startItems.length) {\n    layoutLeftRightStartOrMiddleItems(startItems, layout, limitHeight, false, 'left', recompute);\n  }\n\n  if (middleItems.length) {\n    layoutLeftRightStartOrMiddleItems(middleItems, layout, limitHeight, true, 'left', recompute);\n  }\n\n  if (endItems.length) {\n    layoutLeftRightEndItems(endItems, layout, limitHeight, 'left', recompute);\n  }\n}\n\nexport function layoutRightInlineItems(\n  items: ILayoutItem[],\n  layout: Layout,\n  limitHeight: number,\n  recompute: IRecompute\n) {\n  const { startItems, middleItems, endItems } = getPositionItems(items);\n\n  if (startItems.length) {\n    layoutLeftRightStartOrMiddleItems(startItems, layout, limitHeight, false, 'right', recompute);\n  }\n\n  if (middleItems.length) {\n    layoutLeftRightStartOrMiddleItems(middleItems, layout, limitHeight, true, 'right', recompute);\n  }\n\n  if (endItems.length) {\n    layoutLeftRightEndItems(endItems, layout, limitHeight, 'right', recompute);\n  }\n}\n\nexport function layoutTopInlineItems(items: ILayoutItem[], layout: Layout, limitWidth: number, recompute: IRecompute) {\n  const { startItems, middleItems, endItems } = getPositionItems(items);\n\n  if (startItems.length) {\n    layoutTopBottomStartOrMiddleItems(startItems, layout, limitWidth, false, 'top', recompute);\n  }\n\n  if (middleItems.length) {\n    layoutTopBottomStartOrMiddleItems(middleItems, layout, limitWidth, true, 'top', recompute);\n  }\n\n  if (endItems.length) {\n    layoutTopBottomEndItems(endItems, layout, limitWidth, 'top', recompute);\n  }\n}\n\nexport function layoutBottomInlineItems(\n  items: ILayoutItem[],\n  layout: Layout,\n  limitWidth: number,\n  recompute: IRecompute\n) {\n  const { startItems, middleItems, endItems } = getPositionItems(items);\n\n  if (startItems.length) {\n    layoutTopBottomStartOrMiddleItems(startItems, layout, limitWidth, false, 'bottom', recompute);\n  }\n\n  if (middleItems.length) {\n    layoutTopBottomStartOrMiddleItems(middleItems, layout, limitWidth, true, 'bottom', recompute);\n  }\n\n  if (endItems.length) {\n    layoutTopBottomEndItems(endItems, layout, limitWidth, 'bottom', recompute);\n  }\n}\n\nexport function getItemLayoutWithTag(\n  item: ILayoutItem,\n  layout: Layout,\n  recompute: IRecompute,\n  setRectToItem: boolean = true\n) {\n  let layoutRect;\n  let rect;\n  // 如果当前 item 自身不需要布局，同时当前的高度没有变化，那么直接复用上次的布局结果\n  // 这里认为左右两侧布局的元素，如果提供给他的布局高度不变，那么 rect 理论上也不会变化，可以直接复用上次的布局结果\n  let checkTagKey: keyof IRecompute = 'recomputeHeight';\n  let setTagKey: keyof IRecompute = 'recomputeWidth';\n  let rectKey: keyof ILayoutRect = 'width';\n  if (item.layoutOrient === 'top' || item.layoutOrient === 'bottom') {\n    checkTagKey = 'recomputeWidth';\n    setTagKey = 'recomputeHeight';\n    rectKey = 'height';\n  }\n  let layoutTag = !(!item.willLayoutTag && recompute[checkTagKey] === false);\n  if (layoutTag) {\n    const lastRect = { ...item.getLayoutRect() };\n    const lastLayoutRect = item.lastComputeRect;\n    layoutRect = layout.getItemComputeLayoutRect(item);\n    // 再次判定，如果当前 item 自身不需要布局，同时当前的布局空间没变化\n    if (!item.willLayoutTag && isEqual(layoutRect, lastLayoutRect)) {\n      layoutTag = false;\n      rect = item.getLayoutRect();\n    } else {\n      rect = item.computeBoundsInRect(layoutRect);\n      // 如果当前布局了，但是结果没变化，那么也不需要重新布局\n      // 注意左右2侧只考虑的宽度变化, 上下2侧只考虑的高度变化\n      if (isEqual(lastRect[rectKey], rect[rectKey])) {\n        layoutTag = false;\n      } else {\n        setRectToItem && item.setLayoutRect(rect);\n        recompute[setTagKey] = true;\n      }\n    }\n  } else {\n    layoutRect = item.getLastComputeOutBounds();\n    rect = item.getLayoutRect();\n  }\n\n  return {\n    layoutRect,\n    rect,\n    layoutTag\n  };\n}\n"]}