{"version":3,"sources":["../src/event/events/dimension/dimension-hover.ts"],"names":[],"mappings":"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","file":"dimension-hover.js","sourcesContent":["import { isMobileLikeMode } from '../../../util/env';\nimport type { BaseEventParams, EventHandler, EventParamsDefinition, EventType } from '../../interface';\nimport { DimensionEvent } from './base';\nimport { isSameDimensionInfo } from './util/common';\nimport { Event_Source_Type } from '../../../constant/event';\nimport type { IDimensionInfo } from './interface';\n\nexport class DimensionHoverEvent extends DimensionEvent {\n  private _cacheDimensionInfo: IDimensionInfo[] | null = null;\n\n  register<Evt extends EventType>(eType: Evt, handler: EventHandler<EventParamsDefinition[Evt]>) {\n    this._callback = handler.callback;\n\n    this._eventDispatcher.register<'pointermove'>('pointermove', {\n      query: { ...handler.query, source: Event_Source_Type.chart },\n      callback: this.onMouseMove\n    });\n\n    this._eventDispatcher.register<'pointerout'>('pointerout', {\n      query: { ...handler.query, source: Event_Source_Type.canvas },\n      callback: this.onMouseOut\n    });\n\n    if (isMobileLikeMode(this._mode)) {\n      // 移动端点按也触发 hover\n      this._eventDispatcher.register<'pointerdown'>('pointerdown', {\n        query: { ...handler.query, source: Event_Source_Type.chart },\n        callback: this.onMouseMove\n      });\n    }\n  }\n\n  unregister() {\n    this._eventDispatcher.unregister('pointermove', {\n      query: null,\n      callback: this.onMouseMove\n    });\n\n    if (isMobileLikeMode(this._mode)) {\n      // 移动端点按也出发 hover\n      this._eventDispatcher.unregister('pointerdown', {\n        query: null,\n        callback: this.onMouseMove\n      });\n    }\n  }\n\n  private onMouseMove = (params: BaseEventParams) => {\n    if (!params) {\n      return;\n    }\n    const x = (params.event as any).viewX;\n    const y = (params.event as any).viewY;\n    const targetDimensionInfo = this.getTargetDimensionInfo(x, y);\n    if (targetDimensionInfo === null && this._cacheDimensionInfo !== null) {\n      // 鼠标移出某维度\n      this._callback.call(null, {\n        ...params,\n        action: 'leave',\n        dimensionInfo: this._cacheDimensionInfo.slice()\n      });\n      this._cacheDimensionInfo = targetDimensionInfo;\n    } else if (\n      targetDimensionInfo !== null &&\n      (this._cacheDimensionInfo === null ||\n        targetDimensionInfo.length !== this._cacheDimensionInfo.length ||\n        targetDimensionInfo.some((info, i) => !isSameDimensionInfo(info, this._cacheDimensionInfo![i])))\n    ) {\n      // 鼠标移入某维度\n      this._callback.call(null, {\n        ...params,\n        action: 'enter',\n        dimensionInfo: targetDimensionInfo.slice()\n      });\n      this._cacheDimensionInfo = targetDimensionInfo;\n    } else if (targetDimensionInfo !== null) {\n      // 鼠标在某维度上滑动\n      this._callback.call(null, {\n        ...params,\n        action: 'move',\n        dimensionInfo: targetDimensionInfo.slice()\n      });\n    }\n  };\n\n  private onMouseOut = (params: BaseEventParams) => {\n    if (!params) {\n      return;\n    }\n    // 鼠标移出某维度\n    this._callback.call(null, {\n      ...params,\n      action: 'leave',\n      dimensionInfo: this._cacheDimensionInfo ? this._cacheDimensionInfo.slice() : []\n    });\n    this._cacheDimensionInfo = null;\n  };\n}\n"]}