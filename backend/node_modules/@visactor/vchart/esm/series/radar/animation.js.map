{"version":3,"sources":["../src/series/radar/animation.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,gBAAgB,EAAmB,MAAM,2BAA2B,CAAC;AAC9E,OAAO,EAAE,OAAO,EAAE,MAAM,oBAAoB,CAAC;AAC7C,OAAO,EAAE,gBAAgB,EAAE,oBAAoB,EAAE,MAAM,oBAAoB,CAAC;AAC5E,OAAO,EAAE,wBAAwB,EAAE,MAAM,wBAAwB,CAAC;AAClE,OAAO,EAAE,WAAW,EAAE,MAAM,wBAAwB,CAAC;AAKrD,MAAM,CAAC,MAAM,kBAAkB,GAAG,CAAC,aAA2B,EAAE,EAAE,CAAC,CAAC;IAClE,IAAI,EAAE,aAAa,KAAK,IAAI,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,SAAS;CACpD,CAAC,CAAC;AAEH,MAAM,CAAC,MAAM,kBAAkB,GAAG,CAAC,MAA6B,EAAE,aAA2B,EAAE,EAAE,CAAC,CAAC;IACjG,IAAI,EAAE,aAAa,KAAK,IAAI,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,eAAe;IAC/D,OAAO,EAAE,GAAG,EAAE,CAAC,CAAC;QACd,MAAM,EAAE,MAAM,CAAC,MAAM,EAAE;KACxB,CAAC;CACH,CAAC,CAAC;AAEH,MAAM,UAAU,oBAAoB,CAClC,MAA6B,EAC7B,MAAyB,EACzB,aAA2B;IAE3B,QAAQ,MAAM,EAAE;QACd,KAAK,QAAQ;YACX,OAAO,kBAAkB,CAAC,aAAa,CAAC,CAAC;QAC3C,KAAK,QAAQ,CAAC;QACd,KAAK,MAAM,CAAC;QACZ;YACE,OAAO,kBAAkB,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC;KACpD;AACH,CAAC;AAED,MAAM,CAAC,MAAM,wBAAwB,GAAG,CAAC,MAA6B,EAAE,aAA2B,EAAE,EAAE;IACrG,MAAM,KAAK,GAAG,GAAG,EAAE,WAAC,OAAA,MAAA,MAAM,CAAC,MAAM,EAAE,0CAAE,CAAC,CAAA,EAAA,CAAC;IACvC,MAAM,GAAG,GAAG,CAAC,KAAY,EAAE,OAAiB,EAAE,EAAE,CAAC,OAAO,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC;IAClF,MAAM,KAAK,GAAG,GAAG,EAAE,WAAC,OAAA,MAAA,MAAM,CAAC,MAAM,EAAE,0CAAE,CAAC,CAAA,EAAA,CAAC;IACvC,MAAM,GAAG,GAAG,CAAC,KAAY,EAAE,OAAiB,EAAE,EAAE,CAAC,OAAO,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC;IAClF,IAAI,aAAa,KAAK,IAAI,EAAE;QAC1B,OAAO;YACL,OAAO,EAAE;gBACP,CAAC,EAAE,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE,EAAE,GAAG,EAAE;gBAC3B,CAAC,EAAE,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE,EAAE,GAAG,EAAE;aAC5B;SACF,CAAC;KACH;IACD,OAAO;QACL,OAAO,EAAE;YACP,CAAC,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE,EAAE,KAAK,EAAE;YAC3B,CAAC,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE,EAAE,KAAK,EAAE;SAC5B;KACF,CAAC;AACJ,CAAC,CAAC;AAEF,MAAM,UAAU,0BAA0B,CACxC,MAA6B,EAC7B,MAAyB,EACzB,aAA2B;IAE3B,QAAQ,MAAM,EAAE;QACd,KAAK,QAAQ;YACX,OAAO,kBAAkB,CAAC,aAAa,CAAC,CAAC;QAC3C,KAAK,QAAQ,CAAC;QACd,KAAK,MAAM,CAAC;QACZ;YACE,OAAO,wBAAwB,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC;KAC1D;AACH,CAAC;AAED,MAAM,CAAC,MAAM,uBAAuB,GAAG,CACrC,MAA6B,EAC7B,aAA2B,EACL,EAAE;IACxB,OAAO;QACL,MAAM,EAAE,gBAAgB;QACxB,gBAAgB,EAAE,CAAC,KAAU,EAAE,OAAiB,EAAE,EAAE;;YAClD,OAAO;gBACL,KAAK,EAAE,OAAO;gBACd,UAAU,EAAE,MAAA,MAAM,CAAC,UAAU,mCAAI,IAAI,CAAC,EAAE,GAAG,CAAC;gBAC5C,MAAM,EAAE,WAAW;gBACnB,MAAM,EAAE,MAAM,CAAC,MAAM,EAAE;gBACvB,MAAM,EAAE,MAAM,CAAC,MAAM,EAAE;gBACvB,aAAa;aACd,CAAC;QACJ,CAAC;KACF,CAAC;AACJ,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,sBAAsB,GAAG,GAAG,EAAE;IACzC,OAAO,CAAC,iBAAiB,CAAC,OAAO,EAAE,CAAC,MAA6B,EAAE,MAAyB,EAAE,EAAE;QAC9F,OAAO;YACL,MAAM,EAAE,MAAM,KAAK,QAAQ,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,oBAAoB,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC;YACpF,KAAK,EAAE,oBAAoB,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC;YACjD,IAAI,EAAE,oBAAoB,CAAC,MAAM,EAAE,MAAM,EAAE,KAAK,CAAC;YACjD,SAAS,EAAE,MAAM,KAAK,QAAQ,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,oBAAoB,CAAC,MAAM,EAAE,MAAM,EAAE,KAAK,CAAC;YACxF,MAAM,EAAE;gBACN;oBACE,OAAO,EAAE,CAAC,QAAQ,EAAE,QAAQ,CAAC;oBAC7B,MAAM,EAAE,oBAAoB;oBAC5B,gBAAgB,EAAE,MAAM;oBACxB,QAAQ,EAAE,wBAAwB,CAAC,MAAM,CAAC,QAAQ;oBAClD,MAAM,EAAE,wBAAwB,CAAC,MAAM,CAAC,MAAM;iBAC/C;gBACD;oBACE,IAAI,EAAE,QAAQ;oBACd,OAAO,EAAE,EAAE,eAAe,EAAE,CAAC,QAAQ,EAAE,SAAS,EAAE,QAAQ,CAAC,EAAE;iBAC9D;aACF;SACmB,CAAC;IACzB,CAAC,CAAC,CAAC;IACH,OAAO,CAAC,iBAAiB,CACvB,aAAa,EACb,CAAC,MAA6B,EAAE,MAAyB,EAAE,EAAE,CAC3D,CAAC;QACC,MAAM,EAAE,MAAM,KAAK,QAAQ,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,0BAA0B,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC;QAC1F,KAAK,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE;QAC1B,IAAI,EAAE,EAAE,IAAI,EAAE,UAAU,EAAE;QAC1B,SAAS,EAAE,MAAM,KAAK,QAAQ,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,0BAA0B,CAAC,MAAM,EAAE,MAAM,EAAE,KAAK,CAAC;QAC9F,MAAM,EAAE;YACN;gBACE,OAAO,EAAE,EAAE,eAAe,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,QAAQ,CAAC,EAAE;aACnD;YACD;gBACE,OAAO,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,QAAQ,CAAC;gBAC7B,MAAM,EAAE,gBAAgB;gBACxB,gBAAgB,EAAE,MAAM;gBACxB,QAAQ,EAAE,wBAAwB,CAAC,MAAM,CAAC,QAAQ;gBAClD,MAAM,EAAE,wBAAwB,CAAC,MAAM,CAAC,MAAM;aAC/C;SACF;KACoB,CAAA,CAC1B,CAAC;IACF,OAAO,CAAC,iBAAiB,CAAC,YAAY,EAAE,CAAC,MAA6B,EAAE,MAAyB,EAAE,EAAE;QACnG,OAAO;YACL,MAAM,EAAE,uBAAuB,CAAC,MAAM,EAAE,IAAI,CAAC;YAC7C,SAAS,EAAE,uBAAuB,CAAC,MAAM,EAAE,KAAK,CAAC;SAClD,CAAC;IACJ,CAAC,CAAC,CAAC;IACH,WAAW,EAAE,CAAC;AAChB,CAAC,CAAC","file":"animation.js","sourcesContent":["import type { IGraphic } from '@visactor/vrender-core';\nimport { ClipAngleAnimate, AnimateExecutor } from '@visactor/vrender-animate';\nimport { Factory } from '../../core/factory';\nimport { PolarPointUpdate, PolarTagPointsUpdate } from '../polar/animation';\nimport { DEFAULT_ANIMATION_CONFIG } from '../../animation/config';\nimport { registerArc } from '@visactor/vrender-kits';\nimport type { IRadarAnimationParams, RadarAppearPreset } from './interface';\nimport type { IAnimationTypeConfig, MarkAnimationSpec } from '../../animation/interface';\nimport type { Datum } from '../../typings/common';\n\nexport const radarFadeAnimation = (animationType: 'in' | 'out') => ({\n  type: animationType === 'in' ? 'fadeIn' : 'fadeOut'\n});\n\nexport const radarGrowAnimation = (params: IRadarAnimationParams, animationType: 'in' | 'out') => ({\n  type: animationType === 'in' ? 'growPointsIn' : 'growPointsOut',\n  options: () => ({\n    center: params.center()\n  })\n});\n\nexport function radarPresetAnimation(\n  params: IRadarAnimationParams,\n  preset: RadarAppearPreset,\n  animationType: 'in' | 'out'\n) {\n  switch (preset) {\n    case 'fadeIn':\n      return radarFadeAnimation(animationType);\n    case 'clipIn':\n    case 'grow':\n    default:\n      return radarGrowAnimation(params, animationType);\n  }\n}\n\nexport const radarSymbolMoveAnimation = (params: IRadarAnimationParams, animationType: 'in' | 'out') => {\n  const xFrom = () => params.center()?.x;\n  const xTo = (datum: Datum, element: IGraphic) => element.getGraphicAttribute('x');\n  const yFrom = () => params.center()?.y;\n  const yTo = (datum: Datum, element: IGraphic) => element.getGraphicAttribute('y');\n  if (animationType === 'in') {\n    return {\n      channel: {\n        x: { from: xFrom, to: xTo },\n        y: { from: yFrom, to: yTo }\n      }\n    };\n  }\n  return {\n    channel: {\n      x: { from: xTo, to: xFrom },\n      y: { from: yTo, to: yFrom }\n    }\n  };\n};\n\nexport function radarSymbolPresetAnimation(\n  params: IRadarAnimationParams,\n  preset: RadarAppearPreset,\n  animationType: 'in' | 'out'\n) {\n  switch (preset) {\n    case 'fadeIn':\n      return radarFadeAnimation(animationType);\n    case 'clipIn':\n    case 'grow':\n    default:\n      return radarSymbolMoveAnimation(params, animationType);\n  }\n}\n\nexport const radarGroupClipAnimation = (\n  params: IRadarAnimationParams,\n  animationType: 'in' | 'out'\n): IAnimationTypeConfig => {\n  return {\n    custom: ClipAngleAnimate,\n    customParameters: (datum: any, graphic: IGraphic) => {\n      return {\n        group: graphic,\n        startAngle: params.startAngle ?? Math.PI / 2,\n        orient: 'clockwise',\n        center: params.center(),\n        radius: params.radius(),\n        animationType\n      };\n    }\n  };\n};\n\nexport const registerRadarAnimation = () => {\n  Factory.registerAnimation('radar', (params: IRadarAnimationParams, preset: RadarAppearPreset) => {\n    return {\n      appear: preset === 'clipIn' ? undefined : radarPresetAnimation(params, preset, 'in'),\n      enter: radarPresetAnimation(params, preset, 'in'),\n      exit: radarPresetAnimation(params, preset, 'out'),\n      disappear: preset === 'clipIn' ? undefined : radarPresetAnimation(params, preset, 'out'),\n      update: [\n        {\n          channel: ['points', 'center'],\n          custom: PolarTagPointsUpdate,\n          customParameters: params,\n          duration: DEFAULT_ANIMATION_CONFIG.update.duration,\n          easing: DEFAULT_ANIMATION_CONFIG.update.easing\n        },\n        {\n          type: 'update',\n          options: { excludeChannels: ['points', 'defined', 'center'] }\n        }\n      ]\n    } as MarkAnimationSpec;\n  });\n  Factory.registerAnimation(\n    'radarSymbol',\n    (params: IRadarAnimationParams, preset: RadarAppearPreset) =>\n      ({\n        appear: preset === 'clipIn' ? undefined : radarSymbolPresetAnimation(params, preset, 'in'),\n        enter: { type: 'scaleIn' },\n        exit: { type: 'scaleOut' },\n        disappear: preset === 'clipIn' ? undefined : radarSymbolPresetAnimation(params, preset, 'out'),\n        update: [\n          {\n            options: { excludeChannels: ['x', 'y', 'center'] }\n          },\n          {\n            channel: ['x', 'y', 'center'],\n            custom: PolarPointUpdate,\n            customParameters: params,\n            duration: DEFAULT_ANIMATION_CONFIG.update.duration,\n            easing: DEFAULT_ANIMATION_CONFIG.update.easing\n          }\n        ]\n      } as MarkAnimationSpec)\n  );\n  Factory.registerAnimation('radarGroup', (params: IRadarAnimationParams, preset: RadarAppearPreset) => {\n    return {\n      appear: radarGroupClipAnimation(params, 'in'),\n      disappear: radarGroupClipAnimation(params, 'out')\n    };\n  });\n  registerArc(); // clipAngle animation will use arc graphic\n};\n"]}