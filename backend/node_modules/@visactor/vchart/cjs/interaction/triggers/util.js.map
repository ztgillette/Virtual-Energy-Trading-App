{"version":3,"sources":["../src/interaction/triggers/util.ts"],"names":[],"mappings":"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","file":"util.js","sourcesContent":["import { array, isNumber, isString } from '@visactor/vutils';\nimport type { IMark, IMarkGraphic } from '../../mark/interface/common';\n\nimport type { IElementFilterOptions, IElementHighlightOptions, IElementSelectTriggerOff } from '../interface/trigger';\nimport type { GraphicEventType } from '@visactor/vrender-core';\nimport type { IBaseInteractionSpec } from '../interface/spec';\nimport { getDatumOfGraphic } from '../../util';\nimport type { Datum } from '../../typings';\nimport { STATE_VALUE_ENUM } from '../../compile/mark/interface';\n\nexport const parseTriggerOffOfSelect = (triggerOff: IElementSelectTriggerOff | IElementSelectTriggerOff[]) => {\n  const triggerOffArray = array(triggerOff);\n  const resetType: ('view' | 'self' | 'timeout')[] = [];\n  const eventNames: GraphicEventType[] = [];\n\n  triggerOffArray.forEach(off => {\n    if (off === 'empty') {\n      resetType.push('view');\n    } else if (isString(off) && off !== 'none') {\n      if ((off as string).includes('view:')) {\n        eventNames.push((off as string).replace('view:', '') as GraphicEventType);\n\n        resetType.push('view');\n      } else {\n        eventNames.push(off as GraphicEventType);\n\n        resetType.push('self');\n      }\n    } else if (isNumber(off)) {\n      resetType.push('timeout');\n    }\n  });\n\n  return {\n    eventNames,\n    resetType\n  };\n};\n\nexport const groupMarksByState = (marks: IMark[], states: string[]): Record<string, number[]> => {\n  if (!states || !marks) {\n    return null;\n  }\n\n  const res: Record<string, number[]> = {};\n\n  marks.forEach(mark => {\n    const stateStyle = mark.stateStyle;\n\n    if (!stateStyle) {\n      return;\n    }\n\n    states.forEach(state => {\n      if (state && stateStyle[state]) {\n        if (!res[state]) {\n          res[state] = [];\n        }\n\n        res[state].push(mark.id);\n      }\n    });\n  });\n\n  return res;\n};\n\nexport const filterMarksOfInteraction = (interactionSpec: IBaseInteractionSpec, marks: IMark[]) => {\n  if (!marks || !marks.length) {\n    return [];\n  }\n  const selector: IMark[] = [];\n\n  if (interactionSpec.markIds) {\n    marks.filter(mark => {\n      if (interactionSpec.markIds.includes(mark.getProductId())) {\n        selector.push(mark);\n      }\n    });\n  } else if (interactionSpec.markNames) {\n    marks.forEach(mark => {\n      if (interactionSpec.markNames.includes(mark.name)) {\n        selector.push(mark);\n      }\n    });\n  } else {\n    marks.forEach(mark => {\n      selector.push(mark);\n    });\n  }\n\n  return selector;\n};\n\nexport const generateFilterValue = (options: IElementFilterOptions) => {\n  if (options.filterField) {\n    return (g: IMarkGraphic) => {\n      return (getDatumOfGraphic(g) as Datum)?.[options.filterField];\n    };\n  }\n\n  return (el: IMarkGraphic) => {\n    return el.context[options.filterType];\n  };\n};\n\nexport const highlightDefaultOptions: Partial<IElementHighlightOptions> = {\n  highlightState: STATE_VALUE_ENUM.STATE_HIGHLIGHT,\n  blurState: STATE_VALUE_ENUM.STATE_BLUR,\n  trigger: 'pointerover',\n  triggerOff: 'pointerout'\n};\n"]}