{"version":3,"sources":["../src/series/word-cloud/interface.ts"],"names":[],"mappings":"","file":"interface.js","sourcesContent":["import type { ITextMarkSpec, IMarkSpec, ISeriesSpec, ITextFormatMethod, IRectMarkSpec } from '../../typings';\nimport type { IAnimationSpec, IMarkAnimateSpec, IStateAnimateSpec } from '../../animation/spec';\nimport type { SeriesMarkNameEnum } from '../interface/type';\nimport type { shapes, GeometricMaskShape, TextShapeMask } from '@visactor/vlayouts';\nimport type { IAnimationTypeConfig } from '../../animation/interface';\n\nexport interface IWordcloudAnimationParams {\n  animationConfig: () => IAnimationTypeConfig;\n}\n\nexport type WordcloudAppearPreset = 'scaleIn' | 'fadeIn';\n\nexport type WordCloudShapeType = keyof typeof shapes;\n\nexport type EllipsisType = {\n  /**\n   * 超长文本替代字符串\n   * @default '...'\n   */\n  string?: string;\n  /**\n   * 限制长度\n   * @description 超过该长度的部分展示用户指定字符串\n   */\n  limitLength?: number;\n};\n\nexport type ZoomToFitType = {\n  repeat?: boolean;\n  /**\n   * 是否缩小\n   */\n  shrink?: boolean;\n  /**\n   * 是否放大\n   */\n  enlarge?: boolean;\n  /**\n   * 缩小的最小字号\n   * @description shrink: true时生效\n   */\n  fontSizeLimitMin?: number;\n  /**\n   * 放大的最大字号\n   * @description enlarge: true时生效\n   */\n  fontSizeLimitMax?: number;\n};\n/**\n * 超出画布的超长文本处理方式\n * @description 'clip': 绘制超长文本，超出画布的部分裁剪掉; 'hidden': 不绘制超长文本; 'ellipsis'绘制超长文本，且使用用户指定的字符串代替超出的文本\n */\nexport type DrawOutOfBoundType = 'clip' | 'hidden' | 'ellipsis';\n\nexport type WordCloudConfigType = {\n  /**\n   * 超长文本省略策略, 超出画布\n   * @default 'hidden'\n   */\n  drawOutOfBound?: DrawOutOfBoundType; // 默认hidden\n  /**\n   * TODO: 省略文本的配置\n   */\n  ellipsis?: EllipsisType;\n  /**\n   * 布局模式:\n   * 'fast': 快速布局，用于小程序 & 小组件环境\n   * 'grid': 基于grid像素布局\n   * 'default': 基于像素布局\n   */\n  layoutMode?: 'fast' | 'grid' | 'default';\n  /**\n   * 自适应缩放配置\n   */\n  zoomToFit: ZoomToFitType;\n  /**\n   * 渐进式渲染配置 - 布局时间\n   */\n  progressiveTime?: number;\n  /**\n   * 渐进式渲染配置 - 布局次数\n   */\n  progressiveStep?: number;\n};\nexport type WordCloudShapeConfigType = {\n  /**\n   * 填充词 - 颜色通道\n   */\n  fillingSeriesField?: string;\n  /**\n   * 填充词 - 颜色列表\n   */\n  fillingColorList?: string[];\n  /**\n   * 填充词 - 字体字段\n   */\n  fillingFontFamilyField?: string;\n  /**\n   * 填充词 - 字重字段\n   */\n  fillingFontWeightField?: string;\n  /**\n   * 填充词 - 字体样式字段\n   */\n  fillingFontStyleField?: string;\n  /**\n   * 填充词 - 直接指定 hex 颜色字段\n   */\n  fillingColorHexField?: string;\n  /**\n   * 填充词 - 可旋转角度 随机取范围\n   */\n  fillingRotateAngles?: number[];\n  /**\n   * 整体布局 - 自动计算核心词时期望的比例\n   */\n  ratio?: number;\n  /**\n   * 整体布局 - 是否对输入图片去除白边\n   */\n  removeWhiteBorder?: boolean;\n  /**\n   * 整体布局 - 布局模式\n   */\n  layoutMode?: 'default' | 'ensureMapping' | 'ensureMappingEnlarge';\n  /**\n   * 填充布局 - 填充文字填充次数\n   */\n  fillingTimes?: number;\n  /**\n   * 填充布局 - 填充时 x 的前进范围\n   */\n  fillingXStep?: number;\n  /**\n   * 填充布局 - 填充时 y 的前进范围\n   */\n  fillingYStep?: number;\n  /**\n   * 填充布局 - 填充时 x 的前进范围（相对宽度比例）\n   */\n  fillingXRatioStep?: number;\n  /**\n   * 填充布局 - 填充时 y 的前进范围（相对高度比例）\n   */\n  fillingYRatioStep?: number;\n  /**\n   * 填充布局 - 填充文字初始大小\n   */\n  fillingInitialFontSize?: number;\n  /**\n   * 填充布局 - 填充文字每次填充大小缩小值\n   */\n  fillingDeltaFontSize?: number;\n  /**\n   * 填充布局 - 填充文字初始透明度\n   */\n  fillingInitialOpacity?: number;\n  /**\n   * 填充布局 - 填充文字每次透明度缩小值\n   */\n  fillingDeltaOpacity?: number;\n  /**\n   * 填充布局 - 单词尝试布局次数\n   */\n  textLayoutTimes?: number;\n  /**\n   * 填充布局 - 每次布局失败后，缩小字号的系数\n   */\n  fontSizeShrinkFactor?: number;\n  /**\n   * 填充布局 - 布局步长系数\n   */\n  stepFactor?: number;\n  /**\n   * 填充布局 - 重要词数\n   */\n  importantWordCount?: number;\n  /**\n   * 填充布局 - 字号缩小限制\n   */\n  globalShinkLimit?: number;\n  /**\n   * 填充布局 - 每次布局成功后，放大字号的系数\n   */\n  fontSizeEnlargeFactor?: number;\n  /**\n   * 填充布局 - 填充词自动计算字号后，每次迭代字号缩小的系数\n   */\n  fillingDeltaFontSizeFactor?: number;\n  /**\n   * 填充布局 - 自动计算填充词时期望的比例\n   */\n  fillingRatio?: number;\n};\n\nexport interface IWordCloudSeriesBaseSpec\n  extends ISeriesSpec,\n    IAnimationSpec<SeriesMarkNameEnum.word, WordcloudAppearPreset> {\n  /**\n   * 文本字段\n   */\n  nameField: string;\n  /**\n   * 权重字段\n   */\n  valueField?: string;\n  /**\n   * 字体字段\n   */\n  fontFamilyField?: string;\n  /**\n   * 字重字段\n   */\n  fontWeightField?: string;\n  /**\n   * 字体样式字段\n   */\n  fontStyleField?: string;\n  /**\n   * 直接指定 hex 颜色字段\n   */\n  colorHexField?: string;\n  /**\n   * 颜色模式\n   * TODO: 'linear' 待支持\n   */\n  colorMode?: 'ordinal';\n  /**\n   * 颜色列表\n   */\n  colorList?: string[];\n  /**\n   * 可旋转角度 随机取范围\n   */\n  rotateAngles?: number[];\n  /**\n   * 字重范围\n   * @default [200,500]\n   */\n  fontWeightRange?: [number, number]; // 需要固定字重大小的话，数组里面的数就配置成一样的\n  /**\n   * 字体大小范围\n   * @description 当valueField存在时，默认值[20,40]; 当valueField不存在时，默认值[10, 10]\n   * @since 1.8.7 如果配置为'auto', 则fontSizeRange不传入, 字体大小会随画布大小改变而改变\n   */\n  fontSizeRange?: [number, number] | 'auto'; // 需要固定字体大小的话，数组里面的数就配置成一样的\n  /**\n   * 词云形状\n   * @default 'circle'\n   *\n   * 注意，文字类型和几何形状类型的shape自 1.12.0 版本开始支持\n   */\n  maskShape?: string | WordCloudShapeType | TextShapeMask | GeometricMaskShape; // url 或 svg字符串 或 base64，或shape字符串\n  /**\n   * TODO: 缩放mask时是否保持比例\n   */\n  keepAspect?: boolean;\n  /**\n   * 是否开始随机摆放方向(顺时针｜逆时针), 主要用于spec测试\n   */\n  random?: boolean;\n  /**\n   * 词云特殊配置\n   */\n  wordCloudConfig?: WordCloudConfigType;\n  /**\n   * 形状词云特殊配置\n   */\n  wordCloudShapeConfig?: WordCloudShapeConfigType;\n  /**\n   * 词云文字图元配置 或 形状词云核心词文字图元配置\n   * @description hover配置随图元state，此外增加padding: 字体间距 和 formatMethod: 文本格式化\n   */\n  [SeriesMarkNameEnum.word]?: IMarkSpec<ITextMarkSpec> & {\n    padding?: number;\n    formatMethod?: ITextFormatMethod<[datum?: any]>;\n  };\n  /**\n   * 形状词云填充词文字图元配置\n   * @description hover配置随图元state，此外增加padding: 字体间距\n   * @description 不增加formatMethod的原因：形状词云在做布局时，word和fillingWord用的是同一份数据，即text相同，所以fillingWords的format不会生效\n   * @deprecated\n   */\n  [SeriesMarkNameEnum.fillingWord]?: IMarkSpec<ITextMarkSpec> & {\n    padding?: number;\n  };\n\n  /**\n   * 当形状词云的形状为文字类型和几何形状类型的时候，支持绘制形状轮廓\n   * @since 1.12.0\n   */\n  [SeriesMarkNameEnum.wordMask]?: IMarkSpec<IRectMarkSpec>;\n\n  animationAppear?:\n    | boolean\n    | (IStateAnimateSpec<WordcloudAppearPreset> & {\n        /**\n         * 默认prest('scaleIn')时，duration为词云中单个词的动画参考时长。当单词数过多，会根据单词总数和总动画时长进行动态调整\n         * prest为 'fadeIn' 时，则为总动画时长。\n         */\n        duration?: number;\n        /**\n         * 词云入场动画总时长，在默认prest('scaleIn')时生效。\n         * @default 1000\n         * @since 1.4.0\n         */\n        totalTime?: number;\n      })\n    | IMarkAnimateSpec<string>;\n}\n\nexport interface IWordCloudSeriesSpec extends IWordCloudSeriesBaseSpec {\n  type: 'wordCloud';\n}\nexport interface IWordCloudSeriesTheme {\n  [SeriesMarkNameEnum.word]?: IMarkSpec<ITextMarkSpec> & {\n    padding?: number;\n  };\n  [SeriesMarkNameEnum.fillingWord]?: IMarkSpec<ITextMarkSpec> & {\n    padding?: number;\n  };\n}\n"]}