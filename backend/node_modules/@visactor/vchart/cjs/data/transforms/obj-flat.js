"use strict";

Object.defineProperty(exports, "__esModule", {
    value: !0
}), exports.objFlat = void 0;

const base_1 = require("../../constant/base"), data_1 = require("../../constant/data"), vutils_1 = require("@visactor/vutils"), objFlat = (data, op) => {
    var _a;
    const dataCollect = (null === (_a = data[0]) || void 0 === _a ? void 0 : _a.latestData) ? data[0].latestData : data || [], result = [];
    let index = 0;
    return dataCollect.forEach((datum => {
        const dataKeyObj = {};
        let dataKey;
        for (const key in datum) key === op || key.startsWith(base_1.PREFIX) || (dataKeyObj[key] = datum[key], 
        dataKey = (0, vutils_1.isValid)(dataKey) ? `${dataKey}_${datum[key]}` : `${datum[key]}`);
        const dataOp = datum[op];
        null == dataOp || dataOp.forEach(((d, i) => {
            result.push(Object.assign({}, dataKeyObj, d, {
                [data_1.DEFAULT_DATA_INDEX]: index,
                [data_1.DEFAULT_DATA_KEY]: `${dataKey}_${i}`
            })), index++;
        }));
    })), result;
};

exports.objFlat = objFlat;
//# sourceMappingURL=obj-flat.js.map
