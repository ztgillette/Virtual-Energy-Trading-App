{"version":3,"sources":["../src/player/base-player.ts"],"names":[],"mappings":"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","file":"base-player.js","sourcesContent":["import type { INode } from '@visactor/vrender-core';\nimport { isNumber, isValidNumber, max, merge } from '@visactor/vutils';\nimport { AbstractComponent } from '../core/base';\nimport type { ComponentOptions, OrientType } from '../interface';\nimport type { SliderAttributes } from '../slider';\nimport { Slider } from '../slider';\nimport type { ControllerAttributes } from './controller';\nimport { Controller } from './controller';\nimport type {\n  Datum,\n  PlayerEventEnum,\n  PlayerAttributes,\n  RailStyleType,\n  ControllerType,\n  TrackStyleType,\n  HandlerStyleType\n} from './type';\nimport { RailDefaultSize, defaultControllerAttributes } from './constant';\nimport { isHorizontal } from './utils';\n\n/**\n * 基本播放器组件\n * 提供最基本的布局能力,\n */\nexport abstract class BasePlayer<T> extends AbstractComponent<Required<PlayerAttributes>> {\n  static defaultAttributes = {\n    visible: true,\n    data: [] as Datum[],\n    interval: 1000,\n    orient: 'bottom',\n    align: 'center',\n    size: {\n      height: 20,\n      width: 300\n    },\n    slider: {\n      visible: true,\n      space: 10,\n      dx: 0,\n      dy: 0,\n      railStyle: {\n        cornerRadius: 5\n      },\n      trackStyle: {},\n      handlerStyle: {}\n    },\n    controller: {\n      visible: true,\n      start: { ...defaultControllerAttributes, key: 'start', position: 'start', space: 0 },\n      pause: { ...defaultControllerAttributes, key: 'pause', position: 'start' },\n      forward: { ...defaultControllerAttributes, key: 'forward', position: 'end' },\n      backward: { ...defaultControllerAttributes, key: 'backward', position: 'start' }\n    }\n  };\n\n  // 组件属性\n  protected _slider: Slider;\n  protected _controller: Controller;\n\n  // 数据属性\n  protected _data = [] as Datum[];\n  protected _minIndex: number;\n  getMinIndex() {\n    return this._minIndex;\n  }\n  protected _maxIndex: number;\n  getMaxIndex() {\n    return this._maxIndex;\n  }\n\n  // 滑轨属性\n  private _sliderVisible: boolean;\n  private _railStyle: RailStyleType;\n  private _trackStyle: TrackStyleType;\n  private _handlerStyle: HandlerStyleType;\n\n  // 控件属性\n  private _controllerVisible: boolean;\n  private _start: ControllerType;\n  private _pause: ControllerType;\n  private _forward: ControllerType;\n  private _backward: ControllerType;\n\n  // 布局属性\n  private _size: { width: number; height: number };\n  private _orient: OrientType;\n\n  // dataIndex, 代表slider的value\n  protected _dataIndex: number = 0;\n  getDataIndex() {\n    return this._dataIndex;\n  }\n\n  private _layoutInfo: {\n    // 滚动条位置\n    slider?: { x: number; y: number; size: number };\n\n    // 控件位置\n    start?: { x: number; y: number; size: number };\n    pause?: { x: number; y: number; size: number };\n    backward?: { x: number; y: number; size: number };\n    forward?: { x: number; y: number; size: number };\n  } = {};\n\n  abstract play(): void;\n  abstract pause(): void;\n  abstract backward(): void;\n  abstract forward(): void;\n\n  constructor(attributes: T, options?: ComponentOptions) {\n    super(options?.skipDefault ? attributes : merge({}, BasePlayer.defaultAttributes, attributes));\n    // 先初始化属性, 再初始化Slider、Controller, 最后初始化事件.\n    this._initAttributes();\n    this._initDataIndex();\n    this._initLayoutInfo();\n    this._initController();\n    this._initSlider();\n  }\n\n  /**\n   * 初始化属性\n   */\n  _initAttributes() {\n    // 基本布局属性\n    this._size = this.attribute.size;\n    this._orient = this.attribute.orient;\n\n    // Slider范围, 起点一定要从0开始\n    this._data = this.attribute.data;\n    this._minIndex = 0;\n    this._maxIndex = this._data.length - 1;\n\n    const { slider = {}, controller = {} as PlayerAttributes['controller'] } = this.attribute;\n    // 轨道样式\n    this._sliderVisible = slider.visible;\n    this._railStyle = { ...slider.railStyle };\n    this._trackStyle = { ...slider.trackStyle };\n    this._handlerStyle = { ...slider.handlerStyle };\n\n    // 控制器样式\n    this._controllerVisible = controller.visible;\n    this._start = { ...controller.start };\n    this._pause = { ...controller.pause };\n    this._forward = { ...controller.forward };\n    this._backward = { ...controller.backward };\n  }\n\n  /**\n   * 初始化dataIndex\n   */\n  _initDataIndex() {\n    this._dataIndex = this.attribute.dataIndex ?? 0;\n  }\n\n  private _initLayoutInfo() {\n    // 控制器\n    const controllers = [this._start, this._backward, this._forward].sort((a, b) => a.order - b.order);\n    // 在开始位置的控制器\n    const startControllers = controllers.filter(d => d.position !== 'end');\n    // 在结束位置的控制器\n    const endControllers = controllers.filter(d => d.position === 'end');\n    // 滑轨横切面长度\n    const railSectionLength =\n      (isHorizontal(this._orient) ? this._railStyle.height : this._railStyle.width) ?? RailDefaultSize[1];\n\n    // 1. 计算所有组件自身占据的宽度 or 高度\n    const controllerPx = controllers.reduce((len, controller) => {\n      const size = controller.style.size;\n      const maxSize = isNumber(size) ? size : max(size[0], size[1]);\n      return len + controller.space + maxSize;\n    }, 0);\n\n    // 2. 计算slider的总占据像素\n    const sliderPx = this._sliderVisible\n      ? (isHorizontal(this._orient) ? this._size?.width : this._size?.height) - controllerPx\n      : 0;\n\n    // 3. 计算slider滑轨的总占据像素\n    const railPx = sliderPx - this.attribute.slider.space;\n\n    // 4. 计算起点控件坐标\n    const startPx = startControllers.reduce((px, controller) => {\n      const {\n        key,\n        space,\n        style: { size }\n      } = controller;\n      const maxSize = isNumber(size) ? size : max(size[0], size[1]);\n      this._layoutInfo[key] = {\n        ...this._layoutInfo[key],\n        size: maxSize,\n        x: isHorizontal(this._orient) ? px + space : (this._size.width - maxSize) / 2,\n        y: isHorizontal(this._orient) ? (this._size.height - maxSize) / 2 : px + space\n      };\n      return px + space + maxSize;\n    }, 0);\n\n    // 5. 计算slider的起点坐标\n    this._layoutInfo.slider = {\n      ...this._layoutInfo.slider,\n      size: railPx,\n      x: isHorizontal(this._orient)\n        ? startPx + this.attribute.slider.space\n        : (this._size.width - railSectionLength) / 2,\n      y: isHorizontal(this._orient)\n        ? (this._size.height - railSectionLength) / 2\n        : startPx + this.attribute.slider.space\n    };\n\n    // 6. 计算终点控件坐标\n    endControllers.reduce((px, controller) => {\n      const {\n        key,\n        space,\n        style: { size }\n      } = controller;\n      const maxSize = isNumber(size) ? size : max(size[0], size[1]);\n      this._layoutInfo[key] = {\n        ...this._layoutInfo[key],\n        size: maxSize,\n        x: isHorizontal(this._orient) ? px + space : (this._size.width - maxSize) / 2,\n        y: isHorizontal(this._orient) ? (this._size.height - maxSize) / 2 : px + space\n      };\n      return px + space + maxSize;\n    }, startPx + sliderPx);\n  }\n\n  /**\n   * 初始化滑动条\n   */\n  private _updateSliderAttrs = () => {\n    let handlerSize;\n    if (isValidNumber(this._handlerStyle.size)) {\n      handlerSize = this._handlerStyle.size;\n    } else if (this._handlerStyle.size && this._handlerStyle.size.length) {\n      handlerSize = max(this._handlerStyle.size[0], this._handlerStyle.size[1]);\n    }\n\n    const attrs: SliderAttributes = {\n      visible: this._sliderVisible,\n      // 重要参数\n      min: this._minIndex,\n      max: this._maxIndex,\n      value: this._dataIndex,\n      railWidth: this._railStyle.width,\n      railHeight: this._railStyle.height,\n      railStyle: this._railStyle,\n      trackStyle: this._trackStyle,\n      handlerSize: isValidNumber(handlerSize) ? handlerSize : undefined,\n      handlerStyle: this._handlerStyle,\n      // 不重要, 但需要预设的参数\n      dy: this.attribute.slider.dy,\n      dx: this.attribute.slider.dx,\n      slidable: true,\n      range: false,\n      handlerText: { visible: false },\n      startText: { visible: false },\n      endText: { visible: false },\n      disableTriggerEvent: this.attribute.disableTriggerEvent\n    };\n\n    // 横向布局\n    if (isHorizontal(this._orient)) {\n      // 滑动条水平居中\n      const railWidth = Math.max(0, this._layoutInfo.slider.size);\n      const railHeight = this._railStyle.height ?? RailDefaultSize[1];\n\n      // 属性修改\n      attrs.layout = 'horizontal';\n      attrs.railHeight = railHeight;\n      attrs.railWidth = railWidth;\n      attrs.x = this._layoutInfo.slider.x;\n      attrs.y = this._layoutInfo.slider.y;\n    }\n    // 纵向布局\n    else {\n      // 滑动条垂直居中\n      const railHeight = Math.max(0, this._layoutInfo.slider.size);\n      const railWidth = this._railStyle.width ?? RailDefaultSize[1];\n\n      // 属性修改\n      attrs.layout = 'vertical';\n      attrs.railWidth = railWidth;\n      attrs.railHeight = railHeight;\n      attrs.x = this._layoutInfo.slider.x;\n      attrs.y = this._layoutInfo.slider.y;\n    }\n    return attrs;\n  };\n\n  private _initSlider = () => {\n    const attrs = this._updateSliderAttrs();\n    this._slider = new Slider(attrs);\n    if (this._sliderVisible) {\n      this.add(this._slider as unknown as INode);\n    }\n  };\n\n  /**\n   * 初始化控制器\n   */\n  private _updateControllerAttrs = () => {\n    const attrs: ControllerAttributes = {\n      start: this._start,\n      pause: this._pause,\n      forward: this._forward,\n      backward: this._backward,\n      disableTriggerEvent: this.attribute.disableTriggerEvent\n    };\n    // 横向布局\n    attrs.layout = isHorizontal(this._orient) ? 'horizontal' : 'vertical';\n    attrs.start = {\n      ...attrs.start,\n      style: {\n        ...attrs.start.style,\n        x: this._layoutInfo.start.x,\n        y: this._layoutInfo.start.y\n      }\n    };\n    attrs.pause = {\n      ...attrs.pause,\n      // 暂停按钮, 复用开始按钮的布局\n      style: {\n        ...attrs.pause.style,\n        x: this._layoutInfo.start.x,\n        y: this._layoutInfo.start.y\n      }\n    };\n    attrs.backward = {\n      ...attrs.backward,\n      style: {\n        ...attrs.backward.style,\n        x: this._layoutInfo.backward.x,\n        y: this._layoutInfo.backward.y\n      }\n    };\n    attrs.forward = {\n      ...attrs.forward,\n      style: {\n        ...attrs.forward.style,\n        x: this._layoutInfo.forward.x,\n        y: this._layoutInfo.forward.y\n      }\n    };\n    return attrs;\n  };\n\n  private _initController = () => {\n    const attrs = this._updateControllerAttrs();\n    this._controller = new Controller(attrs);\n    if (this._controllerVisible) {\n      this.add(this._controller as unknown as INode);\n    }\n  };\n\n  /**\n   * 渲染\n   */\n  render() {\n    this._initLayoutInfo();\n    this.renderSlider();\n    this.renderController();\n  }\n\n  /**\n   * 更新滑动条\n   */\n  renderSlider() {\n    const attrs = this._updateSliderAttrs();\n    this._slider.setAttributes(attrs);\n  }\n\n  /**\n   * 更新控制器\n   */\n  renderController() {\n    const attrs = this._updateControllerAttrs();\n    this._controller.setAttributes(attrs);\n  }\n\n  /**\n   * 触发事件\n   * @param eventType 事件类型\n   * @param dataIndex 数据下标\n   */\n  dispatchCustomEvent(eventType: PlayerEventEnum, dataIndex: number) {\n    this._dispatchEvent(eventType, {\n      eventType,\n      index: dataIndex,\n      value: this._data[dataIndex]\n    });\n  }\n}\n"]}