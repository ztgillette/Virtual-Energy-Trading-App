{"version":3,"sources":["../src/marker/arc-line.ts"],"names":[],"mappings":";;;AAAA,6CAAgD;AAChD,wCAAwC;AACxC,yCAAsD;AACtD,0CAA6C;AAC7C,+CAA+C;AAG/C,iCAAqD;AAGrD,qCAA4F;AAC5F,+CAA0D;AAG1D,IAAA,mCAAwB,GAAE,CAAC;AAE3B,SAAgB,0BAA0B;IACxC,WAAW,CAAC,QAAQ,GAAG,+BAAqB,CAAC;AAC/C,CAAC;AAFD,gEAEC;AACD,MAAa,WAAY,SAAQ,4BAAiE;IAMtF,aAAa,CAAC,KAA2B;QACjD,IAAI,WAAW,CAAC,QAAQ,IAAI,IAAI,CAAC,gBAAgB,EAAE;YACjD,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,gBAAgB,EAAE,KAAK,CAAC,CAAC;SAC7E;IACH,CAAC;IAED,YAAY,UAA4B,EAAE,OAA0B;QAElE,KAAK,CAAC,CAAA,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,WAAW,EAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,IAAA,cAAK,EAAC,EAAE,EAAE,WAAW,CAAC,iBAAiB,EAAE,UAAU,CAAC,CAAC,CAAC;QAblG,SAAI,GAAG,aAAa,CAAC;IAcrB,CAAC;IAES,sBAAsB,CAC9B,SAAsC,EACtC,UAA6D;QAE7D,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,SAA6B,CAAC;QACpF,MAAM,EAAE,IAAI,GAAG,CAAC,EAAE,IAAI,GAAG,CAAC,EAAE,GAAG,UAAU,CAAC;QAC1C,IAAI,KAAK,CAAC;QAEV,QAAQ,SAAS,EAAE;YACjB,KAAK,kCAA2B,CAAC,aAAa;gBAC5C,KAAK,GAAG,UAAU,CAAC;YACrB,KAAK,kCAA2B,CAAC,aAAa;gBAC5C,KAAK,GAAG,UAAU,CAAC;gBACnB,MAAM;YACR,KAAK,kCAA2B,CAAC,WAAW;gBAC1C,KAAK,GAAG,QAAQ,CAAC;YACnB,KAAK,kCAA2B,CAAC,WAAW;gBAC1C,KAAK,GAAG,QAAQ,CAAC;gBACjB,MAAM;YACR,KAAK,kCAA2B,CAAC,MAAM,CAAC;YACxC,KAAK,kCAA2B,CAAC,cAAc,CAAC;YAChD,KAAK,kCAA2B,CAAC,cAAc;gBAC7C,KAAK,GAAG,CAAC,UAAU,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC;gBACpC,MAAM;YACR;gBACE,KAAK,GAAG,CAAC,UAAU,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC;SACvC;QAED,OAAO;YACL,QAAQ,EAAE;gBACR,CAAC,EAAE,MAAM,CAAC,CAAC,GAAG,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;gBACtF,CAAC,EAAE,MAAM,CAAC,CAAC,GAAG,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;aACvF;YACD,KAAK;SACN,CAAC;IACJ,CAAC;IAES,YAAY,CAAC,QAAqC;QAC1D,OAAO,4CAAmC,CAAC,QAAQ,CAAC,CAAC;IACvD,CAAC;IAES,gBAAgB,CAAC,KAAa,EAAE,UAA6D;;QACrG,OAAO,KAAK,GAAG,IAAI,CAAC,EAAE,GAAG,CAAC,GAAG,CAAC,MAAA,UAAU,CAAC,QAAQ,mCAAI,CAAC,CAAC,CAAC;IAC1D,CAAC;IAES,aAAa;QACrB,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE,QAAQ,EAAE,WAAW,EAAE,SAAS,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,IAAI;aAC5F,SAA6B,CAAC;QACjC,OAAO,IAAI,oBAAU,CAAC;YACpB,MAAM;YACN,MAAM;YACN,UAAU;YACV,QAAQ;YACR,WAAW;YACX,SAAS;YACT,SAAS;YACT,KAAK,EAAE;gBACL,IAAI,EAAE,IAAA,cAAK,EAAC,EAAE,EAAE,yBAAc,EAAE,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,IAAI,CAAC;gBAC5C,WAAW,EAAE,IAAA,cAAK,EAAC,EAAE,EAAE,yBAAc,EAAE,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,eAAe,CAAC;gBAC9D,SAAS,EAAE,IAAA,cAAK,EAAC,EAAE,EAAE,yBAAc,EAAE,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,aAAa,CAAC;aAC3D;SACF,CAAC,CAAC;IACL,CAAC;IAES,iBAAiB;QACzB,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE,QAAQ,EAAE,WAAW,EAAE,SAAS,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,IAAI;aAC5F,SAA6B,CAAC;QACjC,IAAI,IAAI,CAAC,KAAK,EAAE;YACb,IAAI,CAAC,KAAa,CAAC,aAAa,CAAC;gBAChC,MAAM;gBACN,MAAM;gBACN,UAAU;gBACV,QAAQ;gBACR,WAAW;gBACX,SAAS;gBACT,SAAS;gBACT,KAAK,EAAE;oBACL,IAAI,EAAE,IAAA,cAAK,EAAC,EAAE,EAAE,yBAAc,EAAE,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,IAAI,CAAC;oBAC5C,WAAW,EAAE,IAAA,cAAK,EAAC,EAAE,EAAE,yBAAc,EAAE,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,eAAe,CAAC;oBAC9D,SAAS,EAAE,IAAA,cAAK,EAAC,EAAE,EAAE,yBAAc,EAAE,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,aAAa,CAAC;iBAC3D;aACF,CAAC,CAAC;SACJ;IACH,CAAC;IAES,aAAa;QACrB,OAAO,IAAI,CAAC;IACd,CAAC;IAES,iBAAiB,CAAC,SAAiB;QAC3C,IAAI,CAAC,cAAc,CAAC,SAAS,EAAE,wBAAwB,EAAE,WAAW,CAAC,iBAAiB,CAAC,KAAsB,CAAC,CAAC;IACjH,CAAC;IAES,oBAAoB;QAC5B,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,iBAAiB,CAAC,KAAsB,CAAC,CAAC;IAC/E,CAAC;;AAhHH,kCAiHC;AA9GQ,6BAAiB,GAA8B,oCAA0D,CAAC","file":"arc-line.js","sourcesContent":["import { array, merge } from '@visactor/vutils';\nimport { ArcSegment } from '../segment';\nimport { loadMarkArcLineComponent } from './register';\nimport { DEFAULT_STATES } from '../constant';\nimport { MarkCommonLine } from './common-line';\nimport type { ComponentOptions } from '../interface';\nimport type { IArcGraphicAttribute, IGroup } from '@visactor/vrender-core';\nimport { IMarkCommonArcLabelPosition } from './type';\n// eslint-disable-next-line no-duplicate-imports\nimport type { MarkArcLineAttrs, MarkerAnimationState, MarkerLineLabelAttrs } from './type';\nimport { DEFAULT_MARK_ARC_LINE_THEME, DEFAULT_POLAR_MARKER_TEXT_STYLE_MAP } from './config';\nimport { markCommonLineAnimate } from './animate/animate';\nimport type { TagAttributes } from '../tag';\n\nloadMarkArcLineComponent();\n\nexport function registerMarkArcLineAnimate() {\n  MarkArcLine._animate = markCommonLineAnimate;\n}\nexport class MarkArcLine extends MarkCommonLine<IArcGraphicAttribute, IMarkCommonArcLabelPosition> {\n  name = 'markArcLine';\n  // eslint-disable-next-line max-len\n  static defaultAttributes: Partial<MarkArcLineAttrs> = DEFAULT_MARK_ARC_LINE_THEME as unknown as MarkArcLineAttrs;\n  protected _line!: ArcSegment;\n\n  protected markerAnimate(state: MarkerAnimationState) {\n    if (MarkArcLine._animate && this._animationConfig) {\n      MarkArcLine._animate(this._line, this._label, this._animationConfig, state);\n    }\n  }\n\n  constructor(attributes: MarkArcLineAttrs, options?: ComponentOptions) {\n    // eslint-disable-next-line max-len\n    super(options?.skipDefault ? attributes : merge({}, MarkArcLine.defaultAttributes, attributes));\n  }\n\n  protected getPointAttrByPosition(\n    direction: IMarkCommonArcLabelPosition,\n    labelAttrs: MarkerLineLabelAttrs<IMarkCommonArcLabelPosition>\n  ) {\n    const { center, radius, startAngle, endAngle } = this.attribute as MarkArcLineAttrs;\n    const { refX = 0, refY = 0 } = labelAttrs;\n    let angle;\n\n    switch (direction) {\n      case IMarkCommonArcLabelPosition.arcInnerStart:\n        angle = startAngle;\n      case IMarkCommonArcLabelPosition.arcOuterStart:\n        angle = startAngle;\n        break;\n      case IMarkCommonArcLabelPosition.arcInnerEnd:\n        angle = endAngle;\n      case IMarkCommonArcLabelPosition.arcOuterEnd:\n        angle = endAngle;\n        break;\n      case IMarkCommonArcLabelPosition.center:\n      case IMarkCommonArcLabelPosition.arcInnerMiddle:\n      case IMarkCommonArcLabelPosition.arcOuterMiddle:\n        angle = (startAngle + endAngle) / 2;\n        break;\n      default: // default arcInnerMiddle\n        angle = (startAngle + endAngle) / 2;\n    }\n\n    return {\n      position: {\n        x: center.x + (radius + refY) * Math.cos(angle) + refX * Math.cos(angle - Math.PI / 2),\n        y: center.y + (radius + refY) * Math.sin(angle) + refX * Math.sin(angle - Math.PI / 2)\n      },\n      angle\n    };\n  }\n\n  protected getTextStyle(position: IMarkCommonArcLabelPosition) {\n    return DEFAULT_POLAR_MARKER_TEXT_STYLE_MAP[position];\n  }\n\n  protected getRotateByAngle(angle: number, labelAttrs: MarkerLineLabelAttrs<IMarkCommonArcLabelPosition>): number {\n    return angle - Math.PI / 2 + (labelAttrs.refAngle ?? 0);\n  }\n\n  protected createSegment() {\n    const { center, radius, startAngle, endAngle, startSymbol, endSymbol, lineStyle, state } = this\n      .attribute as MarkArcLineAttrs;\n    return new ArcSegment({\n      center,\n      radius,\n      startAngle,\n      endAngle,\n      startSymbol,\n      endSymbol,\n      lineStyle,\n      state: {\n        line: merge({}, DEFAULT_STATES, state?.line),\n        startSymbol: merge({}, DEFAULT_STATES, state?.lineStartSymbol),\n        endSymbol: merge({}, DEFAULT_STATES, state?.lineEndSymbol)\n      }\n    });\n  }\n\n  protected setLineAttributes() {\n    const { center, radius, startAngle, endAngle, startSymbol, endSymbol, lineStyle, state } = this\n      .attribute as MarkArcLineAttrs;\n    if (this._line) {\n      (this._line as any).setAttributes({\n        center,\n        radius,\n        startAngle,\n        endAngle,\n        startSymbol,\n        endSymbol,\n        lineStyle,\n        state: {\n          line: merge({}, DEFAULT_STATES, state?.line),\n          startSymbol: merge({}, DEFAULT_STATES, state?.lineStartSymbol),\n          endSymbol: merge({}, DEFAULT_STATES, state?.lineEndSymbol)\n        }\n      });\n    }\n  }\n\n  protected isValidPoints() {\n    return true;\n  }\n\n  protected addMarkLineLabels(container: IGroup) {\n    this._addMarkLabels(container, 'mark-common-line-label', MarkArcLine.defaultAttributes.label as TagAttributes);\n  }\n\n  protected updateMarkLineLabels() {\n    this._updateMarkLabels(MarkArcLine.defaultAttributes.label as TagAttributes);\n  }\n}\n"]}