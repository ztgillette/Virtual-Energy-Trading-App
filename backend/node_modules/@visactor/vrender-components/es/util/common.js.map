{"version":3,"sources":["../src/util/common.ts"],"names":[],"mappings":"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","file":"common.js","sourcesContent":["/**\n * @description 存放工具函数\n */\nimport type { IGraphicAttribute, IGraphic, IGroup } from '@visactor/vrender-core';\nimport { isNil } from '@visactor/vutils';\nimport type { Point } from '../core/type';\nimport type { IMarkLineLabelPosition, IMarkPointItemPosition } from '../marker';\n\nexport function traverseGroup(group: IGraphic, cb: (node: IGraphic) => boolean | void) {\n  group.forEachChildren(node => {\n    const stopped = cb(node as IGraphic);\n    if ((node as IGroup).isContainer && !stopped) {\n      traverseGroup(node as IGraphic, cb);\n    }\n  });\n}\n\nexport const isVisible = (obj?: Partial<IGraphicAttribute>): boolean => {\n  if (isNil(obj)) {\n    return false;\n  }\n  return obj.visible !== false;\n};\n\nexport function getMarksByName(root: IGroup, name: string) {\n  if (!name) {\n    return [];\n  }\n  const group = root.find(node => node.name === name, true) as IGroup;\n  if (!group) {\n    return [];\n  }\n  return group.getChildren() as IGraphic[];\n}\n\nexport function getNoneGroupMarksByName(root: IGroup, name: string) {\n  if (!name) {\n    return [];\n  }\n  const group = root.find(node => node.name === name, true) as IGroup;\n  if (!group) {\n    return [];\n  }\n  return group.findAll(node => node.type !== 'group', true) as unknown as IGraphic[];\n}\n\nexport function removeRepeatPoint(points: Point[]) {\n  const result = [points[0]];\n  for (let i = 1; i < points.length; i++) {\n    if (points[i].x !== points[i - 1].x || points[i].y !== points[i - 1].y) {\n      result.push(points[i]);\n    }\n  }\n  return result;\n}\n\nexport function isPostiveXAxis(angle: number) {\n  return (angle >= 0 && angle < Math.PI / 2) || (angle > (Math.PI * 3) / 2 && angle <= Math.PI * 2);\n}\n\nexport function fuzzyEqualNumber(a: number, b: number, delta: number): boolean {\n  return Math.abs(a - b) < delta;\n}\n\nexport function getTextAlignAttrOfVerticalDir(\n  autoRotate: boolean,\n  lineEndAngle: number,\n  itemPosition: IMarkLineLabelPosition | keyof typeof IMarkPointItemPosition\n) {\n  if (autoRotate) {\n    return {\n      textAlign: 'right',\n      textBaseline: 'middle'\n    };\n  }\n  return {\n    textAlign:\n      // left: 90度方向, 即笛卡尔坐标系y轴负方向 + top 或 270度方向, 即笛卡尔坐标系y轴正方向 + bottom\n      (lineEndAngle < Math.PI && itemPosition.toLocaleLowerCase().includes('top')) ||\n      (lineEndAngle > Math.PI && itemPosition.toLocaleLowerCase().includes('bottom'))\n        ? 'left'\n        : // right: 90度方向, 即笛卡尔坐标系y轴负方向 + bottom 或 270度方向, 即笛卡尔坐标系y轴正方向 + top\n        (lineEndAngle < Math.PI && itemPosition.toLocaleLowerCase().includes('bottom')) ||\n          (lineEndAngle > Math.PI && itemPosition.toLocaleLowerCase().includes('top'))\n        ? 'right'\n        : 'center',\n    textBaseline:\n      // bottom: 90度方向, 即笛卡尔坐标系y轴负方向 + inside 或 270度方向, 即笛卡尔坐标系y轴正方向 + outside\n      (lineEndAngle < Math.PI && itemPosition.includes('inside')) ||\n      (lineEndAngle > Math.PI && !itemPosition.includes('inside'))\n        ? 'bottom'\n        : 'top'\n  };\n}\n"]}