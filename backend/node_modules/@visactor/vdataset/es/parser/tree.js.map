{"version":3,"sources":["../src/parser/tree.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,UAAU,EAAE,MAAM,kBAAkB,CAAC;AAC9C,OAAO,EAAE,SAAS,EAAE,MAAM,cAAc,CAAC;AAEzC,OAAO,EAAE,aAAa,EAAE,MAAM,cAAc,CAAC;AAC7C,OAAO,EAAE,cAAc,EAAE,MAAM,aAAa,CAAC;AAQ7C,MAAM,2BAA2B,GAAuB;IACtD,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,QAAQ;IACzB,QAAQ,EAAE,KAAK;CAChB,CAAC;AAQF,MAAM,CAAC,MAAM,UAAU,GAAW,CAAC,IAAS,EAAE,OAA2B,EAAE,QAAkB,EAAE,EAAE;IAC/F,QAAQ,CAAC,IAAI,GAAG,aAAa,CAAC,IAAI,CAAC;IACnC,MAAM,YAAY,GAAG,cAAc,CAAC,2BAA2B,EAAE,OAAO,CAAC,CAAC;IAC1E,MAAM,EAAE,QAAQ,EAAE,GAAG,YAAY,CAAC;IAElC,IAAI,QAAQ,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,EAAE;QACrC,MAAM,IAAI,SAAS,CAAC,uCAAuC,CAAC,CAAC;KAC9D;IAED,OAAO,SAAS,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;AAQnC,CAAC,CAAC","file":"tree.js","sourcesContent":["import { isFunction } from '@visactor/vutils';\nimport { hierarchy } from 'd3-hierarchy';\nimport type { DataView } from '../data-view';\nimport { DATAVIEW_TYPE } from '../constants';\nimport { mergeDeepImmer } from '../utils/js';\nimport type { Parser } from '.';\n\nexport interface ITreeParserOptions {\n  children?: (data: any) => any[]; // 指定的 children 访问器会为每个数据进行调用，从根 data 开始，并且必须返回一个数组用以表示当前数据的子节点，返回 null 表示当前数据没有子节点。如果没有指定 children 则默认为: d => d.children\n  pureData?: boolean;\n}\n\nconst DEFAULT_TREE_PARSER_OPTIONS: ITreeParserOptions = {\n  children: d => d.children,\n  pureData: false\n};\n/**\n * 树形结构数据 解析器\n * @param data\n * @param options\n * @param dataView\n * @returns\n */\nexport const treeParser: Parser = (data: any, options: ITreeParserOptions, dataView: DataView) => {\n  dataView.type = DATAVIEW_TYPE.TREE;\n  const mergeOptions = mergeDeepImmer(DEFAULT_TREE_PARSER_OPTIONS, options);\n  const { children } = mergeOptions;\n\n  if (children && !isFunction(children)) {\n    throw new TypeError('Invalid children: must be a function!');\n  }\n\n  return hierarchy(data, children);\n  // // if (!options.pureData) {\n  // //   // @ts-ignore\n  // //   dataView.rows = dataView.root = hierarchy(data, children);\n  // // } else {\n  // //   dataView.rows = dataView.root = data;\n  // // }\n  // return data;\n};\n"]}